var _v=Object.defineProperty;var bv=(e,t,n)=>t in e?_v(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var jt=(e,t,n)=>bv(e,typeof t!="symbol"?t+"":t,n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const u of a.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&i(u)}).observe(document,{childList:!0,subtree:!0});function n(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(o){if(o.ep)return;o.ep=!0;const a=n(o);fetch(o.href,a)}})();/**
* @vue/shared v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function Uf(e){const t=Object.create(null);for(const n of e.split(","))t[n]=1;return n=>n in t}const Li={},Nu=[],Aa=()=>{},wv=()=>!1,$h=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),$f=e=>e.startsWith("onUpdate:"),Fr=Object.assign,qf=(e,t)=>{const n=e.indexOf(t);n>-1&&e.splice(n,1)},xv=Object.prototype.hasOwnProperty,fi=(e,t)=>xv.call(e,t),vn=Array.isArray,Du=e=>Rc(e)==="[object Map]",qu=e=>Rc(e)==="[object Set]",Cp=e=>Rc(e)==="[object Date]",Bn=e=>typeof e=="function",or=e=>typeof e=="string",Ba=e=>typeof e=="symbol",Pi=e=>e!==null&&typeof e=="object",Sg=e=>(Pi(e)||Bn(e))&&Bn(e.then)&&Bn(e.catch),Eg=Object.prototype.toString,Rc=e=>Eg.call(e),Lv=e=>Rc(e).slice(8,-1),Ag=e=>Rc(e)==="[object Object]",Vf=e=>or(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,uc=Uf(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),qh=e=>{const t=Object.create(null);return n=>t[n]||(t[n]=e(n))},Cv=/-(\w)/g,Oo=qh(e=>e.replace(Cv,(t,n)=>n?n.toUpperCase():"")),Pv=/\B([A-Z])/g,cu=qh(e=>e.replace(Pv,"-$1").toLowerCase()),Vh=qh(e=>e.charAt(0).toUpperCase()+e.slice(1)),Pd=qh(e=>e?`on${Vh(e)}`:""),Bl=(e,t)=>!Object.is(e,t),lh=(e,...t)=>{for(let n=0;n<e.length;n++)e[n](...t)},Mg=(e,t,n,i=!1)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:i,value:n})},Ch=e=>{const t=parseFloat(e);return isNaN(t)?e:t},kv=e=>{const t=or(e)?Number(e):NaN;return isNaN(t)?e:t};let Pp;const Gh=()=>Pp||(Pp=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Oc(e){if(vn(e)){const t={};for(let n=0;n<e.length;n++){const i=e[n],o=or(i)?Mv(i):Oc(i);if(o)for(const a in o)t[a]=o[a]}return t}else if(or(e)||Pi(e))return e}const Sv=/;(?![^(]*\))/g,Ev=/:([^]+)/,Av=/\/\*[^]*?\*\//g;function Mv(e){const t={};return e.replace(Av,"").split(Sv).forEach(n=>{if(n){const i=n.split(Ev);i.length>1&&(t[i[0].trim()]=i[1].trim())}}),t}function zi(e){let t="";if(or(e))t=e;else if(vn(e))for(let n=0;n<e.length;n++){const i=zi(e[n]);i&&(t+=i+" ")}else if(Pi(e))for(const n in e)e[n]&&(t+=n+" ");return t.trim()}const Bv="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Tv=Uf(Bv);function Bg(e){return!!e||e===""}function Nv(e,t){if(e.length!==t.length)return!1;let n=!0;for(let i=0;n&&i<e.length;i++)n=ou(e[i],t[i]);return n}function ou(e,t){if(e===t)return!0;let n=Cp(e),i=Cp(t);if(n||i)return n&&i?e.getTime()===t.getTime():!1;if(n=Ba(e),i=Ba(t),n||i)return e===t;if(n=vn(e),i=vn(t),n||i)return n&&i?Nv(e,t):!1;if(n=Pi(e),i=Pi(t),n||i){if(!n||!i)return!1;const o=Object.keys(e).length,a=Object.keys(t).length;if(o!==a)return!1;for(const u in e){const d=e.hasOwnProperty(u),f=t.hasOwnProperty(u);if(d&&!f||!d&&f||!ou(e[u],t[u]))return!1}}return String(e)===String(t)}function Gf(e,t){return e.findIndex(n=>ou(n,t))}const Tg=e=>!!(e&&e.__v_isRef===!0),Bt=e=>or(e)?e:e==null?"":vn(e)||Pi(e)&&(e.toString===Eg||!Bn(e.toString))?Tg(e)?Bt(e.value):JSON.stringify(e,Ng,2):String(e),Ng=(e,t)=>Tg(t)?Ng(e,t.value):Du(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((n,[i,o],a)=>(n[kd(i,a)+" =>"]=o,n),{})}:qu(t)?{[`Set(${t.size})`]:[...t.values()].map(n=>kd(n))}:Ba(t)?kd(t):Pi(t)&&!vn(t)&&!Ag(t)?String(t):t,kd=(e,t="")=>{var n;return Ba(e)?`Symbol(${(n=e.description)!=null?n:t})`:e};/**
* @vue/reactivity v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Ps;class Dg{constructor(t=!1){this.detached=t,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Ps,!t&&Ps&&(this.index=(Ps.scopes||(Ps.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,n;if(this.scopes)for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].pause();for(t=0,n=this.effects.length;t<n;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,n;if(this.scopes)for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].resume();for(t=0,n=this.effects.length;t<n;t++)this.effects[t].resume()}}run(t){if(this._active){const n=Ps;try{return Ps=this,t()}finally{Ps=n}}}on(){Ps=this}off(){Ps=this.parent}stop(t){if(this._active){this._active=!1;let n,i;for(n=0,i=this.effects.length;n<i;n++)this.effects[n].stop();for(this.effects.length=0,n=0,i=this.cleanups.length;n<i;n++)this.cleanups[n]();if(this.cleanups.length=0,this.scopes){for(n=0,i=this.scopes.length;n<i;n++)this.scopes[n].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!t){const o=this.parent.scopes.pop();o&&o!==this&&(this.parent.scopes[this.index]=o,o.index=this.index)}this.parent=void 0}}}function Rg(e){return new Dg(e)}function Og(){return Ps}function Dv(e,t=!1){Ps&&Ps.cleanups.push(e)}let Ai;const Sd=new WeakSet;class Ig{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Ps&&Ps.active&&Ps.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Sd.has(this)&&(Sd.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||jg(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,kp(this),zg(this);const t=Ai,n=ta;Ai=this,ta=!0;try{return this.fn()}finally{Ug(this),Ai=t,ta=n,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)Zf(t);this.deps=this.depsTail=void 0,kp(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Sd.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){tf(this)&&this.run()}get dirty(){return tf(this)}}let Fg=0,cc,hc;function jg(e,t=!1){if(e.flags|=8,t){e.next=hc,hc=e;return}e.next=cc,cc=e}function Hf(){Fg++}function Wf(){if(--Fg>0)return;if(hc){let t=hc;for(hc=void 0;t;){const n=t.next;t.next=void 0,t.flags&=-9,t=n}}let e;for(;cc;){let t=cc;for(cc=void 0;t;){const n=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(i){e||(e=i)}t=n}}if(e)throw e}function zg(e){for(let t=e.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function Ug(e){let t,n=e.depsTail,i=n;for(;i;){const o=i.prevDep;i.version===-1?(i===n&&(n=o),Zf(i),Rv(i)):t=i,i.dep.activeLink=i.prevActiveLink,i.prevActiveLink=void 0,i=o}e.deps=t,e.depsTail=n}function tf(e){for(let t=e.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&($g(t.dep.computed)||t.dep.version!==t.version))return!0;return!!e._dirty}function $g(e){if(e.flags&4&&!(e.flags&16)||(e.flags&=-17,e.globalVersion===xc))return;e.globalVersion=xc;const t=e.dep;if(e.flags|=2,t.version>0&&!e.isSSR&&e.deps&&!tf(e)){e.flags&=-3;return}const n=Ai,i=ta;Ai=e,ta=!0;try{zg(e);const o=e.fn(e._value);(t.version===0||Bl(o,e._value))&&(e._value=o,t.version++)}catch(o){throw t.version++,o}finally{Ai=n,ta=i,Ug(e),e.flags&=-3}}function Zf(e,t=!1){const{dep:n,prevSub:i,nextSub:o}=e;if(i&&(i.nextSub=o,e.prevSub=void 0),o&&(o.prevSub=i,e.nextSub=void 0),n.subs===e&&(n.subs=i,!i&&n.computed)){n.computed.flags&=-5;for(let a=n.computed.deps;a;a=a.nextDep)Zf(a,!0)}!t&&!--n.sc&&n.map&&n.map.delete(n.key)}function Rv(e){const{prevDep:t,nextDep:n}=e;t&&(t.nextDep=n,e.prevDep=void 0),n&&(n.prevDep=t,e.nextDep=void 0)}let ta=!0;const qg=[];function Il(){qg.push(ta),ta=!1}function Fl(){const e=qg.pop();ta=e===void 0?!0:e}function kp(e){const{cleanup:t}=e;if(e.cleanup=void 0,t){const n=Ai;Ai=void 0;try{t()}finally{Ai=n}}}let xc=0;class Ov{constructor(t,n){this.sub=t,this.dep=n,this.version=n.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Kf{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(t){if(!Ai||!ta||Ai===this.computed)return;let n=this.activeLink;if(n===void 0||n.sub!==Ai)n=this.activeLink=new Ov(Ai,this),Ai.deps?(n.prevDep=Ai.depsTail,Ai.depsTail.nextDep=n,Ai.depsTail=n):Ai.deps=Ai.depsTail=n,Vg(n);else if(n.version===-1&&(n.version=this.version,n.nextDep)){const i=n.nextDep;i.prevDep=n.prevDep,n.prevDep&&(n.prevDep.nextDep=i),n.prevDep=Ai.depsTail,n.nextDep=void 0,Ai.depsTail.nextDep=n,Ai.depsTail=n,Ai.deps===n&&(Ai.deps=i)}return n}trigger(t){this.version++,xc++,this.notify(t)}notify(t){Hf();try{for(let n=this.subs;n;n=n.prevSub)n.sub.notify()&&n.sub.dep.notify()}finally{Wf()}}}function Vg(e){if(e.dep.sc++,e.sub.flags&4){const t=e.dep.computed;if(t&&!e.dep.subs){t.flags|=20;for(let i=t.deps;i;i=i.nextDep)Vg(i)}const n=e.dep.subs;n!==e&&(e.prevSub=n,n&&(n.nextSub=e)),e.dep.subs=e}}const Ph=new WeakMap,nu=Symbol(""),nf=Symbol(""),Lc=Symbol("");function ls(e,t,n){if(ta&&Ai){let i=Ph.get(e);i||Ph.set(e,i=new Map);let o=i.get(n);o||(i.set(n,o=new Kf),o.map=i,o.key=n),o.track()}}function Qa(e,t,n,i,o,a){const u=Ph.get(e);if(!u){xc++;return}const d=f=>{f&&f.trigger()};if(Hf(),t==="clear")u.forEach(d);else{const f=vn(e),v=f&&Vf(n);if(f&&n==="length"){const _=Number(i);u.forEach((x,k)=>{(k==="length"||k===Lc||!Ba(k)&&k>=_)&&d(x)})}else switch((n!==void 0||u.has(void 0))&&d(u.get(n)),v&&d(u.get(Lc)),t){case"add":f?v&&d(u.get("length")):(d(u.get(nu)),Du(e)&&d(u.get(nf)));break;case"delete":f||(d(u.get(nu)),Du(e)&&d(u.get(nf)));break;case"set":Du(e)&&d(u.get(nu));break}}Wf()}function Iv(e,t){const n=Ph.get(e);return n&&n.get(t)}function bu(e){const t=ii(e);return t===e?t:(ls(t,"iterate",Lc),No(e)?t:t.map(us))}function Hh(e){return ls(e=ii(e),"iterate",Lc),e}const Fv={__proto__:null,[Symbol.iterator](){return Ed(this,Symbol.iterator,us)},concat(...e){return bu(this).concat(...e.map(t=>vn(t)?bu(t):t))},entries(){return Ed(this,"entries",e=>(e[1]=us(e[1]),e))},every(e,t){return Za(this,"every",e,t,void 0,arguments)},filter(e,t){return Za(this,"filter",e,t,n=>n.map(us),arguments)},find(e,t){return Za(this,"find",e,t,us,arguments)},findIndex(e,t){return Za(this,"findIndex",e,t,void 0,arguments)},findLast(e,t){return Za(this,"findLast",e,t,us,arguments)},findLastIndex(e,t){return Za(this,"findLastIndex",e,t,void 0,arguments)},forEach(e,t){return Za(this,"forEach",e,t,void 0,arguments)},includes(...e){return Ad(this,"includes",e)},indexOf(...e){return Ad(this,"indexOf",e)},join(e){return bu(this).join(e)},lastIndexOf(...e){return Ad(this,"lastIndexOf",e)},map(e,t){return Za(this,"map",e,t,void 0,arguments)},pop(){return Xu(this,"pop")},push(...e){return Xu(this,"push",e)},reduce(e,...t){return Sp(this,"reduce",e,t)},reduceRight(e,...t){return Sp(this,"reduceRight",e,t)},shift(){return Xu(this,"shift")},some(e,t){return Za(this,"some",e,t,void 0,arguments)},splice(...e){return Xu(this,"splice",e)},toReversed(){return bu(this).toReversed()},toSorted(e){return bu(this).toSorted(e)},toSpliced(...e){return bu(this).toSpliced(...e)},unshift(...e){return Xu(this,"unshift",e)},values(){return Ed(this,"values",us)}};function Ed(e,t,n){const i=Hh(e),o=i[t]();return i!==e&&!No(e)&&(o._next=o.next,o.next=()=>{const a=o._next();return a.value&&(a.value=n(a.value)),a}),o}const jv=Array.prototype;function Za(e,t,n,i,o,a){const u=Hh(e),d=u!==e&&!No(e),f=u[t];if(f!==jv[t]){const x=f.apply(e,a);return d?us(x):x}let v=n;u!==e&&(d?v=function(x,k){return n.call(this,us(x),k,e)}:n.length>2&&(v=function(x,k){return n.call(this,x,k,e)}));const _=f.call(u,v,i);return d&&o?o(_):_}function Sp(e,t,n,i){const o=Hh(e);let a=n;return o!==e&&(No(e)?n.length>3&&(a=function(u,d,f){return n.call(this,u,d,f,e)}):a=function(u,d,f){return n.call(this,u,us(d),f,e)}),o[t](a,...i)}function Ad(e,t,n){const i=ii(e);ls(i,"iterate",Lc);const o=i[t](...n);return(o===-1||o===!1)&&Xf(n[0])?(n[0]=ii(n[0]),i[t](...n)):o}function Xu(e,t,n=[]){Il(),Hf();const i=ii(e)[t].apply(e,n);return Wf(),Fl(),i}const zv=Uf("__proto__,__v_isRef,__isVue"),Gg=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(Ba));function Uv(e){Ba(e)||(e=String(e));const t=ii(this);return ls(t,"has",e),t.hasOwnProperty(e)}class Hg{constructor(t=!1,n=!1){this._isReadonly=t,this._isShallow=n}get(t,n,i){if(n==="__v_skip")return t.__v_skip;const o=this._isReadonly,a=this._isShallow;if(n==="__v_isReactive")return!o;if(n==="__v_isReadonly")return o;if(n==="__v_isShallow")return a;if(n==="__v_raw")return i===(o?a?Jv:Yg:a?Kg:Zg).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(i)?t:void 0;const u=vn(t);if(!o){let f;if(u&&(f=Fv[n]))return f;if(n==="hasOwnProperty")return Uv}const d=Reflect.get(t,n,sr(t)?t:i);return(Ba(n)?Gg.has(n):zv(n))||(o||ls(t,"get",n),a)?d:sr(d)?u&&Vf(n)?d:d.value:Pi(d)?o?Xg(d):il(d):d}}class Wg extends Hg{constructor(t=!1){super(!1,t)}set(t,n,i,o){let a=t[n];if(!this._isShallow){const f=au(a);if(!No(i)&&!au(i)&&(a=ii(a),i=ii(i)),!vn(t)&&sr(a)&&!sr(i))return f?!1:(a.value=i,!0)}const u=vn(t)&&Vf(n)?Number(n)<t.length:fi(t,n),d=Reflect.set(t,n,i,sr(t)?t:o);return t===ii(o)&&(u?Bl(i,a)&&Qa(t,"set",n,i):Qa(t,"add",n,i)),d}deleteProperty(t,n){const i=fi(t,n);t[n];const o=Reflect.deleteProperty(t,n);return o&&i&&Qa(t,"delete",n,void 0),o}has(t,n){const i=Reflect.has(t,n);return(!Ba(n)||!Gg.has(n))&&ls(t,"has",n),i}ownKeys(t){return ls(t,"iterate",vn(t)?"length":nu),Reflect.ownKeys(t)}}class $v extends Hg{constructor(t=!1){super(!0,t)}set(t,n){return!0}deleteProperty(t,n){return!0}}const qv=new Wg,Vv=new $v,Gv=new Wg(!0);const rf=e=>e,Jc=e=>Reflect.getPrototypeOf(e);function Hv(e,t,n){return function(...i){const o=this.__v_raw,a=ii(o),u=Du(a),d=e==="entries"||e===Symbol.iterator&&u,f=e==="keys"&&u,v=o[e](...i),_=n?rf:t?sf:us;return!t&&ls(a,"iterate",f?nf:nu),{next(){const{value:x,done:k}=v.next();return k?{value:x,done:k}:{value:d?[_(x[0]),_(x[1])]:_(x),done:k}},[Symbol.iterator](){return this}}}}function Xc(e){return function(...t){return e==="delete"?!1:e==="clear"?void 0:this}}function Wv(e,t){const n={get(o){const a=this.__v_raw,u=ii(a),d=ii(o);e||(Bl(o,d)&&ls(u,"get",o),ls(u,"get",d));const{has:f}=Jc(u),v=t?rf:e?sf:us;if(f.call(u,o))return v(a.get(o));if(f.call(u,d))return v(a.get(d));a!==u&&a.get(o)},get size(){const o=this.__v_raw;return!e&&ls(ii(o),"iterate",nu),Reflect.get(o,"size",o)},has(o){const a=this.__v_raw,u=ii(a),d=ii(o);return e||(Bl(o,d)&&ls(u,"has",o),ls(u,"has",d)),o===d?a.has(o):a.has(o)||a.has(d)},forEach(o,a){const u=this,d=u.__v_raw,f=ii(d),v=t?rf:e?sf:us;return!e&&ls(f,"iterate",nu),d.forEach((_,x)=>o.call(a,v(_),v(x),u))}};return Fr(n,e?{add:Xc("add"),set:Xc("set"),delete:Xc("delete"),clear:Xc("clear")}:{add(o){!t&&!No(o)&&!au(o)&&(o=ii(o));const a=ii(this);return Jc(a).has.call(a,o)||(a.add(o),Qa(a,"add",o,o)),this},set(o,a){!t&&!No(a)&&!au(a)&&(a=ii(a));const u=ii(this),{has:d,get:f}=Jc(u);let v=d.call(u,o);v||(o=ii(o),v=d.call(u,o));const _=f.call(u,o);return u.set(o,a),v?Bl(a,_)&&Qa(u,"set",o,a):Qa(u,"add",o,a),this},delete(o){const a=ii(this),{has:u,get:d}=Jc(a);let f=u.call(a,o);f||(o=ii(o),f=u.call(a,o)),d&&d.call(a,o);const v=a.delete(o);return f&&Qa(a,"delete",o,void 0),v},clear(){const o=ii(this),a=o.size!==0,u=o.clear();return a&&Qa(o,"clear",void 0,void 0),u}}),["keys","values","entries",Symbol.iterator].forEach(o=>{n[o]=Hv(o,e,t)}),n}function Yf(e,t){const n=Wv(e,t);return(i,o,a)=>o==="__v_isReactive"?!e:o==="__v_isReadonly"?e:o==="__v_raw"?i:Reflect.get(fi(n,o)&&o in i?n:i,o,a)}const Zv={get:Yf(!1,!1)},Kv={get:Yf(!1,!0)},Yv={get:Yf(!0,!1)};const Zg=new WeakMap,Kg=new WeakMap,Yg=new WeakMap,Jv=new WeakMap;function Xv(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Qv(e){return e.__v_skip||!Object.isExtensible(e)?0:Xv(Lv(e))}function il(e){return au(e)?e:Jf(e,!1,qv,Zv,Zg)}function Jg(e){return Jf(e,!1,Gv,Kv,Kg)}function Xg(e){return Jf(e,!0,Vv,Yv,Yg)}function Jf(e,t,n,i,o){if(!Pi(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const a=o.get(e);if(a)return a;const u=Qv(e);if(u===0)return e;const d=new Proxy(e,u===2?i:n);return o.set(e,d),d}function Tl(e){return au(e)?Tl(e.__v_raw):!!(e&&e.__v_isReactive)}function au(e){return!!(e&&e.__v_isReadonly)}function No(e){return!!(e&&e.__v_isShallow)}function Xf(e){return e?!!e.__v_raw:!1}function ii(e){const t=e&&e.__v_raw;return t?ii(t):e}function Qf(e){return!fi(e,"__v_skip")&&Object.isExtensible(e)&&Mg(e,"__v_skip",!0),e}const us=e=>Pi(e)?il(e):e,sf=e=>Pi(e)?Xg(e):e;function sr(e){return e?e.__v_isRef===!0:!1}function Dt(e){return Qg(e,!1)}function ey(e){return Qg(e,!0)}function Qg(e,t){return sr(e)?e:new ty(e,t)}class ty{constructor(t,n){this.dep=new Kf,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=n?t:ii(t),this._value=n?t:us(t),this.__v_isShallow=n}get value(){return this.dep.track(),this._value}set value(t){const n=this._rawValue,i=this.__v_isShallow||No(t)||au(t);t=i?t:ii(t),Bl(t,n)&&(this._rawValue=t,this._value=i?t:us(t),this.dep.trigger())}}function mn(e){return sr(e)?e.value:e}const ny={get:(e,t,n)=>t==="__v_raw"?e:mn(Reflect.get(e,t,n)),set:(e,t,n,i)=>{const o=e[t];return sr(o)&&!sr(n)?(o.value=n,!0):Reflect.set(e,t,n,i)}};function em(e){return Tl(e)?e:new Proxy(e,ny)}function iy(e){const t=vn(e)?new Array(e.length):{};for(const n in e)t[n]=sy(e,n);return t}class ry{constructor(t,n,i){this._object=t,this._key=n,this._defaultValue=i,this.__v_isRef=!0,this._value=void 0}get value(){const t=this._object[this._key];return this._value=t===void 0?this._defaultValue:t}set value(t){this._object[this._key]=t}get dep(){return Iv(ii(this._object),this._key)}}function sy(e,t,n){const i=e[t];return sr(i)?i:new ry(e,t,n)}class oy{constructor(t,n,i){this.fn=t,this.setter=n,this._value=void 0,this.dep=new Kf(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=xc-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!n,this.isSSR=i}notify(){if(this.flags|=16,!(this.flags&8)&&Ai!==this)return jg(this,!0),!0}get value(){const t=this.dep.track();return $g(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function ay(e,t,n=!1){let i,o;return Bn(e)?i=e:(i=e.get,o=e.set),new oy(i,o,n)}const Qc={},kh=new WeakMap;let Kl;function ly(e,t=!1,n=Kl){if(n){let i=kh.get(n);i||kh.set(n,i=[]),i.push(e)}}function uy(e,t,n=Li){const{immediate:i,deep:o,once:a,scheduler:u,augmentJob:d,call:f}=n,v=Se=>o?Se:No(Se)||o===!1||o===0?el(Se,1):el(Se);let _,x,k,w,N=!1,z=!1;if(sr(e)?(x=()=>e.value,N=No(e)):Tl(e)?(x=()=>v(e),N=!0):vn(e)?(z=!0,N=e.some(Se=>Tl(Se)||No(Se)),x=()=>e.map(Se=>{if(sr(Se))return Se.value;if(Tl(Se))return v(Se);if(Bn(Se))return f?f(Se,2):Se()})):Bn(e)?t?x=f?()=>f(e,2):e:x=()=>{if(k){Il();try{k()}finally{Fl()}}const Se=Kl;Kl=_;try{return f?f(e,3,[w]):e(w)}finally{Kl=Se}}:x=Aa,t&&o){const Se=x,Ne=o===!0?1/0:o;x=()=>el(Se(),Ne)}const W=Og(),O=()=>{_.stop(),W&&W.active&&qf(W.effects,_)};if(a&&t){const Se=t;t=(...Ne)=>{Se(...Ne),O()}}let Z=z?new Array(e.length).fill(Qc):Qc;const se=Se=>{if(!(!(_.flags&1)||!_.dirty&&!Se))if(t){const Ne=_.run();if(o||N||(z?Ne.some(($e,Pe)=>Bl($e,Z[Pe])):Bl(Ne,Z))){k&&k();const $e=Kl;Kl=_;try{const Pe=[Ne,Z===Qc?void 0:z&&Z[0]===Qc?[]:Z,w];f?f(t,3,Pe):t(...Pe),Z=Ne}finally{Kl=$e}}}else _.run()};return d&&d(se),_=new Ig(x),_.scheduler=u?()=>u(se,!1):se,w=Se=>ly(Se,!1,_),k=_.onStop=()=>{const Se=kh.get(_);if(Se){if(f)f(Se,4);else for(const Ne of Se)Ne();kh.delete(_)}},t?i?se(!0):Z=_.run():u?u(se.bind(null,!0),!0):_.run(),O.pause=_.pause.bind(_),O.resume=_.resume.bind(_),O.stop=O,O}function el(e,t=1/0,n){if(t<=0||!Pi(e)||e.__v_skip||(n=n||new Set,n.has(e)))return e;if(n.add(e),t--,sr(e))el(e.value,t,n);else if(vn(e))for(let i=0;i<e.length;i++)el(e[i],t,n);else if(qu(e)||Du(e))e.forEach(i=>{el(i,t,n)});else if(Ag(e)){for(const i in e)el(e[i],t,n);for(const i of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,i)&&el(e[i],t,n)}return e}/**
* @vue/runtime-core v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Ic(e,t,n,i){try{return i?e(...i):e()}catch(o){Wh(o,t,n)}}function na(e,t,n,i){if(Bn(e)){const o=Ic(e,t,n,i);return o&&Sg(o)&&o.catch(a=>{Wh(a,t,n)}),o}if(vn(e)){const o=[];for(let a=0;a<e.length;a++)o.push(na(e[a],t,n,i));return o}}function Wh(e,t,n,i=!0){const o=t?t.vnode:null,{errorHandler:a,throwUnhandledErrorInProduction:u}=t&&t.appContext.config||Li;if(t){let d=t.parent;const f=t.proxy,v=`https://vuejs.org/error-reference/#runtime-${n}`;for(;d;){const _=d.ec;if(_){for(let x=0;x<_.length;x++)if(_[x](e,f,v)===!1)return}d=d.parent}if(a){Il(),Ic(a,null,10,[e,f,v]),Fl();return}}cy(e,n,o,i,u)}function cy(e,t,n,i=!0,o=!1){if(o)throw e;console.error(e)}const ks=[];let ka=-1;const Ru=[];let Ll=null,Pu=0;const tm=Promise.resolve();let Sh=null;function Di(e){const t=Sh||tm;return e?t.then(this?e.bind(this):e):t}function hy(e){let t=ka+1,n=ks.length;for(;t<n;){const i=t+n>>>1,o=ks[i],a=Cc(o);a<e||a===e&&o.flags&2?t=i+1:n=i}return t}function ep(e){if(!(e.flags&1)){const t=Cc(e),n=ks[ks.length-1];!n||!(e.flags&2)&&t>=Cc(n)?ks.push(e):ks.splice(hy(t),0,e),e.flags|=1,nm()}}function nm(){Sh||(Sh=tm.then(rm))}function dy(e){vn(e)?Ru.push(...e):Ll&&e.id===-1?Ll.splice(Pu+1,0,e):e.flags&1||(Ru.push(e),e.flags|=1),nm()}function Ep(e,t,n=ka+1){for(;n<ks.length;n++){const i=ks[n];if(i&&i.flags&2){if(e&&i.id!==e.uid)continue;ks.splice(n,1),n--,i.flags&4&&(i.flags&=-2),i(),i.flags&4||(i.flags&=-2)}}}function im(e){if(Ru.length){const t=[...new Set(Ru)].sort((n,i)=>Cc(n)-Cc(i));if(Ru.length=0,Ll){Ll.push(...t);return}for(Ll=t,Pu=0;Pu<Ll.length;Pu++){const n=Ll[Pu];n.flags&4&&(n.flags&=-2),n.flags&8||n(),n.flags&=-2}Ll=null,Pu=0}}const Cc=e=>e.id==null?e.flags&2?-1:1/0:e.id;function rm(e){try{for(ka=0;ka<ks.length;ka++){const t=ks[ka];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),Ic(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;ka<ks.length;ka++){const t=ks[ka];t&&(t.flags&=-2)}ka=-1,ks.length=0,im(),Sh=null,(ks.length||Ru.length)&&rm()}}let Ss=null,sm=null;function Eh(e){const t=Ss;return Ss=e,sm=e&&e.type.__scopeId||null,t}function Qo(e,t=Ss,n){if(!t||e._n)return e;const i=(...o)=>{i._d&&jp(-1);const a=Eh(t);let u;try{u=e(...o)}finally{Eh(a),i._d&&jp(1)}return u};return i._n=!0,i._c=!0,i._d=!0,i}function un(e,t){if(Ss===null)return e;const n=ed(Ss),i=e.dirs||(e.dirs=[]);for(let o=0;o<t.length;o++){let[a,u,d,f=Li]=t[o];a&&(Bn(a)&&(a={mounted:a,updated:a}),a.deep&&el(u),i.push({dir:a,instance:n,value:u,oldValue:void 0,arg:d,modifiers:f}))}return e}function Gl(e,t,n,i){const o=e.dirs,a=t&&t.dirs;for(let u=0;u<o.length;u++){const d=o[u];a&&(d.oldValue=a[u].value);let f=d.dir[i];f&&(Il(),na(f,n,8,[e.el,d,e,t]),Fl())}}const fy=Symbol("_vte"),om=e=>e.__isTeleport,Cl=Symbol("_leaveCb"),eh=Symbol("_enterCb");function py(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Ta(()=>{e.isMounted=!0}),Yh(()=>{e.isUnmounting=!0}),e}const Mo=[Function,Array],am={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Mo,onEnter:Mo,onAfterEnter:Mo,onEnterCancelled:Mo,onBeforeLeave:Mo,onLeave:Mo,onAfterLeave:Mo,onLeaveCancelled:Mo,onBeforeAppear:Mo,onAppear:Mo,onAfterAppear:Mo,onAppearCancelled:Mo},lm=e=>{const t=e.subTree;return t.component?lm(t.component):t},gy={name:"BaseTransition",props:am,setup(e,{slots:t}){const n=f2(),i=py();return()=>{const o=t.default&&hm(t.default(),!0);if(!o||!o.length)return;const a=um(o),u=ii(e),{mode:d}=u;if(i.isLeaving)return Md(a);const f=Ap(a);if(!f)return Md(a);let v=of(f,u,i,n,x=>v=x);f.type!==Vs&&Pc(f,v);let _=n.subTree&&Ap(n.subTree);if(_&&_.type!==Vs&&!Jl(f,_)&&lm(n).type!==Vs){let x=of(_,u,i,n);if(Pc(_,x),d==="out-in"&&f.type!==Vs)return i.isLeaving=!0,x.afterLeave=()=>{i.isLeaving=!1,n.job.flags&8||n.update(),delete x.afterLeave,_=void 0},Md(a);d==="in-out"&&f.type!==Vs?x.delayLeave=(k,w,N)=>{const z=cm(i,_);z[String(_.key)]=_,k[Cl]=()=>{w(),k[Cl]=void 0,delete v.delayedLeave,_=void 0},v.delayedLeave=()=>{N(),delete v.delayedLeave,_=void 0}}:_=void 0}else _&&(_=void 0);return a}}};function um(e){let t=e[0];if(e.length>1){for(const n of e)if(n.type!==Vs){t=n;break}}return t}const my=gy;function cm(e,t){const{leavingVNodes:n}=e;let i=n.get(t.type);return i||(i=Object.create(null),n.set(t.type,i)),i}function of(e,t,n,i,o){const{appear:a,mode:u,persisted:d=!1,onBeforeEnter:f,onEnter:v,onAfterEnter:_,onEnterCancelled:x,onBeforeLeave:k,onLeave:w,onAfterLeave:N,onLeaveCancelled:z,onBeforeAppear:W,onAppear:O,onAfterAppear:Z,onAppearCancelled:se}=t,Se=String(e.key),Ne=cm(n,e),$e=(Be,ze)=>{Be&&na(Be,i,9,ze)},Pe=(Be,ze)=>{const te=ze[1];$e(Be,ze),vn(Be)?Be.every(J=>J.length<=1)&&te():Be.length<=1&&te()},xe={mode:u,persisted:d,beforeEnter(Be){let ze=f;if(!n.isMounted)if(a)ze=W||f;else return;Be[Cl]&&Be[Cl](!0);const te=Ne[Se];te&&Jl(e,te)&&te.el[Cl]&&te.el[Cl](),$e(ze,[Be])},enter(Be){let ze=v,te=_,J=x;if(!n.isMounted)if(a)ze=O||v,te=Z||_,J=se||x;else return;let Ee=!1;const he=Be[eh]=P=>{Ee||(Ee=!0,P?$e(J,[Be]):$e(te,[Be]),xe.delayedLeave&&xe.delayedLeave(),Be[eh]=void 0)};ze?Pe(ze,[Be,he]):he()},leave(Be,ze){const te=String(e.key);if(Be[eh]&&Be[eh](!0),n.isUnmounting)return ze();$e(k,[Be]);let J=!1;const Ee=Be[Cl]=he=>{J||(J=!0,ze(),he?$e(z,[Be]):$e(N,[Be]),Be[Cl]=void 0,Ne[te]===e&&delete Ne[te])};Ne[te]=e,w?Pe(w,[Be,Ee]):Ee()},clone(Be){const ze=of(Be,t,n,i,o);return o&&o(ze),ze}};return xe}function Md(e){if(Zh(e))return e=Nl(e),e.children=null,e}function Ap(e){if(!Zh(e))return om(e.type)&&e.children?um(e.children):e;const{shapeFlag:t,children:n}=e;if(n){if(t&16)return n[0];if(t&32&&Bn(n.default))return n.default()}}function Pc(e,t){e.shapeFlag&6&&e.component?(e.transition=t,Pc(e.component.subTree,t)):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function hm(e,t=!1,n){let i=[],o=0;for(let a=0;a<e.length;a++){let u=e[a];const d=n==null?u.key:String(n)+String(u.key!=null?u.key:a);u.type===Qt?(u.patchFlag&128&&o++,i=i.concat(hm(u.children,t,d))):(t||u.type!==Vs)&&i.push(d!=null?Nl(u,{key:d}):u)}if(o>1)for(let a=0;a<i.length;a++)i[a].patchFlag=-2;return i}/*! #__NO_SIDE_EFFECTS__ */function Hs(e,t){return Bn(e)?Fr({name:e.name},t,{setup:e}):e}function dm(e){e.ids=[e.ids[0]+e.ids[2]+++"-",0,0]}function Ah(e,t,n,i,o=!1){if(vn(e)){e.forEach((N,z)=>Ah(N,t&&(vn(t)?t[z]:t),n,i,o));return}if(dc(i)&&!o){i.shapeFlag&512&&i.type.__asyncResolved&&i.component.subTree.component&&Ah(e,t,n,i.component.subTree);return}const a=i.shapeFlag&4?ed(i.component):i.el,u=o?null:a,{i:d,r:f}=e,v=t&&t.r,_=d.refs===Li?d.refs={}:d.refs,x=d.setupState,k=ii(x),w=x===Li?()=>!1:N=>fi(k,N);if(v!=null&&v!==f&&(or(v)?(_[v]=null,w(v)&&(x[v]=null)):sr(v)&&(v.value=null)),Bn(f))Ic(f,d,12,[u,_]);else{const N=or(f),z=sr(f);if(N||z){const W=()=>{if(e.f){const O=N?w(f)?x[f]:_[f]:f.value;o?vn(O)&&qf(O,a):vn(O)?O.includes(a)||O.push(a):N?(_[f]=[a],w(f)&&(x[f]=_[f])):(f.value=[a],e.k&&(_[e.k]=f.value))}else N?(_[f]=u,w(f)&&(x[f]=u)):z&&(f.value=u,e.k&&(_[e.k]=u))};u?(W.id=-1,lo(W,n)):W()}}}Gh().requestIdleCallback;Gh().cancelIdleCallback;const dc=e=>!!e.type.__asyncLoader,Zh=e=>e.type.__isKeepAlive;function vy(e,t){fm(e,"a",t)}function yy(e,t){fm(e,"da",t)}function fm(e,t,n=Ir){const i=e.__wdc||(e.__wdc=()=>{let o=n;for(;o;){if(o.isDeactivated)return;o=o.parent}return e()});if(Kh(t,i,n),n){let o=n.parent;for(;o&&o.parent;)Zh(o.parent.vnode)&&_y(i,t,n,o),o=o.parent}}function _y(e,t,n,i){const o=Kh(t,e,i,!0);Jh(()=>{qf(i[t],o)},n)}function Kh(e,t,n=Ir,i=!1){if(n){const o=n[e]||(n[e]=[]),a=t.__weh||(t.__weh=(...u)=>{Il();const d=Fc(n),f=na(t,n,e,u);return d(),Fl(),f});return i?o.unshift(a):o.push(a),a}}const rl=e=>(t,n=Ir)=>{(!Sc||e==="sp")&&Kh(e,(...i)=>t(...i),n)},by=rl("bm"),Ta=rl("m"),wy=rl("bu"),xy=rl("u"),Yh=rl("bum"),Jh=rl("um"),Ly=rl("sp"),Cy=rl("rtg"),Py=rl("rtc");function ky(e,t=Ir){Kh("ec",e,t)}const Sy="components";function Ey(e,t){return My(Sy,e,!0,t)||e}const Ay=Symbol.for("v-ndc");function My(e,t,n=!0,i=!1){const o=Ss||Ir;if(o){const a=o.type;{const d=y2(a,!1);if(d&&(d===t||d===Oo(t)||d===Vh(Oo(t))))return a}const u=Mp(o[e]||a[e],t)||Mp(o.appContext[e],t);return!u&&i?a:u}}function Mp(e,t){return e&&(e[t]||e[Oo(t)]||e[Vh(Oo(t))])}function En(e,t,n,i){let o;const a=n,u=vn(e);if(u||or(e)){const d=u&&Tl(e);let f=!1;d&&(f=!No(e),e=Hh(e)),o=new Array(e.length);for(let v=0,_=e.length;v<_;v++)o[v]=t(f?us(e[v]):e[v],v,void 0,a)}else if(typeof e=="number"){o=new Array(e);for(let d=0;d<e;d++)o[d]=t(d+1,d,void 0,a)}else if(Pi(e))if(e[Symbol.iterator])o=Array.from(e,(d,f)=>t(d,f,void 0,a));else{const d=Object.keys(e);o=new Array(d.length);for(let f=0,v=d.length;f<v;f++){const _=d[f];o[f]=t(e[_],_,f,a)}}else o=[];return o}const af=e=>e?Nm(e)?ed(e):af(e.parent):null,fc=Fr(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>af(e.parent),$root:e=>af(e.root),$host:e=>e.ce,$emit:e=>e.emit,$options:e=>gm(e),$forceUpdate:e=>e.f||(e.f=()=>{ep(e.update)}),$nextTick:e=>e.n||(e.n=Di.bind(e.proxy)),$watch:e=>Xy.bind(e)}),Bd=(e,t)=>e!==Li&&!e.__isScriptSetup&&fi(e,t),By={get({_:e},t){if(t==="__v_skip")return!0;const{ctx:n,setupState:i,data:o,props:a,accessCache:u,type:d,appContext:f}=e;let v;if(t[0]!=="$"){const w=u[t];if(w!==void 0)switch(w){case 1:return i[t];case 2:return o[t];case 4:return n[t];case 3:return a[t]}else{if(Bd(i,t))return u[t]=1,i[t];if(o!==Li&&fi(o,t))return u[t]=2,o[t];if((v=e.propsOptions[0])&&fi(v,t))return u[t]=3,a[t];if(n!==Li&&fi(n,t))return u[t]=4,n[t];lf&&(u[t]=0)}}const _=fc[t];let x,k;if(_)return t==="$attrs"&&ls(e.attrs,"get",""),_(e);if((x=d.__cssModules)&&(x=x[t]))return x;if(n!==Li&&fi(n,t))return u[t]=4,n[t];if(k=f.config.globalProperties,fi(k,t))return k[t]},set({_:e},t,n){const{data:i,setupState:o,ctx:a}=e;return Bd(o,t)?(o[t]=n,!0):i!==Li&&fi(i,t)?(i[t]=n,!0):fi(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(a[t]=n,!0)},has({_:{data:e,setupState:t,accessCache:n,ctx:i,appContext:o,propsOptions:a}},u){let d;return!!n[u]||e!==Li&&fi(e,u)||Bd(t,u)||(d=a[0])&&fi(d,u)||fi(i,u)||fi(fc,u)||fi(o.config.globalProperties,u)},defineProperty(e,t,n){return n.get!=null?e._.accessCache[t]=0:fi(n,"value")&&this.set(e,t,n.value,null),Reflect.defineProperty(e,t,n)}};function Bp(e){return vn(e)?e.reduce((t,n)=>(t[n]=null,t),{}):e}let lf=!0;function Ty(e){const t=gm(e),n=e.proxy,i=e.ctx;lf=!1,t.beforeCreate&&Tp(t.beforeCreate,e,"bc");const{data:o,computed:a,methods:u,watch:d,provide:f,inject:v,created:_,beforeMount:x,mounted:k,beforeUpdate:w,updated:N,activated:z,deactivated:W,beforeDestroy:O,beforeUnmount:Z,destroyed:se,unmounted:Se,render:Ne,renderTracked:$e,renderTriggered:Pe,errorCaptured:xe,serverPrefetch:Be,expose:ze,inheritAttrs:te,components:J,directives:Ee,filters:he}=t;if(v&&Ny(v,i,null),u)for(const G in u){const Q=u[G];Bn(Q)&&(i[G]=Q.bind(n))}if(o){const G=o.call(n,n);Pi(G)&&(e.data=il(G))}if(lf=!0,a)for(const G in a){const Q=a[G],Ae=Bn(Q)?Q.bind(n,n):Bn(Q.get)?Q.get.bind(n,n):Aa,oe=!Bn(Q)&&Bn(Q.set)?Q.set.bind(n):Aa,me=jn({get:Ae,set:oe});Object.defineProperty(i,G,{enumerable:!0,configurable:!0,get:()=>me.value,set:T=>me.value=T})}if(d)for(const G in d)pm(d[G],i,n,G);if(f){const G=Bn(f)?f.call(n):f;Reflect.ownKeys(G).forEach(Q=>{uh(Q,G[Q])})}_&&Tp(_,e,"c");function F(G,Q){vn(Q)?Q.forEach(Ae=>G(Ae.bind(n))):Q&&G(Q.bind(n))}if(F(by,x),F(Ta,k),F(wy,w),F(xy,N),F(vy,z),F(yy,W),F(ky,xe),F(Py,$e),F(Cy,Pe),F(Yh,Z),F(Jh,Se),F(Ly,Be),vn(ze))if(ze.length){const G=e.exposed||(e.exposed={});ze.forEach(Q=>{Object.defineProperty(G,Q,{get:()=>n[Q],set:Ae=>n[Q]=Ae})})}else e.exposed||(e.exposed={});Ne&&e.render===Aa&&(e.render=Ne),te!=null&&(e.inheritAttrs=te),J&&(e.components=J),Ee&&(e.directives=Ee),Be&&dm(e)}function Ny(e,t,n=Aa){vn(e)&&(e=uf(e));for(const i in e){const o=e[i];let a;Pi(o)?"default"in o?a=Do(o.from||i,o.default,!0):a=Do(o.from||i):a=Do(o),sr(a)?Object.defineProperty(t,i,{enumerable:!0,configurable:!0,get:()=>a.value,set:u=>a.value=u}):t[i]=a}}function Tp(e,t,n){na(vn(e)?e.map(i=>i.bind(t.proxy)):e.bind(t.proxy),t,n)}function pm(e,t,n,i){let o=i.includes(".")?Em(n,i):()=>n[i];if(or(e)){const a=t[e];Bn(a)&&Qi(o,a)}else if(Bn(e))Qi(o,e.bind(n));else if(Pi(e))if(vn(e))e.forEach(a=>pm(a,t,n,i));else{const a=Bn(e.handler)?e.handler.bind(n):t[e.handler];Bn(a)&&Qi(o,a,e)}}function gm(e){const t=e.type,{mixins:n,extends:i}=t,{mixins:o,optionsCache:a,config:{optionMergeStrategies:u}}=e.appContext,d=a.get(t);let f;return d?f=d:!o.length&&!n&&!i?f=t:(f={},o.length&&o.forEach(v=>Mh(f,v,u,!0)),Mh(f,t,u)),Pi(t)&&a.set(t,f),f}function Mh(e,t,n,i=!1){const{mixins:o,extends:a}=t;a&&Mh(e,a,n,!0),o&&o.forEach(u=>Mh(e,u,n,!0));for(const u in t)if(!(i&&u==="expose")){const d=Dy[u]||n&&n[u];e[u]=d?d(e[u],t[u]):t[u]}return e}const Dy={data:Np,props:Dp,emits:Dp,methods:ac,computed:ac,beforeCreate:Ls,created:Ls,beforeMount:Ls,mounted:Ls,beforeUpdate:Ls,updated:Ls,beforeDestroy:Ls,beforeUnmount:Ls,destroyed:Ls,unmounted:Ls,activated:Ls,deactivated:Ls,errorCaptured:Ls,serverPrefetch:Ls,components:ac,directives:ac,watch:Oy,provide:Np,inject:Ry};function Np(e,t){return t?e?function(){return Fr(Bn(e)?e.call(this,this):e,Bn(t)?t.call(this,this):t)}:t:e}function Ry(e,t){return ac(uf(e),uf(t))}function uf(e){if(vn(e)){const t={};for(let n=0;n<e.length;n++)t[e[n]]=e[n];return t}return e}function Ls(e,t){return e?[...new Set([].concat(e,t))]:t}function ac(e,t){return e?Fr(Object.create(null),e,t):t}function Dp(e,t){return e?vn(e)&&vn(t)?[...new Set([...e,...t])]:Fr(Object.create(null),Bp(e),Bp(t??{})):t}function Oy(e,t){if(!e)return t;if(!t)return e;const n=Fr(Object.create(null),e);for(const i in t)n[i]=Ls(e[i],t[i]);return n}function mm(){return{app:null,config:{isNativeTag:wv,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Iy=0;function Fy(e,t){return function(i,o=null){Bn(i)||(i=Fr({},i)),o!=null&&!Pi(o)&&(o=null);const a=mm(),u=new WeakSet,d=[];let f=!1;const v=a.app={_uid:Iy++,_component:i,_props:o,_container:null,_context:a,_instance:null,version:b2,get config(){return a.config},set config(_){},use(_,...x){return u.has(_)||(_&&Bn(_.install)?(u.add(_),_.install(v,...x)):Bn(_)&&(u.add(_),_(v,...x))),v},mixin(_){return a.mixins.includes(_)||a.mixins.push(_),v},component(_,x){return x?(a.components[_]=x,v):a.components[_]},directive(_,x){return x?(a.directives[_]=x,v):a.directives[_]},mount(_,x,k){if(!f){const w=v._ceVNode||Ci(i,o);return w.appContext=a,k===!0?k="svg":k===!1&&(k=void 0),e(w,_,k),f=!0,v._container=_,_.__vue_app__=v,ed(w.component)}},onUnmount(_){d.push(_)},unmount(){f&&(na(d,v._instance,16),e(null,v._container),delete v._container.__vue_app__)},provide(_,x){return a.provides[_]=x,v},runWithContext(_){const x=iu;iu=v;try{return _()}finally{iu=x}}};return v}}let iu=null;function uh(e,t){if(Ir){let n=Ir.provides;const i=Ir.parent&&Ir.parent.provides;i===n&&(n=Ir.provides=Object.create(i)),n[e]=t}}function Do(e,t,n=!1){const i=Ir||Ss;if(i||iu){const o=iu?iu._context.provides:i?i.parent==null?i.vnode.appContext&&i.vnode.appContext.provides:i.parent.provides:void 0;if(o&&e in o)return o[e];if(arguments.length>1)return n&&Bn(t)?t.call(i&&i.proxy):t}}function jy(){return!!(Ir||Ss||iu)}const vm={},ym=()=>Object.create(vm),_m=e=>Object.getPrototypeOf(e)===vm;function zy(e,t,n,i=!1){const o={},a=ym();e.propsDefaults=Object.create(null),bm(e,t,o,a);for(const u in e.propsOptions[0])u in o||(o[u]=void 0);n?e.props=i?o:Jg(o):e.type.props?e.props=o:e.props=a,e.attrs=a}function Uy(e,t,n,i){const{props:o,attrs:a,vnode:{patchFlag:u}}=e,d=ii(o),[f]=e.propsOptions;let v=!1;if((i||u>0)&&!(u&16)){if(u&8){const _=e.vnode.dynamicProps;for(let x=0;x<_.length;x++){let k=_[x];if(Xh(e.emitsOptions,k))continue;const w=t[k];if(f)if(fi(a,k))w!==a[k]&&(a[k]=w,v=!0);else{const N=Oo(k);o[N]=cf(f,d,N,w,e,!1)}else w!==a[k]&&(a[k]=w,v=!0)}}}else{bm(e,t,o,a)&&(v=!0);let _;for(const x in d)(!t||!fi(t,x)&&((_=cu(x))===x||!fi(t,_)))&&(f?n&&(n[x]!==void 0||n[_]!==void 0)&&(o[x]=cf(f,d,x,void 0,e,!0)):delete o[x]);if(a!==d)for(const x in a)(!t||!fi(t,x))&&(delete a[x],v=!0)}v&&Qa(e.attrs,"set","")}function bm(e,t,n,i){const[o,a]=e.propsOptions;let u=!1,d;if(t)for(let f in t){if(uc(f))continue;const v=t[f];let _;o&&fi(o,_=Oo(f))?!a||!a.includes(_)?n[_]=v:(d||(d={}))[_]=v:Xh(e.emitsOptions,f)||(!(f in i)||v!==i[f])&&(i[f]=v,u=!0)}if(a){const f=ii(n),v=d||Li;for(let _=0;_<a.length;_++){const x=a[_];n[x]=cf(o,f,x,v[x],e,!fi(v,x))}}return u}function cf(e,t,n,i,o,a){const u=e[n];if(u!=null){const d=fi(u,"default");if(d&&i===void 0){const f=u.default;if(u.type!==Function&&!u.skipFactory&&Bn(f)){const{propsDefaults:v}=o;if(n in v)i=v[n];else{const _=Fc(o);i=v[n]=f.call(null,t),_()}}else i=f;o.ce&&o.ce._setProp(n,i)}u[0]&&(a&&!d?i=!1:u[1]&&(i===""||i===cu(n))&&(i=!0))}return i}const $y=new WeakMap;function wm(e,t,n=!1){const i=n?$y:t.propsCache,o=i.get(e);if(o)return o;const a=e.props,u={},d=[];let f=!1;if(!Bn(e)){const _=x=>{f=!0;const[k,w]=wm(x,t,!0);Fr(u,k),w&&d.push(...w)};!n&&t.mixins.length&&t.mixins.forEach(_),e.extends&&_(e.extends),e.mixins&&e.mixins.forEach(_)}if(!a&&!f)return Pi(e)&&i.set(e,Nu),Nu;if(vn(a))for(let _=0;_<a.length;_++){const x=Oo(a[_]);Rp(x)&&(u[x]=Li)}else if(a)for(const _ in a){const x=Oo(_);if(Rp(x)){const k=a[_],w=u[x]=vn(k)||Bn(k)?{type:k}:Fr({},k),N=w.type;let z=!1,W=!0;if(vn(N))for(let O=0;O<N.length;++O){const Z=N[O],se=Bn(Z)&&Z.name;if(se==="Boolean"){z=!0;break}else se==="String"&&(W=!1)}else z=Bn(N)&&N.name==="Boolean";w[0]=z,w[1]=W,(z||fi(w,"default"))&&d.push(x)}}const v=[u,d];return Pi(e)&&i.set(e,v),v}function Rp(e){return e[0]!=="$"&&!uc(e)}const xm=e=>e[0]==="_"||e==="$stable",tp=e=>vn(e)?e.map(Sa):[Sa(e)],qy=(e,t,n)=>{if(t._n)return t;const i=Qo((...o)=>tp(t(...o)),n);return i._c=!1,i},Lm=(e,t,n)=>{const i=e._ctx;for(const o in e){if(xm(o))continue;const a=e[o];if(Bn(a))t[o]=qy(o,a,i);else if(a!=null){const u=tp(a);t[o]=()=>u}}},Cm=(e,t)=>{const n=tp(t);e.slots.default=()=>n},Pm=(e,t,n)=>{for(const i in t)(n||i!=="_")&&(e[i]=t[i])},Vy=(e,t,n)=>{const i=e.slots=ym();if(e.vnode.shapeFlag&32){const o=t._;o?(Pm(i,t,n),n&&Mg(i,"_",o,!0)):Lm(t,i)}else t&&Cm(e,t)},Gy=(e,t,n)=>{const{vnode:i,slots:o}=e;let a=!0,u=Li;if(i.shapeFlag&32){const d=t._;d?n&&d===1?a=!1:Pm(o,t,n):(a=!t.$stable,Lm(t,o)),u=t}else t&&(Cm(e,t),u={default:1});if(a)for(const d in o)!xm(d)&&u[d]==null&&delete o[d]},lo=s2;function Hy(e){return Wy(e)}function Wy(e,t){const n=Gh();n.__VUE__=!0;const{insert:i,remove:o,patchProp:a,createElement:u,createText:d,createComment:f,setText:v,setElementText:_,parentNode:x,nextSibling:k,setScopeId:w=Aa,insertStaticContent:N}=e,z=(V,K,ye,ve=null,ee=null,Ge=null,tt=void 0,Ue=null,nt=!!K.dynamicChildren)=>{if(V===K)return;V&&!Jl(V,K)&&(ve=U(V),T(V,ee,Ge,!0),V=null),K.patchFlag===-2&&(nt=!1,K.dynamicChildren=null);const{type:st,ref:Ct,shapeFlag:xt}=K;switch(st){case Qh:W(V,K,ye,ve);break;case Vs:O(V,K,ye,ve);break;case ch:V==null&&Z(K,ye,ve,tt);break;case Qt:J(V,K,ye,ve,ee,Ge,tt,Ue,nt);break;default:xt&1?Ne(V,K,ye,ve,ee,Ge,tt,Ue,nt):xt&6?Ee(V,K,ye,ve,ee,Ge,tt,Ue,nt):(xt&64||xt&128)&&st.process(V,K,ye,ve,ee,Ge,tt,Ue,nt,ce)}Ct!=null&&ee&&Ah(Ct,V&&V.ref,Ge,K||V,!K)},W=(V,K,ye,ve)=>{if(V==null)i(K.el=d(K.children),ye,ve);else{const ee=K.el=V.el;K.children!==V.children&&v(ee,K.children)}},O=(V,K,ye,ve)=>{V==null?i(K.el=f(K.children||""),ye,ve):K.el=V.el},Z=(V,K,ye,ve)=>{[V.el,V.anchor]=N(V.children,K,ye,ve,V.el,V.anchor)},se=({el:V,anchor:K},ye,ve)=>{let ee;for(;V&&V!==K;)ee=k(V),i(V,ye,ve),V=ee;i(K,ye,ve)},Se=({el:V,anchor:K})=>{let ye;for(;V&&V!==K;)ye=k(V),o(V),V=ye;o(K)},Ne=(V,K,ye,ve,ee,Ge,tt,Ue,nt)=>{K.type==="svg"?tt="svg":K.type==="math"&&(tt="mathml"),V==null?$e(K,ye,ve,ee,Ge,tt,Ue,nt):Be(V,K,ee,Ge,tt,Ue,nt)},$e=(V,K,ye,ve,ee,Ge,tt,Ue)=>{let nt,st;const{props:Ct,shapeFlag:xt,transition:Ot,dirs:$t}=V;if(nt=V.el=u(V.type,Ge,Ct&&Ct.is,Ct),xt&8?_(nt,V.children):xt&16&&xe(V.children,nt,null,ve,ee,Td(V,Ge),tt,Ue),$t&&Gl(V,null,ve,"created"),Pe(nt,V,V.scopeId,tt,ve),Ct){for(const ft in Ct)ft!=="value"&&!uc(ft)&&a(nt,ft,null,Ct[ft],Ge,ve);"value"in Ct&&a(nt,"value",null,Ct.value,Ge),(st=Ct.onVnodeBeforeMount)&&xa(st,ve,V)}$t&&Gl(V,null,ve,"beforeMount");const Gt=Zy(ee,Ot);Gt&&Ot.beforeEnter(nt),i(nt,K,ye),((st=Ct&&Ct.onVnodeMounted)||Gt||$t)&&lo(()=>{st&&xa(st,ve,V),Gt&&Ot.enter(nt),$t&&Gl(V,null,ve,"mounted")},ee)},Pe=(V,K,ye,ve,ee)=>{if(ye&&w(V,ye),ve)for(let Ge=0;Ge<ve.length;Ge++)w(V,ve[Ge]);if(ee){let Ge=ee.subTree;if(K===Ge||Mm(Ge.type)&&(Ge.ssContent===K||Ge.ssFallback===K)){const tt=ee.vnode;Pe(V,tt,tt.scopeId,tt.slotScopeIds,ee.parent)}}},xe=(V,K,ye,ve,ee,Ge,tt,Ue,nt=0)=>{for(let st=nt;st<V.length;st++){const Ct=V[st]=Ue?Pl(V[st]):Sa(V[st]);z(null,Ct,K,ye,ve,ee,Ge,tt,Ue)}},Be=(V,K,ye,ve,ee,Ge,tt)=>{const Ue=K.el=V.el;let{patchFlag:nt,dynamicChildren:st,dirs:Ct}=K;nt|=V.patchFlag&16;const xt=V.props||Li,Ot=K.props||Li;let $t;if(ye&&Hl(ye,!1),($t=Ot.onVnodeBeforeUpdate)&&xa($t,ye,K,V),Ct&&Gl(K,V,ye,"beforeUpdate"),ye&&Hl(ye,!0),(xt.innerHTML&&Ot.innerHTML==null||xt.textContent&&Ot.textContent==null)&&_(Ue,""),st?ze(V.dynamicChildren,st,Ue,ye,ve,Td(K,ee),Ge):tt||Q(V,K,Ue,null,ye,ve,Td(K,ee),Ge,!1),nt>0){if(nt&16)te(Ue,xt,Ot,ye,ee);else if(nt&2&&xt.class!==Ot.class&&a(Ue,"class",null,Ot.class,ee),nt&4&&a(Ue,"style",xt.style,Ot.style,ee),nt&8){const Gt=K.dynamicProps;for(let ft=0;ft<Gt.length;ft++){const Fe=Gt[ft],kt=xt[Fe],Et=Ot[Fe];(Et!==kt||Fe==="value")&&a(Ue,Fe,kt,Et,ee,ye)}}nt&1&&V.children!==K.children&&_(Ue,K.children)}else!tt&&st==null&&te(Ue,xt,Ot,ye,ee);(($t=Ot.onVnodeUpdated)||Ct)&&lo(()=>{$t&&xa($t,ye,K,V),Ct&&Gl(K,V,ye,"updated")},ve)},ze=(V,K,ye,ve,ee,Ge,tt)=>{for(let Ue=0;Ue<K.length;Ue++){const nt=V[Ue],st=K[Ue],Ct=nt.el&&(nt.type===Qt||!Jl(nt,st)||nt.shapeFlag&70)?x(nt.el):ye;z(nt,st,Ct,null,ve,ee,Ge,tt,!0)}},te=(V,K,ye,ve,ee)=>{if(K!==ye){if(K!==Li)for(const Ge in K)!uc(Ge)&&!(Ge in ye)&&a(V,Ge,K[Ge],null,ee,ve);for(const Ge in ye){if(uc(Ge))continue;const tt=ye[Ge],Ue=K[Ge];tt!==Ue&&Ge!=="value"&&a(V,Ge,Ue,tt,ee,ve)}"value"in ye&&a(V,"value",K.value,ye.value,ee)}},J=(V,K,ye,ve,ee,Ge,tt,Ue,nt)=>{const st=K.el=V?V.el:d(""),Ct=K.anchor=V?V.anchor:d("");let{patchFlag:xt,dynamicChildren:Ot,slotScopeIds:$t}=K;$t&&(Ue=Ue?Ue.concat($t):$t),V==null?(i(st,ye,ve),i(Ct,ye,ve),xe(K.children||[],ye,Ct,ee,Ge,tt,Ue,nt)):xt>0&&xt&64&&Ot&&V.dynamicChildren?(ze(V.dynamicChildren,Ot,ye,ee,Ge,tt,Ue),(K.key!=null||ee&&K===ee.subTree)&&km(V,K,!0)):Q(V,K,ye,Ct,ee,Ge,tt,Ue,nt)},Ee=(V,K,ye,ve,ee,Ge,tt,Ue,nt)=>{K.slotScopeIds=Ue,V==null?K.shapeFlag&512?ee.ctx.activate(K,ye,ve,tt,nt):he(K,ye,ve,ee,Ge,tt,nt):P(V,K,nt)},he=(V,K,ye,ve,ee,Ge,tt)=>{const Ue=V.component=d2(V,ve,ee);if(Zh(V)&&(Ue.ctx.renderer=ce),p2(Ue,!1,tt),Ue.asyncDep){if(ee&&ee.registerDep(Ue,F,tt),!V.el){const nt=Ue.subTree=Ci(Vs);O(null,nt,K,ye)}}else F(Ue,V,K,ye,ee,Ge,tt)},P=(V,K,ye)=>{const ve=K.component=V.component;if(i2(V,K,ye))if(ve.asyncDep&&!ve.asyncResolved){G(ve,K,ye);return}else ve.next=K,ve.update();else K.el=V.el,ve.vnode=K},F=(V,K,ye,ve,ee,Ge,tt)=>{const Ue=()=>{if(V.isMounted){let{next:xt,bu:Ot,u:$t,parent:Gt,vnode:ft}=V;{const et=Sm(V);if(et){xt&&(xt.el=ft.el,G(V,xt,tt)),et.asyncDep.then(()=>{V.isUnmounted||Ue()});return}}let Fe=xt,kt;Hl(V,!1),xt?(xt.el=ft.el,G(V,xt,tt)):xt=ft,Ot&&lh(Ot),(kt=xt.props&&xt.props.onVnodeBeforeUpdate)&&xa(kt,Gt,xt,ft),Hl(V,!0);const Et=Ip(V),At=V.subTree;V.subTree=Et,z(At,Et,x(At.el),U(At),V,ee,Ge),xt.el=Et.el,Fe===null&&r2(V,Et.el),$t&&lo($t,ee),(kt=xt.props&&xt.props.onVnodeUpdated)&&lo(()=>xa(kt,Gt,xt,ft),ee)}else{let xt;const{el:Ot,props:$t}=K,{bm:Gt,m:ft,parent:Fe,root:kt,type:Et}=V,At=dc(K);Hl(V,!1),Gt&&lh(Gt),!At&&(xt=$t&&$t.onVnodeBeforeMount)&&xa(xt,Fe,K),Hl(V,!0);{kt.ce&&kt.ce._injectChildStyle(Et);const et=V.subTree=Ip(V);z(null,et,ye,ve,V,ee,Ge),K.el=et.el}if(ft&&lo(ft,ee),!At&&(xt=$t&&$t.onVnodeMounted)){const et=K;lo(()=>xa(xt,Fe,et),ee)}(K.shapeFlag&256||Fe&&dc(Fe.vnode)&&Fe.vnode.shapeFlag&256)&&V.a&&lo(V.a,ee),V.isMounted=!0,K=ye=ve=null}};V.scope.on();const nt=V.effect=new Ig(Ue);V.scope.off();const st=V.update=nt.run.bind(nt),Ct=V.job=nt.runIfDirty.bind(nt);Ct.i=V,Ct.id=V.uid,nt.scheduler=()=>ep(Ct),Hl(V,!0),st()},G=(V,K,ye)=>{K.component=V;const ve=V.vnode.props;V.vnode=K,V.next=null,Uy(V,K.props,ve,ye),Gy(V,K.children,ye),Il(),Ep(V),Fl()},Q=(V,K,ye,ve,ee,Ge,tt,Ue,nt=!1)=>{const st=V&&V.children,Ct=V?V.shapeFlag:0,xt=K.children,{patchFlag:Ot,shapeFlag:$t}=K;if(Ot>0){if(Ot&128){oe(st,xt,ye,ve,ee,Ge,tt,Ue,nt);return}else if(Ot&256){Ae(st,xt,ye,ve,ee,Ge,tt,Ue,nt);return}}$t&8?(Ct&16&&R(st,ee,Ge),xt!==st&&_(ye,xt)):Ct&16?$t&16?oe(st,xt,ye,ve,ee,Ge,tt,Ue,nt):R(st,ee,Ge,!0):(Ct&8&&_(ye,""),$t&16&&xe(xt,ye,ve,ee,Ge,tt,Ue,nt))},Ae=(V,K,ye,ve,ee,Ge,tt,Ue,nt)=>{V=V||Nu,K=K||Nu;const st=V.length,Ct=K.length,xt=Math.min(st,Ct);let Ot;for(Ot=0;Ot<xt;Ot++){const $t=K[Ot]=nt?Pl(K[Ot]):Sa(K[Ot]);z(V[Ot],$t,ye,null,ee,Ge,tt,Ue,nt)}st>Ct?R(V,ee,Ge,!0,!1,xt):xe(K,ye,ve,ee,Ge,tt,Ue,nt,xt)},oe=(V,K,ye,ve,ee,Ge,tt,Ue,nt)=>{let st=0;const Ct=K.length;let xt=V.length-1,Ot=Ct-1;for(;st<=xt&&st<=Ot;){const $t=V[st],Gt=K[st]=nt?Pl(K[st]):Sa(K[st]);if(Jl($t,Gt))z($t,Gt,ye,null,ee,Ge,tt,Ue,nt);else break;st++}for(;st<=xt&&st<=Ot;){const $t=V[xt],Gt=K[Ot]=nt?Pl(K[Ot]):Sa(K[Ot]);if(Jl($t,Gt))z($t,Gt,ye,null,ee,Ge,tt,Ue,nt);else break;xt--,Ot--}if(st>xt){if(st<=Ot){const $t=Ot+1,Gt=$t<Ct?K[$t].el:ve;for(;st<=Ot;)z(null,K[st]=nt?Pl(K[st]):Sa(K[st]),ye,Gt,ee,Ge,tt,Ue,nt),st++}}else if(st>Ot)for(;st<=xt;)T(V[st],ee,Ge,!0),st++;else{const $t=st,Gt=st,ft=new Map;for(st=Gt;st<=Ot;st++){const Zt=K[st]=nt?Pl(K[st]):Sa(K[st]);Zt.key!=null&&ft.set(Zt.key,st)}let Fe,kt=0;const Et=Ot-Gt+1;let At=!1,et=0;const ot=new Array(Et);for(st=0;st<Et;st++)ot[st]=0;for(st=$t;st<=xt;st++){const Zt=V[st];if(kt>=Et){T(Zt,ee,Ge,!0);continue}let rn;if(Zt.key!=null)rn=ft.get(Zt.key);else for(Fe=Gt;Fe<=Ot;Fe++)if(ot[Fe-Gt]===0&&Jl(Zt,K[Fe])){rn=Fe;break}rn===void 0?T(Zt,ee,Ge,!0):(ot[rn-Gt]=st+1,rn>=et?et=rn:At=!0,z(Zt,K[rn],ye,null,ee,Ge,tt,Ue,nt),kt++)}const wn=At?Ky(ot):Nu;for(Fe=wn.length-1,st=Et-1;st>=0;st--){const Zt=Gt+st,rn=K[Zt],Gn=Zt+1<Ct?K[Zt+1].el:ve;ot[st]===0?z(null,rn,ye,Gn,ee,Ge,tt,Ue,nt):At&&(Fe<0||st!==wn[Fe]?me(rn,ye,Gn,2):Fe--)}}},me=(V,K,ye,ve,ee=null)=>{const{el:Ge,type:tt,transition:Ue,children:nt,shapeFlag:st}=V;if(st&6){me(V.component.subTree,K,ye,ve);return}if(st&128){V.suspense.move(K,ye,ve);return}if(st&64){tt.move(V,K,ye,ce);return}if(tt===Qt){i(Ge,K,ye);for(let xt=0;xt<nt.length;xt++)me(nt[xt],K,ye,ve);i(V.anchor,K,ye);return}if(tt===ch){se(V,K,ye);return}if(ve!==2&&st&1&&Ue)if(ve===0)Ue.beforeEnter(Ge),i(Ge,K,ye),lo(()=>Ue.enter(Ge),ee);else{const{leave:xt,delayLeave:Ot,afterLeave:$t}=Ue,Gt=()=>i(Ge,K,ye),ft=()=>{xt(Ge,()=>{Gt(),$t&&$t()})};Ot?Ot(Ge,Gt,ft):ft()}else i(Ge,K,ye)},T=(V,K,ye,ve=!1,ee=!1)=>{const{type:Ge,props:tt,ref:Ue,children:nt,dynamicChildren:st,shapeFlag:Ct,patchFlag:xt,dirs:Ot,cacheIndex:$t}=V;if(xt===-2&&(ee=!1),Ue!=null&&Ah(Ue,null,ye,V,!0),$t!=null&&(K.renderCache[$t]=void 0),Ct&256){K.ctx.deactivate(V);return}const Gt=Ct&1&&Ot,ft=!dc(V);let Fe;if(ft&&(Fe=tt&&tt.onVnodeBeforeUnmount)&&xa(Fe,K,V),Ct&6)q(V.component,ye,ve);else{if(Ct&128){V.suspense.unmount(ye,ve);return}Gt&&Gl(V,null,K,"beforeUnmount"),Ct&64?V.type.remove(V,K,ye,ce,ve):st&&!st.hasOnce&&(Ge!==Qt||xt>0&&xt&64)?R(st,K,ye,!1,!0):(Ge===Qt&&xt&384||!ee&&Ct&16)&&R(nt,K,ye),ve&&ne(V)}(ft&&(Fe=tt&&tt.onVnodeUnmounted)||Gt)&&lo(()=>{Fe&&xa(Fe,K,V),Gt&&Gl(V,null,K,"unmounted")},ye)},ne=V=>{const{type:K,el:ye,anchor:ve,transition:ee}=V;if(K===Qt){ae(ye,ve);return}if(K===ch){Se(V);return}const Ge=()=>{o(ye),ee&&!ee.persisted&&ee.afterLeave&&ee.afterLeave()};if(V.shapeFlag&1&&ee&&!ee.persisted){const{leave:tt,delayLeave:Ue}=ee,nt=()=>tt(ye,Ge);Ue?Ue(V.el,Ge,nt):nt()}else Ge()},ae=(V,K)=>{let ye;for(;V!==K;)ye=k(V),o(V),V=ye;o(K)},q=(V,K,ye)=>{const{bum:ve,scope:ee,job:Ge,subTree:tt,um:Ue,m:nt,a:st}=V;Op(nt),Op(st),ve&&lh(ve),ee.stop(),Ge&&(Ge.flags|=8,T(tt,V,K,ye)),Ue&&lo(Ue,K),lo(()=>{V.isUnmounted=!0},K),K&&K.pendingBranch&&!K.isUnmounted&&V.asyncDep&&!V.asyncResolved&&V.suspenseId===K.pendingId&&(K.deps--,K.deps===0&&K.resolve())},R=(V,K,ye,ve=!1,ee=!1,Ge=0)=>{for(let tt=Ge;tt<V.length;tt++)T(V[tt],K,ye,ve,ee)},U=V=>{if(V.shapeFlag&6)return U(V.component.subTree);if(V.shapeFlag&128)return V.suspense.next();const K=k(V.anchor||V.el),ye=K&&K[fy];return ye?k(ye):K};let H=!1;const $=(V,K,ye)=>{V==null?K._vnode&&T(K._vnode,null,null,!0):z(K._vnode||null,V,K,null,null,null,ye),K._vnode=V,H||(H=!0,Ep(),im(),H=!1)},ce={p:z,um:T,m:me,r:ne,mt:he,mc:xe,pc:Q,pbc:ze,n:U,o:e};return{render:$,hydrate:void 0,createApp:Fy($)}}function Td({type:e,props:t},n){return n==="svg"&&e==="foreignObject"||n==="mathml"&&e==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:n}function Hl({effect:e,job:t},n){n?(e.flags|=32,t.flags|=4):(e.flags&=-33,t.flags&=-5)}function Zy(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}function km(e,t,n=!1){const i=e.children,o=t.children;if(vn(i)&&vn(o))for(let a=0;a<i.length;a++){const u=i[a];let d=o[a];d.shapeFlag&1&&!d.dynamicChildren&&((d.patchFlag<=0||d.patchFlag===32)&&(d=o[a]=Pl(o[a]),d.el=u.el),!n&&d.patchFlag!==-2&&km(u,d)),d.type===Qh&&(d.el=u.el)}}function Ky(e){const t=e.slice(),n=[0];let i,o,a,u,d;const f=e.length;for(i=0;i<f;i++){const v=e[i];if(v!==0){if(o=n[n.length-1],e[o]<v){t[i]=o,n.push(i);continue}for(a=0,u=n.length-1;a<u;)d=a+u>>1,e[n[d]]<v?a=d+1:u=d;v<e[n[a]]&&(a>0&&(t[i]=n[a-1]),n[a]=i)}}for(a=n.length,u=n[a-1];a-- >0;)n[a]=u,u=t[u];return n}function Sm(e){const t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:Sm(t)}function Op(e){if(e)for(let t=0;t<e.length;t++)e[t].flags|=8}const Yy=Symbol.for("v-scx"),Jy=()=>Do(Yy);function hf(e,t){return np(e,null,t)}function Qi(e,t,n){return np(e,t,n)}function np(e,t,n=Li){const{immediate:i,deep:o,flush:a,once:u}=n,d=Fr({},n),f=t&&i||!t&&a!=="post";let v;if(Sc){if(a==="sync"){const w=Jy();v=w.__watcherHandles||(w.__watcherHandles=[])}else if(!f){const w=()=>{};return w.stop=Aa,w.resume=Aa,w.pause=Aa,w}}const _=Ir;d.call=(w,N,z)=>na(w,_,N,z);let x=!1;a==="post"?d.scheduler=w=>{lo(w,_&&_.suspense)}:a!=="sync"&&(x=!0,d.scheduler=(w,N)=>{N?w():ep(w)}),d.augmentJob=w=>{t&&(w.flags|=4),x&&(w.flags|=2,_&&(w.id=_.uid,w.i=_))};const k=uy(e,t,d);return Sc&&(v?v.push(k):f&&k()),k}function Xy(e,t,n){const i=this.proxy,o=or(e)?e.includes(".")?Em(i,e):()=>i[e]:e.bind(i,i);let a;Bn(t)?a=t:(a=t.handler,n=t);const u=Fc(this),d=np(o,a.bind(i),n);return u(),d}function Em(e,t){const n=t.split(".");return()=>{let i=e;for(let o=0;o<n.length&&i;o++)i=i[n[o]];return i}}const Qy=(e,t)=>t==="modelValue"||t==="model-value"?e.modelModifiers:e[`${t}Modifiers`]||e[`${Oo(t)}Modifiers`]||e[`${cu(t)}Modifiers`];function e2(e,t,...n){if(e.isUnmounted)return;const i=e.vnode.props||Li;let o=n;const a=t.startsWith("update:"),u=a&&Qy(i,t.slice(7));u&&(u.trim&&(o=n.map(_=>or(_)?_.trim():_)),u.number&&(o=n.map(Ch)));let d,f=i[d=Pd(t)]||i[d=Pd(Oo(t))];!f&&a&&(f=i[d=Pd(cu(t))]),f&&na(f,e,6,o);const v=i[d+"Once"];if(v){if(!e.emitted)e.emitted={};else if(e.emitted[d])return;e.emitted[d]=!0,na(v,e,6,o)}}function Am(e,t,n=!1){const i=t.emitsCache,o=i.get(e);if(o!==void 0)return o;const a=e.emits;let u={},d=!1;if(!Bn(e)){const f=v=>{const _=Am(v,t,!0);_&&(d=!0,Fr(u,_))};!n&&t.mixins.length&&t.mixins.forEach(f),e.extends&&f(e.extends),e.mixins&&e.mixins.forEach(f)}return!a&&!d?(Pi(e)&&i.set(e,null),null):(vn(a)?a.forEach(f=>u[f]=null):Fr(u,a),Pi(e)&&i.set(e,u),u)}function Xh(e,t){return!e||!$h(t)?!1:(t=t.slice(2).replace(/Once$/,""),fi(e,t[0].toLowerCase()+t.slice(1))||fi(e,cu(t))||fi(e,t))}function Ip(e){const{type:t,vnode:n,proxy:i,withProxy:o,propsOptions:[a],slots:u,attrs:d,emit:f,render:v,renderCache:_,props:x,data:k,setupState:w,ctx:N,inheritAttrs:z}=e,W=Eh(e);let O,Z;try{if(n.shapeFlag&4){const Se=o||i,Ne=Se;O=Sa(v.call(Ne,Se,_,x,w,k,N)),Z=d}else{const Se=t;O=Sa(Se.length>1?Se(x,{attrs:d,slots:u,emit:f}):Se(x,null)),Z=t.props?d:t2(d)}}catch(Se){pc.length=0,Wh(Se,e,1),O=Ci(Vs)}let se=O;if(Z&&z!==!1){const Se=Object.keys(Z),{shapeFlag:Ne}=se;Se.length&&Ne&7&&(a&&Se.some($f)&&(Z=n2(Z,a)),se=Nl(se,Z,!1,!0))}return n.dirs&&(se=Nl(se,null,!1,!0),se.dirs=se.dirs?se.dirs.concat(n.dirs):n.dirs),n.transition&&Pc(se,n.transition),O=se,Eh(W),O}const t2=e=>{let t;for(const n in e)(n==="class"||n==="style"||$h(n))&&((t||(t={}))[n]=e[n]);return t},n2=(e,t)=>{const n={};for(const i in e)(!$f(i)||!(i.slice(9)in t))&&(n[i]=e[i]);return n};function i2(e,t,n){const{props:i,children:o,component:a}=e,{props:u,children:d,patchFlag:f}=t,v=a.emitsOptions;if(t.dirs||t.transition)return!0;if(n&&f>=0){if(f&1024)return!0;if(f&16)return i?Fp(i,u,v):!!u;if(f&8){const _=t.dynamicProps;for(let x=0;x<_.length;x++){const k=_[x];if(u[k]!==i[k]&&!Xh(v,k))return!0}}}else return(o||d)&&(!d||!d.$stable)?!0:i===u?!1:i?u?Fp(i,u,v):!0:!!u;return!1}function Fp(e,t,n){const i=Object.keys(t);if(i.length!==Object.keys(e).length)return!0;for(let o=0;o<i.length;o++){const a=i[o];if(t[a]!==e[a]&&!Xh(n,a))return!0}return!1}function r2({vnode:e,parent:t},n){for(;t;){const i=t.subTree;if(i.suspense&&i.suspense.activeBranch===e&&(i.el=e.el),i===e)(e=t.vnode).el=n,t=t.parent;else break}}const Mm=e=>e.__isSuspense;function s2(e,t){t&&t.pendingBranch?vn(e)?t.effects.push(...e):t.effects.push(e):dy(e)}const Qt=Symbol.for("v-fgt"),Qh=Symbol.for("v-txt"),Vs=Symbol.for("v-cmt"),ch=Symbol.for("v-stc"),pc=[];let ho=null;function Ie(e=!1){pc.push(ho=e?null:[])}function o2(){pc.pop(),ho=pc[pc.length-1]||null}let kc=1;function jp(e,t=!1){kc+=e,e<0&&ho&&t&&(ho.hasOnce=!0)}function Bm(e){return e.dynamicChildren=kc>0?ho||Nu:null,o2(),kc>0&&ho&&ho.push(e),e}function je(e,t,n,i,o,a){return Bm(A(e,t,n,i,o,a,!0))}function Al(e,t,n,i,o){return Bm(Ci(e,t,n,i,o,!0))}function Bh(e){return e?e.__v_isVNode===!0:!1}function Jl(e,t){return e.type===t.type&&e.key===t.key}const Tm=({key:e})=>e??null,hh=({ref:e,ref_key:t,ref_for:n})=>(typeof e=="number"&&(e=""+e),e!=null?or(e)||sr(e)||Bn(e)?{i:Ss,r:e,k:t,f:!!n}:e:null);function A(e,t=null,n=null,i=0,o=null,a=e===Qt?0:1,u=!1,d=!1){const f={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&Tm(t),ref:t&&hh(t),scopeId:sm,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:a,patchFlag:i,dynamicProps:o,dynamicChildren:null,appContext:null,ctx:Ss};return d?(ip(f,n),a&128&&e.normalize(f)):n&&(f.shapeFlag|=or(n)?8:16),kc>0&&!u&&ho&&(f.patchFlag>0||a&6)&&f.patchFlag!==32&&ho.push(f),f}const Ci=a2;function a2(e,t=null,n=null,i=0,o=null,a=!1){if((!e||e===Ay)&&(e=Vs),Bh(e)){const d=Nl(e,t,!0);return n&&ip(d,n),kc>0&&!a&&ho&&(d.shapeFlag&6?ho[ho.indexOf(e)]=d:ho.push(d)),d.patchFlag=-2,d}if(_2(e)&&(e=e.__vccOpts),t){t=l2(t);let{class:d,style:f}=t;d&&!or(d)&&(t.class=zi(d)),Pi(f)&&(Xf(f)&&!vn(f)&&(f=Fr({},f)),t.style=Oc(f))}const u=or(e)?1:Mm(e)?128:om(e)?64:Pi(e)?4:Bn(e)?2:0;return A(e,t,n,i,o,u,a,!0)}function l2(e){return e?Xf(e)||_m(e)?Fr({},e):e:null}function Nl(e,t,n=!1,i=!1){const{props:o,ref:a,patchFlag:u,children:d,transition:f}=e,v=t?u2(o||{},t):o,_={__v_isVNode:!0,__v_skip:!0,type:e.type,props:v,key:v&&Tm(v),ref:t&&t.ref?n&&a?vn(a)?a.concat(hh(t)):[a,hh(t)]:hh(t):a,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:d,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==Qt?u===-1?16:u|16:u,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:f,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&Nl(e.ssContent),ssFallback:e.ssFallback&&Nl(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return f&&i&&Pc(_,f.clone(_)),_}function vi(e=" ",t=0){return Ci(Qh,null,e,t)}function gc(e,t){const n=Ci(ch,null,e);return n.staticCount=t,n}function Wt(e="",t=!1){return t?(Ie(),Al(Vs,null,e)):Ci(Vs,null,e)}function Sa(e){return e==null||typeof e=="boolean"?Ci(Vs):vn(e)?Ci(Qt,null,e.slice()):Bh(e)?Pl(e):Ci(Qh,null,String(e))}function Pl(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:Nl(e)}function ip(e,t){let n=0;const{shapeFlag:i}=e;if(t==null)t=null;else if(vn(t))n=16;else if(typeof t=="object")if(i&65){const o=t.default;o&&(o._c&&(o._d=!1),ip(e,o()),o._c&&(o._d=!0));return}else{n=32;const o=t._;!o&&!_m(t)?t._ctx=Ss:o===3&&Ss&&(Ss.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else Bn(t)?(t={default:t,_ctx:Ss},n=32):(t=String(t),i&64?(n=16,t=[vi(t)]):n=8);e.children=t,e.shapeFlag|=n}function u2(...e){const t={};for(let n=0;n<e.length;n++){const i=e[n];for(const o in i)if(o==="class")t.class!==i.class&&(t.class=zi([t.class,i.class]));else if(o==="style")t.style=Oc([t.style,i.style]);else if($h(o)){const a=t[o],u=i[o];u&&a!==u&&!(vn(a)&&a.includes(u))&&(t[o]=a?[].concat(a,u):u)}else o!==""&&(t[o]=i[o])}return t}function xa(e,t,n,i=null){na(e,t,7,[n,i])}const c2=mm();let h2=0;function d2(e,t,n){const i=e.type,o=(t?t.appContext:e.appContext)||c2,a={uid:h2++,vnode:e,type:i,parent:t,appContext:o,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new Dg(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(o.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:wm(i,o),emitsOptions:Am(i,o),emit:null,emitted:null,propsDefaults:Li,inheritAttrs:i.inheritAttrs,ctx:Li,data:Li,props:Li,attrs:Li,slots:Li,refs:Li,setupState:Li,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return a.ctx={_:a},a.root=t?t.root:a,a.emit=e2.bind(null,a),e.ce&&e.ce(a),a}let Ir=null;const f2=()=>Ir||Ss;let Th,df;{const e=Gh(),t=(n,i)=>{let o;return(o=e[n])||(o=e[n]=[]),o.push(i),a=>{o.length>1?o.forEach(u=>u(a)):o[0](a)}};Th=t("__VUE_INSTANCE_SETTERS__",n=>Ir=n),df=t("__VUE_SSR_SETTERS__",n=>Sc=n)}const Fc=e=>{const t=Ir;return Th(e),e.scope.on(),()=>{e.scope.off(),Th(t)}},zp=()=>{Ir&&Ir.scope.off(),Th(null)};function Nm(e){return e.vnode.shapeFlag&4}let Sc=!1;function p2(e,t=!1,n=!1){t&&df(t);const{props:i,children:o}=e.vnode,a=Nm(e);zy(e,i,a,t),Vy(e,o,n);const u=a?g2(e,t):void 0;return t&&df(!1),u}function g2(e,t){const n=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,By);const{setup:i}=n;if(i){Il();const o=e.setupContext=i.length>1?v2(e):null,a=Fc(e),u=Ic(i,e,0,[e.props,o]),d=Sg(u);if(Fl(),a(),(d||e.sp)&&!dc(e)&&dm(e),d){if(u.then(zp,zp),t)return u.then(f=>{Up(e,f)}).catch(f=>{Wh(f,e,0)});e.asyncDep=u}else Up(e,u)}else Dm(e)}function Up(e,t,n){Bn(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:Pi(t)&&(e.setupState=em(t)),Dm(e)}function Dm(e,t,n){const i=e.type;e.render||(e.render=i.render||Aa);{const o=Fc(e);Il();try{Ty(e)}finally{Fl(),o()}}}const m2={get(e,t){return ls(e,"get",""),e[t]}};function v2(e){const t=n=>{e.exposed=n||{}};return{attrs:new Proxy(e.attrs,m2),slots:e.slots,emit:e.emit,expose:t}}function ed(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(em(Qf(e.exposed)),{get(t,n){if(n in t)return t[n];if(n in fc)return fc[n](e)},has(t,n){return n in t||n in fc}})):e.proxy}function y2(e,t=!0){return Bn(e)?e.displayName||e.name:e.name||t&&e.__name}function _2(e){return Bn(e)&&"__vccOpts"in e}const jn=(e,t)=>ay(e,t,Sc);function rp(e,t,n){const i=arguments.length;return i===2?Pi(t)&&!vn(t)?Bh(t)?Ci(e,null,[t]):Ci(e,t):Ci(e,null,t):(i>3?n=Array.prototype.slice.call(arguments,2):i===3&&Bh(n)&&(n=[n]),Ci(e,t,n))}const b2="3.5.13";/**
* @vue/runtime-dom v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let ff;const $p=typeof window<"u"&&window.trustedTypes;if($p)try{ff=$p.createPolicy("vue",{createHTML:e=>e})}catch{}const Rm=ff?e=>ff.createHTML(e):e=>e,w2="http://www.w3.org/2000/svg",x2="http://www.w3.org/1998/Math/MathML",Xa=typeof document<"u"?document:null,qp=Xa&&Xa.createElement("template"),L2={insert:(e,t,n)=>{t.insertBefore(e,n||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,n,i)=>{const o=t==="svg"?Xa.createElementNS(w2,e):t==="mathml"?Xa.createElementNS(x2,e):n?Xa.createElement(e,{is:n}):Xa.createElement(e);return e==="select"&&i&&i.multiple!=null&&o.setAttribute("multiple",i.multiple),o},createText:e=>Xa.createTextNode(e),createComment:e=>Xa.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>Xa.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,n,i,o,a){const u=n?n.previousSibling:t.lastChild;if(o&&(o===a||o.nextSibling))for(;t.insertBefore(o.cloneNode(!0),n),!(o===a||!(o=o.nextSibling)););else{qp.innerHTML=Rm(i==="svg"?`<svg>${e}</svg>`:i==="mathml"?`<math>${e}</math>`:e);const d=qp.content;if(i==="svg"||i==="mathml"){const f=d.firstChild;for(;f.firstChild;)d.appendChild(f.firstChild);d.removeChild(f)}t.insertBefore(d,n)}return[u?u.nextSibling:t.firstChild,n?n.previousSibling:t.lastChild]}},yl="transition",Qu="animation",Ec=Symbol("_vtc"),Om={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},C2=Fr({},am,Om),P2=e=>(e.displayName="Transition",e.props=C2,e),Nh=P2((e,{slots:t})=>rp(my,k2(e),t)),Wl=(e,t=[])=>{vn(e)?e.forEach(n=>n(...t)):e&&e(...t)},Vp=e=>e?vn(e)?e.some(t=>t.length>1):e.length>1:!1;function k2(e){const t={};for(const J in e)J in Om||(t[J]=e[J]);if(e.css===!1)return t;const{name:n="v",type:i,duration:o,enterFromClass:a=`${n}-enter-from`,enterActiveClass:u=`${n}-enter-active`,enterToClass:d=`${n}-enter-to`,appearFromClass:f=a,appearActiveClass:v=u,appearToClass:_=d,leaveFromClass:x=`${n}-leave-from`,leaveActiveClass:k=`${n}-leave-active`,leaveToClass:w=`${n}-leave-to`}=e,N=S2(o),z=N&&N[0],W=N&&N[1],{onBeforeEnter:O,onEnter:Z,onEnterCancelled:se,onLeave:Se,onLeaveCancelled:Ne,onBeforeAppear:$e=O,onAppear:Pe=Z,onAppearCancelled:xe=se}=t,Be=(J,Ee,he,P)=>{J._enterCancelled=P,Zl(J,Ee?_:d),Zl(J,Ee?v:u),he&&he()},ze=(J,Ee)=>{J._isLeaving=!1,Zl(J,x),Zl(J,w),Zl(J,k),Ee&&Ee()},te=J=>(Ee,he)=>{const P=J?Pe:Z,F=()=>Be(Ee,J,he);Wl(P,[Ee,F]),Gp(()=>{Zl(Ee,J?f:a),Ka(Ee,J?_:d),Vp(P)||Hp(Ee,i,z,F)})};return Fr(t,{onBeforeEnter(J){Wl(O,[J]),Ka(J,a),Ka(J,u)},onBeforeAppear(J){Wl($e,[J]),Ka(J,f),Ka(J,v)},onEnter:te(!1),onAppear:te(!0),onLeave(J,Ee){J._isLeaving=!0;const he=()=>ze(J,Ee);Ka(J,x),J._enterCancelled?(Ka(J,k),Kp()):(Kp(),Ka(J,k)),Gp(()=>{J._isLeaving&&(Zl(J,x),Ka(J,w),Vp(Se)||Hp(J,i,W,he))}),Wl(Se,[J,he])},onEnterCancelled(J){Be(J,!1,void 0,!0),Wl(se,[J])},onAppearCancelled(J){Be(J,!0,void 0,!0),Wl(xe,[J])},onLeaveCancelled(J){ze(J),Wl(Ne,[J])}})}function S2(e){if(e==null)return null;if(Pi(e))return[Nd(e.enter),Nd(e.leave)];{const t=Nd(e);return[t,t]}}function Nd(e){return kv(e)}function Ka(e,t){t.split(/\s+/).forEach(n=>n&&e.classList.add(n)),(e[Ec]||(e[Ec]=new Set)).add(t)}function Zl(e,t){t.split(/\s+/).forEach(i=>i&&e.classList.remove(i));const n=e[Ec];n&&(n.delete(t),n.size||(e[Ec]=void 0))}function Gp(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let E2=0;function Hp(e,t,n,i){const o=e._endId=++E2,a=()=>{o===e._endId&&i()};if(n!=null)return setTimeout(a,n);const{type:u,timeout:d,propCount:f}=A2(e,t);if(!u)return i();const v=u+"end";let _=0;const x=()=>{e.removeEventListener(v,k),a()},k=w=>{w.target===e&&++_>=f&&x()};setTimeout(()=>{_<f&&x()},d+1),e.addEventListener(v,k)}function A2(e,t){const n=window.getComputedStyle(e),i=N=>(n[N]||"").split(", "),o=i(`${yl}Delay`),a=i(`${yl}Duration`),u=Wp(o,a),d=i(`${Qu}Delay`),f=i(`${Qu}Duration`),v=Wp(d,f);let _=null,x=0,k=0;t===yl?u>0&&(_=yl,x=u,k=a.length):t===Qu?v>0&&(_=Qu,x=v,k=f.length):(x=Math.max(u,v),_=x>0?u>v?yl:Qu:null,k=_?_===yl?a.length:f.length:0);const w=_===yl&&/\b(transform|all)(,|$)/.test(i(`${yl}Property`).toString());return{type:_,timeout:x,propCount:k,hasTransform:w}}function Wp(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map((n,i)=>Zp(n)+Zp(e[i])))}function Zp(e){return e==="auto"?0:Number(e.slice(0,-1).replace(",","."))*1e3}function Kp(){return document.body.offsetHeight}function M2(e,t,n){const i=e[Ec];i&&(t=(t?[t,...i]:[...i]).join(" ")),t==null?e.removeAttribute("class"):n?e.setAttribute("class",t):e.className=t}const Dh=Symbol("_vod"),Im=Symbol("_vsh"),dh={beforeMount(e,{value:t},{transition:n}){e[Dh]=e.style.display==="none"?"":e.style.display,n&&t?n.beforeEnter(e):ec(e,t)},mounted(e,{value:t},{transition:n}){n&&t&&n.enter(e)},updated(e,{value:t,oldValue:n},{transition:i}){!t!=!n&&(i?t?(i.beforeEnter(e),ec(e,!0),i.enter(e)):i.leave(e,()=>{ec(e,!1)}):ec(e,t))},beforeUnmount(e,{value:t}){ec(e,t)}};function ec(e,t){e.style.display=t?e[Dh]:"none",e[Im]=!t}const B2=Symbol(""),T2=/(^|;)\s*display\s*:/;function N2(e,t,n){const i=e.style,o=or(n);let a=!1;if(n&&!o){if(t)if(or(t))for(const u of t.split(";")){const d=u.slice(0,u.indexOf(":")).trim();n[d]==null&&fh(i,d,"")}else for(const u in t)n[u]==null&&fh(i,u,"");for(const u in n)u==="display"&&(a=!0),fh(i,u,n[u])}else if(o){if(t!==n){const u=i[B2];u&&(n+=";"+u),i.cssText=n,a=T2.test(n)}}else t&&e.removeAttribute("style");Dh in e&&(e[Dh]=a?i.display:"",e[Im]&&(i.display="none"))}const Yp=/\s*!important$/;function fh(e,t,n){if(vn(n))n.forEach(i=>fh(e,t,i));else if(n==null&&(n=""),t.startsWith("--"))e.setProperty(t,n);else{const i=D2(e,t);Yp.test(n)?e.setProperty(cu(i),n.replace(Yp,""),"important"):e[i]=n}}const Jp=["Webkit","Moz","ms"],Dd={};function D2(e,t){const n=Dd[t];if(n)return n;let i=Oo(t);if(i!=="filter"&&i in e)return Dd[t]=i;i=Vh(i);for(let o=0;o<Jp.length;o++){const a=Jp[o]+i;if(a in e)return Dd[t]=a}return t}const Xp="http://www.w3.org/1999/xlink";function Qp(e,t,n,i,o,a=Tv(t)){i&&t.startsWith("xlink:")?n==null?e.removeAttributeNS(Xp,t.slice(6,t.length)):e.setAttributeNS(Xp,t,n):n==null||a&&!Bg(n)?e.removeAttribute(t):e.setAttribute(t,a?"":Ba(n)?String(n):n)}function e0(e,t,n,i,o){if(t==="innerHTML"||t==="textContent"){n!=null&&(e[t]=t==="innerHTML"?Rm(n):n);return}const a=e.tagName;if(t==="value"&&a!=="PROGRESS"&&!a.includes("-")){const d=a==="OPTION"?e.getAttribute("value")||"":e.value,f=n==null?e.type==="checkbox"?"on":"":String(n);(d!==f||!("_value"in e))&&(e.value=f),n==null&&e.removeAttribute(t),e._value=n;return}let u=!1;if(n===""||n==null){const d=typeof e[t];d==="boolean"?n=Bg(n):n==null&&d==="string"?(n="",u=!0):d==="number"&&(n=0,u=!0)}try{e[t]=n}catch{}u&&e.removeAttribute(o||t)}function tl(e,t,n,i){e.addEventListener(t,n,i)}function R2(e,t,n,i){e.removeEventListener(t,n,i)}const t0=Symbol("_vei");function O2(e,t,n,i,o=null){const a=e[t0]||(e[t0]={}),u=a[t];if(i&&u)u.value=i;else{const[d,f]=I2(t);if(i){const v=a[t]=z2(i,o);tl(e,d,v,f)}else u&&(R2(e,d,u,f),a[t]=void 0)}}const n0=/(?:Once|Passive|Capture)$/;function I2(e){let t;if(n0.test(e)){t={};let i;for(;i=e.match(n0);)e=e.slice(0,e.length-i[0].length),t[i[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):cu(e.slice(2)),t]}let Rd=0;const F2=Promise.resolve(),j2=()=>Rd||(F2.then(()=>Rd=0),Rd=Date.now());function z2(e,t){const n=i=>{if(!i._vts)i._vts=Date.now();else if(i._vts<=n.attached)return;na(U2(i,n.value),t,5,[i])};return n.value=e,n.attached=j2(),n}function U2(e,t){if(vn(t)){const n=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{n.call(e),e._stopped=!0},t.map(i=>o=>!o._stopped&&i&&i(o))}else return t}const i0=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,$2=(e,t,n,i,o,a)=>{const u=o==="svg";t==="class"?M2(e,i,u):t==="style"?N2(e,n,i):$h(t)?$f(t)||O2(e,t,n,i,a):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):q2(e,t,i,u))?(e0(e,t,i),!e.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&Qp(e,t,i,u,a,t!=="value")):e._isVueCE&&(/[A-Z]/.test(t)||!or(i))?e0(e,Oo(t),i,a,t):(t==="true-value"?e._trueValue=i:t==="false-value"&&(e._falseValue=i),Qp(e,t,i,u))};function q2(e,t,n,i){if(i)return!!(t==="innerHTML"||t==="textContent"||t in e&&i0(t)&&Bn(n));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const o=e.tagName;if(o==="IMG"||o==="VIDEO"||o==="CANVAS"||o==="SOURCE")return!1}return i0(t)&&or(n)?!1:t in e}const Dl=e=>{const t=e.props["onUpdate:modelValue"]||!1;return vn(t)?n=>lh(t,n):t};function V2(e){e.target.composing=!0}function r0(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const Ro=Symbol("_assign"),Zn={created(e,{modifiers:{lazy:t,trim:n,number:i}},o){e[Ro]=Dl(o);const a=i||o.props&&o.props.type==="number";tl(e,t?"change":"input",u=>{if(u.target.composing)return;let d=e.value;n&&(d=d.trim()),a&&(d=Ch(d)),e[Ro](d)}),n&&tl(e,"change",()=>{e.value=e.value.trim()}),t||(tl(e,"compositionstart",V2),tl(e,"compositionend",r0),tl(e,"change",r0))},mounted(e,{value:t}){e.value=t??""},beforeUpdate(e,{value:t,oldValue:n,modifiers:{lazy:i,trim:o,number:a}},u){if(e[Ro]=Dl(u),e.composing)return;const d=(a||e.type==="number")&&!/^0\d/.test(e.value)?Ch(e.value):e.value,f=t??"";d!==f&&(document.activeElement===e&&e.type!=="range"&&(i&&t===n||o&&e.value.trim()===f)||(e.value=f))}},Fm={deep:!0,created(e,t,n){e[Ro]=Dl(n),tl(e,"change",()=>{const i=e._modelValue,o=zu(e),a=e.checked,u=e[Ro];if(vn(i)){const d=Gf(i,o),f=d!==-1;if(a&&!f)u(i.concat(o));else if(!a&&f){const v=[...i];v.splice(d,1),u(v)}}else if(qu(i)){const d=new Set(i);a?d.add(o):d.delete(o),u(d)}else u(jm(e,a))})},mounted:s0,beforeUpdate(e,t,n){e[Ro]=Dl(n),s0(e,t,n)}};function s0(e,{value:t,oldValue:n},i){e._modelValue=t;let o;if(vn(t))o=Gf(t,i.props.value)>-1;else if(qu(t))o=t.has(i.props.value);else{if(t===n)return;o=ou(t,jm(e,!0))}e.checked!==o&&(e.checked=o)}const G2={created(e,{value:t},n){e.checked=ou(t,n.props.value),e[Ro]=Dl(n),tl(e,"change",()=>{e[Ro](zu(e))})},beforeUpdate(e,{value:t,oldValue:n},i){e[Ro]=Dl(i),t!==n&&(e.checked=ou(t,i.props.value))}},vr={deep:!0,created(e,{value:t,modifiers:{number:n}},i){const o=qu(t);tl(e,"change",()=>{const a=Array.prototype.filter.call(e.options,u=>u.selected).map(u=>n?Ch(zu(u)):zu(u));e[Ro](e.multiple?o?new Set(a):a:a[0]),e._assigning=!0,Di(()=>{e._assigning=!1})}),e[Ro]=Dl(i)},mounted(e,{value:t}){o0(e,t)},beforeUpdate(e,t,n){e[Ro]=Dl(n)},updated(e,{value:t}){e._assigning||o0(e,t)}};function o0(e,t){const n=e.multiple,i=vn(t);if(!(n&&!i&&!qu(t))){for(let o=0,a=e.options.length;o<a;o++){const u=e.options[o],d=zu(u);if(n)if(i){const f=typeof d;f==="string"||f==="number"?u.selected=t.some(v=>String(v)===String(d)):u.selected=Gf(t,d)>-1}else u.selected=t.has(d);else if(ou(zu(u),t)){e.selectedIndex!==o&&(e.selectedIndex=o);return}}!n&&e.selectedIndex!==-1&&(e.selectedIndex=-1)}}function zu(e){return"_value"in e?e._value:e.value}function jm(e,t){const n=t?"_trueValue":"_falseValue";return n in e?e[n]:t}const H2={created(e,t,n){th(e,t,n,null,"created")},mounted(e,t,n){th(e,t,n,null,"mounted")},beforeUpdate(e,t,n,i){th(e,t,n,i,"beforeUpdate")},updated(e,t,n,i){th(e,t,n,i,"updated")}};function W2(e,t){switch(e){case"SELECT":return vr;case"TEXTAREA":return Zn;default:switch(t){case"checkbox":return Fm;case"radio":return G2;default:return Zn}}}function th(e,t,n,i,o){const u=W2(e.tagName,n.props&&n.props.type)[o];u&&u(e,t,n,i)}const Z2=["ctrl","shift","alt","meta"],K2={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>Z2.some(n=>e[`${n}Key`]&&!t.includes(n))},td=(e,t)=>{const n=e._withMods||(e._withMods={}),i=t.join(".");return n[i]||(n[i]=(o,...a)=>{for(let u=0;u<t.length;u++){const d=K2[t[u]];if(d&&d(o,t))return}return e(o,...a)})},Y2=Fr({patchProp:$2},L2);let a0;function J2(){return a0||(a0=Hy(Y2))}const X2=(...e)=>{const t=J2().createApp(...e),{mount:n}=t;return t.mount=i=>{const o=e_(i);if(!o)return;const a=t._component;!Bn(a)&&!a.render&&!a.template&&(a.template=o.innerHTML),o.nodeType===1&&(o.textContent="");const u=n(o,!1,Q2(o));return o instanceof Element&&(o.removeAttribute("v-cloak"),o.setAttribute("data-v-app","")),u},t};function Q2(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function e_(e){return or(e)?document.querySelector(e):e}/*!
 * pinia v2.3.1
 * (c) 2025 Eduardo San Martin Morote
 * @license MIT
 */let zm;const nd=e=>zm=e,Um=Symbol();function pf(e){return e&&typeof e=="object"&&Object.prototype.toString.call(e)==="[object Object]"&&typeof e.toJSON!="function"}var mc;(function(e){e.direct="direct",e.patchObject="patch object",e.patchFunction="patch function"})(mc||(mc={}));function t_(){const e=Rg(!0),t=e.run(()=>Dt({}));let n=[],i=[];const o=Qf({install(a){nd(o),o._a=a,a.provide(Um,o),a.config.globalProperties.$pinia=o,i.forEach(u=>n.push(u)),i=[]},use(a){return this._a?n.push(a):i.push(a),this},_p:n,_a:null,_e:e,_s:new Map,state:t});return o}const $m=()=>{};function l0(e,t,n,i=$m){e.push(t);const o=()=>{const a=e.indexOf(t);a>-1&&(e.splice(a,1),i())};return!n&&Og()&&Dv(o),o}function wu(e,...t){e.slice().forEach(n=>{n(...t)})}const n_=e=>e(),u0=Symbol(),Od=Symbol();function gf(e,t){e instanceof Map&&t instanceof Map?t.forEach((n,i)=>e.set(i,n)):e instanceof Set&&t instanceof Set&&t.forEach(e.add,e);for(const n in t){if(!t.hasOwnProperty(n))continue;const i=t[n],o=e[n];pf(o)&&pf(i)&&e.hasOwnProperty(n)&&!sr(i)&&!Tl(i)?e[n]=gf(o,i):e[n]=i}return e}const i_=Symbol();function r_(e){return!pf(e)||!e.hasOwnProperty(i_)}const{assign:xl}=Object;function s_(e){return!!(sr(e)&&e.effect)}function o_(e,t,n,i){const{state:o,actions:a,getters:u}=t,d=n.state.value[e];let f;function v(){d||(n.state.value[e]=o?o():{});const _=iy(n.state.value[e]);return xl(_,a,Object.keys(u||{}).reduce((x,k)=>(x[k]=Qf(jn(()=>{nd(n);const w=n._s.get(e);return u[k].call(w,w)})),x),{}))}return f=qm(e,v,t,n,i,!0),f}function qm(e,t,n={},i,o,a){let u;const d=xl({actions:{}},n),f={deep:!0};let v,_,x=[],k=[],w;const N=i.state.value[e];!a&&!N&&(i.state.value[e]={}),Dt({});let z;function W(xe){let Be;v=_=!1,typeof xe=="function"?(xe(i.state.value[e]),Be={type:mc.patchFunction,storeId:e,events:w}):(gf(i.state.value[e],xe),Be={type:mc.patchObject,payload:xe,storeId:e,events:w});const ze=z=Symbol();Di().then(()=>{z===ze&&(v=!0)}),_=!0,wu(x,Be,i.state.value[e])}const O=a?function(){const{state:Be}=n,ze=Be?Be():{};this.$patch(te=>{xl(te,ze)})}:$m;function Z(){u.stop(),x=[],k=[],i._s.delete(e)}const se=(xe,Be="")=>{if(u0 in xe)return xe[Od]=Be,xe;const ze=function(){nd(i);const te=Array.from(arguments),J=[],Ee=[];function he(G){J.push(G)}function P(G){Ee.push(G)}wu(k,{args:te,name:ze[Od],store:Ne,after:he,onError:P});let F;try{F=xe.apply(this&&this.$id===e?this:Ne,te)}catch(G){throw wu(Ee,G),G}return F instanceof Promise?F.then(G=>(wu(J,G),G)).catch(G=>(wu(Ee,G),Promise.reject(G))):(wu(J,F),F)};return ze[u0]=!0,ze[Od]=Be,ze},Se={_p:i,$id:e,$onAction:l0.bind(null,k),$patch:W,$reset:O,$subscribe(xe,Be={}){const ze=l0(x,xe,Be.detached,()=>te()),te=u.run(()=>Qi(()=>i.state.value[e],J=>{(Be.flush==="sync"?_:v)&&xe({storeId:e,type:mc.direct,events:w},J)},xl({},f,Be)));return ze},$dispose:Z},Ne=il(Se);i._s.set(e,Ne);const Pe=(i._a&&i._a.runWithContext||n_)(()=>i._e.run(()=>(u=Rg()).run(()=>t({action:se}))));for(const xe in Pe){const Be=Pe[xe];if(sr(Be)&&!s_(Be)||Tl(Be))a||(N&&r_(Be)&&(sr(Be)?Be.value=N[xe]:gf(Be,N[xe])),i.state.value[e][xe]=Be);else if(typeof Be=="function"){const ze=se(Be,xe);Pe[xe]=ze,d.actions[xe]=Be}}return xl(Ne,Pe),xl(ii(Ne),Pe),Object.defineProperty(Ne,"$state",{get:()=>i.state.value[e],set:xe=>{W(Be=>{xl(Be,xe)})}}),i._p.forEach(xe=>{xl(Ne,u.run(()=>xe({store:Ne,app:i._a,pinia:i,options:d})))}),N&&a&&n.hydrate&&n.hydrate(Ne.$state,N),v=!0,_=!0,Ne}/*! #__NO_SIDE_EFFECTS__ */function id(e,t,n){let i,o;const a=typeof t=="function";typeof e=="string"?(i=e,o=a?n:t):(o=e,i=e.id);function u(d,f){const v=jy();return d=d||(v?Do(Um,null):null),d&&nd(d),d=zm,d._s.has(i)||(a?qm(i,t,o,d):o_(i,o,d)),d._s.get(i)}return u.$id=i,u}function Vm(e,t){return function(){return e.apply(t,arguments)}}const{toString:a_}=Object.prototype,{getPrototypeOf:sp}=Object,rd=(e=>t=>{const n=a_.call(t);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),ra=e=>(e=e.toLowerCase(),t=>rd(t)===e),sd=e=>t=>typeof t===e,{isArray:Vu}=Array,Ac=sd("undefined");function l_(e){return e!==null&&!Ac(e)&&e.constructor!==null&&!Ac(e.constructor)&&po(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const Gm=ra("ArrayBuffer");function u_(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&Gm(e.buffer),t}const c_=sd("string"),po=sd("function"),Hm=sd("number"),od=e=>e!==null&&typeof e=="object",h_=e=>e===!0||e===!1,ph=e=>{if(rd(e)!=="object")return!1;const t=sp(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},d_=ra("Date"),f_=ra("File"),p_=ra("Blob"),g_=ra("FileList"),m_=e=>od(e)&&po(e.pipe),v_=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||po(e.append)&&((t=rd(e))==="formdata"||t==="object"&&po(e.toString)&&e.toString()==="[object FormData]"))},y_=ra("URLSearchParams"),[__,b_,w_,x_]=["ReadableStream","Request","Response","Headers"].map(ra),L_=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function jc(e,t,{allOwnKeys:n=!1}={}){if(e===null||typeof e>"u")return;let i,o;if(typeof e!="object"&&(e=[e]),Vu(e))for(i=0,o=e.length;i<o;i++)t.call(null,e[i],i,e);else{const a=n?Object.getOwnPropertyNames(e):Object.keys(e),u=a.length;let d;for(i=0;i<u;i++)d=a[i],t.call(null,e[d],d,e)}}function Wm(e,t){t=t.toLowerCase();const n=Object.keys(e);let i=n.length,o;for(;i-- >0;)if(o=n[i],t===o.toLowerCase())return o;return null}const Ql=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Zm=e=>!Ac(e)&&e!==Ql;function mf(){const{caseless:e}=Zm(this)&&this||{},t={},n=(i,o)=>{const a=e&&Wm(t,o)||o;ph(t[a])&&ph(i)?t[a]=mf(t[a],i):ph(i)?t[a]=mf({},i):Vu(i)?t[a]=i.slice():t[a]=i};for(let i=0,o=arguments.length;i<o;i++)arguments[i]&&jc(arguments[i],n);return t}const C_=(e,t,n,{allOwnKeys:i}={})=>(jc(t,(o,a)=>{n&&po(o)?e[a]=Vm(o,n):e[a]=o},{allOwnKeys:i}),e),P_=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),k_=(e,t,n,i)=>{e.prototype=Object.create(t.prototype,i),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},S_=(e,t,n,i)=>{let o,a,u;const d={};if(t=t||{},e==null)return t;do{for(o=Object.getOwnPropertyNames(e),a=o.length;a-- >0;)u=o[a],(!i||i(u,e,t))&&!d[u]&&(t[u]=e[u],d[u]=!0);e=n!==!1&&sp(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},E_=(e,t,n)=>{e=String(e),(n===void 0||n>e.length)&&(n=e.length),n-=t.length;const i=e.indexOf(t,n);return i!==-1&&i===n},A_=e=>{if(!e)return null;if(Vu(e))return e;let t=e.length;if(!Hm(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},M_=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&sp(Uint8Array)),B_=(e,t)=>{const i=(e&&e[Symbol.iterator]).call(e);let o;for(;(o=i.next())&&!o.done;){const a=o.value;t.call(e,a[0],a[1])}},T_=(e,t)=>{let n;const i=[];for(;(n=e.exec(t))!==null;)i.push(n);return i},N_=ra("HTMLFormElement"),D_=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,i,o){return i.toUpperCase()+o}),c0=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),R_=ra("RegExp"),Km=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),i={};jc(n,(o,a)=>{let u;(u=t(o,a,e))!==!1&&(i[a]=u||o)}),Object.defineProperties(e,i)},O_=e=>{Km(e,(t,n)=>{if(po(e)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const i=e[n];if(po(i)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},I_=(e,t)=>{const n={},i=o=>{o.forEach(a=>{n[a]=!0})};return Vu(e)?i(e):i(String(e).split(t)),n},F_=()=>{},j_=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t,Id="abcdefghijklmnopqrstuvwxyz",h0="0123456789",Ym={DIGIT:h0,ALPHA:Id,ALPHA_DIGIT:Id+Id.toUpperCase()+h0},z_=(e=16,t=Ym.ALPHA_DIGIT)=>{let n="";const{length:i}=t;for(;e--;)n+=t[Math.random()*i|0];return n};function U_(e){return!!(e&&po(e.append)&&e[Symbol.toStringTag]==="FormData"&&e[Symbol.iterator])}const $_=e=>{const t=new Array(10),n=(i,o)=>{if(od(i)){if(t.indexOf(i)>=0)return;if(!("toJSON"in i)){t[o]=i;const a=Vu(i)?[]:{};return jc(i,(u,d)=>{const f=n(u,o+1);!Ac(f)&&(a[d]=f)}),t[o]=void 0,a}}return i};return n(e,0)},q_=ra("AsyncFunction"),V_=e=>e&&(od(e)||po(e))&&po(e.then)&&po(e.catch),Jm=((e,t)=>e?setImmediate:t?((n,i)=>(Ql.addEventListener("message",({source:o,data:a})=>{o===Ql&&a===n&&i.length&&i.shift()()},!1),o=>{i.push(o),Ql.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",po(Ql.postMessage)),G_=typeof queueMicrotask<"u"?queueMicrotask.bind(Ql):typeof process<"u"&&process.nextTick||Jm,Pt={isArray:Vu,isArrayBuffer:Gm,isBuffer:l_,isFormData:v_,isArrayBufferView:u_,isString:c_,isNumber:Hm,isBoolean:h_,isObject:od,isPlainObject:ph,isReadableStream:__,isRequest:b_,isResponse:w_,isHeaders:x_,isUndefined:Ac,isDate:d_,isFile:f_,isBlob:p_,isRegExp:R_,isFunction:po,isStream:m_,isURLSearchParams:y_,isTypedArray:M_,isFileList:g_,forEach:jc,merge:mf,extend:C_,trim:L_,stripBOM:P_,inherits:k_,toFlatObject:S_,kindOf:rd,kindOfTest:ra,endsWith:E_,toArray:A_,forEachEntry:B_,matchAll:T_,isHTMLForm:N_,hasOwnProperty:c0,hasOwnProp:c0,reduceDescriptors:Km,freezeMethods:O_,toObjectSet:I_,toCamelCase:D_,noop:F_,toFiniteNumber:j_,findKey:Wm,global:Ql,isContextDefined:Zm,ALPHABET:Ym,generateString:z_,isSpecCompliantForm:U_,toJSONObject:$_,isAsyncFn:q_,isThenable:V_,setImmediate:Jm,asap:G_};function Dn(e,t,n,i,o){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),i&&(this.request=i),o&&(this.response=o,this.status=o.status?o.status:null)}Pt.inherits(Dn,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Pt.toJSONObject(this.config),code:this.code,status:this.status}}});const Xm=Dn.prototype,Qm={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Qm[e]={value:e}});Object.defineProperties(Dn,Qm);Object.defineProperty(Xm,"isAxiosError",{value:!0});Dn.from=(e,t,n,i,o,a)=>{const u=Object.create(Xm);return Pt.toFlatObject(e,u,function(f){return f!==Error.prototype},d=>d!=="isAxiosError"),Dn.call(u,e.message,t,n,i,o),u.cause=e,u.name=e.name,a&&Object.assign(u,a),u};const H_=null;function vf(e){return Pt.isPlainObject(e)||Pt.isArray(e)}function e1(e){return Pt.endsWith(e,"[]")?e.slice(0,-2):e}function d0(e,t,n){return e?e.concat(t).map(function(o,a){return o=e1(o),!n&&a?"["+o+"]":o}).join(n?".":""):t}function W_(e){return Pt.isArray(e)&&!e.some(vf)}const Z_=Pt.toFlatObject(Pt,{},null,function(t){return/^is[A-Z]/.test(t)});function ad(e,t,n){if(!Pt.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,n=Pt.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(z,W){return!Pt.isUndefined(W[z])});const i=n.metaTokens,o=n.visitor||_,a=n.dots,u=n.indexes,f=(n.Blob||typeof Blob<"u"&&Blob)&&Pt.isSpecCompliantForm(t);if(!Pt.isFunction(o))throw new TypeError("visitor must be a function");function v(N){if(N===null)return"";if(Pt.isDate(N))return N.toISOString();if(!f&&Pt.isBlob(N))throw new Dn("Blob is not supported. Use a Buffer instead.");return Pt.isArrayBuffer(N)||Pt.isTypedArray(N)?f&&typeof Blob=="function"?new Blob([N]):Buffer.from(N):N}function _(N,z,W){let O=N;if(N&&!W&&typeof N=="object"){if(Pt.endsWith(z,"{}"))z=i?z:z.slice(0,-2),N=JSON.stringify(N);else if(Pt.isArray(N)&&W_(N)||(Pt.isFileList(N)||Pt.endsWith(z,"[]"))&&(O=Pt.toArray(N)))return z=e1(z),O.forEach(function(se,Se){!(Pt.isUndefined(se)||se===null)&&t.append(u===!0?d0([z],Se,a):u===null?z:z+"[]",v(se))}),!1}return vf(N)?!0:(t.append(d0(W,z,a),v(N)),!1)}const x=[],k=Object.assign(Z_,{defaultVisitor:_,convertValue:v,isVisitable:vf});function w(N,z){if(!Pt.isUndefined(N)){if(x.indexOf(N)!==-1)throw Error("Circular reference detected in "+z.join("."));x.push(N),Pt.forEach(N,function(O,Z){(!(Pt.isUndefined(O)||O===null)&&o.call(t,O,Pt.isString(Z)?Z.trim():Z,z,k))===!0&&w(O,z?z.concat(Z):[Z])}),x.pop()}}if(!Pt.isObject(e))throw new TypeError("data must be an object");return w(e),t}function f0(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(i){return t[i]})}function op(e,t){this._pairs=[],e&&ad(e,this,t)}const t1=op.prototype;t1.append=function(t,n){this._pairs.push([t,n])};t1.toString=function(t){const n=t?function(i){return t.call(this,i,f0)}:f0;return this._pairs.map(function(o){return n(o[0])+"="+n(o[1])},"").join("&")};function K_(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function n1(e,t,n){if(!t)return e;const i=n&&n.encode||K_;Pt.isFunction(n)&&(n={serialize:n});const o=n&&n.serialize;let a;if(o?a=o(t,n):a=Pt.isURLSearchParams(t)?t.toString():new op(t,n).toString(i),a){const u=e.indexOf("#");u!==-1&&(e=e.slice(0,u)),e+=(e.indexOf("?")===-1?"?":"&")+a}return e}class p0{constructor(){this.handlers=[]}use(t,n,i){return this.handlers.push({fulfilled:t,rejected:n,synchronous:i?i.synchronous:!1,runWhen:i?i.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){Pt.forEach(this.handlers,function(i){i!==null&&t(i)})}}const i1={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Y_=typeof URLSearchParams<"u"?URLSearchParams:op,J_=typeof FormData<"u"?FormData:null,X_=typeof Blob<"u"?Blob:null,Q_={isBrowser:!0,classes:{URLSearchParams:Y_,FormData:J_,Blob:X_},protocols:["http","https","file","blob","url","data"]},ap=typeof window<"u"&&typeof document<"u",yf=typeof navigator=="object"&&navigator||void 0,e4=ap&&(!yf||["ReactNative","NativeScript","NS"].indexOf(yf.product)<0),t4=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",n4=ap&&window.location.href||"http://localhost",i4=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:ap,hasStandardBrowserEnv:e4,hasStandardBrowserWebWorkerEnv:t4,navigator:yf,origin:n4},Symbol.toStringTag,{value:"Module"})),cs={...i4,...Q_};function r4(e,t){return ad(e,new cs.classes.URLSearchParams,Object.assign({visitor:function(n,i,o,a){return cs.isNode&&Pt.isBuffer(n)?(this.append(i,n.toString("base64")),!1):a.defaultVisitor.apply(this,arguments)}},t))}function s4(e){return Pt.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function o4(e){const t={},n=Object.keys(e);let i;const o=n.length;let a;for(i=0;i<o;i++)a=n[i],t[a]=e[a];return t}function r1(e){function t(n,i,o,a){let u=n[a++];if(u==="__proto__")return!0;const d=Number.isFinite(+u),f=a>=n.length;return u=!u&&Pt.isArray(o)?o.length:u,f?(Pt.hasOwnProp(o,u)?o[u]=[o[u],i]:o[u]=i,!d):((!o[u]||!Pt.isObject(o[u]))&&(o[u]=[]),t(n,i,o[u],a)&&Pt.isArray(o[u])&&(o[u]=o4(o[u])),!d)}if(Pt.isFormData(e)&&Pt.isFunction(e.entries)){const n={};return Pt.forEachEntry(e,(i,o)=>{t(s4(i),o,n,0)}),n}return null}function a4(e,t,n){if(Pt.isString(e))try{return(t||JSON.parse)(e),Pt.trim(e)}catch(i){if(i.name!=="SyntaxError")throw i}return(n||JSON.stringify)(e)}const zc={transitional:i1,adapter:["xhr","http","fetch"],transformRequest:[function(t,n){const i=n.getContentType()||"",o=i.indexOf("application/json")>-1,a=Pt.isObject(t);if(a&&Pt.isHTMLForm(t)&&(t=new FormData(t)),Pt.isFormData(t))return o?JSON.stringify(r1(t)):t;if(Pt.isArrayBuffer(t)||Pt.isBuffer(t)||Pt.isStream(t)||Pt.isFile(t)||Pt.isBlob(t)||Pt.isReadableStream(t))return t;if(Pt.isArrayBufferView(t))return t.buffer;if(Pt.isURLSearchParams(t))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let d;if(a){if(i.indexOf("application/x-www-form-urlencoded")>-1)return r4(t,this.formSerializer).toString();if((d=Pt.isFileList(t))||i.indexOf("multipart/form-data")>-1){const f=this.env&&this.env.FormData;return ad(d?{"files[]":t}:t,f&&new f,this.formSerializer)}}return a||o?(n.setContentType("application/json",!1),a4(t)):t}],transformResponse:[function(t){const n=this.transitional||zc.transitional,i=n&&n.forcedJSONParsing,o=this.responseType==="json";if(Pt.isResponse(t)||Pt.isReadableStream(t))return t;if(t&&Pt.isString(t)&&(i&&!this.responseType||o)){const u=!(n&&n.silentJSONParsing)&&o;try{return JSON.parse(t)}catch(d){if(u)throw d.name==="SyntaxError"?Dn.from(d,Dn.ERR_BAD_RESPONSE,this,null,this.response):d}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:cs.classes.FormData,Blob:cs.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Pt.forEach(["delete","get","head","post","put","patch"],e=>{zc.headers[e]={}});const l4=Pt.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),u4=e=>{const t={};let n,i,o;return e&&e.split(`
`).forEach(function(u){o=u.indexOf(":"),n=u.substring(0,o).trim().toLowerCase(),i=u.substring(o+1).trim(),!(!n||t[n]&&l4[n])&&(n==="set-cookie"?t[n]?t[n].push(i):t[n]=[i]:t[n]=t[n]?t[n]+", "+i:i)}),t},g0=Symbol("internals");function tc(e){return e&&String(e).trim().toLowerCase()}function gh(e){return e===!1||e==null?e:Pt.isArray(e)?e.map(gh):String(e)}function c4(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let i;for(;i=n.exec(e);)t[i[1]]=i[2];return t}const h4=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function Fd(e,t,n,i,o){if(Pt.isFunction(i))return i.call(this,t,n);if(o&&(t=n),!!Pt.isString(t)){if(Pt.isString(i))return t.indexOf(i)!==-1;if(Pt.isRegExp(i))return i.test(t)}}function d4(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,n,i)=>n.toUpperCase()+i)}function f4(e,t){const n=Pt.toCamelCase(" "+t);["get","set","has"].forEach(i=>{Object.defineProperty(e,i+n,{value:function(o,a,u){return this[i].call(this,t,o,a,u)},configurable:!0})})}let Gs=class{constructor(t){t&&this.set(t)}set(t,n,i){const o=this;function a(d,f,v){const _=tc(f);if(!_)throw new Error("header name must be a non-empty string");const x=Pt.findKey(o,_);(!x||o[x]===void 0||v===!0||v===void 0&&o[x]!==!1)&&(o[x||f]=gh(d))}const u=(d,f)=>Pt.forEach(d,(v,_)=>a(v,_,f));if(Pt.isPlainObject(t)||t instanceof this.constructor)u(t,n);else if(Pt.isString(t)&&(t=t.trim())&&!h4(t))u(u4(t),n);else if(Pt.isHeaders(t))for(const[d,f]of t.entries())a(f,d,i);else t!=null&&a(n,t,i);return this}get(t,n){if(t=tc(t),t){const i=Pt.findKey(this,t);if(i){const o=this[i];if(!n)return o;if(n===!0)return c4(o);if(Pt.isFunction(n))return n.call(this,o,i);if(Pt.isRegExp(n))return n.exec(o);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,n){if(t=tc(t),t){const i=Pt.findKey(this,t);return!!(i&&this[i]!==void 0&&(!n||Fd(this,this[i],i,n)))}return!1}delete(t,n){const i=this;let o=!1;function a(u){if(u=tc(u),u){const d=Pt.findKey(i,u);d&&(!n||Fd(i,i[d],d,n))&&(delete i[d],o=!0)}}return Pt.isArray(t)?t.forEach(a):a(t),o}clear(t){const n=Object.keys(this);let i=n.length,o=!1;for(;i--;){const a=n[i];(!t||Fd(this,this[a],a,t,!0))&&(delete this[a],o=!0)}return o}normalize(t){const n=this,i={};return Pt.forEach(this,(o,a)=>{const u=Pt.findKey(i,a);if(u){n[u]=gh(o),delete n[a];return}const d=t?d4(a):String(a).trim();d!==a&&delete n[a],n[d]=gh(o),i[d]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const n=Object.create(null);return Pt.forEach(this,(i,o)=>{i!=null&&i!==!1&&(n[o]=t&&Pt.isArray(i)?i.join(", "):i)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,n])=>t+": "+n).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...n){const i=new this(t);return n.forEach(o=>i.set(o)),i}static accessor(t){const i=(this[g0]=this[g0]={accessors:{}}).accessors,o=this.prototype;function a(u){const d=tc(u);i[d]||(f4(o,u),i[d]=!0)}return Pt.isArray(t)?t.forEach(a):a(t),this}};Gs.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Pt.reduceDescriptors(Gs.prototype,({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(i){this[n]=i}}});Pt.freezeMethods(Gs);function jd(e,t){const n=this||zc,i=t||n,o=Gs.from(i.headers);let a=i.data;return Pt.forEach(e,function(d){a=d.call(n,a,o.normalize(),t?t.status:void 0)}),o.normalize(),a}function s1(e){return!!(e&&e.__CANCEL__)}function Gu(e,t,n){Dn.call(this,e??"canceled",Dn.ERR_CANCELED,t,n),this.name="CanceledError"}Pt.inherits(Gu,Dn,{__CANCEL__:!0});function o1(e,t,n){const i=n.config.validateStatus;!n.status||!i||i(n.status)?e(n):t(new Dn("Request failed with status code "+n.status,[Dn.ERR_BAD_REQUEST,Dn.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function p4(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function g4(e,t){e=e||10;const n=new Array(e),i=new Array(e);let o=0,a=0,u;return t=t!==void 0?t:1e3,function(f){const v=Date.now(),_=i[a];u||(u=v),n[o]=f,i[o]=v;let x=a,k=0;for(;x!==o;)k+=n[x++],x=x%e;if(o=(o+1)%e,o===a&&(a=(a+1)%e),v-u<t)return;const w=_&&v-_;return w?Math.round(k*1e3/w):void 0}}function m4(e,t){let n=0,i=1e3/t,o,a;const u=(v,_=Date.now())=>{n=_,o=null,a&&(clearTimeout(a),a=null),e.apply(null,v)};return[(...v)=>{const _=Date.now(),x=_-n;x>=i?u(v,_):(o=v,a||(a=setTimeout(()=>{a=null,u(o)},i-x)))},()=>o&&u(o)]}const Rh=(e,t,n=3)=>{let i=0;const o=g4(50,250);return m4(a=>{const u=a.loaded,d=a.lengthComputable?a.total:void 0,f=u-i,v=o(f),_=u<=d;i=u;const x={loaded:u,total:d,progress:d?u/d:void 0,bytes:f,rate:v||void 0,estimated:v&&d&&_?(d-u)/v:void 0,event:a,lengthComputable:d!=null,[t?"download":"upload"]:!0};e(x)},n)},m0=(e,t)=>{const n=e!=null;return[i=>t[0]({lengthComputable:n,total:e,loaded:i}),t[1]]},v0=e=>(...t)=>Pt.asap(()=>e(...t)),v4=cs.hasStandardBrowserEnv?((e,t)=>n=>(n=new URL(n,cs.origin),e.protocol===n.protocol&&e.host===n.host&&(t||e.port===n.port)))(new URL(cs.origin),cs.navigator&&/(msie|trident)/i.test(cs.navigator.userAgent)):()=>!0,y4=cs.hasStandardBrowserEnv?{write(e,t,n,i,o,a){const u=[e+"="+encodeURIComponent(t)];Pt.isNumber(n)&&u.push("expires="+new Date(n).toGMTString()),Pt.isString(i)&&u.push("path="+i),Pt.isString(o)&&u.push("domain="+o),a===!0&&u.push("secure"),document.cookie=u.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function _4(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function b4(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function a1(e,t){return e&&!_4(t)?b4(e,t):t}const y0=e=>e instanceof Gs?{...e}:e;function lu(e,t){t=t||{};const n={};function i(v,_,x,k){return Pt.isPlainObject(v)&&Pt.isPlainObject(_)?Pt.merge.call({caseless:k},v,_):Pt.isPlainObject(_)?Pt.merge({},_):Pt.isArray(_)?_.slice():_}function o(v,_,x,k){if(Pt.isUndefined(_)){if(!Pt.isUndefined(v))return i(void 0,v,x,k)}else return i(v,_,x,k)}function a(v,_){if(!Pt.isUndefined(_))return i(void 0,_)}function u(v,_){if(Pt.isUndefined(_)){if(!Pt.isUndefined(v))return i(void 0,v)}else return i(void 0,_)}function d(v,_,x){if(x in t)return i(v,_);if(x in e)return i(void 0,v)}const f={url:a,method:a,data:a,baseURL:u,transformRequest:u,transformResponse:u,paramsSerializer:u,timeout:u,timeoutMessage:u,withCredentials:u,withXSRFToken:u,adapter:u,responseType:u,xsrfCookieName:u,xsrfHeaderName:u,onUploadProgress:u,onDownloadProgress:u,decompress:u,maxContentLength:u,maxBodyLength:u,beforeRedirect:u,transport:u,httpAgent:u,httpsAgent:u,cancelToken:u,socketPath:u,responseEncoding:u,validateStatus:d,headers:(v,_,x)=>o(y0(v),y0(_),x,!0)};return Pt.forEach(Object.keys(Object.assign({},e,t)),function(_){const x=f[_]||o,k=x(e[_],t[_],_);Pt.isUndefined(k)&&x!==d||(n[_]=k)}),n}const l1=e=>{const t=lu({},e);let{data:n,withXSRFToken:i,xsrfHeaderName:o,xsrfCookieName:a,headers:u,auth:d}=t;t.headers=u=Gs.from(u),t.url=n1(a1(t.baseURL,t.url),e.params,e.paramsSerializer),d&&u.set("Authorization","Basic "+btoa((d.username||"")+":"+(d.password?unescape(encodeURIComponent(d.password)):"")));let f;if(Pt.isFormData(n)){if(cs.hasStandardBrowserEnv||cs.hasStandardBrowserWebWorkerEnv)u.setContentType(void 0);else if((f=u.getContentType())!==!1){const[v,..._]=f?f.split(";").map(x=>x.trim()).filter(Boolean):[];u.setContentType([v||"multipart/form-data",..._].join("; "))}}if(cs.hasStandardBrowserEnv&&(i&&Pt.isFunction(i)&&(i=i(t)),i||i!==!1&&v4(t.url))){const v=o&&a&&y4.read(a);v&&u.set(o,v)}return t},w4=typeof XMLHttpRequest<"u",x4=w4&&function(e){return new Promise(function(n,i){const o=l1(e);let a=o.data;const u=Gs.from(o.headers).normalize();let{responseType:d,onUploadProgress:f,onDownloadProgress:v}=o,_,x,k,w,N;function z(){w&&w(),N&&N(),o.cancelToken&&o.cancelToken.unsubscribe(_),o.signal&&o.signal.removeEventListener("abort",_)}let W=new XMLHttpRequest;W.open(o.method.toUpperCase(),o.url,!0),W.timeout=o.timeout;function O(){if(!W)return;const se=Gs.from("getAllResponseHeaders"in W&&W.getAllResponseHeaders()),Ne={data:!d||d==="text"||d==="json"?W.responseText:W.response,status:W.status,statusText:W.statusText,headers:se,config:e,request:W};o1(function(Pe){n(Pe),z()},function(Pe){i(Pe),z()},Ne),W=null}"onloadend"in W?W.onloadend=O:W.onreadystatechange=function(){!W||W.readyState!==4||W.status===0&&!(W.responseURL&&W.responseURL.indexOf("file:")===0)||setTimeout(O)},W.onabort=function(){W&&(i(new Dn("Request aborted",Dn.ECONNABORTED,e,W)),W=null)},W.onerror=function(){i(new Dn("Network Error",Dn.ERR_NETWORK,e,W)),W=null},W.ontimeout=function(){let Se=o.timeout?"timeout of "+o.timeout+"ms exceeded":"timeout exceeded";const Ne=o.transitional||i1;o.timeoutErrorMessage&&(Se=o.timeoutErrorMessage),i(new Dn(Se,Ne.clarifyTimeoutError?Dn.ETIMEDOUT:Dn.ECONNABORTED,e,W)),W=null},a===void 0&&u.setContentType(null),"setRequestHeader"in W&&Pt.forEach(u.toJSON(),function(Se,Ne){W.setRequestHeader(Ne,Se)}),Pt.isUndefined(o.withCredentials)||(W.withCredentials=!!o.withCredentials),d&&d!=="json"&&(W.responseType=o.responseType),v&&([k,N]=Rh(v,!0),W.addEventListener("progress",k)),f&&W.upload&&([x,w]=Rh(f),W.upload.addEventListener("progress",x),W.upload.addEventListener("loadend",w)),(o.cancelToken||o.signal)&&(_=se=>{W&&(i(!se||se.type?new Gu(null,e,W):se),W.abort(),W=null)},o.cancelToken&&o.cancelToken.subscribe(_),o.signal&&(o.signal.aborted?_():o.signal.addEventListener("abort",_)));const Z=p4(o.url);if(Z&&cs.protocols.indexOf(Z)===-1){i(new Dn("Unsupported protocol "+Z+":",Dn.ERR_BAD_REQUEST,e));return}W.send(a||null)})},L4=(e,t)=>{const{length:n}=e=e?e.filter(Boolean):[];if(t||n){let i=new AbortController,o;const a=function(v){if(!o){o=!0,d();const _=v instanceof Error?v:this.reason;i.abort(_ instanceof Dn?_:new Gu(_ instanceof Error?_.message:_))}};let u=t&&setTimeout(()=>{u=null,a(new Dn(`timeout ${t} of ms exceeded`,Dn.ETIMEDOUT))},t);const d=()=>{e&&(u&&clearTimeout(u),u=null,e.forEach(v=>{v.unsubscribe?v.unsubscribe(a):v.removeEventListener("abort",a)}),e=null)};e.forEach(v=>v.addEventListener("abort",a));const{signal:f}=i;return f.unsubscribe=()=>Pt.asap(d),f}},C4=function*(e,t){let n=e.byteLength;if(n<t){yield e;return}let i=0,o;for(;i<n;)o=i+t,yield e.slice(i,o),i=o},P4=async function*(e,t){for await(const n of k4(e))yield*C4(n,t)},k4=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:n,value:i}=await t.read();if(n)break;yield i}}finally{await t.cancel()}},_0=(e,t,n,i)=>{const o=P4(e,t);let a=0,u,d=f=>{u||(u=!0,i&&i(f))};return new ReadableStream({async pull(f){try{const{done:v,value:_}=await o.next();if(v){d(),f.close();return}let x=_.byteLength;if(n){let k=a+=x;n(k)}f.enqueue(new Uint8Array(_))}catch(v){throw d(v),v}},cancel(f){return d(f),o.return()}},{highWaterMark:2})},ld=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",u1=ld&&typeof ReadableStream=="function",S4=ld&&(typeof TextEncoder=="function"?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),c1=(e,...t)=>{try{return!!e(...t)}catch{return!1}},E4=u1&&c1(()=>{let e=!1;const t=new Request(cs.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),b0=64*1024,_f=u1&&c1(()=>Pt.isReadableStream(new Response("").body)),Oh={stream:_f&&(e=>e.body)};ld&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!Oh[t]&&(Oh[t]=Pt.isFunction(e[t])?n=>n[t]():(n,i)=>{throw new Dn(`Response type '${t}' is not supported`,Dn.ERR_NOT_SUPPORT,i)})})})(new Response);const A4=async e=>{if(e==null)return 0;if(Pt.isBlob(e))return e.size;if(Pt.isSpecCompliantForm(e))return(await new Request(cs.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(Pt.isArrayBufferView(e)||Pt.isArrayBuffer(e))return e.byteLength;if(Pt.isURLSearchParams(e)&&(e=e+""),Pt.isString(e))return(await S4(e)).byteLength},M4=async(e,t)=>{const n=Pt.toFiniteNumber(e.getContentLength());return n??A4(t)},B4=ld&&(async e=>{let{url:t,method:n,data:i,signal:o,cancelToken:a,timeout:u,onDownloadProgress:d,onUploadProgress:f,responseType:v,headers:_,withCredentials:x="same-origin",fetchOptions:k}=l1(e);v=v?(v+"").toLowerCase():"text";let w=L4([o,a&&a.toAbortSignal()],u),N;const z=w&&w.unsubscribe&&(()=>{w.unsubscribe()});let W;try{if(f&&E4&&n!=="get"&&n!=="head"&&(W=await M4(_,i))!==0){let Ne=new Request(t,{method:"POST",body:i,duplex:"half"}),$e;if(Pt.isFormData(i)&&($e=Ne.headers.get("content-type"))&&_.setContentType($e),Ne.body){const[Pe,xe]=m0(W,Rh(v0(f)));i=_0(Ne.body,b0,Pe,xe)}}Pt.isString(x)||(x=x?"include":"omit");const O="credentials"in Request.prototype;N=new Request(t,{...k,signal:w,method:n.toUpperCase(),headers:_.normalize().toJSON(),body:i,duplex:"half",credentials:O?x:void 0});let Z=await fetch(N);const se=_f&&(v==="stream"||v==="response");if(_f&&(d||se&&z)){const Ne={};["status","statusText","headers"].forEach(Be=>{Ne[Be]=Z[Be]});const $e=Pt.toFiniteNumber(Z.headers.get("content-length")),[Pe,xe]=d&&m0($e,Rh(v0(d),!0))||[];Z=new Response(_0(Z.body,b0,Pe,()=>{xe&&xe(),z&&z()}),Ne)}v=v||"text";let Se=await Oh[Pt.findKey(Oh,v)||"text"](Z,e);return!se&&z&&z(),await new Promise((Ne,$e)=>{o1(Ne,$e,{data:Se,headers:Gs.from(Z.headers),status:Z.status,statusText:Z.statusText,config:e,request:N})})}catch(O){throw z&&z(),O&&O.name==="TypeError"&&/fetch/i.test(O.message)?Object.assign(new Dn("Network Error",Dn.ERR_NETWORK,e,N),{cause:O.cause||O}):Dn.from(O,O&&O.code,e,N)}}),bf={http:H_,xhr:x4,fetch:B4};Pt.forEach(bf,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const w0=e=>`- ${e}`,T4=e=>Pt.isFunction(e)||e===null||e===!1,h1={getAdapter:e=>{e=Pt.isArray(e)?e:[e];const{length:t}=e;let n,i;const o={};for(let a=0;a<t;a++){n=e[a];let u;if(i=n,!T4(n)&&(i=bf[(u=String(n)).toLowerCase()],i===void 0))throw new Dn(`Unknown adapter '${u}'`);if(i)break;o[u||"#"+a]=i}if(!i){const a=Object.entries(o).map(([d,f])=>`adapter ${d} `+(f===!1?"is not supported by the environment":"is not available in the build"));let u=t?a.length>1?`since :
`+a.map(w0).join(`
`):" "+w0(a[0]):"as no adapter specified";throw new Dn("There is no suitable adapter to dispatch the request "+u,"ERR_NOT_SUPPORT")}return i},adapters:bf};function zd(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Gu(null,e)}function x0(e){return zd(e),e.headers=Gs.from(e.headers),e.data=jd.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),h1.getAdapter(e.adapter||zc.adapter)(e).then(function(i){return zd(e),i.data=jd.call(e,e.transformResponse,i),i.headers=Gs.from(i.headers),i},function(i){return s1(i)||(zd(e),i&&i.response&&(i.response.data=jd.call(e,e.transformResponse,i.response),i.response.headers=Gs.from(i.response.headers))),Promise.reject(i)})}const d1="1.7.9",ud={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{ud[e]=function(i){return typeof i===e||"a"+(t<1?"n ":" ")+e}});const L0={};ud.transitional=function(t,n,i){function o(a,u){return"[Axios v"+d1+"] Transitional option '"+a+"'"+u+(i?". "+i:"")}return(a,u,d)=>{if(t===!1)throw new Dn(o(u," has been removed"+(n?" in "+n:"")),Dn.ERR_DEPRECATED);return n&&!L0[u]&&(L0[u]=!0,console.warn(o(u," has been deprecated since v"+n+" and will be removed in the near future"))),t?t(a,u,d):!0}};ud.spelling=function(t){return(n,i)=>(console.warn(`${i} is likely a misspelling of ${t}`),!0)};function N4(e,t,n){if(typeof e!="object")throw new Dn("options must be an object",Dn.ERR_BAD_OPTION_VALUE);const i=Object.keys(e);let o=i.length;for(;o-- >0;){const a=i[o],u=t[a];if(u){const d=e[a],f=d===void 0||u(d,a,e);if(f!==!0)throw new Dn("option "+a+" must be "+f,Dn.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new Dn("Unknown option "+a,Dn.ERR_BAD_OPTION)}}const mh={assertOptions:N4,validators:ud},La=mh.validators;let ru=class{constructor(t){this.defaults=t,this.interceptors={request:new p0,response:new p0}}async request(t,n){try{return await this._request(t,n)}catch(i){if(i instanceof Error){let o={};Error.captureStackTrace?Error.captureStackTrace(o):o=new Error;const a=o.stack?o.stack.replace(/^.+\n/,""):"";try{i.stack?a&&!String(i.stack).endsWith(a.replace(/^.+\n.+\n/,""))&&(i.stack+=`
`+a):i.stack=a}catch{}}throw i}}_request(t,n){typeof t=="string"?(n=n||{},n.url=t):n=t||{},n=lu(this.defaults,n);const{transitional:i,paramsSerializer:o,headers:a}=n;i!==void 0&&mh.assertOptions(i,{silentJSONParsing:La.transitional(La.boolean),forcedJSONParsing:La.transitional(La.boolean),clarifyTimeoutError:La.transitional(La.boolean)},!1),o!=null&&(Pt.isFunction(o)?n.paramsSerializer={serialize:o}:mh.assertOptions(o,{encode:La.function,serialize:La.function},!0)),mh.assertOptions(n,{baseUrl:La.spelling("baseURL"),withXsrfToken:La.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let u=a&&Pt.merge(a.common,a[n.method]);a&&Pt.forEach(["delete","get","head","post","put","patch","common"],N=>{delete a[N]}),n.headers=Gs.concat(u,a);const d=[];let f=!0;this.interceptors.request.forEach(function(z){typeof z.runWhen=="function"&&z.runWhen(n)===!1||(f=f&&z.synchronous,d.unshift(z.fulfilled,z.rejected))});const v=[];this.interceptors.response.forEach(function(z){v.push(z.fulfilled,z.rejected)});let _,x=0,k;if(!f){const N=[x0.bind(this),void 0];for(N.unshift.apply(N,d),N.push.apply(N,v),k=N.length,_=Promise.resolve(n);x<k;)_=_.then(N[x++],N[x++]);return _}k=d.length;let w=n;for(x=0;x<k;){const N=d[x++],z=d[x++];try{w=N(w)}catch(W){z.call(this,W);break}}try{_=x0.call(this,w)}catch(N){return Promise.reject(N)}for(x=0,k=v.length;x<k;)_=_.then(v[x++],v[x++]);return _}getUri(t){t=lu(this.defaults,t);const n=a1(t.baseURL,t.url);return n1(n,t.params,t.paramsSerializer)}};Pt.forEach(["delete","get","head","options"],function(t){ru.prototype[t]=function(n,i){return this.request(lu(i||{},{method:t,url:n,data:(i||{}).data}))}});Pt.forEach(["post","put","patch"],function(t){function n(i){return function(a,u,d){return this.request(lu(d||{},{method:t,headers:i?{"Content-Type":"multipart/form-data"}:{},url:a,data:u}))}}ru.prototype[t]=n(),ru.prototype[t+"Form"]=n(!0)});let D4=class f1{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(a){n=a});const i=this;this.promise.then(o=>{if(!i._listeners)return;let a=i._listeners.length;for(;a-- >0;)i._listeners[a](o);i._listeners=null}),this.promise.then=o=>{let a;const u=new Promise(d=>{i.subscribe(d),a=d}).then(o);return u.cancel=function(){i.unsubscribe(a)},u},t(function(a,u,d){i.reason||(i.reason=new Gu(a,u,d),n(i.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const n=this._listeners.indexOf(t);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const t=new AbortController,n=i=>{t.abort(i)};return this.subscribe(n),t.signal.unsubscribe=()=>this.unsubscribe(n),t.signal}static source(){let t;return{token:new f1(function(o){t=o}),cancel:t}}};function R4(e){return function(n){return e.apply(null,n)}}function O4(e){return Pt.isObject(e)&&e.isAxiosError===!0}const wf={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(wf).forEach(([e,t])=>{wf[t]=e});function p1(e){const t=new ru(e),n=Vm(ru.prototype.request,t);return Pt.extend(n,ru.prototype,t,{allOwnKeys:!0}),Pt.extend(n,t,null,{allOwnKeys:!0}),n.create=function(o){return p1(lu(e,o))},n}const ar=p1(zc);ar.Axios=ru;ar.CanceledError=Gu;ar.CancelToken=D4;ar.isCancel=s1;ar.VERSION=d1;ar.toFormData=ad;ar.AxiosError=Dn;ar.Cancel=ar.CanceledError;ar.all=function(t){return Promise.all(t)};ar.spread=R4;ar.isAxiosError=O4;ar.mergeConfig=lu;ar.AxiosHeaders=Gs;ar.formToJSON=e=>r1(Pt.isHTMLForm(e)?new FormData(e):e);ar.getAdapter=h1.getAdapter;ar.HttpStatusCode=wf;ar.default=ar;const{Axios:jE,AxiosError:zE,CanceledError:UE,isCancel:$E,CancelToken:qE,VERSION:VE,all:GE,Cancel:HE,isAxiosError:WE,spread:ZE,toFormData:KE,AxiosHeaders:YE,HttpStatusCode:JE,formToJSON:XE,getAdapter:QE,mergeConfig:eA}=ar,fn=ar.create({baseURL:"/api",headers:{"Content-Type":"application/json",Accept:"application/json"},withCredentials:!0});function g1(e){var i;const n=`; ${document.cookie}`.split(`; ${e}=`);return n.length===2&&((i=n.pop())==null?void 0:i.split(";").shift())||null}fn.interceptors.request.use(e=>{const t=g1("access_token");return t&&(e.headers.Authorization=`Bearer ${t}`),console.log("Request config:",{url:e.url,method:e.method,headers:e.headers,withCredentials:e.withCredentials}),e},e=>(console.error("Request interceptor error:",e),Promise.reject(e)));fn.interceptors.response.use(e=>e,async e=>{var n;const t=e.config;if(((n=e.response)==null?void 0:n.status)===401&&!t._retry){t._retry=!0;try{await ds().refreshToken();const o=g1("access_token");if(o)return t.headers.Authorization=`Bearer ${o}`,fn(t)}catch(i){console.error("Token refresh failed:",i),window.location.href="/login"}}return Promise.reject(e)});function I4(e){var n;const t=[];if((n=e.response)!=null&&n.data){const i=e.response.data;typeof i=="object"&&!Array.isArray(i)?Object.entries(i).forEach(([o,a])=>{Array.isArray(a)?a.forEach(u=>{t.push({field:o,message:u})}):typeof a=="string"&&t.push({field:o,message:a})}):typeof i=="string"?t.push({field:"non_field_error",message:i}):i.detail&&t.push({field:"non_field_error",message:i.detail})}else e.message&&t.push({field:"non_field_error",message:`Erreur de connexion: ${e.message}`});return t.length===0&&t.push({field:"non_field_error",message:"Une erreur inconnue s'est produite"}),t}async function vh(e){console.log("[fetchUsersByHierarchy] Rcupration des utilisateurs:",e);const t={role:e.role};e.usineId&&(t.usine=e.usineId),e.concessionnaireId&&(t.concessionnaire=e.concessionnaireId),e.includeDetails&&(t.include_plans=!0),e.search&&(t.search=e.search),console.log("[fetchUsersByHierarchy] Filtres appliqus:",t);try{const n=await uo.getUsers(t);return console.log(`[fetchUsersByHierarchy] Rsultat (${n.data.length} utilisateurs):`,n.data),n.data}catch(n){throw console.error("[fetchUsersByHierarchy] Erreur lors de la rcupration des utilisateurs:",n),n}}const uo={async getUsers(e={}){return await fn.get("/users/",{params:e})},async getUser(e){return await fn.get(`/users/${e}/`)},async createUser(e){return await fn.post("/users/",e)},async updateUser(e,t){return await fn.patch(`/users/${e}/`,t)},async deleteUser(e){return await fn.delete(`/users/${e}/`)},async getUsines(){return await fn.get("/users/",{params:{role:"USINE"}})},async getConcessionnaires(e){const t={role:"CONCESSIONNAIRE"};return e&&(t.usine=e),await fn.get("/users/",{params:t})},async getConcessionnaireAgriculteurs(e){return await fn.get("/users/",{params:{role:"AGRICULTEUR",concessionnaire:e}})},async getUsineAgriculteurs(e){return await fn.get("/users/",{params:{role:"AGRICULTEUR",usine:e}})},async getUsersByHierarchy(e){const t={role:e.role};return e.usineId&&(t.usine=e.usineId),e.concessionnaireId&&(t.concessionnaire=e.concessionnaireId),e.includeDetails&&(t.include_plans=!0),e.search&&(t.search=e.search),await fn.get("/users/",{params:t})},async getUsineConcessionnaires(e){return await fn.get("/users/",{params:{role:"CONCESSIONNAIRE",usine:e}})},async getAgriculteurs(e,t){const n={role:"AGRICULTEUR"};return e&&(n.concessionnaire=e),t&&(n.usine=t),await fn.get("/users/",{params:n})},async assignUsineToConcessionnaire(e,t){return await fn.patch(`/users/${e}/`,{usine:t})},async assignConcessionnaireToAgriculteur(e,t){return await fn.patch(`/users/${e}/`,{concessionnaire:t})}},nh={async getPlans(){return await fn.get("/plans/")},async createPlan(e){var n;const t=ds();if(((n=t.user)==null?void 0:n.user_type)==="usine"){if(!e.concessionnaire&&!e.concessionnaire_id)throw new Error("La slection d'un concessionnaire est obligatoire");if(!e.agriculteur&&!e.agriculteur_id)throw new Error("La slection d'un agriculteur est obligatoire");e.usine=t.user.id}return await fn.post("/plans/",e)},async updatePlan(e,t){return await fn.put(`/plans/${e}/`,t)},async deletePlan(e){return await fn.delete(`/plans/${e}/`)},async getAgriculteurPlans(e){return await fn.get("/plans/",{params:{agriculteur:e}})},async createPlanForAgriculteur(e){return await fn.post("/plans/",e)},async getUsinePlans(e){return await fn.get("/plans/",{params:{usine:e}})},async getConcessionnairePlans(e){return await fn.get("/plans/",{params:{concessionnaire:e}})},async createPlanForConcessionnaire(e,t){const n={...e,concessionnaire:t};return await fn.post("/plans/",n)},async createPlanForUsine(e,t){const n={...e,usine:t};return await fn.post("/plans/",n)}};fn.defaults.baseURL="/api";fn.defaults.headers.common["Content-Type"]="application/json";fn.defaults.withCredentials=!0;function Ih(e){var i;const n=`; ${document.cookie}`.split(`; ${e}=`);return n.length===2&&((i=n.pop())==null?void 0:i.split(";").shift())||null}fn.interceptors.request.use(e=>{const t=Ih("access_token");return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>(console.error("Request interceptor error:",e),Promise.reject(e)));fn.interceptors.response.use(e=>e,async e=>{var i,o;const t=ds(),n=e.config;if(((i=e.response)==null?void 0:i.status)===401&&!n._retry&&!((o=n.url)!=null&&o.includes("/token/refresh/"))){n._retry=!0;try{if(!Ih("access_token"))throw new Error("No token available");await t.refreshToken();const u=Ih("access_token");if(u)return n.headers.Authorization=`Bearer ${u}`,fn(n)}catch(a){console.error("Token refresh failed:",a),await t.logout(),window.location.pathname!=="/login"&&(window.location.href="/login")}}return Promise.reject(e)});function F4(e,t,n=1){const i=new Date;i.setTime(i.getTime()+n*24*60*60*1e3);const o=`expires=${i.toUTCString()}`;document.cookie=`${e}=${t};${o};path=/;secure;samesite=Strict`}function co(e){if(!e)return"-";const t=e.first_name||"",n=e.last_name?e.last_name.toUpperCase():"",i=`${t} ${n}`.trim(),o=e.company_name||e.role||"";return!i&&!o?"-":i?o?`${i} (${o})`:i:`(${o})`}function j4(e="",t=""){return`${(e==null?void 0:e.charAt(0))||""}${(t==null?void 0:t.charAt(0))||""}`.toUpperCase()}const z4={ADMIN:"Administrateur",USINE:"Usine",CONCESSIONNAIRE:"Concessionnaire",AGRICULTEUR:"Agriculteur"};function U4(e){return z4[e]||e}function $4(){return"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-gray-100 text-gray-800"}function q4(e){return e?"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800":"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800"}async function V4({role:e,usineId:t,concessionnaireId:n,includeDetails:i=!1}){const o={role:e};return t&&(o.usine=t),n&&(o.concessionnaire=n),i&&(o.include_plans=!0),(await uo.getUsers(o)).data}const ds=id("auth",{state:()=>({user:null,isAuthenticated:!1,mustChangePassword:!1,initialized:!1,loading:!1,error:null,concessionnaires:[],usines:[],concessionnaires_list:[],agriculteurs:[]}),getters:{isAdmin:e=>{var t;return((t=e.user)==null?void 0:t.user_type)==="admin"},isUsine:e=>{var t;return((t=e.user)==null?void 0:t.user_type)==="usine"},isConcessionnaire:e=>{var t;return((t=e.user)==null?void 0:t.user_type)==="concessionnaire"},isAgriculteur:e=>{var t;return((t=e.user)==null?void 0:t.user_type)==="agriculteur"},currentUser:e=>e.user,hasConcessionnaire:e=>{var t;return!!((t=e.user)!=null&&t.concessionnaire)},hasUsine:e=>{var t;return!!((t=e.user)!=null&&t.usine)}},actions:{async initialize(e){if(!e){const n=await this.restoreSession();return this.initialized=!0,n}if(e.isAuthenticated&&e.user)return this.user=e.user,this.isAuthenticated=!0,this.mustChangePassword=e.user.must_change_password||!1,this.initialized=!0,!0;const t=await this.restoreSession();return this.initialized=!0,t},async restoreSession(){try{if(!Ih("access_token"))return this.isAuthenticated=!1,this.user=null,!1;const t=await fn.post("/token/refresh/");return t.data.user?(this.user=t.data.user,this.isAuthenticated=!0,this.mustChangePassword=t.data.user.must_change_password||!1,!0):(await this.fetchUserProfile(),!0)}catch(e){return console.error("Failed to restore session:",e),this.isAuthenticated=!1,this.user=null,!1}},async login(e,t){var n,i,o;try{const a=await fn.post("/token/",{username:e,password:t});if(!a.data.access)throw new Error("Token d'accs non reu");document.cookie=`access_token=${a.data.access}; path=/; secure; samesite=Strict`;const u=await this.fetchUserProfile();return this.user=u,this.isAuthenticated=!0,!0}catch(a){throw this.isAuthenticated=!1,this.user=null,((n=a.response)==null?void 0:n.status)===401?new Error("Identifiants incorrects"):(o=(i=a.response)==null?void 0:i.data)!=null&&o.detail?new Error(a.response.data.detail):a}},async logout(){this.user=null,this.isAuthenticated=!1,this.mustChangePassword=!1,document.cookie="access_token=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT",document.cookie="refresh_token=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT"},async checkAuth(){try{return await this.fetchUserProfile(),!0}catch{return this.isAuthenticated=!1,this.user=null,!1}},async fetchUserProfile(){try{const e=await fn.get("/users/me/");return this.user=e.data,this.isAuthenticated=!0,this.mustChangePassword=e.data.must_change_password||!1,e.data}catch(e){throw this.isAuthenticated=!1,this.user=null,e}},async changePassword(e,t){try{const n=await fn.post("/users/change_password/",{old_password:e,password:t});return this.user={...this.user,must_change_password:!1},n.data}catch(n){throw console.error("Password change error:",n),n}},async refreshToken(){var e,t,n,i;try{const o=await fn.post("/token/refresh/",{},{withCredentials:!0}),{access:a}=o.data;if(!a)throw new Error("No access token received");return F4("access_token",a,1),this.isAuthenticated=!0,a}catch(o){throw console.error("Error refreshing token:",{status:(e=o.response)==null?void 0:e.status,data:(t=o.response)==null?void 0:t.data}),(((n=o.response)==null?void 0:n.status)===401||((i=o.response)==null?void 0:i.status)===403)&&await this.logout(),o}},async fetchUsers(e={}){this.loading=!0;try{return(await uo.getUsers(e)).data}catch(t){throw this.error="Erreur lors de la rcupration des utilisateurs",t}finally{this.loading=!1}},async fetchUsines(){this.loading=!0;try{const e=await uo.getUsines();return this.usines=e.data,this.usines}catch(e){throw this.error="Erreur lors de la rcupration des usines",e}finally{this.loading=!1}},async fetchUsineConcessionnaires(e){this.loading=!0;try{const t=await uo.getUsineConcessionnaires(e);return this.concessionnaires_list=t.data,this.concessionnaires_list}catch(t){throw this.error="Erreur lors de la rcupration des concessionnaires de l'usine",t}finally{this.loading=!1}},async fetchConcessionnaireAgriculteurs(e){this.loading=!0;try{const t=await uo.getAgriculteurs(e);return this.agriculteurs=Array.isArray(t.data)?t.data:[t.data],this.agriculteurs}catch(t){throw this.error="Erreur lors de la rcupration des agriculteurs",t}finally{this.loading=!1}},async fetchUsineAgriculteurs(e){this.loading=!0;try{const t=await uo.getAgriculteurs(void 0,e);return Array.isArray(t.data)?t.data:[t.data]}catch(t){throw this.error="Erreur lors de la rcupration des agriculteurs de l'usine",t}finally{this.loading=!1}},async setUsineForConcessionnaire(e,t){this.loading=!0;try{return await uo.assignUsineToConcessionnaire(e,t)}catch(n){throw this.error="Erreur lors de l'assignation de l'usine au concessionnaire",n}finally{this.loading=!1}},async setConcessionnaireForAgriculteur(e,t){this.loading=!0;try{return await uo.assignConcessionnaireToAgriculteur(e,t)}catch(n){throw this.error="Erreur lors de l'assignation du concessionnaire  l'agriculteur",n}finally{this.loading=!1}},async createUser(e){this.loading=!0;try{return(await uo.createUser(e)).data}catch(t){throw this.error="Erreur lors de la cration de l'utilisateur",t}finally{this.loading=!1}},async updateUser(e,t){this.loading=!0;try{return(await uo.updateUser(e,t)).data}catch(n){throw this.error="Erreur lors de la mise  jour de l'utilisateur",n}finally{this.loading=!1}},async deleteUser(e){this.loading=!0;try{return await uo.deleteUser(e),!0}catch(t){throw this.error="Erreur lors de la suppression de l'utilisateur",t}finally{this.loading=!1}},async fetchConcessionnairesLegacy(){this.loading=!0;try{const e=await fn.get("/users/",{params:{role:"concessionnaire"}});this.concessionnaires=e.data}catch(e){throw this.error="Erreur lors de la rcupration des concessionnaires",e}finally{this.loading=!1}},async setConcessionnaire(e,t){this.loading=!0;try{await fn.patch(`/users/${e}/`,{concessionnaire:t}),this.user&&this.user.id===e&&(this.user.concessionnaire=t)}catch(n){throw this.error="Erreur lors de la mise  jour du concessionnaire",n}finally{this.loading=!1}},async updateUserRole(e,t){this.loading=!0;try{const n=await fn.patch(`/users/${e}/`,{role:t});return this.user&&this.user.id===e&&(this.user.user_type=t),n.data}catch(n){throw this.error="Erreur lors de la mise  jour du rle",n}finally{this.loading=!1}},async updateUserEmail(e){var t;this.loading=!0;try{const n=await fn.patch(`/users/${(t=this.user)==null?void 0:t.id}/`,{email:e});return this.user&&(this.user.email=e),n.data}catch(n){throw this.error="Erreur lors de la mise  jour de l'email",n}finally{this.loading=!1}},checkAccess(e){return this.user?e.includes(this.user.user_type):!1},async fetchUsersByRole(e){this.loading=!0;try{return await V4(e)}catch(t){throw console.error(`Error fetching ${e.role}:`,t),t}finally{this.loading=!1}}}});/*!
  * vue-router v4.5.0
  * (c) 2024 Eduardo San Martin Morote
  * @license MIT
  */const ku=typeof document<"u";function m1(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function G4(e){return e.__esModule||e[Symbol.toStringTag]==="Module"||e.default&&m1(e.default)}const di=Object.assign;function Ud(e,t){const n={};for(const i in t){const o=t[i];n[i]=ia(o)?o.map(e):e(o)}return n}const vc=()=>{},ia=Array.isArray,v1=/#/g,H4=/&/g,W4=/\//g,Z4=/=/g,K4=/\?/g,y1=/\+/g,Y4=/%5B/g,J4=/%5D/g,_1=/%5E/g,X4=/%60/g,b1=/%7B/g,Q4=/%7C/g,w1=/%7D/g,e5=/%20/g;function lp(e){return encodeURI(""+e).replace(Q4,"|").replace(Y4,"[").replace(J4,"]")}function t5(e){return lp(e).replace(b1,"{").replace(w1,"}").replace(_1,"^")}function xf(e){return lp(e).replace(y1,"%2B").replace(e5,"+").replace(v1,"%23").replace(H4,"%26").replace(X4,"`").replace(b1,"{").replace(w1,"}").replace(_1,"^")}function n5(e){return xf(e).replace(Z4,"%3D")}function i5(e){return lp(e).replace(v1,"%23").replace(K4,"%3F")}function r5(e){return e==null?"":i5(e).replace(W4,"%2F")}function Mc(e){try{return decodeURIComponent(""+e)}catch{}return""+e}const s5=/\/$/,o5=e=>e.replace(s5,"");function $d(e,t,n="/"){let i,o={},a="",u="";const d=t.indexOf("#");let f=t.indexOf("?");return d<f&&d>=0&&(f=-1),f>-1&&(i=t.slice(0,f),a=t.slice(f+1,d>-1?d:t.length),o=e(a)),d>-1&&(i=i||t.slice(0,d),u=t.slice(d,t.length)),i=c5(i??t,n),{fullPath:i+(a&&"?")+a+u,path:i,query:o,hash:Mc(u)}}function a5(e,t){const n=t.query?e(t.query):"";return t.path+(n&&"?")+n+(t.hash||"")}function C0(e,t){return!t||!e.toLowerCase().startsWith(t.toLowerCase())?e:e.slice(t.length)||"/"}function l5(e,t,n){const i=t.matched.length-1,o=n.matched.length-1;return i>-1&&i===o&&Uu(t.matched[i],n.matched[o])&&x1(t.params,n.params)&&e(t.query)===e(n.query)&&t.hash===n.hash}function Uu(e,t){return(e.aliasOf||e)===(t.aliasOf||t)}function x1(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(!u5(e[n],t[n]))return!1;return!0}function u5(e,t){return ia(e)?P0(e,t):ia(t)?P0(t,e):e===t}function P0(e,t){return ia(t)?e.length===t.length&&e.every((n,i)=>n===t[i]):e.length===1&&e[0]===t}function c5(e,t){if(e.startsWith("/"))return e;if(!e)return t;const n=t.split("/"),i=e.split("/"),o=i[i.length-1];(o===".."||o===".")&&i.push("");let a=n.length-1,u,d;for(u=0;u<i.length;u++)if(d=i[u],d!==".")if(d==="..")a>1&&a--;else break;return n.slice(0,a).join("/")+"/"+i.slice(u).join("/")}const _l={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};var Bc;(function(e){e.pop="pop",e.push="push"})(Bc||(Bc={}));var yc;(function(e){e.back="back",e.forward="forward",e.unknown=""})(yc||(yc={}));function h5(e){if(!e)if(ku){const t=document.querySelector("base");e=t&&t.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),o5(e)}const d5=/^[^#]+#/;function f5(e,t){return e.replace(d5,"#")+t}function p5(e,t){const n=document.documentElement.getBoundingClientRect(),i=e.getBoundingClientRect();return{behavior:t.behavior,left:i.left-n.left-(t.left||0),top:i.top-n.top-(t.top||0)}}const cd=()=>({left:window.scrollX,top:window.scrollY});function g5(e){let t;if("el"in e){const n=e.el,i=typeof n=="string"&&n.startsWith("#"),o=typeof n=="string"?i?document.getElementById(n.slice(1)):document.querySelector(n):n;if(!o)return;t=p5(o,e)}else t=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(t.left!=null?t.left:window.scrollX,t.top!=null?t.top:window.scrollY)}function k0(e,t){return(history.state?history.state.position-t:-1)+e}const Lf=new Map;function m5(e,t){Lf.set(e,t)}function v5(e){const t=Lf.get(e);return Lf.delete(e),t}let y5=()=>location.protocol+"//"+location.host;function L1(e,t){const{pathname:n,search:i,hash:o}=t,a=e.indexOf("#");if(a>-1){let d=o.includes(e.slice(a))?e.slice(a).length:1,f=o.slice(d);return f[0]!=="/"&&(f="/"+f),C0(f,"")}return C0(n,e)+i+o}function _5(e,t,n,i){let o=[],a=[],u=null;const d=({state:k})=>{const w=L1(e,location),N=n.value,z=t.value;let W=0;if(k){if(n.value=w,t.value=k,u&&u===N){u=null;return}W=z?k.position-z.position:0}else i(w);o.forEach(O=>{O(n.value,N,{delta:W,type:Bc.pop,direction:W?W>0?yc.forward:yc.back:yc.unknown})})};function f(){u=n.value}function v(k){o.push(k);const w=()=>{const N=o.indexOf(k);N>-1&&o.splice(N,1)};return a.push(w),w}function _(){const{history:k}=window;k.state&&k.replaceState(di({},k.state,{scroll:cd()}),"")}function x(){for(const k of a)k();a=[],window.removeEventListener("popstate",d),window.removeEventListener("beforeunload",_)}return window.addEventListener("popstate",d),window.addEventListener("beforeunload",_,{passive:!0}),{pauseListeners:f,listen:v,destroy:x}}function S0(e,t,n,i=!1,o=!1){return{back:e,current:t,forward:n,replaced:i,position:window.history.length,scroll:o?cd():null}}function b5(e){const{history:t,location:n}=window,i={value:L1(e,n)},o={value:t.state};o.value||a(i.value,{back:null,current:i.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0);function a(f,v,_){const x=e.indexOf("#"),k=x>-1?(n.host&&document.querySelector("base")?e:e.slice(x))+f:y5()+e+f;try{t[_?"replaceState":"pushState"](v,"",k),o.value=v}catch(w){console.error(w),n[_?"replace":"assign"](k)}}function u(f,v){const _=di({},t.state,S0(o.value.back,f,o.value.forward,!0),v,{position:o.value.position});a(f,_,!0),i.value=f}function d(f,v){const _=di({},o.value,t.state,{forward:f,scroll:cd()});a(_.current,_,!0);const x=di({},S0(i.value,f,null),{position:_.position+1},v);a(f,x,!1),i.value=f}return{location:i,state:o,push:d,replace:u}}function w5(e){e=h5(e);const t=b5(e),n=_5(e,t.state,t.location,t.replace);function i(a,u=!0){u||n.pauseListeners(),history.go(a)}const o=di({location:"",base:e,go:i,createHref:f5.bind(null,e)},t,n);return Object.defineProperty(o,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(o,"state",{enumerable:!0,get:()=>t.state.value}),o}function x5(e){return typeof e=="string"||e&&typeof e=="object"}function C1(e){return typeof e=="string"||typeof e=="symbol"}const P1=Symbol("");var E0;(function(e){e[e.aborted=4]="aborted",e[e.cancelled=8]="cancelled",e[e.duplicated=16]="duplicated"})(E0||(E0={}));function $u(e,t){return di(new Error,{type:e,[P1]:!0},t)}function Ya(e,t){return e instanceof Error&&P1 in e&&(t==null||!!(e.type&t))}const A0="[^/]+?",L5={sensitive:!1,strict:!1,start:!0,end:!0},C5=/[.+*?^${}()[\]/\\]/g;function P5(e,t){const n=di({},L5,t),i=[];let o=n.start?"^":"";const a=[];for(const v of e){const _=v.length?[]:[90];n.strict&&!v.length&&(o+="/");for(let x=0;x<v.length;x++){const k=v[x];let w=40+(n.sensitive?.25:0);if(k.type===0)x||(o+="/"),o+=k.value.replace(C5,"\\$&"),w+=40;else if(k.type===1){const{value:N,repeatable:z,optional:W,regexp:O}=k;a.push({name:N,repeatable:z,optional:W});const Z=O||A0;if(Z!==A0){w+=10;try{new RegExp(`(${Z})`)}catch(Se){throw new Error(`Invalid custom RegExp for param "${N}" (${Z}): `+Se.message)}}let se=z?`((?:${Z})(?:/(?:${Z}))*)`:`(${Z})`;x||(se=W&&v.length<2?`(?:/${se})`:"/"+se),W&&(se+="?"),o+=se,w+=20,W&&(w+=-8),z&&(w+=-20),Z===".*"&&(w+=-50)}_.push(w)}i.push(_)}if(n.strict&&n.end){const v=i.length-1;i[v][i[v].length-1]+=.7000000000000001}n.strict||(o+="/?"),n.end?o+="$":n.strict&&!o.endsWith("/")&&(o+="(?:/|$)");const u=new RegExp(o,n.sensitive?"":"i");function d(v){const _=v.match(u),x={};if(!_)return null;for(let k=1;k<_.length;k++){const w=_[k]||"",N=a[k-1];x[N.name]=w&&N.repeatable?w.split("/"):w}return x}function f(v){let _="",x=!1;for(const k of e){(!x||!_.endsWith("/"))&&(_+="/"),x=!1;for(const w of k)if(w.type===0)_+=w.value;else if(w.type===1){const{value:N,repeatable:z,optional:W}=w,O=N in v?v[N]:"";if(ia(O)&&!z)throw new Error(`Provided param "${N}" is an array but it is not repeatable (* or + modifiers)`);const Z=ia(O)?O.join("/"):O;if(!Z)if(W)k.length<2&&(_.endsWith("/")?_=_.slice(0,-1):x=!0);else throw new Error(`Missing required param "${N}"`);_+=Z}}return _||"/"}return{re:u,score:i,keys:a,parse:d,stringify:f}}function k5(e,t){let n=0;for(;n<e.length&&n<t.length;){const i=t[n]-e[n];if(i)return i;n++}return e.length<t.length?e.length===1&&e[0]===80?-1:1:e.length>t.length?t.length===1&&t[0]===80?1:-1:0}function k1(e,t){let n=0;const i=e.score,o=t.score;for(;n<i.length&&n<o.length;){const a=k5(i[n],o[n]);if(a)return a;n++}if(Math.abs(o.length-i.length)===1){if(M0(i))return 1;if(M0(o))return-1}return o.length-i.length}function M0(e){const t=e[e.length-1];return e.length>0&&t[t.length-1]<0}const S5={type:0,value:""},E5=/[a-zA-Z0-9_]/;function A5(e){if(!e)return[[]];if(e==="/")return[[S5]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function t(w){throw new Error(`ERR (${n})/"${v}": ${w}`)}let n=0,i=n;const o=[];let a;function u(){a&&o.push(a),a=[]}let d=0,f,v="",_="";function x(){v&&(n===0?a.push({type:0,value:v}):n===1||n===2||n===3?(a.length>1&&(f==="*"||f==="+")&&t(`A repeatable param (${v}) must be alone in its segment. eg: '/:ids+.`),a.push({type:1,value:v,regexp:_,repeatable:f==="*"||f==="+",optional:f==="*"||f==="?"})):t("Invalid state to consume buffer"),v="")}function k(){v+=f}for(;d<e.length;){if(f=e[d++],f==="\\"&&n!==2){i=n,n=4;continue}switch(n){case 0:f==="/"?(v&&x(),u()):f===":"?(x(),n=1):k();break;case 4:k(),n=i;break;case 1:f==="("?n=2:E5.test(f)?k():(x(),n=0,f!=="*"&&f!=="?"&&f!=="+"&&d--);break;case 2:f===")"?_[_.length-1]=="\\"?_=_.slice(0,-1)+f:n=3:_+=f;break;case 3:x(),n=0,f!=="*"&&f!=="?"&&f!=="+"&&d--,_="";break;default:t("Unknown state");break}}return n===2&&t(`Unfinished custom RegExp for param "${v}"`),x(),u(),o}function M5(e,t,n){const i=P5(A5(e.path),n),o=di(i,{record:e,parent:t,children:[],alias:[]});return t&&!o.record.aliasOf==!t.record.aliasOf&&t.children.push(o),o}function B5(e,t){const n=[],i=new Map;t=D0({strict:!1,end:!0,sensitive:!1},t);function o(x){return i.get(x)}function a(x,k,w){const N=!w,z=T0(x);z.aliasOf=w&&w.record;const W=D0(t,x),O=[z];if("alias"in x){const Se=typeof x.alias=="string"?[x.alias]:x.alias;for(const Ne of Se)O.push(T0(di({},z,{components:w?w.record.components:z.components,path:Ne,aliasOf:w?w.record:z})))}let Z,se;for(const Se of O){const{path:Ne}=Se;if(k&&Ne[0]!=="/"){const $e=k.record.path,Pe=$e[$e.length-1]==="/"?"":"/";Se.path=k.record.path+(Ne&&Pe+Ne)}if(Z=M5(Se,k,W),w?w.alias.push(Z):(se=se||Z,se!==Z&&se.alias.push(Z),N&&x.name&&!N0(Z)&&u(x.name)),S1(Z)&&f(Z),z.children){const $e=z.children;for(let Pe=0;Pe<$e.length;Pe++)a($e[Pe],Z,w&&w.children[Pe])}w=w||Z}return se?()=>{u(se)}:vc}function u(x){if(C1(x)){const k=i.get(x);k&&(i.delete(x),n.splice(n.indexOf(k),1),k.children.forEach(u),k.alias.forEach(u))}else{const k=n.indexOf(x);k>-1&&(n.splice(k,1),x.record.name&&i.delete(x.record.name),x.children.forEach(u),x.alias.forEach(u))}}function d(){return n}function f(x){const k=D5(x,n);n.splice(k,0,x),x.record.name&&!N0(x)&&i.set(x.record.name,x)}function v(x,k){let w,N={},z,W;if("name"in x&&x.name){if(w=i.get(x.name),!w)throw $u(1,{location:x});W=w.record.name,N=di(B0(k.params,w.keys.filter(se=>!se.optional).concat(w.parent?w.parent.keys.filter(se=>se.optional):[]).map(se=>se.name)),x.params&&B0(x.params,w.keys.map(se=>se.name))),z=w.stringify(N)}else if(x.path!=null)z=x.path,w=n.find(se=>se.re.test(z)),w&&(N=w.parse(z),W=w.record.name);else{if(w=k.name?i.get(k.name):n.find(se=>se.re.test(k.path)),!w)throw $u(1,{location:x,currentLocation:k});W=w.record.name,N=di({},k.params,x.params),z=w.stringify(N)}const O=[];let Z=w;for(;Z;)O.unshift(Z.record),Z=Z.parent;return{name:W,path:z,params:N,matched:O,meta:N5(O)}}e.forEach(x=>a(x));function _(){n.length=0,i.clear()}return{addRoute:a,resolve:v,removeRoute:u,clearRoutes:_,getRoutes:d,getRecordMatcher:o}}function B0(e,t){const n={};for(const i of t)i in e&&(n[i]=e[i]);return n}function T0(e){const t={path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:e.aliasOf,beforeEnter:e.beforeEnter,props:T5(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}};return Object.defineProperty(t,"mods",{value:{}}),t}function T5(e){const t={},n=e.props||!1;if("component"in e)t.default=n;else for(const i in e.components)t[i]=typeof n=="object"?n[i]:n;return t}function N0(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function N5(e){return e.reduce((t,n)=>di(t,n.meta),{})}function D0(e,t){const n={};for(const i in e)n[i]=i in t?t[i]:e[i];return n}function D5(e,t){let n=0,i=t.length;for(;n!==i;){const a=n+i>>1;k1(e,t[a])<0?i=a:n=a+1}const o=R5(e);return o&&(i=t.lastIndexOf(o,i-1)),i}function R5(e){let t=e;for(;t=t.parent;)if(S1(t)&&k1(e,t)===0)return t}function S1({record:e}){return!!(e.name||e.components&&Object.keys(e.components).length||e.redirect)}function O5(e){const t={};if(e===""||e==="?")return t;const i=(e[0]==="?"?e.slice(1):e).split("&");for(let o=0;o<i.length;++o){const a=i[o].replace(y1," "),u=a.indexOf("="),d=Mc(u<0?a:a.slice(0,u)),f=u<0?null:Mc(a.slice(u+1));if(d in t){let v=t[d];ia(v)||(v=t[d]=[v]),v.push(f)}else t[d]=f}return t}function R0(e){let t="";for(let n in e){const i=e[n];if(n=n5(n),i==null){i!==void 0&&(t+=(t.length?"&":"")+n);continue}(ia(i)?i.map(a=>a&&xf(a)):[i&&xf(i)]).forEach(a=>{a!==void 0&&(t+=(t.length?"&":"")+n,a!=null&&(t+="="+a))})}return t}function I5(e){const t={};for(const n in e){const i=e[n];i!==void 0&&(t[n]=ia(i)?i.map(o=>o==null?null:""+o):i==null?i:""+i)}return t}const F5=Symbol(""),O0=Symbol(""),hd=Symbol(""),up=Symbol(""),Cf=Symbol("");function nc(){let e=[];function t(i){return e.push(i),()=>{const o=e.indexOf(i);o>-1&&e.splice(o,1)}}function n(){e=[]}return{add:t,list:()=>e.slice(),reset:n}}function kl(e,t,n,i,o,a=u=>u()){const u=i&&(i.enterCallbacks[o]=i.enterCallbacks[o]||[]);return()=>new Promise((d,f)=>{const v=k=>{k===!1?f($u(4,{from:n,to:t})):k instanceof Error?f(k):x5(k)?f($u(2,{from:t,to:k})):(u&&i.enterCallbacks[o]===u&&typeof k=="function"&&u.push(k),d())},_=a(()=>e.call(i&&i.instances[o],t,n,v));let x=Promise.resolve(_);e.length<3&&(x=x.then(v)),x.catch(k=>f(k))})}function qd(e,t,n,i,o=a=>a()){const a=[];for(const u of e)for(const d in u.components){let f=u.components[d];if(!(t!=="beforeRouteEnter"&&!u.instances[d]))if(m1(f)){const _=(f.__vccOpts||f)[t];_&&a.push(kl(_,n,i,u,d,o))}else{let v=f();a.push(()=>v.then(_=>{if(!_)throw new Error(`Couldn't resolve component "${d}" at "${u.path}"`);const x=G4(_)?_.default:_;u.mods[d]=_,u.components[d]=x;const w=(x.__vccOpts||x)[t];return w&&kl(w,n,i,u,d,o)()}))}}return a}function I0(e){const t=Do(hd),n=Do(up),i=jn(()=>{const f=mn(e.to);return t.resolve(f)}),o=jn(()=>{const{matched:f}=i.value,{length:v}=f,_=f[v-1],x=n.matched;if(!_||!x.length)return-1;const k=x.findIndex(Uu.bind(null,_));if(k>-1)return k;const w=F0(f[v-2]);return v>1&&F0(_)===w&&x[x.length-1].path!==w?x.findIndex(Uu.bind(null,f[v-2])):k}),a=jn(()=>o.value>-1&&$5(n.params,i.value.params)),u=jn(()=>o.value>-1&&o.value===n.matched.length-1&&x1(n.params,i.value.params));function d(f={}){if(U5(f)){const v=t[mn(e.replace)?"replace":"push"](mn(e.to)).catch(vc);return e.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>v),v}return Promise.resolve()}return{route:i,href:jn(()=>i.value.href),isActive:a,isExactActive:u,navigate:d}}function j5(e){return e.length===1?e[0]:e}const z5=Hs({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:I0,setup(e,{slots:t}){const n=il(I0(e)),{options:i}=Do(hd),o=jn(()=>({[j0(e.activeClass,i.linkActiveClass,"router-link-active")]:n.isActive,[j0(e.exactActiveClass,i.linkExactActiveClass,"router-link-exact-active")]:n.isExactActive}));return()=>{const a=t.default&&j5(t.default(n));return e.custom?a:rp("a",{"aria-current":n.isExactActive?e.ariaCurrentValue:null,href:n.href,onClick:n.navigate,class:o.value},a)}}}),Su=z5;function U5(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const t=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return e.preventDefault&&e.preventDefault(),!0}}function $5(e,t){for(const n in t){const i=t[n],o=e[n];if(typeof i=="string"){if(i!==o)return!1}else if(!ia(o)||o.length!==i.length||i.some((a,u)=>a!==o[u]))return!1}return!0}function F0(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const j0=(e,t,n)=>e??t??n,q5=Hs({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:t,slots:n}){const i=Do(Cf),o=jn(()=>e.route||i.value),a=Do(O0,0),u=jn(()=>{let v=mn(a);const{matched:_}=o.value;let x;for(;(x=_[v])&&!x.components;)v++;return v}),d=jn(()=>o.value.matched[u.value]);uh(O0,jn(()=>u.value+1)),uh(F5,d),uh(Cf,o);const f=Dt();return Qi(()=>[f.value,d.value,e.name],([v,_,x],[k,w,N])=>{_&&(_.instances[x]=v,w&&w!==_&&v&&v===k&&(_.leaveGuards.size||(_.leaveGuards=w.leaveGuards),_.updateGuards.size||(_.updateGuards=w.updateGuards))),v&&_&&(!w||!Uu(_,w)||!k)&&(_.enterCallbacks[x]||[]).forEach(z=>z(v))},{flush:"post"}),()=>{const v=o.value,_=e.name,x=d.value,k=x&&x.components[_];if(!k)return z0(n.default,{Component:k,route:v});const w=x.props[_],N=w?w===!0?v.params:typeof w=="function"?w(v):w:null,W=rp(k,di({},N,t,{onVnodeUnmounted:O=>{O.component.isUnmounted&&(x.instances[_]=null)},ref:f}));return z0(n.default,{Component:W,route:v})||W}}});function z0(e,t){if(!e)return null;const n=e(t);return n.length===1?n[0]:n}const E1=q5;function V5(e){const t=B5(e.routes,e),n=e.parseQuery||O5,i=e.stringifyQuery||R0,o=e.history,a=nc(),u=nc(),d=nc(),f=ey(_l);let v=_l;ku&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const _=Ud.bind(null,U=>""+U),x=Ud.bind(null,r5),k=Ud.bind(null,Mc);function w(U,H){let $,ce;return C1(U)?($=t.getRecordMatcher(U),ce=H):ce=U,t.addRoute(ce,$)}function N(U){const H=t.getRecordMatcher(U);H&&t.removeRoute(H)}function z(){return t.getRoutes().map(U=>U.record)}function W(U){return!!t.getRecordMatcher(U)}function O(U,H){if(H=di({},H||f.value),typeof U=="string"){const ye=$d(n,U,H.path),ve=t.resolve({path:ye.path},H),ee=o.createHref(ye.fullPath);return di(ye,ve,{params:k(ve.params),hash:Mc(ye.hash),redirectedFrom:void 0,href:ee})}let $;if(U.path!=null)$=di({},U,{path:$d(n,U.path,H.path).path});else{const ye=di({},U.params);for(const ve in ye)ye[ve]==null&&delete ye[ve];$=di({},U,{params:x(ye)}),H.params=x(H.params)}const ce=t.resolve($,H),ue=U.hash||"";ce.params=_(k(ce.params));const V=a5(i,di({},U,{hash:t5(ue),path:ce.path})),K=o.createHref(V);return di({fullPath:V,hash:ue,query:i===R0?I5(U.query):U.query||{}},ce,{redirectedFrom:void 0,href:K})}function Z(U){return typeof U=="string"?$d(n,U,f.value.path):di({},U)}function se(U,H){if(v!==U)return $u(8,{from:H,to:U})}function Se(U){return Pe(U)}function Ne(U){return Se(di(Z(U),{replace:!0}))}function $e(U){const H=U.matched[U.matched.length-1];if(H&&H.redirect){const{redirect:$}=H;let ce=typeof $=="function"?$(U):$;return typeof ce=="string"&&(ce=ce.includes("?")||ce.includes("#")?ce=Z(ce):{path:ce},ce.params={}),di({query:U.query,hash:U.hash,params:ce.path!=null?{}:U.params},ce)}}function Pe(U,H){const $=v=O(U),ce=f.value,ue=U.state,V=U.force,K=U.replace===!0,ye=$e($);if(ye)return Pe(di(Z(ye),{state:typeof ye=="object"?di({},ue,ye.state):ue,force:V,replace:K}),H||$);const ve=$;ve.redirectedFrom=H;let ee;return!V&&l5(i,ce,$)&&(ee=$u(16,{to:ve,from:ce}),me(ce,ce,!0,!1)),(ee?Promise.resolve(ee):ze(ve,ce)).catch(Ge=>Ya(Ge)?Ya(Ge,2)?Ge:oe(Ge):Q(Ge,ve,ce)).then(Ge=>{if(Ge){if(Ya(Ge,2))return Pe(di({replace:K},Z(Ge.to),{state:typeof Ge.to=="object"?di({},ue,Ge.to.state):ue,force:V}),H||ve)}else Ge=J(ve,ce,!0,K,ue);return te(ve,ce,Ge),Ge})}function xe(U,H){const $=se(U,H);return $?Promise.reject($):Promise.resolve()}function Be(U){const H=ae.values().next().value;return H&&typeof H.runWithContext=="function"?H.runWithContext(U):U()}function ze(U,H){let $;const[ce,ue,V]=G5(U,H);$=qd(ce.reverse(),"beforeRouteLeave",U,H);for(const ye of ce)ye.leaveGuards.forEach(ve=>{$.push(kl(ve,U,H))});const K=xe.bind(null,U,H);return $.push(K),R($).then(()=>{$=[];for(const ye of a.list())$.push(kl(ye,U,H));return $.push(K),R($)}).then(()=>{$=qd(ue,"beforeRouteUpdate",U,H);for(const ye of ue)ye.updateGuards.forEach(ve=>{$.push(kl(ve,U,H))});return $.push(K),R($)}).then(()=>{$=[];for(const ye of V)if(ye.beforeEnter)if(ia(ye.beforeEnter))for(const ve of ye.beforeEnter)$.push(kl(ve,U,H));else $.push(kl(ye.beforeEnter,U,H));return $.push(K),R($)}).then(()=>(U.matched.forEach(ye=>ye.enterCallbacks={}),$=qd(V,"beforeRouteEnter",U,H,Be),$.push(K),R($))).then(()=>{$=[];for(const ye of u.list())$.push(kl(ye,U,H));return $.push(K),R($)}).catch(ye=>Ya(ye,8)?ye:Promise.reject(ye))}function te(U,H,$){d.list().forEach(ce=>Be(()=>ce(U,H,$)))}function J(U,H,$,ce,ue){const V=se(U,H);if(V)return V;const K=H===_l,ye=ku?history.state:{};$&&(ce||K?o.replace(U.fullPath,di({scroll:K&&ye&&ye.scroll},ue)):o.push(U.fullPath,ue)),f.value=U,me(U,H,$,K),oe()}let Ee;function he(){Ee||(Ee=o.listen((U,H,$)=>{if(!q.listening)return;const ce=O(U),ue=$e(ce);if(ue){Pe(di(ue,{replace:!0,force:!0}),ce).catch(vc);return}v=ce;const V=f.value;ku&&m5(k0(V.fullPath,$.delta),cd()),ze(ce,V).catch(K=>Ya(K,12)?K:Ya(K,2)?(Pe(di(Z(K.to),{force:!0}),ce).then(ye=>{Ya(ye,20)&&!$.delta&&$.type===Bc.pop&&o.go(-1,!1)}).catch(vc),Promise.reject()):($.delta&&o.go(-$.delta,!1),Q(K,ce,V))).then(K=>{K=K||J(ce,V,!1),K&&($.delta&&!Ya(K,8)?o.go(-$.delta,!1):$.type===Bc.pop&&Ya(K,20)&&o.go(-1,!1)),te(ce,V,K)}).catch(vc)}))}let P=nc(),F=nc(),G;function Q(U,H,$){oe(U);const ce=F.list();return ce.length?ce.forEach(ue=>ue(U,H,$)):console.error(U),Promise.reject(U)}function Ae(){return G&&f.value!==_l?Promise.resolve():new Promise((U,H)=>{P.add([U,H])})}function oe(U){return G||(G=!U,he(),P.list().forEach(([H,$])=>U?$(U):H()),P.reset()),U}function me(U,H,$,ce){const{scrollBehavior:ue}=e;if(!ku||!ue)return Promise.resolve();const V=!$&&v5(k0(U.fullPath,0))||(ce||!$)&&history.state&&history.state.scroll||null;return Di().then(()=>ue(U,H,V)).then(K=>K&&g5(K)).catch(K=>Q(K,U,H))}const T=U=>o.go(U);let ne;const ae=new Set,q={currentRoute:f,listening:!0,addRoute:w,removeRoute:N,clearRoutes:t.clearRoutes,hasRoute:W,getRoutes:z,resolve:O,options:e,push:Se,replace:Ne,go:T,back:()=>T(-1),forward:()=>T(1),beforeEach:a.add,beforeResolve:u.add,afterEach:d.add,onError:F.add,isReady:Ae,install(U){const H=this;U.component("RouterLink",Su),U.component("RouterView",E1),U.config.globalProperties.$router=H,Object.defineProperty(U.config.globalProperties,"$route",{enumerable:!0,get:()=>mn(f)}),ku&&!ne&&f.value===_l&&(ne=!0,Se(o.location).catch(ue=>{}));const $={};for(const ue in _l)Object.defineProperty($,ue,{get:()=>f.value[ue],enumerable:!0});U.provide(hd,H),U.provide(up,Jg($)),U.provide(Cf,f);const ce=U.unmount;ae.add(U),U.unmount=function(){ae.delete(U),ae.size<1&&(v=_l,Ee&&Ee(),Ee=null,f.value=_l,ne=!1,G=!1),ce()}}};function R(U){return U.reduce((H,$)=>H.then(()=>Be($)),Promise.resolve())}return q}function G5(e,t){const n=[],i=[],o=[],a=Math.max(t.matched.length,e.matched.length);for(let u=0;u<a;u++){const d=t.matched[u];d&&(e.matched.find(v=>Uu(v,d))?i.push(d):n.push(d));const f=e.matched[u];f&&(t.matched.find(v=>Uu(v,f))||o.push(f))}return[n,i,o]}function dd(){return Do(hd)}function tA(e){return Do(up)}const _c=id("notification",()=>{const e=Dt([]),t=Dt(0),n=Dt(null),i=jn(()=>[...e.value].sort((x,k)=>k.timestamp-x.timestamp));function o({type:x,message:k,duration:w=5e3}){const N=++t.value,z=Date.now(),W={id:N,type:x,message:k,duration:w,timestamp:z};return e.value.push(W),n.value=N,w>0&&setTimeout(()=>{v(N)},w),N}const a=(x,k=5e3)=>o({type:"success",message:x,duration:k}),u=(x,k=5e3)=>o({type:"error",message:x,duration:k}),d=(x,k=5e3)=>o({type:"info",message:x,duration:k}),f=(x,k=5e3)=>o({type:"warning",message:x,duration:k});function v(x){const k=e.value.findIndex(w=>w.id===x);k!==-1&&e.value.splice(k,1),n.value===x&&(n.value=null)}function _(){e.value=[],n.value=null}return{notifications:i,lastAddedId:n,addNotification:o,removeNotification:v,clearAll:_,success:a,error:u,info:d,warning:f}});var To=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function A1(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function H5(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var M1=H5,W5=typeof To=="object"&&To&&To.Object===Object&&To,Z5=W5,K5=Z5,Y5=typeof self=="object"&&self&&self.Object===Object&&self,J5=K5||Y5||Function("return this")(),B1=J5,X5=B1,Q5=function(){return X5.Date.now()},eb=Q5,tb=/\s/;function nb(e){for(var t=e.length;t--&&tb.test(e.charAt(t)););return t}var ib=nb,rb=ib,sb=/^\s+/;function ob(e){return e&&e.slice(0,rb(e)+1).replace(sb,"")}var ab=ob,lb=B1,ub=lb.Symbol,T1=ub,U0=T1,N1=Object.prototype,cb=N1.hasOwnProperty,hb=N1.toString,ic=U0?U0.toStringTag:void 0;function db(e){var t=cb.call(e,ic),n=e[ic];try{e[ic]=void 0;var i=!0}catch{}var o=hb.call(e);return i&&(t?e[ic]=n:delete e[ic]),o}var fb=db,pb=Object.prototype,gb=pb.toString;function mb(e){return gb.call(e)}var vb=mb,$0=T1,yb=fb,_b=vb,bb="[object Null]",wb="[object Undefined]",q0=$0?$0.toStringTag:void 0;function xb(e){return e==null?e===void 0?wb:bb:q0&&q0 in Object(e)?yb(e):_b(e)}var Lb=xb;function Cb(e){return e!=null&&typeof e=="object"}var Pb=Cb,kb=Lb,Sb=Pb,Eb="[object Symbol]";function Ab(e){return typeof e=="symbol"||Sb(e)&&kb(e)==Eb}var Mb=Ab,Bb=ab,V0=M1,Tb=Mb,G0=NaN,Nb=/^[-+]0x[0-9a-f]+$/i,Db=/^0b[01]+$/i,Rb=/^0o[0-7]+$/i,Ob=parseInt;function Ib(e){if(typeof e=="number")return e;if(Tb(e))return G0;if(V0(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=V0(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=Bb(e);var n=Db.test(e);return n||Rb.test(e)?Ob(e.slice(2),n?2:8):Nb.test(e)?G0:+e}var Fb=Ib,jb=M1,Vd=eb,H0=Fb,zb="Expected a function",Ub=Math.max,$b=Math.min;function qb(e,t,n){var i,o,a,u,d,f,v=0,_=!1,x=!1,k=!0;if(typeof e!="function")throw new TypeError(zb);t=H0(t)||0,jb(n)&&(_=!!n.leading,x="maxWait"in n,a=x?Ub(H0(n.maxWait)||0,t):a,k="trailing"in n?!!n.trailing:k);function w($e){var Pe=i,xe=o;return i=o=void 0,v=$e,u=e.apply(xe,Pe),u}function N($e){return v=$e,d=setTimeout(O,t),_?w($e):u}function z($e){var Pe=$e-f,xe=$e-v,Be=t-Pe;return x?$b(Be,a-xe):Be}function W($e){var Pe=$e-f,xe=$e-v;return f===void 0||Pe>=t||Pe<0||x&&xe>=a}function O(){var $e=Vd();if(W($e))return Z($e);d=setTimeout(O,z($e))}function Z($e){return d=void 0,k&&i?w($e):(i=o=void 0,u)}function se(){d!==void 0&&clearTimeout(d),v=0,i=f=o=d=void 0}function Se(){return d===void 0?u:Z(Vd())}function Ne(){var $e=Vd(),Pe=W($e);if(i=arguments,o=this,f=$e,Pe){if(d===void 0)return N(f);if(x)return clearTimeout(d),d=setTimeout(O,t),w(f)}return d===void 0&&(d=setTimeout(O,t)),u}return Ne.cancel=se,Ne.flush=Se,Ne}var Vb=qb;const Gb=A1(Vb),Hb={class:"relative w-full"},Wb={key:0,class:"search-results w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-y-auto"},Zb=["onClick"],W0=Hs({__name:"SearchBar",emits:["select-location"],setup(e,{emit:t}){const n=Dt(""),i=Dt([]),o=t,a=Gb(async f=>{if(f.length<3){i.value=[];return}try{const _=await(await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(f)}`)).json();i.value=_}catch(v){console.error("Erreur lors de la recherche d'adresse:",v),i.value=[]}},300);function u(){a(n.value)}function d(f){n.value=f.display_name,i.value=[],o("select-location",{lat:parseFloat(f.lat),lng:parseFloat(f.lon)})}return(f,v)=>(Ie(),je("div",Hb,[un(A("input",{"onUpdate:modelValue":v[0]||(v[0]=_=>n.value=_),onInput:u,type:"text",placeholder:"Rechercher une adresse...",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"},null,544),[[Zn,n.value]]),i.value.length>0?(Ie(),je("div",Wb,[(Ie(!0),je(Qt,null,En(i.value,_=>(Ie(),je("div",{key:_.place_id,onClick:x=>d(_),class:"px-4 py-2 hover:bg-gray-100 cursor-pointer"},Bt(_.display_name),9,Zb))),128))])):Wt("",!0)]))}}),Kb={class:"h-screen flex flex-col"},Yb={key:0,class:"bg-white shadow-sm z-[2000]"},Jb={class:"mx-auto px-4 sm:px-6 lg:px-8"},Xb={class:"flex h-16 items-center justify-between"},Qb={class:"flex items-center space-x-8"},e3={class:"hidden md:flex space-x-6"},t3={key:0,class:"hidden md:block flex-1 mx-8"},n3={key:1,class:"flex-1"},i3={class:"flex items-center space-x-2 md:space-x-4"},r3={class:"flex md:hidden"},s3={class:"h-6 w-6",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},o3={key:0,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 12h16M4 18h16"},a3={key:1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"},l3={class:"relative"},u3={class:"flex items-center h-full px-3 motion-reduce:transition-none"},c3={class:"flex-shrink-0"},h3={key:0,class:"h-5 w-5 text-white",viewBox:"0 0 20 20",fill:"currentColor"},d3={key:1,class:"h-5 w-5 text-white",viewBox:"0 0 20 20",fill:"currentColor"},f3={key:2,class:"h-5 w-5 text-white",viewBox:"0 0 20 20",fill:"currentColor"},p3={key:3,class:"h-5 w-5 text-white",viewBox:"0 0 20 20",fill:"currentColor"},g3={key:0,class:"ml-2 text-white font-medium message-container"},m3={key:0,class:"absolute right-0 mt-2 w-80 origin-top-right rounded-md bg-white py-1 shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none z-[3000]"},v3={class:"px-4 py-2 border-b border-gray-100 flex justify-between items-center"},y3={class:"max-h-72 overflow-y-auto"},_3={key:0,class:"px-4 py-3 text-sm text-gray-500 text-center"},b3={class:"flex items-start"},w3={class:"flex-shrink-0 mr-3"},x3={key:0,class:"h-5 w-5 text-green-400",viewBox:"0 0 20 20",fill:"currentColor"},L3={key:1,class:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor"},C3={key:2,class:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor"},P3={key:3,class:"h-5 w-5 text-blue-400",viewBox:"0 0 20 20",fill:"currentColor"},k3={class:"flex-1"},S3={class:"text-sm text-gray-800"},E3=["onClick"],A3={class:"relative"},M3={class:"hidden md:flex flex-col items-end"},B3={class:"text-sm font-medium text-gray-700"},T3={key:0,class:"text-xs text-gray-500"},N3=["src","alt"],D3={key:0,class:"absolute right-0 mt-2 w-48 origin-top-right rounded-md bg-white py-1 shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none z-[3000]"},R3={class:"md:hidden px-4 py-2 border-b border-gray-100"},O3={class:"text-sm font-medium text-gray-700"},I3={class:"text-xs text-gray-500"},F3={key:0,class:"md:hidden"},j3={class:"space-y-1 px-2 pb-3 pt-2"},z3={key:0,class:"px-4 py-3"},U3={key:0,class:"fixed inset-0 bg-white z-[2001] flex flex-col items-center justify-center p-6 text-center"},$3=Hs({__name:"App",setup(e){const t=dd(),n=ds(),i=_c(),o=Dt(!1),a=Dt(!1),u=Dt(!1),d=Dt(!1),f=Dt(!1),v=Dt(null),_=Dt(!1),x=Dt(null),k=Dt("13px"),w=Dt("65px");function N(){d.value=window.innerWidth<768}Ta(()=>{N(),window.addEventListener("resize",N),window.addEventListener("resize",z)}),Yh(()=>{window.removeEventListener("resize",N),window.removeEventListener("resize",z)});function z(){if(!x.value)return;const he=x.value.getBoundingClientRect();k.value=`${he.top+window.scrollY+5}px`;const P=he.left+he.width/2;w.value=`${window.innerWidth-P-22}px`}const W=jn(()=>{const he=n.user;if(!he)return"";const P=`${he.first_name} ${he.last_name.toUpperCase()}`;return he.company_name?`${P} (${he.company_name})`:P}),O=jn(()=>{var P;switch((P=n.user)==null?void 0:P.user_type){case"admin":return"Accs administrateur";case"usine":return"Accs usine";case"concessionnaire":return"Accs concessionnaire";case"agriculteur":return"Accs agriculteur";default:return""}}),Z=jn(()=>{var he;return((he=n.user)==null?void 0:he.user_type)==="admin"}),se=Dt(""),Se=jn(()=>n.isAuthenticated),Ne=[{name:"Carte",to:"/"},{name:"Plans",to:"/plans"}],$e=jn(()=>{var P,F;if(!Se.value)return[];const he=[...Ne];return(Z.value||((P=n.user)==null?void 0:P.user_type)==="usine"||((F=n.user)==null?void 0:F.user_type)==="concessionnaire")&&he.push({name:"Utilisateurs",to:"/users"}),he}),Pe=jn(()=>Se.value?[{name:"Mon profil",to:"/profile"}]:[]);async function xe(){try{await n.logout(),t.push("/login")}catch(he){console.error("Erreur lors de la dconnexion:",he)}}function Be(he){window.dispatchEvent(new CustomEvent("map-set-location",{detail:{lat:he.lat,lng:he.lng,zoom:16}}))}Ta(async()=>{console.log("App mounted, checking auth...");try{localStorage.getItem("token")?(console.log("Token found, checking auth..."),await n.checkAuth(),await n.fetchUserProfile()):console.log("No token found")}catch(he){console.error("Auth check error:",he),t.push("/login")}});const ze=jn(()=>{const he="IrrigationDesign";if(!Se.value)return`${he} - Connexion`;const P=t.currentRoute.value,G={home:"Carte",plans:"Plans",users:"Utilisateurs",profile:"Mon profil",selectConcessionnaire:"Slection du concessionnaire",changePassword:"Changement de mot de passe",map:"Carte"}[P.name]||"";return G?`${he} - ${G}`:he});Qi(ze,he=>{document.title=he},{immediate:!0});const te=jn(()=>i.notifications.length);function J(){i.clearAll(),u.value=!1}function Ee(){v.value&&(_.value=!1,setTimeout(()=>{v.value=null},300))}return hf(()=>{if(i.lastAddedId!==null){const he=i.notifications.find(P=>P.id===i.lastAddedId);he&&Di(()=>{z(),f.value=!0,v.value={id:he.id,message:he.message,type:he.type},requestAnimationFrame(()=>{setTimeout(()=>{_.value=!0,setTimeout(()=>{_.value=!1,setTimeout(()=>{var P;((P=v.value)==null?void 0:P.id)===he.id&&(v.value=null,f.value=!1)},300)},4e3)},50)})})}}),(he,P)=>(Ie(),je("div",Kb,[Se.value?(Ie(),je("header",Yb,[A("nav",Jb,[A("div",Xb,[A("div",Qb,[Ci(mn(Su),{to:"/",class:"text-xl font-semibold text-primary-600 truncate"},{default:Qo(()=>P[5]||(P[5]=[A("span",{class:"md:inline hidden"},"IrrigationDesign",-1),A("span",{class:"md:hidden inline"},"ID",-1)])),_:1}),A("div",e3,[(Ie(!0),je(Qt,null,En($e.value,F=>(Ie(),Al(mn(Su),{key:F.name,to:F.to,class:zi(["text-sm font-medium transition-colors duration-200",[he.$route.path===F.to?"text-primary-600 border-b-2 border-primary-500":"text-gray-500 hover:text-gray-900"]])},{default:Qo(()=>[vi(Bt(F.name),1)]),_:2},1032,["to","class"]))),128))])]),he.$route.path==="/"?(Ie(),je("div",t3,[Ci(W0,{onSelectLocation:Be})])):(Ie(),je("div",n3)),A("div",i3,[A("div",r3,[A("button",{onClick:P[0]||(P[0]=F=>a.value=!a.value),class:"inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-primary-500"},[P[6]||(P[6]=A("span",{class:"sr-only"},"Ouvrir le menu",-1)),(Ie(),je("svg",s3,[a.value?(Ie(),je("path",a3)):(Ie(),je("path",o3))]))])]),A("div",l3,[A("button",{ref_key:"bellButtonRef",ref:x,onClick:P[1]||(P[1]=F=>u.value=!u.value),class:zi(["relative flex items-center justify-center p-2 text-gray-400 hover:text-gray-500 rounded-full hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2",{"animate-bell":f.value}])},P[7]||(P[7]=[A("span",{class:"sr-only"},"Voir les notifications",-1),A("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})],-1)]),2),Ci(Nh,{name:"island"},{default:Qo(()=>[v.value?(Ie(),je("div",{key:0,class:zi(["dynamic-island fixed z-[9999] shadow-xl",[_.value?"island-expanded":"island-pill",v.value.type==="success"?"bg-green-500":v.value.type==="error"?"bg-red-500":v.value.type==="warning"?"bg-yellow-500":"bg-blue-500"]]),style:Oc({top:k.value,right:w.value,transform:"translateZ(0)"}),onClick:Ee},[A("div",u3,[A("div",c3,[v.value.type==="success"?(Ie(),je("svg",h3,P[8]||(P[8]=[A("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"},null,-1)]))):v.value.type==="error"?(Ie(),je("svg",d3,P[9]||(P[9]=[A("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"},null,-1)]))):v.value.type==="warning"?(Ie(),je("svg",f3,P[10]||(P[10]=[A("path",{"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"},null,-1)]))):(Ie(),je("svg",p3,P[11]||(P[11]=[A("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z","clip-rule":"evenodd"},null,-1)])))]),Ci(Nh,{name:"message",duration:{enter:200,leave:150}},{default:Qo(()=>[_.value?(Ie(),je("div",g3,Bt(v.value.message),1)):Wt("",!0)]),_:1})])],6)):Wt("",!0)]),_:1}),u.value?(Ie(),je("div",m3,[A("div",v3,[P[12]||(P[12]=A("h3",{class:"text-sm font-semibold text-gray-700"},"Notifications",-1)),te.value>0?(Ie(),je("button",{key:0,onClick:J,class:"text-xs text-primary-600 hover:text-primary-800"}," Tout effacer ")):Wt("",!0)]),A("div",y3,[te.value===0?(Ie(),je("div",_3," Aucune notification ")):Wt("",!0),(Ie(!0),je(Qt,null,En(mn(i).notifications,F=>(Ie(),je("div",{key:F.id,class:"px-4 py-3 border-b border-gray-100 last:border-0 hover:bg-gray-50"},[A("div",b3,[A("div",w3,[F.type==="success"?(Ie(),je("svg",x3,P[13]||(P[13]=[A("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"},null,-1)]))):F.type==="error"?(Ie(),je("svg",L3,P[14]||(P[14]=[A("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"},null,-1)]))):F.type==="warning"?(Ie(),je("svg",C3,P[15]||(P[15]=[A("path",{"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"},null,-1)]))):(Ie(),je("svg",P3,P[16]||(P[16]=[A("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z","clip-rule":"evenodd"},null,-1)])))]),A("div",k3,[A("p",S3,Bt(F.message),1),A("button",{onClick:G=>mn(i).removeNotification(F.id),class:"text-xs text-primary-600 hover:text-primary-800 mt-1"}," Fermer ",8,E3)])])]))),128))])])):Wt("",!0)]),A("div",A3,[A("button",{onClick:P[2]||(P[2]=F=>o.value=!o.value),class:"flex items-center space-x-2 md:space-x-3 focus:outline-none"},[A("div",M3,[A("span",B3,Bt(W.value),1),O.value?(Ie(),je("span",T3,Bt(O.value),1)):Wt("",!0)]),A("img",{class:"h-8 w-8 rounded-full ring-2 ring-white",src:se.value||"https://ui-avatars.com/api/?name="+encodeURIComponent(W.value),alt:W.value},null,8,N3)]),o.value?(Ie(),je("div",D3,[A("div",R3,[A("div",O3,Bt(W.value),1),A("div",I3,Bt(O.value),1)]),(Ie(!0),je(Qt,null,En(Pe.value,F=>(Ie(),Al(mn(Su),{key:F.name,to:F.to,class:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-50",onClick:P[3]||(P[3]=G=>o.value=!1)},{default:Qo(()=>[vi(Bt(F.name),1)]),_:2},1032,["to"]))),128)),A("button",{onClick:xe,class:"block w-full px-4 py-2 text-left text-sm text-red-600 hover:bg-gray-50"}," Dconnexion ")])):Wt("",!0)])])]),a.value?(Ie(),je("div",F3,[A("div",j3,[(Ie(!0),je(Qt,null,En($e.value,F=>(Ie(),Al(mn(Su),{key:F.name,to:F.to,class:zi(["block px-3 py-2 rounded-md text-base font-medium",[he.$route.path===F.to?"bg-primary-50 text-primary-600":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"]]),onClick:P[4]||(P[4]=G=>a.value=!1)},{default:Qo(()=>[vi(Bt(F.name),1)]),_:2},1032,["to","class"]))),128))]),he.$route.path==="/"?(Ie(),je("div",z3,[Ci(W0,{onSelectLocation:Be})])):Wt("",!0)])):Wt("",!0)])])):Wt("",!0),A("main",{class:zi([he.$route.path==="/"?"overflow-hidden":"overflow-auto","flex-1 flex flex-col"])},[d.value&&he.$route.path==="/"?(Ie(),je("div",U3,[P[18]||(P[18]=A("svg",{class:"w-24 h-24 text-primary-500 mb-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})],-1)),P[19]||(P[19]=A("h2",{class:"text-2xl font-bold text-gray-900 mb-4"}," Version bureau recommande ",-1)),P[20]||(P[20]=A("p",{class:"text-gray-600 mb-8 max-w-md"}," Pour une meilleure exprience de conception d'irrigation, nous vous recommandons d'utiliser un cran plus large ou un ordinateur. ",-1)),Ci(mn(Su),{to:"/plans",class:"inline-flex items-center px-4 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-primary-600 hover:bg-primary-700"},{default:Qo(()=>P[17]||(P[17]=[vi(" Voir mes plans ")])),_:1})])):(Ie(),Al(mn(E1),{key:1}))],2)]))}}),q3="modulepreload",V3=function(e){return"/static/frontend/"+e},Z0={},eu=function(t,n,i){let o=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const u=document.querySelector("meta[property=csp-nonce]"),d=(u==null?void 0:u.nonce)||(u==null?void 0:u.getAttribute("nonce"));o=Promise.allSettled(n.map(f=>{if(f=V3(f),f in Z0)return;Z0[f]=!0;const v=f.endsWith(".css"),_=v?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${_}`))return;const x=document.createElement("link");if(x.rel=v?"stylesheet":q3,v||(x.as="script"),x.crossOrigin="",x.href=f,d&&x.setAttribute("nonce",d),document.head.appendChild(x),v)return new Promise((k,w)=>{x.addEventListener("load",k),x.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${f}`)))})}))}function a(u){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=u,window.dispatchEvent(d),!d.defaultPrevented)throw u}return o.then(u=>{for(const d of u||[])d.status==="rejected"&&a(d.reason);return t().catch(a)})},G3={class:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8"},H3={class:"max-w-md w-full space-y-8"},W3={class:"space-y-4"},Z3={class:"mt-1"},K3={class:"mt-1"},Y3={class:"mt-1"},J3={key:0,class:"rounded-md bg-red-50 p-4"},X3={class:"flex"},Q3={class:"ml-3"},ew={class:"text-sm font-medium text-red-800"},tw={key:1,class:"rounded-md bg-yellow-50 p-4"},nw={class:"flex"},iw={class:"ml-3"},rw={class:"mt-2 text-sm text-yellow-700"},sw={class:"list-disc pl-5 space-y-1"},ow=["disabled"],aw={class:"absolute left-0 inset-y-0 flex items-center pl-3"},lw={key:0,class:"h-5 w-5 text-primary-500 group-hover:text-primary-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},uw={key:1,class:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},cw=Hs({__name:"ChangePasswordForm",setup(e){const t=dd(),n=ds(),i=il({oldPassword:"",newPassword:"",confirmPassword:""}),o=Dt(!1),a=Dt("");Ta(()=>{var v,_;console.log("ChangePasswordForm mounted, auth state:",{isAuthenticated:n.isAuthenticated,userId:(v=n.user)==null?void 0:v.id,mustChangePassword:(_=n.user)==null?void 0:_.must_change_password})});const u=jn(()=>{const v=[];return i.newPassword&&i.newPassword.length<8&&v.push("Le nouveau mot de passe doit contenir au moins 8 caractres"),i.newPassword&&i.confirmPassword&&i.newPassword!==i.confirmPassword&&v.push("Les mots de passe ne correspondent pas"),v}),d=jn(()=>i.oldPassword.length>0&&i.newPassword.length>=8&&i.newPassword===i.confirmPassword);async function f(){var v,_,x,k,w,N,z,W;if(!d.value){a.value="Veuillez corriger les erreurs avant de continuer";return}if(!((v=n.user)!=null&&v.id)){a.value="Erreur : utilisateur non identifi";return}o.value=!0,a.value="";try{console.log("Submitting password change..."),await n.changePassword(i.oldPassword,i.newPassword),console.log("Password changed successfully"),t.push("/")}catch(O){console.error("Password change failed:",O),(x=(_=O.response)==null?void 0:_.data)!=null&&x.detail?a.value=O.response.data.detail:(w=(k=O.response)==null?void 0:k.data)!=null&&w.old_password?a.value=O.response.data.old_password[0]:(z=(N=O.response)==null?void 0:N.data)!=null&&z.password?a.value=O.response.data.password[0]:((W=O.response)==null?void 0:W.status)===401?(a.value="Session expire, veuillez vous reconnecter",await n.logout(),t.push("/login")):a.value="Une erreur est survenue lors du changement de mot de passe"}finally{o.value=!1}}return(v,_)=>(Ie(),je("div",G3,[A("div",H3,[_[12]||(_[12]=A("div",null,[A("h2",{class:"mt-6 text-center text-3xl font-extrabold text-gray-900"}," Changement de mot de passe "),A("p",{class:"mt-2 text-center text-sm text-gray-600"}," Pour des raisons de scurit, vous devez changer votre mot de passe. ")],-1)),A("form",{class:"mt-8 space-y-6",onSubmit:td(f,["prevent"])},[A("div",W3,[A("div",null,[_[3]||(_[3]=A("label",{for:"old-password",class:"block text-sm font-medium text-gray-700"},"Ancien mot de passe",-1)),A("div",Z3,[un(A("input",{id:"old-password","onUpdate:modelValue":_[0]||(_[0]=x=>i.oldPassword=x),name:"old-password",type:"password",required:"",autocomplete:"current-password",class:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm",placeholder:"Entrez votre mot de passe actuel"},null,512),[[Zn,i.oldPassword]])])]),A("div",null,[_[4]||(_[4]=A("label",{for:"new-password",class:"block text-sm font-medium text-gray-700"},"Nouveau mot de passe",-1)),A("div",K3,[un(A("input",{id:"new-password","onUpdate:modelValue":_[1]||(_[1]=x=>i.newPassword=x),name:"new-password",type:"password",required:"",autocomplete:"new-password",class:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm",placeholder:"Entrez votre nouveau mot de passe"},null,512),[[Zn,i.newPassword]])]),_[5]||(_[5]=A("p",{class:"mt-1 text-sm text-gray-500"}," Le mot de passe doit contenir au moins 8 caractres ",-1))]),A("div",null,[_[6]||(_[6]=A("label",{for:"confirm-password",class:"block text-sm font-medium text-gray-700"},"Confirmer le mot de passe",-1)),A("div",Y3,[un(A("input",{id:"confirm-password","onUpdate:modelValue":_[2]||(_[2]=x=>i.confirmPassword=x),name:"confirm-password",type:"password",required:"",autocomplete:"new-password",class:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm",placeholder:"Confirmez votre nouveau mot de passe"},null,512),[[Zn,i.confirmPassword]])])])]),a.value?(Ie(),je("div",J3,[A("div",X3,[_[7]||(_[7]=A("div",{class:"flex-shrink-0"},[A("svg",{class:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor"},[A("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})])],-1)),A("div",Q3,[A("h3",ew,Bt(a.value),1)])])])):Wt("",!0),u.value.length>0?(Ie(),je("div",tw,[A("div",nw,[_[9]||(_[9]=A("div",{class:"flex-shrink-0"},[A("svg",{class:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor"},[A("path",{"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"})])],-1)),A("div",iw,[_[8]||(_[8]=A("h3",{class:"text-sm font-medium text-yellow-800"},"Attention",-1)),A("div",rw,[A("ul",sw,[(Ie(!0),je(Qt,null,En(u.value,(x,k)=>(Ie(),je("li",{key:k},Bt(x),1))),128))])])])])])):Wt("",!0),A("div",null,[A("button",{type:"submit",disabled:o.value||!d.value,class:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50"},[A("span",aw,[o.value?(Ie(),je("svg",uw,_[11]||(_[11]=[A("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),A("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):(Ie(),je("svg",lw,_[10]||(_[10]=[A("path",{"fill-rule":"evenodd",d:"M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z","clip-rule":"evenodd"},null,-1)])))]),vi(" "+Bt(o.value?"Modification en cours...":"Changer le mot de passe"),1)],8,ow)])],32)])]))}}),hw="/static/frontend/assets/logo.svg",dw={class:"min-h-screen bg-white from-blue-50 to-white flex flex-col justify-center py-12 sm:px-6 lg:px-8"},fw={class:"mt-8 sm:mx-auto sm:w-full sm:max-w-md"},pw={class:"bg-white py-8 px-6 shadow-lg rounded-md sm:px-10"},gw={key:0,class:"rounded-md bg-red-50 p-4"},mw={class:"flex"},vw={class:"ml-3"},yw={class:"text-sm font-medium text-red-800"},_w={class:"mt-1"},bw={class:"mt-1 relative"},ww=["type"],xw={key:0,class:"h-5 w-5 text-gray-400 hover:text-gray-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},Lw={key:1,class:"h-5 w-5 text-gray-400 hover:text-gray-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},Cw={class:"flex items-center justify-between"},Pw={class:"flex items-center"},kw={class:"text-sm"},Sw=["disabled"],Ew={key:0,class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},Aw=Hs({__name:"LoginView",setup(e){const t=dd(),n=ds(),i=Dt(!1),o=Dt(null),a=Dt(!1),u=il({username:"",password:"",rememberMe:!1});Ta(()=>{var f;console.log("LoginView mounted"),console.log("INITIAL_STATE:",window.INITIAL_STATE),(f=window.INITIAL_STATE)!=null&&f.isAuthenticated&&(console.log("User is authenticated, redirecting to home"),t.push("/"))});async function d(){var f,v,_,x,k,w,N,z,W;i.value=!0,o.value=null;try{if(!u.username||!u.password){o.value="Veuillez remplir tous les champs";return}await n.login(u.username,u.password),(f=n.user)!=null&&f.must_change_password?t.push("/change-password"):t.push("/")}catch(O){console.error("Login error:",O),((v=O==null?void 0:O.response)==null?void 0:v.status)===500?o.value="Le service est temporairement indisponible. Veuillez ressayer dans quelques instants.":((_=O==null?void 0:O.response)==null?void 0:_.status)===401||((x=O==null?void 0:O.response)==null?void 0:x.status)===403?o.value="Identifiants incorrects. Veuillez vrifier votre nom d'utilisateur et mot de passe.":(w=(k=O==null?void 0:O.response)==null?void 0:k.data)!=null&&w.detail?o.value=O.response.data.detail:(W=(z=(N=O==null?void 0:O.response)==null?void 0:N.data)==null?void 0:z.non_field_errors)!=null&&W[0]?o.value=O.response.data.non_field_errors[0]:(O==null?void 0:O.message)==="Network Error"?o.value="Impossible de se connecter au serveur. Veuillez vrifier votre connexion internet.":o.value="Une erreur est survenue lors de la connexion. Veuillez ressayer."}finally{i.value=!1}}return(f,v)=>{const _=Ey("router-link");return Ie(),je("div",dw,[v[12]||(v[12]=A("div",{class:"sm:mx-auto sm:w-full sm:max-w-md"},[A("img",{src:hw,alt:"IrrigationDesign Logo",class:"mx-auto h-40 w-auto transition-transform duration-300 hover:scale-110"}),A("h2",{class:"mt-2 text-center text-3xl font-bold text-gray-800"}," IrrigationDesign "),A("p",{class:"mt-2 text-center text-sm text-gray-600"}," Connectez-vous pour accder  votre espace ")],-1)),A("div",fw,[A("div",pw,[A("form",{class:"space-y-6",onSubmit:td(d,["prevent"])},[o.value?(Ie(),je("div",gw,[A("div",mw,[v[4]||(v[4]=A("div",{class:"flex-shrink-0"},[A("svg",{class:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor"},[A("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})])],-1)),A("div",vw,[A("h3",yw,Bt(o.value),1)])])])):Wt("",!0),A("div",null,[v[5]||(v[5]=A("label",{for:"username",class:"block text-sm font-medium text-gray-700"}," Nom d'utilisateur ",-1)),A("div",_w,[un(A("input",{id:"username","onUpdate:modelValue":v[0]||(v[0]=x=>u.username=x),name:"username",type:"text",required:"",autocomplete:"username",class:"appearance-none block w-full h-11 px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 sm:text-sm","aria-label":"Nom d'utilisateur"},null,512),[[Zn,u.username]])])]),A("div",null,[v[8]||(v[8]=A("label",{for:"password",class:"block text-sm font-medium text-gray-700"}," Mot de passe ",-1)),A("div",bw,[un(A("input",{id:"password","onUpdate:modelValue":v[1]||(v[1]=x=>u.password=x),type:a.value?"text":"password",name:"password",required:"",autocomplete:"current-password",class:"appearance-none block w-full h-11 px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 sm:text-sm pr-10","aria-label":"Mot de passe"},null,8,ww),[[H2,u.password]]),A("button",{type:"button",onClick:v[2]||(v[2]=x=>a.value=!a.value),class:"absolute inset-y-0 right-0 pr-3 flex items-center","aria-label":"Afficher/masquer le mot de passe"},[a.value?(Ie(),je("svg",xw,v[6]||(v[6]=[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"},null,-1),A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"},null,-1)]))):(Ie(),je("svg",Lw,v[7]||(v[7]=[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"},null,-1)])))])])]),A("div",Cw,[A("div",Pw,[un(A("input",{id:"remember-me","onUpdate:modelValue":v[3]||(v[3]=x=>u.rememberMe=x),name:"remember-me",type:"checkbox",class:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded","aria-label":"Se souvenir de moi"},null,512),[[Fm,u.rememberMe]]),v[9]||(v[9]=A("label",{for:"remember-me",class:"ml-2 block text-sm text-gray-900"}," Se souvenir de moi ",-1))]),A("div",kw,[Ci(_,{to:"/forgot-password",class:"font-medium text-primary-600 hover:text-primary-500 transition-colors duration-200"},{default:Qo(()=>v[10]||(v[10]=[vi(" Mot de passe oubli ? ")])),_:1})])]),A("div",null,[A("button",{type:"submit",disabled:i.value,class:"w-full h-11 flex justify-center items-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"Se connecter"},[i.value?(Ie(),je("svg",Ew,v[11]||(v[11]=[A("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),A("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):Wt("",!0),vi(" "+Bt(i.value?"Connexion en cours...":"Se connecter"),1)],8,Sw)])],32)])])])}}}),K0="/static/frontend/assets/logo.jpeg";var Pf={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(e,t){(function(n,i){i(t)})(To,function(n){var i="1.9.4";function o(r){var c,m,E,j;for(m=1,E=arguments.length;m<E;m++){j=arguments[m];for(c in j)r[c]=j[c]}return r}var a=Object.create||function(){function r(){}return function(c){return r.prototype=c,new r}}();function u(r,c){var m=Array.prototype.slice;if(r.bind)return r.bind.apply(r,m.call(arguments,1));var E=m.call(arguments,2);return function(){return r.apply(c,E.length?E.concat(m.call(arguments)):arguments)}}var d=0;function f(r){return"_leaflet_id"in r||(r._leaflet_id=++d),r._leaflet_id}function v(r,c,m){var E,j,pe,Ve;return Ve=function(){E=!1,j&&(pe.apply(m,j),j=!1)},pe=function(){E?j=arguments:(r.apply(m,arguments),setTimeout(Ve,c),E=!0)},pe}function _(r,c,m){var E=c[1],j=c[0],pe=E-j;return r===E&&m?r:((r-j)%pe+pe)%pe+j}function x(){return!1}function k(r,c){if(c===!1)return r;var m=Math.pow(10,c===void 0?6:c);return Math.round(r*m)/m}function w(r){return r.trim?r.trim():r.replace(/^\s+|\s+$/g,"")}function N(r){return w(r).split(/\s+/)}function z(r,c){Object.prototype.hasOwnProperty.call(r,"options")||(r.options=r.options?a(r.options):{});for(var m in c)r.options[m]=c[m];return r.options}function W(r,c,m){var E=[];for(var j in r)E.push(encodeURIComponent(m?j.toUpperCase():j)+"="+encodeURIComponent(r[j]));return(!c||c.indexOf("?")===-1?"?":"&")+E.join("&")}var O=/\{ *([\w_ -]+) *\}/g;function Z(r,c){return r.replace(O,function(m,E){var j=c[E];if(j===void 0)throw new Error("No value provided for variable "+m);return typeof j=="function"&&(j=j(c)),j})}var se=Array.isArray||function(r){return Object.prototype.toString.call(r)==="[object Array]"};function Se(r,c){for(var m=0;m<r.length;m++)if(r[m]===c)return m;return-1}var Ne="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function $e(r){return window["webkit"+r]||window["moz"+r]||window["ms"+r]}var Pe=0;function xe(r){var c=+new Date,m=Math.max(0,16-(c-Pe));return Pe=c+m,window.setTimeout(r,m)}var Be=window.requestAnimationFrame||$e("RequestAnimationFrame")||xe,ze=window.cancelAnimationFrame||$e("CancelAnimationFrame")||$e("CancelRequestAnimationFrame")||function(r){window.clearTimeout(r)};function te(r,c,m){if(m&&Be===xe)r.call(c);else return Be.call(window,u(r,c))}function J(r){r&&ze.call(window,r)}var Ee={__proto__:null,extend:o,create:a,bind:u,get lastId(){return d},stamp:f,throttle:v,wrapNum:_,falseFn:x,formatNum:k,trim:w,splitWords:N,setOptions:z,getParamString:W,template:Z,isArray:se,indexOf:Se,emptyImageUrl:Ne,requestFn:Be,cancelFn:ze,requestAnimFrame:te,cancelAnimFrame:J};function he(){}he.extend=function(r){var c=function(){z(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},m=c.__super__=this.prototype,E=a(m);E.constructor=c,c.prototype=E;for(var j in this)Object.prototype.hasOwnProperty.call(this,j)&&j!=="prototype"&&j!=="__super__"&&(c[j]=this[j]);return r.statics&&o(c,r.statics),r.includes&&(P(r.includes),o.apply(null,[E].concat(r.includes))),o(E,r),delete E.statics,delete E.includes,E.options&&(E.options=m.options?a(m.options):{},o(E.options,r.options)),E._initHooks=[],E.callInitHooks=function(){if(!this._initHooksCalled){m.callInitHooks&&m.callInitHooks.call(this),this._initHooksCalled=!0;for(var pe=0,Ve=E._initHooks.length;pe<Ve;pe++)E._initHooks[pe].call(this)}},c},he.include=function(r){var c=this.prototype.options;return o(this.prototype,r),r.options&&(this.prototype.options=c,this.mergeOptions(r.options)),this},he.mergeOptions=function(r){return o(this.prototype.options,r),this},he.addInitHook=function(r){var c=Array.prototype.slice.call(arguments,1),m=typeof r=="function"?r:function(){this[r].apply(this,c)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(m),this};function P(r){if(!(typeof L>"u"||!L||!L.Mixin)){r=se(r)?r:[r];for(var c=0;c<r.length;c++)r[c]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var F={on:function(r,c,m){if(typeof r=="object")for(var E in r)this._on(E,r[E],c);else{r=N(r);for(var j=0,pe=r.length;j<pe;j++)this._on(r[j],c,m)}return this},off:function(r,c,m){if(!arguments.length)delete this._events;else if(typeof r=="object")for(var E in r)this._off(E,r[E],c);else{r=N(r);for(var j=arguments.length===1,pe=0,Ve=r.length;pe<Ve;pe++)j?this._off(r[pe]):this._off(r[pe],c,m)}return this},_on:function(r,c,m,E){if(typeof c!="function"){console.warn("wrong listener type: "+typeof c);return}if(this._listens(r,c,m)===!1){m===this&&(m=void 0);var j={fn:c,ctx:m};E&&(j.once=!0),this._events=this._events||{},this._events[r]=this._events[r]||[],this._events[r].push(j)}},_off:function(r,c,m){var E,j,pe;if(this._events&&(E=this._events[r],!!E)){if(arguments.length===1){if(this._firingCount)for(j=0,pe=E.length;j<pe;j++)E[j].fn=x;delete this._events[r];return}if(typeof c!="function"){console.warn("wrong listener type: "+typeof c);return}var Ve=this._listens(r,c,m);if(Ve!==!1){var dt=E[Ve];this._firingCount&&(dt.fn=x,this._events[r]=E=E.slice()),E.splice(Ve,1)}}},fire:function(r,c,m){if(!this.listens(r,m))return this;var E=o({},c,{type:r,target:this,sourceTarget:c&&c.sourceTarget||this});if(this._events){var j=this._events[r];if(j){this._firingCount=this._firingCount+1||1;for(var pe=0,Ve=j.length;pe<Ve;pe++){var dt=j[pe],bt=dt.fn;dt.once&&this.off(r,bt,dt.ctx),bt.call(dt.ctx||this,E)}this._firingCount--}}return m&&this._propagateEvent(E),this},listens:function(r,c,m,E){typeof r!="string"&&console.warn('"string" type argument expected');var j=c;typeof c!="function"&&(E=!!c,j=void 0,m=void 0);var pe=this._events&&this._events[r];if(pe&&pe.length&&this._listens(r,j,m)!==!1)return!0;if(E){for(var Ve in this._eventParents)if(this._eventParents[Ve].listens(r,c,m,E))return!0}return!1},_listens:function(r,c,m){if(!this._events)return!1;var E=this._events[r]||[];if(!c)return!!E.length;m===this&&(m=void 0);for(var j=0,pe=E.length;j<pe;j++)if(E[j].fn===c&&E[j].ctx===m)return j;return!1},once:function(r,c,m){if(typeof r=="object")for(var E in r)this._on(E,r[E],c,!0);else{r=N(r);for(var j=0,pe=r.length;j<pe;j++)this._on(r[j],c,m,!0)}return this},addEventParent:function(r){return this._eventParents=this._eventParents||{},this._eventParents[f(r)]=r,this},removeEventParent:function(r){return this._eventParents&&delete this._eventParents[f(r)],this},_propagateEvent:function(r){for(var c in this._eventParents)this._eventParents[c].fire(r.type,o({layer:r.target,propagatedFrom:r.target},r),!0)}};F.addEventListener=F.on,F.removeEventListener=F.clearAllEventListeners=F.off,F.addOneTimeEventListener=F.once,F.fireEvent=F.fire,F.hasEventListeners=F.listens;var G=he.extend(F);function Q(r,c,m){this.x=m?Math.round(r):r,this.y=m?Math.round(c):c}var Ae=Math.trunc||function(r){return r>0?Math.floor(r):Math.ceil(r)};Q.prototype={clone:function(){return new Q(this.x,this.y)},add:function(r){return this.clone()._add(oe(r))},_add:function(r){return this.x+=r.x,this.y+=r.y,this},subtract:function(r){return this.clone()._subtract(oe(r))},_subtract:function(r){return this.x-=r.x,this.y-=r.y,this},divideBy:function(r){return this.clone()._divideBy(r)},_divideBy:function(r){return this.x/=r,this.y/=r,this},multiplyBy:function(r){return this.clone()._multiplyBy(r)},_multiplyBy:function(r){return this.x*=r,this.y*=r,this},scaleBy:function(r){return new Q(this.x*r.x,this.y*r.y)},unscaleBy:function(r){return new Q(this.x/r.x,this.y/r.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=Ae(this.x),this.y=Ae(this.y),this},distanceTo:function(r){r=oe(r);var c=r.x-this.x,m=r.y-this.y;return Math.sqrt(c*c+m*m)},equals:function(r){return r=oe(r),r.x===this.x&&r.y===this.y},contains:function(r){return r=oe(r),Math.abs(r.x)<=Math.abs(this.x)&&Math.abs(r.y)<=Math.abs(this.y)},toString:function(){return"Point("+k(this.x)+", "+k(this.y)+")"}};function oe(r,c,m){return r instanceof Q?r:se(r)?new Q(r[0],r[1]):r==null?r:typeof r=="object"&&"x"in r&&"y"in r?new Q(r.x,r.y):new Q(r,c,m)}function me(r,c){if(r)for(var m=c?[r,c]:r,E=0,j=m.length;E<j;E++)this.extend(m[E])}me.prototype={extend:function(r){var c,m;if(!r)return this;if(r instanceof Q||typeof r[0]=="number"||"x"in r)c=m=oe(r);else if(r=T(r),c=r.min,m=r.max,!c||!m)return this;return!this.min&&!this.max?(this.min=c.clone(),this.max=m.clone()):(this.min.x=Math.min(c.x,this.min.x),this.max.x=Math.max(m.x,this.max.x),this.min.y=Math.min(c.y,this.min.y),this.max.y=Math.max(m.y,this.max.y)),this},getCenter:function(r){return oe((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,r)},getBottomLeft:function(){return oe(this.min.x,this.max.y)},getTopRight:function(){return oe(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(r){var c,m;return typeof r[0]=="number"||r instanceof Q?r=oe(r):r=T(r),r instanceof me?(c=r.min,m=r.max):c=m=r,c.x>=this.min.x&&m.x<=this.max.x&&c.y>=this.min.y&&m.y<=this.max.y},intersects:function(r){r=T(r);var c=this.min,m=this.max,E=r.min,j=r.max,pe=j.x>=c.x&&E.x<=m.x,Ve=j.y>=c.y&&E.y<=m.y;return pe&&Ve},overlaps:function(r){r=T(r);var c=this.min,m=this.max,E=r.min,j=r.max,pe=j.x>c.x&&E.x<m.x,Ve=j.y>c.y&&E.y<m.y;return pe&&Ve},isValid:function(){return!!(this.min&&this.max)},pad:function(r){var c=this.min,m=this.max,E=Math.abs(c.x-m.x)*r,j=Math.abs(c.y-m.y)*r;return T(oe(c.x-E,c.y-j),oe(m.x+E,m.y+j))},equals:function(r){return r?(r=T(r),this.min.equals(r.getTopLeft())&&this.max.equals(r.getBottomRight())):!1}};function T(r,c){return!r||r instanceof me?r:new me(r,c)}function ne(r,c){if(r)for(var m=c?[r,c]:r,E=0,j=m.length;E<j;E++)this.extend(m[E])}ne.prototype={extend:function(r){var c=this._southWest,m=this._northEast,E,j;if(r instanceof q)E=r,j=r;else if(r instanceof ne){if(E=r._southWest,j=r._northEast,!E||!j)return this}else return r?this.extend(R(r)||ae(r)):this;return!c&&!m?(this._southWest=new q(E.lat,E.lng),this._northEast=new q(j.lat,j.lng)):(c.lat=Math.min(E.lat,c.lat),c.lng=Math.min(E.lng,c.lng),m.lat=Math.max(j.lat,m.lat),m.lng=Math.max(j.lng,m.lng)),this},pad:function(r){var c=this._southWest,m=this._northEast,E=Math.abs(c.lat-m.lat)*r,j=Math.abs(c.lng-m.lng)*r;return new ne(new q(c.lat-E,c.lng-j),new q(m.lat+E,m.lng+j))},getCenter:function(){return new q((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new q(this.getNorth(),this.getWest())},getSouthEast:function(){return new q(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(r){typeof r[0]=="number"||r instanceof q||"lat"in r?r=R(r):r=ae(r);var c=this._southWest,m=this._northEast,E,j;return r instanceof ne?(E=r.getSouthWest(),j=r.getNorthEast()):E=j=r,E.lat>=c.lat&&j.lat<=m.lat&&E.lng>=c.lng&&j.lng<=m.lng},intersects:function(r){r=ae(r);var c=this._southWest,m=this._northEast,E=r.getSouthWest(),j=r.getNorthEast(),pe=j.lat>=c.lat&&E.lat<=m.lat,Ve=j.lng>=c.lng&&E.lng<=m.lng;return pe&&Ve},overlaps:function(r){r=ae(r);var c=this._southWest,m=this._northEast,E=r.getSouthWest(),j=r.getNorthEast(),pe=j.lat>c.lat&&E.lat<m.lat,Ve=j.lng>c.lng&&E.lng<m.lng;return pe&&Ve},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(r,c){return r?(r=ae(r),this._southWest.equals(r.getSouthWest(),c)&&this._northEast.equals(r.getNorthEast(),c)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function ae(r,c){return r instanceof ne?r:new ne(r,c)}function q(r,c,m){if(isNaN(r)||isNaN(c))throw new Error("Invalid LatLng object: ("+r+", "+c+")");this.lat=+r,this.lng=+c,m!==void 0&&(this.alt=+m)}q.prototype={equals:function(r,c){if(!r)return!1;r=R(r);var m=Math.max(Math.abs(this.lat-r.lat),Math.abs(this.lng-r.lng));return m<=(c===void 0?1e-9:c)},toString:function(r){return"LatLng("+k(this.lat,r)+", "+k(this.lng,r)+")"},distanceTo:function(r){return H.distance(this,R(r))},wrap:function(){return H.wrapLatLng(this)},toBounds:function(r){var c=180*r/40075017,m=c/Math.cos(Math.PI/180*this.lat);return ae([this.lat-c,this.lng-m],[this.lat+c,this.lng+m])},clone:function(){return new q(this.lat,this.lng,this.alt)}};function R(r,c,m){return r instanceof q?r:se(r)&&typeof r[0]!="object"?r.length===3?new q(r[0],r[1],r[2]):r.length===2?new q(r[0],r[1]):null:r==null?r:typeof r=="object"&&"lat"in r?new q(r.lat,"lng"in r?r.lng:r.lon,r.alt):c===void 0?null:new q(r,c,m)}var U={latLngToPoint:function(r,c){var m=this.projection.project(r),E=this.scale(c);return this.transformation._transform(m,E)},pointToLatLng:function(r,c){var m=this.scale(c),E=this.transformation.untransform(r,m);return this.projection.unproject(E)},project:function(r){return this.projection.project(r)},unproject:function(r){return this.projection.unproject(r)},scale:function(r){return 256*Math.pow(2,r)},zoom:function(r){return Math.log(r/256)/Math.LN2},getProjectedBounds:function(r){if(this.infinite)return null;var c=this.projection.bounds,m=this.scale(r),E=this.transformation.transform(c.min,m),j=this.transformation.transform(c.max,m);return new me(E,j)},infinite:!1,wrapLatLng:function(r){var c=this.wrapLng?_(r.lng,this.wrapLng,!0):r.lng,m=this.wrapLat?_(r.lat,this.wrapLat,!0):r.lat,E=r.alt;return new q(m,c,E)},wrapLatLngBounds:function(r){var c=r.getCenter(),m=this.wrapLatLng(c),E=c.lat-m.lat,j=c.lng-m.lng;if(E===0&&j===0)return r;var pe=r.getSouthWest(),Ve=r.getNorthEast(),dt=new q(pe.lat-E,pe.lng-j),bt=new q(Ve.lat-E,Ve.lng-j);return new ne(dt,bt)}},H=o({},U,{wrapLng:[-180,180],R:6371e3,distance:function(r,c){var m=Math.PI/180,E=r.lat*m,j=c.lat*m,pe=Math.sin((c.lat-r.lat)*m/2),Ve=Math.sin((c.lng-r.lng)*m/2),dt=pe*pe+Math.cos(E)*Math.cos(j)*Ve*Ve,bt=2*Math.atan2(Math.sqrt(dt),Math.sqrt(1-dt));return this.R*bt}}),$=6378137,ce={R:$,MAX_LATITUDE:85.0511287798,project:function(r){var c=Math.PI/180,m=this.MAX_LATITUDE,E=Math.max(Math.min(m,r.lat),-m),j=Math.sin(E*c);return new Q(this.R*r.lng*c,this.R*Math.log((1+j)/(1-j))/2)},unproject:function(r){var c=180/Math.PI;return new q((2*Math.atan(Math.exp(r.y/this.R))-Math.PI/2)*c,r.x*c/this.R)},bounds:function(){var r=$*Math.PI;return new me([-r,-r],[r,r])}()};function ue(r,c,m,E){if(se(r)){this._a=r[0],this._b=r[1],this._c=r[2],this._d=r[3];return}this._a=r,this._b=c,this._c=m,this._d=E}ue.prototype={transform:function(r,c){return this._transform(r.clone(),c)},_transform:function(r,c){return c=c||1,r.x=c*(this._a*r.x+this._b),r.y=c*(this._c*r.y+this._d),r},untransform:function(r,c){return c=c||1,new Q((r.x/c-this._b)/this._a,(r.y/c-this._d)/this._c)}};function V(r,c,m,E){return new ue(r,c,m,E)}var K=o({},H,{code:"EPSG:3857",projection:ce,transformation:function(){var r=.5/(Math.PI*ce.R);return V(r,.5,-r,.5)}()}),ye=o({},K,{code:"EPSG:900913"});function ve(r){return document.createElementNS("http://www.w3.org/2000/svg",r)}function ee(r,c){var m="",E,j,pe,Ve,dt,bt;for(E=0,pe=r.length;E<pe;E++){for(dt=r[E],j=0,Ve=dt.length;j<Ve;j++)bt=dt[j],m+=(j?"L":"M")+bt.x+" "+bt.y;m+=c?_t.svg?"z":"x":""}return m||"M0 0"}var Ge=document.documentElement.style,tt="ActiveXObject"in window,Ue=tt&&!document.addEventListener,nt="msLaunchUri"in navigator&&!("documentMode"in document),st=Rn("webkit"),Ct=Rn("android"),xt=Rn("android 2")||Rn("android 3"),Ot=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),$t=Ct&&Rn("Google")&&Ot<537&&!("AudioNode"in window),Gt=!!window.opera,ft=!nt&&Rn("chrome"),Fe=Rn("gecko")&&!st&&!Gt&&!tt,kt=!ft&&Rn("safari"),Et=Rn("phantom"),At="OTransition"in Ge,et=navigator.platform.indexOf("Win")===0,ot=tt&&"transition"in Ge,wn="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!xt,Zt="MozPerspective"in Ge,rn=!window.L_DISABLE_3D&&(ot||wn||Zt)&&!At&&!Et,Gn=typeof orientation<"u"||Rn("mobile"),Tn=Gn&&st,Kn=Gn&&wn,Hn=!window.PointerEvent&&window.MSPointerEvent,Ui=!!(window.PointerEvent||Hn),Oi="ontouchstart"in window||!!window.TouchEvent,zn=!window.L_NO_TOUCH&&(Oi||Ui),Ut=Gn&&Gt,An=Gn&&Fe,bi=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Yn=function(){var r=!1;try{var c=Object.defineProperty({},"passive",{get:function(){r=!0}});window.addEventListener("testPassiveEventSupport",x,c),window.removeEventListener("testPassiveEventSupport",x,c)}catch{}return r}(),wi=function(){return!!document.createElement("canvas").getContext}(),pi=!!(document.createElementNS&&ve("svg").createSVGRect),sn=!!pi&&function(){var r=document.createElement("div");return r.innerHTML="<svg/>",(r.firstChild&&r.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),gn=!pi&&function(){try{var r=document.createElement("div");r.innerHTML='<v:shape adj="1"/>';var c=r.firstChild;return c.style.behavior="url(#default#VML)",c&&typeof c.adj=="object"}catch{return!1}}(),Yt=navigator.platform.indexOf("Mac")===0,gi=navigator.platform.indexOf("Linux")===0;function Rn(r){return navigator.userAgent.toLowerCase().indexOf(r)>=0}var _t={ie:tt,ielt9:Ue,edge:nt,webkit:st,android:Ct,android23:xt,androidStock:$t,opera:Gt,chrome:ft,gecko:Fe,safari:kt,phantom:Et,opera12:At,win:et,ie3d:ot,webkit3d:wn,gecko3d:Zt,any3d:rn,mobile:Gn,mobileWebkit:Tn,mobileWebkit3d:Kn,msPointer:Hn,pointer:Ui,touch:zn,touchNative:Oi,mobileOpera:Ut,mobileGecko:An,retina:bi,passiveEvents:Yn,canvas:wi,svg:pi,vml:gn,inlineSvg:sn,mac:Yt,linux:gi},Xn=_t.msPointer?"MSPointerDown":"pointerdown",Ii=_t.msPointer?"MSPointerMove":"pointermove",ui=_t.msPointer?"MSPointerUp":"pointerup",yr=_t.msPointer?"MSPointerCancel":"pointercancel",lr={touchstart:Xn,touchmove:Ii,touchend:ui,touchcancel:yr},_r={touchstart:aa,touchmove:As,touchend:As,touchcancel:As},Ki={},ur=!1;function jr(r,c,m){return c==="touchstart"&&fs(),_r[c]?(m=_r[c].bind(this,m),r.addEventListener(lr[c],m,!1),m):(console.warn("wrong event specified:",c),x)}function Es(r,c,m){if(!lr[c]){console.warn("wrong event specified:",c);return}r.removeEventListener(lr[c],m,!1)}function Zs(r){Ki[r.pointerId]=r}function Ks(r){Ki[r.pointerId]&&(Ki[r.pointerId]=r)}function Gr(r){delete Ki[r.pointerId]}function fs(){ur||(document.addEventListener(Xn,Zs,!0),document.addEventListener(Ii,Ks,!0),document.addEventListener(ui,Gr,!0),document.addEventListener(yr,Gr,!0),ur=!0)}function As(r,c){if(c.pointerType!==(c.MSPOINTER_TYPE_MOUSE||"mouse")){c.touches=[];for(var m in Ki)c.touches.push(Ki[m]);c.changedTouches=[c],r(c)}}function aa(r,c){c.MSPOINTER_TYPE_TOUCH&&c.pointerType===c.MSPOINTER_TYPE_TOUCH&&Mi(c),As(r,c)}function la(r){var c={},m,E;for(E in r)m=r[E],c[E]=m&&m.bind?m.bind(r):m;return r=c,c.type="dblclick",c.detail=2,c.isTrusted=!1,c._simulated=!0,c}var Ys=200;function Io(r,c){r.addEventListener("dblclick",c);var m=0,E;function j(pe){if(pe.detail!==1){E=pe.detail;return}if(!(pe.pointerType==="mouse"||pe.sourceCapabilities&&!pe.sourceCapabilities.firesTouchEvents)){var Ve=eo(pe);if(!(Ve.some(function(bt){return bt instanceof HTMLLabelElement&&bt.attributes.for})&&!Ve.some(function(bt){return bt instanceof HTMLInputElement||bt instanceof HTMLSelectElement}))){var dt=Date.now();dt-m<=Ys?(E++,E===2&&c(la(pe))):E=1,m=dt}}}return r.addEventListener("click",j),{dblclick:c,simDblclick:j}}function ua(r,c){r.removeEventListener("dblclick",c.dblclick),r.removeEventListener("click",c.simDblclick)}var Ms=gs(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Bs=gs(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),go=Bs==="webkitTransition"||Bs==="OTransition"?Bs+"End":"transitionend";function Fo(r){return typeof r=="string"?document.getElementById(r):r}function cr(r,c){var m=r.style[c]||r.currentStyle&&r.currentStyle[c];if((!m||m==="auto")&&document.defaultView){var E=document.defaultView.getComputedStyle(r,null);m=E?E[c]:null}return m==="auto"?null:m}function On(r,c,m){var E=document.createElement(r);return E.className=c||"",m&&m.appendChild(E),E}function yn(r){var c=r.parentNode;c&&c.removeChild(r)}function ps(r){for(;r.firstChild;)r.removeChild(r.firstChild)}function Hr(r){var c=r.parentNode;c&&c.lastChild!==r&&c.appendChild(r)}function zr(r){var c=r.parentNode;c&&c.firstChild!==r&&c.insertBefore(r,c.firstChild)}function Ts(r,c){if(r.classList!==void 0)return r.classList.contains(c);var m=Vn(r);return m.length>0&&new RegExp("(^|\\s)"+c+"(\\s|$)").test(m)}function xn(r,c){if(r.classList!==void 0)for(var m=N(c),E=0,j=m.length;E<j;E++)r.classList.add(m[E]);else if(!Ts(r,c)){var pe=Vn(r);ki(r,(pe?pe+" ":"")+c)}}function qn(r,c){r.classList!==void 0?r.classList.remove(c):ki(r,w((" "+Vn(r)+" ").replace(" "+c+" "," ")))}function ki(r,c){r.className.baseVal===void 0?r.className=c:r.className.baseVal=c}function Vn(r){return r.correspondingElement&&(r=r.correspondingElement),r.className.baseVal===void 0?r.className:r.className.baseVal}function Qn(r,c){"opacity"in r.style?r.style.opacity=c:"filter"in r.style&&ci(r,c)}function ci(r,c){var m=!1,E="DXImageTransform.Microsoft.Alpha";try{m=r.filters.item(E)}catch{if(c===1)return}c=Math.round(c*100),m?(m.Enabled=c!==100,m.Opacity=c):r.style.filter+=" progid:"+E+"(opacity="+c+")"}function gs(r){for(var c=document.documentElement.style,m=0;m<r.length;m++)if(r[m]in c)return r[m];return!1}function Wr(r,c,m){var E=c||new Q(0,0);r.style[Ms]=(_t.ie3d?"translate("+E.x+"px,"+E.y+"px)":"translate3d("+E.x+"px,"+E.y+"px,0)")+(m?" scale("+m+")":"")}function _i(r,c){r._leaflet_pos=c,_t.any3d?Wr(r,c):(r.style.left=c.x+"px",r.style.top=c.y+"px")}function Ns(r){return r._leaflet_pos||new Q(0,0)}var jo,Js,Da;if("onselectstart"in document)jo=function(){Sn(window,"selectstart",Mi)},Js=function(){Un(window,"selectstart",Mi)};else{var mo=gs(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);jo=function(){if(mo){var r=document.documentElement.style;Da=r[mo],r[mo]="none"}},Js=function(){mo&&(document.documentElement.style[mo]=Da,Da=void 0)}}function Ra(){Sn(window,"dragstart",Mi)}function ms(){Un(window,"dragstart",Mi)}var Xs,vo;function ca(r){for(;r.tabIndex===-1;)r=r.parentNode;r.style&&($i(),Xs=r,vo=r.style.outlineStyle,r.style.outlineStyle="none",Sn(window,"keydown",$i))}function $i(){Xs&&(Xs.style.outlineStyle=vo,Xs=void 0,vo=void 0,Un(window,"keydown",$i))}function sl(r){do r=r.parentNode;while((!r.offsetWidth||!r.offsetHeight)&&r!==document.body);return r}function ha(r){var c=r.getBoundingClientRect();return{x:c.width/r.offsetWidth||1,y:c.height/r.offsetHeight||1,boundingClientRect:c}}var Pn={__proto__:null,TRANSFORM:Ms,TRANSITION:Bs,TRANSITION_END:go,get:Fo,getStyle:cr,create:On,remove:yn,empty:ps,toFront:Hr,toBack:zr,hasClass:Ts,addClass:xn,removeClass:qn,setClass:ki,getClass:Vn,setOpacity:Qn,testProp:gs,setTransform:Wr,setPosition:_i,getPosition:Ns,get disableTextSelection(){return jo},get enableTextSelection(){return Js},disableImageDrag:Ra,enableImageDrag:ms,preventOutline:ca,restoreOutline:$i,getSizedParentNode:sl,getScale:ha};function Sn(r,c,m,E){if(c&&typeof c=="object")for(var j in c)yo(r,j,c[j],m);else{c=N(c);for(var pe=0,Ve=c.length;pe<Ve;pe++)yo(r,c[pe],m,E)}return this}var Zr="_leaflet_events";function Un(r,c,m,E){if(arguments.length===1)Oa(r),delete r[Zr];else if(c&&typeof c=="object")for(var j in c)Kr(r,j,c[j],m);else if(c=N(c),arguments.length===2)Oa(r,function(dt){return Se(c,dt)!==-1});else for(var pe=0,Ve=c.length;pe<Ve;pe++)Kr(r,c[pe],m,E);return this}function Oa(r,c){for(var m in r[Zr]){var E=m.split(/\d/)[0];(!c||c(E))&&Kr(r,E,null,null,m)}}var da={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function yo(r,c,m,E){var j=c+f(m)+(E?"_"+f(E):"");if(r[Zr]&&r[Zr][j])return this;var pe=function(dt){return m.call(E||r,dt||window.event)},Ve=pe;!_t.touchNative&&_t.pointer&&c.indexOf("touch")===0?pe=jr(r,c,pe):_t.touch&&c==="dblclick"?pe=Io(r,pe):"addEventListener"in r?c==="touchstart"||c==="touchmove"||c==="wheel"||c==="mousewheel"?r.addEventListener(da[c]||c,pe,_t.passiveEvents?{passive:!1}:!1):c==="mouseenter"||c==="mouseleave"?(pe=function(dt){dt=dt||window.event,_o(r,dt)&&Ve(dt)},r.addEventListener(da[c],pe,!1)):r.addEventListener(c,Ve,!1):r.attachEvent("on"+c,pe),r[Zr]=r[Zr]||{},r[Zr][j]=pe}function Kr(r,c,m,E,j){j=j||c+f(m)+(E?"_"+f(E):"");var pe=r[Zr]&&r[Zr][j];if(!pe)return this;!_t.touchNative&&_t.pointer&&c.indexOf("touch")===0?Es(r,c,pe):_t.touch&&c==="dblclick"?ua(r,pe):"removeEventListener"in r?r.removeEventListener(da[c]||c,pe,!1):r.detachEvent("on"+c,pe),r[Zr][j]=null}function Qs(r){return r.stopPropagation?r.stopPropagation():r.originalEvent?r.originalEvent._stopped=!0:r.cancelBubble=!0,this}function Ia(r){return yo(r,"wheel",Qs),this}function zo(r){return Sn(r,"mousedown touchstart dblclick contextmenu",Qs),r._leaflet_disable_click=!0,this}function Mi(r){return r.preventDefault?r.preventDefault():r.returnValue=!1,this}function Ur(r){return Mi(r),Qs(r),this}function eo(r){if(r.composedPath)return r.composedPath();for(var c=[],m=r.target;m;)c.push(m),m=m.parentNode;return c}function ol(r,c){if(!c)return new Q(r.clientX,r.clientY);var m=ha(c),E=m.boundingClientRect;return new Q((r.clientX-E.left)/m.x-c.clientLeft,(r.clientY-E.top)/m.y-c.clientTop)}var Uo=_t.linux&&_t.chrome?window.devicePixelRatio:_t.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function fa(r){return _t.edge?r.wheelDeltaY/2:r.deltaY&&r.deltaMode===0?-r.deltaY/Uo:r.deltaY&&r.deltaMode===1?-r.deltaY*20:r.deltaY&&r.deltaMode===2?-r.deltaY*60:r.deltaX||r.deltaZ?0:r.wheelDelta?(r.wheelDeltaY||r.wheelDelta)/2:r.detail&&Math.abs(r.detail)<32765?-r.detail*20:r.detail?r.detail/-32765*60:0}function _o(r,c){var m=c.relatedTarget;if(!m)return!0;try{for(;m&&m!==r;)m=m.parentNode}catch{return!1}return m!==r}var $o={__proto__:null,on:Sn,off:Un,stopPropagation:Qs,disableScrollPropagation:Ia,disableClickPropagation:zo,preventDefault:Mi,stop:Ur,getPropagationPath:eo,getMousePosition:ol,getWheelDelta:fa,isExternalTarget:_o,addListener:Sn,removeListener:Un},Fa=G.extend({run:function(r,c,m,E){this.stop(),this._el=r,this._inProgress=!0,this._duration=m||.25,this._easeOutPower=1/Math.max(E||.5,.2),this._startPos=Ns(r),this._offset=c.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=te(this._animate,this),this._step()},_step:function(r){var c=+new Date-this._startTime,m=this._duration*1e3;c<m?this._runFrame(this._easeOut(c/m),r):(this._runFrame(1),this._complete())},_runFrame:function(r,c){var m=this._startPos.add(this._offset.multiplyBy(r));c&&m._round(),_i(this._el,m),this.fire("step")},_complete:function(){J(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(r){return 1-Math.pow(1-r,this._easeOutPower)}}),In=G.extend({options:{crs:K,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(r,c){c=z(this,c),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(r),this._initLayout(),this._onResize=u(this._onResize,this),this._initEvents(),c.maxBounds&&this.setMaxBounds(c.maxBounds),c.zoom!==void 0&&(this._zoom=this._limitZoom(c.zoom)),c.center&&c.zoom!==void 0&&this.setView(R(c.center),c.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Bs&&_t.any3d&&!_t.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Sn(this._proxy,go,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(r,c,m){if(c=c===void 0?this._zoom:this._limitZoom(c),r=this._limitCenter(R(r),c,this.options.maxBounds),m=m||{},this._stop(),this._loaded&&!m.reset&&m!==!0){m.animate!==void 0&&(m.zoom=o({animate:m.animate},m.zoom),m.pan=o({animate:m.animate,duration:m.duration},m.pan));var E=this._zoom!==c?this._tryAnimatedZoom&&this._tryAnimatedZoom(r,c,m.zoom):this._tryAnimatedPan(r,m.pan);if(E)return clearTimeout(this._sizeTimer),this}return this._resetView(r,c,m.pan&&m.pan.noMoveStart),this},setZoom:function(r,c){return this._loaded?this.setView(this.getCenter(),r,{zoom:c}):(this._zoom=r,this)},zoomIn:function(r,c){return r=r||(_t.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+r,c)},zoomOut:function(r,c){return r=r||(_t.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-r,c)},setZoomAround:function(r,c,m){var E=this.getZoomScale(c),j=this.getSize().divideBy(2),pe=r instanceof Q?r:this.latLngToContainerPoint(r),Ve=pe.subtract(j).multiplyBy(1-1/E),dt=this.containerPointToLatLng(j.add(Ve));return this.setView(dt,c,{zoom:m})},_getBoundsCenterZoom:function(r,c){c=c||{},r=r.getBounds?r.getBounds():ae(r);var m=oe(c.paddingTopLeft||c.padding||[0,0]),E=oe(c.paddingBottomRight||c.padding||[0,0]),j=this.getBoundsZoom(r,!1,m.add(E));if(j=typeof c.maxZoom=="number"?Math.min(c.maxZoom,j):j,j===1/0)return{center:r.getCenter(),zoom:j};var pe=E.subtract(m).divideBy(2),Ve=this.project(r.getSouthWest(),j),dt=this.project(r.getNorthEast(),j),bt=this.unproject(Ve.add(dt).divideBy(2).add(pe),j);return{center:bt,zoom:j}},fitBounds:function(r,c){if(r=ae(r),!r.isValid())throw new Error("Bounds are not valid.");var m=this._getBoundsCenterZoom(r,c);return this.setView(m.center,m.zoom,c)},fitWorld:function(r){return this.fitBounds([[-90,-180],[90,180]],r)},panTo:function(r,c){return this.setView(r,this._zoom,{pan:c})},panBy:function(r,c){if(r=oe(r).round(),c=c||{},!r.x&&!r.y)return this.fire("moveend");if(c.animate!==!0&&!this.getSize().contains(r))return this._resetView(this.unproject(this.project(this.getCenter()).add(r)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Fa,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),c.noMoveStart||this.fire("movestart"),c.animate!==!1){xn(this._mapPane,"leaflet-pan-anim");var m=this._getMapPanePos().subtract(r).round();this._panAnim.run(this._mapPane,m,c.duration||.25,c.easeLinearity)}else this._rawPanBy(r),this.fire("move").fire("moveend");return this},flyTo:function(r,c,m){if(m=m||{},m.animate===!1||!_t.any3d)return this.setView(r,c,m);this._stop();var E=this.project(this.getCenter()),j=this.project(r),pe=this.getSize(),Ve=this._zoom;r=R(r),c=c===void 0?Ve:c;var dt=Math.max(pe.x,pe.y),bt=dt*this.getZoomScale(Ve,c),It=j.distanceTo(E)||1,Jt=1.42,cn=Jt*Jt;function Nn(si){var gr=si?-1:1,Wu=si?bt:dt,$s=bt*bt-dt*dt+gr*cn*cn*It*It,du=2*Wu*cn*It,Ko=$s/du,dl=Math.sqrt(Ko*Ko+1)-Ko,fu=dl<1e-9?-18:Math.log(dl);return fu}function Sr(si){return(Math.exp(si)-Math.exp(-si))/2}function Wi(si){return(Math.exp(si)+Math.exp(-si))/2}function Dr(si){return Sr(si)/Wi(si)}var Ei=Nn(0);function Us(si){return dt*(Wi(Ei)/Wi(Ei+Jt*si))}function zl(si){return dt*(Wi(Ei)*Dr(Ei+Jt*si)-Sr(Ei))/cn}function bs(si){return 1-Math.pow(1-si,1.5)}var is=Date.now(),Vr=(Nn(1)-Ei)/Jt,Hu=m.duration?1e3*m.duration:1e3*Vr*.8;function Ul(){var si=(Date.now()-is)/Hu,gr=bs(si)*Vr;si<=1?(this._flyToFrame=te(Ul,this),this._move(this.unproject(E.add(j.subtract(E).multiplyBy(zl(gr)/It)),Ve),this.getScaleZoom(dt/Us(gr),Ve),{flyTo:!0})):this._move(r,c)._moveEnd(!0)}return this._moveStart(!0,m.noMoveStart),Ul.call(this),this},flyToBounds:function(r,c){var m=this._getBoundsCenterZoom(r,c);return this.flyTo(m.center,m.zoom,c)},setMaxBounds:function(r){return r=ae(r),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),r.isValid()?(this.options.maxBounds=r,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(r){var c=this.options.minZoom;return this.options.minZoom=r,this._loaded&&c!==r&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(r):this},setMaxZoom:function(r){var c=this.options.maxZoom;return this.options.maxZoom=r,this._loaded&&c!==r&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(r):this},panInsideBounds:function(r,c){this._enforcingBounds=!0;var m=this.getCenter(),E=this._limitCenter(m,this._zoom,ae(r));return m.equals(E)||this.panTo(E,c),this._enforcingBounds=!1,this},panInside:function(r,c){c=c||{};var m=oe(c.paddingTopLeft||c.padding||[0,0]),E=oe(c.paddingBottomRight||c.padding||[0,0]),j=this.project(this.getCenter()),pe=this.project(r),Ve=this.getPixelBounds(),dt=T([Ve.min.add(m),Ve.max.subtract(E)]),bt=dt.getSize();if(!dt.contains(pe)){this._enforcingBounds=!0;var It=pe.subtract(dt.getCenter()),Jt=dt.extend(pe).getSize().subtract(bt);j.x+=It.x<0?-Jt.x:Jt.x,j.y+=It.y<0?-Jt.y:Jt.y,this.panTo(this.unproject(j),c),this._enforcingBounds=!1}return this},invalidateSize:function(r){if(!this._loaded)return this;r=o({animate:!1,pan:!0},r===!0?{animate:!0}:r);var c=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var m=this.getSize(),E=c.divideBy(2).round(),j=m.divideBy(2).round(),pe=E.subtract(j);return!pe.x&&!pe.y?this:(r.animate&&r.pan?this.panBy(pe):(r.pan&&this._rawPanBy(pe),this.fire("move"),r.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(u(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:c,newSize:m}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(r){if(r=this._locateOptions=o({timeout:1e4,watch:!1},r),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var c=u(this._handleGeolocationResponse,this),m=u(this._handleGeolocationError,this);return r.watch?this._locationWatchId=navigator.geolocation.watchPosition(c,m,r):navigator.geolocation.getCurrentPosition(c,m,r),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(r){if(this._container._leaflet_id){var c=r.code,m=r.message||(c===1?"permission denied":c===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:c,message:"Geolocation error: "+m+"."})}},_handleGeolocationResponse:function(r){if(this._container._leaflet_id){var c=r.coords.latitude,m=r.coords.longitude,E=new q(c,m),j=E.toBounds(r.coords.accuracy*2),pe=this._locateOptions;if(pe.setView){var Ve=this.getBoundsZoom(j);this.setView(E,pe.maxZoom?Math.min(Ve,pe.maxZoom):Ve)}var dt={latlng:E,bounds:j,timestamp:r.timestamp};for(var bt in r.coords)typeof r.coords[bt]=="number"&&(dt[bt]=r.coords[bt]);this.fire("locationfound",dt)}},addHandler:function(r,c){if(!c)return this;var m=this[r]=new c(this);return this._handlers.push(m),this.options[r]&&m.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),yn(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(J(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var r;for(r in this._layers)this._layers[r].remove();for(r in this._panes)yn(this._panes[r]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(r,c){var m="leaflet-pane"+(r?" leaflet-"+r.replace("Pane","")+"-pane":""),E=On("div",m,c||this._mapPane);return r&&(this._panes[r]=E),E},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var r=this.getPixelBounds(),c=this.unproject(r.getBottomLeft()),m=this.unproject(r.getTopRight());return new ne(c,m)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(r,c,m){r=ae(r),m=oe(m||[0,0]);var E=this.getZoom()||0,j=this.getMinZoom(),pe=this.getMaxZoom(),Ve=r.getNorthWest(),dt=r.getSouthEast(),bt=this.getSize().subtract(m),It=T(this.project(dt,E),this.project(Ve,E)).getSize(),Jt=_t.any3d?this.options.zoomSnap:1,cn=bt.x/It.x,Nn=bt.y/It.y,Sr=c?Math.max(cn,Nn):Math.min(cn,Nn);return E=this.getScaleZoom(Sr,E),Jt&&(E=Math.round(E/(Jt/100))*(Jt/100),E=c?Math.ceil(E/Jt)*Jt:Math.floor(E/Jt)*Jt),Math.max(j,Math.min(pe,E))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new Q(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(r,c){var m=this._getTopLeftPoint(r,c);return new me(m,m.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(r){return this.options.crs.getProjectedBounds(r===void 0?this.getZoom():r)},getPane:function(r){return typeof r=="string"?this._panes[r]:r},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(r,c){var m=this.options.crs;return c=c===void 0?this._zoom:c,m.scale(r)/m.scale(c)},getScaleZoom:function(r,c){var m=this.options.crs;c=c===void 0?this._zoom:c;var E=m.zoom(r*m.scale(c));return isNaN(E)?1/0:E},project:function(r,c){return c=c===void 0?this._zoom:c,this.options.crs.latLngToPoint(R(r),c)},unproject:function(r,c){return c=c===void 0?this._zoom:c,this.options.crs.pointToLatLng(oe(r),c)},layerPointToLatLng:function(r){var c=oe(r).add(this.getPixelOrigin());return this.unproject(c)},latLngToLayerPoint:function(r){var c=this.project(R(r))._round();return c._subtract(this.getPixelOrigin())},wrapLatLng:function(r){return this.options.crs.wrapLatLng(R(r))},wrapLatLngBounds:function(r){return this.options.crs.wrapLatLngBounds(ae(r))},distance:function(r,c){return this.options.crs.distance(R(r),R(c))},containerPointToLayerPoint:function(r){return oe(r).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(r){return oe(r).add(this._getMapPanePos())},containerPointToLatLng:function(r){var c=this.containerPointToLayerPoint(oe(r));return this.layerPointToLatLng(c)},latLngToContainerPoint:function(r){return this.layerPointToContainerPoint(this.latLngToLayerPoint(R(r)))},mouseEventToContainerPoint:function(r){return ol(r,this._container)},mouseEventToLayerPoint:function(r){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(r))},mouseEventToLatLng:function(r){return this.layerPointToLatLng(this.mouseEventToLayerPoint(r))},_initContainer:function(r){var c=this._container=Fo(r);if(c){if(c._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");Sn(c,"scroll",this._onScroll,this),this._containerId=f(c)},_initLayout:function(){var r=this._container;this._fadeAnimated=this.options.fadeAnimation&&_t.any3d,xn(r,"leaflet-container"+(_t.touch?" leaflet-touch":"")+(_t.retina?" leaflet-retina":"")+(_t.ielt9?" leaflet-oldie":"")+(_t.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var c=cr(r,"position");c!=="absolute"&&c!=="relative"&&c!=="fixed"&&c!=="sticky"&&(r.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var r=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),_i(this._mapPane,new Q(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(xn(r.markerPane,"leaflet-zoom-hide"),xn(r.shadowPane,"leaflet-zoom-hide"))},_resetView:function(r,c,m){_i(this._mapPane,new Q(0,0));var E=!this._loaded;this._loaded=!0,c=this._limitZoom(c),this.fire("viewprereset");var j=this._zoom!==c;this._moveStart(j,m)._move(r,c)._moveEnd(j),this.fire("viewreset"),E&&this.fire("load")},_moveStart:function(r,c){return r&&this.fire("zoomstart"),c||this.fire("movestart"),this},_move:function(r,c,m,E){c===void 0&&(c=this._zoom);var j=this._zoom!==c;return this._zoom=c,this._lastCenter=r,this._pixelOrigin=this._getNewPixelOrigin(r),E?m&&m.pinch&&this.fire("zoom",m):((j||m&&m.pinch)&&this.fire("zoom",m),this.fire("move",m)),this},_moveEnd:function(r){return r&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return J(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(r){_i(this._mapPane,this._getMapPanePos().subtract(r))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(r){this._targets={},this._targets[f(this._container)]=this;var c=r?Un:Sn;c(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&c(window,"resize",this._onResize,this),_t.any3d&&this.options.transform3DLimit&&(r?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){J(this._resizeRequest),this._resizeRequest=te(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var r=this._getMapPanePos();Math.max(Math.abs(r.x),Math.abs(r.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(r,c){for(var m=[],E,j=c==="mouseout"||c==="mouseover",pe=r.target||r.srcElement,Ve=!1;pe;){if(E=this._targets[f(pe)],E&&(c==="click"||c==="preclick")&&this._draggableMoved(E)){Ve=!0;break}if(E&&E.listens(c,!0)&&(j&&!_o(pe,r)||(m.push(E),j))||pe===this._container)break;pe=pe.parentNode}return!m.length&&!Ve&&!j&&this.listens(c,!0)&&(m=[this]),m},_isClickDisabled:function(r){for(;r&&r!==this._container;){if(r._leaflet_disable_click)return!0;r=r.parentNode}},_handleDOMEvent:function(r){var c=r.target||r.srcElement;if(!(!this._loaded||c._leaflet_disable_events||r.type==="click"&&this._isClickDisabled(c))){var m=r.type;m==="mousedown"&&ca(c),this._fireDOMEvent(r,m)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(r,c,m){if(r.type==="click"){var E=o({},r);E.type="preclick",this._fireDOMEvent(E,E.type,m)}var j=this._findEventTargets(r,c);if(m){for(var pe=[],Ve=0;Ve<m.length;Ve++)m[Ve].listens(c,!0)&&pe.push(m[Ve]);j=pe.concat(j)}if(j.length){c==="contextmenu"&&Mi(r);var dt=j[0],bt={originalEvent:r};if(r.type!=="keypress"&&r.type!=="keydown"&&r.type!=="keyup"){var It=dt.getLatLng&&(!dt._radius||dt._radius<=10);bt.containerPoint=It?this.latLngToContainerPoint(dt.getLatLng()):this.mouseEventToContainerPoint(r),bt.layerPoint=this.containerPointToLayerPoint(bt.containerPoint),bt.latlng=It?dt.getLatLng():this.layerPointToLatLng(bt.layerPoint)}for(Ve=0;Ve<j.length;Ve++)if(j[Ve].fire(c,bt,!0),bt.originalEvent._stopped||j[Ve].options.bubblingMouseEvents===!1&&Se(this._mouseEvents,c)!==-1)return}},_draggableMoved:function(r){return r=r.dragging&&r.dragging.enabled()?r:this,r.dragging&&r.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var r=0,c=this._handlers.length;r<c;r++)this._handlers[r].disable()},whenReady:function(r,c){return this._loaded?r.call(c||this,{target:this}):this.on("load",r,c),this},_getMapPanePos:function(){return Ns(this._mapPane)||new Q(0,0)},_moved:function(){var r=this._getMapPanePos();return r&&!r.equals([0,0])},_getTopLeftPoint:function(r,c){var m=r&&c!==void 0?this._getNewPixelOrigin(r,c):this.getPixelOrigin();return m.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(r,c){var m=this.getSize()._divideBy(2);return this.project(r,c)._subtract(m)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(r,c,m){var E=this._getNewPixelOrigin(m,c);return this.project(r,c)._subtract(E)},_latLngBoundsToNewLayerBounds:function(r,c,m){var E=this._getNewPixelOrigin(m,c);return T([this.project(r.getSouthWest(),c)._subtract(E),this.project(r.getNorthWest(),c)._subtract(E),this.project(r.getSouthEast(),c)._subtract(E),this.project(r.getNorthEast(),c)._subtract(E)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(r){return this.latLngToLayerPoint(r).subtract(this._getCenterLayerPoint())},_limitCenter:function(r,c,m){if(!m)return r;var E=this.project(r,c),j=this.getSize().divideBy(2),pe=new me(E.subtract(j),E.add(j)),Ve=this._getBoundsOffset(pe,m,c);return Math.abs(Ve.x)<=1&&Math.abs(Ve.y)<=1?r:this.unproject(E.add(Ve),c)},_limitOffset:function(r,c){if(!c)return r;var m=this.getPixelBounds(),E=new me(m.min.add(r),m.max.add(r));return r.add(this._getBoundsOffset(E,c))},_getBoundsOffset:function(r,c,m){var E=T(this.project(c.getNorthEast(),m),this.project(c.getSouthWest(),m)),j=E.min.subtract(r.min),pe=E.max.subtract(r.max),Ve=this._rebound(j.x,-pe.x),dt=this._rebound(j.y,-pe.y);return new Q(Ve,dt)},_rebound:function(r,c){return r+c>0?Math.round(r-c)/2:Math.max(0,Math.ceil(r))-Math.max(0,Math.floor(c))},_limitZoom:function(r){var c=this.getMinZoom(),m=this.getMaxZoom(),E=_t.any3d?this.options.zoomSnap:1;return E&&(r=Math.round(r/E)*E),Math.max(c,Math.min(m,r))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){qn(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(r,c){var m=this._getCenterOffset(r)._trunc();return(c&&c.animate)!==!0&&!this.getSize().contains(m)?!1:(this.panBy(m,c),!0)},_createAnimProxy:function(){var r=this._proxy=On("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(r),this.on("zoomanim",function(c){var m=Ms,E=this._proxy.style[m];Wr(this._proxy,this.project(c.center,c.zoom),this.getZoomScale(c.zoom,1)),E===this._proxy.style[m]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){yn(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var r=this.getCenter(),c=this.getZoom();Wr(this._proxy,this.project(r,c),this.getZoomScale(c,1))},_catchTransitionEnd:function(r){this._animatingZoom&&r.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(r,c,m){if(this._animatingZoom)return!0;if(m=m||{},!this._zoomAnimated||m.animate===!1||this._nothingToAnimate()||Math.abs(c-this._zoom)>this.options.zoomAnimationThreshold)return!1;var E=this.getZoomScale(c),j=this._getCenterOffset(r)._divideBy(1-1/E);return m.animate!==!0&&!this.getSize().contains(j)?!1:(te(function(){this._moveStart(!0,m.noMoveStart||!1)._animateZoom(r,c,!0)},this),!0)},_animateZoom:function(r,c,m,E){this._mapPane&&(m&&(this._animatingZoom=!0,this._animateToCenter=r,this._animateToZoom=c,xn(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:r,zoom:c,noUpdate:E}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(u(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&qn(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function ja(r,c){return new In(r,c)}var dn=he.extend({options:{position:"topright"},initialize:function(r){z(this,r)},getPosition:function(){return this.options.position},setPosition:function(r){var c=this._map;return c&&c.removeControl(this),this.options.position=r,c&&c.addControl(this),this},getContainer:function(){return this._container},addTo:function(r){this.remove(),this._map=r;var c=this._container=this.onAdd(r),m=this.getPosition(),E=r._controlCorners[m];return xn(c,"leaflet-control"),m.indexOf("bottom")!==-1?E.insertBefore(c,E.firstChild):E.appendChild(c),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(yn(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(r){this._map&&r&&r.screenX>0&&r.screenY>0&&this._map.getContainer().focus()}}),br=function(r){return new dn(r)};In.include({addControl:function(r){return r.addTo(this),this},removeControl:function(r){return r.remove(),this},_initControlPos:function(){var r=this._controlCorners={},c="leaflet-",m=this._controlContainer=On("div",c+"control-container",this._container);function E(j,pe){var Ve=c+j+" "+c+pe;r[j+pe]=On("div",Ve,m)}E("top","left"),E("top","right"),E("bottom","left"),E("bottom","right")},_clearControlPos:function(){for(var r in this._controlCorners)yn(this._controlCorners[r]);yn(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var qo=dn.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(r,c,m,E){return m<E?-1:E<m?1:0}},initialize:function(r,c,m){z(this,m),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var E in r)this._addLayer(r[E],E);for(E in c)this._addLayer(c[E],E,!0)},onAdd:function(r){this._initLayout(),this._update(),this._map=r,r.on("zoomend",this._checkDisabledLayers,this);for(var c=0;c<this._layers.length;c++)this._layers[c].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(r){return dn.prototype.addTo.call(this,r),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var r=0;r<this._layers.length;r++)this._layers[r].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(r,c){return this._addLayer(r,c),this._map?this._update():this},addOverlay:function(r,c){return this._addLayer(r,c,!0),this._map?this._update():this},removeLayer:function(r){r.off("add remove",this._onLayerChange,this);var c=this._getLayer(f(r));return c&&this._layers.splice(this._layers.indexOf(c),1),this._map?this._update():this},expand:function(){xn(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var r=this._map.getSize().y-(this._container.offsetTop+50);return r<this._section.clientHeight?(xn(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=r+"px"):qn(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return qn(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var r="leaflet-control-layers",c=this._container=On("div",r),m=this.options.collapsed;c.setAttribute("aria-haspopup",!0),zo(c),Ia(c);var E=this._section=On("section",r+"-list");m&&(this._map.on("click",this.collapse,this),Sn(c,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var j=this._layersLink=On("a",r+"-toggle",c);j.href="#",j.title="Layers",j.setAttribute("role","button"),Sn(j,{keydown:function(pe){pe.keyCode===13&&this._expandSafely()},click:function(pe){Mi(pe),this._expandSafely()}},this),m||this.expand(),this._baseLayersList=On("div",r+"-base",E),this._separator=On("div",r+"-separator",E),this._overlaysList=On("div",r+"-overlays",E),c.appendChild(E)},_getLayer:function(r){for(var c=0;c<this._layers.length;c++)if(this._layers[c]&&f(this._layers[c].layer)===r)return this._layers[c]},_addLayer:function(r,c,m){this._map&&r.on("add remove",this._onLayerChange,this),this._layers.push({layer:r,name:c,overlay:m}),this.options.sortLayers&&this._layers.sort(u(function(E,j){return this.options.sortFunction(E.layer,j.layer,E.name,j.name)},this)),this.options.autoZIndex&&r.setZIndex&&(this._lastZIndex++,r.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;ps(this._baseLayersList),ps(this._overlaysList),this._layerControlInputs=[];var r,c,m,E,j=0;for(m=0;m<this._layers.length;m++)E=this._layers[m],this._addItem(E),c=c||E.overlay,r=r||!E.overlay,j+=E.overlay?0:1;return this.options.hideSingleBase&&(r=r&&j>1,this._baseLayersList.style.display=r?"":"none"),this._separator.style.display=c&&r?"":"none",this},_onLayerChange:function(r){this._handlingClick||this._update();var c=this._getLayer(f(r.target)),m=c.overlay?r.type==="add"?"overlayadd":"overlayremove":r.type==="add"?"baselayerchange":null;m&&this._map.fire(m,c)},_createRadioElement:function(r,c){var m='<input type="radio" class="leaflet-control-layers-selector" name="'+r+'"'+(c?' checked="checked"':"")+"/>",E=document.createElement("div");return E.innerHTML=m,E.firstChild},_addItem:function(r){var c=document.createElement("label"),m=this._map.hasLayer(r.layer),E;r.overlay?(E=document.createElement("input"),E.type="checkbox",E.className="leaflet-control-layers-selector",E.defaultChecked=m):E=this._createRadioElement("leaflet-base-layers_"+f(this),m),this._layerControlInputs.push(E),E.layerId=f(r.layer),Sn(E,"click",this._onInputClick,this);var j=document.createElement("span");j.innerHTML=" "+r.name;var pe=document.createElement("span");c.appendChild(pe),pe.appendChild(E),pe.appendChild(j);var Ve=r.overlay?this._overlaysList:this._baseLayersList;return Ve.appendChild(c),this._checkDisabledLayers(),c},_onInputClick:function(){if(!this._preventClick){var r=this._layerControlInputs,c,m,E=[],j=[];this._handlingClick=!0;for(var pe=r.length-1;pe>=0;pe--)c=r[pe],m=this._getLayer(c.layerId).layer,c.checked?E.push(m):c.checked||j.push(m);for(pe=0;pe<j.length;pe++)this._map.hasLayer(j[pe])&&this._map.removeLayer(j[pe]);for(pe=0;pe<E.length;pe++)this._map.hasLayer(E[pe])||this._map.addLayer(E[pe]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var r=this._layerControlInputs,c,m,E=this._map.getZoom(),j=r.length-1;j>=0;j--)c=r[j],m=this._getLayer(c.layerId).layer,c.disabled=m.options.minZoom!==void 0&&E<m.options.minZoom||m.options.maxZoom!==void 0&&E>m.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var r=this._section;this._preventClick=!0,Sn(r,"click",Mi),this.expand();var c=this;setTimeout(function(){Un(r,"click",Mi),c._preventClick=!1})}}),bo=function(r,c,m){return new qo(r,c,m)},Er=dn.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(r){var c="leaflet-control-zoom",m=On("div",c+" leaflet-bar"),E=this.options;return this._zoomInButton=this._createButton(E.zoomInText,E.zoomInTitle,c+"-in",m,this._zoomIn),this._zoomOutButton=this._createButton(E.zoomOutText,E.zoomOutTitle,c+"-out",m,this._zoomOut),this._updateDisabled(),r.on("zoomend zoomlevelschange",this._updateDisabled,this),m},onRemove:function(r){r.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(r){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(r.shiftKey?3:1))},_zoomOut:function(r){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(r.shiftKey?3:1))},_createButton:function(r,c,m,E,j){var pe=On("a",m,E);return pe.innerHTML=r,pe.href="#",pe.title=c,pe.setAttribute("role","button"),pe.setAttribute("aria-label",c),zo(pe),Sn(pe,"click",Ur),Sn(pe,"click",j,this),Sn(pe,"click",this._refocusOnMap,this),pe},_updateDisabled:function(){var r=this._map,c="leaflet-disabled";qn(this._zoomInButton,c),qn(this._zoomOutButton,c),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||r._zoom===r.getMinZoom())&&(xn(this._zoomOutButton,c),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||r._zoom===r.getMaxZoom())&&(xn(this._zoomInButton,c),this._zoomInButton.setAttribute("aria-disabled","true"))}});In.mergeOptions({zoomControl:!0}),In.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new Er,this.addControl(this.zoomControl))});var za=function(r){return new Er(r)},Ds=dn.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(r){var c="leaflet-control-scale",m=On("div",c),E=this.options;return this._addScales(E,c+"-line",m),r.on(E.updateWhenIdle?"moveend":"move",this._update,this),r.whenReady(this._update,this),m},onRemove:function(r){r.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(r,c,m){r.metric&&(this._mScale=On("div",c,m)),r.imperial&&(this._iScale=On("div",c,m))},_update:function(){var r=this._map,c=r.getSize().y/2,m=r.distance(r.containerPointToLatLng([0,c]),r.containerPointToLatLng([this.options.maxWidth,c]));this._updateScales(m)},_updateScales:function(r){this.options.metric&&r&&this._updateMetric(r),this.options.imperial&&r&&this._updateImperial(r)},_updateMetric:function(r){var c=this._getRoundNum(r),m=c<1e3?c+" m":c/1e3+" km";this._updateScale(this._mScale,m,c/r)},_updateImperial:function(r){var c=r*3.2808399,m,E,j;c>5280?(m=c/5280,E=this._getRoundNum(m),this._updateScale(this._iScale,E+" mi",E/m)):(j=this._getRoundNum(c),this._updateScale(this._iScale,j+" ft",j/c))},_updateScale:function(r,c,m){r.style.width=Math.round(this.options.maxWidth*m)+"px",r.innerHTML=c},_getRoundNum:function(r){var c=Math.pow(10,(Math.floor(r)+"").length-1),m=r/c;return m=m>=10?10:m>=5?5:m>=3?3:m>=2?2:1,c*m}}),pa=function(r){return new Ds(r)},ga='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Yr=dn.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(_t.inlineSvg?ga+" ":"")+"Leaflet</a>"},initialize:function(r){z(this,r),this._attributions={}},onAdd:function(r){r.attributionControl=this,this._container=On("div","leaflet-control-attribution"),zo(this._container);for(var c in r._layers)r._layers[c].getAttribution&&this.addAttribution(r._layers[c].getAttribution());return this._update(),r.on("layeradd",this._addAttribution,this),this._container},onRemove:function(r){r.off("layeradd",this._addAttribution,this)},_addAttribution:function(r){r.layer.getAttribution&&(this.addAttribution(r.layer.getAttribution()),r.layer.once("remove",function(){this.removeAttribution(r.layer.getAttribution())},this))},setPrefix:function(r){return this.options.prefix=r,this._update(),this},addAttribution:function(r){return r?(this._attributions[r]||(this._attributions[r]=0),this._attributions[r]++,this._update(),this):this},removeAttribution:function(r){return r?(this._attributions[r]&&(this._attributions[r]--,this._update()),this):this},_update:function(){if(this._map){var r=[];for(var c in this._attributions)this._attributions[c]&&r.push(c);var m=[];this.options.prefix&&m.push(this.options.prefix),r.length&&m.push(r.join(", ")),this._container.innerHTML=m.join(' <span aria-hidden="true">|</span> ')}}});In.mergeOptions({attributionControl:!0}),In.addInitHook(function(){this.options.attributionControl&&new Yr().addTo(this)});var ma=function(r){return new Yr(r)};dn.Layers=qo,dn.Zoom=Er,dn.Scale=Ds,dn.Attribution=Yr,br.layers=bo,br.zoom=za,br.scale=pa,br.attribution=ma;var qi=he.extend({initialize:function(r){this._map=r},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});qi.addTo=function(r,c){return r.addHandler(c,this),this};var al={Events:F},Vo=_t.touch?"touchstart mousedown":"mousedown",Jr=G.extend({options:{clickTolerance:3},initialize:function(r,c,m,E){z(this,E),this._element=r,this._dragStartTarget=c||r,this._preventOutline=m},enable:function(){this._enabled||(Sn(this._dragStartTarget,Vo,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Jr._dragging===this&&this.finishDrag(!0),Un(this._dragStartTarget,Vo,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(r){if(this._enabled&&(this._moved=!1,!Ts(this._element,"leaflet-zoom-anim"))){if(r.touches&&r.touches.length!==1){Jr._dragging===this&&this.finishDrag();return}if(!(Jr._dragging||r.shiftKey||r.which!==1&&r.button!==1&&!r.touches)&&(Jr._dragging=this,this._preventOutline&&ca(this._element),Ra(),jo(),!this._moving)){this.fire("down");var c=r.touches?r.touches[0]:r,m=sl(this._element);this._startPoint=new Q(c.clientX,c.clientY),this._startPos=Ns(this._element),this._parentScale=ha(m);var E=r.type==="mousedown";Sn(document,E?"mousemove":"touchmove",this._onMove,this),Sn(document,E?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(r){if(this._enabled){if(r.touches&&r.touches.length>1){this._moved=!0;return}var c=r.touches&&r.touches.length===1?r.touches[0]:r,m=new Q(c.clientX,c.clientY)._subtract(this._startPoint);!m.x&&!m.y||Math.abs(m.x)+Math.abs(m.y)<this.options.clickTolerance||(m.x/=this._parentScale.x,m.y/=this._parentScale.y,Mi(r),this._moved||(this.fire("dragstart"),this._moved=!0,xn(document.body,"leaflet-dragging"),this._lastTarget=r.target||r.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),xn(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(m),this._moving=!0,this._lastEvent=r,this._updatePosition())}},_updatePosition:function(){var r={originalEvent:this._lastEvent};this.fire("predrag",r),_i(this._element,this._newPos),this.fire("drag",r)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(r){qn(document.body,"leaflet-dragging"),this._lastTarget&&(qn(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Un(document,"mousemove touchmove",this._onMove,this),Un(document,"mouseup touchend touchcancel",this._onUp,this),ms(),Js();var c=this._moved&&this._moving;this._moving=!1,Jr._dragging=!1,c&&this.fire("dragend",{noInertia:r,distance:this._newPos.distanceTo(this._startPos)})}});function va(r,c,m){var E,j=[1,4,2,8],pe,Ve,dt,bt,It,Jt,cn,Nn;for(pe=0,Jt=r.length;pe<Jt;pe++)r[pe]._code=wt(r[pe],c);for(dt=0;dt<4;dt++){for(cn=j[dt],E=[],pe=0,Jt=r.length,Ve=Jt-1;pe<Jt;Ve=pe++)bt=r[pe],It=r[Ve],bt._code&cn?It._code&cn||(Nn=ut(It,bt,cn,c,m),Nn._code=wt(Nn,c),E.push(Nn)):(It._code&cn&&(Nn=ut(It,bt,cn,c,m),Nn._code=wt(Nn,c),E.push(Nn)),E.push(bt));r=E}return r}function Ua(r,c){var m,E,j,pe,Ve,dt,bt,It,Jt;if(!r||r.length===0)throw new Error("latlngs not passed");en(r)||(console.warn("latlngs are not flat! Only the first ring will be used"),r=r[0]);var cn=R([0,0]),Nn=ae(r),Sr=Nn.getNorthWest().distanceTo(Nn.getSouthWest())*Nn.getNorthEast().distanceTo(Nn.getNorthWest());Sr<1700&&(cn=$a(r));var Wi=r.length,Dr=[];for(m=0;m<Wi;m++){var Ei=R(r[m]);Dr.push(c.project(R([Ei.lat-cn.lat,Ei.lng-cn.lng])))}for(dt=bt=It=0,m=0,E=Wi-1;m<Wi;E=m++)j=Dr[m],pe=Dr[E],Ve=j.y*pe.x-pe.y*j.x,bt+=(j.x+pe.x)*Ve,It+=(j.y+pe.y)*Ve,dt+=Ve*3;dt===0?Jt=Dr[0]:Jt=[bt/dt,It/dt];var Us=c.unproject(oe(Jt));return R([Us.lat+cn.lat,Us.lng+cn.lng])}function $a(r){for(var c=0,m=0,E=0,j=0;j<r.length;j++){var pe=R(r[j]);c+=pe.lat,m+=pe.lng,E++}return R([c/E,m/E])}var ya={__proto__:null,clipPolygon:va,polygonCenter:Ua,centroid:$a};function wo(r,c){if(!c||!r.length)return r.slice();var m=c*c;return r=ie(r,m),r=Bi(r,m),r}function Go(r,c,m){return Math.sqrt(Kt(r,c,m,!0))}function xo(r,c,m){return Kt(r,c,m)}function Bi(r,c){var m=r.length,E=typeof Uint8Array<"u"?Uint8Array:Array,j=new E(m);j[0]=j[m-1]=1,C(r,j,c,0,m-1);var pe,Ve=[];for(pe=0;pe<m;pe++)j[pe]&&Ve.push(r[pe]);return Ve}function C(r,c,m,E,j){var pe=0,Ve,dt,bt;for(dt=E+1;dt<=j-1;dt++)bt=Kt(r[dt],r[E],r[j],!0),bt>pe&&(Ve=dt,pe=bt);pe>m&&(c[Ve]=1,C(r,c,m,E,Ve),C(r,c,m,Ve,j))}function ie(r,c){for(var m=[r[0]],E=1,j=0,pe=r.length;E<pe;E++)zt(r[E],r[j])>c&&(m.push(r[E]),j=E);return j<pe-1&&m.push(r[pe-1]),m}var De;function We(r,c,m,E,j){var pe=E?De:wt(r,m),Ve=wt(c,m),dt,bt,It;for(De=Ve;;){if(!(pe|Ve))return[r,c];if(pe&Ve)return!1;dt=pe||Ve,bt=ut(r,c,dt,m,j),It=wt(bt,m),dt===pe?(r=bt,pe=It):(c=bt,Ve=It)}}function ut(r,c,m,E,j){var pe=c.x-r.x,Ve=c.y-r.y,dt=E.min,bt=E.max,It,Jt;return m&8?(It=r.x+pe*(bt.y-r.y)/Ve,Jt=bt.y):m&4?(It=r.x+pe*(dt.y-r.y)/Ve,Jt=dt.y):m&2?(It=bt.x,Jt=r.y+Ve*(bt.x-r.x)/pe):m&1&&(It=dt.x,Jt=r.y+Ve*(dt.x-r.x)/pe),new Q(It,Jt,j)}function wt(r,c){var m=0;return r.x<c.min.x?m|=1:r.x>c.max.x&&(m|=2),r.y<c.min.y?m|=4:r.y>c.max.y&&(m|=8),m}function zt(r,c){var m=c.x-r.x,E=c.y-r.y;return m*m+E*E}function Kt(r,c,m,E){var j=c.x,pe=c.y,Ve=m.x-j,dt=m.y-pe,bt=Ve*Ve+dt*dt,It;return bt>0&&(It=((r.x-j)*Ve+(r.y-pe)*dt)/bt,It>1?(j=m.x,pe=m.y):It>0&&(j+=Ve*It,pe+=dt*It)),Ve=r.x-j,dt=r.y-pe,E?Ve*Ve+dt*dt:new Q(j,pe)}function en(r){return!se(r[0])||typeof r[0][0]!="object"&&typeof r[0][0]<"u"}function ln(r){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),en(r)}function Ln(r,c){var m,E,j,pe,Ve,dt,bt,It;if(!r||r.length===0)throw new Error("latlngs not passed");en(r)||(console.warn("latlngs are not flat! Only the first ring will be used"),r=r[0]);var Jt=R([0,0]),cn=ae(r),Nn=cn.getNorthWest().distanceTo(cn.getSouthWest())*cn.getNorthEast().distanceTo(cn.getNorthWest());Nn<1700&&(Jt=$a(r));var Sr=r.length,Wi=[];for(m=0;m<Sr;m++){var Dr=R(r[m]);Wi.push(c.project(R([Dr.lat-Jt.lat,Dr.lng-Jt.lng])))}for(m=0,E=0;m<Sr-1;m++)E+=Wi[m].distanceTo(Wi[m+1])/2;if(E===0)It=Wi[0];else for(m=0,pe=0;m<Sr-1;m++)if(Ve=Wi[m],dt=Wi[m+1],j=Ve.distanceTo(dt),pe+=j,pe>E){bt=(pe-E)/j,It=[dt.x-bt*(dt.x-Ve.x),dt.y-bt*(dt.y-Ve.y)];break}var Ei=c.unproject(oe(It));return R([Ei.lat+Jt.lat,Ei.lng+Jt.lng])}var Fn={__proto__:null,simplify:wo,pointToSegmentDistance:Go,closestPointOnSegment:xo,clipSegment:We,_getEdgeIntersection:ut,_getBitCode:wt,_sqClosestPointOnSegment:Kt,isFlat:en,_flat:ln,polylineCenter:Ln},mi={project:function(r){return new Q(r.lng,r.lat)},unproject:function(r){return new q(r.y,r.x)},bounds:new me([-180,-90],[180,90])},Wn={R:6378137,R_MINOR:6356752314245179e-9,bounds:new me([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(r){var c=Math.PI/180,m=this.R,E=r.lat*c,j=this.R_MINOR/m,pe=Math.sqrt(1-j*j),Ve=pe*Math.sin(E),dt=Math.tan(Math.PI/4-E/2)/Math.pow((1-Ve)/(1+Ve),pe/2);return E=-m*Math.log(Math.max(dt,1e-10)),new Q(r.lng*c*m,E)},unproject:function(r){for(var c=180/Math.PI,m=this.R,E=this.R_MINOR/m,j=Math.sqrt(1-E*E),pe=Math.exp(-r.y/m),Ve=Math.PI/2-2*Math.atan(pe),dt=0,bt=.1,It;dt<15&&Math.abs(bt)>1e-7;dt++)It=j*Math.sin(Ve),It=Math.pow((1-It)/(1+It),j/2),bt=Math.PI/2-2*Math.atan(pe*It)-Ve,Ve+=bt;return new q(Ve*c,r.x*c/m)}},ei={__proto__:null,LonLat:mi,Mercator:Wn,SphericalMercator:ce},Vi=o({},H,{code:"EPSG:3395",projection:Wn,transformation:function(){var r=.5/(Math.PI*Wn.R);return V(r,.5,-r,.5)}()}),Fi=o({},H,{code:"EPSG:4326",projection:mi,transformation:V(1/180,1,-1/180,.5)}),$r=o({},U,{projection:mi,transformation:V(1,0,-1,0),scale:function(r){return Math.pow(2,r)},zoom:function(r){return Math.log(r)/Math.LN2},distance:function(r,c){var m=c.lng-r.lng,E=c.lat-r.lat;return Math.sqrt(m*m+E*E)},infinite:!0});U.Earth=H,U.EPSG3395=Vi,U.EPSG3857=K,U.EPSG900913=ye,U.EPSG4326=Fi,U.Simple=$r;var oi=G.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(r){return r.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(r){return r&&r.removeLayer(this),this},getPane:function(r){return this._map.getPane(r?this.options[r]||r:this.options.pane)},addInteractiveTarget:function(r){return this._map._targets[f(r)]=this,this},removeInteractiveTarget:function(r){return delete this._map._targets[f(r)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(r){var c=r.target;if(c.hasLayer(this)){if(this._map=c,this._zoomAnimated=c._zoomAnimated,this.getEvents){var m=this.getEvents();c.on(m,this),this.once("remove",function(){c.off(m,this)},this)}this.onAdd(c),this.fire("add"),c.fire("layeradd",{layer:this})}}});In.include({addLayer:function(r){if(!r._layerAdd)throw new Error("The provided object is not a Layer.");var c=f(r);return this._layers[c]?this:(this._layers[c]=r,r._mapToAdd=this,r.beforeAdd&&r.beforeAdd(this),this.whenReady(r._layerAdd,r),this)},removeLayer:function(r){var c=f(r);return this._layers[c]?(this._loaded&&r.onRemove(this),delete this._layers[c],this._loaded&&(this.fire("layerremove",{layer:r}),r.fire("remove")),r._map=r._mapToAdd=null,this):this},hasLayer:function(r){return f(r)in this._layers},eachLayer:function(r,c){for(var m in this._layers)r.call(c,this._layers[m]);return this},_addLayers:function(r){r=r?se(r)?r:[r]:[];for(var c=0,m=r.length;c<m;c++)this.addLayer(r[c])},_addZoomLimit:function(r){(!isNaN(r.options.maxZoom)||!isNaN(r.options.minZoom))&&(this._zoomBoundLayers[f(r)]=r,this._updateZoomLevels())},_removeZoomLimit:function(r){var c=f(r);this._zoomBoundLayers[c]&&(delete this._zoomBoundLayers[c],this._updateZoomLevels())},_updateZoomLevels:function(){var r=1/0,c=-1/0,m=this._getZoomSpan();for(var E in this._zoomBoundLayers){var j=this._zoomBoundLayers[E].options;r=j.minZoom===void 0?r:Math.min(r,j.minZoom),c=j.maxZoom===void 0?c:Math.max(c,j.maxZoom)}this._layersMaxZoom=c===-1/0?void 0:c,this._layersMinZoom=r===1/0?void 0:r,m!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var wr=oi.extend({initialize:function(r,c){z(this,c),this._layers={};var m,E;if(r)for(m=0,E=r.length;m<E;m++)this.addLayer(r[m])},addLayer:function(r){var c=this.getLayerId(r);return this._layers[c]=r,this._map&&this._map.addLayer(r),this},removeLayer:function(r){var c=r in this._layers?r:this.getLayerId(r);return this._map&&this._layers[c]&&this._map.removeLayer(this._layers[c]),delete this._layers[c],this},hasLayer:function(r){var c=typeof r=="number"?r:this.getLayerId(r);return c in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(r){var c=Array.prototype.slice.call(arguments,1),m,E;for(m in this._layers)E=this._layers[m],E[r]&&E[r].apply(E,c);return this},onAdd:function(r){this.eachLayer(r.addLayer,r)},onRemove:function(r){this.eachLayer(r.removeLayer,r)},eachLayer:function(r,c){for(var m in this._layers)r.call(c,this._layers[m]);return this},getLayer:function(r){return this._layers[r]},getLayers:function(){var r=[];return this.eachLayer(r.push,r),r},setZIndex:function(r){return this.invoke("setZIndex",r)},getLayerId:function(r){return f(r)}}),ll=function(r,c){return new wr(r,c)},xr=wr.extend({addLayer:function(r){return this.hasLayer(r)?this:(r.addEventParent(this),wr.prototype.addLayer.call(this,r),this.fire("layeradd",{layer:r}))},removeLayer:function(r){return this.hasLayer(r)?(r in this._layers&&(r=this._layers[r]),r.removeEventParent(this),wr.prototype.removeLayer.call(this,r),this.fire("layerremove",{layer:r})):this},setStyle:function(r){return this.invoke("setStyle",r)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var r=new ne;for(var c in this._layers){var m=this._layers[c];r.extend(m.getBounds?m.getBounds():m.getLatLng())}return r}}),qa=function(r,c){return new xr(r,c)},vs=he.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(r){z(this,r)},createIcon:function(r){return this._createIcon("icon",r)},createShadow:function(r){return this._createIcon("shadow",r)},_createIcon:function(r,c){var m=this._getIconUrl(r);if(!m){if(r==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var E=this._createImg(m,c&&c.tagName==="IMG"?c:null);return this._setIconStyles(E,r),(this.options.crossOrigin||this.options.crossOrigin==="")&&(E.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),E},_setIconStyles:function(r,c){var m=this.options,E=m[c+"Size"];typeof E=="number"&&(E=[E,E]);var j=oe(E),pe=oe(c==="shadow"&&m.shadowAnchor||m.iconAnchor||j&&j.divideBy(2,!0));r.className="leaflet-marker-"+c+" "+(m.className||""),pe&&(r.style.marginLeft=-pe.x+"px",r.style.marginTop=-pe.y+"px"),j&&(r.style.width=j.x+"px",r.style.height=j.y+"px")},_createImg:function(r,c){return c=c||document.createElement("img"),c.src=r,c},_getIconUrl:function(r){return _t.retina&&this.options[r+"RetinaUrl"]||this.options[r+"Url"]}});function Va(r){return new vs(r)}var to=vs.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(r){return typeof to.imagePath!="string"&&(to.imagePath=this._detectIconPath()),(this.options.imagePath||to.imagePath)+vs.prototype._getIconUrl.call(this,r)},_stripUrl:function(r){var c=function(m,E,j){var pe=E.exec(m);return pe&&pe[j]};return r=c(r,/^url\((['"])?(.+)\1\)$/,2),r&&c(r,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var r=On("div","leaflet-default-icon-path",document.body),c=cr(r,"background-image")||cr(r,"backgroundImage");if(document.body.removeChild(r),c=this._stripUrl(c),c)return c;var m=document.querySelector('link[href$="leaflet.css"]');return m?m.href.substring(0,m.href.length-11-1):""}}),no=qi.extend({initialize:function(r){this._marker=r},addHooks:function(){var r=this._marker._icon;this._draggable||(this._draggable=new Jr(r,r,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),xn(r,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&qn(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(r){var c=this._marker,m=c._map,E=this._marker.options.autoPanSpeed,j=this._marker.options.autoPanPadding,pe=Ns(c._icon),Ve=m.getPixelBounds(),dt=m.getPixelOrigin(),bt=T(Ve.min._subtract(dt).add(j),Ve.max._subtract(dt).subtract(j));if(!bt.contains(pe)){var It=oe((Math.max(bt.max.x,pe.x)-bt.max.x)/(Ve.max.x-bt.max.x)-(Math.min(bt.min.x,pe.x)-bt.min.x)/(Ve.min.x-bt.min.x),(Math.max(bt.max.y,pe.y)-bt.max.y)/(Ve.max.y-bt.max.y)-(Math.min(bt.min.y,pe.y)-bt.min.y)/(Ve.min.y-bt.min.y)).multiplyBy(E);m.panBy(It,{animate:!1}),this._draggable._newPos._add(It),this._draggable._startPos._add(It),_i(c._icon,this._draggable._newPos),this._onDrag(r),this._panRequest=te(this._adjustPan.bind(this,r))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(r){this._marker.options.autoPan&&(J(this._panRequest),this._panRequest=te(this._adjustPan.bind(this,r)))},_onDrag:function(r){var c=this._marker,m=c._shadow,E=Ns(c._icon),j=c._map.layerPointToLatLng(E);m&&_i(m,E),c._latlng=j,r.latlng=j,r.oldLatLng=this._oldLatLng,c.fire("move",r).fire("drag",r)},_onDragEnd:function(r){J(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",r)}}),ji=oi.extend({options:{icon:new to,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(r,c){z(this,c),this._latlng=R(r)},onAdd:function(r){this._zoomAnimated=this._zoomAnimated&&r.options.markerZoomAnimation,this._zoomAnimated&&r.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(r){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&r.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(r){var c=this._latlng;return this._latlng=R(r),this.update(),this.fire("move",{oldLatLng:c,latlng:this._latlng})},setZIndexOffset:function(r){return this.options.zIndexOffset=r,this.update()},getIcon:function(){return this.options.icon},setIcon:function(r){return this.options.icon=r,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var r=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(r)}return this},_initIcon:function(){var r=this.options,c="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),m=r.icon.createIcon(this._icon),E=!1;m!==this._icon&&(this._icon&&this._removeIcon(),E=!0,r.title&&(m.title=r.title),m.tagName==="IMG"&&(m.alt=r.alt||"")),xn(m,c),r.keyboard&&(m.tabIndex="0",m.setAttribute("role","button")),this._icon=m,r.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Sn(m,"focus",this._panOnFocus,this);var j=r.icon.createShadow(this._shadow),pe=!1;j!==this._shadow&&(this._removeShadow(),pe=!0),j&&(xn(j,c),j.alt=""),this._shadow=j,r.opacity<1&&this._updateOpacity(),E&&this.getPane().appendChild(this._icon),this._initInteraction(),j&&pe&&this.getPane(r.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Un(this._icon,"focus",this._panOnFocus,this),yn(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&yn(this._shadow),this._shadow=null},_setPos:function(r){this._icon&&_i(this._icon,r),this._shadow&&_i(this._shadow,r),this._zIndex=r.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(r){this._icon&&(this._icon.style.zIndex=this._zIndex+r)},_animateZoom:function(r){var c=this._map._latLngToNewLayerPoint(this._latlng,r.zoom,r.center).round();this._setPos(c)},_initInteraction:function(){if(this.options.interactive&&(xn(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),no)){var r=this.options.draggable;this.dragging&&(r=this.dragging.enabled(),this.dragging.disable()),this.dragging=new no(this),r&&this.dragging.enable()}},setOpacity:function(r){return this.options.opacity=r,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var r=this.options.opacity;this._icon&&Qn(this._icon,r),this._shadow&&Qn(this._shadow,r)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var r=this._map;if(r){var c=this.options.icon.options,m=c.iconSize?oe(c.iconSize):oe(0,0),E=c.iconAnchor?oe(c.iconAnchor):oe(0,0);r.panInside(this._latlng,{paddingTopLeft:E,paddingBottomRight:m.subtract(E)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function _a(r,c){return new ji(r,c)}var Ar=oi.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(r){this._renderer=r.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(r){return z(this,r),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&r&&Object.prototype.hasOwnProperty.call(r,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Lr=Ar.extend({options:{fill:!0,radius:10},initialize:function(r,c){z(this,c),this._latlng=R(r),this._radius=this.options.radius},setLatLng:function(r){var c=this._latlng;return this._latlng=R(r),this.redraw(),this.fire("move",{oldLatLng:c,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(r){return this.options.radius=this._radius=r,this.redraw()},getRadius:function(){return this._radius},setStyle:function(r){var c=r&&r.radius||this._radius;return Ar.prototype.setStyle.call(this,r),this.setRadius(c),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var r=this._radius,c=this._radiusY||r,m=this._clickTolerance(),E=[r+m,c+m];this._pxBounds=new me(this._point.subtract(E),this._point.add(E))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(r){return r.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function ba(r,c){return new Lr(r,c)}var hr=Lr.extend({initialize:function(r,c,m){if(typeof c=="number"&&(c=o({},m,{radius:c})),z(this,c),this._latlng=R(r),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(r){return this._mRadius=r,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var r=[this._radius,this._radiusY||this._radius];return new ne(this._map.layerPointToLatLng(this._point.subtract(r)),this._map.layerPointToLatLng(this._point.add(r)))},setStyle:Ar.prototype.setStyle,_project:function(){var r=this._latlng.lng,c=this._latlng.lat,m=this._map,E=m.options.crs;if(E.distance===H.distance){var j=Math.PI/180,pe=this._mRadius/H.R/j,Ve=m.project([c+pe,r]),dt=m.project([c-pe,r]),bt=Ve.add(dt).divideBy(2),It=m.unproject(bt).lat,Jt=Math.acos((Math.cos(pe*j)-Math.sin(c*j)*Math.sin(It*j))/(Math.cos(c*j)*Math.cos(It*j)))/j;(isNaN(Jt)||Jt===0)&&(Jt=pe/Math.cos(Math.PI/180*c)),this._point=bt.subtract(m.getPixelOrigin()),this._radius=isNaN(Jt)?0:bt.x-m.project([It,r-Jt]).x,this._radiusY=bt.y-Ve.y}else{var cn=E.unproject(E.project(this._latlng).subtract([this._mRadius,0]));this._point=m.latLngToLayerPoint(this._latlng),this._radius=this._point.x-m.latLngToLayerPoint(cn).x}this._updateBounds()}});function io(r,c,m){return new hr(r,c,m)}var qr=Ar.extend({options:{smoothFactor:1,noClip:!1},initialize:function(r,c){z(this,c),this._setLatLngs(r)},getLatLngs:function(){return this._latlngs},setLatLngs:function(r){return this._setLatLngs(r),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(r){for(var c=1/0,m=null,E=Kt,j,pe,Ve=0,dt=this._parts.length;Ve<dt;Ve++)for(var bt=this._parts[Ve],It=1,Jt=bt.length;It<Jt;It++){j=bt[It-1],pe=bt[It];var cn=E(r,j,pe,!0);cn<c&&(c=cn,m=E(r,j,pe))}return m&&(m.distance=Math.sqrt(c)),m},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Ln(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(r,c){return c=c||this._defaultShape(),r=R(r),c.push(r),this._bounds.extend(r),this.redraw()},_setLatLngs:function(r){this._bounds=new ne,this._latlngs=this._convertLatLngs(r)},_defaultShape:function(){return en(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(r){for(var c=[],m=en(r),E=0,j=r.length;E<j;E++)m?(c[E]=R(r[E]),this._bounds.extend(c[E])):c[E]=this._convertLatLngs(r[E]);return c},_project:function(){var r=new me;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,r),this._bounds.isValid()&&r.isValid()&&(this._rawPxBounds=r,this._updateBounds())},_updateBounds:function(){var r=this._clickTolerance(),c=new Q(r,r);this._rawPxBounds&&(this._pxBounds=new me([this._rawPxBounds.min.subtract(c),this._rawPxBounds.max.add(c)]))},_projectLatlngs:function(r,c,m){var E=r[0]instanceof q,j=r.length,pe,Ve;if(E){for(Ve=[],pe=0;pe<j;pe++)Ve[pe]=this._map.latLngToLayerPoint(r[pe]),m.extend(Ve[pe]);c.push(Ve)}else for(pe=0;pe<j;pe++)this._projectLatlngs(r[pe],c,m)},_clipPoints:function(){var r=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(r))){if(this.options.noClip){this._parts=this._rings;return}var c=this._parts,m,E,j,pe,Ve,dt,bt;for(m=0,j=0,pe=this._rings.length;m<pe;m++)for(bt=this._rings[m],E=0,Ve=bt.length;E<Ve-1;E++)dt=We(bt[E],bt[E+1],r,E,!0),dt&&(c[j]=c[j]||[],c[j].push(dt[0]),(dt[1]!==bt[E+1]||E===Ve-2)&&(c[j].push(dt[1]),j++))}},_simplifyPoints:function(){for(var r=this._parts,c=this.options.smoothFactor,m=0,E=r.length;m<E;m++)r[m]=wo(r[m],c)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(r,c){var m,E,j,pe,Ve,dt,bt=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(r))return!1;for(m=0,pe=this._parts.length;m<pe;m++)for(dt=this._parts[m],E=0,Ve=dt.length,j=Ve-1;E<Ve;j=E++)if(!(!c&&E===0)&&Go(r,dt[j],dt[E])<=bt)return!0;return!1}});function ul(r,c){return new qr(r,c)}qr._flat=ln;var Gi=qr.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Ua(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(r){var c=qr.prototype._convertLatLngs.call(this,r),m=c.length;return m>=2&&c[0]instanceof q&&c[0].equals(c[m-1])&&c.pop(),c},_setLatLngs:function(r){qr.prototype._setLatLngs.call(this,r),en(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return en(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var r=this._renderer._bounds,c=this.options.weight,m=new Q(c,c);if(r=new me(r.min.subtract(m),r.max.add(m)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(r))){if(this.options.noClip){this._parts=this._rings;return}for(var E=0,j=this._rings.length,pe;E<j;E++)pe=va(this._rings[E],r,!0),pe.length&&this._parts.push(pe)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(r){var c=!1,m,E,j,pe,Ve,dt,bt,It;if(!this._pxBounds||!this._pxBounds.contains(r))return!1;for(pe=0,bt=this._parts.length;pe<bt;pe++)for(m=this._parts[pe],Ve=0,It=m.length,dt=It-1;Ve<It;dt=Ve++)E=m[Ve],j=m[dt],E.y>r.y!=j.y>r.y&&r.x<(j.x-E.x)*(r.y-E.y)/(j.y-E.y)+E.x&&(c=!c);return c||qr.prototype._containsPoint.call(this,r,!0)}});function Rs(r,c){return new Gi(r,c)}var Xr=xr.extend({initialize:function(r,c){z(this,c),this._layers={},r&&this.addData(r)},addData:function(r){var c=se(r)?r:r.features,m,E,j;if(c){for(m=0,E=c.length;m<E;m++)j=c[m],(j.geometries||j.geometry||j.features||j.coordinates)&&this.addData(j);return this}var pe=this.options;if(pe.filter&&!pe.filter(r))return this;var Ve=Ho(r,pe);return Ve?(Ve.feature=Qr(r),Ve.defaultOptions=Ve.options,this.resetStyle(Ve),pe.onEachFeature&&pe.onEachFeature(r,Ve),this.addLayer(Ve)):this},resetStyle:function(r){return r===void 0?this.eachLayer(this.resetStyle,this):(r.options=o({},r.defaultOptions),this._setLayerStyle(r,this.options.style),this)},setStyle:function(r){return this.eachLayer(function(c){this._setLayerStyle(c,r)},this)},_setLayerStyle:function(r,c){r.setStyle&&(typeof c=="function"&&(c=c(r.feature)),r.setStyle(c))}});function Ho(r,c){var m=r.type==="Feature"?r.geometry:r,E=m?m.coordinates:null,j=[],pe=c&&c.pointToLayer,Ve=c&&c.coordsToLatLng||Os,dt,bt,It,Jt;if(!E&&!m)return null;switch(m.type){case"Point":return dt=Ve(E),ro(pe,r,dt,c);case"MultiPoint":for(It=0,Jt=E.length;It<Jt;It++)dt=Ve(E[It]),j.push(ro(pe,r,dt,c));return new xr(j);case"LineString":case"MultiLineString":return bt=er(E,m.type==="LineString"?0:1,Ve),new qr(bt,c);case"Polygon":case"MultiPolygon":return bt=er(E,m.type==="Polygon"?1:2,Ve),new Gi(bt,c);case"GeometryCollection":for(It=0,Jt=m.geometries.length;It<Jt;It++){var cn=Ho({geometry:m.geometries[It],type:"Feature",properties:r.properties},c);cn&&j.push(cn)}return new xr(j);case"FeatureCollection":for(It=0,Jt=m.features.length;It<Jt;It++){var Nn=Ho(m.features[It],c);Nn&&j.push(Nn)}return new xr(j);default:throw new Error("Invalid GeoJSON object.")}}function ro(r,c,m,E){return r?r(c,m):new ji(m,E&&E.markersInheritOptions&&E)}function Os(r){return new q(r[1],r[0],r[2])}function er(r,c,m){for(var E=[],j=0,pe=r.length,Ve;j<pe;j++)Ve=c?er(r[j],c-1,m):(m||Os)(r[j]),E.push(Ve);return E}function Yi(r,c){return r=R(r),r.alt!==void 0?[k(r.lng,c),k(r.lat,c),k(r.alt,c)]:[k(r.lng,c),k(r.lat,c)]}function ys(r,c,m,E){for(var j=[],pe=0,Ve=r.length;pe<Ve;pe++)j.push(c?ys(r[pe],en(r[pe])?0:c-1,m,E):Yi(r[pe],E));return!c&&m&&j.length>0&&j.push(j[0].slice()),j}function Mr(r,c){return r.feature?o({},r.feature,{geometry:c}):Qr(c)}function Qr(r){return r.type==="Feature"||r.type==="FeatureCollection"?r:{type:"Feature",properties:{},geometry:r}}var so={toGeoJSON:function(r){return Mr(this,{type:"Point",coordinates:Yi(this.getLatLng(),r)})}};ji.include(so),hr.include(so),Lr.include(so),qr.include({toGeoJSON:function(r){var c=!en(this._latlngs),m=ys(this._latlngs,c?1:0,!1,r);return Mr(this,{type:(c?"Multi":"")+"LineString",coordinates:m})}}),Gi.include({toGeoJSON:function(r){var c=!en(this._latlngs),m=c&&!en(this._latlngs[0]),E=ys(this._latlngs,m?2:c?1:0,!0,r);return c||(E=[E]),Mr(this,{type:(m?"Multi":"")+"Polygon",coordinates:E})}}),wr.include({toMultiPoint:function(r){var c=[];return this.eachLayer(function(m){c.push(m.toGeoJSON(r).geometry.coordinates)}),Mr(this,{type:"MultiPoint",coordinates:c})},toGeoJSON:function(r){var c=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(c==="MultiPoint")return this.toMultiPoint(r);var m=c==="GeometryCollection",E=[];return this.eachLayer(function(j){if(j.toGeoJSON){var pe=j.toGeoJSON(r);if(m)E.push(pe.geometry);else{var Ve=Qr(pe);Ve.type==="FeatureCollection"?E.push.apply(E,Ve.features):E.push(Ve)}}}),m?Mr(this,{geometries:E,type:"GeometryCollection"}):{type:"FeatureCollection",features:E}}});function es(r,c){return new Xr(r,c)}var Si=es,Is=oi.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(r,c,m){this._url=r,this._bounds=ae(c),z(this,m)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(xn(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){yn(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(r){return this.options.opacity=r,this._image&&this._updateOpacity(),this},setStyle:function(r){return r.opacity&&this.setOpacity(r.opacity),this},bringToFront:function(){return this._map&&Hr(this._image),this},bringToBack:function(){return this._map&&zr(this._image),this},setUrl:function(r){return this._url=r,this._image&&(this._image.src=r),this},setBounds:function(r){return this._bounds=ae(r),this._map&&this._reset(),this},getEvents:function(){var r={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(r.zoomanim=this._animateZoom),r},setZIndex:function(r){return this.options.zIndex=r,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var r=this._url.tagName==="IMG",c=this._image=r?this._url:On("img");if(xn(c,"leaflet-image-layer"),this._zoomAnimated&&xn(c,"leaflet-zoom-animated"),this.options.className&&xn(c,this.options.className),c.onselectstart=x,c.onmousemove=x,c.onload=u(this.fire,this,"load"),c.onerror=u(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(c.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),r){this._url=c.src;return}c.src=this._url,c.alt=this.options.alt},_animateZoom:function(r){var c=this._map.getZoomScale(r.zoom),m=this._map._latLngBoundsToNewLayerBounds(this._bounds,r.zoom,r.center).min;Wr(this._image,m,c)},_reset:function(){var r=this._image,c=new me(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),m=c.getSize();_i(r,c.min),r.style.width=m.x+"px",r.style.height=m.y+"px"},_updateOpacity:function(){Qn(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var r=this.options.errorOverlayUrl;r&&this._url!==r&&(this._url=r,this._image.src=r)},getCenter:function(){return this._bounds.getCenter()}}),Cr=function(r,c,m){return new Is(r,c,m)},dr=Is.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var r=this._url.tagName==="VIDEO",c=this._image=r?this._url:On("video");if(xn(c,"leaflet-image-layer"),this._zoomAnimated&&xn(c,"leaflet-zoom-animated"),this.options.className&&xn(c,this.options.className),c.onselectstart=x,c.onmousemove=x,c.onloadeddata=u(this.fire,this,"load"),r){for(var m=c.getElementsByTagName("source"),E=[],j=0;j<m.length;j++)E.push(m[j].src);this._url=m.length>0?E:[c.src];return}se(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(c.style,"objectFit")&&(c.style.objectFit="fill"),c.autoplay=!!this.options.autoplay,c.loop=!!this.options.loop,c.muted=!!this.options.muted,c.playsInline=!!this.options.playsInline;for(var pe=0;pe<this._url.length;pe++){var Ve=On("source");Ve.src=this._url[pe],c.appendChild(Ve)}}});function Wo(r,c,m){return new dr(r,c,m)}var Ga=Is.extend({_initImage:function(){var r=this._image=this._url;xn(r,"leaflet-image-layer"),this._zoomAnimated&&xn(r,"leaflet-zoom-animated"),this.options.className&&xn(r,this.options.className),r.onselectstart=x,r.onmousemove=x}});function Ha(r,c,m){return new Ga(r,c,m)}var fr=oi.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(r,c){r&&(r instanceof q||se(r))?(this._latlng=R(r),z(this,c)):(z(this,r),this._source=c),this.options.content&&(this._content=this.options.content)},openOn:function(r){return r=arguments.length?r:this._source._map,r.hasLayer(this)||r.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(r){return this._map?this.close():(arguments.length?this._source=r:r=this._source,this._prepareOpen(),this.openOn(r._map)),this},onAdd:function(r){this._zoomAnimated=r._zoomAnimated,this._container||this._initLayout(),r._fadeAnimated&&Qn(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),r._fadeAnimated&&Qn(this._container,1),this.bringToFront(),this.options.interactive&&(xn(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(r){r._fadeAnimated?(Qn(this._container,0),this._removeTimeout=setTimeout(u(yn,void 0,this._container),200)):yn(this._container),this.options.interactive&&(qn(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(r){return this._latlng=R(r),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(r){return this._content=r,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var r={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(r.zoomanim=this._animateZoom),r},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Hr(this._container),this},bringToBack:function(){return this._map&&zr(this._container),this},_prepareOpen:function(r){var c=this._source;if(!c._map)return!1;if(c instanceof xr){c=null;var m=this._source._layers;for(var E in m)if(m[E]._map){c=m[E];break}if(!c)return!1;this._source=c}if(!r)if(c.getCenter)r=c.getCenter();else if(c.getLatLng)r=c.getLatLng();else if(c.getBounds)r=c.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(r),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var r=this._contentNode,c=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof c=="string")r.innerHTML=c;else{for(;r.hasChildNodes();)r.removeChild(r.firstChild);r.appendChild(c)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var r=this._map.latLngToLayerPoint(this._latlng),c=oe(this.options.offset),m=this._getAnchor();this._zoomAnimated?_i(this._container,r.add(m)):c=c.add(r).add(m);var E=this._containerBottom=-c.y,j=this._containerLeft=-Math.round(this._containerWidth/2)+c.x;this._container.style.bottom=E+"px",this._container.style.left=j+"px"}},_getAnchor:function(){return[0,0]}});In.include({_initOverlay:function(r,c,m,E){var j=c;return j instanceof r||(j=new r(E).setContent(c)),m&&j.setLatLng(m),j}}),oi.include({_initOverlay:function(r,c,m,E){var j=m;return j instanceof r?(z(j,E),j._source=this):(j=c&&!E?c:new r(E,this),j.setContent(m)),j}});var Br=fr.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(r){return r=arguments.length?r:this._source._map,!r.hasLayer(this)&&r._popup&&r._popup.options.autoClose&&r.removeLayer(r._popup),r._popup=this,fr.prototype.openOn.call(this,r)},onAdd:function(r){fr.prototype.onAdd.call(this,r),r.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Ar||this._source.on("preclick",Qs))},onRemove:function(r){fr.prototype.onRemove.call(this,r),r.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Ar||this._source.off("preclick",Qs))},getEvents:function(){var r=fr.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(r.preclick=this.close),this.options.keepInView&&(r.moveend=this._adjustPan),r},_initLayout:function(){var r="leaflet-popup",c=this._container=On("div",r+" "+(this.options.className||"")+" leaflet-zoom-animated"),m=this._wrapper=On("div",r+"-content-wrapper",c);if(this._contentNode=On("div",r+"-content",m),zo(c),Ia(this._contentNode),Sn(c,"contextmenu",Qs),this._tipContainer=On("div",r+"-tip-container",c),this._tip=On("div",r+"-tip",this._tipContainer),this.options.closeButton){var E=this._closeButton=On("a",r+"-close-button",c);E.setAttribute("role","button"),E.setAttribute("aria-label","Close popup"),E.href="#close",E.innerHTML='<span aria-hidden="true">&#215;</span>',Sn(E,"click",function(j){Mi(j),this.close()},this)}},_updateLayout:function(){var r=this._contentNode,c=r.style;c.width="",c.whiteSpace="nowrap";var m=r.offsetWidth;m=Math.min(m,this.options.maxWidth),m=Math.max(m,this.options.minWidth),c.width=m+1+"px",c.whiteSpace="",c.height="";var E=r.offsetHeight,j=this.options.maxHeight,pe="leaflet-popup-scrolled";j&&E>j?(c.height=j+"px",xn(r,pe)):qn(r,pe),this._containerWidth=this._container.offsetWidth},_animateZoom:function(r){var c=this._map._latLngToNewLayerPoint(this._latlng,r.zoom,r.center),m=this._getAnchor();_i(this._container,c.add(m))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var r=this._map,c=parseInt(cr(this._container,"marginBottom"),10)||0,m=this._container.offsetHeight+c,E=this._containerWidth,j=new Q(this._containerLeft,-m-this._containerBottom);j._add(Ns(this._container));var pe=r.layerPointToContainerPoint(j),Ve=oe(this.options.autoPanPadding),dt=oe(this.options.autoPanPaddingTopLeft||Ve),bt=oe(this.options.autoPanPaddingBottomRight||Ve),It=r.getSize(),Jt=0,cn=0;pe.x+E+bt.x>It.x&&(Jt=pe.x+E-It.x+bt.x),pe.x-Jt-dt.x<0&&(Jt=pe.x-dt.x),pe.y+m+bt.y>It.y&&(cn=pe.y+m-It.y+bt.y),pe.y-cn-dt.y<0&&(cn=pe.y-dt.y),(Jt||cn)&&(this.options.keepInView&&(this._autopanning=!0),r.fire("autopanstart").panBy([Jt,cn]))}},_getAnchor:function(){return oe(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Lo=function(r,c){return new Br(r,c)};In.mergeOptions({closePopupOnClick:!0}),In.include({openPopup:function(r,c,m){return this._initOverlay(Br,r,c,m).openOn(this),this},closePopup:function(r){return r=arguments.length?r:this._popup,r&&r.close(),this}}),oi.include({bindPopup:function(r,c){return this._popup=this._initOverlay(Br,this._popup,r,c),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(r){return this._popup&&(this instanceof xr||(this._popup._source=this),this._popup._prepareOpen(r||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(r){return this._popup&&this._popup.setContent(r),this},getPopup:function(){return this._popup},_openPopup:function(r){if(!(!this._popup||!this._map)){Ur(r);var c=r.layer||r.target;if(this._popup._source===c&&!(c instanceof Ar)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(r.latlng);return}this._popup._source=c,this.openPopup(r.latlng)}},_movePopup:function(r){this._popup.setLatLng(r.latlng)},_onKeyPress:function(r){r.originalEvent.keyCode===13&&this._openPopup(r)}});var Fs=fr.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(r){fr.prototype.onAdd.call(this,r),this.setOpacity(this.options.opacity),r.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(r){fr.prototype.onRemove.call(this,r),r.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var r=fr.prototype.getEvents.call(this);return this.options.permanent||(r.preclick=this.close),r},_initLayout:function(){var r="leaflet-tooltip",c=r+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=On("div",c),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+f(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(r){var c,m,E=this._map,j=this._container,pe=E.latLngToContainerPoint(E.getCenter()),Ve=E.layerPointToContainerPoint(r),dt=this.options.direction,bt=j.offsetWidth,It=j.offsetHeight,Jt=oe(this.options.offset),cn=this._getAnchor();dt==="top"?(c=bt/2,m=It):dt==="bottom"?(c=bt/2,m=0):dt==="center"?(c=bt/2,m=It/2):dt==="right"?(c=0,m=It/2):dt==="left"?(c=bt,m=It/2):Ve.x<pe.x?(dt="right",c=0,m=It/2):(dt="left",c=bt+(Jt.x+cn.x)*2,m=It/2),r=r.subtract(oe(c,m,!0)).add(Jt).add(cn),qn(j,"leaflet-tooltip-right"),qn(j,"leaflet-tooltip-left"),qn(j,"leaflet-tooltip-top"),qn(j,"leaflet-tooltip-bottom"),xn(j,"leaflet-tooltip-"+dt),_i(j,r)},_updatePosition:function(){var r=this._map.latLngToLayerPoint(this._latlng);this._setPosition(r)},setOpacity:function(r){this.options.opacity=r,this._container&&Qn(this._container,r)},_animateZoom:function(r){var c=this._map._latLngToNewLayerPoint(this._latlng,r.zoom,r.center);this._setPosition(c)},_getAnchor:function(){return oe(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),wa=function(r,c){return new Fs(r,c)};In.include({openTooltip:function(r,c,m){return this._initOverlay(Fs,r,c,m).openOn(this),this},closeTooltip:function(r){return r.close(),this}}),oi.include({bindTooltip:function(r,c){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Fs,this._tooltip,r,c),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(r){if(!(!r&&this._tooltipHandlersAdded)){var c=r?"off":"on",m={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?m.add=this._openTooltip:(m.mouseover=this._openTooltip,m.mouseout=this.closeTooltip,m.click=this._openTooltip,this._map?this._addFocusListeners():m.add=this._addFocusListeners),this._tooltip.options.sticky&&(m.mousemove=this._moveTooltip),this[c](m),this._tooltipHandlersAdded=!r}},openTooltip:function(r){return this._tooltip&&(this instanceof xr||(this._tooltip._source=this),this._tooltip._prepareOpen(r)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(r){return this._tooltip&&this._tooltip.setContent(r),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(r){var c=typeof r.getElement=="function"&&r.getElement();c&&(Sn(c,"focus",function(){this._tooltip._source=r,this.openTooltip()},this),Sn(c,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(r){var c=typeof r.getElement=="function"&&r.getElement();c&&c.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(r){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var c=this;this._map.once("moveend",function(){c._openOnceFlag=!1,c._openTooltip(r)});return}this._tooltip._source=r.layer||r.target,this.openTooltip(this._tooltip.options.sticky?r.latlng:void 0)}},_moveTooltip:function(r){var c=r.latlng,m,E;this._tooltip.options.sticky&&r.originalEvent&&(m=this._map.mouseEventToContainerPoint(r.originalEvent),E=this._map.containerPointToLayerPoint(m),c=this._map.layerPointToLatLng(E)),this._tooltip.setLatLng(c)}});var Co=vs.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(r){var c=r&&r.tagName==="DIV"?r:document.createElement("div"),m=this.options;if(m.html instanceof Element?(ps(c),c.appendChild(m.html)):c.innerHTML=m.html!==!1?m.html:"",m.bgPos){var E=oe(m.bgPos);c.style.backgroundPosition=-E.x+"px "+-E.y+"px"}return this._setIconStyles(c,"icon"),c},createShadow:function(){return null}});function Po(r){return new Co(r)}vs.Default=to;var oo=oi.extend({options:{tileSize:256,opacity:1,updateWhenIdle:_t.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(r){z(this,r)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(r){r._addZoomLimit(this)},onRemove:function(r){this._removeAllTiles(),yn(this._container),r._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Hr(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(zr(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(r){return this.options.opacity=r,this._updateOpacity(),this},setZIndex:function(r){return this.options.zIndex=r,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var r=this._clampZoom(this._map.getZoom());r!==this._tileZoom&&(this._tileZoom=r,this._updateLevels()),this._update()}return this},getEvents:function(){var r={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=v(this._onMoveEnd,this.options.updateInterval,this)),r.move=this._onMove),this._zoomAnimated&&(r.zoomanim=this._animateZoom),r},createTile:function(){return document.createElement("div")},getTileSize:function(){var r=this.options.tileSize;return r instanceof Q?r:new Q(r,r)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(r){for(var c=this.getPane().children,m=-r(-1/0,1/0),E=0,j=c.length,pe;E<j;E++)pe=c[E].style.zIndex,c[E]!==this._container&&pe&&(m=r(m,+pe));isFinite(m)&&(this.options.zIndex=m+r(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!_t.ielt9){Qn(this._container,this.options.opacity);var r=+new Date,c=!1,m=!1;for(var E in this._tiles){var j=this._tiles[E];if(!(!j.current||!j.loaded)){var pe=Math.min(1,(r-j.loaded)/200);Qn(j.el,pe),pe<1?c=!0:(j.active?m=!0:this._onOpaqueTile(j),j.active=!0)}}m&&!this._noPrune&&this._pruneTiles(),c&&(J(this._fadeFrame),this._fadeFrame=te(this._updateOpacity,this))}},_onOpaqueTile:x,_initContainer:function(){this._container||(this._container=On("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var r=this._tileZoom,c=this.options.maxZoom;if(r!==void 0){for(var m in this._levels)m=Number(m),this._levels[m].el.children.length||m===r?(this._levels[m].el.style.zIndex=c-Math.abs(r-m),this._onUpdateLevel(m)):(yn(this._levels[m].el),this._removeTilesAtZoom(m),this._onRemoveLevel(m),delete this._levels[m]);var E=this._levels[r],j=this._map;return E||(E=this._levels[r]={},E.el=On("div","leaflet-tile-container leaflet-zoom-animated",this._container),E.el.style.zIndex=c,E.origin=j.project(j.unproject(j.getPixelOrigin()),r).round(),E.zoom=r,this._setZoomTransform(E,j.getCenter(),j.getZoom()),x(E.el.offsetWidth),this._onCreateLevel(E)),this._level=E,E}},_onUpdateLevel:x,_onRemoveLevel:x,_onCreateLevel:x,_pruneTiles:function(){if(this._map){var r,c,m=this._map.getZoom();if(m>this.options.maxZoom||m<this.options.minZoom){this._removeAllTiles();return}for(r in this._tiles)c=this._tiles[r],c.retain=c.current;for(r in this._tiles)if(c=this._tiles[r],c.current&&!c.active){var E=c.coords;this._retainParent(E.x,E.y,E.z,E.z-5)||this._retainChildren(E.x,E.y,E.z,E.z+2)}for(r in this._tiles)this._tiles[r].retain||this._removeTile(r)}},_removeTilesAtZoom:function(r){for(var c in this._tiles)this._tiles[c].coords.z===r&&this._removeTile(c)},_removeAllTiles:function(){for(var r in this._tiles)this._removeTile(r)},_invalidateAll:function(){for(var r in this._levels)yn(this._levels[r].el),this._onRemoveLevel(Number(r)),delete this._levels[r];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(r,c,m,E){var j=Math.floor(r/2),pe=Math.floor(c/2),Ve=m-1,dt=new Q(+j,+pe);dt.z=+Ve;var bt=this._tileCoordsToKey(dt),It=this._tiles[bt];return It&&It.active?(It.retain=!0,!0):(It&&It.loaded&&(It.retain=!0),Ve>E?this._retainParent(j,pe,Ve,E):!1)},_retainChildren:function(r,c,m,E){for(var j=2*r;j<2*r+2;j++)for(var pe=2*c;pe<2*c+2;pe++){var Ve=new Q(j,pe);Ve.z=m+1;var dt=this._tileCoordsToKey(Ve),bt=this._tiles[dt];if(bt&&bt.active){bt.retain=!0;continue}else bt&&bt.loaded&&(bt.retain=!0);m+1<E&&this._retainChildren(j,pe,m+1,E)}},_resetView:function(r){var c=r&&(r.pinch||r.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),c,c)},_animateZoom:function(r){this._setView(r.center,r.zoom,!0,r.noUpdate)},_clampZoom:function(r){var c=this.options;return c.minNativeZoom!==void 0&&r<c.minNativeZoom?c.minNativeZoom:c.maxNativeZoom!==void 0&&c.maxNativeZoom<r?c.maxNativeZoom:r},_setView:function(r,c,m,E){var j=Math.round(c);this.options.maxZoom!==void 0&&j>this.options.maxZoom||this.options.minZoom!==void 0&&j<this.options.minZoom?j=void 0:j=this._clampZoom(j);var pe=this.options.updateWhenZooming&&j!==this._tileZoom;(!E||pe)&&(this._tileZoom=j,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),j!==void 0&&this._update(r),m||this._pruneTiles(),this._noPrune=!!m),this._setZoomTransforms(r,c)},_setZoomTransforms:function(r,c){for(var m in this._levels)this._setZoomTransform(this._levels[m],r,c)},_setZoomTransform:function(r,c,m){var E=this._map.getZoomScale(m,r.zoom),j=r.origin.multiplyBy(E).subtract(this._map._getNewPixelOrigin(c,m)).round();_t.any3d?Wr(r.el,j,E):_i(r.el,j)},_resetGrid:function(){var r=this._map,c=r.options.crs,m=this._tileSize=this.getTileSize(),E=this._tileZoom,j=this._map.getPixelWorldBounds(this._tileZoom);j&&(this._globalTileRange=this._pxBoundsToTileRange(j)),this._wrapX=c.wrapLng&&!this.options.noWrap&&[Math.floor(r.project([0,c.wrapLng[0]],E).x/m.x),Math.ceil(r.project([0,c.wrapLng[1]],E).x/m.y)],this._wrapY=c.wrapLat&&!this.options.noWrap&&[Math.floor(r.project([c.wrapLat[0],0],E).y/m.x),Math.ceil(r.project([c.wrapLat[1],0],E).y/m.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(r){var c=this._map,m=c._animatingZoom?Math.max(c._animateToZoom,c.getZoom()):c.getZoom(),E=c.getZoomScale(m,this._tileZoom),j=c.project(r,this._tileZoom).floor(),pe=c.getSize().divideBy(E*2);return new me(j.subtract(pe),j.add(pe))},_update:function(r){var c=this._map;if(c){var m=this._clampZoom(c.getZoom());if(r===void 0&&(r=c.getCenter()),this._tileZoom!==void 0){var E=this._getTiledPixelBounds(r),j=this._pxBoundsToTileRange(E),pe=j.getCenter(),Ve=[],dt=this.options.keepBuffer,bt=new me(j.getBottomLeft().subtract([dt,-dt]),j.getTopRight().add([dt,-dt]));if(!(isFinite(j.min.x)&&isFinite(j.min.y)&&isFinite(j.max.x)&&isFinite(j.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var It in this._tiles){var Jt=this._tiles[It].coords;(Jt.z!==this._tileZoom||!bt.contains(new Q(Jt.x,Jt.y)))&&(this._tiles[It].current=!1)}if(Math.abs(m-this._tileZoom)>1){this._setView(r,m);return}for(var cn=j.min.y;cn<=j.max.y;cn++)for(var Nn=j.min.x;Nn<=j.max.x;Nn++){var Sr=new Q(Nn,cn);if(Sr.z=this._tileZoom,!!this._isValidTile(Sr)){var Wi=this._tiles[this._tileCoordsToKey(Sr)];Wi?Wi.current=!0:Ve.push(Sr)}}if(Ve.sort(function(Ei,Us){return Ei.distanceTo(pe)-Us.distanceTo(pe)}),Ve.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Dr=document.createDocumentFragment();for(Nn=0;Nn<Ve.length;Nn++)this._addTile(Ve[Nn],Dr);this._level.el.appendChild(Dr)}}}},_isValidTile:function(r){var c=this._map.options.crs;if(!c.infinite){var m=this._globalTileRange;if(!c.wrapLng&&(r.x<m.min.x||r.x>m.max.x)||!c.wrapLat&&(r.y<m.min.y||r.y>m.max.y))return!1}if(!this.options.bounds)return!0;var E=this._tileCoordsToBounds(r);return ae(this.options.bounds).overlaps(E)},_keyToBounds:function(r){return this._tileCoordsToBounds(this._keyToTileCoords(r))},_tileCoordsToNwSe:function(r){var c=this._map,m=this.getTileSize(),E=r.scaleBy(m),j=E.add(m),pe=c.unproject(E,r.z),Ve=c.unproject(j,r.z);return[pe,Ve]},_tileCoordsToBounds:function(r){var c=this._tileCoordsToNwSe(r),m=new ne(c[0],c[1]);return this.options.noWrap||(m=this._map.wrapLatLngBounds(m)),m},_tileCoordsToKey:function(r){return r.x+":"+r.y+":"+r.z},_keyToTileCoords:function(r){var c=r.split(":"),m=new Q(+c[0],+c[1]);return m.z=+c[2],m},_removeTile:function(r){var c=this._tiles[r];c&&(yn(c.el),delete this._tiles[r],this.fire("tileunload",{tile:c.el,coords:this._keyToTileCoords(r)}))},_initTile:function(r){xn(r,"leaflet-tile");var c=this.getTileSize();r.style.width=c.x+"px",r.style.height=c.y+"px",r.onselectstart=x,r.onmousemove=x,_t.ielt9&&this.options.opacity<1&&Qn(r,this.options.opacity)},_addTile:function(r,c){var m=this._getTilePos(r),E=this._tileCoordsToKey(r),j=this.createTile(this._wrapCoords(r),u(this._tileReady,this,r));this._initTile(j),this.createTile.length<2&&te(u(this._tileReady,this,r,null,j)),_i(j,m),this._tiles[E]={el:j,coords:r,current:!0},c.appendChild(j),this.fire("tileloadstart",{tile:j,coords:r})},_tileReady:function(r,c,m){c&&this.fire("tileerror",{error:c,tile:m,coords:r});var E=this._tileCoordsToKey(r);m=this._tiles[E],m&&(m.loaded=+new Date,this._map._fadeAnimated?(Qn(m.el,0),J(this._fadeFrame),this._fadeFrame=te(this._updateOpacity,this)):(m.active=!0,this._pruneTiles()),c||(xn(m.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:m.el,coords:r})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),_t.ielt9||!this._map._fadeAnimated?te(this._pruneTiles,this):setTimeout(u(this._pruneTiles,this),250)))},_getTilePos:function(r){return r.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(r){var c=new Q(this._wrapX?_(r.x,this._wrapX):r.x,this._wrapY?_(r.y,this._wrapY):r.y);return c.z=r.z,c},_pxBoundsToTileRange:function(r){var c=this.getTileSize();return new me(r.min.unscaleBy(c).floor(),r.max.unscaleBy(c).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var r in this._tiles)if(!this._tiles[r].loaded)return!1;return!0}});function ts(r){return new oo(r)}var tr=oo.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(r,c){this._url=r,c=z(this,c),c.detectRetina&&_t.retina&&c.maxZoom>0?(c.tileSize=Math.floor(c.tileSize/2),c.zoomReverse?(c.zoomOffset--,c.minZoom=Math.min(c.maxZoom,c.minZoom+1)):(c.zoomOffset++,c.maxZoom=Math.max(c.minZoom,c.maxZoom-1)),c.minZoom=Math.max(0,c.minZoom)):c.zoomReverse?c.minZoom=Math.min(c.maxZoom,c.minZoom):c.maxZoom=Math.max(c.minZoom,c.maxZoom),typeof c.subdomains=="string"&&(c.subdomains=c.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(r,c){return this._url===r&&c===void 0&&(c=!0),this._url=r,c||this.redraw(),this},createTile:function(r,c){var m=document.createElement("img");return Sn(m,"load",u(this._tileOnLoad,this,c,m)),Sn(m,"error",u(this._tileOnError,this,c,m)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(m.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(m.referrerPolicy=this.options.referrerPolicy),m.alt="",m.src=this.getTileUrl(r),m},getTileUrl:function(r){var c={r:_t.retina?"@2x":"",s:this._getSubdomain(r),x:r.x,y:r.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var m=this._globalTileRange.max.y-r.y;this.options.tms&&(c.y=m),c["-y"]=m}return Z(this._url,o(c,this.options))},_tileOnLoad:function(r,c){_t.ielt9?setTimeout(u(r,this,null,c),0):r(null,c)},_tileOnError:function(r,c,m){var E=this.options.errorTileUrl;E&&c.getAttribute("src")!==E&&(c.src=E),r(m,c)},_onTileRemove:function(r){r.tile.onload=null},_getZoomForUrl:function(){var r=this._tileZoom,c=this.options.maxZoom,m=this.options.zoomReverse,E=this.options.zoomOffset;return m&&(r=c-r),r+E},_getSubdomain:function(r){var c=Math.abs(r.x+r.y)%this.options.subdomains.length;return this.options.subdomains[c]},_abortLoading:function(){var r,c;for(r in this._tiles)if(this._tiles[r].coords.z!==this._tileZoom&&(c=this._tiles[r].el,c.onload=x,c.onerror=x,!c.complete)){c.src=Ne;var m=this._tiles[r].coords;yn(c),delete this._tiles[r],this.fire("tileabort",{tile:c,coords:m})}},_removeTile:function(r){var c=this._tiles[r];if(c)return c.el.setAttribute("src",Ne),oo.prototype._removeTile.call(this,r)},_tileReady:function(r,c,m){if(!(!this._map||m&&m.getAttribute("src")===Ne))return oo.prototype._tileReady.call(this,r,c,m)}});function ri(r,c){return new tr(r,c)}var ti=tr.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(r,c){this._url=r;var m=o({},this.defaultWmsParams);for(var E in c)E in this.options||(m[E]=c[E]);c=z(this,c);var j=c.detectRetina&&_t.retina?2:1,pe=this.getTileSize();m.width=pe.x*j,m.height=pe.y*j,this.wmsParams=m},onAdd:function(r){this._crs=this.options.crs||r.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var c=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[c]=this._crs.code,tr.prototype.onAdd.call(this,r)},getTileUrl:function(r){var c=this._tileCoordsToNwSe(r),m=this._crs,E=T(m.project(c[0]),m.project(c[1])),j=E.min,pe=E.max,Ve=(this._wmsVersion>=1.3&&this._crs===Fi?[j.y,j.x,pe.y,pe.x]:[j.x,j.y,pe.x,pe.y]).join(","),dt=tr.prototype.getTileUrl.call(this,r);return dt+W(this.wmsParams,dt,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+Ve},setParams:function(r,c){return o(this.wmsParams,r),c||this.redraw(),this}});function Ti(r,c){return new ti(r,c)}tr.WMS=ti,ri.wms=Ti;var ai=oi.extend({options:{padding:.1},initialize:function(r){z(this,r),f(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),xn(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var r={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(r.zoomanim=this._onAnimZoom),r},_onAnimZoom:function(r){this._updateTransform(r.center,r.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(r,c){var m=this._map.getZoomScale(c,this._zoom),E=this._map.getSize().multiplyBy(.5+this.options.padding),j=this._map.project(this._center,c),pe=E.multiplyBy(-m).add(j).subtract(this._map._getNewPixelOrigin(r,c));_t.any3d?Wr(this._container,pe,m):_i(this._container,pe)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var r in this._layers)this._layers[r]._reset()},_onZoomEnd:function(){for(var r in this._layers)this._layers[r]._project()},_updatePaths:function(){for(var r in this._layers)this._layers[r]._update()},_update:function(){var r=this.options.padding,c=this._map.getSize(),m=this._map.containerPointToLayerPoint(c.multiplyBy(-r)).round();this._bounds=new me(m,m.add(c.multiplyBy(1+r*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),_s=ai.extend({options:{tolerance:0},getEvents:function(){var r=ai.prototype.getEvents.call(this);return r.viewprereset=this._onViewPreReset,r},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){ai.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var r=this._container=document.createElement("canvas");Sn(r,"mousemove",this._onMouseMove,this),Sn(r,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Sn(r,"mouseout",this._handleMouseOut,this),r._leaflet_disable_events=!0,this._ctx=r.getContext("2d")},_destroyContainer:function(){J(this._redrawRequest),delete this._ctx,yn(this._container),Un(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var r;this._redrawBounds=null;for(var c in this._layers)r=this._layers[c],r._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){ai.prototype._update.call(this);var r=this._bounds,c=this._container,m=r.getSize(),E=_t.retina?2:1;_i(c,r.min),c.width=E*m.x,c.height=E*m.y,c.style.width=m.x+"px",c.style.height=m.y+"px",_t.retina&&this._ctx.scale(2,2),this._ctx.translate(-r.min.x,-r.min.y),this.fire("update")}},_reset:function(){ai.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(r){this._updateDashArray(r),this._layers[f(r)]=r;var c=r._order={layer:r,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=c),this._drawLast=c,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(r){this._requestRedraw(r)},_removePath:function(r){var c=r._order,m=c.next,E=c.prev;m?m.prev=E:this._drawLast=E,E?E.next=m:this._drawFirst=m,delete r._order,delete this._layers[f(r)],this._requestRedraw(r)},_updatePath:function(r){this._extendRedrawBounds(r),r._project(),r._update(),this._requestRedraw(r)},_updateStyle:function(r){this._updateDashArray(r),this._requestRedraw(r)},_updateDashArray:function(r){if(typeof r.options.dashArray=="string"){var c=r.options.dashArray.split(/[, ]+/),m=[],E,j;for(j=0;j<c.length;j++){if(E=Number(c[j]),isNaN(E))return;m.push(E)}r.options._dashArray=m}else r.options._dashArray=r.options.dashArray},_requestRedraw:function(r){this._map&&(this._extendRedrawBounds(r),this._redrawRequest=this._redrawRequest||te(this._redraw,this))},_extendRedrawBounds:function(r){if(r._pxBounds){var c=(r.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new me,this._redrawBounds.extend(r._pxBounds.min.subtract([c,c])),this._redrawBounds.extend(r._pxBounds.max.add([c,c]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var r=this._redrawBounds;if(r){var c=r.getSize();this._ctx.clearRect(r.min.x,r.min.y,c.x,c.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var r,c=this._redrawBounds;if(this._ctx.save(),c){var m=c.getSize();this._ctx.beginPath(),this._ctx.rect(c.min.x,c.min.y,m.x,m.y),this._ctx.clip()}this._drawing=!0;for(var E=this._drawFirst;E;E=E.next)r=E.layer,(!c||r._pxBounds&&r._pxBounds.intersects(c))&&r._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(r,c){if(this._drawing){var m,E,j,pe,Ve=r._parts,dt=Ve.length,bt=this._ctx;if(dt){for(bt.beginPath(),m=0;m<dt;m++){for(E=0,j=Ve[m].length;E<j;E++)pe=Ve[m][E],bt[E?"lineTo":"moveTo"](pe.x,pe.y);c&&bt.closePath()}this._fillStroke(bt,r)}}},_updateCircle:function(r){if(!(!this._drawing||r._empty())){var c=r._point,m=this._ctx,E=Math.max(Math.round(r._radius),1),j=(Math.max(Math.round(r._radiusY),1)||E)/E;j!==1&&(m.save(),m.scale(1,j)),m.beginPath(),m.arc(c.x,c.y/j,E,0,Math.PI*2,!1),j!==1&&m.restore(),this._fillStroke(m,r)}},_fillStroke:function(r,c){var m=c.options;m.fill&&(r.globalAlpha=m.fillOpacity,r.fillStyle=m.fillColor||m.color,r.fill(m.fillRule||"evenodd")),m.stroke&&m.weight!==0&&(r.setLineDash&&r.setLineDash(c.options&&c.options._dashArray||[]),r.globalAlpha=m.opacity,r.lineWidth=m.weight,r.strokeStyle=m.color,r.lineCap=m.lineCap,r.lineJoin=m.lineJoin,r.stroke())},_onClick:function(r){for(var c=this._map.mouseEventToLayerPoint(r),m,E,j=this._drawFirst;j;j=j.next)m=j.layer,m.options.interactive&&m._containsPoint(c)&&(!(r.type==="click"||r.type==="preclick")||!this._map._draggableMoved(m))&&(E=m);this._fireEvent(E?[E]:!1,r)},_onMouseMove:function(r){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var c=this._map.mouseEventToLayerPoint(r);this._handleMouseHover(r,c)}},_handleMouseOut:function(r){var c=this._hoveredLayer;c&&(qn(this._container,"leaflet-interactive"),this._fireEvent([c],r,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(r,c){if(!this._mouseHoverThrottled){for(var m,E,j=this._drawFirst;j;j=j.next)m=j.layer,m.options.interactive&&m._containsPoint(c)&&(E=m);E!==this._hoveredLayer&&(this._handleMouseOut(r),E&&(xn(this._container,"leaflet-interactive"),this._fireEvent([E],r,"mouseover"),this._hoveredLayer=E)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,r),this._mouseHoverThrottled=!0,setTimeout(u(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(r,c,m){this._map._fireDOMEvent(c,m||c.type,r)},_bringToFront:function(r){var c=r._order;if(c){var m=c.next,E=c.prev;if(m)m.prev=E;else return;E?E.next=m:m&&(this._drawFirst=m),c.prev=this._drawLast,this._drawLast.next=c,c.next=null,this._drawLast=c,this._requestRedraw(r)}},_bringToBack:function(r){var c=r._order;if(c){var m=c.next,E=c.prev;if(E)E.next=m;else return;m?m.prev=E:E&&(this._drawLast=E),c.prev=null,c.next=this._drawFirst,this._drawFirst.prev=c,this._drawFirst=c,this._requestRedraw(r)}}});function ko(r){return _t.canvas?new _s(r):null}var js=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(r){return document.createElement("<lvml:"+r+' class="lvml">')}}catch{}return function(r){return document.createElement("<"+r+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),cl={_initContainer:function(){this._container=On("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(ai.prototype._update.call(this),this.fire("update"))},_initPath:function(r){var c=r._container=js("shape");xn(c,"leaflet-vml-shape "+(this.options.className||"")),c.coordsize="1 1",r._path=js("path"),c.appendChild(r._path),this._updateStyle(r),this._layers[f(r)]=r},_addPath:function(r){var c=r._container;this._container.appendChild(c),r.options.interactive&&r.addInteractiveTarget(c)},_removePath:function(r){var c=r._container;yn(c),r.removeInteractiveTarget(c),delete this._layers[f(r)]},_updateStyle:function(r){var c=r._stroke,m=r._fill,E=r.options,j=r._container;j.stroked=!!E.stroke,j.filled=!!E.fill,E.stroke?(c||(c=r._stroke=js("stroke")),j.appendChild(c),c.weight=E.weight+"px",c.color=E.color,c.opacity=E.opacity,E.dashArray?c.dashStyle=se(E.dashArray)?E.dashArray.join(" "):E.dashArray.replace(/( *, *)/g," "):c.dashStyle="",c.endcap=E.lineCap.replace("butt","flat"),c.joinstyle=E.lineJoin):c&&(j.removeChild(c),r._stroke=null),E.fill?(m||(m=r._fill=js("fill")),j.appendChild(m),m.color=E.fillColor||E.color,m.opacity=E.fillOpacity):m&&(j.removeChild(m),r._fill=null)},_updateCircle:function(r){var c=r._point.round(),m=Math.round(r._radius),E=Math.round(r._radiusY||m);this._setPath(r,r._empty()?"M0 0":"AL "+c.x+","+c.y+" "+m+","+E+" 0,"+65535*360)},_setPath:function(r,c){r._path.v=c},_bringToFront:function(r){Hr(r._container)},_bringToBack:function(r){zr(r._container)}},So=_t.vml?js:ve,Hi=ai.extend({_initContainer:function(){this._container=So("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=So("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){yn(this._container),Un(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){ai.prototype._update.call(this);var r=this._bounds,c=r.getSize(),m=this._container;(!this._svgSize||!this._svgSize.equals(c))&&(this._svgSize=c,m.setAttribute("width",c.x),m.setAttribute("height",c.y)),_i(m,r.min),m.setAttribute("viewBox",[r.min.x,r.min.y,c.x,c.y].join(" ")),this.fire("update")}},_initPath:function(r){var c=r._path=So("path");r.options.className&&xn(c,r.options.className),r.options.interactive&&xn(c,"leaflet-interactive"),this._updateStyle(r),this._layers[f(r)]=r},_addPath:function(r){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(r._path),r.addInteractiveTarget(r._path)},_removePath:function(r){yn(r._path),r.removeInteractiveTarget(r._path),delete this._layers[f(r)]},_updatePath:function(r){r._project(),r._update()},_updateStyle:function(r){var c=r._path,m=r.options;c&&(m.stroke?(c.setAttribute("stroke",m.color),c.setAttribute("stroke-opacity",m.opacity),c.setAttribute("stroke-width",m.weight),c.setAttribute("stroke-linecap",m.lineCap),c.setAttribute("stroke-linejoin",m.lineJoin),m.dashArray?c.setAttribute("stroke-dasharray",m.dashArray):c.removeAttribute("stroke-dasharray"),m.dashOffset?c.setAttribute("stroke-dashoffset",m.dashOffset):c.removeAttribute("stroke-dashoffset")):c.setAttribute("stroke","none"),m.fill?(c.setAttribute("fill",m.fillColor||m.color),c.setAttribute("fill-opacity",m.fillOpacity),c.setAttribute("fill-rule",m.fillRule||"evenodd")):c.setAttribute("fill","none"))},_updatePoly:function(r,c){this._setPath(r,ee(r._parts,c))},_updateCircle:function(r){var c=r._point,m=Math.max(Math.round(r._radius),1),E=Math.max(Math.round(r._radiusY),1)||m,j="a"+m+","+E+" 0 1,0 ",pe=r._empty()?"M0 0":"M"+(c.x-m)+","+c.y+j+m*2+",0 "+j+-m*2+",0 ";this._setPath(r,pe)},_setPath:function(r,c){r._path.setAttribute("d",c)},_bringToFront:function(r){Hr(r._path)},_bringToBack:function(r){zr(r._path)}});_t.vml&&Hi.include(cl);function li(r){return _t.svg||_t.vml?new Hi(r):null}In.include({getRenderer:function(r){var c=r.options.renderer||this._getPaneRenderer(r.options.pane)||this.options.renderer||this._renderer;return c||(c=this._renderer=this._createRenderer()),this.hasLayer(c)||this.addLayer(c),c},_getPaneRenderer:function(r){if(r==="overlayPane"||r===void 0)return!1;var c=this._paneRenderers[r];return c===void 0&&(c=this._createRenderer({pane:r}),this._paneRenderers[r]=c),c},_createRenderer:function(r){return this.options.preferCanvas&&ko(r)||li(r)}});var Tr=Gi.extend({initialize:function(r,c){Gi.prototype.initialize.call(this,this._boundsToLatLngs(r),c)},setBounds:function(r){return this.setLatLngs(this._boundsToLatLngs(r))},_boundsToLatLngs:function(r){return r=ae(r),[r.getSouthWest(),r.getNorthWest(),r.getNorthEast(),r.getSouthEast()]}});function Nr(r,c){return new Tr(r,c)}Hi.create=So,Hi.pointsToPath=ee,Xr.geometryToLayer=Ho,Xr.coordsToLatLng=Os,Xr.coordsToLatLngs=er,Xr.latLngToCoords=Yi,Xr.latLngsToCoords=ys,Xr.getFeature=Mr,Xr.asFeature=Qr,In.mergeOptions({boxZoom:!0});var _n=qi.extend({initialize:function(r){this._map=r,this._container=r._container,this._pane=r._panes.overlayPane,this._resetStateTimeout=0,r.on("unload",this._destroy,this)},addHooks:function(){Sn(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Un(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){yn(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(r){if(!r.shiftKey||r.which!==1&&r.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),jo(),Ra(),this._startPoint=this._map.mouseEventToContainerPoint(r),Sn(document,{contextmenu:Ur,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(r){this._moved||(this._moved=!0,this._box=On("div","leaflet-zoom-box",this._container),xn(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(r);var c=new me(this._point,this._startPoint),m=c.getSize();_i(this._box,c.min),this._box.style.width=m.x+"px",this._box.style.height=m.y+"px"},_finish:function(){this._moved&&(yn(this._box),qn(this._container,"leaflet-crosshair")),Js(),ms(),Un(document,{contextmenu:Ur,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(r){if(!(r.which!==1&&r.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(u(this._resetState,this),0);var c=new ne(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(c).fire("boxzoomend",{boxZoomBounds:c})}},_onKeyDown:function(r){r.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});In.addInitHook("addHandler","boxZoom",_n),In.mergeOptions({doubleClickZoom:!0});var hl=qi.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(r){var c=this._map,m=c.getZoom(),E=c.options.zoomDelta,j=r.originalEvent.shiftKey?m-E:m+E;c.options.doubleClickZoom==="center"?c.setZoom(j):c.setZoomAround(r.containerPoint,j)}});In.addInitHook("addHandler","doubleClickZoom",hl),In.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Zo=qi.extend({addHooks:function(){if(!this._draggable){var r=this._map;this._draggable=new Jr(r._mapPane,r._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),r.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),r.on("zoomend",this._onZoomEnd,this),r.whenReady(this._onZoomEnd,this))}xn(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){qn(this._map._container,"leaflet-grab"),qn(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var r=this._map;if(r._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var c=ae(this._map.options.maxBounds);this._offsetLimit=T(this._map.latLngToContainerPoint(c.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(c.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;r.fire("movestart").fire("dragstart"),r.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(r){if(this._map.options.inertia){var c=this._lastTime=+new Date,m=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(m),this._times.push(c),this._prunePositions(c)}this._map.fire("move",r).fire("drag",r)},_prunePositions:function(r){for(;this._positions.length>1&&r-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var r=this._map.getSize().divideBy(2),c=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=c.subtract(r).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(r,c){return r-(r-c)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var r=this._draggable._newPos.subtract(this._draggable._startPos),c=this._offsetLimit;r.x<c.min.x&&(r.x=this._viscousLimit(r.x,c.min.x)),r.y<c.min.y&&(r.y=this._viscousLimit(r.y,c.min.y)),r.x>c.max.x&&(r.x=this._viscousLimit(r.x,c.max.x)),r.y>c.max.y&&(r.y=this._viscousLimit(r.y,c.max.y)),this._draggable._newPos=this._draggable._startPos.add(r)}},_onPreDragWrap:function(){var r=this._worldWidth,c=Math.round(r/2),m=this._initialWorldOffset,E=this._draggable._newPos.x,j=(E-c+m)%r+c-m,pe=(E+c+m)%r-c-m,Ve=Math.abs(j+m)<Math.abs(pe+m)?j:pe;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=Ve},_onDragEnd:function(r){var c=this._map,m=c.options,E=!m.inertia||r.noInertia||this._times.length<2;if(c.fire("dragend",r),E)c.fire("moveend");else{this._prunePositions(+new Date);var j=this._lastPos.subtract(this._positions[0]),pe=(this._lastTime-this._times[0])/1e3,Ve=m.easeLinearity,dt=j.multiplyBy(Ve/pe),bt=dt.distanceTo([0,0]),It=Math.min(m.inertiaMaxSpeed,bt),Jt=dt.multiplyBy(It/bt),cn=It/(m.inertiaDeceleration*Ve),Nn=Jt.multiplyBy(-cn/2).round();!Nn.x&&!Nn.y?c.fire("moveend"):(Nn=c._limitOffset(Nn,c.options.maxBounds),te(function(){c.panBy(Nn,{duration:cn,easeLinearity:Ve,noMoveStart:!0,animate:!0})}))}}});In.addInitHook("addHandler","dragging",Zo),In.mergeOptions({keyboard:!0,keyboardPanDelta:80});var ns=qi.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(r){this._map=r,this._setPanDelta(r.options.keyboardPanDelta),this._setZoomDelta(r.options.zoomDelta)},addHooks:function(){var r=this._map._container;r.tabIndex<=0&&(r.tabIndex="0"),Sn(r,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Un(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var r=document.body,c=document.documentElement,m=r.scrollTop||c.scrollTop,E=r.scrollLeft||c.scrollLeft;this._map._container.focus(),window.scrollTo(E,m)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(r){var c=this._panKeys={},m=this.keyCodes,E,j;for(E=0,j=m.left.length;E<j;E++)c[m.left[E]]=[-1*r,0];for(E=0,j=m.right.length;E<j;E++)c[m.right[E]]=[r,0];for(E=0,j=m.down.length;E<j;E++)c[m.down[E]]=[0,r];for(E=0,j=m.up.length;E<j;E++)c[m.up[E]]=[0,-1*r]},_setZoomDelta:function(r){var c=this._zoomKeys={},m=this.keyCodes,E,j;for(E=0,j=m.zoomIn.length;E<j;E++)c[m.zoomIn[E]]=r;for(E=0,j=m.zoomOut.length;E<j;E++)c[m.zoomOut[E]]=-r},_addHooks:function(){Sn(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Un(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(r){if(!(r.altKey||r.ctrlKey||r.metaKey)){var c=r.keyCode,m=this._map,E;if(c in this._panKeys){if(!m._panAnim||!m._panAnim._inProgress)if(E=this._panKeys[c],r.shiftKey&&(E=oe(E).multiplyBy(3)),m.options.maxBounds&&(E=m._limitOffset(oe(E),m.options.maxBounds)),m.options.worldCopyJump){var j=m.wrapLatLng(m.unproject(m.project(m.getCenter()).add(E)));m.panTo(j)}else m.panBy(E)}else if(c in this._zoomKeys)m.setZoom(m.getZoom()+(r.shiftKey?3:1)*this._zoomKeys[c]);else if(c===27&&m._popup&&m._popup.options.closeOnEscapeKey)m.closePopup();else return;Ur(r)}}});In.addInitHook("addHandler","keyboard",ns),In.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var pr=qi.extend({addHooks:function(){Sn(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Un(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(r){var c=fa(r),m=this._map.options.wheelDebounceTime;this._delta+=c,this._lastMousePos=this._map.mouseEventToContainerPoint(r),this._startTime||(this._startTime=+new Date);var E=Math.max(m-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(u(this._performZoom,this),E),Ur(r)},_performZoom:function(){var r=this._map,c=r.getZoom(),m=this._map.options.zoomSnap||0;r._stop();var E=this._delta/(this._map.options.wheelPxPerZoomLevel*4),j=4*Math.log(2/(1+Math.exp(-Math.abs(E))))/Math.LN2,pe=m?Math.ceil(j/m)*m:j,Ve=r._limitZoom(c+(this._delta>0?pe:-pe))-c;this._delta=0,this._startTime=null,Ve&&(r.options.scrollWheelZoom==="center"?r.setZoom(c+Ve):r.setZoomAround(this._lastMousePos,c+Ve))}});In.addInitHook("addHandler","scrollWheelZoom",pr);var jl=600;In.mergeOptions({tapHold:_t.touchNative&&_t.safari&&_t.mobile,tapTolerance:15});var Pr=qi.extend({addHooks:function(){Sn(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Un(this._map._container,"touchstart",this._onDown,this)},_onDown:function(r){if(clearTimeout(this._holdTimeout),r.touches.length===1){var c=r.touches[0];this._startPos=this._newPos=new Q(c.clientX,c.clientY),this._holdTimeout=setTimeout(u(function(){this._cancel(),this._isTapValid()&&(Sn(document,"touchend",Mi),Sn(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",c))},this),jl),Sn(document,"touchend touchcancel contextmenu",this._cancel,this),Sn(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function r(){Un(document,"touchend",Mi),Un(document,"touchend touchcancel",r)},_cancel:function(){clearTimeout(this._holdTimeout),Un(document,"touchend touchcancel contextmenu",this._cancel,this),Un(document,"touchmove",this._onMove,this)},_onMove:function(r){var c=r.touches[0];this._newPos=new Q(c.clientX,c.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(r,c){var m=new MouseEvent(r,{bubbles:!0,cancelable:!0,view:window,screenX:c.screenX,screenY:c.screenY,clientX:c.clientX,clientY:c.clientY});m._simulated=!0,c.target.dispatchEvent(m)}});In.addInitHook("addHandler","tapHold",Pr),In.mergeOptions({touchZoom:_t.touch,bounceAtZoomLimits:!0});var kr=qi.extend({addHooks:function(){xn(this._map._container,"leaflet-touch-zoom"),Sn(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){qn(this._map._container,"leaflet-touch-zoom"),Un(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(r){var c=this._map;if(!(!r.touches||r.touches.length!==2||c._animatingZoom||this._zooming)){var m=c.mouseEventToContainerPoint(r.touches[0]),E=c.mouseEventToContainerPoint(r.touches[1]);this._centerPoint=c.getSize()._divideBy(2),this._startLatLng=c.containerPointToLatLng(this._centerPoint),c.options.touchZoom!=="center"&&(this._pinchStartLatLng=c.containerPointToLatLng(m.add(E)._divideBy(2))),this._startDist=m.distanceTo(E),this._startZoom=c.getZoom(),this._moved=!1,this._zooming=!0,c._stop(),Sn(document,"touchmove",this._onTouchMove,this),Sn(document,"touchend touchcancel",this._onTouchEnd,this),Mi(r)}},_onTouchMove:function(r){if(!(!r.touches||r.touches.length!==2||!this._zooming)){var c=this._map,m=c.mouseEventToContainerPoint(r.touches[0]),E=c.mouseEventToContainerPoint(r.touches[1]),j=m.distanceTo(E)/this._startDist;if(this._zoom=c.getScaleZoom(j,this._startZoom),!c.options.bounceAtZoomLimits&&(this._zoom<c.getMinZoom()&&j<1||this._zoom>c.getMaxZoom()&&j>1)&&(this._zoom=c._limitZoom(this._zoom)),c.options.touchZoom==="center"){if(this._center=this._startLatLng,j===1)return}else{var pe=m._add(E)._divideBy(2)._subtract(this._centerPoint);if(j===1&&pe.x===0&&pe.y===0)return;this._center=c.unproject(c.project(this._pinchStartLatLng,this._zoom).subtract(pe),this._zoom)}this._moved||(c._moveStart(!0,!1),this._moved=!0),J(this._animRequest);var Ve=u(c._move,c,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=te(Ve,this,!0),Mi(r)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,J(this._animRequest),Un(document,"touchmove",this._onTouchMove,this),Un(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});In.addInitHook("addHandler","touchZoom",kr),In.BoxZoom=_n,In.DoubleClickZoom=hl,In.Drag=Zo,In.Keyboard=ns,In.ScrollWheelZoom=pr,In.TapHold=Pr,In.TouchZoom=kr,n.Bounds=me,n.Browser=_t,n.CRS=U,n.Canvas=_s,n.Circle=hr,n.CircleMarker=Lr,n.Class=he,n.Control=dn,n.DivIcon=Co,n.DivOverlay=fr,n.DomEvent=$o,n.DomUtil=Pn,n.Draggable=Jr,n.Evented=G,n.FeatureGroup=xr,n.GeoJSON=Xr,n.GridLayer=oo,n.Handler=qi,n.Icon=vs,n.ImageOverlay=Is,n.LatLng=q,n.LatLngBounds=ne,n.Layer=oi,n.LayerGroup=wr,n.LineUtil=Fn,n.Map=In,n.Marker=ji,n.Mixin=al,n.Path=Ar,n.Point=Q,n.PolyUtil=ya,n.Polygon=Gi,n.Polyline=qr,n.Popup=Br,n.PosAnimation=Fa,n.Projection=ei,n.Rectangle=Tr,n.Renderer=ai,n.SVG=Hi,n.SVGOverlay=Ga,n.TileLayer=tr,n.Tooltip=Fs,n.Transformation=ue,n.Util=Ee,n.VideoOverlay=dr,n.bind=u,n.bounds=T,n.canvas=ko,n.circle=io,n.circleMarker=ba,n.control=br,n.divIcon=Po,n.extend=o,n.featureGroup=qa,n.geoJSON=es,n.geoJson=Si,n.gridLayer=ts,n.icon=Va,n.imageOverlay=Cr,n.latLng=R,n.latLngBounds=ae,n.layerGroup=ll,n.map=ja,n.marker=_a,n.point=oe,n.polygon=Rs,n.polyline=ul,n.popup=Lo,n.rectangle=Nr,n.setOptions=z,n.stamp=f,n.svg=li,n.svgOverlay=Ha,n.tileLayer=ri,n.tooltip=wa,n.transformation=V,n.version=i,n.videoOverlay=Wo;var zs=window.L;n.noConflict=function(){return window.L=zs,this},window.L=n})})(Pf,Pf.exports);var Zi=Pf.exports;const Ke=A1(Zi);var Y0={exports:{}};(function(e,t){(function(n,i){i(t)})(To,function(n){var i=typeof window<"u"?window:typeof To<"u"?To:typeof self<"u"?self:{};function o(v,_){return v(_={exports:{}},_.exports),_.exports}var a=o(function(v,_){(function(x){const k={escape:function(P){return P.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1")},parseExtension:w,mimeType:function(P){return P=w(P).toLowerCase(),function(){var F="application/font-woff",G="image/jpeg";return{woff:F,woff2:F,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:G,jpeg:G,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml"}}()[P]||""},dataAsUrl:function(P,F){return`data:${F};base64,`+P},isDataUrl:function(P){return P.search(/^(data:)/)!==-1},canvasToBlob:function(P){return P.toBlob?new Promise(function(G){P.toBlob(G)}):(F=P,new Promise(function(G){const Q=Pe(F.toDataURL().split(",")[1]);var Ae=Q.length;const oe=new Uint8Array(Ae);for(let me=0;me<Ae;me++)oe[me]=Q.charCodeAt(me);G(new Blob([oe],{type:"image/png"}))}));var F},resolveUrl:function(P,F){const G=document.implementation.createHTMLDocument(),Q=G.createElement("base"),Ae=(G.head.appendChild(Q),G.createElement("a"));return G.body.appendChild(Ae),Q.href=F,Ae.href=P,Ae.href},getAndEncode:function(P){let F=Ne.impl.urlCache.find(function(G){return G.url===P});return F||(F={url:P,promise:null},Ne.impl.urlCache.push(F)),F.promise===null&&(Ne.impl.options.cacheBust&&(P+=(/\?/.test(P)?"&":"?")+new Date().getTime()),F.promise=new Promise(function(G){const Q=Ne.impl.options.httpTimeout,Ae=new XMLHttpRequest;let oe;var me;function T(ne){console.error(ne),G("")}Ae.onreadystatechange=function(){if(Ae.readyState===4)if(Ae.status!==200)oe?G(oe):T(`cannot fetch resource: ${P}, status: `+Ae.status);else{const ne=new FileReader;ne.onloadend=function(){var ae=ne.result.split(/,/)[1];G(ae)},ne.readAsDataURL(Ae.response)}},Ae.ontimeout=function(){oe?G(oe):T(`timeout of ${Q}ms occured while fetching resource: `+P)},Ae.responseType="blob",Ae.timeout=Q,Ne.impl.options.useCredentials&&(Ae.withCredentials=!0),Ae.open("GET",P,!0),Ae.send(),Ne.impl.options.imagePlaceholder&&(me=Ne.impl.options.imagePlaceholder.split(/,/))&&me[1]&&(oe=me[1])})),F.promise},uid:function(){let P=0;return function(){return"u"+("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4)+P++}}(),delay:function(P){return function(F){return new Promise(function(G){setTimeout(function(){G(F)},P)})}},asArray:function(P){const F=[],G=P.length;for(let Q=0;Q<G;Q++)F.push(P[Q]);return F},escapeXhtml:function(P){return P.replace(/%/g,"%25").replace(/#/g,"%23").replace(/\n/g,"%0A")},makeImage:function(P){return P!=="data:,"?new Promise(function(F,G){const Q=new Image;Ne.impl.options.useCredentials&&(Q.crossOrigin="use-credentials"),Q.onload=function(){F(Q)},Q.onerror=G,Q.src=P}):Promise.resolve()},width:function(P){var F=N(P,"border-left-width"),G=N(P,"border-right-width");return P.scrollWidth+F+G},height:function(P){var F=N(P,"border-top-width"),G=N(P,"border-bottom-width");return P.scrollHeight+F+G}};function w(P){return(P=/\.([^\.\/]*?)(\?|$)/g.exec(P))?P[1]:""}function N(P,F){const G=$e(P).getPropertyValue(F);return parseFloat(G.replace("px",""))}const z=function(){const P=/url\(['"]?([^'"]+?)['"]?\)/g;return{inlineAll:function(Ae,oe,me){return F(Ae)?Promise.resolve(Ae).then(G).then(function(T){let ne=Promise.resolve(Ae);return T.forEach(function(ae){ne=ne.then(function(q){return Q(q,ae,oe,me)})}),ne}):Promise.resolve(Ae)},shouldProcess:F,impl:{readUrls:G,inline:Q}};function F(Ae){return Ae.search(P)!==-1}function G(Ae){const oe=[];for(var me;(me=P.exec(Ae))!==null;)oe.push(me[1]);return oe.filter(function(T){return!k.isDataUrl(T)})}function Q(Ae,oe,me,T){return Promise.resolve(oe).then(function(ne){return me?k.resolveUrl(ne,me):ne}).then(T||k.getAndEncode).then(function(ne){return k.dataAsUrl(ne,k.mimeType(oe))}).then(function(ne){return Ae.replace((ae=oe,new RegExp(`(url\\(['"]?)(${k.escape(ae)})(['"]?\\))`,"g")),`$1${ne}$3`);var ae})}}(),W={resolveAll:function(){return O().then(function(P){return Promise.all(P.map(function(F){return F.resolve()}))}).then(function(P){return P.join(`
`)})},impl:{readAll:O}};function O(){return Promise.resolve(k.asArray(document.styleSheets)).then(function(F){const G=[];return F.forEach(function(Q){if(Object.getPrototypeOf(Q).hasOwnProperty("cssRules"))try{k.asArray(Q.cssRules||[]).forEach(G.push.bind(G))}catch(Ae){console.log("Error while reading CSS rules from "+Q.href,Ae.toString())}}),G}).then(function(F){return F.filter(function(G){return G.type===CSSRule.FONT_FACE_RULE}).filter(function(G){return z.shouldProcess(G.style.getPropertyValue("src"))})}).then(function(F){return F.map(P)});function P(F){return{resolve:function(){var G=(F.parentStyleSheet||{}).href;return z.inlineAll(F.cssText,G)},src:function(){return F.style.getPropertyValue("src")}}}}const Z={inlineAll:function P(F){return F instanceof Element?function(G){const Q=G.style.getPropertyValue("background");return Q?z.inlineAll(Q).then(function(Ae){G.style.setProperty("background",Ae,Q)}).then(function(){return G}):Promise.resolve(G)}(F).then(function(){return F instanceof HTMLImageElement?se(F).inline():Promise.all(k.asArray(F.childNodes).map(function(G){return P(G)}))}):Promise.resolve(F)},impl:{newImage:se}};function se(P){return{inline:function(F){return k.isDataUrl(P.src)?Promise.resolve():Promise.resolve(P.src).then(F||k.getAndEncode).then(function(G){return k.dataAsUrl(G,k.mimeType(P.src))}).then(function(G){return new Promise(function(Q){P.onload=Q,P.onerror=Q,P.src=G})})}}}const Se={imagePlaceholder:void 0,cacheBust:!1,useCredentials:!1},Ne={toSvg:xe,toPng:function(P,F){return(F=F||{}).raster=!0,Be(P,F).then(function(G){return G.toDataURL()})},toJpeg:function(P,F){return(F=F||{}).raster=!0,Be(P,F).then(function(G){return G.toDataURL("image/jpeg",F.quality||1)})},toBlob:function(P,F){return(F=F||{}).raster=!0,Be(P,F).then(k.canvasToBlob)},toPixelData:function(P,F){return(F=F||{}).raster=!0,Be(P,F).then(function(G){return G.getContext("2d").getImageData(0,0,k.width(P),k.height(P)).data})},toCanvas:function(P,F){return(F=F||{}).raster=!0,Be(P,F||{})},impl:{fontFaces:W,images:Z,util:k,inliner:z,urlCache:[],options:{}}},$e=(v.exports=Ne,x.getComputedStyle||window.getComputedStyle),Pe=x.atob||window.atob;function xe(P,F){var G=F=F||{};return G.imagePlaceholder===void 0?Ne.impl.options.imagePlaceholder=Se.imagePlaceholder:Ne.impl.options.imagePlaceholder=G.imagePlaceholder,G.cacheBust===void 0?Ne.impl.options.cacheBust=Se.cacheBust:Ne.impl.options.cacheBust=G.cacheBust,G.useCredentials===void 0?Ne.impl.options.useCredentials=Se.useCredentials:Ne.impl.options.useCredentials=G.useCredentials,Promise.resolve(P).then(function(Q){return function Ae(oe,me,T,ne,ae=null){return T||!me||me(oe)?Promise.resolve(oe).then(function(q){return q instanceof HTMLCanvasElement?k.makeImage(q.toDataURL()):q.nodeName==="IFRAME"?html2canvas(q.contentDocument.body).then(R=>R.toDataURL()).then(k.makeImage):q.cloneNode(!1)}).then(function(q){return function(R,U){const H=R.childNodes;return H.length===0?Promise.resolve(U):function($,ce){const ue=$e(R);let V=Promise.resolve();return ce.forEach(function(K){V=V.then(function(){return Ae(K,me,!1,ne,ue)}).then(function(ye){ye&&$.appendChild(ye)})}),V}(U,k.asArray(H)).then(function(){return U})}(oe,q)}).then(function(q){return function(R,U,H){return U instanceof Element?Promise.resolve().then(function(){(function($,ce){const ue=$e($);ue.cssText?(ce.style.cssText=ue.cssText,function(V,K){K.font=V.font,K.fontFamily=V.fontFamily,K.fontFeatureSettings=V.fontFeatureSettings,K.fontKerning=V.fontKerning,K.fontSize=V.fontSize,K.fontStretch=V.fontStretch,K.fontStyle=V.fontStyle,K.fontVariant=V.fontVariant,K.fontVariantCaps=V.fontVariantCaps,K.fontVariantEastAsian=V.fontVariantEastAsian,K.fontVariantLigatures=V.fontVariantLigatures,K.fontVariantNumeric=V.fontVariantNumeric,K.fontVariationSettings=V.fontVariationSettings,K.fontWeight=V.fontWeight}(ue,ce.style)):(H?function(V,K,ye,ve){const ee=ye.style,Ge=V.style;for(var tt of K){var Ue=K.getPropertyValue(tt),nt=Ge.getPropertyValue(tt),st=(Ge.setProperty(tt,ve?"initial":"unset"),K.getPropertyValue(tt));st!==Ue?ee.setProperty(tt,Ue):ee.removeProperty(tt),Ge.setProperty(tt,nt)}}($,ue,ce,T):function(V,K,ye){const ve=function(Ge){if(he[Ge])return he[Ge];Ee||((Ee=document.createElement("iframe")).style.visibility="hidden",Ee.style.position="fixed",document.body.appendChild(Ee),Ee.contentWindow.document.write('<!DOCTYPE html><meta charset="UTF-8"><title>sandbox</title><body>'));const tt=document.createElement(Ge),Ue=(Ee.contentWindow.document.body.appendChild(tt),tt.textContent=".",Ee.contentWindow.getComputedStyle(tt)),nt={};return k.asArray(Ue).forEach(function(st){nt[st]=st==="width"||st==="height"?"auto":Ue.getPropertyValue(st)}),Ee.contentWindow.document.body.removeChild(tt),he[Ge]=nt}(ye.tagName),ee=ye.style;k.asArray(V).forEach(function(Ge){var tt=V.getPropertyValue(Ge);(tt!==ve[Ge]||K&&tt!==K.getPropertyValue(Ge))&&ee.setProperty(Ge,tt,V.getPropertyPriority(Ge))})}(ue,ae,ce),T&&(["inset-block","inset-block-start","inset-block-end"].forEach(V=>ce.style.removeProperty(V)),["left","right","top","bottom"].forEach(V=>{ce.style.getPropertyValue(V)&&ce.style.setProperty(V,"0px")})))})(R,U)}).then(function(){[":before",":after"].forEach(function($){(function(ce){const ue=$e(R,ce),V=ue.getPropertyValue("content");if(V!==""&&V!=="none"){const K=k.uid(),ye=U.getAttribute("class"),ve=(ye&&U.setAttribute("class",ye+" "+K),document.createElement("style"));ve.appendChild(function(){const ee=`.${K}:`+ce,Ge=(ue.cssText?function(){return`${ue.cssText} content: ${ue.getPropertyValue("content")};`}:function(){return k.asArray(ue).map(function(tt){return tt+": "+ue.getPropertyValue(tt)+(ue.getPropertyPriority(tt)?" !important":"")}).join("; ")+";"})();return document.createTextNode(ee+`{${Ge}}`)}()),U.appendChild(ve)}})($)})}).then(function(){R instanceof HTMLTextAreaElement&&(U.innerHTML=R.value),R instanceof HTMLInputElement&&U.setAttribute("value",R.value)}).then(function(){U instanceof SVGElement&&(U.setAttribute("xmlns","http://www.w3.org/2000/svg"),U instanceof SVGRectElement&&["width","height"].forEach(function($){const ce=U.getAttribute($);ce&&U.style.setProperty($,ce)}))}).then(function(){return U}):U}(oe,q,ne)}):Promise.resolve()}(Q,F.filter,!0,!F.raster)}).then(ze).then(te).then(function(Q){F.bgcolor&&(Q.style.backgroundColor=F.bgcolor),F.width&&(Q.style.width=F.width+"px"),F.height&&(Q.style.height=F.height+"px"),F.style&&Object.keys(F.style).forEach(function(oe){Q.style[oe]=F.style[oe]});let Ae=null;return typeof F.onclone=="function"&&(Ae=F.onclone(Q)),Promise.resolve(Ae).then(function(){return Q})}).then(function(Q){return Q=Q,Ae=F.width||k.width(P),oe=F.height||k.height(P),Promise.resolve(Q).then(function(me){return me.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),new XMLSerializer().serializeToString(me)}).then(k.escapeXhtml).then(function(me){return`<foreignObject x="0" y="0" width="100%" height="100%">${me}</foreignObject>`}).then(function(me){return`<svg xmlns="http://www.w3.org/2000/svg" width="${Ae}" height="${oe}">${me}</svg>`}).then(function(me){return"data:image/svg+xml;charset=utf-8,"+me});var Ae,oe}).then(function(Q){return Ne.impl.urlCache=[],Q})}function Be(P,F){return xe(P,F).then(k.makeImage).then(k.delay(0)).then(function(G){var Q=typeof F.scale!="number"?1:F.scale;const Ae=function(me,T){const ne=document.createElement("canvas");if(ne.width=(F.width||k.width(me))*T,ne.height=(F.height||k.height(me))*T,F.bgcolor){const ae=ne.getContext("2d");ae.fillStyle=F.bgcolor,ae.fillRect(0,0,ne.width,ne.height)}return ne}(P,Q),oe=Ae.getContext("2d");return oe.mozImageSmoothingEnabled=!1,oe.msImageSmoothingEnabled=!1,oe.imageSmoothingEnabled=!1,G&&(oe.scale(Q,Q),oe.drawImage(G,0,0)),Ee&&(document.body.removeChild(Ee),Ee=null,J&&clearTimeout(J),J=setTimeout(()=>{J=null,he={}},2e4)),Ae})}function ze(P){return W.resolveAll().then(function(F){const G=document.createElement("style");return P.appendChild(G),G.appendChild(document.createTextNode(F)),P})}function te(P){return Z.inlineAll(P).then(function(){return P})}let J=null,Ee=null,he={}})(i)}),u=o(function(v,_){(function(){function x(W,O,Z){var se=new XMLHttpRequest;se.open("GET",W),se.responseType="blob",se.onload=function(){z(se.response,O,Z)},se.onerror=function(){console.error("could not download file")},se.send()}function k(W){var O=new XMLHttpRequest;O.open("HEAD",W,!1);try{O.send()}catch{}return 200<=O.status&&299>=O.status}function w(W){try{W.dispatchEvent(new MouseEvent("click"))}catch{var O=document.createEvent("MouseEvents");O.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),W.dispatchEvent(O)}}var N=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof i=="object"&&i.global===i?i:void 0,z=N.saveAs||(typeof window!="object"||window!==N?function(){}:"download"in HTMLAnchorElement.prototype?function(W,O,Z){var se=N.URL||N.webkitURL,Se=document.createElement("a");O=O||W.name||"download",Se.download=O,Se.rel="noopener",typeof W=="string"?(Se.href=W,Se.origin===location.origin?w(Se):k(Se.href)?x(W,O,Z):w(Se,Se.target="_blank")):(Se.href=se.createObjectURL(W),setTimeout(function(){se.revokeObjectURL(Se.href)},4e4),setTimeout(function(){w(Se)},0))}:"msSaveOrOpenBlob"in navigator?function(W,O,Z){if(O=O||W.name||"download",typeof W!="string")navigator.msSaveOrOpenBlob(function(Se,Ne){return Ne===void 0?Ne={autoBom:!1}:typeof Ne!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),Ne={autoBom:!Ne}),Ne.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(Se.type)?new Blob(["\uFEFF",Se],{type:Se.type}):Se}(W,Z),O);else if(k(W))x(W,O,Z);else{var se=document.createElement("a");se.href=W,se.target="_blank",setTimeout(function(){w(se)})}}:function(W,O,Z,se){if((se=se||open("","_blank"))&&(se.document.title=se.document.body.innerText="downloading..."),typeof W=="string")return x(W,O,Z);var Se=W.type==="application/octet-stream",Ne=/constructor/i.test(N.HTMLElement)||N.safari,$e=/CriOS\/[\d]+/.test(navigator.userAgent);if(($e||Se&&Ne)&&typeof FileReader=="object"){var Pe=new FileReader;Pe.onloadend=function(){var ze=Pe.result;ze=$e?ze:ze.replace(/^data:[^;]*;/,"data:attachment/file;"),se?se.location.href=ze:location=ze,se=null},Pe.readAsDataURL(W)}else{var xe=N.URL||N.webkitURL,Be=xe.createObjectURL(W);se?se.location=Be:location.href=Be,se=null,setTimeout(function(){xe.revokeObjectURL(Be)},4e4)}});N.saveAs=z.saveAs=z,v.exports=z})()}),d=L.Control.extend({options:{cropImageByInnerWH:!0,hidden:!1,domtoimageOptions:{},position:"topleft",screenName:"screen",iconUrl:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/PjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0iQ2FwYV8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB4PSIwcHgiIHk9IjBweCIgdmlld0JveD0iMCAwIDMyIDMyIiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCAzMiAzMjsiIHhtbDpzcGFjZT0icHJlc2VydmUiPjxnPjxnIGlkPSJjYW1lcmEiPjxwYXRoIHN0eWxlPSJmaWxsOiMwMTAwMDI7IiBkPSJNMTYsOS41MDFjLTQuNDE5LDAtOCwzLjU4MS04LDhjMCw0LjQxOCwzLjU4MSw4LDgsOGM0LjQxOCwwLDgtMy41ODIsOC04UzIwLjQxOCw5LjUwMSwxNiw5LjUwMXogTTIwLjU1NSwyMS40MDZjLTIuMTU2LDIuNTE2LTUuOTQzLDIuODA3LTguNDU5LDAuNjVjLTIuNTE3LTIuMTU2LTIuODA3LTUuOTQ0LTAuNjUtOC40NTljMi4xNTUtMi41MTcsNS45NDMtMi44MDcsOC40NTktMC42NUMyMi40MiwxNS4xMDIsMjIuNzExLDE4Ljg5MSwyMC41NTUsMjEuNDA2eiIvPjxwYXRoIHN0eWxlPSJmaWxsOiMwMTAwMDI7IiBkPSJNMTYsMTMuNTAxYy0yLjIwOSwwLTMuOTk5LDEuNzkxLTQsMy45OTl2MC4wMDJjMCwwLjI3NSwwLjIyNCwwLjUsMC41LDAuNXMwLjUtMC4yMjUsMC41LTAuNVYxNy41YzAuMDAxLTEuNjU2LDEuMzQzLTIuOTk5LDMtMi45OTljMC4yNzYsMCwwLjUtMC4yMjQsMC41LTAuNVMxNi4yNzYsMTMuNTAxLDE2LDEzLjUwMXoiLz48cGF0aCBzdHlsZT0iZmlsbDojMDEwMDAyOyIgZD0iTTI5LjQ5Miw4LjU0MmwtNC4zMzQtMC43MjNsLTEuMzczLTMuNDM0QzIzLjMyNiwzLjI0LDIyLjIzMiwyLjUsMjEsMi41SDExYy0xLjIzMiwwLTIuMzI2LDAuNzQtMi43ODYsMS44ODZMNi44NDIsNy44MTlMMi41MDksOC41NDJDMS4wNTUsOC43ODMsMCwxMC4wMjcsMCwxMS41djE1YzAsMS42NTQsMS4zNDYsMywzLDNoMjZjMS42NTQsMCwzLTEuMzQ2LDMtM3YtMTVDMzIsMTAuMDI3LDMwLjk0NSw4Ljc4MywyOS40OTIsOC41NDJ6IE0zMCwyNi41YzAsMC41NTMtMC40NDcsMS0xLDFIM2MtMC41NTMsMC0xLTAuNDQ3LTEtMXYtMTVjMC0wLjQ4OSwwLjM1NC0wLjkwNiwwLjgzNi0wLjk4Nkw4LjI4LDkuNjA3bDEuNzkxLTQuNDc4QzEwLjIyNCw0Ljc1LDEwLjU5MSw0LjUsMTEsNC41aDEwYzAuNDA4LDAsMC43NzUsMC4yNDksMC45MjgsMC42MjlsMS43OTEsNC40NzhsNS40NDUsMC45MDdDMjkuNjQ2LDEwLjU5NCwzMCwxMS4wMTEsMzAsMTEuNVYyNi41eiIvPjwvZz48L2c+PGc+PC9nPjxnPjwvZz48Zz48L2c+PGc+PC9nPjxnPjwvZz48Zz48L2c+PGc+PC9nPjxnPjwvZz48Zz48L2c+PGc+PC9nPjxnPjwvZz48Zz48L2c+PGc+PC9nPjxnPjwvZz48Zz48L2c+PC9zdmc+",hideElementsWithSelectors:[".leaflet-control-container"],onCropBorderSize:2,caption:null,captionFontSize:15,captionFont:"Arial",captionColor:"black",captionBgColor:"white",captionOffset:5,mimeType:"image/png",debugMode:!1,preventDownload:!1,onPixelDataFail:function(v){var _=v.node,x=v.error;return console.warn("Map node is very big "+_.scrollWidth+"x"+_.scrollHeight),console.warn(`Add function: SimpleMapScreenshoter({
              onPixelDataFail: function({ node, plugin, error, mapPane, domtoimageOptions }) {
                 // Solutions:
                 // decrease size of map
                 // or decrease zoom level
                 // or remove elements with big distanses
                 // and after that return image in Promise - plugin._getPixelDataOfNormalMap
                 return plugin._getPixelDataOfNormalMap(domtoimageOptions)
              }
            })`),Promise.reject(x)}},onAdd:function(){return this._container=L.DomUtil.create("div","leaflet-control-simpleMapScreenshoter"),this._link=null,this._screenState={status:1,promise:null},this.options.hidden===!1&&this._addScreenBtn(),this._onUserStartInteractWithMap=this._onUserStartInteractWithMap.bind(this),this._onUserEndInteractWithMap=this._onUserEndInteractWithMap.bind(this),this._map.on("zoomstart",this._onUserStartInteractWithMap),this._map.on("move",this._onUserStartInteractWithMap),this._map.on("zoomend",this._onUserEndInteractWithMap),this._map.on("moveend",this._onUserEndInteractWithMap),this._container},takeScreen:function(){var v=this,_=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"blob",x=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},k={};for(var w in this.options)x.hasOwnProperty(w)?k[w]=x[w]:k[w]=this.options[w];return this._screenState.status===2?this._screenState.promise:(this._map.fire("simpleMapScreenshoter.takeScreen"),this._screenState.status=2,this._setElementsVisible(!1),this._screenState.promise=this._waitEndOfInteractions().then(function(){return v._getPixelData(k)}).then(function(N){return v._setElementsVisible(!0),v._toCanvas(N,k)}).then(function(N){return _==="image"?v._canvasToImage(N,k):_==="canvas"?N:v._canvasToBlob(N,k)}).then(function(N){return v._screenState.status=1,v._map.fire("simpleMapScreenshoter.done"),N}).catch(function(N){return v._setElementsVisible(!0),v._screenState.status=1,v._map.fire("simpleMapScreenshoter.error",{e:N}),Promise.reject(N)}),this._screenState.promise)},_setElementsVisible:function(){var v=this,_=arguments.length>0&&arguments[0]!==void 0&&arguments[0];this.options.hideElementsWithSelectors.forEach(function(x){var k=v._map._container.querySelectorAll(x),w=!0,N=!1,z=void 0;try{for(var W,O=k[Symbol.iterator]();!(w=(W=O.next()).done);w=!0)W.value.style.opacity=_===!1?0:1}catch(Z){N=!0,z=Z}finally{try{!w&&O.return&&O.return()}finally{if(N)throw z}}})},_canvasToImage:function(v,_){var x=_.mimeType,k=v.toDataURL(x);return k.indexOf("base64")===-1?Promise.reject(new Error("Base64 image generation error")):Promise.resolve(k)},_canvasToBlob:function(v,_){var x=_.mimeType;return new Promise(function(k,w){v.toBlob(function(N){k(N)},x)})},_toCanvas:function(v,_){var x=_.captionOffset,k=_.caption,w=_.captionFontSize,N=_.captionFont,z=_.captionColor,W=_.captionBgColor,O=this._node,Z=O.screenHeight,se=O.screenWidth,Se=document.createElement("canvas");Se.width=se,Se.height=Z;for(var Ne=Se.getContext("2d"),$e=Ne.createImageData(se,Z),Pe=0;Pe<v.length;++Pe)$e.data[Pe]=v[Pe];Ne.putImageData($e,0,0),$e=null;var xe=document.createElement("canvas"),Be=xe.getContext("2d"),ze=0,te=0,J=Z,Ee=se;if(this.options.cropImageByInnerWH===!0){for(var he=[],P=0,F=0;F<Z;++F){P=0;for(var G=0;G<se;++G)v[4*F*se+4*G+4]===0&&P++;P===se&&he.push(F)}var Q=this._getMinAndMaxOnValuesBreak(he);ze=Q.min;for(var Ae=se,oe=Q.max,me=[],T=0,ne=te;ne<Ae;++ne){T=0;for(var ae=0;ae<Z;++ae)v[4*ae*se+4*ne+4]===0&&T++;T===Z&&me.push(ne)}var q=this._getMinAndMaxOnValuesBreak(me);te=q.min,Ae=q.max,(te===0&&Ae===0||Ae===null)&&(Ae=se),(ze===0&&oe===0||oe===null)&&(oe=Z),this.options.debugMode===!0&&(console.log("emptyYLine",he),console.log("minMaxY",Q),console.log("emptyXLine",me),console.log("minMaxX",q),console.log("debugX",{}),console.log("debugY",{})),ze===0&&oe===Z&&te===0&&Ae===se||(ze+=this.options.onCropBorderSize,oe-=this.options.onCropBorderSize,te+=this.options.onCropBorderSize,Ae-=this.options.onCropBorderSize),J=oe-ze,Ee=Ae-te,xe.width=Ee,xe.height=J}else xe.width=Ee,xe.height=J;var R=null;return k&&(R=typeof k=="function"?k.call(this):k),R!==null&&(xe.height=xe.height+(x+w+x),Be.beginPath(),Be.rect(0,0,xe.width,xe.height),Be.fillStyle=W,Be.fill(),Be.save()),Be.drawImage(Se,te,ze,Ee,J,0,0,Ee,J),R!==null&&(Be.font=w+"px "+N,Be.fillStyle=z,Be.fillText(R,x,J+x+w)),Promise.resolve(xe)},_getMinAndMaxOnValuesBreak:function(v){for(var _=0,x=0,k=!1,w=1;w<v.length;w++){if(v[w]-1!==v[w-1]){x=v[w],k=!0;break}_=v[w]}return k===!1&&v[0]>1?(_=0,x=v[0]):k===!1&&(_=v[v.length-1]||0,x=null),{min:_,max:x}},_getPixelData:function(v){var _=this,x=v.domtoimageOptions,k=x===void 0?{}:x;return this._getPixelDataOfNormalMap(k).catch(function(w){return console.warn("May be map size very big on that zoom level, we have error:",w.toString()),console.warn("You can manually hide map elements with large distances between them for fix that warn"),_._getPixelDataOfBigMap(k)})},_getPixelDataOfNormalMap:function(){var v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},_=this._map.getContainer();return this._node={node:_,screenHeight:_.scrollHeight,screenWidth:_.scrollWidth},a.toPixelData(_,v)},_getPixelDataOfBigMap:function(){var v=this,_=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},x=this._map.getContainer(),k=this._map.getPane("mapPane");k.style.width=2*x.clientWidth+"px",k.style.height=2*x.clientHeight+"px",k.style.overflow="hidden";var w=function(){k.style.width="initial",k.style.height="initial",k.style.overflow="initial"};return this._node={node:x,screenHeight:x.scrollHeight,screenWidth:x.scrollWidth},a.toPixelData(x,_).then(function(N){return w(),N}).catch(function(N){return w(),x.scrollHeight>=4e3||x.scrollWidth>=4e3?v.options.onPixelDataFail({plugin:v,node:x,mapPane:k,error:N,domtoimageOptions:_}):Promise.reject(N)})},_addScreenBtn:function(){this._link=L.DomUtil.create("a","leaflet-control-simpleMapScreenshoter-btn",this._container),this._addCss(),L.DomEvent.addListener(this._link,"click",this._onScreenBtn,this),L.DomEvent.disableClickPropagation(this._link)},_addCss:function(){var v=`
    .leaflet-control-simpleMapScreenshoter{
       border: 2px solid rgba(0,0,0,0.2);
       background-clip: padding-box;
    }
    .leaflet-control-simpleMapScreenshoter a{
       background-color: #fff;
       border-bottom: 1px solid #ccc;
       width: 30px;
       height: 30px;
       line-height: 30px;
       display: block;
       text-align: center;
       text-decoration: none;
       color: black;
       overflow: hidden;
       border-radius: 2px;
       background-image: url('`+this.options.iconUrl+`');
       background-position: 46% 41%;
       background-repeat: no-repeat;
       background-size: 63%;
    }
    .leaflet-control-simpleMapScreenshoter a:hover{
       cursor: pointer;
    }
    `,_=document.head||document.getElementsByTagName("head")[0],x=document.createElement("style");x.appendChild(document.createTextNode(v)),_.appendChild(x)},_onScreenBtn:function(){var v=this;this._map.fire("simpleMapScreenshoter.click"),this.options.preventDownload||this.takeScreen().then(function(_){var x=typeof v.options.screenName=="function"?v.options.screenName.call(v):v.options.screenName;u.saveAs(_,x+".png")}).catch(function(_){v._map.fire("simpleMapScreenshoter.error",{e:_})})},_onUserStartInteractWithMap:function(){this._interaction=!0},_onUserEndInteractWithMap:function(){this._interaction=!1},_waitEndOfInteractions:function(){var v=this;return new Promise(function(_){var x=setInterval(function(){v._interaction||(_(),clearInterval(x))},100)})}}),f=(L.Control.SimpleMapScreenshoter=d,L.simpleMapScreenshoter=function(v){return new L.Control.SimpleMapScreenshoter(v)},d);n.default=f,n.SimpleMapScreenshoter=d,Object.defineProperty(n,"__esModule",{value:!0})})})(Y0,Y0.exports);const Mw={class:"h-full flex flex-col bg-white overflow-y-auto"},Bw={class:"p-3 border-b border-gray-200"},Tw={class:"grid grid-cols-4 gap-1"},Nw=["onClick","title"],Dw=["innerHTML"],Rw={key:0,class:"flex-1 overflow-y-auto"},Ow={class:"p-3 border-b border-gray-200"},Iw={class:"p-3"},Fw={class:"grid grid-cols-6 gap-2 mb-4"},jw=["onClick","title"],zw={key:0,class:"space-y-4"},Uw={class:"flex items-center gap-4"},$w={class:"flex items-center gap-2"},qw={class:"flex items-center gap-4"},Vw=["value"],Gw={key:0,class:"flex items-center gap-4"},Hw={class:"flex items-center gap-2"},Ww={key:1,class:"space-y-4"},Zw={class:"flex items-center gap-4"},Kw={class:"flex items-center gap-2"},Yw={class:"flex items-center gap-4"},Jw={class:"flex items-center gap-2"},Xw={class:"flex items-center gap-4"},Qw={class:"flex items-center gap-2"},ex={class:"flex items-center gap-4"},tx={class:"flex items-center gap-2"},nx={class:"flex items-center gap-4"},ix={class:"flex items-center gap-2"},rx=["onClick","title"],sx=["innerHTML"],ox={key:1,class:"p-3 border-t border-gray-200"},ax={class:"mt-3"},lx={key:0},ux={class:"grid grid-cols-2 gap-4"},cx={class:"text-sm font-medium text-gray-500"},hx={class:"text-sm font-medium text-gray-500"},dx={class:"text-sm font-medium text-gray-500"},fx={class:"text-sm font-medium text-gray-500"},px={class:"text-sm font-medium text-gray-500"},gx={class:"text-sm font-medium text-gray-500"},mx={class:"text-sm font-medium text-gray-500"},vx={class:"text-sm font-medium text-gray-500"},yx={class:"text-sm font-medium text-gray-500"},_x={class:"text-sm font-medium text-gray-500"},bx={class:"text-sm font-medium text-gray-500"},wx={class:"text-sm font-medium text-gray-500"},xx={class:"text-sm font-medium text-gray-500"},Lx={class:"text-sm font-medium text-gray-500"},Cx={class:"text-sm font-medium text-gray-500"},Px={class:"text-sm font-medium text-gray-500"},kx={key:1,class:"text-center text-sm text-gray-500"},Sx={key:2,class:"p-3 border-t border-gray-200"},Ex={class:"mt-3"},Ax={class:"mb-4"},Mx={class:"grid grid-cols-2 gap-2"},Bx={class:"grid grid-cols-2 gap-2"},Tx=Hs({__name:"DrawingTools",props:{currentTool:{},selectedShape:{}},emits:["tool-change","style-update","delete-shape"],setup(e,{emit:t}){const n=e,i=t,o=Dt(null),a=Dt("Double-cliquez pour diter"),u=Dt("#3B82F6"),d=Dt(.2),f=Dt("#2563EB"),v=Dt(2),_=Dt("solid"),x=Dt("#000000"),k=Dt("Arial, sans-serif"),w=Dt("center"),N=Dt(!1),z=Dt(!1),W=Dt({style:!1,properties:!1,samplePoints:!1}),O=Dt({radius:4,color:"#FF4500",fillColor:"#FF4500",fillOpacity:.6,weight:2,opacity:.8}),Z=Dt({radius:6,weight:3,opacity:1,fillOpacity:1}),se=jn(()=>{var q,R;return!((q=n.selectedShape)!=null&&q.properties)||n.selectedShape.properties.type!=="TextRectangle"?"center":((R=n.selectedShape.properties.style)==null?void 0:R.textAlign)||"center"});Qi(()=>n.selectedShape,q=>{var R,U,H;if(!q){o.value=null,w.value="center",N.value=!1,z.value=!1,a.value="Double-cliquez pour diter";return}if(console.log("[DrawingTools] Changement de forme slectionne",{newShape:q,properties:q==null?void 0:q.properties}),q){if(o.value={...q.properties},((R=q.properties)==null?void 0:R.type)==="TextRectangle"){const $=((U=q.properties)==null?void 0:U.style)||{};x.value=$.textColor||"#000000",k.value=$.fontFamily||"Arial, sans-serif",w.value=$.textAlign||"center",N.value=$.bold||!1,z.value=$.italic||!1,a.value=q.properties.text||"Double-cliquez pour diter",console.log("[DrawingTools] Initialisation du TextRectangle",{text:a.value,style:$})}((H=q.properties)==null?void 0:H.type)==="ElevationLine"&&(O.value={...q.properties.samplePointStyle},Z.value={...q.properties.minMaxPointStyle})}else o.value=null},{immediate:!0}),Qi(()=>{var q,R;return(R=(q=n.selectedShape)==null?void 0:q.properties)==null?void 0:R.text},q=>{var R,U;((U=(R=n.selectedShape)==null?void 0:R.properties)==null?void 0:U.type)==="TextRectangle"&&(console.log("[DrawingTools] Mise  jour du texte :",q),a.value=q||"Double-cliquez pour diter")},{immediate:!0}),Qi(()=>{var q,R;return(R=(q=n.selectedShape)==null?void 0:q.properties)==null?void 0:R.style},q=>{var R;(R=n.selectedShape)!=null&&R.properties&&n.selectedShape.properties.type==="TextRectangle"&&q&&(x.value=q.textColor||"#000000",k.value=q.fontFamily||"Arial, sans-serif",N.value=q.bold||!1,z.value=q.italic||!1)},{deep:!0});const Se=(q,R)=>{let U=null;return(...H)=>{U!==null&&clearTimeout(U),U=window.setTimeout(()=>{q(...H),U=null},R)}},Ne=(q,R)=>{if(q===R)return!0;if(q===null||R===null)return!1;if(typeof q!="object"||typeof R!="object")return q===R;const U=Object.keys(q),H=Object.keys(R);if(U.length!==H.length)return!1;for(const $ of U)if(!H.includes($)||!Ne(q[$],R[$]))return!1;return!0},$e=Se((q,R)=>{console.log("[DrawingTools] Changement dtect dans localProperties",{newProperties:q,oldProperties:R,selectedShape:n.selectedShape})},300);Qi(()=>o.value,(q,R)=>{q&&R&&!Ne(q,R)&&$e(q,R)},{deep:!0});const Pe=q=>({Circle:'<svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10" /></svg>',Semicircle:'<svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M2 12a10 10 0 0 1 20 0" /></svg>',Rectangle:'<svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2" ry="2" /></svg>',Polygon:'<svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 3l9 7-3 9H6l-3-9 9-7z" /></svg>',delete:'<svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="3 6 5 6 21 6" /><path d="M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2" /><line x1="10" y1="11" x2="10" y2="17" /><line x1="14" y1="11" x2="14" y2="17" /></svg>',Line:'<svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 19l18-14" /></svg>',TextRectangle:'<svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" /><path d="M9 8h6m-3 0v8" /></svg>',ElevationLine:'<svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 12h3l3-9 6 18 3-9h3" /></svg>'})[q]||"",xe=[{type:"Circle",label:"Cercle"},{type:"Semicircle",label:"Demi-cercle"},{type:"Rectangle",label:"Rectangle"},{type:"Polygon",label:"Polygone"},{type:"Line",label:"Ligne"},{type:"ElevationLine",label:"Profil altimtrique"},{type:"TextRectangle",label:"Texte"},{type:"delete",label:"Supprimer"}],Be=["#2563EB","#DC2626","#059669","#D97706","#7C3AED","#DB2777"],ze=[{value:"solid",label:"Continu"},{value:"dashed",label:"Tirets"},{value:"dotted",label:"Pointill"},{value:"dashdot",label:"Tiret-point"}],te=[{value:"left",label:"Align  gauche",icon:"&#8678;"},{value:"center",label:"Centr",icon:"&#8645;"},{value:"right",label:"Align  droite",icon:"&#8680;"}],J=jn(()=>{var R,U;const q=(U=(R=n.selectedShape)==null?void 0:R.properties)==null?void 0:U.type;return console.log("[DrawingTools] Calcul de showFillOptions",{shapeType:q,selectedShape:n.selectedShape}),q?["Circle","Rectangle","Polygon","Semicircle"].includes(q)&&q!=="ElevationLine":!1}),Ee=q=>{W.value[q]=!W.value[q]},he=q=>{switch(q){case"dashed":return"10,10";case"dotted":return"2,5";case"dashdot":return"10,5,2,5";default:return""}},P=q=>{var R,U;f.value=q,(J.value||((R=o.value)==null?void 0:R.type)==="TextRectangle")&&(u.value=q),F({strokeColor:q,fillColor:J.value||((U=o.value)==null?void 0:U.type)==="TextRectangle"?q:void 0})},F=q=>{const R={...q};q.strokeStyle&&(R.dashArray=he(q.strokeStyle)),q.fillOpacity!==void 0&&(R.fillOpacity=parseFloat(q.fillOpacity)),q.strokeOpacity!==void 0&&(R.strokeOpacity=parseFloat(q.strokeOpacity)),q.strokeWidth!==void 0&&(R.weight=parseInt(q.strokeWidth)),q.strokeColor&&(R.color=q.strokeColor),i("style-update",R)},G=q=>{var U,H,$,ce,ue,V,K;if(((H=(U=n.selectedShape)==null?void 0:U.properties)==null?void 0:H.type)!=="TextRectangle")return;const R={textColor:($=n.selectedShape.properties.style)==null?void 0:$.textColor,fontFamily:(ce=n.selectedShape.properties.style)==null?void 0:ce.fontFamily,textAlign:(ue=n.selectedShape.properties.style)==null?void 0:ue.textAlign,bold:(V=n.selectedShape.properties.style)==null?void 0:V.bold,italic:(K=n.selectedShape.properties.style)==null?void 0:K.italic,...q};i("style-update",R)},Q=()=>{N.value=!N.value,G({bold:N.value})},Ae=()=>{z.value=!z.value,G({italic:z.value})},oe=q=>q?q>=1e3?`${(q/1e3).toFixed(2)} km`:`${q.toFixed(2)} m`:"0 m",me=q=>q?`${(q/1e4).toFixed(2)} ha`:"0 ha",T=q=>q?`${((q%360+360)%360).toFixed(1)}`:"0",ne=()=>{var q,R;if(((R=(q=n.selectedShape)==null?void 0:q.properties)==null?void 0:R.type)==="ElevationLine"){const U={...O.value,fillColor:O.value.color};n.selectedShape.layer.setSamplePointStyle(U)}},ae=()=>{var q,R;((R=(q=n.selectedShape)==null?void 0:q.properties)==null?void 0:R.type)==="ElevationLine"&&n.selectedShape.layer.setMinMaxPointStyle(Z.value)};return(q,R)=>(Ie(),je("div",Mw,[R[74]||(R[74]=A("div",{class:"p-3 bg-gray-50 border-b border-gray-200"},[A("h3",{class:"text-sm font-semibold text-gray-700"},"Outils de dessin")],-1)),A("div",Bw,[A("div",Tw,[(Ie(!0),je(Qt,null,En(xe.filter(U=>U.type!=="delete"),U=>(Ie(),je("button",{key:U.type,class:zi(["flex items-center justify-center p-2 rounded border",{"bg-blue-50 border-blue-200 text-blue-700":q.currentTool===U.type}]),onClick:H=>q.$emit("tool-change",U.type),title:U.label},[A("span",{class:"icon",innerHTML:Pe(U.type)},null,8,Dw)],10,Nw))),128))]),q.selectedShape?(Ie(),je("button",{key:0,class:zi(["w-full mt-2 p-2 rounded border border-red-200 bg-red-50 text-red-600 hover:bg-red-100",{"bg-red-100":q.currentTool==="delete"}]),onClick:R[0]||(R[0]=U=>q.$emit("delete-shape")),title:"Supprimer la forme"},R[33]||(R[33]=[A("svg",{class:"w-4 h-4 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)]),2)):Wt("",!0)]),q.selectedShape&&o.value?(Ie(),je("div",Rw,[A("div",Ow,[A("button",{class:"flex items-center justify-between w-full text-sm font-semibold text-gray-700",onClick:R[1]||(R[1]=U=>Ee("style"))},[R[35]||(R[35]=A("span",null,"Style",-1)),(Ie(),je("svg",{class:zi(["w-4 h-4",{"rotate-180":!W.value.style}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},R[34]||(R[34]=[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)]),2))])]),un(A("div",Iw,[A("div",Fw,[(Ie(),je(Qt,null,En(Be,U=>A("button",{key:U,class:"w-8 h-8 rounded-full",style:Oc({backgroundColor:U}),onClick:H=>P(U),title:U},null,12,jw)),64))]),o.value.type!=="TextRectangle"?(Ie(),je("div",zw,[A("div",Uw,[R[36]||(R[36]=A("span",{class:"w-20 text-sm font-semibold text-gray-700"},"Contour",-1)),A("div",$w,[un(A("input",{type:"color","onUpdate:modelValue":R[2]||(R[2]=U=>f.value=U),class:"w-16 h-8 rounded border",onChange:R[3]||(R[3]=U=>F({strokeColor:f.value})),title:"Couleur du contour"},null,544),[[Zn,f.value]]),un(A("input",{type:"range","onUpdate:modelValue":R[4]||(R[4]=U=>v.value=U),min:"1",max:"10",class:"w-16 h-2 rounded-md",onChange:R[5]||(R[5]=U=>F({strokeWidth:v.value})),title:"paisseur du contour"},null,544),[[Zn,v.value]])])]),A("div",qw,[R[37]||(R[37]=A("span",{class:"w-20 text-sm font-semibold text-gray-700"},"Style",-1)),un(A("select",{"onUpdate:modelValue":R[6]||(R[6]=U=>_.value=U),class:"w-full rounded border",onChange:R[7]||(R[7]=U=>F({strokeStyle:_.value}))},[(Ie(),je(Qt,null,En(ze,U=>A("option",{key:U.value,value:U.value},Bt(U.label),9,Vw)),64))],544),[[vr,_.value]])]),J.value?(Ie(),je("div",Gw,[R[38]||(R[38]=A("span",{class:"w-20 text-sm font-semibold text-gray-700"},"Remplir",-1)),A("div",Hw,[un(A("input",{type:"color","onUpdate:modelValue":R[8]||(R[8]=U=>u.value=U),class:"w-16 h-8 rounded border",onChange:R[9]||(R[9]=U=>F({fillColor:u.value})),title:"Couleur de remplissage"},null,544),[[Zn,u.value]]),un(A("input",{type:"range","onUpdate:modelValue":R[10]||(R[10]=U=>d.value=U),min:"0",max:"1",step:"0.1",class:"w-16 h-2 rounded-md",onChange:R[11]||(R[11]=U=>F({fillOpacity:d.value})),title:"Opacit du remplissage"},null,544),[[Zn,d.value]])])])):Wt("",!0)])):Wt("",!0),o.value.type==="TextRectangle"?(Ie(),je("div",Ww,[A("div",Zw,[R[39]||(R[39]=A("span",{class:"w-20 text-sm font-semibold text-gray-700"},"Contour",-1)),A("div",Kw,[un(A("input",{type:"color","onUpdate:modelValue":R[12]||(R[12]=U=>f.value=U),class:"w-16 h-8 rounded border",onChange:R[13]||(R[13]=U=>F({strokeColor:f.value})),title:"Couleur du contour"},null,544),[[Zn,f.value]]),un(A("input",{type:"range","onUpdate:modelValue":R[14]||(R[14]=U=>v.value=U),min:"1",max:"10",class:"w-16 h-2 rounded-md",onChange:R[15]||(R[15]=U=>F({strokeWidth:v.value})),title:"paisseur du contour"},null,544),[[Zn,v.value]])])]),A("div",Yw,[R[40]||(R[40]=A("span",{class:"w-20 text-sm font-semibold text-gray-700"},"Remplir",-1)),A("div",Jw,[un(A("input",{type:"color","onUpdate:modelValue":R[16]||(R[16]=U=>u.value=U),class:"w-16 h-8 rounded border",onChange:R[17]||(R[17]=U=>F({fillColor:u.value})),title:"Couleur de remplissage"},null,544),[[Zn,u.value]]),un(A("input",{type:"range","onUpdate:modelValue":R[18]||(R[18]=U=>d.value=U),min:"0",max:"1",step:"0.1",class:"w-16 h-2 rounded-md",onChange:R[19]||(R[19]=U=>F({fillOpacity:d.value})),title:"Opacit du remplissage"},null,544),[[Zn,d.value]])])]),A("div",Xw,[R[41]||(R[41]=A("span",{class:"w-20 text-sm font-semibold text-gray-700"},"Texte",-1)),A("div",Qw,[un(A("input",{type:"color","onUpdate:modelValue":R[20]||(R[20]=U=>x.value=U),class:"w-16 h-8 rounded border",onChange:R[21]||(R[21]=U=>G({textColor:x.value})),title:"Couleur du texte"},null,544),[[Zn,x.value]])])]),A("div",ex,[R[43]||(R[43]=A("span",{class:"w-20 text-sm font-semibold text-gray-700"},"Police",-1)),A("div",tx,[un(A("select",{"onUpdate:modelValue":R[22]||(R[22]=U=>k.value=U),class:"w-full rounded border",onChange:R[23]||(R[23]=U=>G({fontFamily:k.value}))},R[42]||(R[42]=[gc('<option value="Arial, sans-serif" data-v-4c5f2c80>Arial</option><option value="&#39;Times New Roman&#39;, serif" data-v-4c5f2c80>Times</option><option value="&#39;Courier New&#39;, monospace" data-v-4c5f2c80>Courier</option><option value="Georgia, serif" data-v-4c5f2c80>Georgia</option><option value="Verdana, sans-serif" data-v-4c5f2c80>Verdana</option>',5)]),544),[[vr,k.value]])])]),A("div",nx,[R[44]||(R[44]=A("span",{class:"w-20 text-sm font-semibold text-gray-700"},"Align.",-1)),A("div",ix,[(Ie(),je(Qt,null,En(te,U=>A("button",{key:U.value,class:zi(["flex items-center justify-center p-2 rounded border",{"bg-blue-50 border-blue-200 text-blue-700":se.value===U.value}]),onClick:H=>G({textAlign:U.value}),title:U.label},[A("span",{innerHTML:U.icon},null,8,sx)],10,rx)),64)),A("button",{class:zi(["flex items-center justify-center p-2 rounded border",{"bg-blue-50 border-blue-200 text-blue-700":N.value}]),onClick:Q,title:"Gras"}," B ",2),A("button",{class:zi(["flex items-center justify-center p-2 rounded border",{"bg-blue-50 border-blue-200 text-blue-700":z.value}]),onClick:Ae,title:"Italique"}," I ",2)])])])):Wt("",!0)],512),[[dh,!W.value.style]])])):Wt("",!0),q.selectedShape&&o.value&&o.value.type!=="TextRectangle"?(Ie(),je("div",ox,[A("button",{class:"flex items-center justify-between w-full text-sm font-semibold text-gray-700",onClick:R[24]||(R[24]=U=>Ee("properties"))},[R[46]||(R[46]=A("span",null,"Proprits",-1)),(Ie(),je("svg",{class:zi(["w-4 h-4",{"rotate-180":!W.value.properties}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},R[45]||(R[45]=[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)]),2))]),un(A("div",ax,[o.value?(Ie(),je("div",lx,[A("div",ux,[o.value.type==="Circle"?(Ie(),je(Qt,{key:0},[R[47]||(R[47]=A("span",{class:"text-sm font-semibold text-gray-700"},"Rayon :",-1)),A("span",cx,Bt(oe(o.value.radius||0)),1),R[48]||(R[48]=A("span",{class:"text-sm font-semibold text-gray-700"},"Surface :",-1)),A("span",hx,Bt(me(o.value.area||0)),1)],64)):o.value.type==="Rectangle"?(Ie(),je(Qt,{key:1},[R[49]||(R[49]=A("span",{class:"text-sm font-semibold text-gray-700"},"Largeur :",-1)),A("span",dx,Bt(oe(o.value.width||0)),1),R[50]||(R[50]=A("span",{class:"text-sm font-semibold text-gray-700"},"Hauteur :",-1)),A("span",fx,Bt(oe(o.value.height||0)),1),R[51]||(R[51]=A("span",{class:"text-sm font-semibold text-gray-700"},"Surface :",-1)),A("span",px,Bt(me(o.value.area||0)),1)],64)):o.value.type==="Semicircle"?(Ie(),je(Qt,{key:2},[R[52]||(R[52]=A("span",{class:"text-sm font-semibold text-gray-700"},"Rayon :",-1)),A("span",gx,Bt(oe(o.value.radius||0)),1),R[53]||(R[53]=A("span",{class:"text-sm font-semibold text-gray-700"},"Surface :",-1)),A("span",mx,Bt(me(o.value.area||0)),1),R[54]||(R[54]=A("span",{class:"text-sm font-semibold text-gray-700"},"Angle :",-1)),A("span",vx,Bt(T(o.value.openingAngle||0)),1)],64)):o.value.type==="Line"?(Ie(),je(Qt,{key:3},[R[55]||(R[55]=A("span",{class:"text-sm font-semibold text-gray-700"},"Longueur :",-1)),A("span",yx,Bt(oe(o.value.length||0)),1)],64)):o.value.type==="Polygon"?(Ie(),je(Qt,{key:4},[R[56]||(R[56]=A("span",{class:"text-sm font-semibold text-gray-700"},"Surface :",-1)),A("span",_x,Bt(me(o.value.area||0)),1),R[57]||(R[57]=A("span",{class:"text-sm font-semibold text-gray-700"},"Primtre :",-1)),A("span",bx,Bt(oe(o.value.perimeter||0)),1)],64)):o.value.type==="ElevationLine"?(Ie(),je(Qt,{key:5},[R[58]||(R[58]=A("span",{class:"text-sm font-semibold text-gray-700"},"Longueur :",-1)),A("span",wx,Bt(oe(o.value.length||0)),1),R[59]||(R[59]=A("span",{class:"text-sm font-semibold text-gray-700"},"Altitude min :",-1)),A("span",xx,Bt(oe(o.value.minElevation||0)),1),R[60]||(R[60]=A("span",{class:"text-sm font-semibold text-gray-700"},"Altitude max :",-1)),A("span",Lx,Bt(oe(o.value.maxElevation||0)),1),R[61]||(R[61]=A("span",{class:"text-sm font-semibold text-gray-700"},"Dnivel + :",-1)),A("span",Cx,Bt(oe(o.value.elevationGain||0)),1),R[62]||(R[62]=A("span",{class:"text-sm font-semibold text-gray-700"},"Dnivel - :",-1)),A("span",Px,Bt(oe(o.value.elevationLoss||0)),1)],64)):Wt("",!0)])])):(Ie(),je("div",kx," Aucune proprit disponible "))],512),[[dh,!W.value.properties]])])):Wt("",!0),q.selectedShape&&o.value&&o.value.type==="ElevationLine"?(Ie(),je("div",Sx,[A("button",{class:"flex items-center justify-between w-full text-sm font-semibold text-gray-700",onClick:R[25]||(R[25]=U=>Ee("samplePoints"))},[R[64]||(R[64]=A("span",null,"Points d'chantillonnage",-1)),(Ie(),je("svg",{class:zi(["w-4 h-4",{"rotate-180":!W.value.samplePoints}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},R[63]||(R[63]=[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)]),2))]),un(A("div",Ex,[A("div",Ax,[R[69]||(R[69]=A("h4",{class:"text-sm font-semibold mb-2"},"Points normaux",-1)),A("div",Mx,[A("div",null,[R[65]||(R[65]=A("label",{class:"text-xs text-gray-600"},"Taille",-1)),un(A("input",{type:"number","onUpdate:modelValue":R[26]||(R[26]=U=>O.value.radius=U),min:"2",max:"10",step:"1",class:"w-full px-2 py-1 border rounded",onChange:ne},null,544),[[Zn,O.value.radius]])]),A("div",null,[R[66]||(R[66]=A("label",{class:"text-xs text-gray-600"},"Couleur",-1)),un(A("input",{type:"color","onUpdate:modelValue":R[27]||(R[27]=U=>O.value.color=U),class:"w-full h-8 px-1 border rounded",onChange:ne},null,544),[[Zn,O.value.color]])]),A("div",null,[R[67]||(R[67]=A("label",{class:"text-xs text-gray-600"},"Opacit",-1)),un(A("input",{type:"range","onUpdate:modelValue":R[28]||(R[28]=U=>O.value.fillOpacity=U),min:"0",max:"1",step:"0.1",class:"w-full",onChange:ne},null,544),[[Zn,O.value.fillOpacity]])]),A("div",null,[R[68]||(R[68]=A("label",{class:"text-xs text-gray-600"},"Bordure",-1)),un(A("input",{type:"number","onUpdate:modelValue":R[29]||(R[29]=U=>O.value.weight=U),min:"1",max:"5",step:"1",class:"w-full px-2 py-1 border rounded",onChange:ne},null,544),[[Zn,O.value.weight]])])])]),A("div",null,[R[73]||(R[73]=A("h4",{class:"text-sm font-semibold mb-2"},"Points min/max",-1)),A("div",Bx,[A("div",null,[R[70]||(R[70]=A("label",{class:"text-xs text-gray-600"},"Taille",-1)),un(A("input",{type:"number","onUpdate:modelValue":R[30]||(R[30]=U=>Z.value.radius=U),min:"4",max:"12",step:"1",class:"w-full px-2 py-1 border rounded",onChange:ae},null,544),[[Zn,Z.value.radius]])]),A("div",null,[R[71]||(R[71]=A("label",{class:"text-xs text-gray-600"},"Bordure",-1)),un(A("input",{type:"number","onUpdate:modelValue":R[31]||(R[31]=U=>Z.value.weight=U),min:"1",max:"5",step:"1",class:"w-full px-2 py-1 border rounded",onChange:ae},null,544),[[Zn,Z.value.weight]])]),A("div",null,[R[72]||(R[72]=A("label",{class:"text-xs text-gray-600"},"Opacit",-1)),un(A("input",{type:"range","onUpdate:modelValue":R[32]||(R[32]=U=>Z.value.fillOpacity=U),min:"0",max:"1",step:"0.1",class:"w-full",onChange:ae},null,544),[[Zn,Z.value.fillOpacity]])])])])],512),[[dh,!W.value.samplePoints]])])):Wt("",!0)]))}}),D1=(e,t)=>{const n=e.__vccOpts||e;for(const[i,o]of t)n[i]=o;return n},Nx=D1(Tx,[["__scopeId","data-v-4c5f2c80"]]),Dx={class:"map-toolbar w-full"},Rx={class:"hidden md:flex items-center space-x-2"},Ox={class:"dropdown"},Ix={class:"dropdown-menu"},Fx=["onClick"],jx={key:0,class:"border-l pl-2 flex-1"},zx={class:"flex items-center"},Ux={class:"plan-info"},$x={class:"plan-name"},qx={key:0,class:"plan-description"},Vx={class:"border-l pl-2 ml-auto"},Gx={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4 text-blue-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},Hx={key:1,class:"h-4 w-4 mr-2 text-primary-600",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},Wx={key:"saving"},Zx={key:"success",class:"save-success-text"},Kx={key:"default"},Yx={class:"md:hidden"},Jx={class:"flex justify-between items-center"},Xx={key:0,class:"truncate mx-2 text-sm font-medium"},Qx={key:0,class:"mobile-menu mt-2 bg-white shadow-md rounded p-2 z-50"},eL={class:"flex flex-col space-y-2"},tL={key:0,class:"flex flex-col pb-2 border-b"},nL={class:"text-sm font-semibold text-gray-800"},iL={key:0,class:"text-xs text-gray-600 mt-1"},rL={class:"flex flex-col"},sL={class:"grid grid-cols-2 gap-1"},oL=["onClick"],aL={key:0,class:"animate-spin h-3 w-3 mr-1 text-blue-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},lL={key:1,class:"h-3 w-3 mr-1 text-primary-600",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},uL={key:"saving"},cL={key:"success",class:"save-success-text"},hL={key:"default"},dL=Hs({__name:"MapToolbar",props:{lastSave:{},planName:{},planDescription:{},saveStatus:{}},emits:["change-map-type","create-new-plan","load-plan","save-plan","adjust-view","generate-summary"],setup(e,{emit:t}){const n=t,i=e,o=Dt("Ville"),a=Dt(!1),u=W=>{const O=W.currentTarget,Z=O.nextElementSibling;if(Z&&Z.classList.contains("dropdown-menu")){const se=O.getBoundingClientRect();Z.style.top=`${se.bottom}px`,Z.style.left=`${se.left}px`}},d={Ville:"Ville",Satellite:"Satellite",Cadastre:"Cadastre"},f=jn(()=>i.lastSave?new Date(i.lastSave).toLocaleString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"Jamais"),v=W=>{o.value=W,n("change-map-type",W),z()},_=()=>{n("create-new-plan"),z()},x=()=>{n("load-plan"),z()},k=()=>{n("save-plan"),z()},w=()=>{n("adjust-view"),z()},N=()=>{n("generate-summary"),z()},z=()=>{a.value=!1};return(W,O)=>(Ie(),je("div",Dx,[A("div",Rx,[A("div",Ox,[A("button",{class:"btn-toolbar dropdown-toggle",onMouseover:u},[O[1]||(O[1]=A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",viewBox:"0 0 20 20",fill:"currentColor"},[A("path",{"fill-rule":"evenodd",d:"M12 1.586l-4 4V17h8V5.586l-4-4zM2 17V9.276l4-3.638V17H2zM2 8.162V3h4.5L12 8.5V17H6V5.638L2 8.162z","clip-rule":"evenodd"})],-1)),A("span",null,Bt(d[o.value]),1)],32),A("div",Ix,[(Ie(),je(Qt,null,En(d,(Z,se)=>A("button",{key:se,class:zi(["dropdown-item",{active:se===o.value}]),onClick:Se=>v(se)},Bt(Z),11,Fx)),64))])]),W.planName?(Ie(),je("div",jx,[A("div",zx,[A("div",Ux,[A("h2",$x,Bt(W.planName),1),W.planDescription?(Ie(),je("p",qx,Bt(W.planDescription),1)):Wt("",!0)])])])):Wt("",!0),A("div",{class:"border-l pl-2"},[A("div",{class:"flex items-center space-x-1"},[A("button",{onClick:_,class:"btn-toolbar",title:"Nouveau plan"},O[2]||(O[2]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[A("path",{"fill-rule":"evenodd",d:"M6 2a2 2 0 00-2 2v12a2 2 0 002 2h8a2 2 0 002-2V7.414A2 2 0 0015.414 6L12 2.586A2 2 0 0010.586 2H6zm5 6a1 1 0 10-2 0v2H7a1 1 0 100 2h2v2a1 1 0 102 0v-2h2a1 1 0 100-2h-2V8z","clip-rule":"evenodd"})],-1),A("span",{class:"hidden lg:inline ml-1"},"Nouveau",-1)])),A("button",{onClick:x,class:"btn-toolbar",title:"Charger un plan"},O[3]||(O[3]=[gc('<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor" data-v-db17e599><path fill-rule="evenodd" d="M2 6a2 2 0 012-2h4a1 1 0 010 2H4v10h10v-4a1 1 0 112 0v4a2 2 0 01-2 2H4a2 2 0 01-2-2V6z" clip-rule="evenodd" data-v-db17e599></path><path d="M10 9a1 1 0 011-1h5a1 1 0 110 2h-5a1 1 0 01-1-1z" data-v-db17e599></path><path fill-rule="evenodd" d="M13 5a1 1 0 011 1v4a1 1 0 11-2 0V6a1 1 0 011-1z" clip-rule="evenodd" data-v-db17e599></path></svg><span class="hidden lg:inline ml-1" data-v-db17e599>Charger</span>',2)])),A("button",{onClick:k,class:"btn-toolbar",title:"Enregistrer le plan"},O[4]||(O[4]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[A("path",{d:"M7.707 10.293a1 1 0 10-1.414 1.414l3 3a1 1 0 001.414 0l3-3a1 1 0 00-1.414-1.414L11 11.586V6h5a2 2 0 012 2v7a2 2 0 01-2 2H4a2 2 0 01-2-2V8a2 2 0 012-2h5v5.586l-1.293-1.293zM9 4a1 1 0 012 0v2H9V4z"})],-1),A("span",{class:"hidden lg:inline ml-1"},"Enregistrer",-1)]))])]),A("div",{class:"border-l pl-2"},[A("div",{class:"flex items-center space-x-1"},[A("button",{onClick:w,class:"btn-toolbar",title:"Ajuster la vue"},O[5]||(O[5]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[A("path",{d:"M5 3a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2V5a2 2 0 00-2-2H5zM5 11a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2v-2a2 2 0 00-2-2H5zM11 5a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V5zM11 13a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})],-1),A("span",{class:"hidden lg:inline ml-1"},"Ajuster",-1)])),A("button",{onClick:N,class:"btn-toolbar",title:"Gnrer une synthse"},O[6]||(O[6]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[A("path",{"fill-rule":"evenodd",d:"M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z","clip-rule":"evenodd"})],-1),A("span",{class:"hidden lg:inline ml-1"},"Synthse",-1)]))])]),A("div",Vx,[A("div",{class:zi(["text-xs hidden lg:flex items-center",{"text-gray-500":!W.saveStatus,"text-primary-600 font-medium":W.saveStatus==="success","text-blue-600 font-medium":W.saveStatus==="saving"}])},[W.saveStatus==="saving"?(Ie(),je("svg",Gx,O[7]||(O[7]=[A("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),A("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):Wt("",!0),W.saveStatus==="success"?(Ie(),je("svg",Hx,O[8]||(O[8]=[A("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"},null,-1)]))):Wt("",!0),Ci(Nh,{name:"fade-slide",mode:"out-in"},{default:Qo(()=>[W.saveStatus==="saving"?(Ie(),je("span",Wx," Sauvegarde en cours... ")):W.saveStatus==="success"?(Ie(),je("span",Zx," Sauvegarde russie ! ")):(Ie(),je("span",Kx," Dernire modification : "+Bt(f.value),1))]),_:1})],2)])]),A("div",Yx,[A("div",Jx,[A("button",{onClick:O[0]||(O[0]=Z=>a.value=!a.value),class:"p-1 rounded border"},O[9]||(O[9]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-gray-600",viewBox:"0 0 20 20",fill:"currentColor"},[A("path",{"fill-rule":"evenodd",d:"M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z","clip-rule":"evenodd"})],-1)])),W.planName?(Ie(),je("div",Xx,Bt(W.planName),1)):Wt("",!0),A("div",{class:"flex space-x-1"},[A("button",{onClick:_,class:"p-1 rounded border bg-white"},O[10]||(O[10]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[A("path",{"fill-rule":"evenodd",d:"M6 2a2 2 0 00-2 2v12a2 2 0 002 2h8a2 2 0 002-2V7.414A2 2 0 0015.414 6L12 2.586A2 2 0 0010.586 2H6zm5 6a1 1 0 10-2 0v2H7a1 1 0 100 2h2v2a1 1 0 102 0v-2h2a1 1 0 100-2h-2V8z","clip-rule":"evenodd"})],-1)])),A("button",{onClick:k,class:"p-1 rounded border bg-white"},O[11]||(O[11]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[A("path",{d:"M7.707 10.293a1 1 0 10-1.414 1.414l3 3a1 1 0 001.414 0l3-3a1 1 0 00-1.414-1.414L11 11.586V6h5a2 2 0 012 2v7a2 2 0 01-2 2H4a2 2 0 01-2-2V8a2 2 0 012-2h5v5.586l-1.293-1.293zM9 4a1 1 0 012 0v2H9V4z"})],-1)])),A("button",{onClick:w,class:"p-1 rounded border bg-white"},O[12]||(O[12]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[A("path",{d:"M5 3a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2V5a2 2 0 00-2-2H5zM5 11a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2v-2a2 2 0 00-2-2H5zM11 5a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V5zM11 13a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})],-1)]))])]),a.value?(Ie(),je("div",Qx,[A("div",eL,[W.planName?(Ie(),je("div",tL,[A("h3",nL,Bt(W.planName),1),W.planDescription?(Ie(),je("p",iL,Bt(W.planDescription),1)):Wt("",!0)])):Wt("",!0),A("div",rL,[O[13]||(O[13]=A("span",{class:"text-xs font-medium text-gray-500 mb-1"},"Type de carte",-1)),A("div",sL,[(Ie(),je(Qt,null,En(d,(Z,se)=>A("button",{key:se,class:zi(["px-2 py-1 text-xs rounded border",{"bg-blue-50 border-blue-200 text-blue-700":se===o.value}]),onClick:Se=>v(se)},Bt(Z),11,oL)),64))])]),A("div",{class:"flex flex-col"},[O[16]||(O[16]=A("span",{class:"text-xs font-medium text-gray-500 mb-1"},"Outils de plan",-1)),A("div",{class:"grid grid-cols-2 gap-1"},[A("button",{onClick:x,class:"px-2 py-1 text-xs rounded border flex items-center justify-center"},O[14]||(O[14]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-3 w-3 mr-1",viewBox:"0 0 20 20",fill:"currentColor"},[A("path",{"fill-rule":"evenodd",d:"M2 6a2 2 0 012-2h4a1 1 0 010 2H4v10h10v-4a1 1 0 112 0v4a2 2 0 01-2 2H4a2 2 0 01-2-2V6z","clip-rule":"evenodd"}),A("path",{d:"M10 9a1 1 0 011-1h5a1 1 0 110 2h-5a1 1 0 01-1-1z"}),A("path",{"fill-rule":"evenodd",d:"M13 5a1 1 0 011 1v4a1 1 0 11-2 0V6a1 1 0 011-1z","clip-rule":"evenodd"})],-1),vi(" Charger ")])),A("button",{onClick:N,class:"px-2 py-1 text-xs rounded border flex items-center justify-center"},O[15]||(O[15]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-3 w-3 mr-1",viewBox:"0 0 20 20",fill:"currentColor"},[A("path",{"fill-rule":"evenodd",d:"M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z","clip-rule":"evenodd"})],-1),vi(" Synthse ")]))])]),A("div",{class:zi(["text-xs text-center pt-1 border-t flex items-center justify-center space-x-1",{"text-gray-500":!W.saveStatus,"text-primary-600 font-medium":W.saveStatus==="success","text-blue-600 font-medium":W.saveStatus==="saving"}])},[W.saveStatus==="saving"?(Ie(),je("svg",aL,O[17]||(O[17]=[A("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),A("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):Wt("",!0),W.saveStatus==="success"?(Ie(),je("svg",lL,O[18]||(O[18]=[A("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"},null,-1)]))):Wt("",!0),Ci(Nh,{name:"fade-slide",mode:"out-in"},{default:Qo(()=>[W.saveStatus==="saving"?(Ie(),je("span",uL," Sauvegarde en cours... ")):W.saveStatus==="success"?(Ie(),je("span",cL," Sauvegarde russie ! ")):(Ie(),je("span",hL," Dernire modification : "+Bt(f.value),1))]),_:1})],2)])])):Wt("",!0)])]))}}),fL=D1(dL,[["__scopeId","data-v-db17e599"]]);(()=>{var Ht,pn;var e=Object.create,t=Object.defineProperty,n=Object.getOwnPropertyDescriptor,i=Object.getOwnPropertyNames,o=Object.getPrototypeOf,a=Object.prototype.hasOwnProperty,u=(s,l)=>()=>(l||s((l={exports:{}}).exports,l),l.exports),d=(s,l,h,g)=>{if(l&&typeof l=="object"||typeof l=="function")for(let y of i(l))!a.call(s,y)&&y!==h&&t(s,y,{get:()=>l[y],enumerable:!(g=n(l,y))||g.enumerable});return s},f=(s,l,h)=>(h=s!=null?e(o(s)):{},d(l||!s||!s.__esModule?t(h,"default",{value:s,enumerable:!0}):h,s)),v=u((s,l)=>{function h(){this.__data__=[],this.size=0}l.exports=h}),_=u((s,l)=>{function h(g,y){return g===y||g!==g&&y!==y}l.exports=h}),x=u((s,l)=>{var h=_();function g(y,S){for(var B=y.length;B--;)if(h(y[B][0],S))return B;return-1}l.exports=g}),k=u((s,l)=>{var h=x(),g=Array.prototype,y=g.splice;function S(B){var D=this.__data__,Y=h(D,B);if(Y<0)return!1;var le=D.length-1;return Y==le?D.pop():y.call(D,Y,1),--this.size,!0}l.exports=S}),w=u((s,l)=>{var h=x();function g(y){var S=this.__data__,B=h(S,y);return B<0?void 0:S[B][1]}l.exports=g}),N=u((s,l)=>{var h=x();function g(y){return h(this.__data__,y)>-1}l.exports=g}),z=u((s,l)=>{var h=x();function g(y,S){var B=this.__data__,D=h(B,y);return D<0?(++this.size,B.push([y,S])):B[D][1]=S,this}l.exports=g}),W=u((s,l)=>{var h=v(),g=k(),y=w(),S=N(),B=z();function D(Y){var le=-1,Oe=Y==null?0:Y.length;for(this.clear();++le<Oe;){var Te=Y[le];this.set(Te[0],Te[1])}}D.prototype.clear=h,D.prototype.delete=g,D.prototype.get=y,D.prototype.has=S,D.prototype.set=B,l.exports=D}),O=u((s,l)=>{var h=W();function g(){this.__data__=new h,this.size=0}l.exports=g}),Z=u((s,l)=>{function h(g){var y=this.__data__,S=y.delete(g);return this.size=y.size,S}l.exports=h}),se=u((s,l)=>{function h(g){return this.__data__.get(g)}l.exports=h}),Se=u((s,l)=>{function h(g){return this.__data__.has(g)}l.exports=h}),Ne=u((s,l)=>{var h=typeof To=="object"&&To&&To.Object===Object&&To;l.exports=h}),$e=u((s,l)=>{var h=Ne(),g=typeof self=="object"&&self&&self.Object===Object&&self,y=h||g||Function("return this")();l.exports=y}),Pe=u((s,l)=>{var h=$e(),g=h.Symbol;l.exports=g}),xe=u((s,l)=>{var h=Pe(),g=Object.prototype,y=g.hasOwnProperty,S=g.toString,B=h?h.toStringTag:void 0;function D(Y){var le=y.call(Y,B),Oe=Y[B];try{Y[B]=void 0;var Te=!0}catch{}var it=S.call(Y);return Te&&(le?Y[B]=Oe:delete Y[B]),it}l.exports=D}),Be=u((s,l)=>{var h=Object.prototype,g=h.toString;function y(S){return g.call(S)}l.exports=y}),ze=u((s,l)=>{var h=Pe(),g=xe(),y=Be(),S="[object Null]",B="[object Undefined]",D=h?h.toStringTag:void 0;function Y(le){return le==null?le===void 0?B:S:D&&D in Object(le)?g(le):y(le)}l.exports=Y}),te=u((s,l)=>{function h(g){var y=typeof g;return g!=null&&(y=="object"||y=="function")}l.exports=h}),J=u((s,l)=>{var h=ze(),g=te(),y="[object AsyncFunction]",S="[object Function]",B="[object GeneratorFunction]",D="[object Proxy]";function Y(le){if(!g(le))return!1;var Oe=h(le);return Oe==S||Oe==B||Oe==y||Oe==D}l.exports=Y}),Ee=u((s,l)=>{var h=$e(),g=h["__core-js_shared__"];l.exports=g}),he=u((s,l)=>{var h=Ee(),g=function(){var S=/[^.]+$/.exec(h&&h.keys&&h.keys.IE_PROTO||"");return S?"Symbol(src)_1."+S:""}();function y(S){return!!g&&g in S}l.exports=y}),P=u((s,l)=>{var h=Function.prototype,g=h.toString;function y(S){if(S!=null){try{return g.call(S)}catch{}try{return S+""}catch{}}return""}l.exports=y}),F=u((s,l)=>{var h=J(),g=he(),y=te(),S=P(),B=/[\\^$.*+?()[\]{}|]/g,D=/^\[object .+?Constructor\]$/,Y=Function.prototype,le=Object.prototype,Oe=Y.toString,Te=le.hasOwnProperty,it=RegExp("^"+Oe.call(Te).replace(B,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function pt(Tt){if(!y(Tt)||g(Tt))return!1;var qt=h(Tt)?it:D;return qt.test(S(Tt))}l.exports=pt}),G=u((s,l)=>{function h(g,y){return g==null?void 0:g[y]}l.exports=h}),Q=u((s,l)=>{var h=F(),g=G();function y(S,B){var D=g(S,B);return h(D)?D:void 0}l.exports=y}),Ae=u((s,l)=>{var h=Q(),g=$e(),y=h(g,"Map");l.exports=y}),oe=u((s,l)=>{var h=Q(),g=h(Object,"create");l.exports=g}),me=u((s,l)=>{var h=oe();function g(){this.__data__=h?h(null):{},this.size=0}l.exports=g}),T=u((s,l)=>{function h(g){var y=this.has(g)&&delete this.__data__[g];return this.size-=y?1:0,y}l.exports=h}),ne=u((s,l)=>{var h=oe(),g="__lodash_hash_undefined__",y=Object.prototype,S=y.hasOwnProperty;function B(D){var Y=this.__data__;if(h){var le=Y[D];return le===g?void 0:le}return S.call(Y,D)?Y[D]:void 0}l.exports=B}),ae=u((s,l)=>{var h=oe(),g=Object.prototype,y=g.hasOwnProperty;function S(B){var D=this.__data__;return h?D[B]!==void 0:y.call(D,B)}l.exports=S}),q=u((s,l)=>{var h=oe(),g="__lodash_hash_undefined__";function y(S,B){var D=this.__data__;return this.size+=this.has(S)?0:1,D[S]=h&&B===void 0?g:B,this}l.exports=y}),R=u((s,l)=>{var h=me(),g=T(),y=ne(),S=ae(),B=q();function D(Y){var le=-1,Oe=Y==null?0:Y.length;for(this.clear();++le<Oe;){var Te=Y[le];this.set(Te[0],Te[1])}}D.prototype.clear=h,D.prototype.delete=g,D.prototype.get=y,D.prototype.has=S,D.prototype.set=B,l.exports=D}),U=u((s,l)=>{var h=R(),g=W(),y=Ae();function S(){this.size=0,this.__data__={hash:new h,map:new(y||g),string:new h}}l.exports=S}),H=u((s,l)=>{function h(g){var y=typeof g;return y=="string"||y=="number"||y=="symbol"||y=="boolean"?g!=="__proto__":g===null}l.exports=h}),$=u((s,l)=>{var h=H();function g(y,S){var B=y.__data__;return h(S)?B[typeof S=="string"?"string":"hash"]:B.map}l.exports=g}),ce=u((s,l)=>{var h=$();function g(y){var S=h(this,y).delete(y);return this.size-=S?1:0,S}l.exports=g}),ue=u((s,l)=>{var h=$();function g(y){return h(this,y).get(y)}l.exports=g}),V=u((s,l)=>{var h=$();function g(y){return h(this,y).has(y)}l.exports=g}),K=u((s,l)=>{var h=$();function g(y,S){var B=h(this,y),D=B.size;return B.set(y,S),this.size+=B.size==D?0:1,this}l.exports=g}),ye=u((s,l)=>{var h=U(),g=ce(),y=ue(),S=V(),B=K();function D(Y){var le=-1,Oe=Y==null?0:Y.length;for(this.clear();++le<Oe;){var Te=Y[le];this.set(Te[0],Te[1])}}D.prototype.clear=h,D.prototype.delete=g,D.prototype.get=y,D.prototype.has=S,D.prototype.set=B,l.exports=D}),ve=u((s,l)=>{var h=W(),g=Ae(),y=ye(),S=200;function B(D,Y){var le=this.__data__;if(le instanceof h){var Oe=le.__data__;if(!g||Oe.length<S-1)return Oe.push([D,Y]),this.size=++le.size,this;le=this.__data__=new y(Oe)}return le.set(D,Y),this.size=le.size,this}l.exports=B}),ee=u((s,l)=>{var h=W(),g=O(),y=Z(),S=se(),B=Se(),D=ve();function Y(le){var Oe=this.__data__=new h(le);this.size=Oe.size}Y.prototype.clear=g,Y.prototype.delete=y,Y.prototype.get=S,Y.prototype.has=B,Y.prototype.set=D,l.exports=Y}),Ge=u((s,l)=>{var h=Q(),g=function(){try{var y=h(Object,"defineProperty");return y({},"",{}),y}catch{}}();l.exports=g}),tt=u((s,l)=>{var h=Ge();function g(y,S,B){S=="__proto__"&&h?h(y,S,{configurable:!0,enumerable:!0,value:B,writable:!0}):y[S]=B}l.exports=g}),Ue=u((s,l)=>{var h=tt(),g=_();function y(S,B,D){(D!==void 0&&!g(S[B],D)||D===void 0&&!(B in S))&&h(S,B,D)}l.exports=y}),nt=u((s,l)=>{function h(g){return function(y,S,B){for(var D=-1,Y=Object(y),le=B(y),Oe=le.length;Oe--;){var Te=le[g?Oe:++D];if(S(Y[Te],Te,Y)===!1)break}return y}}l.exports=h}),st=u((s,l)=>{var h=nt(),g=h();l.exports=g}),Ct=u((s,l)=>{var h=$e(),g=typeof s=="object"&&s&&!s.nodeType&&s,y=g&&typeof l=="object"&&l&&!l.nodeType&&l,S=y&&y.exports===g,B=S?h.Buffer:void 0,D=B?B.allocUnsafe:void 0;function Y(le,Oe){if(Oe)return le.slice();var Te=le.length,it=D?D(Te):new le.constructor(Te);return le.copy(it),it}l.exports=Y}),xt=u((s,l)=>{var h=$e(),g=h.Uint8Array;l.exports=g}),Ot=u((s,l)=>{var h=xt();function g(y){var S=new y.constructor(y.byteLength);return new h(S).set(new h(y)),S}l.exports=g}),$t=u((s,l)=>{var h=Ot();function g(y,S){var B=S?h(y.buffer):y.buffer;return new y.constructor(B,y.byteOffset,y.length)}l.exports=g}),Gt=u((s,l)=>{function h(g,y){var S=-1,B=g.length;for(y||(y=Array(B));++S<B;)y[S]=g[S];return y}l.exports=h}),ft=u((s,l)=>{var h=te(),g=Object.create,y=function(){function S(){}return function(B){if(!h(B))return{};if(g)return g(B);S.prototype=B;var D=new S;return S.prototype=void 0,D}}();l.exports=y}),Fe=u((s,l)=>{function h(g,y){return function(S){return g(y(S))}}l.exports=h}),kt=u((s,l)=>{var h=Fe(),g=h(Object.getPrototypeOf,Object);l.exports=g}),Et=u((s,l)=>{var h=Object.prototype;function g(y){var S=y&&y.constructor,B=typeof S=="function"&&S.prototype||h;return y===B}l.exports=g}),At=u((s,l)=>{var h=ft(),g=kt(),y=Et();function S(B){return typeof B.constructor=="function"&&!y(B)?h(g(B)):{}}l.exports=S}),et=u((s,l)=>{function h(g){return g!=null&&typeof g=="object"}l.exports=h}),ot=u((s,l)=>{var h=ze(),g=et(),y="[object Arguments]";function S(B){return g(B)&&h(B)==y}l.exports=S}),wn=u((s,l)=>{var h=ot(),g=et(),y=Object.prototype,S=y.hasOwnProperty,B=y.propertyIsEnumerable,D=h(function(){return arguments}())?h:function(Y){return g(Y)&&S.call(Y,"callee")&&!B.call(Y,"callee")};l.exports=D}),Zt=u((s,l)=>{var h=Array.isArray;l.exports=h}),rn=u((s,l)=>{var h=9007199254740991;function g(y){return typeof y=="number"&&y>-1&&y%1==0&&y<=h}l.exports=g}),Gn=u((s,l)=>{var h=J(),g=rn();function y(S){return S!=null&&g(S.length)&&!h(S)}l.exports=y}),Tn=u((s,l)=>{var h=Gn(),g=et();function y(S){return g(S)&&h(S)}l.exports=y}),Kn=u((s,l)=>{function h(){return!1}l.exports=h}),Hn=u((s,l)=>{var h=$e(),g=Kn(),y=typeof s=="object"&&s&&!s.nodeType&&s,S=y&&typeof l=="object"&&l&&!l.nodeType&&l,B=S&&S.exports===y,D=B?h.Buffer:void 0,Y=D?D.isBuffer:void 0,le=Y||g;l.exports=le}),Ui=u((s,l)=>{var h=ze(),g=kt(),y=et(),S="[object Object]",B=Function.prototype,D=Object.prototype,Y=B.toString,le=D.hasOwnProperty,Oe=Y.call(Object);function Te(it){if(!y(it)||h(it)!=S)return!1;var pt=g(it);if(pt===null)return!0;var Tt=le.call(pt,"constructor")&&pt.constructor;return typeof Tt=="function"&&Tt instanceof Tt&&Y.call(Tt)==Oe}l.exports=Te}),Oi=u((s,l)=>{var h=ze(),g=rn(),y=et(),S="[object Arguments]",B="[object Array]",D="[object Boolean]",Y="[object Date]",le="[object Error]",Oe="[object Function]",Te="[object Map]",it="[object Number]",pt="[object Object]",Tt="[object RegExp]",qt="[object Set]",Vt="[object String]",bn="[object WeakMap]",Re="[object ArrayBuffer]",qe="[object DataView]",Je="[object Float32Array]",yt="[object Float64Array]",at="[object Int8Array]",gt="[object Int16Array]",X="[object Int32Array]",de="[object Uint8Array]",Le="[object Uint8ClampedArray]",we="[object Uint16Array]",Ce="[object Uint32Array]",ke={};ke[Je]=ke[yt]=ke[at]=ke[gt]=ke[X]=ke[de]=ke[Le]=ke[we]=ke[Ce]=!0,ke[S]=ke[B]=ke[Re]=ke[D]=ke[qe]=ke[Y]=ke[le]=ke[Oe]=ke[Te]=ke[it]=ke[pt]=ke[Tt]=ke[qt]=ke[Vt]=ke[bn]=!1;function Ze(He){return y(He)&&g(He.length)&&!!ke[h(He)]}l.exports=Ze}),zn=u((s,l)=>{function h(g){return function(y){return g(y)}}l.exports=h}),Ut=u((s,l)=>{var h=Ne(),g=typeof s=="object"&&s&&!s.nodeType&&s,y=g&&typeof l=="object"&&l&&!l.nodeType&&l,S=y&&y.exports===g,B=S&&h.process,D=function(){try{var Y=y&&y.require&&y.require("util").types;return Y||B&&B.binding&&B.binding("util")}catch{}}();l.exports=D}),An=u((s,l)=>{var h=Oi(),g=zn(),y=Ut(),S=y&&y.isTypedArray,B=S?g(S):h;l.exports=B}),bi=u((s,l)=>{function h(g,y){if(!(y==="constructor"&&typeof g[y]=="function")&&y!="__proto__")return g[y]}l.exports=h}),Yn=u((s,l)=>{var h=tt(),g=_(),y=Object.prototype,S=y.hasOwnProperty;function B(D,Y,le){var Oe=D[Y];(!(S.call(D,Y)&&g(Oe,le))||le===void 0&&!(Y in D))&&h(D,Y,le)}l.exports=B}),wi=u((s,l)=>{var h=Yn(),g=tt();function y(S,B,D,Y){var le=!D;D||(D={});for(var Oe=-1,Te=B.length;++Oe<Te;){var it=B[Oe],pt=Y?Y(D[it],S[it],it,D,S):void 0;pt===void 0&&(pt=S[it]),le?g(D,it,pt):h(D,it,pt)}return D}l.exports=y}),pi=u((s,l)=>{function h(g,y){for(var S=-1,B=Array(g);++S<g;)B[S]=y(S);return B}l.exports=h}),sn=u((s,l)=>{var h=9007199254740991,g=/^(?:0|[1-9]\d*)$/;function y(S,B){var D=typeof S;return B=B??h,!!B&&(D=="number"||D!="symbol"&&g.test(S))&&S>-1&&S%1==0&&S<B}l.exports=y}),gn=u((s,l)=>{var h=pi(),g=wn(),y=Zt(),S=Hn(),B=sn(),D=An(),Y=Object.prototype,le=Y.hasOwnProperty;function Oe(Te,it){var pt=y(Te),Tt=!pt&&g(Te),qt=!pt&&!Tt&&S(Te),Vt=!pt&&!Tt&&!qt&&D(Te),bn=pt||Tt||qt||Vt,Re=bn?h(Te.length,String):[],qe=Re.length;for(var Je in Te)(it||le.call(Te,Je))&&!(bn&&(Je=="length"||qt&&(Je=="offset"||Je=="parent")||Vt&&(Je=="buffer"||Je=="byteLength"||Je=="byteOffset")||B(Je,qe)))&&Re.push(Je);return Re}l.exports=Oe}),Yt=u((s,l)=>{function h(g){var y=[];if(g!=null)for(var S in Object(g))y.push(S);return y}l.exports=h}),gi=u((s,l)=>{var h=te(),g=Et(),y=Yt(),S=Object.prototype,B=S.hasOwnProperty;function D(Y){if(!h(Y))return y(Y);var le=g(Y),Oe=[];for(var Te in Y)Te=="constructor"&&(le||!B.call(Y,Te))||Oe.push(Te);return Oe}l.exports=D}),Rn=u((s,l)=>{var h=gn(),g=gi(),y=Gn();function S(B){return y(B)?h(B,!0):g(B)}l.exports=S}),_t=u((s,l)=>{var h=wi(),g=Rn();function y(S){return h(S,g(S))}l.exports=y}),Xn=u((s,l)=>{var h=Ue(),g=Ct(),y=$t(),S=Gt(),B=At(),D=wn(),Y=Zt(),le=Tn(),Oe=Hn(),Te=J(),it=te(),pt=Ui(),Tt=An(),qt=bi(),Vt=_t();function bn(Re,qe,Je,yt,at,gt,X){var de=qt(Re,Je),Le=qt(qe,Je),we=X.get(Le);if(we){h(Re,Je,we);return}var Ce=gt?gt(de,Le,Je+"",Re,qe,X):void 0,ke=Ce===void 0;if(ke){var Ze=Y(Le),He=!Ze&&Oe(Le),Xe=!Ze&&!He&&Tt(Le);Ce=Le,Ze||He||Xe?Y(de)?Ce=de:le(de)?Ce=S(de):He?(ke=!1,Ce=g(Le,!0)):Xe?(ke=!1,Ce=y(Le,!0)):Ce=[]:pt(Le)||D(Le)?(Ce=de,D(de)?Ce=Vt(de):(!it(de)||Te(de))&&(Ce=B(Le))):ke=!1}ke&&(X.set(Le,Ce),at(Ce,Le,yt,gt,X),X.delete(Le)),h(Re,Je,Ce)}l.exports=bn}),Ii=u((s,l)=>{var h=ee(),g=Ue(),y=st(),S=Xn(),B=te(),D=Rn(),Y=bi();function le(Oe,Te,it,pt,Tt){Oe!==Te&&y(Te,function(qt,Vt){if(Tt||(Tt=new h),B(qt))S(Oe,Te,Vt,it,le,pt,Tt);else{var bn=pt?pt(Y(Oe,Vt),qt,Vt+"",Oe,Te,Tt):void 0;bn===void 0&&(bn=qt),g(Oe,Vt,bn)}},D)}l.exports=le}),ui=u((s,l)=>{function h(g){return g}l.exports=h}),yr=u((s,l)=>{function h(g,y,S){switch(S.length){case 0:return g.call(y);case 1:return g.call(y,S[0]);case 2:return g.call(y,S[0],S[1]);case 3:return g.call(y,S[0],S[1],S[2])}return g.apply(y,S)}l.exports=h}),lr=u((s,l)=>{var h=yr(),g=Math.max;function y(S,B,D){return B=g(B===void 0?S.length-1:B,0),function(){for(var Y=arguments,le=-1,Oe=g(Y.length-B,0),Te=Array(Oe);++le<Oe;)Te[le]=Y[B+le];le=-1;for(var it=Array(B+1);++le<B;)it[le]=Y[le];return it[B]=D(Te),h(S,this,it)}}l.exports=y}),_r=u((s,l)=>{function h(g){return function(){return g}}l.exports=h}),Ki=u((s,l)=>{var h=_r(),g=Ge(),y=ui(),S=g?function(B,D){return g(B,"toString",{configurable:!0,enumerable:!1,value:h(D),writable:!0})}:y;l.exports=S}),ur=u((s,l)=>{var h=800,g=16,y=Date.now;function S(B){var D=0,Y=0;return function(){var le=y(),Oe=g-(le-Y);if(Y=le,Oe>0){if(++D>=h)return arguments[0]}else D=0;return B.apply(void 0,arguments)}}l.exports=S}),jr=u((s,l)=>{var h=Ki(),g=ur(),y=g(h);l.exports=y}),Es=u((s,l)=>{var h=ui(),g=lr(),y=jr();function S(B,D){return y(g(B,D,h),B+"")}l.exports=S}),Zs=u((s,l)=>{var h=_(),g=Gn(),y=sn(),S=te();function B(D,Y,le){if(!S(le))return!1;var Oe=typeof Y;return(Oe=="number"?g(le)&&y(Y,le.length):Oe=="string"&&Y in le)?h(le[Y],D):!1}l.exports=B}),Ks=u((s,l)=>{var h=Es(),g=Zs();function y(S){return h(function(B,D){var Y=-1,le=D.length,Oe=le>1?D[le-1]:void 0,Te=le>2?D[2]:void 0;for(Oe=S.length>3&&typeof Oe=="function"?(le--,Oe):void 0,Te&&g(D[0],D[1],Te)&&(Oe=le<3?void 0:Oe,le=1),B=Object(B);++Y<le;){var it=D[Y];it&&S(B,it,Y,Oe)}return B})}l.exports=y}),Gr=u((s,l)=>{var h=Ii(),g=Ks(),y=g(function(S,B,D){h(S,B,D)});l.exports=y}),fs=u((s,l)=>{var h=ze(),g=et(),y="[object Symbol]";function S(B){return typeof B=="symbol"||g(B)&&h(B)==y}l.exports=S}),As=u((s,l)=>{var h=Zt(),g=fs(),y=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,S=/^\w*$/;function B(D,Y){if(h(D))return!1;var le=typeof D;return le=="number"||le=="symbol"||le=="boolean"||D==null||g(D)?!0:S.test(D)||!y.test(D)||Y!=null&&D in Object(Y)}l.exports=B}),aa=u((s,l)=>{var h=ye(),g="Expected a function";function y(S,B){if(typeof S!="function"||B!=null&&typeof B!="function")throw new TypeError(g);var D=function(){var Y=arguments,le=B?B.apply(this,Y):Y[0],Oe=D.cache;if(Oe.has(le))return Oe.get(le);var Te=S.apply(this,Y);return D.cache=Oe.set(le,Te)||Oe,Te};return D.cache=new(y.Cache||h),D}y.Cache=h,l.exports=y}),la=u((s,l)=>{var h=aa(),g=500;function y(S){var B=h(S,function(Y){return D.size===g&&D.clear(),Y}),D=B.cache;return B}l.exports=y}),Ys=u((s,l)=>{var h=la(),g=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,y=/\\(\\)?/g,S=h(function(B){var D=[];return B.charCodeAt(0)===46&&D.push(""),B.replace(g,function(Y,le,Oe,Te){D.push(Oe?Te.replace(y,"$1"):le||Y)}),D});l.exports=S}),Io=u((s,l)=>{function h(g,y){for(var S=-1,B=g==null?0:g.length,D=Array(B);++S<B;)D[S]=y(g[S],S,g);return D}l.exports=h}),ua=u((s,l)=>{var h=Pe(),g=Io(),y=Zt(),S=fs(),B=h?h.prototype:void 0,D=B?B.toString:void 0;function Y(le){if(typeof le=="string")return le;if(y(le))return g(le,Y)+"";if(S(le))return D?D.call(le):"";var Oe=le+"";return Oe=="0"&&1/le==-1/0?"-0":Oe}l.exports=Y}),Ms=u((s,l)=>{var h=ua();function g(y){return y==null?"":h(y)}l.exports=g}),Bs=u((s,l)=>{var h=Zt(),g=As(),y=Ys(),S=Ms();function B(D,Y){return h(D)?D:g(D,Y)?[D]:y(S(D))}l.exports=B}),go=u((s,l)=>{var h=fs();function g(y){if(typeof y=="string"||h(y))return y;var S=y+"";return S=="0"&&1/y==-1/0?"-0":S}l.exports=g}),Fo=u((s,l)=>{var h=Bs(),g=go();function y(S,B){B=h(B,S);for(var D=0,Y=B.length;S!=null&&D<Y;)S=S[g(B[D++])];return D&&D==Y?S:void 0}l.exports=y}),cr=u((s,l)=>{var h=Fo();function g(y,S,B){var D=y==null?void 0:h(y,S);return D===void 0?B:D}l.exports=g}),On=u((s,l)=>{(function(h,g){typeof s=="object"&&typeof l<"u"?l.exports=g():(h=h||self).RBush=g()})(s,function(){function h(Re,qe,Je,yt,at){(function gt(X,de,Le,we,Ce){for(;we>Le;){if(we-Le>600){var ke=we-Le+1,Ze=de-Le+1,He=Math.log(ke),Xe=.5*Math.exp(2*He/3),ht=.5*Math.sqrt(He*Xe*(ke-Xe)/ke)*(Ze-ke/2<0?-1:1),ct=Math.max(Le,Math.floor(de-Ze*Xe/ke+ht)),Rt=Math.min(we,Math.floor(de+(ke-Ze)*Xe/ke+ht));gt(X,de,ct,Rt,Ce)}var Xt=X[de],nn=Le,an=we;for(g(X,Le,de),Ce(X[we],Xt)>0&&g(X,Le,we);nn<an;){for(g(X,nn,an),nn++,an--;Ce(X[nn],Xt)<0;)nn++;for(;Ce(X[an],Xt)>0;)an--}Ce(X[Le],Xt)===0?g(X,Le,an):g(X,++an,we),an<=de&&(Le=an+1),de<=an&&(we=an-1)}})(Re,qe,Je||0,yt||Re.length-1,at||y)}function g(Re,qe,Je){var yt=Re[qe];Re[qe]=Re[Je],Re[Je]=yt}function y(Re,qe){return Re<qe?-1:Re>qe?1:0}var S=function(Re){Re===void 0&&(Re=9),this._maxEntries=Math.max(4,Re),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function B(Re,qe,Je){if(!Je)return qe.indexOf(Re);for(var yt=0;yt<qe.length;yt++)if(Je(Re,qe[yt]))return yt;return-1}function D(Re,qe){Y(Re,0,Re.children.length,qe,Re)}function Y(Re,qe,Je,yt,at){at||(at=Vt(null)),at.minX=1/0,at.minY=1/0,at.maxX=-1/0,at.maxY=-1/0;for(var gt=qe;gt<Je;gt++){var X=Re.children[gt];le(at,Re.leaf?yt(X):X)}return at}function le(Re,qe){return Re.minX=Math.min(Re.minX,qe.minX),Re.minY=Math.min(Re.minY,qe.minY),Re.maxX=Math.max(Re.maxX,qe.maxX),Re.maxY=Math.max(Re.maxY,qe.maxY),Re}function Oe(Re,qe){return Re.minX-qe.minX}function Te(Re,qe){return Re.minY-qe.minY}function it(Re){return(Re.maxX-Re.minX)*(Re.maxY-Re.minY)}function pt(Re){return Re.maxX-Re.minX+(Re.maxY-Re.minY)}function Tt(Re,qe){return Re.minX<=qe.minX&&Re.minY<=qe.minY&&qe.maxX<=Re.maxX&&qe.maxY<=Re.maxY}function qt(Re,qe){return qe.minX<=Re.maxX&&qe.minY<=Re.maxY&&qe.maxX>=Re.minX&&qe.maxY>=Re.minY}function Vt(Re){return{children:Re,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function bn(Re,qe,Je,yt,at){for(var gt=[qe,Je];gt.length;)if(!((Je=gt.pop())-(qe=gt.pop())<=yt)){var X=qe+Math.ceil((Je-qe)/yt/2)*yt;h(Re,X,qe,Je,at),gt.push(qe,X,X,Je)}}return S.prototype.all=function(){return this._all(this.data,[])},S.prototype.search=function(Re){var qe=this.data,Je=[];if(!qt(Re,qe))return Je;for(var yt=this.toBBox,at=[];qe;){for(var gt=0;gt<qe.children.length;gt++){var X=qe.children[gt],de=qe.leaf?yt(X):X;qt(Re,de)&&(qe.leaf?Je.push(X):Tt(Re,de)?this._all(X,Je):at.push(X))}qe=at.pop()}return Je},S.prototype.collides=function(Re){var qe=this.data;if(!qt(Re,qe))return!1;for(var Je=[];qe;){for(var yt=0;yt<qe.children.length;yt++){var at=qe.children[yt],gt=qe.leaf?this.toBBox(at):at;if(qt(Re,gt)){if(qe.leaf||Tt(Re,gt))return!0;Je.push(at)}}qe=Je.pop()}return!1},S.prototype.load=function(Re){if(!Re||!Re.length)return this;if(Re.length<this._minEntries){for(var qe=0;qe<Re.length;qe++)this.insert(Re[qe]);return this}var Je=this._build(Re.slice(),0,Re.length-1,0);if(this.data.children.length)if(this.data.height===Je.height)this._splitRoot(this.data,Je);else{if(this.data.height<Je.height){var yt=this.data;this.data=Je,Je=yt}this._insert(Je,this.data.height-Je.height-1,!0)}else this.data=Je;return this},S.prototype.insert=function(Re){return Re&&this._insert(Re,this.data.height-1),this},S.prototype.clear=function(){return this.data=Vt([]),this},S.prototype.remove=function(Re,qe){if(!Re)return this;for(var Je,yt,at,gt=this.data,X=this.toBBox(Re),de=[],Le=[];gt||de.length;){if(gt||(gt=de.pop(),yt=de[de.length-1],Je=Le.pop(),at=!0),gt.leaf){var we=B(Re,gt.children,qe);if(we!==-1)return gt.children.splice(we,1),de.push(gt),this._condense(de),this}at||gt.leaf||!Tt(gt,X)?yt?(Je++,gt=yt.children[Je],at=!1):gt=null:(de.push(gt),Le.push(Je),Je=0,yt=gt,gt=gt.children[0])}return this},S.prototype.toBBox=function(Re){return Re},S.prototype.compareMinX=function(Re,qe){return Re.minX-qe.minX},S.prototype.compareMinY=function(Re,qe){return Re.minY-qe.minY},S.prototype.toJSON=function(){return this.data},S.prototype.fromJSON=function(Re){return this.data=Re,this},S.prototype._all=function(Re,qe){for(var Je=[];Re;)Re.leaf?qe.push.apply(qe,Re.children):Je.push.apply(Je,Re.children),Re=Je.pop();return qe},S.prototype._build=function(Re,qe,Je,yt){var at,gt=Je-qe+1,X=this._maxEntries;if(gt<=X)return D(at=Vt(Re.slice(qe,Je+1)),this.toBBox),at;yt||(yt=Math.ceil(Math.log(gt)/Math.log(X)),X=Math.ceil(gt/Math.pow(X,yt-1))),(at=Vt([])).leaf=!1,at.height=yt;var de=Math.ceil(gt/X),Le=de*Math.ceil(Math.sqrt(X));bn(Re,qe,Je,Le,this.compareMinX);for(var we=qe;we<=Je;we+=Le){var Ce=Math.min(we+Le-1,Je);bn(Re,we,Ce,de,this.compareMinY);for(var ke=we;ke<=Ce;ke+=de){var Ze=Math.min(ke+de-1,Ce);at.children.push(this._build(Re,ke,Ze,yt-1))}}return D(at,this.toBBox),at},S.prototype._chooseSubtree=function(Re,qe,Je,yt){for(;yt.push(qe),!qe.leaf&&yt.length-1!==Je;){for(var at=1/0,gt=1/0,X=void 0,de=0;de<qe.children.length;de++){var Le=qe.children[de],we=it(Le),Ce=(ke=Re,Ze=Le,(Math.max(Ze.maxX,ke.maxX)-Math.min(Ze.minX,ke.minX))*(Math.max(Ze.maxY,ke.maxY)-Math.min(Ze.minY,ke.minY))-we);Ce<gt?(gt=Ce,at=we<at?we:at,X=Le):Ce===gt&&we<at&&(at=we,X=Le)}qe=X||qe.children[0]}var ke,Ze;return qe},S.prototype._insert=function(Re,qe,Je){var yt=Je?Re:this.toBBox(Re),at=[],gt=this._chooseSubtree(yt,this.data,qe,at);for(gt.children.push(Re),le(gt,yt);qe>=0&&at[qe].children.length>this._maxEntries;)this._split(at,qe),qe--;this._adjustParentBBoxes(yt,at,qe)},S.prototype._split=function(Re,qe){var Je=Re[qe],yt=Je.children.length,at=this._minEntries;this._chooseSplitAxis(Je,at,yt);var gt=this._chooseSplitIndex(Je,at,yt),X=Vt(Je.children.splice(gt,Je.children.length-gt));X.height=Je.height,X.leaf=Je.leaf,D(Je,this.toBBox),D(X,this.toBBox),qe?Re[qe-1].children.push(X):this._splitRoot(Je,X)},S.prototype._splitRoot=function(Re,qe){this.data=Vt([Re,qe]),this.data.height=Re.height+1,this.data.leaf=!1,D(this.data,this.toBBox)},S.prototype._chooseSplitIndex=function(Re,qe,Je){for(var yt,at,gt,X,de,Le,we,Ce=1/0,ke=1/0,Ze=qe;Ze<=Je-qe;Ze++){var He=Y(Re,0,Ze,this.toBBox),Xe=Y(Re,Ze,Je,this.toBBox),ht=(at=He,gt=Xe,X=void 0,de=void 0,Le=void 0,we=void 0,X=Math.max(at.minX,gt.minX),de=Math.max(at.minY,gt.minY),Le=Math.min(at.maxX,gt.maxX),we=Math.min(at.maxY,gt.maxY),Math.max(0,Le-X)*Math.max(0,we-de)),ct=it(He)+it(Xe);ht<Ce?(Ce=ht,yt=Ze,ke=ct<ke?ct:ke):ht===Ce&&ct<ke&&(ke=ct,yt=Ze)}return yt||Je-qe},S.prototype._chooseSplitAxis=function(Re,qe,Je){var yt=Re.leaf?this.compareMinX:Oe,at=Re.leaf?this.compareMinY:Te;this._allDistMargin(Re,qe,Je,yt)<this._allDistMargin(Re,qe,Je,at)&&Re.children.sort(yt)},S.prototype._allDistMargin=function(Re,qe,Je,yt){Re.children.sort(yt);for(var at=this.toBBox,gt=Y(Re,0,qe,at),X=Y(Re,Je-qe,Je,at),de=pt(gt)+pt(X),Le=qe;Le<Je-qe;Le++){var we=Re.children[Le];le(gt,Re.leaf?at(we):we),de+=pt(gt)}for(var Ce=Je-qe-1;Ce>=qe;Ce--){var ke=Re.children[Ce];le(X,Re.leaf?at(ke):ke),de+=pt(X)}return de},S.prototype._adjustParentBBoxes=function(Re,qe,Je){for(var yt=Je;yt>=0;yt--)le(qe[yt],Re)},S.prototype._condense=function(Re){for(var qe=Re.length-1,Je=void 0;qe>=0;qe--)Re[qe].children.length===0?qe>0?(Je=Re[qe-1].children).splice(Je.indexOf(Re[qe]),1):this.clear():D(Re[qe],this.toBBox)},S})}),yn=u(s=>{Object.defineProperty(s,"__esModule",{value:!0}),s.earthRadius=63710088e-1,s.factors={centimeters:s.earthRadius*100,centimetres:s.earthRadius*100,degrees:s.earthRadius/111325,feet:s.earthRadius*3.28084,inches:s.earthRadius*39.37,kilometers:s.earthRadius/1e3,kilometres:s.earthRadius/1e3,meters:s.earthRadius,metres:s.earthRadius,miles:s.earthRadius/1609.344,millimeters:s.earthRadius*1e3,millimetres:s.earthRadius*1e3,nauticalmiles:s.earthRadius/1852,radians:1,yards:s.earthRadius*1.0936},s.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/s.earthRadius,yards:1.0936133},s.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function l(we,Ce,ke){ke===void 0&&(ke={});var Ze={type:"Feature"};return(ke.id===0||ke.id)&&(Ze.id=ke.id),ke.bbox&&(Ze.bbox=ke.bbox),Ze.properties=Ce||{},Ze.geometry=we,Ze}s.feature=l;function h(we,Ce,ke){switch(we){case"Point":return g(Ce).geometry;case"LineString":return D(Ce).geometry;case"Polygon":return S(Ce).geometry;case"MultiPoint":return Te(Ce).geometry;case"MultiLineString":return Oe(Ce).geometry;case"MultiPolygon":return it(Ce).geometry;default:throw new Error(we+" is invalid")}}s.geometry=h;function g(we,Ce,ke){if(ke===void 0&&(ke={}),!we)throw new Error("coordinates is required");if(!Array.isArray(we))throw new Error("coordinates must be an Array");if(we.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!gt(we[0])||!gt(we[1]))throw new Error("coordinates must contain numbers");var Ze={type:"Point",coordinates:we};return l(Ze,Ce,ke)}s.point=g;function y(we,Ce,ke){return ke===void 0&&(ke={}),le(we.map(function(Ze){return g(Ze,Ce)}),ke)}s.points=y;function S(we,Ce,ke){ke===void 0&&(ke={});for(var Ze=0,He=we;Ze<He.length;Ze++){var Xe=He[Ze];if(Xe.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var ht=0;ht<Xe[Xe.length-1].length;ht++)if(Xe[Xe.length-1][ht]!==Xe[0][ht])throw new Error("First and last Position are not equivalent.")}var ct={type:"Polygon",coordinates:we};return l(ct,Ce,ke)}s.polygon=S;function B(we,Ce,ke){return ke===void 0&&(ke={}),le(we.map(function(Ze){return S(Ze,Ce)}),ke)}s.polygons=B;function D(we,Ce,ke){if(ke===void 0&&(ke={}),we.length<2)throw new Error("coordinates must be an array of two or more positions");var Ze={type:"LineString",coordinates:we};return l(Ze,Ce,ke)}s.lineString=D;function Y(we,Ce,ke){return ke===void 0&&(ke={}),le(we.map(function(Ze){return D(Ze,Ce)}),ke)}s.lineStrings=Y;function le(we,Ce){Ce===void 0&&(Ce={});var ke={type:"FeatureCollection"};return Ce.id&&(ke.id=Ce.id),Ce.bbox&&(ke.bbox=Ce.bbox),ke.features=we,ke}s.featureCollection=le;function Oe(we,Ce,ke){ke===void 0&&(ke={});var Ze={type:"MultiLineString",coordinates:we};return l(Ze,Ce,ke)}s.multiLineString=Oe;function Te(we,Ce,ke){ke===void 0&&(ke={});var Ze={type:"MultiPoint",coordinates:we};return l(Ze,Ce,ke)}s.multiPoint=Te;function it(we,Ce,ke){ke===void 0&&(ke={});var Ze={type:"MultiPolygon",coordinates:we};return l(Ze,Ce,ke)}s.multiPolygon=it;function pt(we,Ce,ke){ke===void 0&&(ke={});var Ze={type:"GeometryCollection",geometries:we};return l(Ze,Ce,ke)}s.geometryCollection=pt;function Tt(we,Ce){if(Ce===void 0&&(Ce=0),Ce&&!(Ce>=0))throw new Error("precision must be a positive number");var ke=Math.pow(10,Ce||0);return Math.round(we*ke)/ke}s.round=Tt;function qt(we,Ce){Ce===void 0&&(Ce="kilometers");var ke=s.factors[Ce];if(!ke)throw new Error(Ce+" units is invalid");return we*ke}s.radiansToLength=qt;function Vt(we,Ce){Ce===void 0&&(Ce="kilometers");var ke=s.factors[Ce];if(!ke)throw new Error(Ce+" units is invalid");return we/ke}s.lengthToRadians=Vt;function bn(we,Ce){return qe(Vt(we,Ce))}s.lengthToDegrees=bn;function Re(we){var Ce=we%360;return Ce<0&&(Ce+=360),Ce}s.bearingToAzimuth=Re;function qe(we){var Ce=we%(2*Math.PI);return Ce*180/Math.PI}s.radiansToDegrees=qe;function Je(we){var Ce=we%360;return Ce*Math.PI/180}s.degreesToRadians=Je;function yt(we,Ce,ke){if(Ce===void 0&&(Ce="kilometers"),ke===void 0&&(ke="kilometers"),!(we>=0))throw new Error("length must be a positive number");return qt(Vt(we,Ce),ke)}s.convertLength=yt;function at(we,Ce,ke){if(Ce===void 0&&(Ce="meters"),ke===void 0&&(ke="kilometers"),!(we>=0))throw new Error("area must be a positive number");var Ze=s.areaFactors[Ce];if(!Ze)throw new Error("invalid original units");var He=s.areaFactors[ke];if(!He)throw new Error("invalid final units");return we/Ze*He}s.convertArea=at;function gt(we){return!isNaN(we)&&we!==null&&!Array.isArray(we)}s.isNumber=gt;function X(we){return!!we&&we.constructor===Object}s.isObject=X;function de(we){if(!we)throw new Error("bbox is required");if(!Array.isArray(we))throw new Error("bbox must be an Array");if(we.length!==4&&we.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");we.forEach(function(Ce){if(!gt(Ce))throw new Error("bbox must only contain numbers")})}s.validateBBox=de;function Le(we){if(!we)throw new Error("id is required");if(["string","number"].indexOf(typeof we)===-1)throw new Error("id must be a number or a string")}s.validateId=Le}),ps=u(s=>{Object.defineProperty(s,"__esModule",{value:!0});var l=yn();function h(qe,Je,yt){if(qe!==null)for(var at,gt,X,de,Le,we,Ce,ke=0,Ze=0,He,Xe=qe.type,ht=Xe==="FeatureCollection",ct=Xe==="Feature",Rt=ht?qe.features.length:1,Xt=0;Xt<Rt;Xt++){Ce=ht?qe.features[Xt].geometry:ct?qe.geometry:qe,He=Ce?Ce.type==="GeometryCollection":!1,Le=He?Ce.geometries.length:1;for(var nn=0;nn<Le;nn++){var an=0,Jn=0;if(de=He?Ce.geometries[nn]:Ce,de!==null){we=de.coordinates;var ni=de.type;switch(ke=yt&&(ni==="Polygon"||ni==="MultiPolygon")?1:0,ni){case null:break;case"Point":if(Je(we,Ze,Xt,an,Jn)===!1)return!1;Ze++,an++;break;case"LineString":case"MultiPoint":for(at=0;at<we.length;at++){if(Je(we[at],Ze,Xt,an,Jn)===!1)return!1;Ze++,ni==="MultiPoint"&&an++}ni==="LineString"&&an++;break;case"Polygon":case"MultiLineString":for(at=0;at<we.length;at++){for(gt=0;gt<we[at].length-ke;gt++){if(Je(we[at][gt],Ze,Xt,an,Jn)===!1)return!1;Ze++}ni==="MultiLineString"&&an++,ni==="Polygon"&&Jn++}ni==="Polygon"&&an++;break;case"MultiPolygon":for(at=0;at<we.length;at++){for(Jn=0,gt=0;gt<we[at].length;gt++){for(X=0;X<we[at][gt].length-ke;X++){if(Je(we[at][gt][X],Ze,Xt,an,Jn)===!1)return!1;Ze++}Jn++}an++}break;case"GeometryCollection":for(at=0;at<de.geometries.length;at++)if(h(de.geometries[at],Je,yt)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function g(qe,Je,yt,at){var gt=yt;return h(qe,function(X,de,Le,we,Ce){de===0&&yt===void 0?gt=X:gt=Je(gt,X,de,Le,we,Ce)},at),gt}function y(qe,Je){var yt;switch(qe.type){case"FeatureCollection":for(yt=0;yt<qe.features.length&&Je(qe.features[yt].properties,yt)!==!1;yt++);break;case"Feature":Je(qe.properties,0);break}}function S(qe,Je,yt){var at=yt;return y(qe,function(gt,X){X===0&&yt===void 0?at=gt:at=Je(at,gt,X)}),at}function B(qe,Je){if(qe.type==="Feature")Je(qe,0);else if(qe.type==="FeatureCollection")for(var yt=0;yt<qe.features.length&&Je(qe.features[yt],yt)!==!1;yt++);}function D(qe,Je,yt){var at=yt;return B(qe,function(gt,X){X===0&&yt===void 0?at=gt:at=Je(at,gt,X)}),at}function Y(qe){var Je=[];return h(qe,function(yt){Je.push(yt)}),Je}function le(qe,Je){var yt,at,gt,X,de,Le,we,Ce,ke,Ze,He=0,Xe=qe.type==="FeatureCollection",ht=qe.type==="Feature",ct=Xe?qe.features.length:1;for(yt=0;yt<ct;yt++){for(Le=Xe?qe.features[yt].geometry:ht?qe.geometry:qe,Ce=Xe?qe.features[yt].properties:ht?qe.properties:{},ke=Xe?qe.features[yt].bbox:ht?qe.bbox:void 0,Ze=Xe?qe.features[yt].id:ht?qe.id:void 0,we=Le?Le.type==="GeometryCollection":!1,de=we?Le.geometries.length:1,gt=0;gt<de;gt++){if(X=we?Le.geometries[gt]:Le,X===null){if(Je(null,He,Ce,ke,Ze)===!1)return!1;continue}switch(X.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(Je(X,He,Ce,ke,Ze)===!1)return!1;break}case"GeometryCollection":{for(at=0;at<X.geometries.length;at++)if(Je(X.geometries[at],He,Ce,ke,Ze)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}He++}}function Oe(qe,Je,yt){var at=yt;return le(qe,function(gt,X,de,Le,we){X===0&&yt===void 0?at=gt:at=Je(at,gt,X,de,Le,we)}),at}function Te(qe,Je){le(qe,function(yt,at,gt,X,de){var Le=yt===null?null:yt.type;switch(Le){case null:case"Point":case"LineString":case"Polygon":return Je(l.feature(yt,gt,{bbox:X,id:de}),at,0)===!1?!1:void 0}var we;switch(Le){case"MultiPoint":we="Point";break;case"MultiLineString":we="LineString";break;case"MultiPolygon":we="Polygon";break}for(var Ce=0;Ce<yt.coordinates.length;Ce++){var ke=yt.coordinates[Ce],Ze={type:we,coordinates:ke};if(Je(l.feature(Ze,gt),at,Ce)===!1)return!1}})}function it(qe,Je,yt){var at=yt;return Te(qe,function(gt,X,de){X===0&&de===0&&yt===void 0?at=gt:at=Je(at,gt,X,de)}),at}function pt(qe,Je){Te(qe,function(yt,at,gt){var X=0;if(yt.geometry){var de=yt.geometry.type;if(!(de==="Point"||de==="MultiPoint")){var Le,we=0,Ce=0,ke=0;if(h(yt,function(Ze,He,Xe,ht,ct){if(Le===void 0||at>we||ht>Ce||ct>ke){Le=Ze,we=at,Ce=ht,ke=ct,X=0;return}var Rt=l.lineString([Le,Ze],yt.properties);if(Je(Rt,at,gt,ct,X)===!1)return!1;X++,Le=Ze})===!1)return!1}}})}function Tt(qe,Je,yt){var at=yt,gt=!1;return pt(qe,function(X,de,Le,we,Ce){gt===!1&&yt===void 0?at=X:at=Je(at,X,de,Le,we,Ce),gt=!0}),at}function qt(qe,Je){if(!qe)throw new Error("geojson is required");Te(qe,function(yt,at,gt){if(yt.geometry!==null){var X=yt.geometry.type,de=yt.geometry.coordinates;switch(X){case"LineString":if(Je(yt,at,gt,0,0)===!1)return!1;break;case"Polygon":for(var Le=0;Le<de.length;Le++)if(Je(l.lineString(de[Le],yt.properties),at,gt,Le)===!1)return!1;break}}})}function Vt(qe,Je,yt){var at=yt;return qt(qe,function(gt,X,de,Le){X===0&&yt===void 0?at=gt:at=Je(at,gt,X,de,Le)}),at}function bn(qe,Je){if(Je=Je||{},!l.isObject(Je))throw new Error("options is invalid");var yt=Je.featureIndex||0,at=Je.multiFeatureIndex||0,gt=Je.geometryIndex||0,X=Je.segmentIndex||0,de=Je.properties,Le;switch(qe.type){case"FeatureCollection":yt<0&&(yt=qe.features.length+yt),de=de||qe.features[yt].properties,Le=qe.features[yt].geometry;break;case"Feature":de=de||qe.properties,Le=qe.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":Le=qe;break;default:throw new Error("geojson is invalid")}if(Le===null)return null;var we=Le.coordinates;switch(Le.type){case"Point":case"MultiPoint":return null;case"LineString":return X<0&&(X=we.length+X-1),l.lineString([we[X],we[X+1]],de,Je);case"Polygon":return gt<0&&(gt=we.length+gt),X<0&&(X=we[gt].length+X-1),l.lineString([we[gt][X],we[gt][X+1]],de,Je);case"MultiLineString":return at<0&&(at=we.length+at),X<0&&(X=we[at].length+X-1),l.lineString([we[at][X],we[at][X+1]],de,Je);case"MultiPolygon":return at<0&&(at=we.length+at),gt<0&&(gt=we[at].length+gt),X<0&&(X=we[at][gt].length-X-1),l.lineString([we[at][gt][X],we[at][gt][X+1]],de,Je)}throw new Error("geojson is invalid")}function Re(qe,Je){if(Je=Je||{},!l.isObject(Je))throw new Error("options is invalid");var yt=Je.featureIndex||0,at=Je.multiFeatureIndex||0,gt=Je.geometryIndex||0,X=Je.coordIndex||0,de=Je.properties,Le;switch(qe.type){case"FeatureCollection":yt<0&&(yt=qe.features.length+yt),de=de||qe.features[yt].properties,Le=qe.features[yt].geometry;break;case"Feature":de=de||qe.properties,Le=qe.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":Le=qe;break;default:throw new Error("geojson is invalid")}if(Le===null)return null;var we=Le.coordinates;switch(Le.type){case"Point":return l.point(we,de,Je);case"MultiPoint":return at<0&&(at=we.length+at),l.point(we[at],de,Je);case"LineString":return X<0&&(X=we.length+X),l.point(we[X],de,Je);case"Polygon":return gt<0&&(gt=we.length+gt),X<0&&(X=we[gt].length+X),l.point(we[gt][X],de,Je);case"MultiLineString":return at<0&&(at=we.length+at),X<0&&(X=we[at].length+X),l.point(we[at][X],de,Je);case"MultiPolygon":return at<0&&(at=we.length+at),gt<0&&(gt=we[at].length+gt),X<0&&(X=we[at][gt].length-X),l.point(we[at][gt][X],de,Je)}throw new Error("geojson is invalid")}s.coordAll=Y,s.coordEach=h,s.coordReduce=g,s.featureEach=B,s.featureReduce=D,s.findPoint=Re,s.findSegment=bn,s.flattenEach=Te,s.flattenReduce=it,s.geomEach=le,s.geomReduce=Oe,s.lineEach=qt,s.lineReduce=Vt,s.propEach=y,s.propReduce=S,s.segmentEach=pt,s.segmentReduce=Tt}),Hr=u(s=>{Object.defineProperty(s,"__esModule",{value:!0});var l=ps();function h(g){var y=[1/0,1/0,-1/0,-1/0];return l.coordEach(g,function(S){y[0]>S[0]&&(y[0]=S[0]),y[1]>S[1]&&(y[1]=S[1]),y[2]<S[0]&&(y[2]=S[0]),y[3]<S[1]&&(y[3]=S[1])}),y}h.default=h,s.default=h}),zr=u((s,l)=>{var h=On(),g=yn(),y=ps(),S=Hr().default,B=y.featureEach;y.coordEach,g.polygon;var D=g.featureCollection;function Y(le){var Oe=new h(le);return Oe.insert=function(Te){if(Te.type!=="Feature")throw new Error("invalid feature");return Te.bbox=Te.bbox?Te.bbox:S(Te),h.prototype.insert.call(this,Te)},Oe.load=function(Te){var it=[];return Array.isArray(Te)?Te.forEach(function(pt){if(pt.type!=="Feature")throw new Error("invalid features");pt.bbox=pt.bbox?pt.bbox:S(pt),it.push(pt)}):B(Te,function(pt){if(pt.type!=="Feature")throw new Error("invalid features");pt.bbox=pt.bbox?pt.bbox:S(pt),it.push(pt)}),h.prototype.load.call(this,it)},Oe.remove=function(Te,it){if(Te.type!=="Feature")throw new Error("invalid feature");return Te.bbox=Te.bbox?Te.bbox:S(Te),h.prototype.remove.call(this,Te,it)},Oe.clear=function(){return h.prototype.clear.call(this)},Oe.search=function(Te){var it=h.prototype.search.call(this,this.toBBox(Te));return D(it)},Oe.collides=function(Te){return h.prototype.collides.call(this,this.toBBox(Te))},Oe.all=function(){var Te=h.prototype.all.call(this);return D(Te)},Oe.toJSON=function(){return h.prototype.toJSON.call(this)},Oe.fromJSON=function(Te){return h.prototype.fromJSON.call(this,Te)},Oe.toBBox=function(Te){var it;if(Te.bbox)it=Te.bbox;else if(Array.isArray(Te)&&Te.length===4)it=Te;else if(Array.isArray(Te)&&Te.length===6)it=[Te[0],Te[1],Te[3],Te[4]];else if(Te.type==="Feature")it=S(Te);else if(Te.type==="FeatureCollection")it=S(Te);else throw new Error("invalid geojson");return{minX:it[0],minY:it[1],maxX:it[2],maxY:it[3]}},Oe}l.exports=Y,l.exports.default=Y});Array.prototype.findIndex=Array.prototype.findIndex||function(s){if(this===null)throw new TypeError("Array.prototype.findIndex called on null or undefined");if(typeof s!="function")throw new TypeError("callback must be a function");for(var l=Object(this),h=l.length>>>0,g=arguments[1],y=0;y<h;y++)if(s.call(g,l[y],y,l))return y;return-1},Array.prototype.find=Array.prototype.find||function(s){if(this===null)throw new TypeError("Array.prototype.find called on null or undefined");if(typeof s!="function")throw new TypeError("callback must be a function");for(var l=Object(this),h=l.length>>>0,g=arguments[1],y=0;y<h;y++){var S=l[y];if(s.call(g,S,y,l))return S}},typeof Object.assign!="function"&&(Object.assign=function(s){if(s==null)throw new TypeError("Cannot convert undefined or null to object");s=Object(s);for(var l=1;l<arguments.length;l++){var h=arguments[l];if(h!=null)for(var g in h)Object.prototype.hasOwnProperty.call(h,g)&&(s[g]=h[g])}return s}),function(s){s.forEach(function(l){l.hasOwnProperty("remove")||Object.defineProperty(l,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function(){this.parentNode.removeChild(this)}})})}([Element.prototype,CharacterData.prototype,DocumentType.prototype]),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(s,l){if(this==null)throw new TypeError('"this" is null or not defined');var h=Object(this),g=h.length>>>0;if(g===0)return!1;var y=l|0,S=Math.max(y>=0?y:g-Math.abs(y),0);function B(D,Y){return D===Y||typeof D=="number"&&typeof Y=="number"&&isNaN(D)&&isNaN(Y)}for(;S<g;){if(B(h[S],s))return!0;S++}return!1}});var Ts={version:"2.18.3"},xn=f(Gr()),qn={tooltips:{placeMarker:"Click to place marker",firstVertex:"Click to place first vertex",continueLine:"Click to continue drawing",finishLine:"Click any existing marker to finish",finishPoly:"Click first marker to finish",finishRect:"Click to finish",startCircle:"Click to place circle center",finishCircle:"Click to finish circle",placeCircleMarker:"Click to place circle marker",placeText:"Click to place text",selectFirstLayerFor:"Select first layer for {action}",selectSecondLayerFor:"Select second layer for {action}"},actions:{finish:"Finish",cancel:"Cancel",removeLastVertex:"Remove Last Vertex"},buttonTitles:{drawMarkerButton:"Draw Marker",drawPolyButton:"Draw Polygons",drawLineButton:"Draw Polyline",drawCircleButton:"Draw Circle",drawRectButton:"Draw Rectangle",editButton:"Edit Layers",dragButton:"Drag Layers",cutButton:"Cut Layers",deleteButton:"Remove Layers",drawCircleMarkerButton:"Draw Circle Marker",snappingButton:"Snap dragged marker to other layers and vertices",pinningButton:"Pin shared vertices together",rotateButton:"Rotate Layers",drawTextButton:"Draw Text",scaleButton:"Scale Layers",autoTracingButton:"Auto trace Line",snapGuidesButton:"Show SnapGuides",unionButton:"Union layers",differenceButton:"Subtract layers"},measurements:{totalLength:"Length",segmentLength:"Segment length",area:"Area",radius:"Radius",perimeter:"Perimeter",height:"Height",width:"Width",coordinates:"Position",coordinatesMarker:"Position Marker"}},ki={tooltips:{placeMarker:"Platziere den Marker mit Klick",firstVertex:"Platziere den ersten Marker mit Klick",continueLine:"Klicke, um weiter zu zeichnen",finishLine:"Beende mit Klick auf existierenden Marker",finishPoly:"Beende mit Klick auf ersten Marker",finishRect:"Beende mit Klick",startCircle:"Platziere das Kreiszentrum mit Klick",finishCircle:"Beende den Kreis mit Klick",placeCircleMarker:"Platziere den Kreismarker mit Klick",placeText:"Platziere den Text mit Klick"},actions:{finish:"Beenden",cancel:"Abbrechen",removeLastVertex:"Letzten Vertex lschen"},buttonTitles:{drawMarkerButton:"Marker zeichnen",drawPolyButton:"Polygon zeichnen",drawLineButton:"Polyline zeichnen",drawCircleButton:"Kreis zeichnen",drawRectButton:"Rechteck zeichnen",editButton:"Layer editieren",dragButton:"Layer bewegen",cutButton:"Layer schneiden",deleteButton:"Layer lschen",drawCircleMarkerButton:"Kreismarker zeichnen",snappingButton:"Bewegter Layer an andere Layer oder Vertexe einhacken",pinningButton:"Vertexe an der gleichen Position verknpfen",rotateButton:"Layer drehen",drawTextButton:"Text zeichnen",scaleButton:"Layer skalieren",autoTracingButton:"Linie automatisch nachzeichen"},measurements:{totalLength:"Lnge",segmentLength:"Segment Lnge",area:"Flche",radius:"Radius",perimeter:"Umfang",height:"Hhe",width:"Breite",coordinates:"Position",coordinatesMarker:"Position Marker"}},Vn={tooltips:{placeMarker:"Clicca per posizionare un Marker",firstVertex:"Clicca per posizionare il primo vertice",continueLine:"Clicca per continuare a disegnare",finishLine:"Clicca qualsiasi marker esistente per terminare",finishPoly:"Clicca il primo marker per terminare",finishRect:"Clicca per terminare",startCircle:"Clicca per posizionare il punto centrale del cerchio",finishCircle:"Clicca per terminare il cerchio",placeCircleMarker:"Clicca per posizionare un Marker del cherchio"},actions:{finish:"Termina",cancel:"Annulla",removeLastVertex:"Rimuovi l'ultimo vertice"},buttonTitles:{drawMarkerButton:"Disegna Marker",drawPolyButton:"Disegna Poligoni",drawLineButton:"Disegna Polilinea",drawCircleButton:"Disegna Cerchio",drawRectButton:"Disegna Rettangolo",editButton:"Modifica Livelli",dragButton:"Sposta Livelli",cutButton:"Ritaglia Livelli",deleteButton:"Elimina Livelli",drawCircleMarkerButton:"Disegna Marker del Cerchio",snappingButton:"Snap ha trascinato il pennarello su altri strati e vertici",pinningButton:"Pin condiviso vertici insieme",rotateButton:"Ruota livello"}},Qn={tooltips:{placeMarker:"Klik untuk menempatkan marker",firstVertex:"Klik untuk menempatkan vertex pertama",continueLine:"Klik untuk meneruskan digitasi",finishLine:"Klik pada sembarang marker yang ada untuk mengakhiri",finishPoly:"Klik marker pertama untuk mengakhiri",finishRect:"Klik untuk mengakhiri",startCircle:"Klik untuk menempatkan titik pusat lingkaran",finishCircle:"Klik untuk mengakhiri lingkaran",placeCircleMarker:"Klik untuk menempatkan penanda lingkarann"},actions:{finish:"Selesai",cancel:"Batal",removeLastVertex:"Hilangkan Vertex Terakhir"},buttonTitles:{drawMarkerButton:"Digitasi Marker",drawPolyButton:"Digitasi Polygon",drawLineButton:"Digitasi Polyline",drawCircleButton:"Digitasi Lingkaran",drawRectButton:"Digitasi Segi Empat",editButton:"Edit Layer",dragButton:"Geser Layer",cutButton:"Potong Layer",deleteButton:"Hilangkan Layer",drawCircleMarkerButton:"Digitasi Penanda Lingkaran",snappingButton:"Jepretkan penanda yang ditarik ke lapisan dan simpul lain",pinningButton:"Sematkan simpul bersama bersama",rotateButton:"Putar lapisan"}},ci={tooltips:{placeMarker:"Adaug un punct",firstVertex:"Apas aici pentru a aduga primul Vertex",continueLine:"Apas aici pentru a continua desenul",finishLine:"Apas pe orice obiect pentru a finisa desenul",finishPoly:"Apas pe primul obiect pentru a finisa",finishRect:"Apas pentru a finisa",startCircle:"Apas pentru a desena un cerc",finishCircle:"Apas pentru a finisa un cerc",placeCircleMarker:"Adaug un punct"},actions:{finish:"Termin",cancel:"Anuleaz",removeLastVertex:"terge ultimul Vertex"},buttonTitles:{drawMarkerButton:"Adaug o bulin",drawPolyButton:"Deseneaz un poligon",drawLineButton:"Deseneaz o linie",drawCircleButton:"Deseneaz un cerc",drawRectButton:"Deseneaz un dreptunghi",editButton:"Editeaz straturile",dragButton:"Mut straturile",cutButton:"Taie straturile",deleteButton:"terge straturile",drawCircleMarkerButton:"Deseneaz marcatorul cercului",snappingButton:"Fixai marcatorul glisat pe alte straturi i vrfuri",pinningButton:"Fixai vrfurile partajate mpreun",rotateButton:"Rotii stratul"}},gs={tooltips:{placeMarker:",   ",firstVertex:",    ",continueLine:",   ",finishLine:"     ",finishPoly:"  ,  ",finishRect:",  ",startCircle:",    ",finishCircle:",   ",placeCircleMarker:",    "},actions:{finish:"",cancel:"",removeLastVertex:"  "},buttonTitles:{drawMarkerButton:" ",drawPolyButton:" ",drawLineButton:" ",drawCircleButton:" ",drawRectButton:" ",editButton:" ",dragButton:" ",cutButton:" ",deleteButton:" ",drawCircleMarkerButton:"  ",snappingButton:"       ",pinningButton:"   ",rotateButton:" "}},Wr={tooltips:{placeMarker:"Presiona para colocar un marcador",firstVertex:"Presiona para colocar el primer vrtice",continueLine:"Presiona para continuar dibujando",finishLine:"Presiona cualquier marcador existente para finalizar",finishPoly:"Presiona el primer marcador para finalizar",finishRect:"Presiona para finalizar",startCircle:"Presiona para colocar el centro del crculo",finishCircle:"Presiona para finalizar el crculo",placeCircleMarker:"Presiona para colocar un marcador de crculo"},actions:{finish:"Finalizar",cancel:"Cancelar",removeLastVertex:"Eliminar ltimo vrtice"},buttonTitles:{drawMarkerButton:"Dibujar Marcador",drawPolyButton:"Dibujar Polgono",drawLineButton:"Dibujar Lnea",drawCircleButton:"Dibujar Crculo",drawRectButton:"Dibujar Rectngulo",editButton:"Editar Capas",dragButton:"Arrastrar Capas",cutButton:"Cortar Capas",deleteButton:"Eliminar Capas",drawCircleMarkerButton:"Dibujar Marcador de Crculo",snappingButton:"El marcador de Snap arrastrado a otras capas y vrtices",pinningButton:"Fijar juntos los vrtices compartidos",rotateButton:"Rotar capa"}},_i={tooltips:{placeMarker:"Klik om een marker te plaatsen",firstVertex:"Klik om het eerste punt te plaatsen",continueLine:"Klik om te blijven tekenen",finishLine:"Klik op een bestaand punt om te beindigen",finishPoly:"Klik op het eerst punt om te beindigen",finishRect:"Klik om te beindigen",startCircle:"Klik om het middelpunt te plaatsen",finishCircle:"Klik om de cirkel te beindigen",placeCircleMarker:"Klik om een marker te plaatsen"},actions:{finish:"Bewaar",cancel:"Annuleer",removeLastVertex:"Verwijder laatste punt"},buttonTitles:{drawMarkerButton:"Plaats Marker",drawPolyButton:"Teken een vlak",drawLineButton:"Teken een lijn",drawCircleButton:"Teken een cirkel",drawRectButton:"Teken een vierkant",editButton:"Bewerk",dragButton:"Verplaats",cutButton:"Knip",deleteButton:"Verwijder",drawCircleMarkerButton:"Plaats Marker",snappingButton:"Snap gesleepte marker naar andere lagen en hoekpunten",pinningButton:"Speld gedeelde hoekpunten samen",rotateButton:"Laag roteren"}},Ns={tooltips:{placeMarker:"Cliquez pour placer un marqueur",firstVertex:"Cliquez pour placer le premier sommet",continueLine:"Cliquez pour continuer  dessiner",finishLine:"Cliquez sur n'importe quel marqueur pour terminer",finishPoly:"Cliquez sur le premier marqueur pour terminer",finishRect:"Cliquez pour terminer",startCircle:"Cliquez pour placer le centre du cercle",finishCircle:"Cliquez pour finir le cercle",placeCircleMarker:"Cliquez pour placer le marqueur circulaire"},actions:{finish:"Terminer",cancel:"Annuler",removeLastVertex:"Retirer le dernier sommet"},buttonTitles:{drawMarkerButton:"Placer des marqueurs",drawPolyButton:"Dessiner des polygones",drawLineButton:"Dessiner des polylignes",drawCircleButton:"Dessiner un cercle",drawRectButton:"Dessiner un rectangle",editButton:"diter des calques",dragButton:"Dplacer des calques",cutButton:"Couper des calques",deleteButton:"Supprimer des calques",drawCircleMarkerButton:"Dessiner un marqueur circulaire",snappingButton:"Glisser le marqueur vers d'autres couches et sommets",pinningButton:"pingler ensemble les sommets partags",rotateButton:"Tourner des calques"}},jo={tooltips:{placeMarker:"",firstVertex:"",continueLine:"",finishLine:"",finishPoly:"",finishRect:"",startCircle:"",finishCircle:"",placeCircleMarker:""},actions:{finish:"",cancel:"",removeLastVertex:""},buttonTitles:{drawMarkerButton:"",drawPolyButton:"",drawLineButton:"",drawCircleButton:"",drawRectButton:"",editButton:"",dragButton:"",cutButton:"",deleteButton:"",drawCircleMarkerButton:"",snappingButton:"",pinningButton:"",rotateButton:""}},Js={tooltips:{placeMarker:"",firstVertex:"",continueLine:"",finishLine:"",finishPoly:"",finishRect:"",startCircle:"",finishCircle:"",placeCircleMarker:""},actions:{finish:"",cancel:"",removeLastVertex:""},buttonTitles:{drawMarkerButton:"",drawPolyButton:"",drawLineButton:"",drawCircleButton:"",drawRectButton:"",editButton:"",dragButton:"",cutButton:"",deleteButton:"",drawCircleMarkerButton:"",snappingButton:"",pinningButton:"",rotateButton:""}},Da={tooltips:{placeMarker:"Clique para posicionar o marcador",firstVertex:"Clique para posicionar o primeiro vrtice",continueLine:"Clique para continuar desenhando",finishLine:"Clique em qualquer marcador existente para finalizar",finishPoly:"Clique no primeiro marcador para finalizar",finishRect:"Clique para finalizar",startCircle:"Clique para posicionar o centro do crculo",finishCircle:"Clique para finalizar o crculo",placeCircleMarker:"Clique para posicionar o marcador circular",placeText:"Clique para inserir texto"},actions:{finish:"Finalizar",cancel:"Cancelar",removeLastVertex:"Remover ltimo vrtice"},buttonTitles:{drawMarkerButton:"Desenhar Marcador",drawPolyButton:"Desenhar Polgonos",drawLineButton:"Desenhar Linha Poligonal",drawCircleButton:"Desenhar Crculo",drawRectButton:"Desenhar Retngulo",editButton:"Editar Camadas",dragButton:"Arrastar Camadas",cutButton:"Recortar Camadas",deleteButton:"Remover Camadas",drawCircleMarkerButton:"Desenhar Marcador de Crculo",snappingButton:"Ajustar marcador arrastado a outras camadas e vrtices",pinningButton:"Unir vrtices compartilhados",rotateButton:"Rotacionar Camadas",drawTextButton:"Desenhar Texto",scaleButton:"Redimensionar Camadas",autoTracingButton:"Traado Automtico de Linha"},measurements:{totalLength:"Comprimento",segmentLength:"Comprimento do Segmento",area:"rea",radius:"Raio",perimeter:"Permetro",height:"Altura",width:"Largura",coordinates:"Posio",coordinatesMarker:"Marcador de Posio"}},mo={tooltips:{placeMarker:"Clique para colocar marcador",firstVertex:"Clique para colocar primeiro vrtice",continueLine:"Clique para continuar a desenhar",finishLine:"Clique num marcador existente para terminar",finishPoly:"Clique no primeiro marcador para terminar",finishRect:"Clique para terminar",startCircle:"Clique para colocar o centro do crculo",finishCircle:"Clique para terminar o crculo",placeCircleMarker:"Clique para colocar marcador de crculo",placeText:"Clique para colocar texto"},actions:{finish:"Terminar",cancel:"Cancelar",removeLastVertex:"Remover ltimo Vrtice"},buttonTitles:{drawMarkerButton:"Desenhar Marcador",drawPolyButton:"Desenhar Polgonos",drawLineButton:"Desenhar Polilinha",drawCircleButton:"Desenhar Crculo",drawRectButton:"Desenhar Retngulo",editButton:"Editar Camadas",dragButton:"Arrastar Camadas",cutButton:"Cortar Camadas",deleteButton:"Remover Camadas",drawCircleMarkerButton:"Desenhar Marcador de Crculo",snappingButton:"Ajustar marcador arrastado a outras camadas e vrtices",pinningButton:"Unir vrtices partilhados",rotateButton:"Rodar Camadas",drawTextButton:"Desenhar Texto",scaleButton:"Escalar Camadas",autoTracingButton:"Traado Automtico de Linha"},measurements:{totalLength:"Comprimento",segmentLength:"Comprimento do Segmento",area:"rea",radius:"Raio",perimeter:"Permetro",height:"Altura",width:"Largura",coordinates:"Posio",coordinatesMarker:"Marcador de Posio"}},Ra={tooltips:{placeMarker:"Kliknij, aby umieci znacznik",firstVertex:"Kliknij, aby umieci pierwszy wierzchoek",continueLine:"Kliknij, aby kontynuowa rysowanie",finishLine:"Kliknij dowolny istniejcy znacznik, aby zakoczy",finishPoly:"Kliknij pierwszy znacznik, aby zakoczy",finishRect:"Kliknij, aby zakoczy",startCircle:"Kliknij, aby umieci rodek okrgu",finishCircle:"Kliknij, aby zakoczy okrg",placeCircleMarker:"Kliknij, aby umieci znacznik okrgu",placeText:"Kliknij, aby umieci tekst"},actions:{finish:"Zakocz",cancel:"Anuluj",removeLastVertex:"Usu ostatni wierzchoek"},buttonTitles:{drawMarkerButton:"Rysuj znacznik",drawPolyButton:"Rysuj wielokt",drawLineButton:"Rysuj lini",drawCircleButton:"Rysuj okrg",drawRectButton:"Rysuj prostokt",editButton:"Edytuj warstwy",dragButton:"Przecignij warstwy",cutButton:"Wytnij warstwy",deleteButton:"Usu warstwy",drawCircleMarkerButton:"Rysuj znacznik okrgy",snappingButton:"Przycignij przenoszony znacznik do innych warstw i wierzchokw",pinningButton:"Przypnij wsplne wierzchoki razem",rotateButton:"Obr warstwy",drawTextButton:"Rysuj tekst",scaleButton:"Skaluj warstwy",autoTracingButton:"Automatyczne ledzenie linii"},measurements:{totalLength:"Dugo",segmentLength:"Dugo odcinka",area:"Obszar",radius:"Promie",perimeter:"Obwd",height:"Wysoko",width:"Szeroko",coordinates:"Pozycja",coordinatesMarker:"Znacznik pozycji"}},ms={tooltips:{placeMarker:"Klicka fr att placera markr",firstVertex:"Klicka fr att placera frsta hrnet",continueLine:"Klicka fr att fortstta rita",finishLine:"Klicka p en existerande punkt fr att slutfra",finishPoly:"Klicka p den frsta punkten fr att slutfra",finishRect:"Klicka fr att slutfra",startCircle:"Klicka fr att placera cirkelns centrum",finishCircle:"Klicka fr att slutfra cirkeln",placeCircleMarker:"Klicka fr att placera cirkelmarkr"},actions:{finish:"Slutfr",cancel:"Avbryt",removeLastVertex:"Ta bort sista hrnet"},buttonTitles:{drawMarkerButton:"Rita Markr",drawPolyButton:"Rita Polygoner",drawLineButton:"Rita Linje",drawCircleButton:"Rita Cirkel",drawRectButton:"Rita Rektangel",editButton:"Redigera Lager",dragButton:"Dra Lager",cutButton:"Klipp i Lager",deleteButton:"Ta bort Lager",drawCircleMarkerButton:"Rita Cirkelmarkr",snappingButton:"Snpp dra markren till andra lager och hrn",pinningButton:"Fst delade hrn tillsammans",rotateButton:"Rotera lagret"}},Xs={tooltips:{placeMarker:"     ",firstVertex:"       ",continueLine:"      ",finishLine:"        ",finishPoly:"       ",finishRect:"    ",startCircle:"      ",finishCircle:"      ",placeCircleMarker:"      "},actions:{finish:"",cancel:"",removeLastVertex:"  "},buttonTitles:{drawMarkerButton:" ",drawPolyButton:" ",drawLineButton:" ",drawCircleButton:" ",drawRectButton:" ",editButton:" ",dragButton:" ",cutButton:" ",deleteButton:" ",drawCircleMarkerButton:"  ",snappingButton:"        ",pinningButton:"   ",rotateButton:"  "}},vo={tooltips:{placeMarker:"Kattintson a jell elhelyezshez",firstVertex:"Kattintson az els pont elhelyezshez",continueLine:"Kattintson a kvetkez pont elhelyezshez",finishLine:"A befejezshez kattintson egy meglv pontra",finishPoly:"A befejezshez kattintson az els pontra",finishRect:"Kattintson a befejezshez",startCircle:"Kattintson a kr kzppontjnak elhelyezshez",finishCircle:"Kattintson a kr befejezshez",placeCircleMarker:"Kattintson a krjell elhelyezshez"},actions:{finish:"Befejezs",cancel:"Mgse",removeLastVertex:"Utols pont eltvoltsa"},buttonTitles:{drawMarkerButton:"Jell rajzolsa",drawPolyButton:"Poligon rajzolsa",drawLineButton:"Vonal rajzolsa",drawCircleButton:"Kr rajzolsa",drawRectButton:"Ngyzet rajzolsa",editButton:"Elemek szerkesztse",dragButton:"Elemek mozgatsa",cutButton:"Elemek vgsa",deleteButton:"Elemek trlse",drawCircleMarkerButton:"Kr jell rajzolsa",snappingButton:"Kapcsolja a jelltt msik elemhez vagy ponthoz",pinningButton:"Kzs pontok sszektse",rotateButton:"Flia elforgatsa"}},ca={tooltips:{placeMarker:"Tryk for at placere en markr",firstVertex:"Tryk for at placere det frste punkt",continueLine:"Tryk for at fortstte linjen",finishLine:"Tryk p et eksisterende punkt for at afslutte",finishPoly:"Tryk p det frste punkt for at afslutte",finishRect:"Tryk for at afslutte",startCircle:"Tryk for at placere cirklens center",finishCircle:"Tryk for at afslutte cirklen",placeCircleMarker:"Tryk for at placere en cirkelmarkr"},actions:{finish:"Afslut",cancel:"Afbryd",removeLastVertex:"Fjern sidste punkt"},buttonTitles:{drawMarkerButton:"Placer markr",drawPolyButton:"Tegn polygon",drawLineButton:"Tegn linje",drawCircleButton:"Tegn cirkel",drawRectButton:"Tegn firkant",editButton:"Rediger",dragButton:"Trk",cutButton:"Klip",deleteButton:"Fjern",drawCircleMarkerButton:"Tegn cirkelmarkr",snappingButton:"Fastgr trukket markr til andre elementer",pinningButton:"Sammenlg delte elementer",rotateButton:"Roter laget"}},$i={tooltips:{placeMarker:"Klikk for  plassere punkt",firstVertex:"Klikk for  plassere frste punkt",continueLine:"Klikk for  tegne videre",finishLine:"Klikk p et eksisterende punkt for  fullfre",finishPoly:"Klikk frste punkt for  fullfre",finishRect:"Klikk for  fullfre",startCircle:"Klikk for  sette sirkel midtpunkt",finishCircle:"Klikk for  fullfre sirkel",placeCircleMarker:"Klikk for  plassere sirkel",placeText:"Klikk for  plassere tekst"},actions:{finish:"Fullfr",cancel:"Kanseller",removeLastVertex:"Fjern forrige punkt"},buttonTitles:{drawMarkerButton:"Tegn punkt",drawPolyButton:"Tegn flate",drawLineButton:"Tegn linje",drawCircleButton:"Tegn sirkel",drawRectButton:"Tegn rektangel",editButton:"Rediger objekter",dragButton:"Dra objekter",cutButton:"Kutt objekter",deleteButton:"Fjern objekter",drawCircleMarkerButton:"Tegn sirkel-punkt",snappingButton:"Fest dratt punkt til andre objekter og punkt",pinningButton:"Pin delte punkter sammen",rotateButton:"Rotr objekter",drawTextButton:"Tegn tekst",scaleButton:"Skalr objekter",autoTracingButton:"Automatisk sporing av linje"},measurements:{totalLength:"Lengde",segmentLength:"Segmentlengde",area:"Omrde",radius:"Radius",perimeter:"Omriss",height:"Hyde",width:"Bredde",coordinates:"Posisjon",coordinatesMarker:"Posisjonsmarkr"}},sl={tooltips:{placeMarker:"   ",firstVertex:"    ",continueLine:"   ",finishLine:"      ",finishPoly:"     ",finishRect:"  ",startCircle:"    ",finishCircle:"    ",placeCircleMarker:"    ",placeText:"   "},actions:{finish:"",cancel:"",removeLastVertex:"  "},buttonTitles:{drawMarkerButton:" ",drawPolyButton:" ",drawLineButton:" ",drawCircleButton:" ",drawRectButton:" ",editButton:" ",dragButton:" ",cutButton:" ",deleteButton:" ",drawCircleMarkerButton:"  ",snappingButton:"       ",pinningButton:"      ",rotateButton:" ",drawTextButton:" ",scaleButton:"",autoTracingButton:" "},measurements:{totalLength:"",segmentLength:" ",area:"",radius:"",perimeter:"",height:"",width:"",coordinates:"",coordinatesMarker:" "}},ha={tooltips:{placeMarker:",   ",firstVertex:",    ",continueLine:",   ",finishLine:" -    ",finishPoly:"  ,  ",finishRect:",  ",startCircle:",    ",finishCircle:",   ",placeCircleMarker:",    "},actions:{finish:"",cancel:"",removeLastVertex:"  "},buttonTitles:{drawMarkerButton:" ",drawPolyButton:" ",drawLineButton:" ",drawCircleButton:" ",drawRectButton:" ",editButton:" ",dragButton:" ",cutButton:" ",deleteButton:" ",drawCircleMarkerButton:"  ",snappingButton:"       ",pinningButton:"'   ",rotateButton:" "}},Pn={tooltips:{placeMarker:"areti yerletirmek iin tklayn",firstVertex:"lk tepe noktasn yerletirmek iin tklayn",continueLine:"izime devam etmek iin tklayn",finishLine:"Bitirmek iin mevcut herhangi bir iaretiyi tklayn",finishPoly:"Bitirmek iin ilk iaretiyi tklayn",finishRect:"Bitirmek iin tklayn",startCircle:"Daire merkezine yerletirmek iin tklayn",finishCircle:"Daireyi bitirmek iin tklayn",placeCircleMarker:"Daire iaretisi yerletirmek iin tklayn"},actions:{finish:"Bitir",cancel:"ptal",removeLastVertex:"Son keyi kaldr"},buttonTitles:{drawMarkerButton:"izim aretisi",drawPolyButton:"okgenler iz",drawLineButton:"oklu izgi iz",drawCircleButton:"ember iz",drawRectButton:"Dikdrtgen iz",editButton:"Katmanlar dzenle",dragButton:"Katmanlar srkle",cutButton:"Katmanlar kes",deleteButton:"Katmanlar kaldr",drawCircleMarkerButton:"Daire iaretisi iz",snappingButton:"Srklenen iaretiyi dier katmanlara ve kelere yaptr",pinningButton:"Paylalan keleri birbirine sabitle",rotateButton:"Katman dndr"}},Sn={tooltips:{placeMarker:"Kliknutm vytvote znaku",firstVertex:"Kliknutm vytvote prvn objekt",continueLine:"Kliknutm pokraujte v kreslen",finishLine:"Kliknut na libovolnou existujc znaku pro dokonen",finishPoly:"Vyberte prvn bod pro dokonen",finishRect:"Kliknte pro dokonen",startCircle:"Kliknutm pidejte sted kruhu",finishCircle:",   ",placeCircleMarker:"Kliknutm nastavte polomr"},actions:{finish:"Dokonit",cancel:"Zruit",removeLastVertex:"Zruit posledn akci"},buttonTitles:{drawMarkerButton:"Pidat znaku",drawPolyButton:"Nakreslit polygon",drawLineButton:"Nakreslit kivku",drawCircleButton:"Nakreslit kruh",drawRectButton:"Nakreslit obdlnk",editButton:"Upravit vrstvu",dragButton:"Peneste vrstvu",cutButton:"Vyjmout vrstvu",deleteButton:"Smazat vrstvu",drawCircleMarkerButton:"Pidat kruhovou znaku",snappingButton:"Navzat tanou znaku k dalm vrstvm a vrcholm",pinningButton:"Spojit spolen body dohromady",rotateButton:"Otote vrstvu"}},Zr={tooltips:{placeMarker:"",firstVertex:"",continueLine:"",finishLine:"",finishPoly:"",finishRect:"",startCircle:"",finishCircle:"",placeCircleMarker:"",placeText:""},actions:{finish:"",cancel:"",removeLastVertex:""},buttonTitles:{drawMarkerButton:"",drawPolyButton:"",drawLineButton:"",drawCircleButton:"",drawRectButton:"",editButton:"",dragButton:"",cutButton:"",deleteButton:"",drawCircleMarkerButton:"",snappingButton:"",pinningButton:"",rotateButton:"",drawTextButton:""}},Un={tooltips:{placeMarker:"Klikkaa asettaaksesi merkin",firstVertex:"Klikkaa asettaakseni ensimmisen osuuden",continueLine:"Klikkaa jatkaaksesi piirtmist",finishLine:"Klikkaa olemassa olevaa merkki lopettaaksesi",finishPoly:"Klikkaa ensimmist merkki lopettaaksesi",finishRect:"Klikkaa lopettaaksesi",startCircle:"Klikkaa asettaaksesi ympyrn keskipisteen",finishCircle:"Klikkaa lopettaaksesi ympyrn",placeCircleMarker:"Klikkaa asettaaksesi ympyrmerkin",placeText:"Klikkaa asettaaksesi tekstin"},actions:{finish:"Valmis",cancel:"Peruuta",removeLastVertex:"Poista viimeinen osuus"},buttonTitles:{drawMarkerButton:"Piirr merkkej",drawPolyButton:"Piirr monikulmioita",drawLineButton:"Piirr viivoja",drawCircleButton:"Piirr ympyr",drawRectButton:"Piirr neliskulmioita",editButton:"Muokkaa",dragButton:"Siirr",cutButton:"Leikkaa",deleteButton:"Poista",drawCircleMarkerButton:"Piirr ympyrmerkki",snappingButton:"Kiinnit siirrettv merkki toisiin muotoihin",pinningButton:"Kiinnit jaetut muodot yhteen",rotateButton:"Knn",drawTextButton:"Piirr teksti"}},Oa={tooltips:{placeMarker:"  ",firstVertex:"   ",continueLine:"  ",finishLine:"   ",finishPoly:"   ",finishRect:" ",startCircle:"    ",finishCircle:"  ",placeCircleMarker:"   ",placeText:"  "},actions:{finish:"",cancel:"",removeLastVertex:"  "},buttonTitles:{drawMarkerButton:" ",drawPolyButton:" ",drawLineButton:" ",drawCircleButton:" ",drawRectButton:" ",editButton:" ",dragButton:" ",cutButton:" ",deleteButton:" ",drawCircleMarkerButton:"  ",snappingButton:"       ",pinningButton:"   ",rotateButton:" ",drawTextButton:" "}},da={tooltips:{placeMarker:"   ",firstVertex:"    ",continueLine:"    ",finishLine:"    ",finishPoly:"    ",finishRect:"  ",startCircle:"    ",finishCircle:"   ",placeCircleMarker:"    ",placeText:"   "},actions:{finish:"",cancel:" ",removeLastVertex:"  "},buttonTitles:{drawMarkerButton:" ",drawPolyButton:" ",drawLineButton:" ",drawCircleButton:" ",drawRectButton:" ",editButton:" ",dragButton:"  ",cutButton:"  ",deleteButton:" ",drawCircleMarkerButton:"  ",snappingButton:"     ",pinningButton:"   ",rotateButton:" ",drawTextButton:" ",scaleButton:"  ",autoTracingButton:"  "},measurements:{totalLength:"",segmentLength:" ",area:"",radius:"",perimeter:"",height:"",width:"",coordinates:"",coordinatesMarker:" "}},yo=mo,Kr={en:qn,de:ki,it:Vn,id:Qn,ro:ci,ru:gs,es:Wr,nl:_i,fr:Ns,pt:yo,pt_br:Da,pt_pt:mo,zh:jo,zh_tw:Js,pl:Ra,sv:ms,el:Xs,hu:vo,da:ca,no:$i,fa:sl,ua:ha,tr:Pn,cz:Sn,ja:Zr,fi:Un,ko:Oa,ky:da},Qs={_globalEditModeEnabled:!1,enableGlobalEditMode(s){let l={...s};this._globalEditModeEnabled=!0,this.Toolbar.toggleButton("editMode",this.globalEditModeEnabled()),L.PM.Utils.findLayers(this.map).forEach(h=>{this._isRelevantForEdit(h)&&h.pm.enable(l)}),this.throttledReInitEdit||(this.throttledReInitEdit=L.Util.throttle(this.handleLayerAdditionInGlobalEditMode,100,this)),this._addedLayersEdit={},this.map.on("layeradd",this._layerAddedEdit,this),this.map.on("layeradd",this.throttledReInitEdit,this),this._fireGlobalEditModeToggled(!0)},disableGlobalEditMode(){this._globalEditModeEnabled=!1,L.PM.Utils.findLayers(this.map).forEach(s=>{s.pm.disable()}),this.map.off("layeradd",this._layerAddedEdit,this),this.map.off("layeradd",this.throttledReInitEdit,this),this.Toolbar.toggleButton("editMode",this.globalEditModeEnabled()),this._fireGlobalEditModeToggled(!1)},globalEditEnabled(){return this.globalEditModeEnabled()},globalEditModeEnabled(){return this._globalEditModeEnabled},toggleGlobalEditMode(s=this.globalOptions){this.globalEditModeEnabled()?this.disableGlobalEditMode():this.enableGlobalEditMode(s)},handleLayerAdditionInGlobalEditMode(){let s=this._addedLayersEdit;if(this._addedLayersEdit={},this.globalEditModeEnabled())for(let l in s){let h=s[l];this._isRelevantForEdit(h)&&h.pm.enable({...this.globalOptions})}},_layerAddedEdit({layer:s}){this._addedLayersEdit[L.stamp(s)]=s},_isRelevantForEdit(s){return s.pm&&!(s instanceof L.LayerGroup)&&(!L.PM.optIn&&!s.options.pmIgnore||L.PM.optIn&&s.options.pmIgnore===!1)&&!s._pmTempLayer&&s.pm.options.allowEditing}},Ia=Qs,zo={_globalDragModeEnabled:!1,enableGlobalDragMode(){let s=L.PM.Utils.findLayers(this.map);this._globalDragModeEnabled=!0,this._addedLayersDrag={},s.forEach(l=>{this._isRelevantForDrag(l)&&l.pm.enableLayerDrag()}),this.throttledReInitDrag||(this.throttledReInitDrag=L.Util.throttle(this.reinitGlobalDragMode,100,this)),this.map.on("layeradd",this._layerAddedDrag,this),this.map.on("layeradd",this.throttledReInitDrag,this),this.Toolbar.toggleButton("dragMode",this.globalDragModeEnabled()),this._fireGlobalDragModeToggled(!0)},disableGlobalDragMode(){let s=L.PM.Utils.findLayers(this.map);this._globalDragModeEnabled=!1,s.forEach(l=>{l.pm.disableLayerDrag()}),this.map.off("layeradd",this._layerAddedDrag,this),this.map.off("layeradd",this.throttledReInitDrag,this),this.Toolbar.toggleButton("dragMode",this.globalDragModeEnabled()),this._fireGlobalDragModeToggled(!1)},globalDragModeEnabled(){return!!this._globalDragModeEnabled},toggleGlobalDragMode(){this.globalDragModeEnabled()?this.disableGlobalDragMode():this.enableGlobalDragMode()},reinitGlobalDragMode(){let s=this._addedLayersDrag;if(this._addedLayersDrag={},this.globalDragModeEnabled())for(let l in s){let h=s[l];this._isRelevantForDrag(h)&&h.pm.enableLayerDrag()}},_layerAddedDrag({layer:s}){this._addedLayersDrag[L.stamp(s)]=s},_isRelevantForDrag(s){return s.pm&&!(s instanceof L.LayerGroup)&&(!L.PM.optIn&&!s.options.pmIgnore||L.PM.optIn&&s.options.pmIgnore===!1)&&!s._pmTempLayer&&s.pm.options.draggable}},Mi=zo,Ur={_globalRemovalModeEnabled:!1,enableGlobalRemovalMode(){this._globalRemovalModeEnabled=!0,this.map.eachLayer(s=>{this._isRelevantForRemoval(s)&&(s.pm.enabled()&&s.pm.disable(),s.on("click",this.removeLayer,this))}),this.throttledReInitRemoval||(this.throttledReInitRemoval=L.Util.throttle(this.handleLayerAdditionInGlobalRemovalMode,100,this)),this._addedLayersRemoval={},this.map.on("layeradd",this._layerAddedRemoval,this),this.map.on("layeradd",this.throttledReInitRemoval,this),this.Toolbar.toggleButton("removalMode",this.globalRemovalModeEnabled()),this._fireGlobalRemovalModeToggled(!0)},disableGlobalRemovalMode(){this._globalRemovalModeEnabled=!1,this.map.eachLayer(s=>{s.off("click",this.removeLayer,this)}),this.map.off("layeradd",this._layerAddedRemoval,this),this.map.off("layeradd",this.throttledReInitRemoval,this),this.Toolbar.toggleButton("removalMode",this.globalRemovalModeEnabled()),this._fireGlobalRemovalModeToggled(!1)},globalRemovalEnabled(){return this.globalRemovalModeEnabled()},globalRemovalModeEnabled(){return!!this._globalRemovalModeEnabled},toggleGlobalRemovalMode(){this.globalRemovalModeEnabled()?this.disableGlobalRemovalMode():this.enableGlobalRemovalMode()},removeLayer(s){let l=s.target;this._isRelevantForRemoval(l)&&!l.pm.dragging()&&(l.removeFrom(this.map.pm._getContainingLayer()),l.remove(),l instanceof L.LayerGroup?(this._fireRemoveLayerGroup(l),this._fireRemoveLayerGroup(this.map,l)):(l.pm._fireRemove(l),l.pm._fireRemove(this.map,l)))},_isRelevantForRemoval(s){return s.pm&&!(s instanceof L.LayerGroup)&&(!L.PM.optIn&&!s.options.pmIgnore||L.PM.optIn&&s.options.pmIgnore===!1)&&!s._pmTempLayer&&s.pm.options.allowRemoval},handleLayerAdditionInGlobalRemovalMode(){let s=this._addedLayersRemoval;if(this._addedLayersRemoval={},this.globalRemovalModeEnabled())for(let l in s){let h=s[l];this._isRelevantForRemoval(h)&&(h.pm.enabled()&&h.pm.disable(),h.on("click",this.removeLayer,this))}},_layerAddedRemoval({layer:s}){this._addedLayersRemoval[L.stamp(s)]=s}},eo=Ur,ol={_globalRotateModeEnabled:!1,enableGlobalRotateMode(){this._globalRotateModeEnabled=!0,L.PM.Utils.findLayers(this.map).filter(s=>s instanceof L.Polyline).forEach(s=>{this._isRelevantForRotate(s)&&s.pm.enableRotate()}),this.throttledReInitRotate||(this.throttledReInitRotate=L.Util.throttle(this.handleLayerAdditionInGlobalRotateMode,100,this)),this._addedLayersRotate={},this.map.on("layeradd",this._layerAddedRotate,this),this.map.on("layeradd",this.throttledReInitRotate,this),this.Toolbar.toggleButton("rotateMode",this.globalRotateModeEnabled()),this._fireGlobalRotateModeToggled()},disableGlobalRotateMode(){this._globalRotateModeEnabled=!1,L.PM.Utils.findLayers(this.map).filter(s=>s instanceof L.Polyline).forEach(s=>{s.pm.disableRotate()}),this.map.off("layeradd",this._layerAddedRotate,this),this.map.off("layeradd",this.throttledReInitRotate,this),this.Toolbar.toggleButton("rotateMode",this.globalRotateModeEnabled()),this._fireGlobalRotateModeToggled()},globalRotateModeEnabled(){return!!this._globalRotateModeEnabled},toggleGlobalRotateMode(){this.globalRotateModeEnabled()?this.disableGlobalRotateMode():this.enableGlobalRotateMode()},_isRelevantForRotate(s){return s.pm&&s instanceof L.Polyline&&!(s instanceof L.LayerGroup)&&(!L.PM.optIn&&!s.options.pmIgnore||L.PM.optIn&&s.options.pmIgnore===!1)&&!s._pmTempLayer&&s.pm.options.allowRotation},handleLayerAdditionInGlobalRotateMode(){let s=this._addedLayersRotate;if(this._addedLayersRotate={},this.globalRotateModeEnabled())for(let l in s){let h=s[l];this._isRelevantForRemoval(h)&&h.pm.enableRotate()}},_layerAddedRotate({layer:s}){this._addedLayersRotate[L.stamp(s)]=s}},Uo=ol,fa=f(Gr()),_o={_fireDrawStart(s="Draw",l={}){this.__fire(this._map,"pm:drawstart",{shape:this._shape,workingLayer:this._layer},s,l)},_fireDrawEnd(s="Draw",l={}){this.__fire(this._map,"pm:drawend",{shape:this._shape},s,l)},_fireCreate(s,l="Draw",h={}){this.__fire(this._map,"pm:create",{shape:this._shape,marker:s,layer:s},l,h)},_fireCenterPlaced(s="Draw",l={}){let h=s==="Draw"?this._layer:void 0,g=s!=="Draw"?this._layer:void 0;this.__fire(this._layer,"pm:centerplaced",{shape:this._shape,workingLayer:h,layer:g,latlng:this._layer.getLatLng()},s,l)},_fireCut(s,l,h,g="Draw",y={}){this.__fire(s,"pm:cut",{shape:this._shape,layer:l,originalLayer:h},g,y)},_fireEdit(s=this._layer,l="Edit",h={}){this.__fire(s,"pm:edit",{layer:this._layer,shape:this.getShape()},l,h)},_fireEnable(s="Edit",l={}){this.__fire(this._layer,"pm:enable",{layer:this._layer,shape:this.getShape()},s,l)},_fireDisable(s="Edit",l={}){this.__fire(this._layer,"pm:disable",{layer:this._layer,shape:this.getShape()},s,l)},_fireUpdate(s="Edit",l={}){this.__fire(this._layer,"pm:update",{layer:this._layer,shape:this.getShape()},s,l)},_fireMarkerDragStart(s,l=void 0,h="Edit",g={}){this.__fire(this._layer,"pm:markerdragstart",{layer:this._layer,markerEvent:s,shape:this.getShape(),indexPath:l},h,g)},_fireMarkerDrag(s,l=void 0,h="Edit",g={}){this.__fire(this._layer,"pm:markerdrag",{layer:this._layer,markerEvent:s,shape:this.getShape(),indexPath:l},h,g)},_fireMarkerDragEnd(s,l=void 0,h=void 0,g="Edit",y={}){this.__fire(this._layer,"pm:markerdragend",{layer:this._layer,markerEvent:s,shape:this.getShape(),indexPath:l,intersectionReset:h},g,y)},_fireDragStart(s="Edit",l={}){this.__fire(this._layer,"pm:dragstart",{layer:this._layer,shape:this.getShape()},s,l)},_fireDrag(s,l="Edit",h={}){this.__fire(this._layer,"pm:drag",{...s,shape:this.getShape()},l,h)},_fireDragEnd(s="Edit",l={}){this.__fire(this._layer,"pm:dragend",{layer:this._layer,shape:this.getShape()},s,l)},_fireDragEnable(s="Edit",l={}){this.__fire(this._layer,"pm:dragenable",{layer:this._layer,shape:this.getShape()},s,l)},_fireDragDisable(s="Edit",l={}){this.__fire(this._layer,"pm:dragdisable",{layer:this._layer,shape:this.getShape()},s,l)},_fireRemove(s,l=s,h="Edit",g={}){this.__fire(s,"pm:remove",{layer:l,shape:this.getShape()},h,g)},_fireVertexAdded(s,l,h,g="Edit",y={}){this.__fire(this._layer,"pm:vertexadded",{layer:this._layer,workingLayer:this._layer,marker:s,indexPath:l,latlng:h,shape:this.getShape()},g,y)},_fireVertexRemoved(s,l,h="Edit",g={}){this.__fire(this._layer,"pm:vertexremoved",{layer:this._layer,marker:s,indexPath:l,shape:this.getShape()},h,g)},_fireVertexClick(s,l,h="Edit",g={}){this.__fire(this._layer,"pm:vertexclick",{layer:this._layer,markerEvent:s,indexPath:l,shape:this.getShape()},h,g)},_fireIntersect(s,l=this._layer,h="Edit",g={}){this.__fire(l,"pm:intersect",{layer:this._layer,intersection:s,shape:this.getShape()},h,g)},_fireLayerReset(s,l,h="Edit",g={}){this.__fire(this._layer,"pm:layerreset",{layer:this._layer,markerEvent:s,indexPath:l,shape:this.getShape()},h,g)},_fireChange(s,l="Edit",h={}){this.__fire(this._layer,"pm:change",{layer:this._layer,latlngs:s,shape:this.getShape()},l,h)},_fireTextChange(s,l="Edit",h={}){this.__fire(this._layer,"pm:textchange",{layer:this._layer,text:s,shape:this.getShape()},l,h)},_fireTextFocus(s="Edit",l={}){this.__fire(this._layer,"pm:textfocus",{layer:this._layer,shape:this.getShape()},s,l)},_fireTextBlur(s="Edit",l={}){this.__fire(this._layer,"pm:textblur",{layer:this._layer,shape:this.getShape()},s,l)},_fireSnapDrag(s,l,h="Snapping",g={}){this.__fire(s,"pm:snapdrag",l,h,g)},_fireSnap(s,l,h="Snapping",g={}){this.__fire(s,"pm:snap",l,h,g)},_fireUnsnap(s,l,h="Snapping",g={}){this.__fire(s,"pm:unsnap",l,h,g)},_fireRotationEnable(s,l,h="Rotation",g={}){this.__fire(s,"pm:rotateenable",{layer:this._layer,helpLayer:this._rotatePoly,shape:this.getShape()},h,g)},_fireRotationDisable(s,l="Rotation",h={}){this.__fire(s,"pm:rotatedisable",{layer:this._layer,shape:this.getShape()},l,h)},_fireRotationStart(s,l,h="Rotation",g={}){this.__fire(s,"pm:rotatestart",{layer:this._rotationLayer,helpLayer:this._layer,startAngle:this._startAngle,originLatLngs:l},h,g)},_fireRotation(s,l,h,g=this._rotationLayer,y="Rotation",S={}){this.__fire(s,"pm:rotate",{layer:g,helpLayer:this._layer,startAngle:this._startAngle,angle:g.pm.getAngle(),angleDiff:l,oldLatLngs:h,newLatLngs:g.getLatLngs()},y,S)},_fireRotationEnd(s,l,h,g="Rotation",y={}){this.__fire(s,"pm:rotateend",{layer:this._rotationLayer,helpLayer:this._layer,startAngle:l,angle:this._rotationLayer.pm.getAngle(),originLatLngs:h,newLatLngs:this._rotationLayer.getLatLngs()},g,y)},_fireActionClick(s,l,h,g="Toolbar",y={}){this.__fire(this._map,"pm:actionclick",{text:s.text,action:s,btnName:l,button:h},g,y)},_fireButtonClick(s,l,h="Toolbar",g={}){this.__fire(this._map,"pm:buttonclick",{btnName:s,button:l},h,g)},_fireLangChange(s,l,h,g,y="Global",S={}){this.__fire(this.map,"pm:langchange",{oldLang:s,activeLang:l,fallback:h,translations:g},y,S)},_fireGlobalDragModeToggled(s,l="Global",h={}){this.__fire(this.map,"pm:globaldragmodetoggled",{enabled:s,map:this.map},l,h)},_fireGlobalEditModeToggled(s,l="Global",h={}){this.__fire(this.map,"pm:globaleditmodetoggled",{enabled:s,map:this.map},l,h)},_fireGlobalRemovalModeToggled(s,l="Global",h={}){this.__fire(this.map,"pm:globalremovalmodetoggled",{enabled:s,map:this.map},l,h)},_fireGlobalCutModeToggled(s="Global",l={}){this.__fire(this._map,"pm:globalcutmodetoggled",{enabled:!!this._enabled,map:this._map},s,l)},_fireGlobalDrawModeToggled(s="Global",l={}){this.__fire(this._map,"pm:globaldrawmodetoggled",{enabled:this._enabled,shape:this._shape,map:this._map},s,l)},_fireGlobalRotateModeToggled(s="Global",l={}){this.__fire(this.map,"pm:globalrotatemodetoggled",{enabled:this.globalRotateModeEnabled(),map:this.map},s,l)},_fireRemoveLayerGroup(s,l=s,h="Edit",g={}){this.__fire(s,"pm:remove",{layer:l,shape:void 0},h,g)},_fireKeyeventEvent(s,l,h,g="Global",y={}){this.__fire(this.map,"pm:keyevent",{event:s,eventType:l,focusOn:h},g,y)},__fire(s,l,h,g,y={}){h=(0,fa.default)(h,y,{source:g}),L.PM.Utils._fireEvent(s,l,h)}},$o=_o,Fa=()=>({_lastEvents:{keydown:void 0,keyup:void 0,current:void 0},_initKeyListener(s){this.map=s,L.DomEvent.on(document,"keydown keyup",this._onKeyListener,this),L.DomEvent.on(window,"blur",this._onBlur,this),s.once("unload",this._unbindKeyListenerEvents,this)},_unbindKeyListenerEvents(){L.DomEvent.off(document,"keydown keyup",this._onKeyListener,this),L.DomEvent.off(window,"blur",this._onBlur,this)},_onKeyListener(s){let l="document";this.map.getContainer().contains(s.target)&&(l="map");let h={event:s,eventType:s.type,focusOn:l};this._lastEvents[s.type]=h,this._lastEvents.current=h,this.map.pm._fireKeyeventEvent(s,s.type,l)},_onBlur(s){s.altKey=!1;let l={event:s,eventType:s.type,focusOn:"document"};this._lastEvents[s.type]=l,this._lastEvents.current=l},getLastKeyEvent(s="current"){return this._lastEvents[s]},isShiftKeyPressed(){var s;return(s=this._lastEvents.current)==null?void 0:s.event.shiftKey},isAltKeyPressed(){var s;return(s=this._lastEvents.current)==null?void 0:s.event.altKey},isCtrlKeyPressed(){var s;return(s=this._lastEvents.current)==null?void 0:s.event.ctrlKey},isMetaKeyPressed(){var s;return(s=this._lastEvents.current)==null?void 0:s.event.metaKey},getPressedKey(){var s;return(s=this._lastEvents.current)==null?void 0:s.event.key}}),In=Fa,ja=f(cr());function dn(s){let l=L.PM.activeLang;return(0,ja.default)(Kr[l],s)||(0,ja.default)(Kr.en,s)||s}function br(s){for(let l=0;l<s.length;l+=1){let h=s[l];if(Array.isArray(h)){if(br(h))return!0}else if(h!=null&&h!=="")return!0}return!1}function qo(s){return s.reduce((l,h)=>{if(h.length!==0){let g=Array.isArray(h)?qo(h):h;Array.isArray(g)?g.length!==0&&l.push(g):l.push(g)}return l},[])}function bo(s,l,h){let g={a:L.CRS.Earth.R,b:63567523142e-4,f:.0033528106647474805},{a:y,b:S,f:B}=g,D=s.lng,Y=s.lat,le=h,Oe=Math.PI,Te=l*Oe/180,it=Math.sin(Te),pt=Math.cos(Te),Tt=(1-B)*Math.tan(Y*Oe/180),qt=1/Math.sqrt(1+Tt*Tt),Vt=Tt*qt,bn=Math.atan2(Tt,pt),Re=qt*it,qe=1-Re*Re,Je=qe*(y*y-S*S)/(S*S),yt=1+Je/16384*(4096+Je*(-768+Je*(320-175*Je))),at=Je/1024*(256+Je*(-128+Je*(74-47*Je))),gt=le/(S*yt),X=2*Math.PI,de,Le,we;for(;Math.abs(gt-X)>1e-12;){de=Math.cos(2*bn+gt),Le=Math.sin(gt),we=Math.cos(gt);let Rt=at*Le*(de+at/4*(we*(-1+2*de*de)-at/6*de*(-3+4*Le*Le)*(-3+4*de*de)));X=gt,gt=le/(S*yt)+Rt}let Ce=Vt*Le-qt*we*pt,ke=Math.atan2(Vt*we+qt*Le*pt,(1-B)*Math.sqrt(Re*Re+Ce*Ce)),Ze=Math.atan2(Le*it,qt*we-Vt*Le*pt),He=B/16*qe*(4+B*(4-3*qe)),Xe=Ze-(1-He)*B*Re*(gt+He*Le*(de+He*we*(-1+2*de*de))),ht=D+Xe*180/Oe,ct=ke*180/Oe;return L.latLng(ht,ct)}function Er(s,l,h,g,y=!0){let S,B,D,Y=[];for(let le=0;le<h;le+=1){if(y)S=le*360/h+g,B=bo(s,S,l),D=L.latLng(B.lng,B.lat);else{let Oe=s.lat+Math.cos(2*le*Math.PI/h)*l,Te=s.lng+Math.sin(2*le*Math.PI/h)*l;D=L.latLng(Oe,Te)}Y.push(D)}return Y}function za(s,l,h){l=(l+360)%360;let g=Math.PI/180,y=180/Math.PI,{R:S}=L.CRS.Earth,B=s.lng*g,D=s.lat*g,Y=l*g,le=Math.sin(D),Oe=Math.cos(D),Te=Math.cos(h/S),it=Math.sin(h/S),pt=Math.asin(le*Te+Oe*it*Math.cos(Y)),Tt=B+Math.atan2(Math.sin(Y)*it*Oe,Te-le*Math.sin(pt));Tt*=y;let qt=Tt-360,Vt=Tt<-180?Tt+360:Tt;return Tt=Tt>180?qt:Vt,L.latLng([pt*y,Tt])}function Ds(s,l,h){let g=s.latLngToContainerPoint(l),y=s.latLngToContainerPoint(h),S=Math.atan2(y.y-g.y,y.x-g.x)*180/Math.PI+90;return S+=S<0?360:0,S}function pa(s,l,h,g){let y=Ds(s,l,h);return za(l,y,g)}function ga(s,l,h="asc"){if(!l||Object.keys(l).length===0)return(Y,le)=>Y-le;let g=Object.keys(l),y,S=g.length-1,B={};for(;S>=0;)y=g[S],B[y.toLowerCase()]=l[y],S-=1;function D(Y){if(Y instanceof L.Marker)return"Marker";if(Y instanceof L.Circle)return"Circle";if(Y instanceof L.CircleMarker)return"CircleMarker";if(Y instanceof L.Rectangle)return"Rectangle";if(Y instanceof L.Polygon)return"Polygon";if(Y instanceof L.Polyline)return"Line"}return(Y,le)=>{let Oe,Te;if(Oe=D(Y.layer).toLowerCase(),Te=D(le.layer).toLowerCase(),!Oe||!Te)return 0;let it=Oe in B?B[Oe]:Number.MAX_SAFE_INTEGER,pt=Te in B?B[Te]:Number.MAX_SAFE_INTEGER,Tt=0;return it<pt?Tt=-1:it>pt&&(Tt=1),h==="desc"?Tt*-1:Tt}}function Yr(s,l=s.getLatLngs()){return s instanceof L.Polygon?L.polygon(l).getLatLngs():L.polyline(l).getLatLngs()}function ma(s,l){var h,g,y,S;if((g=(h=l.options.crs)==null?void 0:h.projection)!=null&&g.MAX_LATITUDE){let B=(S=(y=l.options.crs)==null?void 0:y.projection)==null?void 0:S.MAX_LATITUDE;s.lat=Math.max(Math.min(B,s.lat),-B)}return s}function qi(s){return s.options.renderer||s._map&&(s._map._getPaneRenderer(s.options.pane)||s._map.options.renderer||s._map._renderer)||s._renderer}var al=L.Class.extend({includes:[Ia,Mi,eo,Uo,$o],initialize(s){this.map=s,this.Draw=new L.PM.Draw(s),this.Toolbar=new L.PM.Toolbar(s),this.Keyboard=In(),this.globalOptions={snappable:!0,layerGroup:void 0,snappingOrder:["Marker","CircleMarker","Circle","Line","Polygon","Rectangle"],panes:{vertexPane:"markerPane",layerPane:"overlayPane",markerPane:"markerPane"},draggable:!0},this.Keyboard._initKeyListener(s)},setLang(s="en",l,h="en"){if(s=s.trim().toLowerCase(),!/^[a-z]{2}$/.test(s)){let y=s.replace(/[-_\s]/g,"-").replace(/^(\w{2})$/,"$1-").match(/([a-z]{2})-?([a-z]{2})?/);if(y){let S=[`${y[1]}_${y[2]}`,`${y[1]}`];for(let B of S)if(Kr[B]){s=B;break}}}let g=L.PM.activeLang;l&&(Kr[s]=(0,xn.default)(Kr[h],l)),L.PM.activeLang=s,this.map.pm.Toolbar.reinit(),this._fireLangChange(g,s,h,Kr[s])},addControls(s){this.Toolbar.addControls(s)},removeControls(){this.Toolbar.removeControls()},toggleControls(){this.Toolbar.toggleControls()},controlsVisible(){return this.Toolbar.isVisible},enableDraw(s="Polygon",l){s==="Poly"&&(s="Polygon"),this.Draw.enable(s,l)},disableDraw(s="Polygon"){s==="Poly"&&(s="Polygon"),this.Draw.disable(s)},setPathOptions(s,l={}){let h=l.ignoreShapes||[],g=l.merge||!1;this.map.pm.Draw.shapes.forEach(y=>{h.indexOf(y)===-1&&this.map.pm.Draw[y].setPathOptions(s,g)})},getGlobalOptions(){return this.globalOptions},setGlobalOptions(s){let l=(0,xn.default)(this.globalOptions,s);l.editable&&(l.resizeableCircleMarker=l.editable,delete l.editable);let h=!1;this.map.pm.Draw.CircleMarker.enabled()&&!!this.map.pm.Draw.CircleMarker.options.resizeableCircleMarker!=!!l.resizeableCircleMarker&&(this.map.pm.Draw.CircleMarker.disable(),h=!0);let g=!1;this.map.pm.Draw.Circle.enabled()&&!!this.map.pm.Draw.Circle.options.resizeableCircle!=!!l.resizeableCircle&&(this.map.pm.Draw.Circle.disable(),g=!0),this.map.pm.Draw.shapes.forEach(y=>{this.map.pm.Draw[y].setOptions(l)}),h&&this.map.pm.Draw.CircleMarker.enable(),g&&this.map.pm.Draw.Circle.enable(),L.PM.Utils.findLayers(this.map).forEach(y=>{y.pm.setOptions(l)}),this.map.fire("pm:globaloptionschanged"),this.globalOptions=l,this.applyGlobalOptions()},applyGlobalOptions(){L.PM.Utils.findLayers(this.map).forEach(s=>{s.pm.enabled()&&s.pm.applyOptions()})},globalDrawModeEnabled(){return!!this.Draw.getActiveShape()},globalCutModeEnabled(){return!!this.Draw.Cut.enabled()},enableGlobalCutMode(s){return this.Draw.Cut.enable(s)},toggleGlobalCutMode(s){return this.Draw.Cut.toggle(s)},disableGlobalCutMode(){return this.Draw.Cut.disable()},getGeomanLayers(s=!1){let l=L.PM.Utils.findLayers(this.map);if(!s)return l;let h=L.featureGroup();return h._pmTempLayer=!0,l.forEach(g=>{h.addLayer(g)}),h},getGeomanDrawLayers(s=!1){let l=L.PM.Utils.findLayers(this.map).filter(g=>g._drawnByGeoman===!0);if(!s)return l;let h=L.featureGroup();return h._pmTempLayer=!0,l.forEach(g=>{h.addLayer(g)}),h},_getContainingLayer(){return this.globalOptions.layerGroup&&this.globalOptions.layerGroup instanceof L.LayerGroup?this.globalOptions.layerGroup:this.map},_isCRSSimple(){return this.map.options.crs===L.CRS.Simple},_touchEventCounter:0,_addTouchEvents(s){this._touchEventCounter===0&&(L.DomEvent.on(s,"touchmove",this._canvasTouchMove,this),L.DomEvent.on(s,"touchstart touchend touchcancel",this._canvasTouchClick,this)),this._touchEventCounter+=1},_removeTouchEvents(s){this._touchEventCounter===1&&(L.DomEvent.off(s,"touchmove",this._canvasTouchMove,this),L.DomEvent.off(s,"touchstart touchend touchcancel",this._canvasTouchClick,this)),this._touchEventCounter=this._touchEventCounter<=1?0:this._touchEventCounter-1},_canvasTouchMove(s){qi(this.map)._onMouseMove(this._createMouseEvent("mousemove",s))},_canvasTouchClick(s){let l="";s.type==="touchstart"||s.type==="pointerdown"?l="mousedown":(s.type==="touchend"||s.type==="pointerup"||s.type==="touchcancel"||s.type==="pointercancel")&&(l="mouseup"),l&&qi(this.map)._onClick(this._createMouseEvent(l,s))},_createMouseEvent(s,l){let h,g=l.touches[0]||l.changedTouches[0];try{h=new MouseEvent(s,{bubbles:l.bubbles,cancelable:l.cancelable,view:l.view,detail:g.detail,screenX:g.screenX,screenY:g.screenY,clientX:g.clientX,clientY:g.clientY,ctrlKey:l.ctrlKey,altKey:l.altKey,shiftKey:l.shiftKey,metaKey:l.metaKey,button:l.button,relatedTarget:l.relatedTarget})}catch{h=document.createEvent("MouseEvents"),h.initMouseEvent(s,l.bubbles,l.cancelable,l.view,g.detail,g.screenX,g.screenY,g.clientX,g.clientY,l.ctrlKey,l.altKey,l.shiftKey,l.metaKey,l.button,l.relatedTarget)}return h}}),Vo=al,Jr=L.Control.extend({includes:[$o],options:{position:"topleft",disableByOtherButtons:!0},initialize(s){this._button=L.Util.extend({},this.options,s)},onAdd(s){return this._map=s,this._map.pm.Toolbar.options.oneBlock?this._container=this._map.pm.Toolbar._createContainer(this.options.position):this._button.tool==="edit"?this._container=this._map.pm.Toolbar.editContainer:this._button.tool==="options"?this._container=this._map.pm.Toolbar.optionsContainer:this._button.tool==="custom"?this._container=this._map.pm.Toolbar.customContainer:this._container=this._map.pm.Toolbar.drawContainer,this._renderButton(),this._container},_renderButton(){let s=this.buttonsDomNode;this.buttonsDomNode=this._makeButton(this._button),s?s.replaceWith(this.buttonsDomNode):this._container.appendChild(this.buttonsDomNode)},onRemove(){return this.buttonsDomNode.remove(),this._container},getText(){return this._button.text},getIconUrl(){return this._button.iconUrl},destroy(){this._button={},this._update()},toggle(s){return typeof s=="boolean"?this._button.toggleStatus=s:this._button.toggleStatus=!this._button.toggleStatus,this._applyStyleClasses(),this._updateActiveAction(this._button),this._button.toggleStatus},toggled(){return this._button.toggleStatus},onCreate(){this.toggle(!1)},disable(){this.toggle(!1),this._button.disabled=!0,this._updateDisabled()},enable(){this._button.disabled=!1,this._updateDisabled(),this._updateActiveAction(this._button)},_triggerClick(s){s&&s.preventDefault(),!this._button.disabled&&(this._button.onClick(s,{button:this,event:s}),this._clicked(s),this._button.afterClick(s,{button:this,event:s}))},_makeButton(s){let l=this.options.position.indexOf("right")>-1?"pos-right":"",h=L.DomUtil.create("div",`button-container  ${l}`,this._container);s.title&&h.setAttribute("title",s.title);let g=L.DomUtil.create("a","leaflet-buttons-control-button",h);g.setAttribute("role","button"),g.setAttribute("tabindex","0"),g.href="#";let y=L.DomUtil.create("div",`leaflet-pm-actions-container ${l}`,h),S=s.actions,B={cancel:{text:dn("actions.cancel"),title:dn("actions.cancel"),onClick(){this._triggerClick()}},finishMode:{text:dn("actions.finish"),title:dn("actions.finish"),onClick(){this._triggerClick()}},removeLastVertex:{text:dn("actions.removeLastVertex"),title:dn("actions.removeLastVertex"),onClick(){this._map.pm.Draw[s.jsClass]._removeLastVertex()}},finish:{text:dn("actions.finish"),title:dn("actions.finish"),onClick(Y){this._map.pm.Draw[s.jsClass]._finishShape(Y)}}};s._preparedActions=S.map(Y=>{let le=typeof Y=="string"?Y:Y.name,Oe;if(B[le])Oe=B[le];else if(Y.text)Oe=Y;else return Oe;let Te=L.DomUtil.create("a",`leaflet-pm-action ${l} action-${le}`,y);if(Te.setAttribute("role","button"),Te.setAttribute("tabindex","0"),Te.href="#",Oe.title&&(Te.title=Oe.title),Te.innerHTML=Oe.text,L.DomEvent.disableClickPropagation(Te),L.DomEvent.on(Te,"click",L.DomEvent.stop),Oe._node=Te,!s.disabled&&Oe.onClick){let it=pt=>{pt.preventDefault();let Tt="",{buttons:qt}=this._map.pm.Toolbar;for(let Vt in qt)if(qt[Vt]._button===s){Tt=Vt;break}this._fireActionClick(Oe,Tt,s)};L.DomEvent.addListener(Te,"click",it,this),L.DomEvent.addListener(Te,"click",Oe.onClick,this),L.DomEvent.addListener(Te,"click",()=>this._updateActiveAction(s))}return Oe}),this._updateActiveAction(s),s.toggleStatus&&L.DomUtil.addClass(h,"active");let D=L.DomUtil.create("div","control-icon",g);return s.iconUrl&&D.setAttribute("src",s.iconUrl),s.className&&L.DomUtil.addClass(D,s.className),L.DomEvent.disableClickPropagation(g),L.DomEvent.on(g,"click",L.DomEvent.stop),s.disabled||(L.DomEvent.addListener(g,"click",this._onBtnClick,this),L.DomEvent.addListener(g,"click",this._triggerClick,this)),s.disabled&&(L.DomUtil.addClass(g,"pm-disabled"),g.setAttribute("aria-disabled","true")),h},_applyStyleClasses(){this._container&&(!this._button.toggleStatus||this._button.cssToggle===!1?(L.DomUtil.removeClass(this.buttonsDomNode,"active"),L.DomUtil.removeClass(this._container,"activeChild")):(L.DomUtil.addClass(this.buttonsDomNode,"active"),L.DomUtil.addClass(this._container,"activeChild")))},_onBtnClick(){if(this._button.disabled)return;this._button.disableOtherButtons&&this._map.pm.Toolbar.triggerClickOnToggledButtons(this);let s="",{buttons:l}=this._map.pm.Toolbar;for(let h in l)if(l[h]._button===this._button){s=h;break}this._fireButtonClick(s,this._button)},_clicked(){this._button.doToggle&&this.toggle()},_updateDisabled(){if(!this._container)return;let s="pm-disabled",l=this.buttonsDomNode.children[0];this._button.disabled?(L.DomUtil.addClass(l,s),l.setAttribute("aria-disabled","true")):(L.DomUtil.removeClass(l,s),l.setAttribute("aria-disabled","false"))},_updateActiveAction(s){var l;(l=s._preparedActions)==null||l.forEach(h=>{h!=null&&h._node&&(h.isActive&&h.isActive.call(this)?L.DomUtil.addClass(h._node,"active-action"):L.DomUtil.removeClass(h._node,"active-action"))})}}),va=Jr;L.Control.PMButton=va;var Ua=L.Class.extend({options:{drawMarker:!0,drawRectangle:!0,drawPolyline:!0,drawPolygon:!0,drawCircle:!0,drawCircleMarker:!0,drawText:!0,editMode:!0,dragMode:!0,cutPolygon:!0,removalMode:!0,rotateMode:!0,snappingOption:!0,drawControls:!0,editControls:!0,optionsControls:!0,customControls:!0,oneBlock:!1,position:"topleft",positions:{draw:"",edit:"",options:"",custom:""}},customButtons:[],initialize(s){this.customButtons=[],this.options.positions={draw:"",edit:"",options:"",custom:""},this.init(s)},reinit(){let s=this.isVisible;this.removeControls(),this._defineButtons(),s&&this.addControls()},init(s){this.map=s,this.buttons={},this.isVisible=!1,this.drawContainer=L.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-draw leaflet-bar leaflet-control"),this.editContainer=L.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-edit leaflet-bar leaflet-control"),this.optionsContainer=L.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-options leaflet-bar leaflet-control"),this.customContainer=L.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-custom leaflet-bar leaflet-control"),this._defineButtons()},_createContainer(s){let l=`${s}Container`;return this[l]||(this[l]=L.DomUtil.create("div",`leaflet-pm-toolbar leaflet-pm-${s} leaflet-bar leaflet-control`)),this[l]},getButtons(){return this.buttons},addControls(s=this.options){typeof s.editPolygon<"u"&&(s.editMode=s.editPolygon),typeof s.deleteLayer<"u"&&(s.removalMode=s.deleteLayer),L.Util.setOptions(this,s),this.applyIconStyle(),this.isVisible=!0,this._showHideButtons()},applyIconStyle(){let s=this.getButtons(),l={geomanIcons:{drawMarker:"control-icon leaflet-pm-icon-marker",drawPolyline:"control-icon leaflet-pm-icon-polyline",drawRectangle:"control-icon leaflet-pm-icon-rectangle",drawPolygon:"control-icon leaflet-pm-icon-polygon",drawCircle:"control-icon leaflet-pm-icon-circle",drawCircleMarker:"control-icon leaflet-pm-icon-circle-marker",editMode:"control-icon leaflet-pm-icon-edit",dragMode:"control-icon leaflet-pm-icon-drag",cutPolygon:"control-icon leaflet-pm-icon-cut",removalMode:"control-icon leaflet-pm-icon-delete",drawText:"control-icon leaflet-pm-icon-text"}};for(let h in s){let g=s[h];L.Util.setOptions(g,{className:l.geomanIcons[h]})}},removeControls(){let s=this.getButtons();for(let l in s)s[l].remove();this.isVisible=!1},toggleControls(s=this.options){this.isVisible?this.removeControls():this.addControls(s)},_addButton(s,l){return this.buttons[s]=l,this.options[s]=!!this.options[s]||!1,this.buttons[s]},triggerClickOnToggledButtons(s){for(let l in this.buttons){let h=this.buttons[l];h._button.disableByOtherButtons&&h!==s&&h.toggled()&&h._triggerClick()}},toggleButton(s,l,h=!0){s==="editPolygon"&&(s="editMode"),s==="deleteLayer"&&(s="removalMode");let g=s;return h&&this.triggerClickOnToggledButtons(this.buttons[g]),this.buttons[g]?this.buttons[g].toggle(l):!1},_defineButtons(){let s={className:"control-icon leaflet-pm-icon-marker",title:dn("buttonTitles.drawMarkerButton"),jsClass:"Marker",onClick:()=>{},afterClick:(it,pt)=>{this.map.pm.Draw[pt.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]},l={title:dn("buttonTitles.drawPolyButton"),className:"control-icon leaflet-pm-icon-polygon",jsClass:"Polygon",onClick:()=>{},afterClick:(it,pt)=>{this.map.pm.Draw[pt.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["finish","removeLastVertex","cancel"]},h={className:"control-icon leaflet-pm-icon-polyline",title:dn("buttonTitles.drawLineButton"),jsClass:"Line",onClick:()=>{},afterClick:(it,pt)=>{this.map.pm.Draw[pt.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["finish","removeLastVertex","cancel"]},g={title:dn("buttonTitles.drawCircleButton"),className:"control-icon leaflet-pm-icon-circle",jsClass:"Circle",onClick:()=>{},afterClick:(it,pt)=>{this.map.pm.Draw[pt.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]},y={title:dn("buttonTitles.drawCircleMarkerButton"),className:"control-icon leaflet-pm-icon-circle-marker",jsClass:"CircleMarker",onClick:()=>{},afterClick:(it,pt)=>{this.map.pm.Draw[pt.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]},S={title:dn("buttonTitles.drawRectButton"),className:"control-icon leaflet-pm-icon-rectangle",jsClass:"Rectangle",onClick:()=>{},afterClick:(it,pt)=>{this.map.pm.Draw[pt.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]},B={title:dn("buttonTitles.editButton"),className:"control-icon leaflet-pm-icon-edit",onClick:()=>{},afterClick:()=>{this.map.pm.toggleGlobalEditMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finishMode"]},D={title:dn("buttonTitles.dragButton"),className:"control-icon leaflet-pm-icon-drag",onClick:()=>{},afterClick:()=>{this.map.pm.toggleGlobalDragMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finishMode"]},Y={title:dn("buttonTitles.cutButton"),className:"control-icon leaflet-pm-icon-cut",jsClass:"Cut",onClick:()=>{},afterClick:(it,pt)=>{this.map.pm.Draw[pt.button._button.jsClass].toggle({snappable:!0,cursorMarker:!0,allowSelfIntersection:!1})},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finish","removeLastVertex","cancel"]},le={title:dn("buttonTitles.deleteButton"),className:"control-icon leaflet-pm-icon-delete",onClick:()=>{},afterClick:()=>{this.map.pm.toggleGlobalRemovalMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finishMode"]},Oe={title:dn("buttonTitles.rotateButton"),className:"control-icon leaflet-pm-icon-rotate",onClick:()=>{},afterClick:()=>{this.map.pm.toggleGlobalRotateMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finishMode"]},Te={className:"control-icon leaflet-pm-icon-text",title:dn("buttonTitles.drawTextButton"),jsClass:"Text",onClick:()=>{},afterClick:(it,pt)=>{this.map.pm.Draw[pt.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]};this._addButton("drawMarker",new L.Control.PMButton(s)),this._addButton("drawPolyline",new L.Control.PMButton(h)),this._addButton("drawRectangle",new L.Control.PMButton(S)),this._addButton("drawPolygon",new L.Control.PMButton(l)),this._addButton("drawCircle",new L.Control.PMButton(g)),this._addButton("drawCircleMarker",new L.Control.PMButton(y)),this._addButton("drawText",new L.Control.PMButton(Te)),this._addButton("editMode",new L.Control.PMButton(B)),this._addButton("dragMode",new L.Control.PMButton(D)),this._addButton("cutPolygon",new L.Control.PMButton(Y)),this._addButton("removalMode",new L.Control.PMButton(le)),this._addButton("rotateMode",new L.Control.PMButton(Oe))},_showHideButtons(){if(!this.isVisible)return;this.removeControls(),this.isVisible=!0;let s=this.getButtons(),l=[];this.options.drawControls===!1&&(l=l.concat(Object.keys(s).filter(h=>!s[h]._button.tool))),this.options.editControls===!1&&(l=l.concat(Object.keys(s).filter(h=>s[h]._button.tool==="edit"))),this.options.optionsControls===!1&&(l=l.concat(Object.keys(s).filter(h=>s[h]._button.tool==="options"))),this.options.customControls===!1&&(l=l.concat(Object.keys(s).filter(h=>s[h]._button.tool==="custom")));for(let h in s)if(this.options[h]&&l.indexOf(h)===-1){let g=s[h]._button.tool;g||(g="draw"),s[h].setPosition(this._getBtnPosition(g)),s[h].addTo(this.map)}},_getBtnPosition(s){return this.options.positions&&this.options.positions[s]?this.options.positions[s]:this.options.position},setBlockPosition(s,l){this.options.positions[s]=l,this._showHideButtons(),this.changeControlOrder()},getBlockPositions(){return this.options.positions},copyDrawControl(s,l){if(l)typeof l!="object"&&(l={name:l});else throw new TypeError("Button has no name");let h=this._btnNameMapping(s);if(!l.name)throw new TypeError("Button has no name");if(this.buttons[l.name])throw new TypeError("Button with this name already exists");let g=this.map.pm.Draw.createNewDrawInstance(l.name,h);l={...this.buttons[h]._button,...l};let y=this.createCustomControl(l);return{drawInstance:g,control:y}},createCustomControl(s){if(!s.name)throw new TypeError("Button has no name");if(this.buttons[s.name])throw new TypeError("Button with this name already exists");s.onClick||(s.onClick=()=>{}),s.afterClick||(s.afterClick=()=>{}),s.toggle!==!1&&(s.toggle=!0),s.block&&(s.block=s.block.toLowerCase()),(!s.block||s.block==="draw")&&(s.block=""),s.className?s.className.indexOf("control-icon")===-1&&(s.className=`control-icon ${s.className}`):s.className="control-icon";let l={tool:s.block,className:s.className,title:s.title||"",jsClass:s.name,onClick:s.onClick,afterClick:s.afterClick,doToggle:s.toggle,toggleStatus:!1,disableOtherButtons:s.disableOtherButtons??!0,disableByOtherButtons:s.disableByOtherButtons??!0,cssToggle:s.toggle,position:this.options.position,actions:s.actions||[],disabled:!!s.disabled};this.options[s.name]!==!1&&(this.options[s.name]=!0);let h=this._addButton(s.name,new L.Control.PMButton(l));return this.changeControlOrder(),h},controlExists(s){return!!this.getButton(s)},getButton(s){return this.getButtons()[s]},getButtonsInBlock(s){let l={};if(s)for(let h in this.getButtons()){let g=this.getButtons()[h];(g._button.tool===s||s==="draw"&&!g._button.tool)&&(l[h]=g)}return l},changeControlOrder(s=[]){let l=this._shapeMapping(),h=[];s.forEach(S=>{l[S]?h.push(l[S]):h.push(S)});let g=this.getButtons(),y={};h.forEach(S=>{g[S]&&(y[S]=g[S])}),Object.keys(g).filter(S=>!g[S]._button.tool||g[S]._button.tool==="draw").forEach(S=>{h.indexOf(S)===-1&&(y[S]=g[S])}),Object.keys(g).filter(S=>g[S]._button.tool==="edit").forEach(S=>{h.indexOf(S)===-1&&(y[S]=g[S])}),Object.keys(g).filter(S=>g[S]._button.tool==="options").forEach(S=>{h.indexOf(S)===-1&&(y[S]=g[S])}),Object.keys(g).filter(S=>g[S]._button.tool==="custom").forEach(S=>{h.indexOf(S)===-1&&(y[S]=g[S])}),Object.keys(g).forEach(S=>{h.indexOf(S)===-1&&(y[S]=g[S])}),this.map.pm.Toolbar.buttons=y,this._showHideButtons()},getControlOrder(){let s=this.getButtons(),l=[];for(let h in s)l.push(h);return l},changeActionsOfControl(s,l){let h=this._btnNameMapping(s);if(!h)throw new TypeError("No name passed");if(!l)throw new TypeError("No actions passed");if(!this.buttons[h])throw new TypeError("Button with this name not exists");this.buttons[h]._button.actions=l,this.changeControlOrder()},setButtonDisabled(s,l){let h=this._btnNameMapping(s);l?this.buttons[h].disable():this.buttons[h].enable()},_shapeMapping(){return{Marker:"drawMarker",Circle:"drawCircle",Polygon:"drawPolygon",Rectangle:"drawRectangle",Polyline:"drawPolyline",Line:"drawPolyline",CircleMarker:"drawCircleMarker",Edit:"editMode",Drag:"dragMode",Cut:"cutPolygon",Removal:"removalMode",Rotate:"rotateMode",Text:"drawText"}},_btnNameMapping(s){let l=this._shapeMapping();return l[s]?l[s]:s}}),$a=Ua,ya=f(Gr()),wo={_initSnappableMarkers(){this.options.snapDistance=this.options.snapDistance||30,this.options.snapSegment=this.options.snapSegment===void 0?!0:this.options.snapSegment,this._assignEvents(this._markers),this._layer.off("pm:dragstart",this._unsnap,this),this._layer.on("pm:dragstart",this._unsnap,this)},_disableSnapping(){this._layer.off("pm:dragstart",this._unsnap,this)},_assignEvents(s){s.forEach(l=>{if(Array.isArray(l)){this._assignEvents(l);return}l.off("drag",this._handleSnapping,this),l.on("drag",this._handleSnapping,this),l.off("dragend",this._cleanupSnapping,this),l.on("dragend",this._cleanupSnapping,this)})},_cleanupSnapping(s){if(s){let l=s.target;l._snapped=!1}delete this._snapList,this.throttledList&&(this._map.off("layeradd",this.throttledList,this),this.throttledList=void 0),this._map.off("layerremove",this._handleSnapLayerRemoval,this),this.debugIndicatorLines&&this.debugIndicatorLines.forEach(l=>{l.remove()})},_handleThrottleSnapping(){this.throttledList&&this._createSnapList()},_handleSnapping(s){var D,Y,le;let l=s.target;if(l._snapped=!1,this.throttledList||(this.throttledList=L.Util.throttle(this._handleThrottleSnapping,100,this)),((D=s==null?void 0:s.originalEvent)==null?void 0:D.altKey)||((le=(Y=this._map)==null?void 0:Y.pm)==null?void 0:le.Keyboard.isAltKeyPressed())||(this._snapList===void 0&&(this._createSnapList(),this._map.off("layeradd",this.throttledList,this),this._map.on("layeradd",this.throttledList,this)),this._snapList.length<=0))return!1;let h=this._calcClosestLayer(l.getLatLng(),this._snapList);if(Object.keys(h).length===0)return!1;let g=h.layer instanceof L.Marker||h.layer instanceof L.CircleMarker||!this.options.snapSegment,y;g?y=h.latlng:y=this._checkPrioritiySnapping(h);let S=this.options.snapDistance,B={marker:l,shape:this._shape,snapLatLng:y,segment:h.segment,layer:this._layer,workingLayer:this._layer,layerInteractedWith:h.layer,distance:h.distance};if(this._fireSnapDrag(B.marker,B),this._fireSnapDrag(this._layer,B),h.distance<S){l._orgLatLng=l.getLatLng(),l.setLatLng(y),l._snapped=!0,l._snapInfo=B;let Oe=()=>{this._snapLatLng=y,this._fireSnap(l,B),this._fireSnap(this._layer,B)},Te=this._snapLatLng||{},it=y||{};(Te.lat!==it.lat||Te.lng!==it.lng)&&Oe()}else this._snapLatLng&&(this._unsnap(B),l._snapped=!1,l._snapInfo=void 0,this._fireUnsnap(B.marker,B),this._fireUnsnap(this._layer,B));return!0},_createSnapList(){let s=[],l=[],h=this._map;h.off("layerremove",this._handleSnapLayerRemoval,this),h.on("layerremove",this._handleSnapLayerRemoval,this),h.eachLayer(g=>{if((g instanceof L.Polyline||g instanceof L.Marker||g instanceof L.CircleMarker||g instanceof L.ImageOverlay)&&g.options.snapIgnore!==!0){if(g.options.snapIgnore===void 0&&(!L.PM.optIn&&g.options.pmIgnore===!0||L.PM.optIn&&g.options.pmIgnore!==!1))return;(g instanceof L.Circle||g instanceof L.CircleMarker)&&g.pm&&g.pm._hiddenPolyCircle?s.push(g.pm._hiddenPolyCircle):g instanceof L.ImageOverlay&&(g=L.rectangle(g.getBounds())),s.push(g);let y=L.polyline([],{color:"red",pmIgnore:!0});y._pmTempLayer=!0,l.push(y),(g instanceof L.Circle||g instanceof L.CircleMarker)&&l.push(y)}}),s=s.filter(g=>this._layer!==g),s=s.filter(g=>g._latlng||g._latlngs&&br(g._latlngs)),s=s.filter(g=>!g._pmTempLayer),this._otherSnapLayers?(this._otherSnapLayers.forEach(()=>{let g=L.polyline([],{color:"red",pmIgnore:!0});g._pmTempLayer=!0,l.push(g)}),this._snapList=s.concat(this._otherSnapLayers)):this._snapList=s,this.debugIndicatorLines=l},_handleSnapLayerRemoval({layer:s}){if(!s._leaflet_id)return;let l=this._snapList.findIndex(h=>h._leaflet_id===s._leaflet_id);l>-1&&this._snapList.splice(l,1)},_calcClosestLayer(s,l){return this._calcClosestLayers(s,l,1)[0]},_calcClosestLayers(s,l,h=1){let g=[],y={};l.forEach((B,D)=>{var le;if(B._parentCopy&&B._parentCopy===this._layer||((le=B.getLatLngs)==null?void 0:le.call(B).flat(5).length)<2)return;let Y=this._calcLayerDistances(s,B);if(Y.distance=Math.floor(Y.distance),this.debugIndicatorLines){if(!this.debugIndicatorLines[D]){let Oe=L.polyline([],{color:"red",pmIgnore:!0});Oe._pmTempLayer=!0,this.debugIndicatorLines[D]=Oe}this.debugIndicatorLines[D].setLatLngs([s,Y.latlng])}h===1&&(y.distance===void 0||Y.distance-5<=y.distance)?(Y.distance+5<y.distance&&(g=[]),y=Y,y.layer=B,g.push(y)):h!==1&&(y={},y=Y,y.layer=B,g.push(y))}),h!==1&&(g=g.sort((B,D)=>B.distance-D.distance)),h===-1&&(h=g.length);let S=this._getClosestLayerByPriority(g,h);return L.Util.isArray(S)?S:[S]},_calcLayerDistances(s,l){let h=this._map,g=l instanceof L.Marker||l instanceof L.CircleMarker,y=l instanceof L.Polygon,S=s;if(g){let B=l.getLatLng();return{latlng:{...B},distance:this._getDistance(h,B,S)}}return this._calcLatLngDistances(S,l.getLatLngs(),h,y)},_calcLatLngDistances(s,l,h,g=!1){let y,S,B,D=Y=>{Y.forEach((le,Oe)=>{if(Array.isArray(le)){D(le);return}if(this.options.snapSegment){let Te=le,it;g?it=Oe+1===Y.length?0:Oe+1:it=Oe+1===Y.length?void 0:Oe+1;let pt=Y[it];if(pt){let Tt=this._getDistanceToSegment(h,s,Te,pt);(S===void 0||Tt<S)&&(S=Tt,B=[Te,pt])}}else{let Te=this._getDistance(h,s,le);(S===void 0||Te<S)&&(S=Te,y=le)}})};return D(l),this.options.snapSegment?{latlng:{...this._getClosestPointOnSegment(h,s,B[0],B[1])},segment:B,distance:S}:{latlng:y,distance:S}},_getClosestLayerByPriority(s,l=1){s=s.sort((B,D)=>B._leaflet_id-D._leaflet_id);let h=["Marker","CircleMarker","Circle","Line","Polygon","Rectangle"],g=this._map.pm.globalOptions.snappingOrder||[],y=0,S={};return g.concat(h).forEach(B=>{S[B]||(y+=1,S[B]=y)}),s.sort(ga("instanceofShape",S)),l===1?s[0]||{}:s.slice(0,l)},_checkPrioritiySnapping(s){let l=this._map,h=s.segment[0],g=s.segment[1],y=s.latlng,S=y;if(this.options.snapVertex){let B=this._getDistance(l,h,y),D=this._getDistance(l,g,y),Y=B<D?h:g,le=B<D?B:D;if(this.options.snapMiddle){let Te=L.PM.Utils.calcMiddleLatLng(l,h,g),it=this._getDistance(l,Te,y);it<B&&it<D&&(Y=Te,le=it)}let Oe=this.options.snapDistance;le<Oe&&(S=Y)}return{...S}},_unsnap(){delete this._snapLatLng},_getClosestPointOnSegment(s,l,h,g){let y=s.getMaxZoom();y===1/0&&(y=s.getZoom());let S=s.project(l,y),B=s.project(h,y),D=s.project(g,y),Y=L.LineUtil.closestPointOnSegment(S,B,D);return s.unproject(Y,y)},_getDistanceToSegment(s,l,h,g){let y=s.latLngToContainerPoint(l),S=s.latLngToContainerPoint(h),B=s.latLngToContainerPoint(g);return L.LineUtil.pointToSegmentDistance(y,S,B)},_getDistance(s,l,h){return s.latLngToContainerPoint(l).distanceTo(s.latLngToContainerPoint(h))}},Go=wo,xo=L.Class.extend({includes:[Go,$o],options:{snappable:!0,snapDistance:20,snapMiddle:!1,allowSelfIntersection:!0,tooltips:!0,templineStyle:{},hintlineStyle:{color:"#3388ff",dashArray:"5,5"},pathOptions:null,cursorMarker:!0,finishOn:null,markerStyle:{draggable:!0,icon:L.icon()},hideMiddleMarkers:!1,minRadiusCircle:null,maxRadiusCircle:null,minRadiusCircleMarker:null,maxRadiusCircleMarker:null,resizeableCircleMarker:!1,resizeableCircle:!0,markerEditable:!0,continueDrawing:!1,snapSegment:!0,requireSnapToFinish:!1,rectangleAngle:0,textOptions:{text:null,focusAfterDraw:null,removeIfEmpty:null,className:null},snapVertex:!0},setOptions(s){L.Util.setOptions(this,s),this.setStyle(this.options)},setStyle(){},getOptions(){return this.options},initialize(s){let l=new L.Icon.Default;l.options.tooltipAnchor=[0,0],this.options.markerStyle.icon=l,this._map=s,this.shapes=["Marker","CircleMarker","Line","Polygon","Rectangle","Circle","Cut","Text"],this.shapes.forEach(h=>{this[h]=new L.PM.Draw[h](this._map)}),this.Marker.setOptions({continueDrawing:!0}),this.CircleMarker.setOptions({continueDrawing:!0})},setPathOptions(s,l=!1){l?this.options.pathOptions=(0,ya.default)(this.options.pathOptions,s):this.options.pathOptions=s},getShapes(){return this.shapes},getShape(){return this._shape},enable(s,l){if(!s)throw new Error(`Error: Please pass a shape as a parameter. Possible shapes are: ${this.getShapes().join(",")}`);this.disable(),this[s].enable(l)},disable(){this.shapes.forEach(s=>{this[s].disable()})},addControls(){this.shapes.forEach(s=>{this[s].addButton()})},getActiveShape(){let s;return this.shapes.forEach(l=>{this[l]._enabled&&(s=l)}),s},_setGlobalDrawMode(){this._shape==="Cut"?this._fireGlobalCutModeToggled():this._fireGlobalDrawModeToggled();let s=[];this._map.eachLayer(l=>{(l instanceof L.Polyline||l instanceof L.Marker||l instanceof L.Circle||l instanceof L.CircleMarker||l instanceof L.ImageOverlay)&&(l._pmTempLayer||s.push(l))}),this._enabled?s.forEach(l=>{L.PM.Utils.disablePopup(l)}):s.forEach(l=>{L.PM.Utils.enablePopup(l)})},createNewDrawInstance(s,l){let h=this._getShapeFromBtnName(l);if(this[s])throw new TypeError("Draw Type already exists");if(!L.PM.Draw[h])throw new TypeError(`There is no class L.PM.Draw.${h}`);return this[s]=new L.PM.Draw[h](this._map),this[s].toolbarButtonName=s,this[s]._shape=s,this.shapes.push(s),this[l]&&this[s].setOptions(this[l].options),this[s].setOptions(this[s].options),this[s]},_getShapeFromBtnName(s){let l={drawMarker:"Marker",drawCircle:"Circle",drawPolygon:"Polygon",drawPolyline:"Line",drawRectangle:"Rectangle",drawCircleMarker:"CircleMarker",editMode:"Edit",dragMode:"Drag",cutPolygon:"Cut",removalMode:"Removal",rotateMode:"Rotate",drawText:"Text"};return l[s]?l[s]:this[s]?this[s]._shape:s},_finishLayer(s){s.pm&&(s.pm.setOptions(this.options),s.pm._shape=this._shape,s.pm._map=this._map),this._addDrawnLayerProp(s)},_addDrawnLayerProp(s){s._drawnByGeoman=!0},_setPane(s,l){l==="layerPane"?s.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.layerPane||"overlayPane":l==="vertexPane"?s.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.vertexPane||"markerPane":l==="markerPane"&&(s.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.markerPane||"markerPane")},_isFirstLayer(){return(this._map||this._layer._map).pm.getGeomanLayers().length===0}}),Bi=xo;Bi.Marker=Bi.extend({initialize(s){this._map=s,this._shape="Marker",this.toolbarButtonName="drawMarker"},enable(s){L.Util.setOptions(this,s),this._enabled=!0,this._map.getContainer().classList.add("geoman-draw-cursor"),this._map.on("click",this._createMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._hintMarker=L.marker(this._map.getCenter(),this.options.markerStyle),this._setPane(this._hintMarker,"markerPane"),this._hintMarker._pmTempLayer=!0,this._hintMarker.addTo(this._map),this.options.tooltips&&this._hintMarker.bindTooltip(dn("tooltips.placeMarker"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this._layer=this._hintMarker,this._map.on("mousemove",this._syncHintMarker,this),this.options.markerEditable&&this._map.eachLayer(l=>{this.isRelevantMarker(l)&&l.pm.enable()}),this._fireDrawStart(),this._setGlobalDrawMode()},disable(){this._enabled&&(this._enabled=!1,this._map.getContainer().classList.remove("geoman-draw-cursor"),this._map.off("click",this._createMarker,this),this._hintMarker.remove(),this._map.off("mousemove",this._syncHintMarker,this),this._map.eachLayer(s=>{this.isRelevantMarker(s)&&s.pm.disable()}),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},enabled(){return this._enabled},toggle(s){this.enabled()?this.disable():this.enable(s)},isRelevantMarker(s){return s instanceof L.Marker&&s.pm&&!s._pmTempLayer&&!s.pm._initTextMarker},_syncHintMarker(s){if(this._hintMarker.setLatLng(s.latlng),this.options.snappable){let l=s;l.target=this._hintMarker,this._handleSnapping(l)}this._fireChange(this._hintMarker.getLatLng(),"Draw")},_createMarker(s){if(!s.latlng||this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;this._hintMarker._snapped||this._hintMarker.setLatLng(s.latlng);let l=this._hintMarker.getLatLng(),h=new L.Marker(l,this.options.markerStyle);this._setPane(h,"markerPane"),this._finishLayer(h),h.pm||(h.options.draggable=!1),h.addTo(this._map.pm._getContainingLayer()),h.pm&&this.options.markerEditable?h.pm.enable():h.dragging&&h.dragging.disable(),this._fireCreate(h),this._cleanupSnapping(),this.options.continueDrawing||this.disable()},setStyle(){var s,l;(s=this.options.markerStyle)!=null&&s.icon&&((l=this._hintMarker)==null||l.setIcon(this.options.markerStyle.icon))}});var C=63710088e-1,ie={centimeters:C*100,centimetres:C*100,degrees:C/111325,feet:C*3.28084,inches:C*39.37,kilometers:C/1e3,kilometres:C/1e3,meters:C,metres:C,miles:C/1609.344,millimeters:C*1e3,millimetres:C*1e3,nauticalmiles:C/1852,radians:1,yards:C*1.0936};function De(s,l,h){h===void 0&&(h={});var g={type:"Feature"};return(h.id===0||h.id)&&(g.id=h.id),h.bbox&&(g.bbox=h.bbox),g.properties=l||{},g.geometry=s,g}function We(s,l,h){if(h===void 0&&(h={}),!s)throw new Error("coordinates is required");if(!Array.isArray(s))throw new Error("coordinates must be an Array");if(s.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Ln(s[0])||!Ln(s[1]))throw new Error("coordinates must contain numbers");var g={type:"Point",coordinates:s};return De(g,l,h)}function ut(s,l,h){if(h===void 0&&(h={}),s.length<2)throw new Error("coordinates must be an array of two or more positions");var g={type:"LineString",coordinates:s};return De(g,l,h)}function wt(s,l){l===void 0&&(l={});var h={type:"FeatureCollection"};return l.id&&(h.id=l.id),l.bbox&&(h.bbox=l.bbox),h.features=s,h}function zt(s,l){l===void 0&&(l="kilometers");var h=ie[l];if(!h)throw new Error(l+" units is invalid");return s*h}function Kt(s,l){l===void 0&&(l="kilometers");var h=ie[l];if(!h)throw new Error(l+" units is invalid");return s/h}function en(s){var l=s%(2*Math.PI);return l*180/Math.PI}function ln(s){var l=s%360;return l*Math.PI/180}function Ln(s){return!isNaN(s)&&s!==null&&!Array.isArray(s)}function Fn(s){var l,h,g={type:"FeatureCollection",features:[]};if(s.type==="Feature"?h=s.geometry:h=s,h.type==="LineString")l=[h.coordinates];else if(h.type==="MultiLineString")l=h.coordinates;else if(h.type==="MultiPolygon")l=[].concat.apply([],h.coordinates);else if(h.type==="Polygon")l=h.coordinates;else throw new Error("Input must be a LineString, MultiLineString, Polygon, or MultiPolygon Feature or Geometry");return l.forEach(function(y){l.forEach(function(S){for(var B=0;B<y.length-1;B++)for(var D=B;D<S.length-1;D++)if(!(y===S&&(Math.abs(B-D)===1||B===0&&D===y.length-2&&y[B][0]===y[y.length-1][0]&&y[B][1]===y[y.length-1][1]))){var Y=mi(y[B][0],y[B][1],y[B+1][0],y[B+1][1],S[D][0],S[D][1],S[D+1][0],S[D+1][1]);Y&&g.features.push(We([Y[0],Y[1]]))}})}),g}function mi(s,l,h,g,y,S,B,D){var Y,le,Oe,Te,it,pt={x:null,y:null,onLine1:!1,onLine2:!1};return Y=(D-S)*(h-s)-(B-y)*(g-l),Y===0?pt.x!==null&&pt.y!==null?pt:!1:(le=l-S,Oe=s-y,Te=(B-y)*le-(D-S)*Oe,it=(h-s)*le-(g-l)*Oe,le=Te/Y,Oe=it/Y,pt.x=s+le*(h-s),pt.y=l+le*(g-l),le>=0&&le<=1&&(pt.onLine1=!0),Oe>=0&&Oe<=1&&(pt.onLine2=!0),pt.onLine1&&pt.onLine2?[pt.x,pt.y]:!1)}Bi.Line=Bi.extend({initialize(s){this._map=s,this._shape="Line",this.toolbarButtonName="drawPolyline",this._doesSelfIntersect=!1},enable(s){L.Util.setOptions(this,s),this._enabled=!0,this._markers=[],this._layerGroup=new L.FeatureGroup,this._layerGroup._pmTempLayer=!0,this._layerGroup.addTo(this._map),this._layer=L.polyline([],{...this.options.templineStyle,pmIgnore:!1}),this._setPane(this._layer,"layerPane"),this._layer._pmTempLayer=!0,this._layerGroup.addLayer(this._layer),this._hintline=L.polyline([],this.options.hintlineStyle),this._setPane(this._hintline,"layerPane"),this._hintline._pmTempLayer=!0,this._layerGroup.addLayer(this._hintline),this._hintMarker=L.marker(this._map.getCenter(),{interactive:!1,zIndexOffset:100,icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._setPane(this._hintMarker,"vertexPane"),this._hintMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._hintMarker),this.options.cursorMarker&&L.DomUtil.addClass(this._hintMarker._icon,"visible"),this.options.tooltips&&this._hintMarker.bindTooltip(dn("tooltips.firstVertex"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this._map.getContainer().classList.add("geoman-draw-cursor"),this._map.on("click",this._createVertex,this),this.options.finishOn&&this.options.finishOn!=="snap"&&this._map.on(this.options.finishOn,this._finishShape,this),this.options.finishOn==="dblclick"&&(this.tempMapDoubleClickZoomState=this._map.doubleClickZoom._enabled,this.tempMapDoubleClickZoomState&&this._map.doubleClickZoom.disable()),this._map.on("mousemove",this._syncHintMarker,this),this._hintMarker.on("move",this._syncHintLine,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._otherSnapLayers=[],this.isRed=!1,this._fireDrawStart(),this._setGlobalDrawMode()},disable(){this._enabled&&(this._enabled=!1,this._map.getContainer().classList.remove("geoman-draw-cursor"),this._map.off("click",this._createVertex,this),this._map.off("mousemove",this._syncHintMarker,this),this.options.finishOn&&this.options.finishOn!=="snap"&&this._map.off(this.options.finishOn,this._finishShape,this),this.tempMapDoubleClickZoomState&&this._map.doubleClickZoom.enable(),this._map.removeLayer(this._layerGroup),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},enabled(){return this._enabled},toggle(s){this.enabled()?this.disable():this.enable(s)},_syncHintLine(){let s=this._layer.getLatLngs();if(s.length>0){let l=s[s.length-1];this._hintline.setLatLngs([l,this._hintMarker.getLatLng()])}},_syncHintMarker(s){if(this._hintMarker.setLatLng(s.latlng),this.options.snappable){let h=s;h.target=this._hintMarker,this._handleSnapping(h)}this.options.allowSelfIntersection||this._handleSelfIntersection(!0,this._hintMarker.getLatLng());let l=this._layer._defaultShape().slice();l.push(this._hintMarker.getLatLng()),this._change(l)},hasSelfIntersection(){return Fn(this._layer.toGeoJSON(15)).features.length>0},_handleSelfIntersection(s,l){let h=L.polyline(this._layer.getLatLngs());s&&(l||(l=this._hintMarker.getLatLng()),h.addLatLng(l));let g=Fn(h.toGeoJSON(15));this._doesSelfIntersect=g.features.length>0,this._doesSelfIntersect?this.isRed||(this.isRed=!0,this._hintline.setStyle({color:"#f00000ff"}),this._fireIntersect(g,this._map,"Draw")):this._hintline.isEmpty()||(this.isRed=!1,this._hintline.setStyle(this.options.hintlineStyle))},_createVertex(s){if(!this.options.allowSelfIntersection&&(this._handleSelfIntersection(!0,s.latlng),this._doesSelfIntersect))return;this._hintMarker._snapped||this._hintMarker.setLatLng(s.latlng);let l=this._hintMarker.getLatLng(),h=this._layer.getLatLngs(),g=h[h.length-1];if(l.equals(h[0])||h.length>0&&l.equals(g)){this._finishShape();return}this._layer._latlngInfo=this._layer._latlngInfo||[],this._layer._latlngInfo.push({latlng:l,snapInfo:this._hintMarker._snapInfo}),this._layer.addLatLng(l);let y=this._createMarker(l);this._setTooltipText(),this._setHintLineAfterNewVertex(l),this._fireVertexAdded(y,void 0,l,"Draw"),this._change(this._layer.getLatLngs()),this.options.finishOn==="snap"&&this._hintMarker._snapped&&this._finishShape(s)},_setHintLineAfterNewVertex(s){this._hintline.setLatLngs([s,s])},_removeLastVertex(){let s=this._markers;if(s.length<=1){this.disable();return}let l=this._layer.getLatLngs(),h=s[s.length-1],{indexPath:g}=L.PM.Utils.findDeepMarkerIndex(s,h);s.pop(),this._layerGroup.removeLayer(h);let y=s[s.length-1],S=l.indexOf(y.getLatLng());l=l.slice(0,S+1),this._layer.setLatLngs(l),this._layer._latlngInfo.pop(),this._syncHintLine(),this._setTooltipText(),this._fireVertexRemoved(h,g,"Draw"),this._change(this._layer.getLatLngs())},_finishShape(){if(!this.options.allowSelfIntersection&&(this._handleSelfIntersection(!1),this._doesSelfIntersect)||this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;let s=this._layer.getLatLngs();if(s.length<=1)return;let l=L.polyline(s,this.options.pathOptions);this._setPane(l,"layerPane"),this._finishLayer(l),l.addTo(this._map.pm._getContainingLayer()),this._fireCreate(l),this.options.snappable&&this._cleanupSnapping();let h=this._hintMarker.getLatLng();this.disable(),this.options.continueDrawing&&(this.enable(),this._hintMarker.setLatLng(h))},_createMarker(s){let l=new L.Marker(s,{draggable:!1,icon:L.divIcon({className:"marker-icon"})});return this._setPane(l,"vertexPane"),l._pmTempLayer=!0,this._layerGroup.addLayer(l),this._markers.push(l),l.on("click",this._finishShape,this),l},_setTooltipText(){let{length:s}=this._layer.getLatLngs().flat(),l="";s<=1?l=dn("tooltips.continueLine"):l=dn("tooltips.finishLine"),this._hintMarker.setTooltipContent(l)},_change(s){this._fireChange(s,"Draw")},setStyle(){var s,l;(s=this._layer)==null||s.setStyle(this.options.templineStyle),(l=this._hintline)==null||l.setStyle(this.options.hintlineStyle)}}),Bi.Polygon=Bi.Line.extend({initialize(s){this._map=s,this._shape="Polygon",this.toolbarButtonName="drawPolygon"},enable(s){L.PM.Draw.Line.prototype.enable.call(this,s),this._layer.pm._shape="Polygon"},_createMarker(s){let l=new L.Marker(s,{draggable:!1,icon:L.divIcon({className:"marker-icon"})});return this._setPane(l,"vertexPane"),l._pmTempLayer=!0,this._layerGroup.addLayer(l),this._markers.push(l),this._layer.getLatLngs().flat().length===1?(l.on("click",this._finishShape,this),this._tempSnapLayerIndex=this._otherSnapLayers.push(l)-1,this.options.snappable&&this._cleanupSnapping()):l.on("click",()=>1),l},_setTooltipText(){let{length:s}=this._layer.getLatLngs().flat(),l="";s<=2?l=dn("tooltips.continueLine"):l=dn("tooltips.finishPoly"),this._hintMarker.setTooltipContent(l)},_finishShape(){if(!this.options.allowSelfIntersection&&(this._handleSelfIntersection(!0,this._layer.getLatLngs()[0]),this._doesSelfIntersect)||this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;let s=this._layer.getLatLngs();if(s.length<=2)return;let l=L.polygon(s,this.options.pathOptions);this._setPane(l,"layerPane"),this._finishLayer(l),l.addTo(this._map.pm._getContainingLayer()),this._fireCreate(l),this._cleanupSnapping(),this._otherSnapLayers.splice(this._tempSnapLayerIndex,1),delete this._tempSnapLayerIndex;let h=this._hintMarker.getLatLng();this.disable(),this.options.continueDrawing&&(this.enable(),this._hintMarker.setLatLng(h))}}),Bi.Rectangle=Bi.extend({initialize(s){this._map=s,this._shape="Rectangle",this.toolbarButtonName="drawRectangle"},enable(s){if(L.Util.setOptions(this,s),this._enabled=!0,this._layerGroup=new L.FeatureGroup,this._layerGroup._pmTempLayer=!0,this._layerGroup.addTo(this._map),this._layer=L.rectangle([[0,0],[0,0]],this.options.pathOptions),this._setPane(this._layer,"layerPane"),this._layer._pmTempLayer=!0,this._startMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"marker-icon rect-start-marker"}),draggable:!1,zIndexOffset:-100,opacity:this.options.cursorMarker?1:0}),this._setPane(this._startMarker,"vertexPane"),this._startMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._startMarker),this._hintMarker=L.marker(this._map.getCenter(),{zIndexOffset:150,icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._setPane(this._hintMarker,"vertexPane"),this._hintMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._hintMarker),this.options.cursorMarker&&L.DomUtil.addClass(this._hintMarker._icon,"visible"),this.options.tooltips&&this._hintMarker.bindTooltip(dn("tooltips.firstVertex"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this.options.cursorMarker){this._styleMarkers=[];for(let l=0;l<2;l+=1){let h=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"marker-icon rect-style-marker"}),draggable:!1,zIndexOffset:100});this._setPane(h,"vertexPane"),h._pmTempLayer=!0,this._layerGroup.addLayer(h),this._styleMarkers.push(h)}}this._map.getContainer().classList.add("geoman-draw-cursor"),this._map.on("click",this._placeStartingMarkers,this),this._map.on("mousemove",this._syncHintMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._otherSnapLayers=[],this._fireDrawStart(),this._setGlobalDrawMode()},disable(){this._enabled&&(this._enabled=!1,this._map.getContainer().classList.remove("geoman-draw-cursor"),this._map.off("click",this._finishShape,this),this._map.off("click",this._placeStartingMarkers,this),this._map.off("mousemove",this._syncHintMarker,this),this._map.removeLayer(this._layerGroup),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},enabled(){return this._enabled},toggle(s){this.enabled()?this.disable():this.enable(s)},_placeStartingMarkers(s){this._hintMarker._snapped||this._hintMarker.setLatLng(s.latlng);let l=this._hintMarker.getLatLng();L.DomUtil.addClass(this._startMarker._icon,"visible"),this._startMarker.setLatLng(l),this.options.cursorMarker&&this._styleMarkers&&this._styleMarkers.forEach(h=>{L.DomUtil.addClass(h._icon,"visible"),h.setLatLng(l)}),this._map.off("click",this._placeStartingMarkers,this),this._map.on("click",this._finishShape,this),this._hintMarker.setTooltipContent(dn("tooltips.finishRect")),this._setRectangleOrigin()},_setRectangleOrigin(){let s=this._startMarker.getLatLng();s&&(this._layerGroup.addLayer(this._layer),this._layer.setLatLngs([s,s]),this._hintMarker.on("move",this._syncRectangleSize,this))},_syncHintMarker(s){if(this._hintMarker.setLatLng(s.latlng),this.options.snappable){let h=s;h.target=this._hintMarker,this._handleSnapping(h)}let l=this._layerGroup&&this._layerGroup.hasLayer(this._layer)?this._layer.getLatLngs():[this._hintMarker.getLatLng()];this._fireChange(l,"Draw")},_syncRectangleSize(){let s=ma(this._startMarker.getLatLng(),this._map),l=ma(this._hintMarker.getLatLng(),this._map),h=L.PM.Utils._getRotatedRectangle(s,l,this.options.rectangleAngle||0,this._map);if(this._layer.setLatLngs(h),this.options.cursorMarker&&this._styleMarkers){let g=[];h.forEach(y=>{!y.equals(s,1e-8)&&!y.equals(l,1e-8)&&g.push(y)}),g.forEach((y,S)=>{try{this._styleMarkers[S].setLatLng(y)}catch{}})}},_findCorners(){let s=this._layer.getLatLngs()[0];return L.PM.Utils._getRotatedRectangle(s[0],s[2],this.options.rectangleAngle||0,this._map)},_finishShape(s){this._hintMarker._snapped||this._hintMarker.setLatLng(s.latlng);let l=this._hintMarker.getLatLng(),h=this._startMarker.getLatLng();if(this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer()||h.equals(l))return;let g=L.rectangle([h,l],this.options.pathOptions);if(this.options.rectangleAngle){let S=L.PM.Utils._getRotatedRectangle(h,l,this.options.rectangleAngle||0,this._map);g.setLatLngs(S),g.pm&&g.pm._setAngle(this.options.rectangleAngle||0)}this._setPane(g,"layerPane"),this._finishLayer(g),g.addTo(this._map.pm._getContainingLayer()),this._fireCreate(g);let y=this._hintMarker.getLatLng();this.disable(),this.options.continueDrawing&&(this.enable(),this._hintMarker.setLatLng(y))},setStyle(){var s;(s=this._layer)==null||s.setStyle(this.options.pathOptions)}}),Bi.CircleMarker=Bi.extend({initialize(s){this._map=s,this._shape="CircleMarker",this.toolbarButtonName="drawCircleMarker",this._layerIsDragging=!1,this._BaseCircleClass=L.CircleMarker,this._minRadiusOption="minRadiusCircleMarker",this._maxRadiusOption="maxRadiusCircleMarker",this._editableOption="resizeableCircleMarker",this._defaultRadius=10},enable(s){if(L.Util.setOptions(this,s),this.options.editable&&(this.options.resizeableCircleMarker=this.options.editable,delete this.options.editable),this._enabled=!0,this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._map.getContainer().classList.add("geoman-draw-cursor"),this.options[this._editableOption]){let l={};L.extend(l,this.options.templineStyle),l.radius=0,this._layerGroup=new L.FeatureGroup,this._layerGroup._pmTempLayer=!0,this._layerGroup.addTo(this._map),this._layer=new this._BaseCircleClass(this._map.getCenter(),l),this._setPane(this._layer,"layerPane"),this._layer._pmTempLayer=!0,this._centerMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"marker-icon"}),draggable:!1,zIndexOffset:100}),this._setPane(this._centerMarker,"vertexPane"),this._centerMarker._pmTempLayer=!0,this._hintMarker=L.marker(this._map.getCenter(),{zIndexOffset:110,icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._setPane(this._hintMarker,"vertexPane"),this._hintMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._hintMarker),this.options.cursorMarker&&L.DomUtil.addClass(this._hintMarker._icon,"visible"),this.options.tooltips&&this._hintMarker.bindTooltip(dn("tooltips.startCircle"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this._hintline=L.polyline([],this.options.hintlineStyle),this._setPane(this._hintline,"layerPane"),this._hintline._pmTempLayer=!0,this._layerGroup.addLayer(this._hintline),this._map.on("click",this._placeCenterMarker,this)}else this._map.on("click",this._createMarker,this),this._hintMarker=new this._BaseCircleClass(this._map.getCenter(),{radius:this._defaultRadius,...this.options.templineStyle}),this._setPane(this._hintMarker,"layerPane"),this._hintMarker._pmTempLayer=!0,this._hintMarker.addTo(this._map),this._layer=this._hintMarker,this.options.tooltips&&this._hintMarker.bindTooltip(dn("tooltips.placeCircleMarker"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip();this._map.on("mousemove",this._syncHintMarker,this),this._extendingEnable(),this._otherSnapLayers=[],this._fireDrawStart(),this._setGlobalDrawMode()},_extendingEnable(){!this.options[this._editableOption]&&this.options.markerEditable&&this._map.eachLayer(s=>{this.isRelevantMarker(s)&&s.pm.enable()}),this._layer.bringToBack()},disable(){this._enabled&&(this._enabled=!1,this._map.getContainer().classList.remove("geoman-draw-cursor"),this.options[this._editableOption]?(this._map.off("click",this._finishShape,this),this._map.off("click",this._placeCenterMarker,this),this._map.removeLayer(this._layerGroup)):(this._map.off("click",this._createMarker,this),this._extendingDisable(),this._hintMarker.remove()),this._map.off("mousemove",this._syncHintMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},_extendingDisable(){this._map.eachLayer(s=>{this.isRelevantMarker(s)&&s.pm.disable()})},enabled(){return this._enabled},toggle(s){this.enabled()?this.disable():this.enable(s)},_placeCenterMarker(s){this._hintMarker._snapped||this._hintMarker.setLatLng(s.latlng),this._layerGroup.addLayer(this._layer),this._layerGroup.addLayer(this._centerMarker);let l=this._hintMarker.getLatLng();this._centerMarker.setLatLng(l),this._map.off("click",this._placeCenterMarker,this),this._map.on("click",this._finishShape,this),this._placeCircleCenter()},_placeCircleCenter(){let s=this._centerMarker.getLatLng();s&&(this._layer.setLatLng(s),this._hintMarker.on("move",this._syncHintLine,this),this._hintMarker.on("move",this._syncCircleRadius,this),this._hintMarker.setTooltipContent(dn("tooltips.finishCircle")),this._fireCenterPlaced(),this._fireChange(this._layer.getLatLng(),"Draw"))},_syncHintLine(){let s=this._centerMarker.getLatLng(),l=this._getNewDestinationOfHintMarker();this._hintline.setLatLngs([s,l])},_syncCircleRadius(){let s=this._centerMarker.getLatLng(),l=this._hintMarker.getLatLng(),h=this._distanceCalculation(s,l);this.options[this._minRadiusOption]&&h<this.options[this._minRadiusOption]?this._layer.setRadius(this.options[this._minRadiusOption]):this.options[this._maxRadiusOption]&&h>this.options[this._maxRadiusOption]?this._layer.setRadius(this.options[this._maxRadiusOption]):this._layer.setRadius(h)},_syncHintMarker(s){if(this._hintMarker.setLatLng(s.latlng),this._hintMarker.setLatLng(this._getNewDestinationOfHintMarker()),this.options.snappable){let h=s;h.target=this._hintMarker,this._handleSnapping(h)}this._handleHintMarkerSnapping();let l=this._layerGroup&&this._layerGroup.hasLayer(this._centerMarker)?this._centerMarker.getLatLng():this._hintMarker.getLatLng();this._fireChange(l,"Draw")},isRelevantMarker(s){return s instanceof L.CircleMarker&&!(s instanceof L.Circle)&&s.pm&&!s._pmTempLayer},_createMarker(s){if(this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer()||!s.latlng||this._layerIsDragging)return;this._hintMarker._snapped||this._hintMarker.setLatLng(s.latlng);let l=this._hintMarker.getLatLng(),h=new this._BaseCircleClass(l,{radius:this._defaultRadius,...this.options.pathOptions});this._setPane(h,"layerPane"),this._finishLayer(h),h.addTo(this._map.pm._getContainingLayer()),this._extendingCreateMarker(h),this._fireCreate(h),this._cleanupSnapping(),this.options.continueDrawing||this.disable()},_extendingCreateMarker(s){s.pm&&this.options.markerEditable&&s.pm.enable()},_finishShape(s){if(this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;this._hintMarker._snapped||this._hintMarker.setLatLng(s.latlng);let l=this._centerMarker.getLatLng(),h=this._defaultRadius;if(this.options[this._editableOption]){let B=this._hintMarker.getLatLng();h=this._distanceCalculation(l,B),this.options[this._minRadiusOption]&&h<this.options[this._minRadiusOption]?h=this.options[this._minRadiusOption]:this.options[this._maxRadiusOption]&&h>this.options[this._maxRadiusOption]&&(h=this.options[this._maxRadiusOption])}let g={...this.options.pathOptions,radius:h},y=new this._BaseCircleClass(l,g);this._setPane(y,"layerPane"),this._finishLayer(y),y.addTo(this._map.pm._getContainingLayer()),y.pm&&y.pm._updateHiddenPolyCircle(),this._fireCreate(y);let S=this._hintMarker.getLatLng();this.disable(),this.options.continueDrawing&&(this.enable(),this._hintMarker.setLatLng(S))},_getNewDestinationOfHintMarker(){let s=this._hintMarker.getLatLng();if(this.options[this._editableOption]){if(!this._layerGroup.hasLayer(this._centerMarker))return s;let l=this._centerMarker.getLatLng(),h=this._distanceCalculation(l,s);this.options[this._minRadiusOption]&&h<this.options[this._minRadiusOption]?s=pa(this._map,l,s,this._getMinDistanceInMeter()):this.options[this._maxRadiusOption]&&h>this.options[this._maxRadiusOption]&&(s=pa(this._map,l,s,this._getMaxDistanceInMeter()))}return s},_getMinDistanceInMeter(){return L.PM.Utils.pxRadiusToMeterRadius(this.options[this._minRadiusOption],this._map,this._centerMarker.getLatLng())},_getMaxDistanceInMeter(){return L.PM.Utils.pxRadiusToMeterRadius(this.options[this._maxRadiusOption],this._map,this._centerMarker.getLatLng())},_handleHintMarkerSnapping(){if(this.options[this._editableOption]){if(this._hintMarker._snapped){let s=this._centerMarker.getLatLng(),l=this._hintMarker.getLatLng(),h=this._distanceCalculation(s,l);this._layerGroup.hasLayer(this._centerMarker)&&(this.options[this._minRadiusOption]&&h<this.options[this._minRadiusOption]?this._hintMarker.setLatLng(this._hintMarker._orgLatLng):this.options[this._maxRadiusOption]&&h>this.options[this._maxRadiusOption]&&this._hintMarker.setLatLng(this._hintMarker._orgLatLng))}this._hintMarker.setLatLng(this._getNewDestinationOfHintMarker())}},setStyle(){var l,h;let s={};L.extend(s,this.options.templineStyle),this.options[this._editableOption]&&(s.radius=0),(l=this._layer)==null||l.setStyle(s),(h=this._hintline)==null||h.setStyle(this.options.hintlineStyle)},_distanceCalculation(s,l){return this._map.project(s).distanceTo(this._map.project(l))}}),Bi.Circle=Bi.CircleMarker.extend({initialize(s){this._map=s,this._shape="Circle",this.toolbarButtonName="drawCircle",this._BaseCircleClass=L.Circle,this._minRadiusOption="minRadiusCircle",this._maxRadiusOption="maxRadiusCircle",this._editableOption="resizeableCircle",this._defaultRadius=100},_extendingEnable(){},_extendingDisable(){},_extendingCreateMarker(){},isRelevantMarker(){},_getMinDistanceInMeter(){return this.options[this._minRadiusOption]},_getMaxDistanceInMeter(){return this.options[this._maxRadiusOption]},_distanceCalculation(s,l){return this._map.distance(s,l)}});function Wn(s){if(!s)throw new Error("coord is required");if(!Array.isArray(s)){if(s.type==="Feature"&&s.geometry!==null&&s.geometry.type==="Point")return s.geometry.coordinates;if(s.type==="Point")return s.coordinates}if(Array.isArray(s)&&s.length>=2&&!Array.isArray(s[0])&&!Array.isArray(s[1]))return s;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function ei(s){if(Array.isArray(s))return s;if(s.type==="Feature"){if(s.geometry!==null)return s.geometry.coordinates}else if(s.coordinates)return s.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function Vi(s){return s.type==="Feature"?s.geometry:s}function Fi(s,l){return s.type==="FeatureCollection"?"FeatureCollection":s.type==="GeometryCollection"?"GeometryCollection":s.type==="Feature"&&s.geometry!==null?s.geometry.type:s.type}function $r(s,l,h){if(s!==null)for(var g,y,S,B,D,Y,le,Oe=0,Te=0,it,pt=s.type,Tt=pt==="FeatureCollection",qt=pt==="Feature",Vt=Tt?s.features.length:1,bn=0;bn<Vt;bn++){le=Tt?s.features[bn].geometry:qt?s.geometry:s,it=le?le.type==="GeometryCollection":!1,D=it?le.geometries.length:1;for(var Re=0;Re<D;Re++){var qe=0,Je=0;if(B=it?le.geometries[Re]:le,B!==null){Y=B.coordinates;var yt=B.type;switch(Oe=0,yt){case null:break;case"Point":if(l(Y,Te,bn,qe,Je)===!1)return!1;Te++,qe++;break;case"LineString":case"MultiPoint":for(g=0;g<Y.length;g++){if(l(Y[g],Te,bn,qe,Je)===!1)return!1;Te++,yt==="MultiPoint"&&qe++}yt==="LineString"&&qe++;break;case"Polygon":case"MultiLineString":for(g=0;g<Y.length;g++){for(y=0;y<Y[g].length-Oe;y++){if(l(Y[g][y],Te,bn,qe,Je)===!1)return!1;Te++}yt==="MultiLineString"&&qe++,yt==="Polygon"&&Je++}yt==="Polygon"&&qe++;break;case"MultiPolygon":for(g=0;g<Y.length;g++){for(Je=0,y=0;y<Y[g].length;y++){for(S=0;S<Y[g][y].length-Oe;S++){if(l(Y[g][y][S],Te,bn,qe,Je)===!1)return!1;Te++}Je++}qe++}break;case"GeometryCollection":for(g=0;g<B.geometries.length;g++)if($r(B.geometries[g],l)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function oi(s,l){if(s.type==="Feature")l(s,0);else if(s.type==="FeatureCollection")for(var h=0;h<s.features.length&&l(s.features[h],h)!==!1;h++);}function wr(s,l,h){var g=h;return oi(s,function(y,S){S===0&&h===void 0?g=y:g=l(g,y,S)}),g}function ll(s,l){var h,g,y,S,B,D,Y,le,Oe,Te,it=0,pt=s.type==="FeatureCollection",Tt=s.type==="Feature",qt=pt?s.features.length:1;for(h=0;h<qt;h++){for(D=pt?s.features[h].geometry:Tt?s.geometry:s,le=pt?s.features[h].properties:Tt?s.properties:{},Oe=pt?s.features[h].bbox:Tt?s.bbox:void 0,Te=pt?s.features[h].id:Tt?s.id:void 0,Y=D?D.type==="GeometryCollection":!1,B=Y?D.geometries.length:1,y=0;y<B;y++){if(S=Y?D.geometries[y]:D,S===null){if(l(null,it,le,Oe,Te)===!1)return!1;continue}switch(S.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(l(S,it,le,Oe,Te)===!1)return!1;break}case"GeometryCollection":{for(g=0;g<S.geometries.length;g++)if(l(S.geometries[g],it,le,Oe,Te)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}it++}}function xr(s,l){ll(s,function(h,g,y,S,B){var D=h===null?null:h.type;switch(D){case null:case"Point":case"LineString":case"Polygon":return l(De(h,y,{bbox:S,id:B}),g,0)===!1?!1:void 0}var Y;switch(D){case"MultiPoint":Y="Point";break;case"MultiLineString":Y="LineString";break;case"MultiPolygon":Y="Polygon";break}for(var le=0;le<h.coordinates.length;le++){var Oe=h.coordinates[le],Te={type:Y,coordinates:Oe};if(l(De(Te,y),g,le)===!1)return!1}})}function qa(s){if(!s)throw new Error("geojson is required");var l=[];return xr(s,function(h){vs(h,l)}),wt(l)}function vs(s,l){var h=[],g=s.geometry;if(g!==null){switch(g.type){case"Polygon":h=ei(g);break;case"LineString":h=[ei(g)]}h.forEach(function(y){var S=Va(y,s.properties);S.forEach(function(B){B.id=l.length,l.push(B)})})}}function Va(s,l){var h=[];return s.reduce(function(g,y){var S=ut([g,y],l);return S.bbox=to(g,y),h.push(S),y}),h}function to(s,l){var h=s[0],g=s[1],y=l[0],S=l[1],B=h<y?h:y,D=g<S?g:S,Y=h>y?h:y,le=g>S?g:S;return[B,D,Y,le]}var no=qa,ji=f(zr(),1);function _a(s,l){var h={},g=[];if(s.type==="LineString"&&(s=De(s)),l.type==="LineString"&&(l=De(l)),s.type==="Feature"&&l.type==="Feature"&&s.geometry!==null&&l.geometry!==null&&s.geometry.type==="LineString"&&l.geometry.type==="LineString"&&s.geometry.coordinates.length===2&&l.geometry.coordinates.length===2){var y=Ar(s,l);return y&&g.push(y),wt(g)}var S=(0,ji.default)();return S.load(no(l)),oi(no(s),function(B){oi(S.search(B),function(D){var Y=Ar(B,D);if(Y){var le=ei(Y).join(",");h[le]||(h[le]=!0,g.push(Y))}})}),wt(g)}function Ar(s,l){var h=ei(s),g=ei(l);if(h.length!==2)throw new Error("<intersects> line1 must only contain 2 coordinates");if(g.length!==2)throw new Error("<intersects> line2 must only contain 2 coordinates");var y=h[0][0],S=h[0][1],B=h[1][0],D=h[1][1],Y=g[0][0],le=g[0][1],Oe=g[1][0],Te=g[1][1],it=(Te-le)*(B-y)-(Oe-Y)*(D-S),pt=(Oe-Y)*(S-le)-(Te-le)*(y-Y),Tt=(B-y)*(S-le)-(D-S)*(y-Y);if(it===0)return null;var qt=pt/it,Vt=Tt/it;if(qt>=0&&qt<=1&&Vt>=0&&Vt<=1){var bn=y+qt*(B-y),Re=S+qt*(D-S);return We([bn,Re])}return null}var Lr=_a,ba=f(zr(),1);function hr(s,l,h){h===void 0&&(h={});var g=Wn(s),y=Wn(l),S=ln(y[1]-g[1]),B=ln(y[0]-g[0]),D=ln(g[1]),Y=ln(y[1]),le=Math.pow(Math.sin(S/2),2)+Math.pow(Math.sin(B/2),2)*Math.cos(D)*Math.cos(Y);return zt(2*Math.atan2(Math.sqrt(le),Math.sqrt(1-le)),h.units)}var io=hr;function qr(s){var l=s[0],h=s[1],g=s[2],y=s[3],S=io(s.slice(0,2),[g,h]),B=io(s.slice(0,2),[l,y]);if(S>=B){var D=(h+y)/2;return[l,D-(g-l)/2,g,D+(g-l)/2]}else{var Y=(l+g)/2;return[Y-(y-h)/2,h,Y+(y-h)/2,y]}}var ul=qr;function Gi(s){var l=[1/0,1/0,-1/0,-1/0];return $r(s,function(h){l[0]>h[0]&&(l[0]=h[0]),l[1]>h[1]&&(l[1]=h[1]),l[2]<h[0]&&(l[2]=h[0]),l[3]<h[1]&&(l[3]=h[1])}),l}Gi.default=Gi;var Rs=Gi;function Xr(s,l){l===void 0&&(l={});var h=l.precision,g=l.coordinates,y=l.mutate;if(h=h==null||isNaN(h)?6:h,g=g==null||isNaN(g)?3:g,!s)throw new Error("<geojson> is required");if(typeof h!="number")throw new Error("<precision> must be a number");if(typeof g!="number")throw new Error("<coordinates> must be a number");(y===!1||y===void 0)&&(s=JSON.parse(JSON.stringify(s)));var S=Math.pow(10,h);return $r(s,function(B){Ho(B,S,g)}),s}function Ho(s,l,h){s.length>h&&s.splice(h,s.length);for(var g=0;g<s.length;g++)s[g]=Math.round(s[g]*l)/l;return s}var ro=Xr;function Os(s,l,h){if(h===void 0&&(h={}),h.final===!0)return er(s,l);var g=Wn(s),y=Wn(l),S=ln(g[0]),B=ln(y[0]),D=ln(g[1]),Y=ln(y[1]),le=Math.sin(B-S)*Math.cos(Y),Oe=Math.cos(D)*Math.sin(Y)-Math.sin(D)*Math.cos(Y)*Math.cos(B-S);return en(Math.atan2(le,Oe))}function er(s,l){var h=Os(l,s);return h=(h+180)%360,h}function Yi(s,l,h,g){g===void 0&&(g={});var y=Wn(s),S=ln(y[0]),B=ln(y[1]),D=ln(h),Y=Kt(l,g.units),le=Math.asin(Math.sin(B)*Math.cos(Y)+Math.cos(B)*Math.sin(Y)*Math.cos(D)),Oe=S+Math.atan2(Math.sin(D)*Math.sin(Y)*Math.cos(B),Math.cos(Y)-Math.sin(B)*Math.sin(le)),Te=en(Oe),it=en(le);return We([Te,it],g.properties)}function ys(s,l,h){h===void 0&&(h={});var g=We([1/0,1/0],{dist:1/0}),y=0;return xr(s,function(S){for(var B=ei(S),D=0;D<B.length-1;D++){var Y=We(B[D]);Y.properties.dist=io(l,Y,h);var le=We(B[D+1]);le.properties.dist=io(l,le,h);var Oe=io(Y,le,h),Te=Math.max(Y.properties.dist,le.properties.dist),it=Os(Y,le),pt=Yi(l,Te,it+90,h),Tt=Yi(l,Te,it-90,h),qt=Lr(ut([pt.geometry.coordinates,Tt.geometry.coordinates]),ut([Y.geometry.coordinates,le.geometry.coordinates])),Vt=null;qt.features.length>0&&(Vt=qt.features[0],Vt.properties.dist=io(l,Vt,h),Vt.properties.location=y+io(Y,Vt,h)),Y.properties.dist<g.properties.dist&&(g=Y,g.properties.index=D,g.properties.location=y),le.properties.dist<g.properties.dist&&(g=le,g.properties.index=D+1,g.properties.location=y+Oe),Vt&&Vt.properties.dist<g.properties.dist&&(g=Vt,g.properties.index=D),y+=Oe}}),g}var Mr=ys;function Qr(s,l){if(!s)throw new Error("line is required");if(!l)throw new Error("splitter is required");var h=Fi(s),g=Fi(l);if(h!=="LineString")throw new Error("line must be LineString");if(g==="FeatureCollection")throw new Error("splitter cannot be a FeatureCollection");if(g==="GeometryCollection")throw new Error("splitter cannot be a GeometryCollection");var y=ro(l,{precision:7});switch(g){case"Point":return es(s,y);case"MultiPoint":return so(s,y);case"LineString":case"MultiLineString":case"Polygon":case"MultiPolygon":return so(s,Lr(s,y))}}function so(s,l){var h=[],g=(0,ba.default)();return xr(l,function(y){if(h.forEach(function(D,Y){D.id=Y}),!h.length)h=es(s,y).features,h.forEach(function(D){D.bbox||(D.bbox=ul(Rs(D)))}),g.load(wt(h));else{var S=g.search(y);if(S.features.length){var B=Si(y,S);h=h.filter(function(D){return D.id!==B.id}),g.remove(B),oi(es(B,y),function(D){h.push(D),g.insert(D)})}}}),wt(h)}function es(s,l){var h=[],g=ei(s)[0],y=ei(s)[s.geometry.coordinates.length-1];if(Is(g,Wn(l))||Is(y,Wn(l)))return wt([s]);var S=(0,ba.default)(),B=no(s);S.load(B);var D=S.search(l);if(!D.features.length)return wt([s]);var Y=Si(l,D),le=[g],Oe=wr(B,function(Te,it,pt){var Tt=ei(it)[1],qt=Wn(l);return pt===Y.id?(Te.push(qt),h.push(ut(Te)),Is(qt,Tt)?[qt]:[qt,Tt]):(Te.push(Tt),Te)},le);return Oe.length>1&&h.push(ut(Oe)),wt(h)}function Si(s,l){if(!l.features.length)throw new Error("lines must contain features");if(l.features.length===1)return l.features[0];var h,g=1/0;return oi(l,function(y){var S=Mr(y,s),B=S.properties.dist;B<g&&(h=y,g=B)}),h}function Is(s,l){return s[0]===l[0]&&s[1]===l[1]}var Cr=Qr;function dr(s,l,h){if(h===void 0&&(h={}),!s)throw new Error("point is required");if(!l)throw new Error("polygon is required");var g=Wn(s),y=Vi(l),S=y.type,B=l.bbox,D=y.coordinates;if(B&&Ga(g,B)===!1)return!1;S==="Polygon"&&(D=[D]);for(var Y=!1,le=0;le<D.length&&!Y;le++)if(Wo(g,D[le][0],h.ignoreBoundary)){for(var Oe=!1,Te=1;Te<D[le].length&&!Oe;)Wo(g,D[le][Te],!h.ignoreBoundary)&&(Oe=!0),Te++;Oe||(Y=!0)}return Y}function Wo(s,l,h){var g=!1;l[0][0]===l[l.length-1][0]&&l[0][1]===l[l.length-1][1]&&(l=l.slice(0,l.length-1));for(var y=0,S=l.length-1;y<l.length;S=y++){var B=l[y][0],D=l[y][1],Y=l[S][0],le=l[S][1],Oe=s[1]*(B-Y)+D*(Y-s[0])+le*(s[0]-B)===0&&(B-s[0])*(Y-s[0])<=0&&(D-s[1])*(le-s[1])<=0;if(Oe)return!h;var Te=D>s[1]!=le>s[1]&&s[0]<(Y-B)*(s[1]-D)/(le-D)+B;Te&&(g=!g)}return g}function Ga(s,l){return l[0]<=s[0]&&l[1]<=s[1]&&l[2]>=s[0]&&l[3]>=s[1]}function Ha(s,l,h){h===void 0&&(h={});for(var g=Wn(s),y=ei(l),S=0;S<y.length-1;S++){var B=!1;if(h.ignoreEndVertices&&(S===0&&(B="start"),S===y.length-2&&(B="end"),S===0&&S+1===y.length-1&&(B="both")),fr(y[S],y[S+1],g,B,typeof h.epsilon>"u"?null:h.epsilon))return!0}return!1}function fr(s,l,h,g,y){var S=h[0],B=h[1],D=s[0],Y=s[1],le=l[0],Oe=l[1],Te=h[0]-D,it=h[1]-Y,pt=le-D,Tt=Oe-Y,qt=Te*Tt-it*pt;if(y!==null){if(Math.abs(qt)>y)return!1}else if(qt!==0)return!1;if(g){if(g==="start")return Math.abs(pt)>=Math.abs(Tt)?pt>0?D<S&&S<=le:le<=S&&S<D:Tt>0?Y<B&&B<=Oe:Oe<=B&&B<Y;if(g==="end")return Math.abs(pt)>=Math.abs(Tt)?pt>0?D<=S&&S<le:le<S&&S<=D:Tt>0?Y<=B&&B<Oe:Oe<B&&B<=Y;if(g==="both")return Math.abs(pt)>=Math.abs(Tt)?pt>0?D<S&&S<le:le<S&&S<D:Tt>0?Y<B&&B<Oe:Oe<B&&B<Y}else return Math.abs(pt)>=Math.abs(Tt)?pt>0?D<=S&&S<=le:le<=S&&S<=D:Tt>0?Y<=B&&B<=Oe:Oe<=B&&B<=Y;return!1}var Br=Ha;function Lo(s,l){var h=Vi(s),g=Vi(l),y=h.type,S=g.type,B=h.coordinates,D=g.coordinates;switch(y){case"Point":switch(S){case"Point":return ti(B,D);default:throw new Error("feature2 "+S+" geometry not supported")}case"MultiPoint":switch(S){case"Point":return Fs(h,g);case"MultiPoint":return wa(h,g);default:throw new Error("feature2 "+S+" geometry not supported")}case"LineString":switch(S){case"Point":return Br(g,h,{ignoreEndVertices:!0});case"LineString":return oo(h,g);case"MultiPoint":return Co(h,g);default:throw new Error("feature2 "+S+" geometry not supported")}case"Polygon":switch(S){case"Point":return dr(g,h,{ignoreBoundary:!0});case"LineString":return ts(h,g);case"Polygon":return tr(h,g);case"MultiPoint":return Po(h,g);default:throw new Error("feature2 "+S+" geometry not supported")}default:throw new Error("feature1 "+y+" geometry not supported")}}function Fs(s,l){var h,g=!1;for(h=0;h<s.coordinates.length;h++)if(ti(s.coordinates[h],l.coordinates)){g=!0;break}return g}function wa(s,l){for(var h=0,g=l.coordinates;h<g.length;h++){for(var y=g[h],S=!1,B=0,D=s.coordinates;B<D.length;B++){var Y=D[B];if(ti(y,Y)){S=!0;break}}if(!S)return!1}return!0}function Co(s,l){for(var h=!1,g=0,y=l.coordinates;g<y.length;g++){var S=y[g];if(Br(S,s,{ignoreEndVertices:!0})&&(h=!0),!Br(S,s))return!1}return!!h}function Po(s,l){for(var h=0,g=l.coordinates;h<g.length;h++){var y=g[h];if(!dr(y,s,{ignoreBoundary:!0}))return!1}return!0}function oo(s,l){for(var h=!1,g=0,y=l.coordinates;g<y.length;g++){var S=y[g];if(Br({type:"Point",coordinates:S},s,{ignoreEndVertices:!0})&&(h=!0),!Br({type:"Point",coordinates:S},s,{ignoreEndVertices:!1}))return!1}return h}function ts(s,l){var h=!1,g=0,y=Rs(s),S=Rs(l);if(!ri(y,S))return!1;for(g;g<l.coordinates.length-1;g++){var B=Ti(l.coordinates[g],l.coordinates[g+1]);if(dr({type:"Point",coordinates:B},s,{ignoreBoundary:!0})){h=!0;break}}return h}function tr(s,l){if(s.type==="Feature"&&s.geometry===null||l.type==="Feature"&&l.geometry===null)return!1;var h=Rs(s),g=Rs(l);if(!ri(h,g))return!1;for(var y=Vi(l).coordinates,S=0,B=y;S<B.length;S++)for(var D=B[S],Y=0,le=D;Y<le.length;Y++){var Oe=le[Y];if(!dr(Oe,s))return!1}return!0}function ri(s,l){return!(s[0]>l[0]||s[2]<l[2]||s[1]>l[1]||s[3]<l[3])}function ti(s,l){return s[0]===l[0]&&s[1]===l[1]}function Ti(s,l){return[(s[0]+l[0])/2,(s[1]+l[1])/2]}var ai=f(cr()),_s=s=>()=>s,ko=s=>{let l=s?(h,g)=>g.minus(h).abs().isLessThanOrEqualTo(s):_s(!1);return(h,g)=>l(h,g)?0:h.comparedTo(g)};function js(s){let l=s?(h,g,y,S,B)=>h.exponentiatedBy(2).isLessThanOrEqualTo(S.minus(g).exponentiatedBy(2).plus(B.minus(y).exponentiatedBy(2)).times(s)):_s(!1);return(h,g,y)=>{let S=h.x,B=h.y,D=y.x,Y=y.y,le=B.minus(Y).times(g.x.minus(D)).minus(S.minus(D).times(g.y.minus(Y)));return l(le,S,B,D,Y)?0:le.comparedTo(0)}}var cl=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,So=Math.ceil,Hi=Math.floor,li="[BigNumber Error] ",Tr=li+"Number primitive has more than 15 significant digits: ",Nr=1e14,_n=14,hl=9007199254740991,Zo=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],ns=1e7,pr=1e9;function jl(s){var l,h,g,y=Re.prototype={constructor:Re,toString:null,valueOf:null},S=new Re(1),B=20,D=4,Y=-7,le=21,Oe=-1e7,Te=1e7,it=!1,pt=1,Tt=0,qt={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"",suffix:""},Vt="0123456789abcdefghijklmnopqrstuvwxyz",bn=!0;function Re(X,de){var Le,we,Ce,ke,Ze,He,Xe,ht,ct=this;if(!(ct instanceof Re))return new Re(X,de);if(de==null){if(X&&X._isBigNumber===!0){ct.s=X.s,!X.c||X.e>Te?ct.c=ct.e=null:X.e<Oe?ct.c=[ct.e=0]:(ct.e=X.e,ct.c=X.c.slice());return}if((He=typeof X=="number")&&X*0==0){if(ct.s=1/X<0?(X=-X,-1):1,X===~~X){for(ke=0,Ze=X;Ze>=10;Ze/=10,ke++);ke>Te?ct.c=ct.e=null:(ct.e=ke,ct.c=[X]);return}ht=String(X)}else{if(!cl.test(ht=String(X)))return g(ct,ht,He);ct.s=ht.charCodeAt(0)==45?(ht=ht.slice(1),-1):1}(ke=ht.indexOf("."))>-1&&(ht=ht.replace(".","")),(Ze=ht.search(/e/i))>0?(ke<0&&(ke=Ze),ke+=+ht.slice(Ze+1),ht=ht.substring(0,Ze)):ke<0&&(ke=ht.length)}else{if(r(de,2,Vt.length,"Base"),de==10&&bn)return ct=new Re(X),at(ct,B+ct.e+1,D);if(ht=String(X),He=typeof X=="number"){if(X*0!=0)return g(ct,ht,He,de);if(ct.s=1/X<0?(ht=ht.slice(1),-1):1,Re.DEBUG&&ht.replace(/^0\.0*|\./,"").length>15)throw Error(Tr+X)}else ct.s=ht.charCodeAt(0)===45?(ht=ht.slice(1),-1):1;for(Le=Vt.slice(0,de),ke=Ze=0,Xe=ht.length;Ze<Xe;Ze++)if(Le.indexOf(we=ht.charAt(Ze))<0){if(we=="."){if(Ze>ke){ke=Xe;continue}}else if(!Ce&&(ht==ht.toUpperCase()&&(ht=ht.toLowerCase())||ht==ht.toLowerCase()&&(ht=ht.toUpperCase()))){Ce=!0,Ze=-1,ke=0;continue}return g(ct,String(X),He,de)}He=!1,ht=h(ht,de,10,ct.s),(ke=ht.indexOf("."))>-1?ht=ht.replace(".",""):ke=ht.length}for(Ze=0;ht.charCodeAt(Ze)===48;Ze++);for(Xe=ht.length;ht.charCodeAt(--Xe)===48;);if(ht=ht.slice(Ze,++Xe)){if(Xe-=Ze,He&&Re.DEBUG&&Xe>15&&(X>hl||X!==Hi(X)))throw Error(Tr+ct.s*X);if((ke=ke-Ze-1)>Te)ct.c=ct.e=null;else if(ke<Oe)ct.c=[ct.e=0];else{if(ct.e=ke,ct.c=[],Ze=(ke+1)%_n,ke<0&&(Ze+=_n),Ze<Xe){for(Ze&&ct.c.push(+ht.slice(0,Ze)),Xe-=_n;Ze<Xe;)ct.c.push(+ht.slice(Ze,Ze+=_n));Ze=_n-(ht=ht.slice(Ze)).length}else Ze-=Xe;for(;Ze--;ht+="0");ct.c.push(+ht)}}else ct.c=[ct.e=0]}Re.clone=jl,Re.ROUND_UP=0,Re.ROUND_DOWN=1,Re.ROUND_CEIL=2,Re.ROUND_FLOOR=3,Re.ROUND_HALF_UP=4,Re.ROUND_HALF_DOWN=5,Re.ROUND_HALF_EVEN=6,Re.ROUND_HALF_CEIL=7,Re.ROUND_HALF_FLOOR=8,Re.EUCLID=9,Re.config=Re.set=function(X){var de,Le;if(X!=null)if(typeof X=="object"){if(X.hasOwnProperty(de="DECIMAL_PLACES")&&(Le=X[de],r(Le,0,pr,de),B=Le),X.hasOwnProperty(de="ROUNDING_MODE")&&(Le=X[de],r(Le,0,8,de),D=Le),X.hasOwnProperty(de="EXPONENTIAL_AT")&&(Le=X[de],Le&&Le.pop?(r(Le[0],-1e9,0,de),r(Le[1],0,pr,de),Y=Le[0],le=Le[1]):(r(Le,-1e9,pr,de),Y=-(le=Le<0?-Le:Le))),X.hasOwnProperty(de="RANGE"))if(Le=X[de],Le&&Le.pop)r(Le[0],-1e9,-1,de),r(Le[1],1,pr,de),Oe=Le[0],Te=Le[1];else if(r(Le,-1e9,pr,de),Le)Oe=-(Te=Le<0?-Le:Le);else throw Error(li+de+" cannot be zero: "+Le);if(X.hasOwnProperty(de="CRYPTO"))if(Le=X[de],Le===!!Le)if(Le)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))it=Le;else throw it=!Le,Error(li+"crypto unavailable");else it=Le;else throw Error(li+de+" not true or false: "+Le);if(X.hasOwnProperty(de="MODULO_MODE")&&(Le=X[de],r(Le,0,9,de),pt=Le),X.hasOwnProperty(de="POW_PRECISION")&&(Le=X[de],r(Le,0,pr,de),Tt=Le),X.hasOwnProperty(de="FORMAT"))if(Le=X[de],typeof Le=="object")qt=Le;else throw Error(li+de+" not an object: "+Le);if(X.hasOwnProperty(de="ALPHABET"))if(Le=X[de],typeof Le=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(Le))bn=Le.slice(0,10)=="0123456789",Vt=Le;else throw Error(li+de+" invalid: "+Le)}else throw Error(li+"Object expected: "+X);return{DECIMAL_PLACES:B,ROUNDING_MODE:D,EXPONENTIAL_AT:[Y,le],RANGE:[Oe,Te],CRYPTO:it,MODULO_MODE:pt,POW_PRECISION:Tt,FORMAT:qt,ALPHABET:Vt}},Re.isBigNumber=function(X){if(!X||X._isBigNumber!==!0)return!1;if(!Re.DEBUG)return!0;var de,Le,we=X.c,Ce=X.e,ke=X.s;e:if({}.toString.call(we)=="[object Array]"){if((ke===1||ke===-1)&&Ce>=-1e9&&Ce<=pr&&Ce===Hi(Ce)){if(we[0]===0){if(Ce===0&&we.length===1)return!0;break e}if(de=(Ce+1)%_n,de<1&&(de+=_n),String(we[0]).length==de){for(de=0;de<we.length;de++)if(Le=we[de],Le<0||Le>=Nr||Le!==Hi(Le))break e;if(Le!==0)return!0}}}else if(we===null&&Ce===null&&(ke===null||ke===1||ke===-1))return!0;throw Error(li+"Invalid BigNumber: "+X)},Re.maximum=Re.max=function(){return Je(arguments,-1)},Re.minimum=Re.min=function(){return Je(arguments,1)},Re.random=function(){var X=9007199254740992,de=Math.random()*X&2097151?function(){return Hi(Math.random()*X)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(Le){var we,Ce,ke,Ze,He,Xe=0,ht=[],ct=new Re(S);if(Le==null?Le=B:r(Le,0,pr),Ze=So(Le/_n),it)if(crypto.getRandomValues){for(we=crypto.getRandomValues(new Uint32Array(Ze*=2));Xe<Ze;)He=we[Xe]*131072+(we[Xe+1]>>>11),He>=9e15?(Ce=crypto.getRandomValues(new Uint32Array(2)),we[Xe]=Ce[0],we[Xe+1]=Ce[1]):(ht.push(He%1e14),Xe+=2);Xe=Ze/2}else if(crypto.randomBytes){for(we=crypto.randomBytes(Ze*=7);Xe<Ze;)He=(we[Xe]&31)*281474976710656+we[Xe+1]*1099511627776+we[Xe+2]*4294967296+we[Xe+3]*16777216+(we[Xe+4]<<16)+(we[Xe+5]<<8)+we[Xe+6],He>=9e15?crypto.randomBytes(7).copy(we,Xe):(ht.push(He%1e14),Xe+=7);Xe=Ze/7}else throw it=!1,Error(li+"crypto unavailable");if(!it)for(;Xe<Ze;)He=de(),He<9e15&&(ht[Xe++]=He%1e14);for(Ze=ht[--Xe],Le%=_n,Ze&&Le&&(He=Zo[_n-Le],ht[Xe]=Hi(Ze/He)*He);ht[Xe]===0;ht.pop(),Xe--);if(Xe<0)ht=[ke=0];else{for(ke=-1;ht[0]===0;ht.splice(0,1),ke-=_n);for(Xe=1,He=ht[0];He>=10;He/=10,Xe++);Xe<_n&&(ke-=_n-Xe)}return ct.e=ke,ct.c=ht,ct}}(),Re.sum=function(){for(var X=1,de=arguments,Le=new Re(de[0]);X<de.length;)Le=Le.plus(de[X++]);return Le},h=function(){var X="0123456789";function de(Le,we,Ce,ke){for(var Ze,He=[0],Xe,ht=0,ct=Le.length;ht<ct;){for(Xe=He.length;Xe--;He[Xe]*=we);for(He[0]+=ke.indexOf(Le.charAt(ht++)),Ze=0;Ze<He.length;Ze++)He[Ze]>Ce-1&&(He[Ze+1]==null&&(He[Ze+1]=0),He[Ze+1]+=He[Ze]/Ce|0,He[Ze]%=Ce)}return He.reverse()}return function(Le,we,Ce,ke,Ze){var He,Xe,ht,ct,Rt,Xt,nn,an,Jn=Le.indexOf("."),ni=B,$n=D;for(Jn>=0&&(ct=Tt,Tt=0,Le=Le.replace(".",""),an=new Re(we),Xt=an.pow(Le.length-Jn),Tt=ct,an.c=de(E(kr(Xt.c),Xt.e,"0"),10,Ce,X),an.e=an.c.length),nn=de(Le,we,Ce,Ze?(He=Vt,X):(He=X,Vt)),ht=ct=nn.length;nn[--ct]==0;nn.pop());if(!nn[0])return He.charAt(0);if(Jn<0?--ht:(Xt.c=nn,Xt.e=ht,Xt.s=ke,Xt=l(Xt,an,ni,$n,Ce),nn=Xt.c,Rt=Xt.r,ht=Xt.e),Xe=ht+ni+1,Jn=nn[Xe],ct=Ce/2,Rt=Rt||Xe<0||nn[Xe+1]!=null,Rt=$n<4?(Jn!=null||Rt)&&($n==0||$n==(Xt.s<0?3:2)):Jn>ct||Jn==ct&&($n==4||Rt||$n==6&&nn[Xe-1]&1||$n==(Xt.s<0?8:7)),Xe<1||!nn[0])Le=Rt?E(He.charAt(1),-ni,He.charAt(0)):He.charAt(0);else{if(nn.length=Xe,Rt)for(--Ce;++nn[--Xe]>Ce;)nn[Xe]=0,Xe||(++ht,nn=[1].concat(nn));for(ct=nn.length;!nn[--ct];);for(Jn=0,Le="";Jn<=ct;Le+=He.charAt(nn[Jn++]));Le=E(Le,ht,He.charAt(0))}return Le}}(),l=function(){function X(we,Ce,ke){var Ze,He,Xe,ht,ct=0,Rt=we.length,Xt=Ce%ns,nn=Ce/ns|0;for(we=we.slice();Rt--;)Xe=we[Rt]%ns,ht=we[Rt]/ns|0,Ze=nn*Xe+ht*Xt,He=Xt*Xe+Ze%ns*ns+ct,ct=(He/ke|0)+(Ze/ns|0)+nn*ht,we[Rt]=He%ke;return ct&&(we=[ct].concat(we)),we}function de(we,Ce,ke,Ze){var He,Xe;if(ke!=Ze)Xe=ke>Ze?1:-1;else for(He=Xe=0;He<ke;He++)if(we[He]!=Ce[He]){Xe=we[He]>Ce[He]?1:-1;break}return Xe}function Le(we,Ce,ke,Ze){for(var He=0;ke--;)we[ke]-=He,He=we[ke]<Ce[ke]?1:0,we[ke]=He*Ze+we[ke]-Ce[ke];for(;!we[0]&&we.length>1;we.splice(0,1));}return function(we,Ce,ke,Ze,He){var Xe,ht,ct,Rt,Xt,nn,an,Jn,ni,$n,hi,Rr,pl,Eo,Ku,Ao,Vl,ws=we.s==Ce.s?1:-1,mr=we.c,Ni=Ce.c;if(!mr||!mr[0]||!Ni||!Ni[0])return new Re(!we.s||!Ce.s||(mr?Ni&&mr[0]==Ni[0]:!Ni)?NaN:mr&&mr[0]==0||!Ni?ws*0:ws/0);for(Jn=new Re(ws),ni=Jn.c=[],ht=we.e-Ce.e,ws=ke+ht+1,He||(He=Nr,ht=Pr(we.e/_n)-Pr(Ce.e/_n),ws=ws/_n|0),ct=0;Ni[ct]==(mr[ct]||0);ct++);if(Ni[ct]>(mr[ct]||0)&&ht--,ws<0)ni.push(1),Rt=!0;else{for(Eo=mr.length,Ao=Ni.length,ct=0,ws+=2,Xt=Hi(He/(Ni[0]+1)),Xt>1&&(Ni=X(Ni,Xt,He),mr=X(mr,Xt,He),Ao=Ni.length,Eo=mr.length),pl=Ao,$n=mr.slice(0,Ao),hi=$n.length;hi<Ao;$n[hi++]=0);Vl=Ni.slice(),Vl=[0].concat(Vl),Ku=Ni[0],Ni[1]>=He/2&&Ku++;do{if(Xt=0,Xe=de(Ni,$n,Ao,hi),Xe<0){if(Rr=$n[0],Ao!=hi&&(Rr=Rr*He+($n[1]||0)),Xt=Hi(Rr/Ku),Xt>1)for(Xt>=He&&(Xt=He-1),nn=X(Ni,Xt,He),an=nn.length,hi=$n.length;de(nn,$n,an,hi)==1;)Xt--,Le(nn,Ao<an?Vl:Ni,an,He),an=nn.length,Xe=1;else Xt==0&&(Xe=Xt=1),nn=Ni.slice(),an=nn.length;if(an<hi&&(nn=[0].concat(nn)),Le($n,nn,hi,He),hi=$n.length,Xe==-1)for(;de(Ni,$n,Ao,hi)<1;)Xt++,Le($n,Ao<hi?Vl:Ni,hi,He),hi=$n.length}else Xe===0&&(Xt++,$n=[0]);ni[ct++]=Xt,$n[0]?$n[hi++]=mr[pl]||0:($n=[mr[pl]],hi=1)}while((pl++<Eo||$n[0]!=null)&&ws--);Rt=$n[0]!=null,ni[0]||ni.splice(0,1)}if(He==Nr){for(ct=1,ws=ni[0];ws>=10;ws/=10,ct++);at(Jn,ke+(Jn.e=ct+ht*_n-1)+1,Ze,Rt)}else Jn.e=ht,Jn.r=+Rt;return Jn}}();function qe(X,de,Le,we){var Ce,ke,Ze,He,Xe;if(Le==null?Le=D:r(Le,0,8),!X.c)return X.toString();if(Ce=X.c[0],Ze=X.e,de==null)Xe=kr(X.c),Xe=we==1||we==2&&(Ze<=Y||Ze>=le)?m(Xe,Ze):E(Xe,Ze,"0");else if(X=at(new Re(X),de,Le),ke=X.e,Xe=kr(X.c),He=Xe.length,we==1||we==2&&(de<=ke||ke<=Y)){for(;He<de;Xe+="0",He++);Xe=m(Xe,ke)}else if(de-=Ze,Xe=E(Xe,ke,"0"),ke+1>He){if(--de>0)for(Xe+=".";de--;Xe+="0");}else if(de+=ke-He,de>0)for(ke+1==He&&(Xe+=".");de--;Xe+="0");return X.s<0&&Ce?"-"+Xe:Xe}function Je(X,de){for(var Le,we,Ce=1,ke=new Re(X[0]);Ce<X.length;Ce++)we=new Re(X[Ce]),(!we.s||(Le=zs(ke,we))===de||Le===0&&ke.s===de)&&(ke=we);return ke}function yt(X,de,Le){for(var we=1,Ce=de.length;!de[--Ce];de.pop());for(Ce=de[0];Ce>=10;Ce/=10,we++);return(Le=we+Le*_n-1)>Te?X.c=X.e=null:Le<Oe?X.c=[X.e=0]:(X.e=Le,X.c=de),X}g=function(){var X=/^(-?)0([xbo])(?=\w[\w.]*$)/i,de=/^([^.]+)\.$/,Le=/^\.([^.]+)$/,we=/^-?(Infinity|NaN)$/,Ce=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(ke,Ze,He,Xe){var ht,ct=He?Ze:Ze.replace(Ce,"");if(we.test(ct))ke.s=isNaN(ct)?null:ct<0?-1:1;else{if(!He&&(ct=ct.replace(X,function(Rt,Xt,nn){return ht=(nn=nn.toLowerCase())=="x"?16:nn=="b"?2:8,!Xe||Xe==ht?Xt:Rt}),Xe&&(ht=Xe,ct=ct.replace(de,"$1").replace(Le,"0.$1")),Ze!=ct))return new Re(ct,ht);if(Re.DEBUG)throw Error(li+"Not a"+(Xe?" base "+Xe:"")+" number: "+Ze);ke.s=null}ke.c=ke.e=null}}();function at(X,de,Le,we){var Ce,ke,Ze,He,Xe,ht,ct,Rt=X.c,Xt=Zo;if(Rt){e:{for(Ce=1,He=Rt[0];He>=10;He/=10,Ce++);if(ke=de-Ce,ke<0)ke+=_n,Ze=de,Xe=Rt[ht=0],ct=Hi(Xe/Xt[Ce-Ze-1]%10);else if(ht=So((ke+1)/_n),ht>=Rt.length)if(we){for(;Rt.length<=ht;Rt.push(0));Xe=ct=0,Ce=1,ke%=_n,Ze=ke-_n+1}else break e;else{for(Xe=He=Rt[ht],Ce=1;He>=10;He/=10,Ce++);ke%=_n,Ze=ke-_n+Ce,ct=Ze<0?0:Hi(Xe/Xt[Ce-Ze-1]%10)}if(we=we||de<0||Rt[ht+1]!=null||(Ze<0?Xe:Xe%Xt[Ce-Ze-1]),we=Le<4?(ct||we)&&(Le==0||Le==(X.s<0?3:2)):ct>5||ct==5&&(Le==4||we||Le==6&&(ke>0?Ze>0?Xe/Xt[Ce-Ze]:0:Rt[ht-1])%10&1||Le==(X.s<0?8:7)),de<1||!Rt[0])return Rt.length=0,we?(de-=X.e+1,Rt[0]=Xt[(_n-de%_n)%_n],X.e=-de||0):Rt[0]=X.e=0,X;if(ke==0?(Rt.length=ht,He=1,ht--):(Rt.length=ht+1,He=Xt[_n-ke],Rt[ht]=Ze>0?Hi(Xe/Xt[Ce-Ze]%Xt[Ze])*He:0),we)for(;;)if(ht==0){for(ke=1,Ze=Rt[0];Ze>=10;Ze/=10,ke++);for(Ze=Rt[0]+=He,He=1;Ze>=10;Ze/=10,He++);ke!=He&&(X.e++,Rt[0]==Nr&&(Rt[0]=1));break}else{if(Rt[ht]+=He,Rt[ht]!=Nr)break;Rt[ht--]=0,He=1}for(ke=Rt.length;Rt[--ke]===0;Rt.pop());}X.e>Te?X.c=X.e=null:X.e<Oe&&(X.c=[X.e=0])}return X}function gt(X){var de,Le=X.e;return Le===null?X.toString():(de=kr(X.c),de=Le<=Y||Le>=le?m(de,Le):E(de,Le,"0"),X.s<0?"-"+de:de)}return y.absoluteValue=y.abs=function(){var X=new Re(this);return X.s<0&&(X.s=1),X},y.comparedTo=function(X,de){return zs(this,new Re(X,de))},y.decimalPlaces=y.dp=function(X,de){var Le,we,Ce,ke=this;if(X!=null)return r(X,0,pr),de==null?de=D:r(de,0,8),at(new Re(ke),X+ke.e+1,de);if(!(Le=ke.c))return null;if(we=((Ce=Le.length-1)-Pr(this.e/_n))*_n,Ce=Le[Ce])for(;Ce%10==0;Ce/=10,we--);return we<0&&(we=0),we},y.dividedBy=y.div=function(X,de){return l(this,new Re(X,de),B,D)},y.dividedToIntegerBy=y.idiv=function(X,de){return l(this,new Re(X,de),0,1)},y.exponentiatedBy=y.pow=function(X,de){var Le,we,Ce,ke,Ze,He,Xe,ht,ct,Rt=this;if(X=new Re(X),X.c&&!X.isInteger())throw Error(li+"Exponent not an integer: "+gt(X));if(de!=null&&(de=new Re(de)),He=X.e>14,!Rt.c||!Rt.c[0]||Rt.c[0]==1&&!Rt.e&&Rt.c.length==1||!X.c||!X.c[0])return ct=new Re(Math.pow(+gt(Rt),He?X.s*(2-c(X)):+gt(X))),de?ct.mod(de):ct;if(Xe=X.s<0,de){if(de.c?!de.c[0]:!de.s)return new Re(NaN);we=!Xe&&Rt.isInteger()&&de.isInteger(),we&&(Rt=Rt.mod(de))}else{if(X.e>9&&(Rt.e>0||Rt.e<-1||(Rt.e==0?Rt.c[0]>1||He&&Rt.c[1]>=24e7:Rt.c[0]<8e13||He&&Rt.c[0]<=9999975e7)))return ke=Rt.s<0&&c(X)?-0:0,Rt.e>-1&&(ke=1/ke),new Re(Xe?1/ke:ke);Tt&&(ke=So(Tt/_n+2))}for(He?(Le=new Re(.5),Xe&&(X.s=1),ht=c(X)):(Ce=Math.abs(+gt(X)),ht=Ce%2),ct=new Re(S);;){if(ht){if(ct=ct.times(Rt),!ct.c)break;ke?ct.c.length>ke&&(ct.c.length=ke):we&&(ct=ct.mod(de))}if(Ce){if(Ce=Hi(Ce/2),Ce===0)break;ht=Ce%2}else if(X=X.times(Le),at(X,X.e+1,1),X.e>14)ht=c(X);else{if(Ce=+gt(X),Ce===0)break;ht=Ce%2}Rt=Rt.times(Rt),ke?Rt.c&&Rt.c.length>ke&&(Rt.c.length=ke):we&&(Rt=Rt.mod(de))}return we?ct:(Xe&&(ct=S.div(ct)),de?ct.mod(de):ke?at(ct,Tt,D,Ze):ct)},y.integerValue=function(X){var de=new Re(this);return X==null?X=D:r(X,0,8),at(de,de.e+1,X)},y.isEqualTo=y.eq=function(X,de){return zs(this,new Re(X,de))===0},y.isFinite=function(){return!!this.c},y.isGreaterThan=y.gt=function(X,de){return zs(this,new Re(X,de))>0},y.isGreaterThanOrEqualTo=y.gte=function(X,de){return(de=zs(this,new Re(X,de)))===1||de===0},y.isInteger=function(){return!!this.c&&Pr(this.e/_n)>this.c.length-2},y.isLessThan=y.lt=function(X,de){return zs(this,new Re(X,de))<0},y.isLessThanOrEqualTo=y.lte=function(X,de){return(de=zs(this,new Re(X,de)))===-1||de===0},y.isNaN=function(){return!this.s},y.isNegative=function(){return this.s<0},y.isPositive=function(){return this.s>0},y.isZero=function(){return!!this.c&&this.c[0]==0},y.minus=function(X,de){var Le,we,Ce,ke,Ze=this,He=Ze.s;if(X=new Re(X,de),de=X.s,!He||!de)return new Re(NaN);if(He!=de)return X.s=-de,Ze.plus(X);var Xe=Ze.e/_n,ht=X.e/_n,ct=Ze.c,Rt=X.c;if(!Xe||!ht){if(!ct||!Rt)return ct?(X.s=-de,X):new Re(Rt?Ze:NaN);if(!ct[0]||!Rt[0])return Rt[0]?(X.s=-de,X):new Re(ct[0]?Ze:D==3?-0:0)}if(Xe=Pr(Xe),ht=Pr(ht),ct=ct.slice(),He=Xe-ht){for((ke=He<0)?(He=-He,Ce=ct):(ht=Xe,Ce=Rt),Ce.reverse(),de=He;de--;Ce.push(0));Ce.reverse()}else for(we=(ke=(He=ct.length)<(de=Rt.length))?He:de,He=de=0;de<we;de++)if(ct[de]!=Rt[de]){ke=ct[de]<Rt[de];break}if(ke&&(Ce=ct,ct=Rt,Rt=Ce,X.s=-X.s),de=(we=Rt.length)-(Le=ct.length),de>0)for(;de--;ct[Le++]=0);for(de=Nr-1;we>He;){if(ct[--we]<Rt[we]){for(Le=we;Le&&!ct[--Le];ct[Le]=de);--ct[Le],ct[we]+=Nr}ct[we]-=Rt[we]}for(;ct[0]==0;ct.splice(0,1),--ht);return ct[0]?yt(X,ct,ht):(X.s=D==3?-1:1,X.c=[X.e=0],X)},y.modulo=y.mod=function(X,de){var Le,we,Ce=this;return X=new Re(X,de),!Ce.c||!X.s||X.c&&!X.c[0]?new Re(NaN):!X.c||Ce.c&&!Ce.c[0]?new Re(Ce):(pt==9?(we=X.s,X.s=1,Le=l(Ce,X,0,3),X.s=we,Le.s*=we):Le=l(Ce,X,0,pt),X=Ce.minus(Le.times(X)),!X.c[0]&&pt==1&&(X.s=Ce.s),X)},y.multipliedBy=y.times=function(X,de){var Le,we,Ce,ke,Ze,He,Xe,ht,ct,Rt,Xt,nn,an,Jn,ni,$n=this,hi=$n.c,Rr=(X=new Re(X,de)).c;if(!hi||!Rr||!hi[0]||!Rr[0])return!$n.s||!X.s||hi&&!hi[0]&&!Rr||Rr&&!Rr[0]&&!hi?X.c=X.e=X.s=null:(X.s*=$n.s,!hi||!Rr?X.c=X.e=null:(X.c=[0],X.e=0)),X;for(we=Pr($n.e/_n)+Pr(X.e/_n),X.s*=$n.s,Xe=hi.length,Rt=Rr.length,Xe<Rt&&(an=hi,hi=Rr,Rr=an,Ce=Xe,Xe=Rt,Rt=Ce),Ce=Xe+Rt,an=[];Ce--;an.push(0));for(Jn=Nr,ni=ns,Ce=Rt;--Ce>=0;){for(Le=0,Xt=Rr[Ce]%ni,nn=Rr[Ce]/ni|0,Ze=Xe,ke=Ce+Ze;ke>Ce;)ht=hi[--Ze]%ni,ct=hi[Ze]/ni|0,He=nn*ht+ct*Xt,ht=Xt*ht+He%ni*ni+an[ke]+Le,Le=(ht/Jn|0)+(He/ni|0)+nn*ct,an[ke--]=ht%Jn;an[ke]=Le}return Le?++we:an.splice(0,1),yt(X,an,we)},y.negated=function(){var X=new Re(this);return X.s=-X.s||null,X},y.plus=function(X,de){var Le,we=this,Ce=we.s;if(X=new Re(X,de),de=X.s,!Ce||!de)return new Re(NaN);if(Ce!=de)return X.s=-de,we.minus(X);var ke=we.e/_n,Ze=X.e/_n,He=we.c,Xe=X.c;if(!ke||!Ze){if(!He||!Xe)return new Re(Ce/0);if(!He[0]||!Xe[0])return Xe[0]?X:new Re(He[0]?we:Ce*0)}if(ke=Pr(ke),Ze=Pr(Ze),He=He.slice(),Ce=ke-Ze){for(Ce>0?(Ze=ke,Le=Xe):(Ce=-Ce,Le=He),Le.reverse();Ce--;Le.push(0));Le.reverse()}for(Ce=He.length,de=Xe.length,Ce-de<0&&(Le=Xe,Xe=He,He=Le,de=Ce),Ce=0;de;)Ce=(He[--de]=He[de]+Xe[de]+Ce)/Nr|0,He[de]=Nr===He[de]?0:He[de]%Nr;return Ce&&(He=[Ce].concat(He),++Ze),yt(X,He,Ze)},y.precision=y.sd=function(X,de){var Le,we,Ce,ke=this;if(X!=null&&X!==!!X)return r(X,1,pr),de==null?de=D:r(de,0,8),at(new Re(ke),X,de);if(!(Le=ke.c))return null;if(Ce=Le.length-1,we=Ce*_n+1,Ce=Le[Ce]){for(;Ce%10==0;Ce/=10,we--);for(Ce=Le[0];Ce>=10;Ce/=10,we++);}return X&&ke.e+1>we&&(we=ke.e+1),we},y.shiftedBy=function(X){return r(X,-9007199254740991,hl),this.times("1e"+X)},y.squareRoot=y.sqrt=function(){var X,de,Le,we,Ce,ke=this,Ze=ke.c,He=ke.s,Xe=ke.e,ht=B+4,ct=new Re("0.5");if(He!==1||!Ze||!Ze[0])return new Re(!He||He<0&&(!Ze||Ze[0])?NaN:Ze?ke:1/0);if(He=Math.sqrt(+gt(ke)),He==0||He==1/0?(de=kr(Ze),(de.length+Xe)%2==0&&(de+="0"),He=Math.sqrt(+de),Xe=Pr((Xe+1)/2)-(Xe<0||Xe%2),He==1/0?de="5e"+Xe:(de=He.toExponential(),de=de.slice(0,de.indexOf("e")+1)+Xe),Le=new Re(de)):Le=new Re(He+""),Le.c[0]){for(Xe=Le.e,He=Xe+ht,He<3&&(He=0);;)if(Ce=Le,Le=ct.times(Ce.plus(l(ke,Ce,ht,1))),kr(Ce.c).slice(0,He)===(de=kr(Le.c)).slice(0,He))if(Le.e<Xe&&--He,de=de.slice(He-3,He+1),de=="9999"||!we&&de=="4999"){if(!we&&(at(Ce,Ce.e+B+2,0),Ce.times(Ce).eq(ke))){Le=Ce;break}ht+=4,He+=4,we=1}else{(!+de||!+de.slice(1)&&de.charAt(0)=="5")&&(at(Le,Le.e+B+2,1),X=!Le.times(Le).eq(ke));break}}return at(Le,Le.e+B+1,D,X)},y.toExponential=function(X,de){return X!=null&&(r(X,0,pr),X++),qe(this,X,de,1)},y.toFixed=function(X,de){return X!=null&&(r(X,0,pr),X=X+this.e+1),qe(this,X,de)},y.toFormat=function(X,de,Le){var we,Ce=this;if(Le==null)X!=null&&de&&typeof de=="object"?(Le=de,de=null):X&&typeof X=="object"?(Le=X,X=de=null):Le=qt;else if(typeof Le!="object")throw Error(li+"Argument not an object: "+Le);if(we=Ce.toFixed(X,de),Ce.c){var ke,Ze=we.split("."),He=+Le.groupSize,Xe=+Le.secondaryGroupSize,ht=Le.groupSeparator||"",ct=Ze[0],Rt=Ze[1],Xt=Ce.s<0,nn=Xt?ct.slice(1):ct,an=nn.length;if(Xe&&(ke=He,He=Xe,Xe=ke,an-=ke),He>0&&an>0){for(ke=an%He||He,ct=nn.substr(0,ke);ke<an;ke+=He)ct+=ht+nn.substr(ke,He);Xe>0&&(ct+=ht+nn.slice(ke)),Xt&&(ct="-"+ct)}we=Rt?ct+(Le.decimalSeparator||"")+((Xe=+Le.fractionGroupSize)?Rt.replace(new RegExp("\\d{"+Xe+"}\\B","g"),"$&"+(Le.fractionGroupSeparator||"")):Rt):ct}return(Le.prefix||"")+we+(Le.suffix||"")},y.toFraction=function(X){var de,Le,we,Ce,ke,Ze,He,Xe,ht,ct,Rt,Xt,nn=this,an=nn.c;if(X!=null&&(He=new Re(X),!He.isInteger()&&(He.c||He.s!==1)||He.lt(S)))throw Error(li+"Argument "+(He.isInteger()?"out of range: ":"not an integer: ")+gt(He));if(!an)return new Re(nn);for(de=new Re(S),ht=Le=new Re(S),we=Xe=new Re(S),Xt=kr(an),ke=de.e=Xt.length-nn.e-1,de.c[0]=Zo[(Ze=ke%_n)<0?_n+Ze:Ze],X=!X||He.comparedTo(de)>0?ke>0?de:ht:He,Ze=Te,Te=1/0,He=new Re(Xt),Xe.c[0]=0;ct=l(He,de,0,1),Ce=Le.plus(ct.times(we)),Ce.comparedTo(X)!=1;)Le=we,we=Ce,ht=Xe.plus(ct.times(Ce=ht)),Xe=Ce,de=He.minus(ct.times(Ce=de)),He=Ce;return Ce=l(X.minus(Le),we,0,1),Xe=Xe.plus(Ce.times(ht)),Le=Le.plus(Ce.times(we)),Xe.s=ht.s=nn.s,ke=ke*2,Rt=l(ht,we,ke,D).minus(nn).abs().comparedTo(l(Xe,Le,ke,D).minus(nn).abs())<1?[ht,we]:[Xe,Le],Te=Ze,Rt},y.toNumber=function(){return+gt(this)},y.toPrecision=function(X,de){return X!=null&&r(X,1,pr),qe(this,X,de,2)},y.toString=function(X){var de,Le=this,we=Le.s,Ce=Le.e;return Ce===null?we?(de="Infinity",we<0&&(de="-"+de)):de="NaN":(X==null?de=Ce<=Y||Ce>=le?m(kr(Le.c),Ce):E(kr(Le.c),Ce,"0"):X===10&&bn?(Le=at(new Re(Le),B+Ce+1,D),de=E(kr(Le.c),Le.e,"0")):(r(X,2,Vt.length,"Base"),de=h(E(kr(Le.c),Ce,"0"),10,X,we,!0)),we<0&&Le.c[0]&&(de="-"+de)),de},y.valueOf=y.toJSON=function(){return gt(this)},y._isBigNumber=!0,y[Symbol.toStringTag]="BigNumber",y[Symbol.for("nodejs.util.inspect.custom")]=y.valueOf,s!=null&&Re.set(s),Re}function Pr(s){var l=s|0;return s>0||s===l?l:l-1}function kr(s){for(var l,h,g=1,y=s.length,S=s[0]+"";g<y;){for(l=s[g++]+"",h=_n-l.length;h--;l="0"+l);S+=l}for(y=S.length;S.charCodeAt(--y)===48;);return S.slice(0,y+1||1)}function zs(s,l){var h,g,y=s.c,S=l.c,B=s.s,D=l.s,Y=s.e,le=l.e;if(!B||!D)return null;if(h=y&&!y[0],g=S&&!S[0],h||g)return h?g?0:-D:B;if(B!=D)return B;if(h=B<0,g=Y==le,!y||!S)return g?0:!y^h?1:-1;if(!g)return Y>le^h?1:-1;for(D=(Y=y.length)<(le=S.length)?Y:le,B=0;B<D;B++)if(y[B]!=S[B])return y[B]>S[B]^h?1:-1;return Y==le?0:Y>le^h?1:-1}function r(s,l,h,g){if(s<l||s>h||s!==Hi(s))throw Error(li+(g||"Argument")+(typeof s=="number"?s<l||s>h?" out of range: ":" not an integer: ":" not a primitive number: ")+String(s))}function c(s){var l=s.c.length-1;return Pr(s.e/_n)==l&&s.c[l]%2!=0}function m(s,l){return(s.length>1?s.charAt(0)+"."+s.slice(1):s)+(l<0?"e":"e+")+l}function E(s,l,h){var g,y;if(l<0){for(y=h+".";++l;y+=h);s=y+s}else if(g=s.length,++l>g){for(y=h,l-=g;--l;y+=h);s+=y}else l<g&&(s=s.slice(0,l)+"."+s.slice(l));return s}var j=jl(),pe=j,Ve=class{constructor(s){jt(this,"key");jt(this,"left",null);jt(this,"right",null);this.key=s}},dt=class extends Ve{constructor(s){super(s)}},bt=class{constructor(){jt(this,"size",0);jt(this,"modificationCount",0);jt(this,"splayCount",0)}splay(s){let l=this.root;if(l==null)return this.compare(s,s),-1;let h=null,g=null,y=null,S=null,B=l,D=this.compare,Y;for(;;)if(Y=D(B.key,s),Y>0){let le=B.left;if(le==null||(Y=D(le.key,s),Y>0&&(B.left=le.right,le.right=B,B=le,le=B.left,le==null)))break;h==null?g=B:h.left=B,h=B,B=le}else if(Y<0){let le=B.right;if(le==null||(Y=D(le.key,s),Y<0&&(B.right=le.left,le.left=B,B=le,le=B.right,le==null)))break;y==null?S=B:y.right=B,y=B,B=le}else break;return y!=null&&(y.right=B.left,B.left=S),h!=null&&(h.left=B.right,B.right=g),this.root!==B&&(this.root=B,this.splayCount++),Y}splayMin(s){let l=s,h=l.left;for(;h!=null;){let g=h;l.left=g.right,g.right=l,l=g,h=l.left}return l}splayMax(s){let l=s,h=l.right;for(;h!=null;){let g=h;l.right=g.left,g.left=l,l=g,h=l.right}return l}_delete(s){if(this.root==null||this.splay(s)!=0)return null;let l=this.root,h=l,g=l.left;if(this.size--,g==null)this.root=l.right;else{let y=l.right;l=this.splayMax(g),l.right=y,this.root=l}return this.modificationCount++,h}addNewRoot(s,l){this.size++,this.modificationCount++;let h=this.root;if(h==null){this.root=s;return}l<0?(s.left=h,s.right=h.right,h.right=null):(s.right=h,s.left=h.left,h.left=null),this.root=s}_first(){let s=this.root;return s==null?null:(this.root=this.splayMin(s),this.root)}_last(){let s=this.root;return s==null?null:(this.root=this.splayMax(s),this.root)}clear(){this.root=null,this.size=0,this.modificationCount++}has(s){return this.validKey(s)&&this.splay(s)==0}defaultCompare(){return(s,l)=>s<l?-1:s>l?1:0}wrap(){return{getRoot:()=>this.root,setRoot:s=>{this.root=s},getSize:()=>this.size,getModificationCount:()=>this.modificationCount,getSplayCount:()=>this.splayCount,setSplayCount:s=>{this.splayCount=s},splay:s=>this.splay(s),has:s=>this.has(s)}}},It=class lc extends bt{constructor(h,g){super();jt(this,"root",null);jt(this,"compare");jt(this,"validKey");jt(this,Ht,"[object Set]");this.compare=h??this.defaultCompare(),this.validKey=g??(y=>y!=null&&y!=null)}delete(h){return this.validKey(h)?this._delete(h)!=null:!1}deleteAll(h){for(let g of h)this.delete(g)}forEach(h){let g=this[Symbol.iterator](),y;for(;y=g.next(),!y.done;)h(y.value,y.value,this)}add(h){let g=this.splay(h);return g!=0&&this.addNewRoot(new dt(h),g),this}addAndReturn(h){let g=this.splay(h);return g!=0&&this.addNewRoot(new dt(h),g),this.root.key}addAll(h){for(let g of h)this.add(g)}isEmpty(){return this.root==null}isNotEmpty(){return this.root!=null}single(){if(this.size==0)throw"Bad state: No element";if(this.size>1)throw"Bad state: Too many element";return this.root.key}first(){if(this.size==0)throw"Bad state: No element";return this._first().key}last(){if(this.size==0)throw"Bad state: No element";return this._last().key}lastBefore(h){if(h==null)throw"Invalid arguments(s)";if(this.root==null)return null;if(this.splay(h)<0)return this.root.key;let g=this.root.left;if(g==null)return null;let y=g.right;for(;y!=null;)g=y,y=g.right;return g.key}firstAfter(h){if(h==null)throw"Invalid arguments(s)";if(this.root==null)return null;if(this.splay(h)>0)return this.root.key;let g=this.root.right;if(g==null)return null;let y=g.left;for(;y!=null;)g=y,y=g.left;return g.key}retainAll(h){let g=new lc(this.compare,this.validKey),y=this.modificationCount;for(let S of h){if(y!=this.modificationCount)throw"Concurrent modification during iteration.";this.validKey(S)&&this.splay(S)==0&&g.add(this.root.key)}g.size!=this.size&&(this.root=g.root,this.size=g.size,this.modificationCount++)}lookup(h){return!this.validKey(h)||this.splay(h)!=0?null:this.root.key}intersection(h){let g=new lc(this.compare,this.validKey);for(let y of this)h.has(y)&&g.add(y);return g}difference(h){let g=new lc(this.compare,this.validKey);for(let y of this)h.has(y)||g.add(y);return g}union(h){let g=this.clone();return g.addAll(h),g}clone(){let h=new lc(this.compare,this.validKey);return h.size=this.size,h.root=this.copyNode(this.root),h}copyNode(h){if(h==null)return null;function g(S,B){let D,Y;do{if(D=S.left,Y=S.right,D!=null){let le=new dt(D.key);B.left=le,g(D,le)}if(Y!=null){let le=new dt(Y.key);B.right=le,S=Y,B=le}}while(Y!=null)}let y=new dt(h.key);return g(h,y),y}toSet(){return this.clone()}entries(){return new Nn(this.wrap())}keys(){return this[Symbol.iterator]()}values(){return this[Symbol.iterator]()}[(pn=Symbol.iterator,Ht=Symbol.toStringTag,pn)](){return new cn(this.wrap())}},Jt=class{constructor(s){jt(this,"tree");jt(this,"path",new Array);jt(this,"modificationCount",null);jt(this,"splayCount");this.tree=s,this.splayCount=s.getSplayCount()}[Symbol.iterator](){return this}next(){return this.moveNext()?{done:!1,value:this.current()}:{done:!0,value:null}}current(){if(!this.path.length)return null;let s=this.path[this.path.length-1];return this.getValue(s)}rebuildPath(s){this.path.splice(0,this.path.length),this.tree.splay(s),this.path.push(this.tree.getRoot()),this.splayCount=this.tree.getSplayCount()}findLeftMostDescendent(s){for(;s!=null;)this.path.push(s),s=s.left}moveNext(){if(this.modificationCount!=this.tree.getModificationCount()){if(this.modificationCount==null){this.modificationCount=this.tree.getModificationCount();let h=this.tree.getRoot();for(;h!=null;)this.path.push(h),h=h.left;return this.path.length>0}throw"Concurrent modification during iteration."}if(!this.path.length)return!1;this.splayCount!=this.tree.getSplayCount()&&this.rebuildPath(this.path[this.path.length-1].key);let s=this.path[this.path.length-1],l=s.right;if(l!=null){for(;l!=null;)this.path.push(l),l=l.left;return!0}for(this.path.pop();this.path.length&&this.path[this.path.length-1].right===s;)s=this.path.pop();return this.path.length>0}},cn=class extends Jt{getValue(s){return s.key}},Nn=class extends Jt{getValue(s){return[s.key,s.key]}},Sr=s=>s,Wi=s=>{if(s){let l=new It(ko(s)),h=new It(ko(s)),g=(S,B)=>B.addAndReturn(S),y=S=>({x:g(S.x,l),y:g(S.y,h)});return y({x:new pe(0),y:new pe(0)}),y}return Sr},Dr=s=>({set:l=>{Ei=Dr(l)},reset:()=>Dr(s),compare:ko(s),snap:Wi(s),orient:js(s)}),Ei=Dr(),Us=(s,l)=>s.ll.x.isLessThanOrEqualTo(l.x)&&l.x.isLessThanOrEqualTo(s.ur.x)&&s.ll.y.isLessThanOrEqualTo(l.y)&&l.y.isLessThanOrEqualTo(s.ur.y),zl=(s,l)=>{if(l.ur.x.isLessThan(s.ll.x)||s.ur.x.isLessThan(l.ll.x)||l.ur.y.isLessThan(s.ll.y)||s.ur.y.isLessThan(l.ll.y))return null;let h=s.ll.x.isLessThan(l.ll.x)?l.ll.x:s.ll.x,g=s.ur.x.isLessThan(l.ur.x)?s.ur.x:l.ur.x,y=s.ll.y.isLessThan(l.ll.y)?l.ll.y:s.ll.y,S=s.ur.y.isLessThan(l.ur.y)?s.ur.y:l.ur.y;return{ll:{x:h,y},ur:{x:g,y:S}}},bs=(s,l)=>s.x.times(l.y).minus(s.y.times(l.x)),is=(s,l)=>s.x.times(l.x).plus(s.y.times(l.y)),Vr=s=>is(s,s).sqrt(),Hu=(s,l,h)=>{let g={x:l.x.minus(s.x),y:l.y.minus(s.y)},y={x:h.x.minus(s.x),y:h.y.minus(s.y)};return bs(y,g).div(Vr(y)).div(Vr(g))},Ul=(s,l,h)=>{let g={x:l.x.minus(s.x),y:l.y.minus(s.y)},y={x:h.x.minus(s.x),y:h.y.minus(s.y)};return is(y,g).div(Vr(y)).div(Vr(g))},si=(s,l,h)=>l.y.isZero()?null:{x:s.x.plus(l.x.div(l.y).times(h.minus(s.y))),y:h},gr=(s,l,h)=>l.x.isZero()?null:{x:h,y:s.y.plus(l.y.div(l.x).times(h.minus(s.x)))},Wu=(s,l,h,g)=>{if(l.x.isZero())return gr(h,g,s.x);if(g.x.isZero())return gr(s,l,h.x);if(l.y.isZero())return si(h,g,s.y);if(g.y.isZero())return si(s,l,h.y);let y=bs(l,g);if(y.isZero())return null;let S={x:h.x.minus(s.x),y:h.y.minus(s.y)},B=bs(S,l).div(y),D=bs(S,g).div(y),Y=s.x.plus(D.times(l.x)),le=h.x.plus(B.times(g.x)),Oe=s.y.plus(D.times(l.y)),Te=h.y.plus(B.times(g.y)),it=Y.plus(le).div(2),pt=Oe.plus(Te).div(2);return{x:it,y:pt}},$s=class R1{constructor(l,h){jt(this,"point");jt(this,"isLeft");jt(this,"segment");jt(this,"otherSE");jt(this,"consumedBy");l.events===void 0?l.events=[this]:l.events.push(this),this.point=l,this.isLeft=h}static compare(l,h){let g=R1.comparePoints(l.point,h.point);return g!==0?g:(l.point!==h.point&&l.link(h),l.isLeft!==h.isLeft?l.isLeft?1:-1:Ko.compare(l.segment,h.segment))}static comparePoints(l,h){return l.x.isLessThan(h.x)?-1:l.x.isGreaterThan(h.x)?1:l.y.isLessThan(h.y)?-1:l.y.isGreaterThan(h.y)?1:0}link(l){if(l.point===this.point)throw new Error("Tried to link already linked events");let h=l.point.events;for(let g=0,y=h.length;g<y;g++){let S=h[g];this.point.events.push(S),S.point=this.point}this.checkForConsuming()}checkForConsuming(){let l=this.point.events.length;for(let h=0;h<l;h++){let g=this.point.events[h];if(g.segment.consumedBy===void 0)for(let y=h+1;y<l;y++){let S=this.point.events[y];S.consumedBy===void 0&&g.otherSE.point.events===S.otherSE.point.events&&g.segment.consume(S.segment)}}}getAvailableLinkedEvents(){let l=[];for(let h=0,g=this.point.events.length;h<g;h++){let y=this.point.events[h];y!==this&&!y.segment.ringOut&&y.segment.isInResult()&&l.push(y)}return l}getLeftmostComparator(l){let h=new Map,g=y=>{let S=y.otherSE;h.set(y,{sine:Hu(this.point,l.point,S.point),cosine:Ul(this.point,l.point,S.point)})};return(y,S)=>{h.has(y)||g(y),h.has(S)||g(S);let{sine:B,cosine:D}=h.get(y),{sine:Y,cosine:le}=h.get(S);return B.isGreaterThanOrEqualTo(0)&&Y.isGreaterThanOrEqualTo(0)?D.isLessThan(le)?1:D.isGreaterThan(le)?-1:0:B.isLessThan(0)&&Y.isLessThan(0)?D.isLessThan(le)?-1:D.isGreaterThan(le)?1:0:Y.isLessThan(B)?-1:Y.isGreaterThan(B)?1:0}}},du=0,Ko=class yh{constructor(l,h,g,y){jt(this,"id");jt(this,"leftSE");jt(this,"rightSE");jt(this,"rings");jt(this,"windings");jt(this,"ringOut");jt(this,"consumedBy");jt(this,"prev");jt(this,"_prevInResult");jt(this,"_beforeState");jt(this,"_afterState");jt(this,"_isInResult");this.id=++du,this.leftSE=l,l.segment=this,l.otherSE=h,this.rightSE=h,h.segment=this,h.otherSE=l,this.rings=g,this.windings=y}static compare(l,h){let g=l.leftSE.point.x,y=h.leftSE.point.x,S=l.rightSE.point.x,B=h.rightSE.point.x;if(B.isLessThan(g))return 1;if(S.isLessThan(y))return-1;let D=l.leftSE.point.y,Y=h.leftSE.point.y,le=l.rightSE.point.y,Oe=h.rightSE.point.y;if(g.isLessThan(y)){if(Y.isLessThan(D)&&Y.isLessThan(le))return 1;if(Y.isGreaterThan(D)&&Y.isGreaterThan(le))return-1;let Te=l.comparePoint(h.leftSE.point);if(Te<0)return 1;if(Te>0)return-1;let it=h.comparePoint(l.rightSE.point);return it!==0?it:-1}if(g.isGreaterThan(y)){if(D.isLessThan(Y)&&D.isLessThan(Oe))return-1;if(D.isGreaterThan(Y)&&D.isGreaterThan(Oe))return 1;let Te=h.comparePoint(l.leftSE.point);if(Te!==0)return Te;let it=l.comparePoint(h.rightSE.point);return it<0?1:it>0?-1:1}if(D.isLessThan(Y))return-1;if(D.isGreaterThan(Y))return 1;if(S.isLessThan(B)){let Te=h.comparePoint(l.rightSE.point);if(Te!==0)return Te}if(S.isGreaterThan(B)){let Te=l.comparePoint(h.rightSE.point);if(Te<0)return 1;if(Te>0)return-1}if(!S.eq(B)){let Te=le.minus(D),it=S.minus(g),pt=Oe.minus(Y),Tt=B.minus(y);if(Te.isGreaterThan(it)&&pt.isLessThan(Tt))return 1;if(Te.isLessThan(it)&&pt.isGreaterThan(Tt))return-1}return S.isGreaterThan(B)?1:S.isLessThan(B)||le.isLessThan(Oe)?-1:le.isGreaterThan(Oe)?1:l.id<h.id?-1:l.id>h.id?1:0}static fromRing(l,h,g){let y,S,B,D=$s.comparePoints(l,h);if(D<0)y=l,S=h,B=1;else if(D>0)y=h,S=l,B=-1;else throw new Error(`Tried to create degenerate segment at [${l.x}, ${l.y}]`);let Y=new $s(y,!0),le=new $s(S,!1);return new yh(Y,le,[g],[B])}replaceRightSE(l){this.rightSE=l,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}bbox(){let l=this.leftSE.point.y,h=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:l.isLessThan(h)?l:h},ur:{x:this.rightSE.point.x,y:l.isGreaterThan(h)?l:h}}}vector(){return{x:this.rightSE.point.x.minus(this.leftSE.point.x),y:this.rightSE.point.y.minus(this.leftSE.point.y)}}isAnEndpoint(l){return l.x.eq(this.leftSE.point.x)&&l.y.eq(this.leftSE.point.y)||l.x.eq(this.rightSE.point.x)&&l.y.eq(this.rightSE.point.y)}comparePoint(l){return Ei.orient(this.leftSE.point,l,this.rightSE.point)}getIntersection(l){let h=this.bbox(),g=l.bbox(),y=zl(h,g);if(y===null)return null;let S=this.leftSE.point,B=this.rightSE.point,D=l.leftSE.point,Y=l.rightSE.point,le=Us(h,D)&&this.comparePoint(D)===0,Oe=Us(g,S)&&l.comparePoint(S)===0,Te=Us(h,Y)&&this.comparePoint(Y)===0,it=Us(g,B)&&l.comparePoint(B)===0;if(Oe&&le)return it&&!Te?B:!it&&Te?Y:null;if(Oe)return Te&&S.x.eq(Y.x)&&S.y.eq(Y.y)?null:S;if(le)return it&&B.x.eq(D.x)&&B.y.eq(D.y)?null:D;if(it&&Te)return null;if(it)return B;if(Te)return Y;let pt=Wu(S,this.vector(),D,l.vector());return pt===null||!Us(y,pt)?null:Ei.snap(pt)}split(l){let h=[],g=l.events!==void 0,y=new $s(l,!0),S=new $s(l,!1),B=this.rightSE;this.replaceRightSE(S),h.push(S),h.push(y);let D=new yh(y,B,this.rings.slice(),this.windings.slice());return $s.comparePoints(D.leftSE.point,D.rightSE.point)>0&&D.swapEvents(),$s.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),g&&(y.checkForConsuming(),S.checkForConsuming()),h}swapEvents(){let l=this.rightSE;this.rightSE=this.leftSE,this.leftSE=l,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(let h=0,g=this.windings.length;h<g;h++)this.windings[h]*=-1}consume(l){let h=this,g=l;for(;h.consumedBy;)h=h.consumedBy;for(;g.consumedBy;)g=g.consumedBy;let y=yh.compare(h,g);if(y!==0){if(y>0){let S=h;h=g,g=S}if(h.prev===g){let S=h;h=g,g=S}for(let S=0,B=g.rings.length;S<B;S++){let D=g.rings[S],Y=g.windings[S],le=h.rings.indexOf(D);le===-1?(h.rings.push(D),h.windings.push(Y)):h.windings[le]+=Y}g.rings=null,g.windings=null,g.consumedBy=h,g.leftSE.consumedBy=h.leftSE,g.rightSE.consumedBy=h.rightSE}}prevInResult(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}beforeState(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{let l=this.prev.consumedBy||this.prev;this._beforeState=l.afterState()}return this._beforeState}afterState(){if(this._afterState!==void 0)return this._afterState;let l=this.beforeState();this._afterState={rings:l.rings.slice(0),windings:l.windings.slice(0),multiPolys:[]};let h=this._afterState.rings,g=this._afterState.windings,y=this._afterState.multiPolys;for(let D=0,Y=this.rings.length;D<Y;D++){let le=this.rings[D],Oe=this.windings[D],Te=h.indexOf(le);Te===-1?(h.push(le),g.push(Oe)):g[Te]+=Oe}let S=[],B=[];for(let D=0,Y=h.length;D<Y;D++){if(g[D]===0)continue;let le=h[D],Oe=le.poly;if(B.indexOf(Oe)===-1)if(le.isExterior)S.push(Oe);else{B.indexOf(Oe)===-1&&B.push(Oe);let Te=S.indexOf(le.poly);Te!==-1&&S.splice(Te,1)}}for(let D=0,Y=S.length;D<Y;D++){let le=S[D].multiPoly;y.indexOf(le)===-1&&y.push(le)}return this._afterState}isInResult(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;let l=this.beforeState().multiPolys,h=this.afterState().multiPolys;switch(gu.type){case"union":{let g=l.length===0,y=h.length===0;this._isInResult=g!==y;break}case"intersection":{let g,y;l.length<h.length?(g=l.length,y=h.length):(g=h.length,y=l.length),this._isInResult=y===gu.numMultiPolys&&g<y;break}case"xor":{let g=Math.abs(l.length-h.length);this._isInResult=g%2===1;break}case"difference":{let g=y=>y.length===1&&y[0].isSubject;this._isInResult=g(l)!==g(h);break}}return this._isInResult}},dl=class{constructor(s,l,h){jt(this,"poly");jt(this,"isExterior");jt(this,"segments");jt(this,"bbox");if(!Array.isArray(s)||s.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=l,this.isExterior=h,this.segments=[],typeof s[0][0]!="number"||typeof s[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");let g=Ei.snap({x:new pe(s[0][0]),y:new pe(s[0][1])});this.bbox={ll:{x:g.x,y:g.y},ur:{x:g.x,y:g.y}};let y=g;for(let S=1,B=s.length;S<B;S++){if(typeof s[S][0]!="number"||typeof s[S][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");let D=Ei.snap({x:new pe(s[S][0]),y:new pe(s[S][1])});D.x.eq(y.x)&&D.y.eq(y.y)||(this.segments.push(Ko.fromRing(y,D,this)),D.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=D.x),D.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=D.y),D.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=D.x),D.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=D.y),y=D)}(!g.x.eq(y.x)||!g.y.eq(y.y))&&this.segments.push(Ko.fromRing(y,g,this))}getSweepEvents(){let s=[];for(let l=0,h=this.segments.length;l<h;l++){let g=this.segments[l];s.push(g.leftSE),s.push(g.rightSE)}return s}},fu=class{constructor(s,l){jt(this,"multiPoly");jt(this,"exteriorRing");jt(this,"interiorRings");jt(this,"bbox");if(!Array.isArray(s))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new dl(s[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(let h=1,g=s.length;h<g;h++){let y=new dl(s[h],this,!1);y.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=y.bbox.ll.x),y.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=y.bbox.ll.y),y.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=y.bbox.ur.x),y.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=y.bbox.ur.y),this.interiorRings.push(y)}this.multiPoly=l}getSweepEvents(){let s=this.exteriorRing.getSweepEvents();for(let l=0,h=this.interiorRings.length;l<h;l++){let g=this.interiorRings[l].getSweepEvents();for(let y=0,S=g.length;y<S;y++)s.push(g[y])}return s}},Uc=class{constructor(s,l){jt(this,"isSubject");jt(this,"polys");jt(this,"bbox");if(!Array.isArray(s))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof s[0][0][0]=="number"&&(s=[s])}catch{}this.polys=[],this.bbox={ll:{x:new pe(Number.POSITIVE_INFINITY),y:new pe(Number.POSITIVE_INFINITY)},ur:{x:new pe(Number.NEGATIVE_INFINITY),y:new pe(Number.NEGATIVE_INFINITY)}};for(let h=0,g=s.length;h<g;h++){let y=new fu(s[h],this);y.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=y.bbox.ll.x),y.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=y.bbox.ll.y),y.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=y.bbox.ur.x),y.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=y.bbox.ur.y),this.polys.push(y)}this.isSubject=l}getSweepEvents(){let s=[];for(let l=0,h=this.polys.length;l<h;l++){let g=this.polys[l].getSweepEvents();for(let y=0,S=g.length;y<S;y++)s.push(g[y])}return s}},pu=class kf{constructor(l){jt(this,"events");jt(this,"poly");jt(this,"_isExteriorRing");jt(this,"_enclosingRing");this.events=l;for(let h=0,g=l.length;h<g;h++)l[h].segment.ringOut=this;this.poly=null}static factory(l){let h=[];for(let g=0,y=l.length;g<y;g++){let S=l[g];if(!S.isInResult()||S.ringOut)continue;let B=null,D=S.leftSE,Y=S.rightSE,le=[D],Oe=D.point,Te=[];for(;B=D,D=Y,le.push(D),D.point!==Oe;)for(;;){let it=D.getAvailableLinkedEvents();if(it.length===0){let qt=le[0].point,Vt=le[le.length-1].point;throw new Error(`Unable to complete output ring starting at [${qt.x}, ${qt.y}]. Last matching segment found ends at [${Vt.x}, ${Vt.y}].`)}if(it.length===1){Y=it[0].otherSE;break}let pt=null;for(let qt=0,Vt=Te.length;qt<Vt;qt++)if(Te[qt].point===D.point){pt=qt;break}if(pt!==null){let qt=Te.splice(pt)[0],Vt=le.splice(qt.index);Vt.unshift(Vt[0].otherSE),h.push(new kf(Vt.reverse()));continue}Te.push({index:le.length,point:D.point});let Tt=D.getLeftmostComparator(B);Y=it.sort(Tt)[0].otherSE;break}h.push(new kf(le))}return h}getGeom(){let l=this.events[0].point,h=[l];for(let le=1,Oe=this.events.length-1;le<Oe;le++){let Te=this.events[le].point,it=this.events[le+1].point;Ei.orient(Te,l,it)!==0&&(h.push(Te),l=Te)}if(h.length===1)return null;let g=h[0],y=h[1];Ei.orient(g,l,y)===0&&h.shift(),h.push(h[0]);let S=this.isExteriorRing()?1:-1,B=this.isExteriorRing()?0:h.length-1,D=this.isExteriorRing()?h.length:-1,Y=[];for(let le=B;le!=D;le+=S)Y.push([h[le].x.toNumber(),h[le].y.toNumber()]);return Y}isExteriorRing(){if(this._isExteriorRing===void 0){let l=this.enclosingRing();this._isExteriorRing=l?!l.isExteriorRing():!0}return this._isExteriorRing}enclosingRing(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}_calcEnclosingRing(){var y,S;let l=this.events[0];for(let B=1,D=this.events.length;B<D;B++){let Y=this.events[B];$s.compare(l,Y)>0&&(l=Y)}let h=l.segment.prevInResult(),g=h?h.prevInResult():null;for(;;){if(!h)return null;if(!g)return h.ringOut;if(g.ringOut!==h.ringOut)return((y=g.ringOut)==null?void 0:y.enclosingRing())!==h.ringOut?h.ringOut:(S=h.ringOut)==null?void 0:S.enclosingRing();h=g.prevInResult(),g=h?h.prevInResult():null}}},$l=class{constructor(s){jt(this,"exteriorRing");jt(this,"interiorRings");this.exteriorRing=s,s.poly=this,this.interiorRings=[]}addInterior(s){this.interiorRings.push(s),s.poly=this}getGeom(){let s=this.exteriorRing.getGeom();if(s===null)return null;let l=[s];for(let h=0,g=this.interiorRings.length;h<g;h++){let y=this.interiorRings[h].getGeom();y!==null&&l.push(y)}return l}},ql=class{constructor(s){jt(this,"rings");jt(this,"polys");this.rings=s,this.polys=this._composePolys(s)}getGeom(){let s=[];for(let l=0,h=this.polys.length;l<h;l++){let g=this.polys[l].getGeom();g!==null&&s.push(g)}return s}_composePolys(s){var h;let l=[];for(let g=0,y=s.length;g<y;g++){let S=s[g];if(!S.poly)if(S.isExteriorRing())l.push(new $l(S));else{let B=S.enclosingRing();B!=null&&B.poly||l.push(new $l(B)),(h=B==null?void 0:B.poly)==null||h.addInterior(S)}}return l}},Zu=class{constructor(s,l=Ko.compare){jt(this,"queue");jt(this,"tree");jt(this,"segments");this.queue=s,this.tree=new It(l),this.segments=[]}process(s){let l=s.segment,h=[];if(s.consumedBy)return s.isLeft?this.queue.delete(s.otherSE):this.tree.delete(l),h;s.isLeft&&this.tree.add(l);let g=l,y=l;do g=this.tree.lastBefore(g);while(g!=null&&g.consumedBy!=null);do y=this.tree.firstAfter(y);while(y!=null&&y.consumedBy!=null);if(s.isLeft){let S=null;if(g){let D=g.getIntersection(l);if(D!==null&&(l.isAnEndpoint(D)||(S=D),!g.isAnEndpoint(D))){let Y=this._splitSafely(g,D);for(let le=0,Oe=Y.length;le<Oe;le++)h.push(Y[le])}}let B=null;if(y){let D=y.getIntersection(l);if(D!==null&&(l.isAnEndpoint(D)||(B=D),!y.isAnEndpoint(D))){let Y=this._splitSafely(y,D);for(let le=0,Oe=Y.length;le<Oe;le++)h.push(Y[le])}}if(S!==null||B!==null){let D=null;S===null?D=B:B===null?D=S:D=$s.comparePoints(S,B)<=0?S:B,this.queue.delete(l.rightSE),h.push(l.rightSE);let Y=l.split(D);for(let le=0,Oe=Y.length;le<Oe;le++)h.push(Y[le])}h.length>0?(this.tree.delete(l),h.push(s)):(this.segments.push(l),l.prev=g)}else{if(g&&y){let S=g.getIntersection(y);if(S!==null){if(!g.isAnEndpoint(S)){let B=this._splitSafely(g,S);for(let D=0,Y=B.length;D<Y;D++)h.push(B[D])}if(!y.isAnEndpoint(S)){let B=this._splitSafely(y,S);for(let D=0,Y=B.length;D<Y;D++)h.push(B[D])}}}this.tree.delete(l)}return h}_splitSafely(s,l){this.tree.delete(s);let h=s.rightSE;this.queue.delete(h);let g=s.split(l);return g.push(h),s.consumedBy===void 0&&this.tree.add(s),g}},md=class{constructor(){jt(this,"type");jt(this,"numMultiPolys")}run(s,l,h){fl.type=s;let g=[new Uc(l,!0)];for(let Y=0,le=h.length;Y<le;Y++)g.push(new Uc(h[Y],!1));if(fl.numMultiPolys=g.length,fl.type==="difference"){let Y=g[0],le=1;for(;le<g.length;)zl(g[le].bbox,Y.bbox)!==null?le++:g.splice(le,1)}if(fl.type==="intersection")for(let Y=0,le=g.length;Y<le;Y++){let Oe=g[Y];for(let Te=Y+1,it=g.length;Te<it;Te++)if(zl(Oe.bbox,g[Te].bbox)===null)return[]}let y=new It($s.compare);for(let Y=0,le=g.length;Y<le;Y++){let Oe=g[Y].getSweepEvents();for(let Te=0,it=Oe.length;Te<it;Te++)y.add(Oe[Te])}let S=new Zu(y),B=null;for(y.size!=0&&(B=y.first(),y.delete(B));B;){let Y=S.process(B);for(let le=0,Oe=Y.length;le<Oe;le++){let Te=Y[le];Te.consumedBy===void 0&&y.add(Te)}y.size!=0?(B=y.first(),y.delete(B)):B=null}Ei.reset();let D=pu.factory(S.segments);return new ql(D).getGeom()}},fl=new md,gu=fl,vd=(s,...l)=>gu.run("intersection",s,l),yd=(s,...l)=>gu.run("difference",s,l);Ei.set;function mu(s){let l={type:"Feature"};return l.geometry=s,l}function vu(s){return s.type==="Feature"?s.geometry:s}function $c(s){return s&&s.geometry&&s.geometry.coordinates?s.geometry.coordinates:s}function qc(s){return mu({type:"LineString",coordinates:s})}function yu(s){return mu({type:"MultiLineString",coordinates:s})}function Vc(s){return mu({type:"Polygon",coordinates:s})}function Gc(s){return mu({type:"MultiPolygon",coordinates:s})}function Hc(s,l){let h=vu(s),g=vu(l),y=vd(h.coordinates,g.coordinates);return y.length===0?null:y.length===1?Vc(y[0]):Gc(y)}function p(s,l){let h=vu(s),g=vu(l),y=yd(h.coordinates,g.coordinates);return y.length===0?null:y.length===1?Vc(y[0]):Gc(y)}function b(s){return Array.isArray(s)?1+b(s[0]):-1}function M(s){s instanceof L.Polyline&&(s=s.toGeoJSON(15));let l=$c(s),h=b(l),g=[];return h>1?l.forEach(y=>{g.push(qc(y))}):g.push(s),g}function I(s){let l=[];return s.eachLayer(h=>{l.push($c(h.toGeoJSON(15)))}),yu(l)}Bi.Cut=Bi.Polygon.extend({initialize(s){this._map=s,this._shape="Cut",this.toolbarButtonName="cutPolygon"},_finishShape(){if(this._editedLayers=[],!this.options.allowSelfIntersection&&(this._handleSelfIntersection(!0,this._layer.getLatLngs()[0]),this._doesSelfIntersect)||this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;let s=this._layer.getLatLngs();if(s.length<=2)return;let l=L.polygon(s,this.options.pathOptions);l._latlngInfos=this._layer._latlngInfo,this.cut(l),this._cleanupSnapping(),this._otherSnapLayers.splice(this._tempSnapLayerIndex,1),delete this._tempSnapLayerIndex,this._editedLayers.forEach(({layer:g,originalLayer:y})=>{this._fireCut(y,g,y),this._fireCut(this._map,g,y),y.pm._fireEdit()}),this._editedLayers=[];let h=this._hintMarker.getLatLng();this.disable(),this.options.continueDrawing&&(this.enable(),this._hintMarker.setLatLng(h))},cut(s){let l=this._map._layers,h=s._latlngInfos||[];Object.keys(l).map(g=>l[g]).filter(g=>g.pm).filter(g=>!g._pmTempLayer).filter(g=>!L.PM.optIn&&!g.options.pmIgnore||L.PM.optIn&&g.options.pmIgnore===!1).filter(g=>g instanceof L.Polyline).filter(g=>g!==s).filter(g=>g.pm.options.allowCutting).filter(g=>this.options.layersToCut&&L.Util.isArray(this.options.layersToCut)&&this.options.layersToCut.length>0?this.options.layersToCut.indexOf(g)>-1:!0).filter(g=>!this._layerGroup.hasLayer(g)).filter(g=>{try{let y=!!Lr(s.toGeoJSON(15),g.toGeoJSON(15)).features.length>0;return y||g instanceof L.Polyline&&!(g instanceof L.Polygon)?y:!!Hc(s.toGeoJSON(15),g.toGeoJSON(15))}catch{return g instanceof L.Polygon&&console.error("You can't cut polygons with self-intersections"),!1}}).forEach(g=>{let y;if(g instanceof L.Polygon){y=L.polygon(g.getLatLngs());let Y=y.getLatLngs();h.forEach(le=>{if(le&&le.snapInfo){let{latlng:Oe}=le,Te=this._calcClosestLayer(Oe,[y]);if(Te&&Te.segment&&Te.distance<this.options.snapDistance){let{segment:it}=Te;if(it&&it.length===2){let{indexPath:pt,parentPath:Tt,newIndex:qt}=L.PM.Utils._getIndexFromSegment(Y,it);(pt.length>1?(0,ai.default)(Y,Tt):Y).splice(qt,0,Oe)}}}})}else y=g;let S=this._cutLayer(s,y),B=L.geoJSON(S,g.options);B.getLayers().length===1&&([B]=B.getLayers()),this._setPane(B,"layerPane");let D=B.addTo(this._map.pm._getContainingLayer());if(D.pm.enable(g.pm.options),D.pm.disable(),g._pmTempLayer=!0,s._pmTempLayer=!0,g.remove(),g.removeFrom(this._map.pm._getContainingLayer()),s.remove(),s.removeFrom(this._map.pm._getContainingLayer()),D.getLayers&&D.getLayers().length===0&&this._map.pm.removeLayer({target:D}),D instanceof L.LayerGroup?(D.eachLayer(Y=>{this._addDrawnLayerProp(Y)}),this._addDrawnLayerProp(D)):this._addDrawnLayerProp(D),this.options.layersToCut&&L.Util.isArray(this.options.layersToCut)&&this.options.layersToCut.length>0){let Y=this.options.layersToCut.indexOf(g);Y>-1&&this.options.layersToCut.splice(Y,1)}this._editedLayers.push({layer:D,originalLayer:g})})},_cutLayer(s,l){let h=L.geoJSON(),g;if(l instanceof L.Polygon)g=p(l.toGeoJSON(15),s.toGeoJSON(15));else{let y=M(l);y.forEach(S=>{let B=Cr(S,s.toGeoJSON(15)),D;B&&B.features.length>0?D=L.geoJSON(B):D=L.geoJSON(S),D.getLayers().forEach(Y=>{Lo(s.toGeoJSON(15),Y.toGeoJSON(15))||Y.addTo(h)})}),y.length>1?g=I(h):g=h.toGeoJSON(15)}return g},_change:L.Util.falseFn}),Bi.Text=Bi.extend({initialize(s){this._map=s,this._shape="Text",this.toolbarButtonName="drawText"},enable(s){L.Util.setOptions(this,s),this._enabled=!0,this._map.on("click",this._createMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._hintMarker=L.marker(this._map.getCenter(),{interactive:!1,zIndexOffset:100,icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._setPane(this._hintMarker,"vertexPane"),this._hintMarker._pmTempLayer=!0,this._hintMarker.addTo(this._map),this.options.cursorMarker&&L.DomUtil.addClass(this._hintMarker._icon,"visible"),this.options.tooltips&&this._hintMarker.bindTooltip(dn("tooltips.placeText"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this._layer=this._hintMarker,this._map.on("mousemove",this._syncHintMarker,this),this._map.getContainer().classList.add("geoman-draw-cursor"),this._fireDrawStart(),this._setGlobalDrawMode()},disable(){var s;this._enabled&&(this._enabled=!1,this._map.off("click",this._createMarker,this),(s=this._hintMarker)==null||s.remove(),this._map.getContainer().classList.remove("geoman-draw-cursor"),this._map.off("mousemove",this._syncHintMarker,this),this._map.off("mousemove",this._showHintMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},enabled(){return this._enabled},toggle(s){this.enabled()?this.disable():this.enable(s)},_syncHintMarker(s){if(this._hintMarker.setLatLng(s.latlng),this.options.snappable){let l=s;l.target=this._hintMarker,this._handleSnapping(l)}},_createMarker(s){var y,S,B,D;if(!s.latlng||this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;this._hintMarker._snapped||this._hintMarker.setLatLng(s.latlng);let l=this._hintMarker.getLatLng();if(this.textArea=this._createTextArea(),(y=this.options.textOptions)==null?void 0:y.className){let Y=this.options.textOptions.className.split(" ");this.textArea.classList.add(...Y)}let h=this._createTextIcon(this.textArea),g=new L.Marker(l,{textMarker:!0,_textMarkerOverPM:!0,icon:h});if(this._setPane(g,"markerPane"),this._finishLayer(g),g.pm||(g.options.draggable=!1),g.addTo(this._map.pm._getContainingLayer()),g.pm){g.pm.textArea=this.textArea,L.setOptions(g.pm,{removeIfEmpty:((S=this.options.textOptions)==null?void 0:S.removeIfEmpty)??!0});let Y=((B=this.options.textOptions)==null?void 0:B.focusAfterDraw)??!0;g.pm._createTextMarker(Y),(D=this.options.textOptions)!=null&&D.text&&g.pm.setText(this.options.textOptions.text)}this._fireCreate(g),this._cleanupSnapping(),this.disable(),this.options.continueDrawing&&this._map.once("mousemove",this._showHintMarkerAfterMoving,this)},_showHintMarkerAfterMoving(s){this.enable(),this._hintMarker.setLatLng(s.latlng)},_createTextArea(){let s=document.createElement("textarea");return s.readOnly=!0,s.classList.add("pm-textarea","pm-disabled"),s},_createTextIcon(s){return L.divIcon({className:"pm-text-marker",html:s})}});var re={enableLayerDrag(){if(!this.options.draggable||!this._layer._map)return;this.disable(),this._layerDragEnabled=!0,this._map||(this._map=this._layer._map),(this._layer instanceof L.Marker||this._layer instanceof L.ImageOverlay)&&L.DomEvent.on(this._getDOMElem(),"dragstart",this._stopDOMImageDrag),this._layer.dragging&&this._layer.dragging.disable(),this._tempDragCoord=null,qi(this._layer)instanceof L.Canvas?(this._layer.on("mouseout",this.removeDraggingClass,this),this._layer.on("mouseover",this.addDraggingClass,this)):this.addDraggingClass(),this._originalMapDragState=this._layer._map.dragging._enabled,this._safeToCacheDragState=!0;let s=this._getDOMElem();s&&(qi(this._layer)instanceof L.Canvas?(this._layer.on("touchstart mousedown",this._dragMixinOnMouseDown,this),this._map.pm._addTouchEvents(s)):L.DomEvent.on(s,"touchstart mousedown",this._simulateMouseDownEvent,this)),this._fireDragEnable()},disableLayerDrag(){this._layerDragEnabled=!1,qi(this._layer)instanceof L.Canvas?(this._layer.off("mouseout",this.removeDraggingClass,this),this._layer.off("mouseover",this.addDraggingClass,this)):this.removeDraggingClass(),this._originalMapDragState&&this._dragging&&this._map.dragging.enable(),this._safeToCacheDragState=!1,this._layer.dragging&&this._layer.dragging.disable();let s=this._getDOMElem();s&&(qi(this._layer)instanceof L.Canvas?(this._layer.off("touchstart mousedown",this._dragMixinOnMouseDown,this),this._map.pm._removeTouchEvents(s)):L.DomEvent.off(s,"touchstart mousedown",this._simulateMouseDownEvent,this)),this._layerDragged&&this._fireUpdate(),this._layerDragged=!1,this._fireDragDisable()},dragging(){return this._dragging},layerDragEnabled(){return!!this._layerDragEnabled},_simulateMouseDownEvent(s){let l=s.touches?s.touches[0]:s,h={originalEvent:l,target:this._layer};return h.containerPoint=this._map.mouseEventToContainerPoint(l),h.latlng=this._map.containerPointToLatLng(h.containerPoint),this._dragMixinOnMouseDown(h),!1},_simulateMouseMoveEvent(s){let l=s.touches?s.touches[0]:s,h={originalEvent:l,target:this._layer};return h.containerPoint=this._map.mouseEventToContainerPoint(l),h.latlng=this._map.containerPointToLatLng(h.containerPoint),this._dragMixinOnMouseMove(h),!1},_simulateMouseUpEvent(s){let l={originalEvent:s.touches?s.touches[0]:s,target:this._layer};return s.type.indexOf("touch")===-1&&(l.containerPoint=this._map.mouseEventToContainerPoint(s),l.latlng=this._map.containerPointToLatLng(l.containerPoint)),this._dragMixinOnMouseUp(l),!1},_dragMixinOnMouseDown(s){if(s.originalEvent.button>0)return;this._overwriteEventIfItComesFromMarker(s);let l=s._fromLayerSync,h=this._syncLayers("_dragMixinOnMouseDown",s);if(this._layer instanceof L.Marker&&(this.options.snappable&&!l&&!h?this._initSnappableMarkers():this._disableSnapping()),this._layer instanceof L.CircleMarker){let g="resizeableCircleMarker";this._layer instanceof L.Circle&&(g="resizeableCircle"),this.options.snappable&&!l&&!h?this._layer.pm.options[g]||this._initSnappableMarkersDrag():this._layer.pm.options[g]?this._layer.pm._disableSnapping():this._layer.pm._disableSnappingDrag()}this._safeToCacheDragState&&(this._originalMapDragState=this._layer._map.dragging._enabled,this._safeToCacheDragState=!1),this._tempDragCoord=s.latlng,L.DomEvent.on(this._map.getContainer(),"touchend mouseup",this._simulateMouseUpEvent,this),L.DomEvent.on(this._map.getContainer(),"touchmove mousemove",this._simulateMouseMoveEvent,this)},_dragMixinOnMouseMove(s){this._overwriteEventIfItComesFromMarker(s);let l=this._getDOMElem();this._syncLayers("_dragMixinOnMouseMove",s),this._dragging||(this._dragging=!0,L.DomUtil.addClass(l,"leaflet-pm-dragging"),this._layer instanceof L.Marker||this._layer.bringToFront(),this._originalMapDragState&&this._map.dragging.disable(),this._fireDragStart()),this._tempDragCoord||(this._tempDragCoord=s.latlng),this._onLayerDrag(s),this._layer instanceof L.CircleMarker&&this._layer.pm._updateHiddenPolyCircle()},_dragMixinOnMouseUp(s){let l=this._getDOMElem();return this._syncLayers("_dragMixinOnMouseUp",s),this._originalMapDragState&&this._map.dragging.enable(),this._safeToCacheDragState=!0,L.DomEvent.off(this._map.getContainer(),"touchmove mousemove",this._simulateMouseMoveEvent,this),L.DomEvent.off(this._map.getContainer(),"touchend mouseup",this._simulateMouseUpEvent,this),this._dragging?(this._layer instanceof L.CircleMarker&&this._layer.pm._updateHiddenPolyCircle(),this._layerDragged=!0,window.setTimeout(()=>{this._dragging=!1,l&&L.DomUtil.removeClass(l,"leaflet-pm-dragging"),this._fireDragEnd(),this._fireEdit(),this._layerEdited=!0},10),!0):!1},_onLayerDrag(s){let{latlng:l}=s,h={lat:l.lat-this._tempDragCoord.lat,lng:l.lng-this._tempDragCoord.lng},g=y=>y.map(S=>{if(Array.isArray(S))return g(S);let B={lat:S.lat+h.lat,lng:S.lng+h.lng};return(S.alt||S.alt===0)&&(B.alt=S.alt),B});if(this._layer instanceof L.Circle&&this._layer.options.resizeableCircle||this._layer instanceof L.CircleMarker&&this._layer.options.resizeableCircleMarker){let y=g([this._layer.getLatLng()]);this._layer.setLatLng(y[0]),this._fireChange(this._layer.getLatLng(),"Edit")}else if(this._layer instanceof L.CircleMarker||this._layer instanceof L.Marker){let y=this._layer.getLatLng();this._layer._snapped&&(y=this._layer._orgLatLng);let S=g([y]);this._layer.setLatLng(S[0]),this._fireChange(this._layer.getLatLng(),"Edit")}else if(this._layer instanceof L.ImageOverlay){let y=g([this._layer.getBounds().getNorthWest(),this._layer.getBounds().getSouthEast()]);this._layer.setBounds(y),this._fireChange(this._layer.getBounds(),"Edit")}else{let y=g(this._layer.getLatLngs());this._layer.setLatLngs(y),this._fireChange(this._layer.getLatLngs(),"Edit")}this._tempDragCoord=l,s.layer=this._layer,this._fireDrag(s)},addDraggingClass(){let s=this._getDOMElem();s&&L.DomUtil.addClass(s,"leaflet-pm-draggable")},removeDraggingClass(){let s=this._getDOMElem();s&&L.DomUtil.removeClass(s,"leaflet-pm-draggable")},_getDOMElem(){let s=null;return this._layer._path?s=this._layer._path:this._layer._renderer&&this._layer._renderer._container?s=this._layer._renderer._container:this._layer._image?s=this._layer._image:this._layer._icon&&(s=this._layer._icon),s},_overwriteEventIfItComesFromMarker(s){s.target.getLatLng&&(!s.target._radius||s.target._radius<=10)&&(s.containerPoint=this._map.mouseEventToContainerPoint(s.originalEvent),s.latlng=this._map.containerPointToLatLng(s.containerPoint))},_syncLayers(s,l){if(this.enabled())return!1;if(!l._fromLayerSync&&this._layer===l.target&&this.options.syncLayersOnDrag){l._fromLayerSync=!0;let h=[];if(L.Util.isArray(this.options.syncLayersOnDrag))h=this.options.syncLayersOnDrag,this.options.syncLayersOnDrag.forEach(g=>{g instanceof L.LayerGroup&&(h=h.concat(g.pm.getLayers(!0)))});else if(this.options.syncLayersOnDrag===!0&&this._parentLayerGroup)for(let g in this._parentLayerGroup){let y=this._parentLayerGroup[g];y.pm&&(h=y.pm.getLayers(!0))}return L.Util.isArray(h)&&h.length>0&&(h=h.filter(g=>!!g.pm).filter(g=>!!g.pm.options.draggable),h.forEach(g=>{g!==this._layer&&g.pm[s]&&(g._snapped=!1,g.pm[s](l))})),h.length>0}return!1},_stopDOMImageDrag(s){return s.preventDefault(),!1}},fe=re,ge=f(cr());function _e(s,l,h,g){return h.unproject(l.transform(h.project(s,g)),g)}function be(s,l,h){let g=h.getMaxZoom();if(g===1/0&&(g=h.getZoom()),L.Util.isArray(s)){let y=[];return s.forEach(S=>{y.push(be(S,l,h))}),y}return s instanceof L.LatLng?_e(s,l,h,g):null}function Me(s,l){l instanceof L.Layer&&(l=l.getLatLng());let h=s.getMaxZoom();return h===1/0&&(h=s.getZoom()),s.project(l,h)}function Ye(s,l){let h=s.getMaxZoom();return h===1/0&&(h=s.getZoom()),s.unproject(l,h)}var mt={_onRotateStart(s){this._preventRenderingMarkers(!0),this._rotationOriginLatLng=this._getRotationCenter().clone(),this._rotationOriginPoint=Me(this._map,this._rotationOriginLatLng),this._rotationStartPoint=Me(this._map,s.target.getLatLng()),this._initialRotateLatLng=Yr(this._layer),this._startAngle=this.getAngle();let l=Yr(this._rotationLayer,this._rotationLayer.pm._rotateOrgLatLng);this._fireRotationStart(this._rotationLayer,l),this._fireRotationStart(this._map,l)},_onRotate(s){let l=Me(this._map,s.target.getLatLng()),h=this._rotationStartPoint,g=this._rotationOriginPoint,y=Math.atan2(l.y-g.y,l.x-g.x)-Math.atan2(h.y-g.y,h.x-g.x);this._layer.setLatLngs(this._rotateLayer(y,this._initialRotateLatLng,this._rotationOriginLatLng,L.PM.Matrix.init(),this._map));let S=this;function B(Oe,Te=[],it=-1){if(it>-1&&Te.push(it),L.Util.isArray(Oe[0]))Oe.forEach((pt,Tt)=>B(pt,Te.slice(),Tt));else{let pt=Te.length>0?(0,ge.default)(S._markers,Te):S._markers[0];Oe.forEach((Tt,qt)=>{pt[qt].setLatLng(Tt)})}}B(this._layer.getLatLngs());let D=Yr(this._rotationLayer);this._rotationLayer.setLatLngs(this._rotateLayer(y,this._rotationLayer.pm._rotateOrgLatLng,this._rotationOriginLatLng,L.PM.Matrix.init(),this._map));let Y=y*180/Math.PI;Y=Y<0?Y+360:Y;let le=Y+this._startAngle;this._setAngle(le),this._rotationLayer.pm._setAngle(le),this._fireRotation(this._rotationLayer,Y,D),this._fireRotation(this._map,Y,D),this._rotationLayer.pm._fireChange(this._rotationLayer.getLatLngs(),"Rotation")},_onRotateEnd(){let s=this._startAngle;delete this._rotationOriginLatLng,delete this._rotationOriginPoint,delete this._rotationStartPoint,delete this._initialRotateLatLng,delete this._startAngle;let l=Yr(this._rotationLayer,this._rotationLayer.pm._rotateOrgLatLng);this._rotationLayer.pm._rotateOrgLatLng=Yr(this._rotationLayer),this._fireRotationEnd(this._rotationLayer,s,l),this._fireRotationEnd(this._map,s,l),this._rotationLayer.pm._fireEdit(this._rotationLayer,"Rotation"),this._preventRenderingMarkers(!1),this._layerRotated=!0},_rotateLayer(s,l,h,g,y){let S=Me(y,h);return this._matrix=g.clone().rotate(s,S).flip(),be(l,this._matrix,y)},_setAngle(s){s=s<0?s+360:s,this._angle=s%360},_getRotationCenter(){if(this._rotationCenter)return this._rotationCenter;let s=L.polygon(this._layer.getLatLngs(),{stroke:!1,fill:!1,pmIgnore:!0}).addTo(this._layer._map),l=s.getCenter();return s.removeFrom(this._layer._map),l},enableRotate(){if(!this.options.allowRotation){this.disableRotate();return}this.rotateEnabled()&&this.disableRotate(),this._layer instanceof L.Rectangle&&this._angle===void 0&&this.setInitAngle(Ds(this._layer._map,this._layer.getLatLngs()[0][0],this._layer.getLatLngs()[0][1])||0);let s={fill:!1,stroke:!1,pmIgnore:!1,snapIgnore:!0};this._rotatePoly=L.polygon(this._layer.getLatLngs(),s),this._rotatePoly._pmTempLayer=!0,this._rotatePoly.addTo(this._layer._map),this._rotatePoly.pm._setAngle(this.getAngle()),this._rotatePoly.pm.setRotationCenter(this.getRotationCenter()),this._rotatePoly.pm.setOptions(this._layer._map.pm.getGlobalOptions()),this._rotatePoly.pm.setOptions({rotate:!0,snappable:!1,hideMiddleMarkers:!0}),this._rotatePoly.pm._rotationLayer=this._layer,this._rotatePoly.pm.enable(),this._rotateOrgLatLng=Yr(this._layer),this._rotateEnabled=!0,this._layer.on("remove",this.disableRotate,this),this._fireRotationEnable(this._layer),this._fireRotationEnable(this._layer._map)},disableRotate(){this.rotateEnabled()&&(this._rotatePoly.pm._layerRotated&&this._fireUpdate(),this._rotatePoly.pm._layerRotated=!1,this._rotatePoly.pm.disable(),this._rotatePoly.remove(),this._rotatePoly.pm.setOptions({rotate:!1}),this._rotatePoly=void 0,this._rotateOrgLatLng=void 0,this._layer.off("remove",this.disableRotate,this),this._rotateEnabled=!1,this._fireRotationDisable(this._layer),this._fireRotationDisable(this._layer._map))},rotateEnabled(){return!!this._rotateEnabled},rotateLayer(s){let l=this.getAngle(),h=this._layer.getLatLngs(),g=s*(Math.PI/180);this._layer.setLatLngs(this._rotateLayer(g,this._layer.getLatLngs(),this._getRotationCenter(),L.PM.Matrix.init(),this._layer._map)),this._rotateOrgLatLng=L.polygon(this._layer.getLatLngs()).getLatLngs(),this._setAngle(this.getAngle()+s),this.rotateEnabled()&&this._rotatePoly&&this._rotatePoly.pm.enabled()&&(this._rotatePoly.setLatLngs(this._rotateLayer(g,this._rotatePoly.getLatLngs(),this._getRotationCenter(),L.PM.Matrix.init(),this._rotatePoly._map)),this._rotatePoly.pm._initMarkers());let y=this.getAngle()-l;y=y<0?y+360:y,this._startAngle=l,this._fireRotation(this._layer,y,h,this._layer),this._fireRotation(this._map||this._layer._map,y,h,this._layer),delete this._startAngle,this._fireChange(this._layer.getLatLngs(),"Rotation")},rotateLayerToAngle(s){let l=s-this.getAngle();this.rotateLayer(l)},getAngle(){return this._angle||0},setInitAngle(s){this._setAngle(s)},getRotationCenter(){return this._getRotationCenter()},setRotationCenter(s){this._rotationCenter=s,this._rotatePoly&&this._rotatePoly.pm.setRotationCenter(s)}},vt=mt,lt=L.Class.extend({includes:[fe,Go,vt,$o],options:{snappable:!0,snapDistance:20,allowSelfIntersection:!0,allowSelfIntersectionEdit:!1,preventMarkerRemoval:!1,removeLayerBelowMinVertexCount:!0,limitMarkersToCount:-1,hideMiddleMarkers:!1,snapSegment:!0,syncLayersOnDrag:!1,draggable:!0,allowEditing:!0,allowRemoval:!0,allowCutting:!0,allowRotation:!0,addVertexOn:"click",removeVertexOn:"contextmenu",removeVertexValidation:void 0,addVertexValidation:void 0,moveVertexValidation:void 0,resizeableCircleMarker:!1,resizeableCircle:!0,snapMiddle:!1,snapVertex:!0},setOptions(s){L.Util.setOptions(this,s)},getOptions(){return this.options},applyOptions(){},isPolygon(){return this._layer instanceof L.Polygon},getShape(){return this._shape},_setPane(s,l){l==="layerPane"?s.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.layerPane||"overlayPane":l==="vertexPane"?s.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.vertexPane||"markerPane":l==="markerPane"&&(s.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.markerPane||"markerPane")},remove(){(this._map||this._layer._map).pm.removeLayer({target:this._layer})},_vertexValidation(s,l){let h=l.target,g={layer:this._layer,marker:h,event:l},y="";return s==="move"?y="moveVertexValidation":s==="add"?y="addVertexValidation":s==="remove"&&(y="removeVertexValidation"),this.options[y]&&typeof this.options[y]=="function"&&!this.options[y](g)?(s==="move"&&(h._cancelDragEventChain=h.getLatLng()),!1):(h._cancelDragEventChain=null,!0)},_vertexValidationDrag(s){return s._cancelDragEventChain?(s._latlng=s._cancelDragEventChain,s.update(),!1):!0},_vertexValidationDragEnd(s){return s._cancelDragEventChain?(s._cancelDragEventChain=null,!1):!0}}),St=lt;St.LayerGroup=L.Class.extend({initialize(s){this._layerGroup=s,this._layers=this.getLayers(),this._getMap(),this._layers.forEach(g=>this._initLayer(g));let l=g=>{if(g.layer._pmTempLayer)return;this._layers=this.getLayers();let y=this._layers.filter(S=>!S.pm._parentLayerGroup||!(this._layerGroup._leaflet_id in S.pm._parentLayerGroup));y.forEach(S=>{this._initLayer(S)}),y.length>0&&this._getMap()&&this._getMap().pm.globalEditModeEnabled()&&this.enabled()&&this.enable(this.getOptions())};this._layerGroup.on("layeradd",L.Util.throttle(l,100,this),this),this._layerGroup.on("layerremove",g=>{this._removeLayerFromGroup(g.target)},this);let h=g=>{g.target._pmTempLayer||(this._layers=this.getLayers())};this._layerGroup.on("layerremove",L.Util.throttle(h,100,this),this)},enable(s,l=[]){l.length===0&&(this._layers=this.getLayers()),this._options=s,this._layers.forEach(h=>{h instanceof L.LayerGroup?l.indexOf(h._leaflet_id)===-1&&(l.push(h._leaflet_id),h.pm.enable(s,l)):h.pm.enable(s)})},disable(s=[]){s.length===0&&(this._layers=this.getLayers()),this._layers.forEach(l=>{l instanceof L.LayerGroup?s.indexOf(l._leaflet_id)===-1&&(s.push(l._leaflet_id),l.pm.disable(s)):l.pm.disable()})},enabled(s=[]){return s.length===0&&(this._layers=this.getLayers()),!!this._layers.find(l=>l instanceof L.LayerGroup?s.indexOf(l._leaflet_id)===-1?(s.push(l._leaflet_id),l.pm.enabled(s)):!1:l.pm.enabled())},toggleEdit(s,l=[]){l.length===0&&(this._layers=this.getLayers()),this._options=s,this._layers.forEach(h=>{h instanceof L.LayerGroup?l.indexOf(h._leaflet_id)===-1&&(l.push(h._leaflet_id),h.pm.toggleEdit(s,l)):h.pm.toggleEdit(s)})},_initLayer(s){let l=L.Util.stamp(this._layerGroup);s.pm._parentLayerGroup||(s.pm._parentLayerGroup={}),s.pm._parentLayerGroup[l]=this._layerGroup},_removeLayerFromGroup(s){if(s.pm&&s.pm._layerGroup){let l=L.Util.stamp(this._layerGroup);delete s.pm._layerGroup[l]}},dragging(){return this._layers=this.getLayers(),this._layers?!!this._layers.find(s=>s.pm.dragging()):!1},getOptions(){return this.options},_getMap(){var s;return this._map||((s=this._layers.find(l=>!!l._map))==null?void 0:s._map)||null},getLayers(s=!1,l=!0,h=!0,g=[]){let y=[];return s?this._layerGroup.getLayers().forEach(S=>{y.push(S),S instanceof L.LayerGroup&&g.indexOf(S._leaflet_id)===-1&&(g.push(S._leaflet_id),y=y.concat(S.pm.getLayers(!0,!0,!0,g)))}):y=this._layerGroup.getLayers(),h&&(y=y.filter(S=>!(S instanceof L.LayerGroup))),l&&(y=y.filter(S=>!!S.pm),y=y.filter(S=>!S._pmTempLayer),y=y.filter(S=>!L.PM.optIn&&!S.options.pmIgnore||L.PM.optIn&&S.options.pmIgnore===!1)),y},setOptions(s,l=[]){l.length===0&&(this._layers=this.getLayers()),this.options=s,this._layers.forEach(h=>{h.pm&&(h instanceof L.LayerGroup?l.indexOf(h._leaflet_id)===-1&&(l.push(h._leaflet_id),h.pm.setOptions(s,l)):h.pm.setOptions(s))})}}),St.Marker=St.extend({_shape:"Marker",initialize(s){this._layer=s,this._enabled=!1,this._layer.on("dragend",this._onDragEnd,this)},enable(s={draggable:!0}){if(L.Util.setOptions(this,s),!this.options.allowEditing||!this._layer._map){this.disable();return}this._map=this._layer._map,this.enabled()&&this.disable(),this.applyOptions(),this._layer.on("remove",this.disable,this),this._enabled=!0,this._fireEnable()},disable(){this.enabled()&&(this.disableLayerDrag(),this._layer.off("remove",this.disable,this),this._layer.off("contextmenu",this._removeMarker,this),this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable(),this._enabled=!1)},enabled(){return this._enabled},toggleEdit(s){this.enabled()?this.disable():this.enable(s)},applyOptions(){this.options.snappable?this._initSnappableMarkers():this._disableSnapping(),this.options.draggable?this.enableLayerDrag():this.disableLayerDrag(),this.options.preventMarkerRemoval||this._layer.on("contextmenu",this._removeMarker,this)},_removeMarker(s){let l=s.target;l.remove(),this._fireRemove(l),this._fireRemove(this._map,l)},_onDragEnd(){this._fireEdit(),this._layerEdited=!0},_initSnappableMarkers(){let s=this._layer;this.options.snapDistance=this.options.snapDistance||30,this.options.snapSegment=this.options.snapSegment===void 0?!0:this.options.snapSegment,s.off("pm:drag",this._handleSnapping,this),s.on("pm:drag",this._handleSnapping,this),s.off("pm:dragend",this._cleanupSnapping,this),s.on("pm:dragend",this._cleanupSnapping,this),s.off("pm:dragstart",this._unsnap,this),s.on("pm:dragstart",this._unsnap,this)},_disableSnapping(){let s=this._layer;s.off("pm:drag",this._handleSnapping,this),s.off("pm:dragend",this._cleanupSnapping,this),s.off("pm:dragstart",this._unsnap,this)}});var Lt=f(cr()),Qe={filterMarkerGroup(){this.markerCache=[],this.createCache(),this._layer.on("pm:edit",this.createCache,this),this.applyLimitFilters({}),this.throttledApplyLimitFilters||(this.throttledApplyLimitFilters=L.Util.throttle(this.applyLimitFilters,100,this)),this._layer.on("pm:disable",this._removeMarkerLimitEvents,this),this._layer.on("remove",this._removeMarkerLimitEvents,this),this.options.limitMarkersToCount>-1&&(this._layer.on("pm:vertexremoved",this._initMarkers,this),this._map.on("mousemove",this.throttledApplyLimitFilters,this))},_removeMarkerLimitEvents(){this._map.off("mousemove",this.throttledApplyLimitFilters,this),this._layer.off("pm:edit",this.createCache,this),this._layer.off("pm:disable",this._removeMarkerLimitEvents,this),this._layer.off("pm:vertexremoved",this._initMarkers,this)},createCache(){let s=[...this._markerGroup.getLayers(),...this.markerCache];this.markerCache=s.filter((l,h,g)=>g.indexOf(l)===h)},_removeFromCache(s){let l=this.markerCache.indexOf(s);l>-1&&this.markerCache.splice(l,1)},renderLimits(s){this.markerCache.forEach(l=>{s.includes(l)?this._markerGroup.addLayer(l):this._markerGroup.removeLayer(l)})},applyLimitFilters({latlng:s={lat:0,lng:0}}){if(this._preventRenderMarkers)return;let l=[...this._filterClosestMarkers(s)];this.renderLimits(l)},_filterClosestMarkers(s){let l=[...this.markerCache],h=this.options.limitMarkersToCount;return h===-1?l:(l.sort((g,y)=>{let S=g._latlng.distanceTo(s),B=y._latlng.distanceTo(s);return S-B}),l.filter((g,y)=>h>-1?y<h:!0))},_preventRenderMarkers:!1,_preventRenderingMarkers(s){this._preventRenderMarkers=!!s}},rt=Qe;St.Line=St.extend({includes:[rt],_shape:"Line",initialize(s){this._layer=s,this._enabled=!1},enable(s){if(L.Util.setOptions(this,s),this._map=this._layer._map,!!this._map){if(!this.options.allowEditing){this.disable();return}this.enabled()&&this.disable(),this._enabled=!0,this._initMarkers(),this.applyOptions(),this._layer.on("remove",this.disable,this),this.options.allowSelfIntersection||this._layer.on("pm:vertexremoved",this._handleSelfIntersectionOnVertexRemoval,this),this.options.allowSelfIntersection?this.cachedColor=void 0:(this._layer.options.color!=="#f00000ff"?(this.cachedColor=this._layer.options.color,this.isRed=!1):this.isRed=!0,this._handleLayerStyle()),this._fireEnable()}},disable(){if(!this.enabled()||this._dragging)return;this._enabled=!1,this._markerGroup.clearLayers(),this._markerGroup.removeFrom(this._map),this._layer.off("remove",this.disable,this),this.options.allowSelfIntersection||this._layer.off("pm:vertexremoved",this._handleSelfIntersectionOnVertexRemoval,this);let s=this._layer._path?this._layer._path:this._layer._renderer._container;L.DomUtil.removeClass(s,"leaflet-pm-draggable"),this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable()},enabled(){return this._enabled},toggleEdit(s){return this.enabled()?this.disable():this.enable(s),this.enabled()},applyOptions(){this.options.snappable?this._initSnappableMarkers():this._disableSnapping()},_initMarkers(){let s=this._map,l=this._layer.getLatLngs();this._markerGroup&&(this._markerGroup.removeFrom(s),this._markerGroup.clearLayers()),this._markerGroup=new L.FeatureGroup,this._markerGroup._pmTempLayer=!0;let h=g=>{if(Array.isArray(g[0]))return g.map(h,this);let y=g.map(this._createMarker,this);return this.options.hideMiddleMarkers!==!0&&g.map((S,B)=>{let D=this.isPolygon()?(B+1)%g.length:B+1;return this._createMiddleMarker(y[B],y[D])}),y};this._markers=h(l),this.filterMarkerGroup(),s.addLayer(this._markerGroup)},_createMarker(s){let l=new L.Marker(s,{draggable:!0,icon:L.divIcon({className:"marker-icon"})});return this._setPane(l,"vertexPane"),l._pmTempLayer=!0,this.options.rotate?(l.on("dragstart",this._onRotateStart,this),l.on("drag",this._onRotate,this),l.on("dragend",this._onRotateEnd,this)):(l.on("click",this._onVertexClick,this),l.on("dragstart",this._onMarkerDragStart,this),l.on("move",this._onMarkerDrag,this),l.on("dragend",this._onMarkerDragEnd,this),this.options.preventMarkerRemoval||l.on(this.options.removeVertexOn,this._removeMarker,this)),this._markerGroup.addLayer(l),l},_createMiddleMarker(s,l){if(!s||!l)return!1;let h=L.PM.Utils.calcMiddleLatLng(this._map,s.getLatLng(),l.getLatLng()),g=this._createMarker(h),y=L.divIcon({className:"marker-icon marker-icon-middle"});return g.setIcon(y),g.leftM=s,g.rightM=l,s._middleMarkerNext=g,l._middleMarkerPrev=g,g.on(this.options.addVertexOn,this._onMiddleMarkerClick,this),g.on("movestart",this._onMiddleMarkerMoveStart,this),g},_onMiddleMarkerClick(s){let l=s.target;if(!this._vertexValidation("add",s))return;let h=L.divIcon({className:"marker-icon"});l.setIcon(h),this._addMarker(l,l.leftM,l.rightM)},_onMiddleMarkerMoveStart(s){let l=s.target;if(l.on("moveend",this._onMiddleMarkerMoveEnd,this),!this._vertexValidation("add",s)){l.on("move",this._onMiddleMarkerMovePrevent,this);return}l._dragging=!0,this._addMarker(l,l.leftM,l.rightM)},_onMiddleMarkerMovePrevent(s){let l=s.target;this._vertexValidationDrag(l)},_onMiddleMarkerMoveEnd(s){let l=s.target;if(l.off("move",this._onMiddleMarkerMovePrevent,this),l.off("moveend",this._onMiddleMarkerMoveEnd,this),!this._vertexValidationDragEnd(l))return;let h=L.divIcon({className:"marker-icon"});l.setIcon(h),setTimeout(()=>{delete l._dragging},100)},_addMarker(s,l,h){s.off("movestart",this._onMiddleMarkerMoveStart,this),s.off(this.options.addVertexOn,this._onMiddleMarkerClick,this);let g=s.getLatLng(),y=this._layer._latlngs;delete s.leftM,delete s.rightM;let{indexPath:S,index:B,parentPath:D}=L.PM.Utils.findDeepMarkerIndex(this._markers,l),Y=S.length>1?(0,Lt.default)(y,D):y,le=S.length>1?(0,Lt.default)(this._markers,D):this._markers;Y.splice(B+1,0,g),le.splice(B+1,0,s),this._layer.setLatLngs(y),this.options.hideMiddleMarkers!==!0&&(this._createMiddleMarker(l,s),this._createMiddleMarker(s,h)),this._fireEdit(),this._layerEdited=!0,this._fireChange(this._layer.getLatLngs(),"Edit"),this._fireVertexAdded(s,L.PM.Utils.findDeepMarkerIndex(this._markers,s).indexPath,g),this.options.snappable&&this._initSnappableMarkers()},hasSelfIntersection(){return Fn(this._layer.toGeoJSON(15)).features.length>0},_handleSelfIntersectionOnVertexRemoval(){this._handleLayerStyle(!0)&&(this._layer.setLatLngs(this._coordsBeforeEdit),this._coordsBeforeEdit=null,this._initMarkers())},_handleLayerStyle(s){let l=this._layer,h,g;if(this.options.allowSelfIntersection?h=!1:(g=Fn(this._layer.toGeoJSON(15)),h=g.features.length>0),h){if(!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this._updateDisabledMarkerStyle(this._markers,!0),this.isRed)return h;s?this._flashLayer():(l.setStyle({color:"#f00000ff"}),this.isRed=!0),this._fireIntersect(g)}else l.setStyle({color:this.cachedColor}),this.isRed=!1,!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this._updateDisabledMarkerStyle(this._markers,!1);return h},_flashLayer(){this.cachedColor||(this.cachedColor=this._layer.options.color),this._layer.setStyle({color:"#f00000ff"}),this.isRed=!0,window.setTimeout(()=>{this._layer.setStyle({color:this.cachedColor}),this.isRed=!1},200)},_updateDisabledMarkerStyle(s,l){s.forEach(h=>{Array.isArray(h)?this._updateDisabledMarkerStyle(h,l):h._icon&&(l&&!this._checkMarkerAllowedToDrag(h)?L.DomUtil.addClass(h._icon,"vertexmarker-disabled"):L.DomUtil.removeClass(h._icon,"vertexmarker-disabled"))})},_removeMarker(s){let l=s.target;if(!this._vertexValidation("remove",s))return;this.options.allowSelfIntersection||(this._coordsBeforeEdit=Yr(this._layer,this._layer.getLatLngs()));let h=this._layer.getLatLngs(),{indexPath:g,index:y,parentPath:S}=L.PM.Utils.findDeepMarkerIndex(this._markers,l);if(!g)return;let B=g.length>1?(0,Lt.default)(h,S):h,D=g.length>1?(0,Lt.default)(this._markers,S):this._markers,Y=S[S.length-1]>0&&this._layer instanceof L.Polygon;if(!this.options.removeLayerBelowMinVertexCount&&!Y&&(B.length<=2||this.isPolygon()&&B.length<=3)){this._flashLayer();return}B.splice(y,1),this._layer.setLatLngs(h),this.isPolygon()&&B.length<=2&&B.splice(0,B.length);let le=!1;if(B.length<=1&&(B.splice(0,B.length),S.length>1&&g.length>1&&(h=qo(h)),this._layer.setLatLngs(h),this._initMarkers(),le=!0),br(h)||this._layer.remove(),h=qo(h),this._layer.setLatLngs(h),this._markers=qo(this._markers),!le&&(D=g.length>1?(0,Lt.default)(this._markers,S):this._markers,l._middleMarkerPrev&&(this._markerGroup.removeLayer(l._middleMarkerPrev),this._removeFromCache(l._middleMarkerPrev)),l._middleMarkerNext&&(this._markerGroup.removeLayer(l._middleMarkerNext),this._removeFromCache(l._middleMarkerNext)),this._markerGroup.removeLayer(l),this._removeFromCache(l),D)){let Oe,Te;if(this.isPolygon()?(Oe=(y+1)%D.length,Te=(y+(D.length-1))%D.length):(Te=y-1<0?void 0:y-1,Oe=y+1>=D.length?void 0:y+1),Oe!==Te){let it=D[Te],pt=D[Oe];this.options.hideMiddleMarkers!==!0&&this._createMiddleMarker(it,pt)}D.splice(y,1)}this._fireEdit(),this._layerEdited=!0,this._fireVertexRemoved(l,g),this._fireChange(this._layer.getLatLngs(),"Edit")},updatePolygonCoordsFromMarkerDrag(s){let l=this._layer.getLatLngs(),h=s.getLatLng(),{indexPath:g,index:y,parentPath:S}=L.PM.Utils.findDeepMarkerIndex(this._markers,s);(g.length>1?(0,Lt.default)(l,S):l).splice(y,1,h),this._layer.setLatLngs(l)},_getNeighborMarkers(s){let{indexPath:l,index:h,parentPath:g}=L.PM.Utils.findDeepMarkerIndex(this._markers,s),y=l.length>1?(0,Lt.default)(this._markers,g):this._markers,S=(h+1)%y.length,B=(h+(y.length-1))%y.length,D=y[B],Y=y[S];return{prevMarker:D,nextMarker:Y}},_checkMarkerAllowedToDrag(s){let{prevMarker:l,nextMarker:h}=this._getNeighborMarkers(s),g=L.polyline([l.getLatLng(),s.getLatLng()]),y=L.polyline([s.getLatLng(),h.getLatLng()]),S=Lr(this._layer.toGeoJSON(15),g.toGeoJSON(15)).features.length,B=Lr(this._layer.toGeoJSON(15),y.toGeoJSON(15)).features.length;return s.getLatLng()===this._markers[0][0].getLatLng()?B+=1:s.getLatLng()===this._markers[0][this._markers[0].length-1].getLatLng()&&(S+=1),!(S<=2&&B<=2)},_onMarkerDragStart(s){let l=s.target;if(this.cachedColor||(this.cachedColor=this._layer.options.color),!this._vertexValidation("move",s))return;let{indexPath:h}=L.PM.Utils.findDeepMarkerIndex(this._markers,l);this._fireMarkerDragStart(s,h),this.options.allowSelfIntersection||(this._coordsBeforeEdit=Yr(this._layer,this._layer.getLatLngs())),!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this.hasSelfIntersection()?this._markerAllowedToDrag=this._checkMarkerAllowedToDrag(l):this._markerAllowedToDrag=null},_onMarkerDrag(s){let l=s.target;if(!this._vertexValidationDrag(l))return;let{indexPath:h,index:g,parentPath:y}=L.PM.Utils.findDeepMarkerIndex(this._markers,l);if(!h)return;if(!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this.hasSelfIntersection()&&this._markerAllowedToDrag===!1){this._layer.setLatLngs(this._coordsBeforeEdit),this._initMarkers(),this._handleLayerStyle();return}this.updatePolygonCoordsFromMarkerDrag(l);let S=h.length>1?(0,Lt.default)(this._markers,y):this._markers,B=(g+1)%S.length,D=(g+(S.length-1))%S.length,Y=l.getLatLng(),le=S[D].getLatLng(),Oe=S[B].getLatLng();if(l._middleMarkerNext){let Te=L.PM.Utils.calcMiddleLatLng(this._map,Y,Oe);l._middleMarkerNext.setLatLng(Te)}if(l._middleMarkerPrev){let Te=L.PM.Utils.calcMiddleLatLng(this._map,Y,le);l._middleMarkerPrev.setLatLng(Te)}this.options.allowSelfIntersection||this._handleLayerStyle(),this._fireMarkerDrag(s,h),this._fireChange(this._layer.getLatLngs(),"Edit")},_onMarkerDragEnd(s){let l=s.target;if(!this._vertexValidationDragEnd(l))return;let{indexPath:h}=L.PM.Utils.findDeepMarkerIndex(this._markers,l),g=!this.options.allowSelfIntersection&&this.hasSelfIntersection();g&&this.options.allowSelfIntersectionEdit&&this._markerAllowedToDrag&&(g=!1);let y=!this.options.allowSelfIntersection&&g;if(this._fireMarkerDragEnd(s,h,y),y){this._layer.setLatLngs(this._coordsBeforeEdit),this._coordsBeforeEdit=null,this._initMarkers(),this.options.snappable&&this._initSnappableMarkers(),this._handleLayerStyle(),this._fireLayerReset(s,h);return}!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this._handleLayerStyle(),this._fireEdit(),this._layerEdited=!0,this._fireChange(this._layer.getLatLngs(),"Edit")},_onVertexClick(s){let l=s.target;if(l._dragging)return;let{indexPath:h}=L.PM.Utils.findDeepMarkerIndex(this._markers,l);this._fireVertexClick(s,h)}}),St.Polygon=St.Line.extend({_shape:"Polygon",_checkMarkerAllowedToDrag(s){let{prevMarker:l,nextMarker:h}=this._getNeighborMarkers(s),g=L.polyline([l.getLatLng(),s.getLatLng()]),y=L.polyline([s.getLatLng(),h.getLatLng()]),S=Lr(this._layer.toGeoJSON(15),g.toGeoJSON(15)).features.length,B=Lr(this._layer.toGeoJSON(15),y.toGeoJSON(15)).features.length;return!(S<=2&&B<=2)}}),St.Rectangle=St.Polygon.extend({_shape:"Rectangle",_initMarkers(){let s=this._map,l=this._findCorners();this._markerGroup&&this._markerGroup.clearLayers(),this._markerGroup=new L.FeatureGroup,this._markerGroup._pmTempLayer=!0,s.addLayer(this._markerGroup),this._markers=[],this._markers[0]=l.map(this._createMarker,this),[this._cornerMarkers]=this._markers,this._layer.getLatLngs()[0].forEach((h,g)=>{let y=this._cornerMarkers.find(S=>S._index===g);y&&y.setLatLng(h)})},applyOptions(){this.options.snappable?this._initSnappableMarkers():this._disableSnapping(),this._addMarkerEvents()},_createMarker(s,l){let h=new L.Marker(s,{draggable:!0,icon:L.divIcon({className:"marker-icon"})});return this._setPane(h,"vertexPane"),h._origLatLng=s,h._index=l,h._pmTempLayer=!0,h.on("click",this._onVertexClick,this),this._markerGroup.addLayer(h),h},_addMarkerEvents(){this._markers[0].forEach(s=>{s.on("dragstart",this._onMarkerDragStart,this),s.on("drag",this._onMarkerDrag,this),s.on("dragend",this._onMarkerDragEnd,this),this.options.preventMarkerRemoval||s.on("contextmenu",this._removeMarker,this)})},_removeMarker(){return null},_onMarkerDragStart(s){if(!this._vertexValidation("move",s))return;let l=s.target,h=this._cornerMarkers;l._oppositeCornerLatLng=h.find(y=>y._index===(l._index+2)%4).getLatLng(),l._snapped=!1;let{indexPath:g}=L.PM.Utils.findDeepMarkerIndex(this._markers,l);this._fireMarkerDragStart(s,g)},_onMarkerDrag(s){let l=s.target;if(!this._vertexValidationDrag(l)||l._index===void 0)return;this._adjustRectangleForMarkerMove(l);let{indexPath:h}=L.PM.Utils.findDeepMarkerIndex(this._markers,l);this._fireMarkerDrag(s,h),this._fireChange(this._layer.getLatLngs(),"Edit")},_onMarkerDragEnd(s){let l=s.target;if(!this._vertexValidationDragEnd(l))return;this._cornerMarkers.forEach(g=>{delete g._oppositeCornerLatLng});let{indexPath:h}=L.PM.Utils.findDeepMarkerIndex(this._markers,l);this._fireMarkerDragEnd(s,h),this._fireEdit(),this._layerEdited=!0,this._fireChange(this._layer.getLatLngs(),"Edit")},_adjustRectangleForMarkerMove(s){L.extend(s._origLatLng,s._latlng);let l=L.PM.Utils._getRotatedRectangle(s.getLatLng(),s._oppositeCornerLatLng,this.getAngle(),this._map);this._layer.setLatLngs(l),this._adjustAllMarkers(s),this._layer.redraw()},_adjustAllMarkers(s){let l=this._layer.getLatLngs()[0];if(l&&l.length!==4&&l.length>0)l.forEach((h,g)=>{this._cornerMarkers[g].setLatLng(h)}),this._cornerMarkers.slice(l.length).forEach(h=>{h.setLatLng(l[0])});else if(!l||!l.length)console.error("The layer has no LatLngs");else{let h=l.findIndex(g=>s.getLatLng().equals(g));h>-1?(this._cornerMarkers[(s._index+1)%4].setLatLng(l[(h+1)%4]),this._cornerMarkers[(s._index+2)%4].setLatLng(l[(h+2)%4]),this._cornerMarkers[(s._index+3)%4].setLatLng(l[(h+3)%4])):this._cornerMarkers.forEach(g=>{g.setLatLng(l[g._index])})}},_findCorners(){this._angle===void 0&&this.setInitAngle(Ds(this._map,this._layer.getLatLngs()[0][0],this._layer.getLatLngs()[0][1])||0);let s=this._layer.getLatLngs()[0];return L.PM.Utils._getRotatedRectangle(s[0],s[2],this.getAngle(),this._map||this)}}),St.CircleMarker=St.extend({_shape:"CircleMarker",initialize(s){this._layer=s,this._enabled=!1,this._minRadiusOption="minRadiusCircleMarker",this._maxRadiusOption="maxRadiusCircleMarker",this._editableOption="resizeableCircleMarker",this._updateHiddenPolyCircle()},enable(s={draggable:!0,snappable:!0}){if(L.Util.setOptions(this,s),this.options.editable&&(this.options.resizeableCircleMarker=this.options.editable,delete this.options.editable),!this.options.allowEditing||!this._layer._map){this.disable();return}this._map=this._layer._map,this.enabled()&&this.disable(),this.applyOptions(),this._layer.on("remove",this.disable,this),this._enabled=!0,this._extendingEnable(),this._updateHiddenPolyCircle(),this._fireEnable()},_extendingEnable(){this._layer.on("pm:dragstart",this._onDragStart,this),this._layer.on("pm:drag",this._onMarkerDrag,this),this._layer.on("pm:dragend",this._onMarkerDragEnd,this)},disable(){this.dragging()||(this._map||(this._map=this._layer._map),this._map&&this.enabled()&&(this.layerDragEnabled()&&this.disableLayerDrag(),this._helperLayers&&(this._helperLayers.clearLayers(),this._helperLayers.removeFrom(this._map)),this.options[this._editableOption]?(this._map.off("move",this._syncMarkers,this),this._outerMarker.off("drag",this._handleOuterMarkerSnapping,this)):this._map.off("move",this._updateHiddenPolyCircle,this),this._extendingDisable(),this._layer.off("remove",this.disable,this),this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable(),this._enabled=!1))},_extendingDisable(){this._layer.off("contextmenu",this._removeMarker,this)},enabled(){return this._enabled},toggleEdit(s){this.enabled()?this.disable():this.enable(s)},applyOptions(){this.options[this._editableOption]?(this._initMarkers(),this._map.on("move",this._syncMarkers,this),this.options.snappable?(this._initSnappableMarkers(),this._outerMarker.on("drag",this._handleOuterMarkerSnapping,this),this._outerMarker.on("move",this._syncHintLine,this),this._outerMarker.on("move",this._syncCircleRadius,this)):this._disableSnapping()):(this.options.draggable&&this.enableLayerDrag(),this._map.on("move",this._updateHiddenPolyCircle,this),this.options.snappable?this._initSnappableMarkersDrag():this._disableSnappingDrag()),this._extendingApplyOptions()},_extendingApplyOptions(){this.options.preventMarkerRemoval||this._layer.on("contextmenu",this._removeMarker,this)},_initMarkers(){let s=this._map;this._helperLayers&&(this._helperLayers.removeFrom(s),this._helperLayers.clearLayers()),this._helperLayers=new L.FeatureGroup,this._helperLayers._pmTempLayer=!0,this._helperLayers.addTo(s);let l=this._layer.getLatLng(),h=this._layer._radius,g=this._getLatLngOnCircle(l,h);this._centerMarker=this._createCenterMarker(l),this._outerMarker=this._createOuterMarker(g),this._markers=[this._centerMarker,this._outerMarker],this._createHintLine(this._centerMarker,this._outerMarker)},_getLatLngOnCircle(s,l){let h=this._map.project(s),g=L.point(h.x+l,h.y);return this._map.unproject(g)},_createHintLine(s,l){let h=s.getLatLng(),g=l.getLatLng();this._hintline=L.polyline([h,g],this.options.hintlineStyle),this._setPane(this._hintline,"layerPane"),this._hintline._pmTempLayer=!0,this._helperLayers.addLayer(this._hintline)},_createCenterMarker(s){let l=this._createMarker(s);return this.options.draggable?(L.DomUtil.addClass(l._icon,"leaflet-pm-draggable"),l.on("move",this._moveCircle,this)):l.dragging.disable(),l},_createOuterMarker(s){let l=this._createMarker(s);return l.on("drag",this._resizeCircle,this),l},_createMarker(s){let l=new L.Marker(s,{draggable:!0,icon:L.divIcon({className:"marker-icon"})});return this._setPane(l,"vertexPane"),l._origLatLng=s,l._pmTempLayer=!0,l.on("dragstart",this._onMarkerDragStart,this),l.on("drag",this._onMarkerDrag,this),l.on("dragend",this._onMarkerDragEnd,this),l.on("click",this._onVertexClick,this),this._helperLayers.addLayer(l),l},_moveCircle(s){if(s.target._cancelDragEventChain)return;let l=this._centerMarker.getLatLng();this._layer.setLatLng(l);let h=this._layer._radius,g=this._getLatLngOnCircle(l,h);this._outerMarker._latlng=g,this._outerMarker.update(),this._syncHintLine(),this._updateHiddenPolyCircle(),this._fireCenterPlaced("Edit"),this._fireChange(this._layer.getLatLng(),"Edit")},_syncMarkers(){let s=this._layer.getLatLng(),l=this._layer._radius,h=this._getLatLngOnCircle(s,l);this._outerMarker.setLatLng(h),this._centerMarker.setLatLng(s),this._syncHintLine(),this._updateHiddenPolyCircle()},_resizeCircle(){this._outerMarker.setLatLng(this._getNewDestinationOfOuterMarker()),this._syncHintLine(),this._syncCircleRadius()},_syncCircleRadius(){let s=this._centerMarker.getLatLng(),l=this._outerMarker.getLatLng(),h=this._distanceCalculation(s,l);this.options[this._minRadiusOption]&&h<this.options[this._minRadiusOption]?this._layer.setRadius(this.options[this._minRadiusOption]):this.options[this._maxRadiusOption]&&h>this.options[this._maxRadiusOption]?this._layer.setRadius(this.options[this._maxRadiusOption]):this._layer.setRadius(h),this._updateHiddenPolyCircle(),this._fireChange(this._layer.getLatLng(),"Edit")},_syncHintLine(){let s=this._centerMarker.getLatLng(),l=this._outerMarker.getLatLng();this._hintline.setLatLngs([s,l])},_removeMarker(){this.options[this._editableOption]&&this.disable(),this._layer.remove(),this._fireRemove(this._layer),this._fireRemove(this._map,this._layer)},_onDragStart(){this._map.pm.Draw.CircleMarker._layerIsDragging=!0},_onMarkerDragStart(s){this._vertexValidation("move",s)&&this._fireMarkerDragStart(s)},_onMarkerDrag(s){let l=s.target;l instanceof L.Marker&&!this._vertexValidationDrag(l)||this._fireMarkerDrag(s)},_onMarkerDragEnd(s){this._extedingMarkerDragEnd();let l=s.target;this._vertexValidationDragEnd(l)&&(this.options[this._editableOption]&&(this._fireEdit(),this._layerEdited=!0),this._fireMarkerDragEnd(s))},_extedingMarkerDragEnd(){this._map.pm.Draw.CircleMarker._layerIsDragging=!1},_initSnappableMarkersDrag(){let s=this._layer;this.options.snapDistance=this.options.snapDistance||30,this.options.snapSegment=this.options.snapSegment===void 0?!0:this.options.snapSegment,s.off("pm:drag",this._handleSnapping,this),s.on("pm:drag",this._handleSnapping,this),s.off("pm:dragend",this._cleanupSnapping,this),s.on("pm:dragend",this._cleanupSnapping,this),s.off("pm:dragstart",this._unsnap,this),s.on("pm:dragstart",this._unsnap,this)},_disableSnappingDrag(){let s=this._layer;s.off("pm:drag",this._handleSnapping,this),s.off("pm:dragend",this._cleanupSnapping,this),s.off("pm:dragstart",this._unsnap,this)},_updateHiddenPolyCircle(){let s=this._layer._map||this._map;if(s){let l=L.PM.Utils.pxRadiusToMeterRadius(this._layer.getRadius(),s,this._layer.getLatLng()),h=L.circle(this._layer.getLatLng(),this._layer.options);h.setRadius(l);let g=s&&s.pm._isCRSSimple();this._hiddenPolyCircle?this._hiddenPolyCircle.setLatLngs(L.PM.Utils.circleToPolygon(h,200,!g).getLatLngs()):this._hiddenPolyCircle=L.PM.Utils.circleToPolygon(h,200,!g),this._hiddenPolyCircle._parentCopy||(this._hiddenPolyCircle._parentCopy=this._layer)}},_getNewDestinationOfOuterMarker(){let s=this._centerMarker.getLatLng(),l=this._outerMarker.getLatLng(),h=this._distanceCalculation(s,l);return this.options[this._minRadiusOption]&&h<this.options[this._minRadiusOption]?l=pa(this._map,s,l,this._getMinDistanceInMeter(s)):this.options[this._maxRadiusOption]&&h>this.options[this._maxRadiusOption]&&(l=pa(this._map,s,l,this._getMaxDistanceInMeter(s))),l},_handleOuterMarkerSnapping(){if(this._outerMarker._snapped){let s=this._centerMarker.getLatLng(),l=this._outerMarker.getLatLng(),h=this._distanceCalculation(s,l);this.options[this._minRadiusOption]&&h<this.options[this._minRadiusOption]?this._outerMarker.setLatLng(this._outerMarker._orgLatLng):this.options[this._maxRadiusOption]&&h>this.options[this._maxRadiusOption]&&this._outerMarker.setLatLng(this._outerMarker._orgLatLng)}this._outerMarker.setLatLng(this._getNewDestinationOfOuterMarker())},_distanceCalculation(s,l){return this._map.project(s).distanceTo(this._map.project(l))},_getMinDistanceInMeter(s){return L.PM.Utils.pxRadiusToMeterRadius(this.options[this._minRadiusOption],this._map,s)},_getMaxDistanceInMeter(s){return L.PM.Utils.pxRadiusToMeterRadius(this.options[this._maxRadiusOption],this._map,s)},_onVertexClick(s){s.target._dragging||this._fireVertexClick(s,void 0)}}),St.Circle=St.CircleMarker.extend({_shape:"Circle",initialize(s){this._layer=s,this._enabled=!1,this._minRadiusOption="minRadiusCircle",this._maxRadiusOption="maxRadiusCircle",this._editableOption="resizeableCircle",this._updateHiddenPolyCircle()},enable(s){L.PM.Edit.CircleMarker.prototype.enable.call(this,s||{})},_extendingEnable(){},_extendingDisable(){this._layer.off("remove",this.disable,this);let s=this._layer._path?this._layer._path:this._layer._renderer._container;L.DomUtil.removeClass(s,"leaflet-pm-draggable")},_extendingApplyOptions(){},_syncMarkers(){},_removeMarker(){},_onDragStart(){},_extedingMarkerDragEnd(){},_updateHiddenPolyCircle(){let s=this._map&&this._map.pm._isCRSSimple();this._hiddenPolyCircle?this._hiddenPolyCircle.setLatLngs(L.PM.Utils.circleToPolygon(this._layer,200,!s).getLatLngs()):this._hiddenPolyCircle=L.PM.Utils.circleToPolygon(this._layer,200,!s),this._hiddenPolyCircle._parentCopy||(this._hiddenPolyCircle._parentCopy=this._layer)},_distanceCalculation(s,l){return this._map.distance(s,l)},_getMinDistanceInMeter(){return this.options[this._minRadiusOption]},_getMaxDistanceInMeter(){return this.options[this._maxRadiusOption]},_onVertexClick(s){s.target._dragging||this._fireVertexClick(s,void 0)}}),St.ImageOverlay=St.extend({_shape:"ImageOverlay",initialize(s){this._layer=s,this._enabled=!1},toggleEdit(s){this.enabled()?this.disable():this.enable(s)},enabled(){return this._enabled},enable(s={draggable:!0,snappable:!0}){if(L.Util.setOptions(this,s),this._map=this._layer._map,!!this._map){if(!this.options.allowEditing){this.disable();return}this.enabled()||this.disable(),this.enableLayerDrag(),this._layer.on("remove",this.disable,this),this._enabled=!0,this._otherSnapLayers=this._findCorners(),this._fireEnable()}},disable(){this._dragging||(this._map||(this._map=this._layer._map),this.disableLayerDrag(),this._layer.off("remove",this.disable,this),this.enabled()||(this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable()),this._enabled=!1)},_findCorners(){let s=this._layer.getBounds(),l=s.getNorthWest(),h=s.getNorthEast(),g=s.getSouthEast(),y=s.getSouthWest();return[l,h,g,y]}}),St.Text=St.extend({_shape:"Text",initialize(s){this._layer=s,this._enabled=!1},enable(s){if(L.Util.setOptions(this,s),!!this.textArea){if(!this.options.allowEditing||!this._layer._map){this.disable();return}this._map=this._layer._map,this.enabled()&&this.disable(),this.applyOptions(),this._safeToCacheDragState=!0,this._focusChange(),this.textArea.readOnly=!1,this.textArea.classList.remove("pm-disabled"),this._layer.on("remove",this.disable,this),L.DomEvent.on(this.textArea,"input",this._autoResize,this),L.DomEvent.on(this.textArea,"focus",this._focusChange,this),L.DomEvent.on(this.textArea,"blur",this._focusChange,this),this._layer.on("dblclick",L.DomEvent.stop),L.DomEvent.off(this.textArea,"mousedown",this._preventTextSelection),this._enabled=!0,this._fireEnable()}},disable(){if(!this.enabled())return;this._layer.off("remove",this.disable,this),L.DomEvent.off(this.textArea,"input",this._autoResize,this),L.DomEvent.off(this.textArea,"focus",this._focusChange,this),L.DomEvent.off(this.textArea,"blur",this._focusChange,this),L.DomEvent.off(document,"click",this._documentClick,this),this._focusChange(),this.textArea.readOnly=!0,this.textArea.classList.add("pm-disabled");let s=document.activeElement;this.textArea.focus(),this.textArea.selectionStart=0,this.textArea.selectionEnd=0,L.DomEvent.on(this.textArea,"mousedown",this._preventTextSelection),s.focus(),this._disableOnBlurActive=!1,this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable(),this._enabled=!1},enabled(){return this._enabled},toggleEdit(s){this.enabled()?this.disable():this.enable(s)},applyOptions(){this.options.snappable?this._initSnappableMarkers():this._disableSnapping()},_initSnappableMarkers(){let s=this._layer;this.options.snapDistance=this.options.snapDistance||30,this.options.snapSegment=this.options.snapSegment===void 0?!0:this.options.snapSegment,s.off("pm:drag",this._handleSnapping,this),s.on("pm:drag",this._handleSnapping,this),s.off("pm:dragend",this._cleanupSnapping,this),s.on("pm:dragend",this._cleanupSnapping,this),s.off("pm:dragstart",this._unsnap,this),s.on("pm:dragstart",this._unsnap,this)},_disableSnapping(){let s=this._layer;s.off("pm:drag",this._handleSnapping,this),s.off("pm:dragend",this._cleanupSnapping,this),s.off("pm:dragstart",this._unsnap,this)},_autoResize(){this.textArea.style.height="1px",this.textArea.style.width="1px";let s=this.textArea.scrollHeight>21?this.textArea.scrollHeight:21,l=this.textArea.scrollWidth>16?this.textArea.scrollWidth:16;this.textArea.style.height=`${s}px`,this.textArea.style.width=`${l}px`,this._layer.options.text=this.getText(),this._fireTextChange(this.getText())},_disableOnBlur(){this._disableOnBlurActive=!0,setTimeout(()=>{this.enabled()&&L.DomEvent.on(document,"click",this._documentClick,this)},100)},_documentClick(s){s.target!==this.textArea&&(this.disable(),!this.getText()&&this.options.removeIfEmpty&&this.remove())},_focusChange(s={}){let l=this._hasFocus;this._hasFocus=s.type==="focus",!l!=!this._hasFocus&&(this._hasFocus?(this._applyFocus(),this._focusText=this.getText(),this._fireTextFocus()):(this._removeFocus(),this._fireTextBlur(),this._focusText!==this.getText()&&(this._fireEdit(),this._layerEdited=!0)))},_applyFocus(){this.textArea.classList.add("pm-hasfocus"),this._map.dragging&&(this._safeToCacheDragState&&(this._originalMapDragState=this._map.dragging._enabled,this._safeToCacheDragState=!1),this._map.dragging.disable())},_removeFocus(){this._map.dragging&&(this._originalMapDragState&&this._map.dragging.enable(),this._safeToCacheDragState=!0),this.textArea.classList.remove("pm-hasfocus")},focus(){if(!this.enabled())throw new TypeError("Layer is not enabled");this.textArea.focus()},blur(){if(!this.enabled())throw new TypeError("Layer is not enabled");this.textArea.blur(),this._disableOnBlurActive&&this.disable()},hasFocus(){return this._hasFocus},getElement(){return this.textArea},setText(s){s&&(this.textArea.value=s),this._autoResize()},getText(){return this.textArea.value},_initTextMarker(){if(this.textArea=L.PM.Draw.Text.prototype._createTextArea.call(this),this.options.className){let l=this.options.className.split(" ");this.textArea.classList.add(...l)}let s=L.PM.Draw.Text.prototype._createTextIcon.call(this,this.textArea);this._layer.setIcon(s),this._layer.once("add",this._createTextMarker,this)},_createTextMarker(s=!1){this._layer.off("add",this._createTextMarker,this),this._layer.getElement().tabIndex=-1,this.textArea.wrap="off",this.textArea.style.overflow="hidden",this.textArea.style.height=L.DomUtil.getStyle(this.textArea,"font-size"),this.textArea.style.width="1px",this._layer.options.text&&this.setText(this._layer.options.text),this._autoResize(),s===!0&&(this.enable(),this.focus(),this._disableOnBlur())},_preventTextSelection(s){s.preventDefault()}});var Mt=function(s,l,h,g,y,S){this._matrix=[s,l,h,g,y,S]};Mt.init=()=>new L.PM.Matrix(1,0,0,1,0,0),Mt.prototype={transform(s){return this._transform(s.clone())},_transform(s){let l=this._matrix,{x:h,y:g}=s;return s.x=l[0]*h+l[1]*g+l[4],s.y=l[2]*h+l[3]*g+l[5],s},untransform(s){let l=this._matrix;return new L.Point((s.x/l[0]-l[4])/l[0],(s.y/l[2]-l[5])/l[2])},clone(){let s=this._matrix;return new L.PM.Matrix(s[0],s[1],s[2],s[3],s[4],s[5])},translate(s){if(s===void 0)return new L.Point(this._matrix[4],this._matrix[5]);let l,h;return typeof s=="number"?(l=s,h=s):(l=s.x,h=s.y),this._add(1,0,0,1,l,h)},scale(s,l){if(s===void 0)return new L.Point(this._matrix[0],this._matrix[3]);let h,g;return l=l||L.point(0,0),typeof s=="number"?(h=s,g=s):(h=s.x,g=s.y),this._add(h,0,0,g,l.x,l.y)._add(1,0,0,1,-l.x,-l.y)},rotate(s,l){let h=Math.cos(s),g=Math.sin(s);return l=l||new L.Point(0,0),this._add(h,g,-g,h,l.x,l.y)._add(1,0,0,1,-l.x,-l.y)},flip(){return this._matrix[1]*=-1,this._matrix[2]*=-1,this},_add(s,l,h,g,y,S){let B=[[],[],[]],D=this._matrix,Y=[[D[0],D[2],D[4]],[D[1],D[3],D[5]],[0,0,1]],le=[[s,h,y],[l,g,S],[0,0,1]],Oe;s&&s instanceof L.PM.Matrix&&(D=s._matrix,le=[[D[0],D[2],D[4]],[D[1],D[3],D[5]],[0,0,1]]);for(let Te=0;Te<3;Te+=1)for(let it=0;it<3;it+=1){Oe=0;for(let pt=0;pt<3;pt+=1)Oe+=Y[Te][pt]*le[pt][it];B[Te][it]=Oe}return this._matrix=[B[0][0],B[1][0],B[0][1],B[1][1],B[0][2],B[1][2]],this}};var Ft=Mt,Nt={calcMiddleLatLng(s,l,h){let g=s.project(l),y=s.project(h);return s.unproject(g._add(y)._divideBy(2))},findLayers(s){let l=[];return s.eachLayer(h=>{(h instanceof L.Polyline||h instanceof L.Marker||h instanceof L.Circle||h instanceof L.CircleMarker||h instanceof L.ImageOverlay)&&l.push(h)}),l=l.filter(h=>!!h.pm),l=l.filter(h=>!h._pmTempLayer),l=l.filter(h=>!L.PM.optIn&&!h.options.pmIgnore||L.PM.optIn&&h.options.pmIgnore===!1),l},circleToPolygon(s,l=60,h=!0){let g=s.getLatLng(),y=s.getRadius(),S=Er(g,y,l,0,h),B=[];for(let D=0;D<S.length;D+=1){let Y=[S[D].lat,S[D].lng];B.push(Y)}return L.polygon(B,s.options)},disablePopup(s){s.getPopup()&&(s._tempPopupCopy=s.getPopup(),s.unbindPopup())},enablePopup(s){s._tempPopupCopy&&(s.bindPopup(s._tempPopupCopy),delete s._tempPopupCopy)},_fireEvent(s,l,h,g=!1){s.fire(l,h,g);let{groups:y}=this.getAllParentGroups(s);y.forEach(S=>{S.fire(l,h,g)})},getAllParentGroups(s){let l=[],h=[],g=y=>{for(let S in y._eventParents)if(l.indexOf(S)===-1){l.push(S);let B=y._eventParents[S];h.push(B),g(B)}};return!s._pmLastGroupFetch||!s._pmLastGroupFetch.time||new Date().getTime()-s._pmLastGroupFetch.time>1e3?(g(s),s._pmLastGroupFetch={time:new Date().getTime(),groups:h,groupIds:l},{groupIds:l,groups:h}):{groups:s._pmLastGroupFetch.groups,groupIds:s._pmLastGroupFetch.groupIds}},createGeodesicPolygon:Er,getTranslation:dn,findDeepCoordIndex(s,l,h=!0){let g,y=B=>(D,Y)=>{let le=B.concat(Y);if(h){if(D.lat&&D.lat===l.lat&&D.lng===l.lng)return g=le,!0}else if(D.lat&&L.latLng(D).equals(l))return g=le,!0;return Array.isArray(D)&&D.some(y(le))};s.some(y([]));let S={};return g&&(S={indexPath:g,index:g[g.length-1],parentPath:g.slice(0,g.length-1)}),S},findDeepMarkerIndex(s,l){let h,g=S=>(B,D)=>{let Y=S.concat(D);return B._leaflet_id===l._leaflet_id?(h=Y,!0):Array.isArray(B)&&B.some(g(Y))};s.some(g([]));let y={};return h&&(y={indexPath:h,index:h[h.length-1],parentPath:h.slice(0,h.length-1)}),y},_getIndexFromSegment(s,l){if(l&&l.length===2){let h=this.findDeepCoordIndex(s,l[0]),g=this.findDeepCoordIndex(s,l[1]),y=Math.max(h.index,g.index);return(h.index===0||g.index===0)&&y!==1&&(y+=1),{indexA:h,indexB:g,newIndex:y,indexPath:h.indexPath,parentPath:h.parentPath}}return null},_getRotatedRectangle(s,l,h,g){let y=Me(g,s),S=Me(g,l),B=h*Math.PI/180,D=Math.cos(B),Y=Math.sin(B),le=(S.x-y.x)*D+(S.y-y.y)*Y,Oe=(S.y-y.y)*D-(S.x-y.x)*Y,Te=le*D+y.x,it=le*Y+y.y,pt=-Oe*Y+y.x,Tt=Oe*D+y.y,qt=Ye(g,y),Vt=Ye(g,{x:Te,y:it}),bn=Ye(g,S),Re=Ye(g,{x:pt,y:Tt});return[qt,Vt,bn,Re]},pxRadiusToMeterRadius(s,l,h){let g=l.project(h),y=L.point(g.x+s,g.y);return l.distance(l.unproject(y),h)}},tn=Nt;L.PM=L.PM||{version:Ts.version,Map:Vo,Toolbar:$a,Draw:Bi,Edit:St,Utils:tn,Matrix:Ft,activeLang:"en",optIn:!1,initialize(s){this.addInitHooks(s)},setOptIn(s){this.optIn=!!s},addInitHooks(){function s(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Map(this)):this.options.pmIgnore||(this.pm=new L.PM.Map(this)),this.pm&&this.pm.setGlobalOptions({})}L.Map.addInitHook(s);function l(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.LayerGroup(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.LayerGroup(this))}L.LayerGroup.addInitHook(l);function h(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.options.textMarker?(this.pm=new L.PM.Edit.Text(this),this.options._textMarkerOverPM||this.pm._initTextMarker(),delete this.options._textMarkerOverPM):this.pm=new L.PM.Edit.Marker(this)):this.options.pmIgnore||(this.options.textMarker?(this.pm=new L.PM.Edit.Text(this),this.options._textMarkerOverPM||this.pm._initTextMarker(),delete this.options._textMarkerOverPM):this.pm=new L.PM.Edit.Marker(this))}L.Marker.addInitHook(h);function g(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.CircleMarker(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.CircleMarker(this))}L.CircleMarker.addInitHook(g);function y(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.Line(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.Line(this))}L.Polyline.addInitHook(y);function S(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.Polygon(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.Polygon(this))}L.Polygon.addInitHook(S);function B(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.Rectangle(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.Rectangle(this))}L.Rectangle.addInitHook(B);function D(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.Circle(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.Circle(this))}L.Circle.addInitHook(D);function Y(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.ImageOverlay(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.ImageOverlay(this))}L.ImageOverlay.addInitHook(Y)},reInitLayer(s){s instanceof L.LayerGroup&&s.eachLayer(l=>{this.reInitLayer(l)}),s.pm||L.PM.optIn&&s.options.pmIgnore!==!1||s.options.pmIgnore||(s instanceof L.Map?s.pm=new L.PM.Map(s):s instanceof L.Marker?s.options.textMarker?(s.pm=new L.PM.Edit.Text(s),s.pm._initTextMarker(),s.pm._createTextMarker(!1)):s.pm=new L.PM.Edit.Marker(s):s instanceof L.Circle?s.pm=new L.PM.Edit.Circle(s):s instanceof L.CircleMarker?s.pm=new L.PM.Edit.CircleMarker(s):s instanceof L.Rectangle?s.pm=new L.PM.Edit.Rectangle(s):s instanceof L.Polygon?s.pm=new L.PM.Edit.Polygon(s):s instanceof L.Polyline?s.pm=new L.PM.Edit.Line(s):s instanceof L.LayerGroup?s.pm=new L.PM.Edit.LayerGroup(s):s instanceof L.ImageOverlay&&(s.pm=new L.PM.Edit.ImageOverlay(s)))}},L.version==="1.7.1"&&L.Canvas.include({_onClick(s){let l=this._map.mouseEventToLayerPoint(s),h,g;for(let y=this._drawFirst;y;y=y.next)h=y.layer,h.options.interactive&&h._containsPoint(l)&&(!(s.type==="click"||s.type==="preclick")||!this._map._draggableMoved(h))&&(g=h);g&&(L.DomEvent.fakeStop(s),this._fireEvent([g],s))}}),L.PM.initialize()})();class nl extends Ke.Polygon{constructor(n,i,o=0,a=180,u={}){super([[]],{...u,pmIgnore:!1,interactive:!0,className:"leaflet-semicircle"});jt(this,"center");jt(this,"radius");jt(this,"startAngle");jt(this,"stopAngle");jt(this,"numPoints");jt(this,"properties");jt(this,"pm");jt(this,"getRadius",()=>this.radius);jt(this,"getStartAngle",()=>this.startAngle);jt(this,"getStopAngle",()=>this.stopAngle);this.center=n,this.radius=i,this.startAngle=this.normalizeAngle(o),this.stopAngle=this.normalizeAngle(a),this.numPoints=64,this.properties={type:"Semicircle",radius:this.radius,startAngle:this.startAngle,stopAngle:this.stopAngle,style:{...u,startAngle:this.startAngle,stopAngle:this.stopAngle}},this.on("pm:enable",()=>{var d;this.pm&&(this.pm._layers=[],this.pm._markers=[],(d=this.pm._markerGroup)==null||d.clearLayers())}),this.on("pm:vertexadded",()=>{var d;this.pm&&((d=this.pm._markerGroup)==null||d.clearLayers())}),this.on("add",()=>{this._map&&(this.updateGeometry(),this.pm&&this.pm.enable({allowSelfIntersection:!1,preventMarkerRemoval:!0}))}),this.updateProperties()}normalizeAngle(n){return(n%360+360)%360}calculateArcPoints(){if(!this._map)return[];const n=[],i=this.getOpeningAngle();n.push(this.center);for(let o=0;o<=this.numPoints;o++){const u=(this.startAngle+i*o/this.numPoints)*Math.PI/180,d=this.radius*Math.cos(u),v=this.radius*Math.sin(u)/111319.9,_=d/(111319.9*Math.cos(this.center.lat*Math.PI/180)),x=Ke.latLng(this.center.lat+v,this.center.lng+_);n.push(x)}return n.push(this.center),n}setRadius(n){return n<=0?this:(this.radius=n,this.properties.radius=n,this.updateGeometry(),this.updateProperties(),this)}setAngles(n,i){const o=this.normalizeAngle(n),a=this.normalizeAngle(i),u=this.getOpeningAngle();let d=(a-o+360)%360;const f=45;return Math.abs(d-u)>f&&(d>u?d=u+f:d=u-f),d=Math.max(5,Math.min(355,d)),this.startAngle===n?this.stopAngle=(this.startAngle+d)%360:(this.startAngle=o,this.stopAngle=(o+d)%360),this.properties.startAngle=this.startAngle,this.properties.stopAngle=this.stopAngle,this.properties.openingAngle=d,this.properties.style.startAngle=this.startAngle,this.properties.style.stopAngle=this.stopAngle,this.updateGeometry(),this}setOpeningAngle(n){return n<5||n>355?this:(this.stopAngle=(this.startAngle+n)%360,this.properties.openingAngle=n,this.updateGeometry(),this.updateProperties(),this)}setCenter(n){return!n.lat||!n.lng?this:(this.center=n,this.updateGeometry(),this.updateProperties(),this)}getCenter(){return this.center}getOpeningAngle(){return(this.stopAngle-this.startAngle+360)%360}calculatePointOnArc(n){const i=n*Math.PI/180,o=this.radius*Math.cos(i),u=this.radius*Math.sin(i)/111319.9,d=o/(111319.9*Math.cos(this.center.lat*Math.PI/180));return Ke.latLng(this.center.lat+u,this.center.lng+d)}calculateMidpointPosition(){const n=this.getOpeningAngle(),i=(this.startAngle+n/2)%360;return this.calculatePointOnArc(i)}calculateAngleToPoint(n){return Math.atan2(n.lat-this.center.lat,n.lng-this.center.lng)*180/Math.PI}createControlPoints(n,i){const o=[],a=this.calculatePointOnArc(this.startAngle),u=this.calculatePointOnArc(this.stopAngle),d=this.calculateMidpointPosition(),f=this.createControlPoint(n,this.center,"#059669"),v=this.createControlPoint(n,a,"#DC2626"),_=this.createControlPoint(n,u,"#DC2626"),x=this.createControlPoint(n,d,"#2563EB");o.push(f,v,_,x),i(o)}createControlPoint(n,i,o){return Ke.circleMarker(i,{radius:6,color:o,fillColor:o,fillOpacity:1,weight:2,className:"control-point",pmIgnore:!0}).addTo(n)}updateProperties(){const n=this.getOpeningAngle(),i=Math.PI*Math.pow(this.radius,2)*n/360,o=2*Math.PI*this.radius*n/360,a=o+2*this.radius;this.properties.area=i,this.properties.arcLength=o,this.properties.perimeter=a,this.properties.openingAngle=n,this.properties.surfaceInterieure=i,this.properties.surfaceExterieure=i,this.properties.diameter=this.radius*2,this.properties.center=this.center,this.fire("properties:updated",{shape:this,properties:this.properties})}updateGeometry(){if(!this._map)return;const n=this.calculateArcPoints();n.length>0&&(this.setLatLngs([n]),this.updateProperties())}toGeoJSON(){const n=super.toGeoJSON();return{...n,properties:{...n.properties,type:"Semicircle",radius:this.radius,startAngle:this.startAngle,stopAngle:this.stopAngle,openingAngle:this.getOpeningAngle()}}}}class rc extends Ke.Circle{constructor(n,i){const o=i.radius||10;super(n,o,i);jt(this,"properties");this.properties={type:"Circle",style:i||{}},this.updateProperties(),this.on("add",()=>{this.updateProperties()})}updateProperties(){var o;const n=this.getRadius(),i=this.getLatLng();this.properties={...this.properties,radius:n,diameter:n*2,area:Math.PI*Math.pow(n,2),perimeter:2*Math.PI*n,center:i,surfaceInterieure:Math.PI*Math.pow(n,2),surfaceExterieure:Math.PI*Math.pow(n,2),style:{...this.options,color:this.options.color||"#3388ff",weight:this.options.weight||3,opacity:this.options.opacity||1,fillColor:this.options.fillColor||"#3388ff",fillOpacity:this.options.fillOpacity||.2,dashArray:((o=this.options)==null?void 0:o.dashArray)||""}},this.fire("properties:updated",{shape:this,properties:this.properties})}setRadius(n){return super.setRadius(n),this.updateProperties(),this}setLatLng(n){return super.setLatLng(n),this.updateProperties(),this}calculatePointOnCircle(n){const i=this.getLatLng(),o=this.getRadius(),a=n*Math.PI/180;return Ke.latLng(i.lat+o/111319.9*Math.sin(a),i.lng+o/(111319.9*Math.cos(i.lat*Math.PI/180))*Math.cos(a))}getCardinalPoints(){return[0,45,90,135,180,225,270,315].map(n=>this.calculatePointOnCircle(n))}calculateAngleFromPoint(n){const i=this.getLatLng(),o=n.lng-i.lng,a=n.lat-i.lat;let u=Math.atan2(a,o)*180/Math.PI;return u<0&&(u+=360),u}resizeFromControlPoint(n){const o=this.getLatLng().distanceTo(n);o>0&&super.setRadius(o)}}var qs=63710088e-1,pL={centimeters:qs*100,centimetres:qs*100,degrees:qs/111325,feet:qs*3.28084,inches:qs*39.37,kilometers:qs/1e3,kilometres:qs/1e3,meters:qs,metres:qs,miles:qs/1609.344,millimeters:qs*1e3,millimetres:qs*1e3,nauticalmiles:qs/1852,radians:1,yards:qs*1.0936};function Fh(e,t,n){n===void 0&&(n={});var i={type:"Feature"};return(n.id===0||n.id)&&(i.id=n.id),n.bbox&&(i.bbox=n.bbox),i.properties=t||{},i.geometry=e,i}function Sl(e,t,n){n===void 0&&(n={});for(var i=0,o=e;i<o.length;i++){var a=o[i];if(a.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var u=0;u<a[a.length-1].length;u++)if(a[a.length-1][u]!==a[0][u])throw new Error("First and last Position are not equivalent.")}var d={type:"Polygon",coordinates:e};return Fh(d,t,n)}function uu(e,t,n){if(n===void 0&&(n={}),e.length<2)throw new Error("coordinates must be an array of two or more positions");var i={type:"LineString",coordinates:e};return Fh(i,t,n)}function gL(e,t){t===void 0&&(t="kilometers");var n=pL[t];if(!n)throw new Error(t+" units is invalid");return e*n}function ih(e){var t=e%360;return t*Math.PI/180}function O1(e,t,n){if(e!==null)for(var i,o,a,u,d,f,v,_=0,x=0,k,w=e.type,N=w==="FeatureCollection",z=w==="Feature",W=N?e.features.length:1,O=0;O<W;O++){v=N?e.features[O].geometry:z?e.geometry:e,k=v?v.type==="GeometryCollection":!1,d=k?v.geometries.length:1;for(var Z=0;Z<d;Z++){var se=0,Se=0;if(u=k?v.geometries[Z]:v,u!==null){f=u.coordinates;var Ne=u.type;switch(_=0,Ne){case null:break;case"Point":if(t(f,x,O,se,Se)===!1)return!1;x++,se++;break;case"LineString":case"MultiPoint":for(i=0;i<f.length;i++){if(t(f[i],x,O,se,Se)===!1)return!1;x++,Ne==="MultiPoint"&&se++}Ne==="LineString"&&se++;break;case"Polygon":case"MultiLineString":for(i=0;i<f.length;i++){for(o=0;o<f[i].length-_;o++){if(t(f[i][o],x,O,se,Se)===!1)return!1;x++}Ne==="MultiLineString"&&se++,Ne==="Polygon"&&Se++}Ne==="Polygon"&&se++;break;case"MultiPolygon":for(i=0;i<f.length;i++){for(Se=0,o=0;o<f[i].length;o++){for(a=0;a<f[i][o].length-_;a++){if(t(f[i][o][a],x,O,se,Se)===!1)return!1;x++}Se++}se++}break;case"GeometryCollection":for(i=0;i<u.geometries.length;i++)if(O1(u.geometries[i],t)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function I1(e,t){var n,i,o,a,u,d,f,v,_,x,k=0,w=e.type==="FeatureCollection",N=e.type==="Feature",z=w?e.features.length:1;for(n=0;n<z;n++){for(d=w?e.features[n].geometry:N?e.geometry:e,v=w?e.features[n].properties:N?e.properties:{},_=w?e.features[n].bbox:N?e.bbox:void 0,x=w?e.features[n].id:N?e.id:void 0,f=d?d.type==="GeometryCollection":!1,u=f?d.geometries.length:1,o=0;o<u;o++){if(a=f?d.geometries[o]:d,a===null){if(t(null,k,v,_,x)===!1)return!1;continue}switch(a.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(t(a,k,v,_,x)===!1)return!1;break}case"GeometryCollection":{for(i=0;i<a.geometries.length;i++)if(t(a.geometries[i],k,v,_,x)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}k++}}function mL(e,t,n){var i=n;return I1(e,function(o,a,u,d,f){i=t(i,o,a,u,d,f)}),i}function vL(e,t){I1(e,function(n,i,o,a,u){var d=n===null?null:n.type;switch(d){case null:case"Point":case"LineString":case"Polygon":return t(Fh(n,o,{bbox:a,id:u}),i,0)===!1?!1:void 0}var f;switch(d){case"MultiPoint":f="Point";break;case"MultiLineString":f="LineString";break;case"MultiPolygon":f="Polygon";break}for(var v=0;v<n.coordinates.length;v++){var _=n.coordinates[v],x={type:f,coordinates:_};if(t(Fh(x,o),i,v)===!1)return!1}})}function yL(e,t){vL(e,function(n,i,o){var a=0;if(n.geometry){var u=n.geometry.type;if(!(u==="Point"||u==="MultiPoint")){var d,f=0,v=0,_=0;if(O1(n,function(x,k,w,N,z){if(d===void 0||i>f||N>v||z>_){d=x,f=i,v=N,_=z,a=0;return}var W=uu([d,x],n.properties);if(t(W,i,o,z,a)===!1)return!1;a++,d=x})===!1)return!1}}})}function _L(e,t,n){var i=n,o=!1;return yL(e,function(a,u,d,f,v){o===!1&&n===void 0?i=a:i=t(i,a,u,d,f,v),o=!0}),i}function J0(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if(e.type==="Feature"&&e.geometry!==null&&e.geometry.type==="Point")return e.geometry.coordinates;if(e.type==="Point")return e.coordinates}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return e;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function tu(e,t,n){n===void 0&&(n={});var i=J0(e),o=J0(t),a=ih(o[1]-i[1]),u=ih(o[0]-i[0]),d=ih(i[1]),f=ih(o[1]),v=Math.pow(Math.sin(a/2),2)+Math.pow(Math.sin(u/2),2)*Math.cos(d)*Math.cos(f);return gL(2*Math.atan2(Math.sqrt(v),Math.sqrt(1-v)),n.units)}var X0=6378137;function Eu(e){return mL(e,function(t,n){return t+bL(n)},0)}function bL(e){var t=0,n;switch(e.type){case"Polygon":return Q0(e.coordinates);case"MultiPolygon":for(n=0;n<e.coordinates.length;n++)t+=Q0(e.coordinates[n]);return t;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}function Q0(e){var t=0;if(e&&e.length>0){t+=Math.abs(eg(e[0]));for(var n=1;n<e.length;n++)t-=Math.abs(eg(e[n]))}return t}function eg(e){var t,n,i,o,a,u,d,f=0,v=e.length;if(v>2){for(d=0;d<v;d++)d===v-2?(o=v-2,a=v-1,u=0):d===v-1?(o=v-1,a=0,u=1):(o=d,a=d+1,u=d+2),t=e[o],n=e[a],i=e[u],f+=(Gd(i[0])-Gd(t[0]))*Math.sin(Gd(n[1]));f=f*X0*X0/2}return f}function Gd(e){return e*Math.PI/180}function Tc(e,t){return t===void 0&&(t={}),_L(e,function(n,i){var o=i.geometry.coordinates;return n+tu(o[0],o[1],t)},0)}class Ca extends Ke.Rectangle{constructor(n,i={}){super(n,{...i,pmIgnore:!1,interactive:!0});jt(this,"properties");this.properties={type:"Rectangle",style:i||{}},this.updateProperties(),this.on("add",()=>{this.updateProperties()})}updateProperties(){var d;const n=this.getBounds(),i=n.getNorthEast(),o=n.getSouthWest(),a=tu([o.lng,o.lat],[i.lng,o.lat],{units:"meters"}),u=tu([o.lng,o.lat],[o.lng,i.lat],{units:"meters"});this.properties={...this.properties,width:a,height:u,area:a*u,perimeter:2*(a+u),center:n.getCenter(),corners:{northEast:i,northWest:n.getNorthWest(),southEast:n.getSouthEast(),southWest:o},bounds:n,surfaceInterieure:a*u,surfaceExterieure:a*u,style:{...this.options,color:this.options.color||"#3388ff",weight:this.options.weight||3,opacity:this.options.opacity||1,fillColor:this.options.fillColor||"#3388ff",fillOpacity:this.options.fillOpacity||.2,dashArray:((d=this.options)==null?void 0:d.dashArray)||""}},this.fire("properties:updated",{shape:this,properties:this.properties})}setBounds(n){return super.setBounds(n),this.updateProperties(),this}getMidPoints(){const n=this.getBounds(),i=n.getNorthWest(),o=n.getNorthEast(),a=n.getSouthEast(),u=n.getSouthWest();return[Ke.latLng((i.lat+o.lat)/2,(i.lng+o.lng)/2),Ke.latLng((o.lat+a.lat)/2,(o.lng+a.lng)/2),Ke.latLng((u.lat+a.lat)/2,(u.lng+a.lng)/2),Ke.latLng((i.lat+u.lat)/2,(i.lng+u.lng)/2)]}getDimensions(){const n=this.getBounds(),i=n.getNorthEast(),o=n.getSouthWest(),a=tu([o.lng,o.lat],[i.lng,o.lat],{units:"meters"}),u=tu([o.lng,o.lat],[o.lng,i.lat],{units:"meters"});return{width:a,height:u}}resizeFromCorner(n,i){const o=this.getBounds(),a=[o.getNorthWest(),o.getNorthEast(),o.getSouthEast(),o.getSouthWest()],u=(n+2)%4,d=a[u],f=Ke.latLngBounds(d,i);Ke.Rectangle.prototype.setBounds.call(this,f)}resizeFromSide(n,i){const o=this.getBounds(),a=o.getNorthWest(),u=o.getSouthEast(),d=o.getSouthWest();let f;switch(n){case 0:f=Ke.latLngBounds(Ke.latLng(i.lat,a.lng),Ke.latLng(d.lat,u.lng));break;case 1:f=Ke.latLngBounds(Ke.latLng(a.lat,a.lng),Ke.latLng(u.lat,i.lng));break;case 2:f=Ke.latLngBounds(Ke.latLng(a.lat,a.lng),Ke.latLng(i.lat,u.lng));break;case 3:f=Ke.latLngBounds(Ke.latLng(a.lat,i.lng),Ke.latLng(u.lat,u.lng));break}f&&(Ke.Rectangle.prototype.setBounds.call(this,f),this.updateProperties())}moveFromCenter(n){const i=this.getBounds(),o=i.getCenter(),a=n.lng-o.lng,u=n.lat-o.lat,d=i.getNorthWest(),f=i.getSouthEast(),v=Ke.latLng(d.lat+u,d.lng+a),_=Ke.latLng(f.lat+u,f.lng+a);Ke.Rectangle.prototype.setBounds.call(this,Ke.latLngBounds(v,_))}}class Bo extends Ke.Rectangle{constructor(n,i="Double-cliquez pour diter",o={}){var f,v,_,x,k,w,N,z;const a=n instanceof Ke.LatLngBounds?n:Ke.latLngBounds(n);if(!a.isValid()){console.warn("[TextRectangle] Limites invalides, utilisation de limites par dfaut");const W=Ke.latLng(0,0);a.extend(Ke.latLng(W.lat+.001,W.lng+.001)),a.extend(Ke.latLng(W.lat-.001,W.lng-.001))}const u={...o.textStyle,color:o.textColor||((f=o.textStyle)==null?void 0:f.color)||"#000000",fontFamily:o.fontFamily||((v=o.textStyle)==null?void 0:v.fontFamily)||"Arial, sans-serif",textAlign:o.textAlign||((_=o.textStyle)==null?void 0:_.textAlign)||"center",backgroundColor:o.backgroundColor||((x=o.textStyle)==null?void 0:x.backgroundColor)||"#FFFFFF",backgroundOpacity:o.backgroundOpacity??((k=o.textStyle)==null?void 0:k.backgroundOpacity)??1,bold:o.bold||((w=o.textStyle)==null?void 0:w.bold)||!1,italic:o.italic||((N=o.textStyle)==null?void 0:N.italic)||!1,fontSize:((z=o.textStyle)==null?void 0:z.fontSize)||"14px"},d={pmIgnore:!1,interactive:!0,fill:!0,stroke:!0,className:"leaflet-text-rectangle",...o,textStyle:u};super(a,d);jt(this,"properties");jt(this,"_textNode",null);jt(this,"_isEditing",!1);jt(this,"_editableDiv",null);jt(this,"_text");jt(this,"_rotation",0);jt(this,"_textStyle",{color:"#000000",fontSize:"14px",fontFamily:"Arial, sans-serif",textAlign:"center",backgroundColor:"#FFFFFF",backgroundOpacity:1,bold:!1,italic:!1});jt(this,"_initialBounds",null);jt(this,"_isResizing",!1);jt(this,"_resizePreview",null);jt(this,"_minWidth",50);jt(this,"_minHeight",30);jt(this,"_maxWidth",2e3);jt(this,"_maxHeight",1e3);jt(this,"_onKeyDown",n=>{n.key==="Enter"&&n.ctrlKey?(n.preventDefault(),this._finishEditing()):n.key==="Escape"&&(n.preventDefault(),this._cancelEditing())});jt(this,"_finishEditing",()=>{if(this._editableDiv)try{const n=this._editableDiv.innerText.trim()||"Double-cliquez pour diter";this._cleanupEditableDiv(),this.setText(n),this._textRedraw(),this.fire("edit:end"),this.map&&!this.map.dragging.enabled()&&this.map.dragging.enable()}catch(n){console.error("[TextRectangle] Erreur lors de la finalisation de l'dition :",n),this._cleanupEditableDiv()}});jt(this,"_cancelEditing",()=>{this._textRedraw(),this._cleanupEditableDiv(),this.map&&!this.map.dragging.enabled()&&this.map.dragging.enable()});jt(this,"_updateTextPosition",()=>{this.updateProperties(),this._textRedraw()});jt(this,"_onZoomEnd",()=>{this._textRedraw()});jt(this,"_onAdd",()=>{this._textRedraw(),this.map&&this.map.on("zoomend",this._onZoomEnd.bind(this))});jt(this,"_onRemove",()=>{this._removeTextNode(),this.map&&this.map.off("zoomend",this._onZoomEnd)});this._text=i,this._textStyle=u,this.properties={type:"TextRectangle",text:this._text,width:0,height:0,area:0,rotation:this._rotation,style:{...d,textStyle:this._textStyle}},this.on({add:this._onAdd,remove:this._onRemove,dblclick:this._onDoubleClick,dragend:this._updateTextPosition,"pm:edit":this._updateTextPosition,"pm:dragend":this._updateTextPosition,"pm:markerdragend":this._updateTextPosition,"pm:vertexadded":this._updateTextPosition,"pm:vertexremoved":this._updateTextPosition}),this.pm&&(this.pm.enableLayerDrag(),console.log("[TextRectangle] Geoman activ pour cette instance"))}get map(){return this._map}set map(n){this._map=n}setText(n,i){const o=this.properties.text;this._text=n,i&&(this._textStyle={...this._textStyle,...i}),this.properties.text=n||"Double-cliquez pour diter",console.log("[TextRectangle] Mise  jour du texte",{oldText:o,newText:this.properties.text,hasTextNode:!!this._textNode}),this._textRedraw(),this.fire("text:updated",{text:this.properties.text,oldText:o,bounds:this.getBounds(),style:this.properties.style}),this.fire("properties:updated",{shape:this,properties:this.properties,source:"setText"})}setTextStyle(n){this._textStyle={...this._textStyle,...n},this.properties.style.textStyle=this._textStyle,this._textRedraw(),this.fire("properties:updated",{shape:this,properties:this.properties})}setRotation(n){this.properties.rotation=n%360,this._textRedraw(),this.fire("properties:updated",{shape:this,properties:this.properties})}getTextElement(){return this._textNode}updateProperties(){if(this.map)try{const n=this.getBounds(),i=n.getSouthWest(),o=Ke.latLng(n.getSouth(),n.getEast()),a=this.map.distance(i,o),u=this.map.distance(i,Ke.latLng(n.getNorth(),n.getWest()));this.properties.width=a,this.properties.height=u,this.properties.area=a*u,this.properties.center=n.getCenter(),this.fire("properties:updated",{shape:this,properties:this.properties,source:"updateProperties",dimensions:{width:a,height:u}}),console.log("[TextRectangle] Proprits mises  jour",{width:a,height:u,area:a*u,center:n.getCenter()})}catch(n){console.error("[TextRectangle] Erreur lors de la mise  jour des proprits :",n)}}setBounds(n){const i=n instanceof Ke.LatLngBounds?n:Ke.latLngBounds(n);return Ke.Rectangle.prototype.setBounds.call(this,i),this._textRedraw(),this.updateProperties(),this}startResize(){if(!this._isResizing&&(this._isResizing=!0,this._initialBounds=this.getBounds(),this.map&&!this._resizePreview))try{if(this._resizePreview=Ke.rectangle(this._initialBounds,{color:this.options.color||"#3388ff",weight:this.options.weight||2,opacity:.8,fillColor:this.options.fillColor||"#3388ff",fillOpacity:.2,dashArray:this.options.dashArray||"5,5",className:"resize-preview"}).addTo(this.map),this._rotation!==0){const n=this._resizePreview._path;n&&(n.style.transformOrigin="center",n.style.transform=`rotate(${this._rotation}deg)`)}this._textNode&&(this._textNode.style.opacity="0.5")}catch(n){console.error("[TextRectangle] Erreur lors de la cration du rectangle fantme:",n),this._cleanupResizePreview()}}updateResizePreview(n){if(!(!this._isResizing||!this._resizePreview||!this.map))try{const i=this.map.latLngToContainerPoint(n.getNorthWest()),o=this.map.latLngToContainerPoint(n.getSouthEast()),a=Math.abs(o.x-i.x),u=Math.abs(o.y-i.y);if(a<this._minWidth||u<this._minHeight||a>this._maxWidth||u>this._maxHeight)return;if(this._resizePreview.setBounds(n),this._rotation!==0){const d=this._resizePreview._path;d&&(d.style.transformOrigin="center",d.style.transform=`rotate(${this._rotation}deg)`)}if(this._textNode){const d=Math.min(a,u)*.1,f=Math.max(10,Math.min(48,d)),v=f*1.2,x=this.properties.text.split(`
`).length*v,k=i.y+(u-x)/2,w=this._calculateTextX(i.x,o.x,5);if(this._textNode.setAttribute("x",w.toString()),this._textNode.setAttribute("y",k.toString()),this._textNode.querySelectorAll("tspan").forEach((N,z)=>{N.setAttribute("x",w.toString()),N.setAttribute("dy",z===0?"0":`${v}px`),N.style.fontSize=`${f}px`}),this._rotation!==0){const N=this.map.latLngToLayerPoint(n.getCenter());this._textNode.setAttribute("transform",`rotate(${this._rotation}, ${N.x}, ${N.y})`)}}this.fire("resize:update",{bounds:n})}catch(i){console.error("[TextRectangle] Erreur lors de la mise  jour du rectangle fantme:",i),this._cleanupResizePreview()}}endResize(n){if(this._isResizing)try{if(this._cleanupResizePreview(),this._textNode&&(this._textNode.style.opacity="1"),this.map){const i=this.map.latLngToContainerPoint(n.getNorthWest()),o=this.map.latLngToContainerPoint(n.getSouthEast()),a=Math.abs(o.x-i.x),u=Math.abs(o.y-i.y);if(a<this._minWidth||u<this._minHeight||a>this._maxWidth||u>this._maxHeight){this.cancelResize();return}}this.setBounds(n),this._textRedraw(),this.fire("resize:end",{bounds:n})}catch(i){console.error("[TextRectangle] Erreur lors de la fin du redimensionnement:",i),this.cancelResize()}finally{this._isResizing=!1}}cancelResize(){if(!(!this._isResizing||!this._initialBounds))try{this._cleanupResizePreview(),this._textNode&&(this._textNode.style.opacity="1"),this.setBounds(this._initialBounds)}catch(n){console.error("[TextRectangle] Erreur lors de l'annulation du redimensionnement:",n)}finally{this._isResizing=!1,this._initialBounds=null}}_cleanupResizePreview(){if(this._resizePreview&&this.map)try{this.map.removeLayer(this._resizePreview)}catch(n){console.error("[TextRectangle] Erreur lors du nettoyage du rectangle fantme:",n)}finally{this._resizePreview=null}}_onDoubleClick(n){this._isEditing||this._isResizing||(Ke.DomEvent.stopPropagation(n),this.fire("edit:start"),this._isEditing=!0,this._removeTextNode(),this._createEditableDiv())}_createEditableDiv(){if(this.map)try{const n=this.getBounds(),i=this.map.latLngToContainerPoint(n.getNorthWest()),o=this.map.latLngToContainerPoint(n.getSouthEast()),a=o.x-i.x,u=o.y-i.y,d=document.createElement("div");d.className="leaflet-text-rectangle-editor",d.contentEditable="true",d.innerText=this.properties.text;const f=Math.min(a,u)*.1,v=Math.max(10,Math.min(48,f));if(Object.assign(d.style,{position:"absolute",left:`${i.x}px`,top:`${i.y}px`,width:`${a}px`,height:`${u}px`,backgroundColor:this.properties.style.fillColor||"#FFFFFF",opacity:`${this.properties.style.fillOpacity??1}`,color:this.properties.style.textColor||"#000000",fontSize:`${v}px`,fontFamily:this.properties.style.fontFamily||"Arial, sans-serif",fontWeight:this.properties.style.bold?"bold":"normal",fontStyle:this.properties.style.italic?"italic":"normal",textAlign:this.properties.style.textAlign||"center",border:`${this.properties.style.weight||2}px solid ${this.properties.style.color||"#3388ff"}`,borderRadius:"2px",padding:"4px",boxSizing:"border-box",zIndex:"1000",overflow:"auto",whiteSpace:"pre-wrap",wordBreak:"break-word",cursor:"text",userSelect:"text",outline:"none",display:"flex",alignItems:"center",justifyContent:this._getJustifyContent()}),this.properties.rotation!==0){const w=this.map.latLngToContainerPoint(n.getCenter());d.style.transformOrigin=`${w.x-i.x}px ${w.y-i.y}px`,d.style.transform=`rotate(${this.properties.rotation}deg)`}this.map.getContainer().appendChild(d),this._editableDiv=d,d.focus();const x=window.getSelection(),k=document.createRange();k.selectNodeContents(d),x==null||x.removeAllRanges(),x==null||x.addRange(k),d.addEventListener("keydown",this._onKeyDown.bind(this)),d.addEventListener("blur",this._finishEditing.bind(this)),d.addEventListener("paste",w=>{var z;w.preventDefault();const N=((z=w.clipboardData)==null?void 0:z.getData("text/plain"))||"";document.execCommand("insertText",!1,N)}),this.map.dragging.enabled()&&this.map.dragging.disable(),console.log("[TextRectangle] Div ditable cr",{position:{left:i.x,top:i.y},size:{width:a,height:u},fontSize:v,styles:this.properties.style})}catch(n){console.error("[TextRectangle] Erreur lors de la cration de l'diteur :",n),this._isEditing=!1}}_getJustifyContent(){switch(this.properties.style.textAlign||"center"){case"left":return"flex-start";case"right":return"flex-end";case"center":default:return"center"}}_cleanupEditableDiv(){this._editableDiv&&(this._editableDiv.removeEventListener("keydown",this._onKeyDown),this._editableDiv.removeEventListener("blur",this._finishEditing),this._editableDiv.parentNode&&this._editableDiv.parentNode.removeChild(this._editableDiv),this._editableDiv=null,this._isEditing=!1)}_textRedraw(){if(!Ke.Browser.svg||!this.map||this._isEditing||!this._path){console.log("[TextRectangle] _textRedraw ignor",{reason:Ke.Browser.svg?this.map?this._isEditing?"En cours d'dition":"Chemin SVG non trouv":"Carte non disponible":"SVG non support"});return}this._removeTextNode();const n=this.properties.text;if(n)try{const i=this._path;if(!i){console.warn("[TextRectangle] Chemin SVG non trouv");return}const o=i.ownerSVGElement;if(!o){console.warn("[TextRectangle] lment SVG parent non trouv");return}const a=Ke.SVG.create("text");a.setAttribute("class","leaflet-text-rectangle-text"),Object.assign(a.style,{fill:this.properties.style.textColor||"#000000",fontFamily:this.properties.style.fontFamily||"Arial, sans-serif",fontWeight:this.properties.style.bold?"bold":"normal",fontStyle:this.properties.style.italic?"italic":"normal"});const u=this.getBounds(),d=this.map.latLngToLayerPoint(u.getNorthWest()),f=this.map.latLngToLayerPoint(u.getSouthEast()),v=f.x-d.x,_=f.y-d.y,x=Math.min(v,_)*.1,k=Math.max(10,Math.min(48,x)),w=n.split(`
`),N=k*1.2,z=w.length*N,W=d.y+(_-z)/2,O=this._getTextAnchor(),Z=this._calculateTextX(d.x,f.x,5);if(a.setAttribute("text-anchor",O),a.setAttribute("dominant-baseline","hanging"),w.forEach((se,Se)=>{const Ne=Ke.SVG.create("tspan");Ne.textContent=se,Ne.setAttribute("x",Z.toString()),Ne.setAttribute("dy",Se===0?"0":`${N}px`),Ne.style.fontSize=`${k}px`,a.appendChild(Ne)}),a.setAttribute("y",W.toString()),this.properties.rotation!==0){const se=this.map.latLngToLayerPoint(u.getCenter());a.setAttribute("transform",`rotate(${this.properties.rotation}, ${se.x}, ${se.y})`)}this._textNode=a,o.appendChild(a),this.fire("text:redrawn",{text:n,fontSize:k,position:{x:Z,y:W},dimensions:{width:v,height:_}}),console.log("[TextRectangle] Texte redessin avec succs",{text:n,fontSize:k,position:{x:Z,y:W},dimensions:{width:v,height:_},lines:w.length,lineHeight:N,totalTextHeight:z})}catch(i){console.error("[TextRectangle] Erreur lors du rendu du texte :",i)}}_calculateTextX(n,i,o){const a=i-n;switch(this.properties.style.textAlign){case"left":return n+o;case"right":return i-o;case"center":default:return n+a/2}}_getTextAnchor(){switch(this.properties.style.textAlign){case"left":return"start";case"right":return"end";case"center":default:return"middle"}}_removeTextNode(){this._textNode&&this._textNode.parentNode&&(this._textNode.parentNode.removeChild(this._textNode),this._textNode=null)}getDimensions(){const n=this.getBounds();if(!this.map)return{width:0,height:0};const i=n.getSouthWest(),o=Ke.latLng(n.getSouth(),n.getEast()),a=this.map.distance(i,o),u=this.map.distance(i,Ke.latLng(n.getNorth(),n.getWest()));return{width:a,height:u}}getMidPoints(){const n=this.getBounds(),i=n.getNorthWest(),o=n.getNorthEast(),a=n.getSouthEast(),u=n.getSouthWest();return[Ke.latLng((i.lat+o.lat)/2,(i.lng+o.lng)/2),Ke.latLng((o.lat+a.lat)/2,(o.lng+a.lng)/2),Ke.latLng((u.lat+a.lat)/2,(u.lng+a.lng)/2),Ke.latLng((i.lat+u.lat)/2,(i.lng+u.lng)/2)]}}var ao=63710088e-1,F1={centimeters:ao*100,centimetres:ao*100,degrees:360/(2*Math.PI),feet:ao*3.28084,inches:ao*39.37,kilometers:ao/1e3,kilometres:ao/1e3,meters:ao,metres:ao,miles:ao/1609.344,millimeters:ao*1e3,millimetres:ao*1e3,nauticalmiles:ao/1852,radians:1,yards:ao*1.0936};function wL(e,t,n={}){const i={type:"Feature"};return(n.id===0||n.id)&&(i.id=n.id),n.bbox&&(i.bbox=n.bbox),i.properties=t||{},i.geometry=e,i}function Sf(e,t,n={}){if(!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!tg(e[0])||!tg(e[1]))throw new Error("coordinates must contain numbers");return wL({type:"Point",coordinates:e},t,n)}function xL(e,t="kilometers"){const n=F1[t];if(!n)throw new Error(t+" units is invalid");return e*n}function LL(e,t="kilometers"){const n=F1[t];if(!n)throw new Error(t+" units is invalid");return e/n}function Ef(e){return e%(2*Math.PI)*180/Math.PI}function ea(e){return e%360*Math.PI/180}function tg(e){return!isNaN(e)&&e!==null&&!Array.isArray(e)}function Nc(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if(e.type==="Feature"&&e.geometry!==null&&e.geometry.type==="Point")return[...e.geometry.coordinates];if(e.type==="Point")return[...e.coordinates]}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return[...e];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function CL(e){return e.type==="Feature"?e.geometry:e}function j1(e,t,n={}){if(n.final===!0)return PL(e,t);const i=Nc(e),o=Nc(t),a=ea(i[0]),u=ea(o[0]),d=ea(i[1]),f=ea(o[1]),v=Math.sin(u-a)*Math.cos(f),_=Math.cos(d)*Math.sin(f)-Math.sin(d)*Math.cos(f)*Math.cos(u-a);return Ef(Math.atan2(v,_))}function PL(e,t){let n=j1(t,e);return n=(n+180)%360,n}function kL(e,t,n,i={}){const o=Nc(e),a=ea(o[0]),u=ea(o[1]),d=ea(n),f=LL(t,i.units),v=Math.asin(Math.sin(u)*Math.cos(f)+Math.cos(u)*Math.sin(f)*Math.cos(d)),_=a+Math.atan2(Math.sin(d)*Math.sin(f)*Math.cos(u),Math.cos(f)-Math.sin(u)*Math.sin(v)),x=Ef(_),k=Ef(v);return Sf([x,k],i.properties)}function SL(e,t,n={}){var i=Nc(e),o=Nc(t),a=ea(o[1]-i[1]),u=ea(o[0]-i[0]),d=ea(i[1]),f=ea(o[1]),v=Math.pow(Math.sin(a/2),2)+Math.pow(Math.sin(u/2),2)*Math.cos(d)*Math.cos(f);return xL(2*Math.atan2(Math.sqrt(v),Math.sqrt(1-v)),n.units)}function EL(e,t,n={}){const o=CL(e).coordinates;let a=0;for(let u=0;u<o.length&&!(t>=a&&u===o.length-1);u++)if(a>=t){const d=t-a;if(d){const f=j1(o[u],o[u-1])-180;return kL(o[u],d,f,n)}else return Sf(o[u])}else a+=SL(o[u],o[u+1],n);return Sf(o[o.length-1])}var Af=EL;class Ji extends Ke.Polyline{constructor(n,i={}){super(n,{...i,pmIgnore:!1,interactive:!0});jt(this,"properties");jt(this,"cachedProperties",{});jt(this,"needsUpdate",!0);this.properties={type:"Line",style:i||{}},this.updateProperties(),this.on("add",()=>{this.updateProperties()})}updateProperties(){var o;const n=this.getLatLngs();if(!n||n.length<2){console.warn("Line has less than 2 points, cannot calculate properties");return}const i=n.map(a=>[a.lng,a.lat]);try{const a=uu(i),u=Tc(a,{units:"meters"});let d;if(n.length===2)d=Ke.latLng((n[0].lat+n[1].lat)/2,(n[0].lng+n[1].lng)/2);else{const v=Af(a,u/2,{units:"meters"});d=Ke.latLng(v.geometry.coordinates[1],v.geometry.coordinates[0])}const f=10;this.properties={...this.properties,length:u,center:d,vertices:n.length,surfaceInfluence:u*f,dimensions:{width:f},style:{...this.options,color:this.options.color||"#3388ff",weight:this.options.weight||3,opacity:this.options.opacity||1,dashArray:((o=this.options)==null?void 0:o.dashArray)||""}},this.cachedProperties.length=u,this.cachedProperties.center=d,this.cachedProperties.midPoints=void 0,this.cachedProperties.segmentLengths=void 0,this.needsUpdate=!1,this.fire("properties:updated",{shape:this,properties:this.properties})}catch(a){console.error("Failed to calculate line properties",a)}finally{}}invalidateCache(){this.needsUpdate=!0,this.cachedProperties={}}setLatLngs(n){return super.setLatLngs(n),this.invalidateCache(),this.updateProperties(),this}getMidPoints(){if(!this.needsUpdate&&this.cachedProperties.midPoints)return this.cachedProperties.midPoints;const n=this.getLatLngs(),i=[];if(n.length<2)return i;for(let o=0;o<n.length-1;o++){const a=n[o],u=n[o+1];if(!a||!u){console.warn("Points invalides dtects pour le segment",o);continue}i.push(Ke.latLng((a.lat+u.lat)/2,(a.lng+u.lng)/2))}return this.cachedProperties.midPoints=i,i}getMidPointAt(n){const i=this.getLatLngs();if(n<0||n>=i.length-1||i.length<2)return null;const o=i[n],a=i[n+1];return!o||!a?(console.warn("Points invalides pour calcul du midpoint au segment",n),null):Ke.latLng((o.lat+a.lat)/2,(o.lng+a.lng)/2)}moveVertex(n,i,o=!1){const a=this.getLatLngs();n>=0&&n<a.length&&(a[n]=i,Ke.Polyline.prototype.setLatLngs.call(this,a),this.needsUpdate=!0,this.cachedProperties.midPoints=void 0,this.cachedProperties.segmentLengths=void 0,this.cachedProperties.center=void 0,this.cachedProperties.length=void 0,o&&this.updateProperties())}addVertex(n,i,o=!1){const a=this.getLatLngs();n>=0&&n<a.length-1&&(a.splice(n+1,0,i),Ke.Polyline.prototype.setLatLngs.call(this,a),this.needsUpdate=!0,this.cachedProperties.midPoints=void 0,this.cachedProperties.segmentLengths=void 0,this.cachedProperties.center=void 0,this.cachedProperties.length=void 0,o&&this.updateProperties())}move(n,i=!0){const a=this.getLatLngs().map(u=>Ke.latLng(u.lat+n.lat,u.lng+n.lng));return Ke.Polyline.prototype.setLatLngs.call(this,a),this.fire("move"),this.needsUpdate=!0,this.cachedProperties.center=void 0,i&&this.updateProperties(),this}getCenter(){if(!this.needsUpdate&&this.cachedProperties.center)return this.cachedProperties.center;const n=this.getLatLngs();if(n.length<2)return n[0]||new Ke.LatLng(0,0);try{const i=n.map(f=>[f.lng,f.lat]),o=uu(i),a=Tc(o,{units:"meters"}),u=Af(o,a/2,{units:"meters"}),d=Ke.latLng(u.geometry.coordinates[1],u.geometry.coordinates[0]);return this.cachedProperties.center=d,d}catch(i){console.warn("Error calculating line center with turf.js, using simple method",i);const o=n.reduce((d,f)=>d+f.lat,0)/n.length,a=n.reduce((d,f)=>d+f.lng,0)/n.length,u=new Ke.LatLng(o,a);return this.cachedProperties.center=u,u}}getSegmentLengths(){if(!this.needsUpdate&&this.cachedProperties.segmentLengths)return this.cachedProperties.segmentLengths;const n=this.getLatLngs(),i=[];if(n.length<2)return i;for(let o=0;o<n.length-1;o++){const a=n[o],u=n[o+1];i.push(a.distanceTo(u))}return this.cachedProperties.segmentLengths=i,i}getSegmentLengthAt(n){const i=this.getLatLngs();if(n<0||n>=i.length-1||i.length<2)return 0;const o=i[n],a=i[n+1];return o.distanceTo(a)}getLengthToVertex(n){const i=this.getLatLngs();let o=0;if(n<=0||i.length<2)return 0;for(let a=0;a<Math.min(n,i.length-1);a++)o+=i[a].distanceTo(i[a+1]);return o}getLength(){if(!this.needsUpdate&&this.cachedProperties.length)return this.cachedProperties.length;const n=this.getLatLngs();let i=0;for(let o=0;o<n.length-1;o++)i+=n[o].distanceTo(n[o+1]);return this.cachedProperties.length=i,i}}function AL(e,t,n={}){const i={type:"Feature"};return(n.id===0||n.id)&&(i.id=n.id),n.bbox&&(i.bbox=n.bbox),i.properties=t||{},i.geometry=e,i}function ML(e,t,n={}){if(!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!ng(e[0])||!ng(e[1]))throw new Error("coordinates must contain numbers");return AL({type:"Point",coordinates:e},t,n)}function ng(e){return!isNaN(e)&&e!==null&&!Array.isArray(e)}function z1(e,t,n){if(e!==null)for(var i,o,a,u,d,f,v,_=0,x=0,k,w=e.type,N=w==="FeatureCollection",z=w==="Feature",W=N?e.features.length:1,O=0;O<W;O++){v=N?e.features[O].geometry:z?e.geometry:e,k=v?v.type==="GeometryCollection":!1,d=k?v.geometries.length:1;for(var Z=0;Z<d;Z++){var se=0,Se=0;if(u=k?v.geometries[Z]:v,u!==null){f=u.coordinates;var Ne=u.type;switch(_=Ne==="Polygon"||Ne==="MultiPolygon"?1:0,Ne){case null:break;case"Point":if(t(f,x,O,se,Se)===!1)return!1;x++,se++;break;case"LineString":case"MultiPoint":for(i=0;i<f.length;i++){if(t(f[i],x,O,se,Se)===!1)return!1;x++,Ne==="MultiPoint"&&se++}Ne==="LineString"&&se++;break;case"Polygon":case"MultiLineString":for(i=0;i<f.length;i++){for(o=0;o<f[i].length-_;o++){if(t(f[i][o],x,O,se,Se)===!1)return!1;x++}Ne==="MultiLineString"&&se++,Ne==="Polygon"&&Se++}Ne==="Polygon"&&se++;break;case"MultiPolygon":for(i=0;i<f.length;i++){for(Se=0,o=0;o<f[i].length;o++){for(a=0;a<f[i][o].length-_;a++){if(t(f[i][o][a],x,O,se,Se)===!1)return!1;x++}Se++}se++}break;case"GeometryCollection":for(i=0;i<u.geometries.length;i++)if(z1(u.geometries[i],t)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function BL(e,t={}){let n=0,i=0,o=0;return z1(e,function(a){n+=a[0],i+=a[1],o++}),ML([n/o,i/o],t.properties)}var bc=BL;class Bu extends Ke.Polygon{constructor(n,i={}){super(n,{...i,pmIgnore:!1,interactive:!0});jt(this,"properties");this.properties={type:"Polygon",style:{color:i.color||"#3388ff",weight:i.weight||3,opacity:i.opacity||1,fillColor:i.fillColor||"#3388ff",fillOpacity:i.fillOpacity||.2,dashArray:i.dashArray||""}},this.updateProperties(),this.on({add:()=>this.updateProperties(),edit:()=>this.updateProperties(),drag:()=>this.updateProperties()})}updateProperties(){var n;try{const i=this.getLatLngs()[0];if(!i||i.length<3){console.warn("Polygon has less than 3 points, cannot calculate properties");return}const o=i.map(_=>[_.lng,_.lat]);o.push(o[0]);const a=Sl([o]),u=Eu(a),d=Tc(uu([...o]),{units:"meters"}),f=bc(a),v=Ke.latLng(f.geometry.coordinates[1],f.geometry.coordinates[0]);this.properties={...this.properties,area:u,perimeter:d,center:v,vertices:i.length,surfaceInterieure:u,surfaceExterieure:u,style:{...this.options,color:this.options.color||"#3388ff",weight:this.options.weight||3,opacity:this.options.opacity||1,fillColor:this.options.fillColor||"#3388ff",fillOpacity:this.options.fillOpacity||.2,dashArray:((n=this.options)==null?void 0:n.dashArray)||""}},this.fire("properties:updated",{shape:this,properties:this.properties})}catch(i){console.error("Failed to calculate polygon properties",i)}}setLatLngs(n){return super.setLatLngs(n),this.updateProperties(),this}getMidPoints(){const n=this.getLatLngs()[0],i=[];if(n.length<2)return i;for(let o=0;o<n.length;o++){const a=n[o],u=n[(o+1)%n.length];i.push(Ke.latLng((a.lat+u.lat)/2,(a.lng+u.lng)/2))}return i}moveVertex(n,i){const o=this.getLatLngs()[0];n>=0&&n<o.length&&(o[n]=i,Ke.Polygon.prototype.setLatLngs.call(this,[o]))}addVertex(n,i){const o=this.getLatLngs()[0];n>=0&&n<o.length&&(o.splice((n+1)%o.length,0,i),Ke.Polygon.prototype.setLatLngs.call(this,[o]))}move(n){const o=this.getLatLngs()[0].map(a=>Ke.latLng(a.lat+n.lat,a.lng+n.lng));return Ke.Polygon.prototype.setLatLngs.call(this,[o]),this}getCenter(){const n=this.getLatLngs()[0];if(!n||n.length===0)return new Ke.LatLng(0,0);try{const i=n.filter(v=>v&&typeof v.lat=="number"&&typeof v.lng=="number"&&!isNaN(v.lat)&&!isNaN(v.lng)&&Math.abs(v.lat)<=90&&Math.abs(v.lng)<=180);if(i.length===0)return console.warn("Aucun point valide dans le polygone pour calculer le centre"),new Ke.LatLng(0,0);const o=i.map(v=>[v.lng,v.lat]);o.push(o[0]);const a=Sl([o]),u=bc(a),d=u.geometry.coordinates[1],f=u.geometry.coordinates[0];if(typeof d!="number"||typeof f!="number"||isNaN(d)||isNaN(f)||Math.abs(d)>90||Math.abs(f)>180)throw new Error("Centroid calcul invalide");return Ke.latLng(d,f)}catch(i){console.warn("Erreur lors du calcul du centrode avec turf.js, utilisation de la mthode simple",i);let o=0,a=0,u=0;for(const d of n)d&&typeof d.lat=="number"&&typeof d.lng=="number"&&!isNaN(d.lat)&&!isNaN(d.lng)&&Math.abs(d.lat)<=90&&Math.abs(d.lng)<=180&&(o+=d.lat,a+=d.lng,u++);return u===0?(console.error("Impossible de calculer un centre valide pour le polygone"),new Ke.LatLng(0,0)):new Ke.LatLng(o/u,a/u)}}getSegmentLengths(){const n=this.getLatLngs()[0],i=[];if(n.length<2)return i;for(let o=0;o<n.length;o++){const a=n[o],u=n[(o+1)%n.length];i.push(a.distanceTo(u))}return i}}const Cs=class Cs extends Ji{constructor(n,i={}){super(n,{...i,color:"#FF4500",weight:4,opacity:.8});jt(this,"elevationData",[]);jt(this,"elevationProfile",null);jt(this,"elevationMarker",null);jt(this,"samplePoints",[]);jt(this,"sampleTooltips",[]);jt(this,"samplePointStyle",{radius:4,color:"#FF4500",fillColor:"#FF4500",fillOpacity:.6,weight:2,opacity:.8});jt(this,"minMaxPointStyle",{radius:6,weight:3,opacity:1,fillOpacity:1});this.properties={...this.properties,type:"ElevationLine",elevationProfile:null,maxElevation:0,minElevation:0,elevationGain:0,elevationLoss:0,dataSource:"pending",samplePointStyle:this.samplePointStyle,minMaxPointStyle:this.minMaxPointStyle},this.setupEventListeners()}setupEventListeners(){this.on("edit",()=>this.updateElevationProfile()),this.on("move",()=>this.updateElevationProfile()),this.on("pm:vertexadded",()=>{console.log("[ElevationLine] Vertex added, updating profile"),this.updateElevationProfile()}),this.on("pm:vertexremoved",()=>{console.log("[ElevationLine] Vertex removed, updating profile"),this.updateElevationProfile()}),this.on("pm:dragend",()=>{console.log("[ElevationLine] Drag ended, updating profile"),this.updateElevationProfile()}),this.on("pm:markerdragend",()=>{console.log("[ElevationLine] Marker drag ended, updating profile"),this.updateElevationProfile()}),this.on("pm:edit",n=>{n.layer.properties.type="ElevationLine"})}calculateOptimalSampleCount(){const n=this.getLength(),i=Math.ceil(n/Cs.SAMPLE_DISTANCE);return Math.min(Math.max(i,Cs.MIN_SAMPLES),Cs.MAX_SAMPLES)}async fetchElevationData(n=0){if(this.getLatLngs().length===0)return;const o=this.getLength();let a="";const u=this.calculateOptimalSampleCount();console.log(`[ElevationLine] Using ${u} sample points for ${o.toFixed(0)}m line`);const d=[];for(let f=0;f<u;f++){const v=f/(u-1)*o,_=this.getPointAtDistance(v);_&&d.push(`${_.lat},${_.lng}`)}a=d.join("|");try{const f=await fetch(`${Cs.API_URL}?locations=${a}`);if(!f.ok)throw new Error(`HTTP error ${f.status}`);const v=await f.json();if(!v.results||!Array.isArray(v.results))throw new Error("Invalid API response format");this.elevationData=v.results.map((_,x)=>({distance:x/(u-1)*o,elevation:_.elevation})),this.properties.dataSource="api"}catch(f){if(console.warn(`[ElevationLine] API fetch attempt ${n+1}/${Cs.MAX_RETRIES} failed:`,f),n<Cs.MAX_RETRIES)return await new Promise(v=>setTimeout(v,Cs.RETRY_DELAY)),this.fetchElevationData(n+1);console.warn("[ElevationLine] All API attempts failed, falling back to simulation"),this.simulateElevationData(),this.properties.dataSource="simulation"}this.calculateElevationStatistics()}simulateElevationData(){const n=this.getLength(),i=this.calculateOptimalSampleCount();this.elevationData=Array.from({length:i},(o,a)=>{const u=a/(i-1)*n,d=100+Math.sin(u/n*Math.PI*2)*50;return{distance:u,elevation:d}})}calculateElevationStatistics(){if(!this.elevationData.length)return;const n=this.elevationData.map(d=>d.elevation),i=n.length?Math.max(...n):0,o=n.length?Math.min(...n):0;let a=0,u=0;for(let d=1;d<this.elevationData.length;d++){const f=this.elevationData[d].elevation-this.elevationData[d-1].elevation;f>0?a+=f:u+=Math.abs(f)}this.properties.maxElevation=i,this.properties.minElevation=o,this.properties.elevationGain=a,this.properties.elevationLoss=u}showSamplePoints(){if(this.clearSamplePoints(),!this.elevationData.length)return;const n=this.elevationData.map(a=>a.elevation),i=Math.max(...n),o=Math.min(...n);this.elevationData.forEach(a=>{const u=this.getPointAtDistance(a.distance);if(!u)return;const d=a.elevation===o,f=a.elevation===i;let v={...this.samplePointStyle};d?v={...v,...this.minMaxPointStyle,color:"#DC2626",fillColor:"#DC2626"}:f&&(v={...v,...this.minMaxPointStyle,color:"#059669",fillColor:"#059669"});const _=Ke.circleMarker(u,v),x=Ke.tooltip({permanent:!1,direction:"top",className:"elevation-tooltip",offset:[0,-10]});let k=`
        Distance: ${this.formatDistance(a.distance)}<br>
        Altitude: ${this.formatElevation(a.elevation)}
      `;d&&(k+="<br><strong>Point le plus bas</strong>"),f&&(k+="<br><strong>Point le plus haut</strong>"),x.setContent(k),_.on("mouseover",()=>{_.setStyle({...v,radius:v.radius+2,fillOpacity:1}),_.bindTooltip(x).openTooltip()}),_.on("mouseout",()=>{_.setStyle(v),_.closeTooltip()}),this._map&&(_.addTo(this._map),this.samplePoints.push(_),this.sampleTooltips.push(x))})}clearSamplePoints(){this.samplePoints.forEach(n=>n.remove()),this.samplePoints=[],this.sampleTooltips.forEach(n=>n.remove()),this.sampleTooltips=[]}formatDistance(n){return n>=1e3?`${(n/1e3).toFixed(2)} km`:`${n.toFixed(0)} m`}formatElevation(n){return`${n.toFixed(0)} m`}onAdd(n){return super.onAdd(n),this.showSamplePoints(),this}onRemove(n){return this.clearSamplePoints(),this.hideElevationMarker(),this.elevationProfile&&(this.elevationProfile.remove(),this.elevationProfile=null),super.onRemove(n)}async updateElevationProfile(){await this.fetchElevationData(),this.updateProperties(),this._map&&this.showSamplePoints(),this.fire("elevation:updated",{shape:this,elevationData:this.elevationData,properties:this.properties})}updateProperties(){if(super.updateProperties(),this.elevationData&&this.elevationData.length>0){const n=this.elevationData.map(d=>d.elevation),i=Math.max(...n),o=Math.min(...n);let a=0,u=0;for(let d=1;d<this.elevationData.length;d++){const f=this.elevationData[d].elevation-this.elevationData[d-1].elevation;f>0?a+=f:u+=Math.abs(f)}this.properties={...this.properties,type:"ElevationLine",elevationData:this.elevationData,maxElevation:i,minElevation:o,elevationGain:a,elevationLoss:u}}}getElevationData(){return this.elevationData}showElevationAt(n){if(!this.elevationData.length)return;const i=this.elevationData.reduce((a,u)=>Math.abs(u.distance-n)<Math.abs(a.distance-n)?u:a),o=this.getPointAtDistance(n);!this.elevationMarker&&o?(this.elevationMarker=Ke.circleMarker(o,{radius:6,color:"#FF4500",fillColor:"#FF4500",fillOpacity:1}),this.elevationMarker.addTo(this._map)):this.elevationMarker&&o&&this.elevationMarker.setLatLng(o),this.fire("elevation:show",{distance:n,elevation:i.elevation,latLng:o})}hideElevationMarker(){this.elevationMarker&&(this.elevationMarker.remove(),this.elevationMarker=null)}getPointAtDistance(n){try{const o=this.getLatLngs().map(d=>[d.lng,d.lat]),a=uu(o),u=Af(a,n,{units:"meters"});return Ke.latLng(u.geometry.coordinates[1],u.geometry.coordinates[0])}catch(i){return console.error("Error calculating point at distance",i),null}}moveVertex(n,i,o=!1){super.moveVertex(n,i,!1),this.properties.type="ElevationLine",o&&this.updateElevationProfile()}addVertex(n,i,o=!1){console.warn("[ElevationLine] Tentative d'ajout de vertex ignore - non autoris pour un profil altimtrique")}setLatLngs(n){return super.setLatLngs(n),this.properties.type="ElevationLine",this.updateElevationProfile(),this}move(n,i=!0){return super.move(n,!1),this.properties.type="ElevationLine",i&&this.updateElevationProfile(),this}setSamplePointStyle(n){this.samplePointStyle={...this.samplePointStyle,...n},this.properties.samplePointStyle=this.samplePointStyle,this._map&&this.showSamplePoints()}setMinMaxPointStyle(n){this.minMaxPointStyle={...this.minMaxPointStyle,...n},this.properties.minMaxPointStyle=this.minMaxPointStyle,this._map&&this.showSamplePoints()}};jt(Cs,"API_URL","https://api.open-elevation.com/api/v1/lookup"),jt(Cs,"RETRY_DELAY",2e3),jt(Cs,"MAX_RETRIES",3),jt(Cs,"SAMPLE_DISTANCE",100),jt(Cs,"MIN_SAMPLES",10),jt(Cs,"MAX_SAMPLES",50);let El=Cs;const jh=(e,t)=>{if(!e||typeof e!="string"||!e.startsWith("#"))return`rgba(0, 0, 0, ${t})`;const n=parseInt(e.slice(1,3),16),i=parseInt(e.slice(3,5),16),o=parseInt(e.slice(5,7),16);return`rgba(${n}, ${i}, ${o}, ${t})`},ig=(e,t)=>{e.style.fontSize=t.fontSize,e.style.color=t.color,e.style.backgroundColor=jh(t.backgroundColor,t.backgroundOpacity),t.hasBorder?e.style.border=`${t.borderWidth} solid ${jh(t.borderColor,t.borderOpacity)}`:e.style.border="none",e.style.padding=t.padding,e.style.borderRadius=t.borderRadius},xs=e=>{document.querySelectorAll(".drawing-help-message").forEach(i=>i.remove());const n=Ke.DomUtil.create("div","drawing-help-message");return n.innerHTML=e,n.style.cssText=`
    position: fixed;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    background-color: rgba(0, 0, 0, 0.8);
    color: white;
    padding: 8px 16px;
    border-radius: 4px;
    font-size: 14px;
    z-index: 2000;
    pointer-events: none;
    text-align: center;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
  `,document.body.appendChild(n),n};function rg(e,t,n){const i=156543.03392*Math.cos(t*Math.PI/180)/Math.pow(2,n);return e/i}const hn=(e,t="m",n="")=>{let i,o;return t==="m"?e>=1e4?(i=(e/1e4).toFixed(2),o="ha"):(i=e.toFixed(2),o="m"):t==="m"?e>=1e3?(i=(e/1e3).toFixed(2),o="km"):(i=e.toFixed(2),o="m"):(i=e.toFixed(2),o=t),n?`${n}: ${i} ${o}`:`${i} ${o}`},TL=e=>({...e,clientX:e.clientX,clientY:e.clientY,button:e.button||0,buttons:e.buttons||0,altKey:e.altKey||!1}),NL=(e,t)=>{let n;return function(...i){window.clearTimeout(n),n=window.setTimeout(()=>e.apply(this,i),t)}},xu=(e,t)=>{let n=0;return function(...i){const o=Date.now();if(!(o-n<t))return n=o,e.apply(this,i)}};function DL(){const e=Dt(null),t=Dt(null),n=Dt(null),i=Dt(null),o=Dt(""),a=Dt(null),u=Dt(!1);window.addEventListener("clearControlPoints",()=>{a.value=null,n.value&&n.value.clearLayers(),i.value&&i.value.clearLayers(),document.querySelectorAll(".measure-tooltip").forEach(P=>P.remove()),document.querySelectorAll(".drawing-help-message").forEach(P=>P.remove())}),Jh(()=>{window.removeEventListener("clearControlPoints",()=>{}),e.value&&(e.value.remove(),e.value=null)});const d=(P,F="Double-cliquez pour diter")=>{const G={fontSize:"14px",color:"#000000",backgroundColor:"#FFFFFF",backgroundOpacity:1,borderColor:"#000000",borderWidth:"1px",borderOpacity:1,padding:"5px 10px",borderRadius:"3px",hasBorder:!0,rotation:0,physicalSize:2},Q=($,ce)=>{var ye;const ue=((ye=e.value)==null?void 0:ye.getZoom())||14,V=P.lat,K=rg(ce.physicalSize,V,ue);return`<div class="text-container" style="width:${K}px;height:${K}px;transform:rotate(${ce.rotation}deg)">
        <div class="text-annotation" style="font-size:${K*.2}px;color:${ce.color};background-color:${jh(ce.backgroundColor,ce.backgroundOpacity)};border:${ce.hasBorder?ce.borderWidth+" solid "+jh(ce.borderColor,ce.borderOpacity):"none"};padding:${ce.padding};border-radius:${ce.borderRadius}">${$}</div>
        <div class="text-controls"><div class="control-button rotate"></div><div class="control-button move"></div></div>
      </div>`},Ae=()=>{if(!e.value)return;const $=me.getIcon(),ce={html:Q(me.properties.text,me.properties.style),className:$.options.className};me.setIcon(Ke.divIcon(ce))},oe=Ke.divIcon({html:Q(F,G),className:"text-container",iconSize:[40,40],iconAnchor:[20,20]}),me=Ke.marker(P,{icon:oe,draggable:!1,pmIgnore:!0});me.properties={type:"text",text:F,style:{...G}},e.value&&(e.value.on("zoomend",Ae),me.on("remove",()=>{var $;($=e.value)==null||$.off("zoomend",Ae)})),Ae();let T=!1,ne=!1,ae=0,q=0;const R=$=>{if(!e.value)return;const ce=$.target;if(ce.classList.contains("rotate")){T=!0;const ue=me.getLatLng(),V=e.value.mouseEventToLatLng($);ae=Math.atan2(V.lat-ue.lat,V.lng-ue.lng)*180/Math.PI,q=me.properties.style.rotation||0}else ce.classList.contains("move")&&(ne=!0);document.addEventListener("mousemove",U),document.addEventListener("mouseup",H)},U=$=>{if(!(!ne||!e.value)){if(T){const ce=me.getLatLng(),ue=e.value.mouseEventToLatLng($),V=Math.atan2(ue.lat-ce.lat,ue.lng-ce.lng)*180/Math.PI,K=(q+(V-ae))%360;me.properties.style.rotation=K;const ye=me.getIcon(),ve={html:Q(me.properties.text,me.properties.style),className:ye.options.className};me.setIcon(Ke.divIcon(ve))}else if(ne){const ce=TL($),ue=e.value.mouseEventToLatLng(ce);me.setLatLng(ue)}}},H=()=>{T=!1,ne=!1,document.removeEventListener("mousemove",U),document.removeEventListener("mouseup",H)};return me.on("add",()=>{const $=me.getElement();$&&$.querySelectorAll(".control-button").forEach(ue=>{ue.addEventListener("mousedown",R)})}),me.on("remove",()=>{const $=me.getElement();$&&$.querySelectorAll(".control-button").forEach(ue=>{ue.removeEventListener("mousedown",R)})}),me.on("dblclick",$=>{var ve;Ke.DomEvent.stopPropagation($);const ce=(ve=me.getElement())==null?void 0:ve.querySelector(".text-annotation");if(!ce)return;ce.contentEditable="true",ce.focus(),ce.classList.add("editing");const ue=window.getSelection(),V=document.createRange();V.selectNodeContents(ce),ue==null||ue.removeAllRanges(),ue==null||ue.addRange(V);const K=()=>{ce.contentEditable="false",ce.classList.remove("editing");const ee=ce.innerText.trim();if(ee){me.properties.text=ee;const Ge=me.getIcon(),tt={html:Q(ee,me.properties.style),className:Ge.options.className};me.setIcon(Ke.divIcon(tt))}ce.removeEventListener("blur",K),ce.removeEventListener("keydown",ye)},ye=ee=>{ee.key==="Enter"&&!ee.shiftKey&&(ee.preventDefault(),K())};ce.addEventListener("blur",K),ce.addEventListener("keydown",ye)}),me},f=(P,F)=>{const G=Ke.DomUtil.create("div","measure-tooltip");if(G.innerHTML=F,G.style.cssText=`
      position: fixed;
      background-color: rgba(0, 0, 0, 0.8);
      color: white;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 12px;
      z-index: 2000;
      pointer-events: none;
      white-space: pre-line;
    `,document.body.appendChild(G),e.value){const Q=e.value.latLngToContainerPoint(P);G.style.left=`${Q.x+10}px`,G.style.top=`${Q.y-25}px`}return G},v=xu((P,F,G)=>{if(P&&(P.innerHTML=G,e.value)){const Q=e.value.latLngToContainerPoint(F);P.style.left=`${Q.x+10}px`,P.style.top=`${Q.y-25}px`}},100),_=(P,F,G)=>{P.on("mouseover",()=>{const Q=f(P.getLatLng(),G());P.measureDiv=Q}),P.on("mousemove",Q=>{P.measureDiv&&e.value&&v(P.measureDiv,Q.latlng,G())}),P.on("mouseout",()=>{P.measureDiv&&(P.measureDiv.remove(),P.measureDiv=void 0)})};let x=[];const k=()=>{x.forEach(P=>{P&&P.remove&&("measureDiv"in P&&P.measureDiv&&(P.measureDiv.remove(),P.measureDiv=void 0),n.value&&n.value.removeLayer(P),P.remove())}),x=[],document.querySelectorAll(".measure-tooltip").forEach(P=>{P.remove()})},w=(P,F="#2563EB")=>{const G=Ke.circleMarker(P,{radius:6,color:F,fillColor:F,fillOpacity:1,weight:2,className:"control-point",pmIgnore:!0});return n.value&&n.value.addLayer(G),G},N=(P,F)=>{var Q,Ae,oe,me,T,ne;console.log("Input layer:",{type:F,instanceof:{Circle:P instanceof Ke.Circle,Rectangle:P instanceof Ke.Rectangle,Polygon:P instanceof Ke.Polygon,Polyline:P instanceof Ke.Polyline,CircleArc:P instanceof nl,TextRectangle:P instanceof Bo,ElevationLine:P instanceof El,Line:P instanceof Ji},options:P.options});const G={type:F,style:P.options||{}};try{if(P instanceof Bo)return P.properties;if(P instanceof Ke.Circle){const ae=P.getRadius(),q=P.getLatLng();G.radius=ae,G.diameter=ae*2,G.area=Math.PI*Math.pow(ae,2),G.perimeter=2*Math.PI*ae,G.center=q,G.surfaceInterieure=G.area,G.surfaceExterieure=G.area}else if(P instanceof nl){const ae=P.getRadius(),q=P.getCenter(),R=P.getStartAngle(),U=P.getStopAngle(),H=P.getOpeningAngle();G.radius=ae,G.diameter=ae*2,G.area=Math.PI*Math.pow(ae,2)*H/360,G.arcLength=2*Math.PI*ae*H/360,G.perimeter=G.arcLength+2*ae,G.center=q,G.startAngle=R,G.stopAngle=U,G.openingAngle=H,G.surfaceInterieure=G.area,G.surfaceExterieure=G.area}else if(P instanceof Ke.Rectangle){const ae=P.getBounds(),q=ae.getNorthEast(),R=ae.getSouthWest(),U=tu([R.lng,R.lat],[q.lng,R.lat],{units:"meters"}),H=tu([R.lng,R.lat],[R.lng,q.lat],{units:"meters"});G.width=U,G.height=H,G.area=U*H,G.perimeter=2*(U+H),G.surfaceInterieure=G.area,G.surfaceExterieure=G.area,G.dimensions={width:U,height:H}}else if(P instanceof Ke.Polygon){const q=P.getLatLngs()[0].map(U=>[U.lng,U.lat]);q.push(q[0]);const R=Sl([q]);G.area=Eu(R),G.perimeter=Tc(uu([...q]),{units:"meters"}),G.surfaceInterieure=G.area,G.surfaceExterieure=G.area}else if(P instanceof Ke.Polyline&&!(P instanceof Ke.Polygon))if(P instanceof El)P.updateProperties(),Object.assign(G,{...P.properties,type:"ElevationLine"}),console.log("[calculateShapeProperties] ElevationLine properties:",G);else if(P instanceof Ji)P.updateProperties(),Object.assign(G,{...P.properties,type:"Line"});else{const q=P.getLatLngs().map(H=>[H.lng,H.lat]),R=uu(q);G.length=Tc(R,{units:"meters"});const U=10;G.surfaceInfluence=G.length*U,G.dimensions={width:U},G.type="Line"}G.style={...G.style,color:((Q=P.options)==null?void 0:Q.color)||"#3388ff",weight:((Ae=P.options)==null?void 0:Ae.weight)||3,opacity:((oe=P.options)==null?void 0:oe.opacity)||1,fillColor:((me=P.options)==null?void 0:me.fillColor)||"#3388ff",fillOpacity:((T=P.options)==null?void 0:T.fillOpacity)||.2,dashArray:((ne=P.options)==null?void 0:ne.dashArray)||""}}catch(ae){console.error("Error calculating shape properties:",ae)}return G},z=(P,F=2)=>{var me;if(!e.value){console.warn("Map is not available for text size update");return}const G=e.value.getZoom(),Q=P.getLatLng().lat,Ae=rg(F,Q,G),oe=(me=P.getElement())==null?void 0:me.querySelector(".text-annotation");oe&&(P.properties.style.fontSize=`${Ae}px`,P.properties.physicalWidth=F,P.properties.physicalHeight=F,ig(oe,P.properties.style))},W=(P,F,G)=>{const Q=Ke.map(P).setView(F,G);e.value=Q,Ke.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:" OpenStreetMap contributors"}).addTo(Q);const Ae=new Ke.FeatureGroup;return Ae.addTo(Q),t.value=Ae,n.value=Ke.featureGroup().addTo(Q),i.value=Ke.featureGroup().addTo(Q),Q.pm.setGlobalOptions({snappable:!0,snapDistance:20,allowSelfIntersection:!1,preventMarkerRemoval:!0,syncLayersOnDrag:!0,layerGroup:Ae,snapLayers:[Ae,i.value],templineStyle:{color:"#3388ff",weight:2,opacity:.7,dashArray:"6,6",radius:6},hintlineStyle:{color:"#3388ff",weight:2,opacity:.7,dashArray:"6,6",radius:6}}),Q.on("pm:drawstart",oe=>{u.value=!0,oe.shape==="Circle"&&o.value==="Semicircle"&&(Q.getContainer().style.cursor="crosshair")}),Q.on("pm:drawend",()=>{u.value=!1,Q.getContainer().style.cursor="",a.value&&xs("Cliquez sur la forme pour afficher les points de contrle")}),Q.on("pm:create",async oe=>{var ne,ae,q,R,U,H,$,ce,ue,V,K;const me=oe.layer;(ne=t.value)==null||ne.addLayer(me);let T="unknown";if(me instanceof Ke.Circle?T=o.value==="Semicircle"?"Semicircle":"Circle":me instanceof Ke.Rectangle?T="Rectangle":me instanceof Ke.Polygon?T="Polygon":me instanceof Ke.Polyline&&!(me instanceof Ke.Polygon)&&(T="Line"),me.properties=N(me,T),a.value=me,window.dispatchEvent(new CustomEvent("shape:created",{detail:{shape:me,type:T,properties:me.properties}})),me.on("mouseover",()=>{console.log("[mouseover] Survol de la forme",{type:T,isSelected:a.value===me}),(!a.value||a.value!==me)&&Ee(me)}),me.on("mouseout",()=>{var ye;console.log("[mouseout] Sortie de la forme",{type:T,isSelected:a.value===me}),(!a.value||a.value!==me)&&((ye=i.value)==null||ye.clearLayers())}),T==="Semicircle"){const ye=me.getLatLng(),ve=me.getRadius();(ae=t.value)==null||ae.removeLayer(me);const ee=new nl(ye,ve);ee.properties=N(ee,"Semicircle"),(q=t.value)==null||q.addLayer(ee),a.value=ee,J(ee)}else if(T==="Circle"){(R=t.value)==null||R.removeLayer(me);const ye=new rc(me.getLatLng(),{...me.options,radius:me.getRadius()});ye.updateProperties(),(U=t.value)==null||U.addLayer(ye),a.value=ye,xe(ye)}else if(T==="Rectangle"){(H=t.value)==null||H.removeLayer(me);const ye=new Ca(me.getBounds(),{...me.options});ye.updateProperties(),($=t.value)==null||$.addLayer(ye),a.value=ye,Be(ye)}else if(me instanceof Ke.Polygon){const ye=me.getLatLngs()[0],ve=new Bu([ye],{...me.options});ve.updateProperties(),(ce=t.value)==null||ce.removeLayer(me),(ue=t.value)==null||ue.addLayer(ve),a.value=ve,te(ve)}else if(me instanceof Ji)ze(me);else if(me instanceof Ke.Polyline&&!(me instanceof Ke.Polygon)){const ye=me.getLatLngs(),ve=new Ji(ye,{...me.options});ve.updateProperties(),(V=t.value)==null||V.removeLayer(me),(K=t.value)==null||K.addLayer(ve),a.value=ve,ze(ve)}xs("Cliquez sur la forme pour afficher les points de contrle")}),Ae.on("click",oe=>{var T,ne,ae,q,R,U,H,$,ce;Ke.DomEvent.stopPropagation(oe);const me=oe.layer;if(console.log("[featureGroup click] Slection de forme",{type:(T=me.properties)==null?void 0:T.type,previouslySelected:a.value===me}),(ne=i.value)==null||ne.clearLayers(),k(),(ae=document.querySelector(".drawing-help-message"))==null||ae.remove(),a.value=me,me instanceof Bo){console.log("[featureGroup click] TextRectangle slectionn",{id:me._leaflet_id,bounds:me.getBounds(),hasTextContainer:!!me.getTextElement(),properties:me.properties}),(q=e.value)!=null&&q.pm.globalEditModeEnabled()&&e.value.pm.disableGlobalEditMode(),he(me),xs("Double-cliquez pour diter le texte. Utilisez les points rouges pour redimensionner.");return}if(me instanceof nl||((R=me.properties)==null?void 0:R.type)==="Semicircle")J(me);else if(me instanceof rc)xe(me);else if(me instanceof Ke.Circle){const ue=new rc(me.getLatLng(),{...me.options,radius:me.getRadius()});ue.updateProperties(),(U=t.value)==null||U.removeLayer(me),(H=t.value)==null||H.addLayer(ue),a.value=ue,xe(ue)}else if(me instanceof Ca)Be(me);else if(me instanceof Ke.Rectangle){const ue=new Ca(me.getBounds(),{...me.options});ue.updateProperties(),($=t.value)==null||$.removeLayer(me),(ce=t.value)==null||ce.addLayer(ue),a.value=ue,Be(ue)}else me instanceof Ke.Polygon?te(me):(me instanceof Ji||me instanceof Ke.Polyline&&!(me instanceof Ke.Polygon))&&ze(me)}),Q.on("pm:edit",oe=>{var T,ne,ae;console.log("[pm:edit] Dbut",{layer:oe.layer,currentProperties:oe.layer.properties});const me=oe.layer;if(me){const q=((T=me.properties)==null?void 0:T.type)||"unknown";if($e(me,q),console.log("[pm:edit] Aprs updateLayerProperties",{updatedProperties:me.properties,selectedShape:a.value}),q==="Semicircle")J(me);else if(me instanceof rc)xe(me);else if(me instanceof Ca)Be(me);else if(me instanceof Ke.Rectangle){const R=new Ca(me.getBounds(),{...me.options});R.updateProperties(),(ne=t.value)==null||ne.removeLayer(me),(ae=t.value)==null||ae.addLayer(R),a.value=R,Be(R)}else me instanceof Ke.Polygon?te(me):me instanceof Ji?(me.updateProperties(),$e(me,"Line"),ze(me)):me instanceof Ke.Polyline&&ze(me)}}),Q.on("pm:dragstart",()=>{document.querySelectorAll(".drawing-help-message").forEach(oe=>oe.remove()),xs("Dplacez la forme  l'endroit souhait")}),Q.on("pm:dragend",oe=>{var T,ne,ae;console.log("[pm:dragend] Dbut",{layer:oe.layer,currentProperties:oe.layer.properties});const me=oe.layer;if(me){const q=((T=me.properties)==null?void 0:T.type)||"unknown";if(me instanceof Ke.Rectangle&&!(me instanceof Ca)){const R=new Ca(me.getBounds(),{...me.options});R.updateProperties(),(ne=t.value)==null||ne.removeLayer(me),(ae=t.value)==null||ae.addLayer(R),a.value=R,Be(R)}else me instanceof Ji?(me.updateProperties(),$e(me,"Line"),ze(me)):$e(me,q);console.log("[pm:dragend] Aprs updateLayerProperties",{updatedProperties:me.properties,selectedShape:a.value})}setTimeout(()=>{xs("Cliquez sur la forme pour afficher les points de contrle")},100)}),Q.on("pm:remove",()=>{var oe;(oe=document.querySelector(".drawing-help-message"))==null||oe.remove()}),Q.on("pm:select",oe=>{var T;const me=oe.layer;document.querySelectorAll(".drawing-help-message").forEach(ne=>ne.remove()),me instanceof nl||((T=me.properties)==null?void 0:T.type)==="Semicircle"?xs(`Points de contrle : <span style="color: #059669"></span> Ajuster le rayon, <span style="color: #2563EB"></span> et <span style="color: #DC2626"></span> Modifier l'ouverture du demi-cercle`):xs("Utilisez les points de contrle pour modifier la forme")}),Q.on("pm:unselect",()=>{document.querySelectorAll(".drawing-help-message").forEach(oe=>oe.remove())}),Q.on("zoomstart",()=>{a.value&&(k(),a.value=null,document.querySelectorAll(".drawing-help-message").forEach(oe=>oe.remove()))}),Q},O=()=>{if(!e.value||!t.value)return;const P=t.value.getBounds();P.isValid()&&e.value.fitBounds(P,{padding:[50,50],maxZoom:19})},Z=P=>{var F;if(e.value){document.querySelectorAll(".drawing-help-message").forEach(G=>G.remove());try{const G=e.value.pm;G.globalEditModeEnabled()&&G.disableGlobalEditMode(),G.globalRemovalModeEnabled()&&G.disableGlobalRemovalMode(),G.disableDraw(),k(),(F=i.value)==null||F.clearLayers()}catch(G){console.error("Error disabling modes:",G)}if(o.value=P,!P){k();return}setTimeout(()=>{var G,Q,Ae,oe,me,T,ne,ae,q,R,U,H,$;try{switch(P){case"Circle":case"Semicircle":const ce=(G=t.value)==null?void 0:G.getLayers().filter(ue=>ue instanceof Ca||ue instanceof Bo);ce&&ce.length>0&&ce.forEach(ue=>{var Ge;if(!ue.getBounds)return;const V=ue.getBounds();[V.getNorthWest(),V.getNorthEast(),V.getSouthEast(),V.getSouthWest()].forEach(tt=>{var nt;const Ue=Ke.circleMarker(tt,{radius:4,color:"#DC2626",fillColor:"#DC2626",fillOpacity:.4,weight:2,className:"temp-corner-marker",pmIgnore:!0});(nt=i.value)==null||nt.addLayer(Ue)}),(ue instanceof Ca?ue.getMidPoints():[Ke.latLng((V.getNorth()+V.getSouth())/2,V.getWest()),Ke.latLng(V.getNorth(),(V.getEast()+V.getWest())/2),Ke.latLng((V.getNorth()+V.getSouth())/2,V.getEast()),Ke.latLng(V.getSouth(),(V.getEast()+V.getWest())/2)]).forEach(tt=>{var nt;const Ue=Ke.circleMarker(tt,{radius:5,color:"#2563EB",fillColor:"#2563EB",fillOpacity:.6,weight:2,className:"temp-midpoint-marker",pmIgnore:!0});(nt=i.value)==null||nt.addLayer(Ue)});const ve=V.getCenter(),ee=Ke.circleMarker(ve,{radius:4,color:"#059669",fillColor:"#059669",fillOpacity:.4,weight:2,className:"temp-center-marker",pmIgnore:!0});(Ge=i.value)==null||Ge.addLayer(ee)}),e.value.pm.setGlobalOptions({snapDistance:20,snapSegment:!0,snapLayers:[t.value,i.value]}),xs(P==="Circle"?"Positionnez le centre du cercle. Points bleus : milieu des cts, Points rouges : sommets, Point vert : centre":"Positionnez le centre du demi-cercle. Points bleus : milieu des cts, Points rouges : sommets, Point vert : centre"),e.value.pm.enableDraw("Circle",{finishOn:"mouseup",continueDrawing:!1});break;case"Rectangle":xs("Cliquez et maintenez pour dessiner un rectangle, relchez pour terminer"),(Q=e.value)==null||Q.pm.enableDraw("Rectangle",{finishOn:"mouseup"});break;case"Polygon":xs("Cliquez pour ajouter des points, double-cliquez pour terminer le polygone"),(Ae=e.value)==null||Ae.pm.enableDraw("Polygon",{finishOn:"dblclick",continueDrawing:!1,snapMiddle:!0,snapDistance:20});break;case"Line":xs("Cliquez pour ajouter des points, double-cliquez pour terminer la ligne"),(oe=e.value)==null||oe.pm.enableDraw("Line",{finishOn:"dblclick",continueDrawing:!1,snapMiddle:!0,snapDistance:20});break;case"Text":if(xs("Cliquez pour ajouter du texte, double-cliquez pour diter"),e.value){const ue=V=>{if(!e.value||!t.value)return;const K=d(V.latlng);t.value.addLayer(K),a.value=K,e.value.off("click",ue),Z("")};e.value.on("click",ue)}break;case"delete":xs("Cliquez sur une forme pour la supprimer"),(me=e.value)==null||me.pm.enableGlobalRemovalMode();break;case"TextRectangle":xs("Cliquez et maintenez pour dessiner un rectangle avec texte, relchez pour terminer"),(T=e.value)!=null&&T.pm.globalEditModeEnabled()&&e.value.pm.disableGlobalEditMode(),(ne=e.value)==null||ne.pm.enableDraw("Rectangle",{finishOn:"mouseup",continueDrawing:!1,templineStyle:{color:"#3B82F6",weight:2,dashArray:"5,5"}}),(ae=e.value)==null||ae.off("pm:create"),(q=e.value)==null||q.on("pm:create",ue=>{var V,K,ye;if(ue.shape==="Rectangle"&&ue.layer){const ve=ue.layer.getBounds();let ee=!1;if(t.value&&t.value.eachLayer(Ge=>{if(Ge instanceof Bo){const tt=Ge.getBounds(),Ue=1e-8;Math.abs(tt.getNorth()-ve.getNorth())<Ue&&Math.abs(tt.getSouth()-ve.getSouth())<Ue&&Math.abs(tt.getEast()-ve.getEast())<Ue&&Math.abs(tt.getWest()-ve.getWest())<Ue&&(ee=!0,a.value=Ge,console.log("[TextRectangle] Rectangle existant trouv, slection au lieu de cration"))}}),!ee){(V=e.value)==null||V.removeLayer(ue.layer),(K=t.value)!=null&&K.hasLayer(ue.layer)&&t.value.removeLayer(ue.layer);const Ge=new Bo(ve,"Double-cliquez pour diter",{color:"#3B82F6",weight:2,fillColor:"#F9FAFB",fillOpacity:.8,textColor:"#000000",fontFamily:"Arial, sans-serif",textAlign:"center",bold:!1,italic:!1});t.value&&(t.value.addLayer(Ge),a.value=Ge,Ge.updateProperties(),he(Ge),console.log("[TextRectangle] Nouveau rectangle cr avec succs",{bounds:Ge.getBounds(),properties:Ge.properties,style:Ge.properties.style}))}(ye=e.value)==null||ye.pm.disableDraw()}});break;case"ElevationLine":xs("Cliquez et maintenez pour tracer le profil altimtrique"),(R=e.value)==null||R.pm.enableDraw("Line",{finishOn:"mouseup",continueDrawing:!1,allowSelfIntersection:!1,templineStyle:{color:"#FF4500",weight:4,opacity:.8}}),(U=e.value)==null||U.pm.setGlobalOptions({continueDrawing:!1,finishOn:"mouseup"}),(H=e.value)==null||H.off("pm:create"),($=e.value)==null||$.on("pm:create",async ue=>{var V,K,ye;if(ue.shape==="Line"&&ue.layer){const ve=ue.layer.getLatLngs();(V=e.value)==null||V.removeLayer(ue.layer),(K=t.value)!=null&&K.hasLayer(ue.layer)&&t.value.removeLayer(ue.layer);const ee=new El(ve,{color:"#FF4500",weight:4,opacity:.8});t.value&&(t.value.addLayer(ee),a.value=ee,await ee.updateElevationProfile(),ze(ee)),(ye=e.value)==null||ye.pm.disableDraw(),o.value=""}});break}}catch(ce){console.error("Error enabling tool:",ce)}},100)}},se=P=>{var G;if(!a.value)return;const F=a.value;if(F.properties=F.properties||{},F.properties.style=F.properties.style||{},F.properties.style={...F.properties.style,...P},F.properties.type==="text"){const Q=F.properties._textLayer,Ae=(G=Q==null?void 0:Q.getElement())==null?void 0:G.querySelector(".text-annotation");Ae&&ig(Ae,F.properties.style);const oe={color:P.borderColor||F.properties.style.borderColor,weight:parseInt(P.borderWidth||F.properties.style.borderWidth),opacity:P.borderOpacity??F.properties.style.borderOpacity};"setStyle"in F&&F.setStyle(oe)}else if(F.properties.type==="TextRectangle"){if(F instanceof Bo){const Q={};P.textColor!==void 0&&(Q.textColor=P.textColor),P.fontSize!==void 0&&(Q.fontSize=P.fontSize),P.fontFamily!==void 0&&(Q.fontFamily=P.fontFamily),P.backgroundColor!==void 0&&(Q.backgroundColor=P.backgroundColor),P.backgroundOpacity!==void 0&&(Q.backgroundOpacity=P.backgroundOpacity),P.textAlign!==void 0&&(Q.textAlign=P.textAlign),P.bold!==void 0&&(Q.bold=P.bold),P.italic!==void 0&&(Q.italic=P.italic),P.fillColor&&(Q.fillColor=P.fillColor),P.fillOpacity!==void 0&&(Q.fillOpacity=P.fillOpacity),P.strokeColor&&(Q.color=P.strokeColor),P.color&&(Q.color=P.color),P.strokeOpacity!==void 0&&(Q.opacity=P.strokeOpacity),P.strokeWidth!==void 0&&(Q.weight=P.strokeWidth),P.weight!==void 0&&(Q.weight=P.weight),P.dashArray&&(Q.dashArray=P.dashArray),F.setTextStyle(Q)}}else{const Q={};P.fillColor&&(Q.fillColor=P.fillColor),P.fillOpacity!==void 0&&(Q.fillOpacity=P.fillOpacity),P.strokeColor&&(Q.color=P.strokeColor),P.strokeOpacity!==void 0&&(Q.opacity=P.strokeOpacity),P.strokeWidth!==void 0&&(Q.weight=P.strokeWidth),P.dashArray&&(Q.dashArray=P.dashArray),"setStyle"in F&&F.setStyle(Q)}},Se=P=>{if(!a.value)return;const F=a.value;F.properties={...F.properties,...P},P.radius&&F instanceof Ke.Circle&&F.setRadius(P.radius)},Ne=P=>{console.log("[forceShapeUpdate] Dbut",{currentProperties:P.properties,selectedShapeRef:a.value}),a.value=null,Di(()=>{a.value=P,console.log("[forceShapeUpdate] Aprs mise  jour",{selectedShape:a.value,properties:a.value.properties})})},$e=(P,F)=>{console.log("[updateLayerProperties] Dbut",{layer:P,shapeType:F,currentProperties:P.properties}),NL((Q,Ae)=>{const oe=N(Q,Ae);console.log("[updateLayerProperties] Nouvelles proprits calcules",{newProperties:oe}),Q.properties={...oe},Ne(Q),Q.fire("properties:updated",{shape:Q,properties:Q.properties}),console.log("[updateLayerProperties] Fin",{finalProperties:Q.properties,selectedShape:a.value})},100)(P,F)},Pe=(P,F)=>Ke.latLng((P.lat+F.lat)/2,(P.lng+F.lng)/2),xe=P=>{if(!e.value||!t.value)return;k();const F=P.getLatLng(),G=P.getRadius(),Q=w(F,"#059669");x.push(Q),_(Q,P,()=>[hn(G,"m","Rayon"),hn(G*2,"m","Diamtre"),hn(Math.PI*Math.pow(G,2),"m","Surface")].join("<br>"));const Ae=[],oe=[0,45,90,135,180,225,270,315];oe.forEach(me=>{const T=P.calculatePointOnCircle(me),ne=w(T,"#2563EB");Ae.push(ne),x.push(ne),_(ne,P,()=>hn(G,"m","Rayon")),ne.on("mousedown",ae=>{if(!e.value)return;Ke.DomEvent.stopPropagation(ae),e.value.dragging.disable();let q=!0;const R=H=>{q&&(P.resizeFromControlPoint(H.latlng),Ae.forEach(($,ce)=>{const ue=P.calculatePointOnCircle(oe[ce]);$.setLatLng(ue)}),Q.setLatLng(P.getLatLng()),ne.measureDiv&&(ne.measureDiv.innerHTML=hn(P.getRadius(),"m","Rayon")))},U=()=>{q=!1,e.value&&(e.value.off("mousemove",R),document.removeEventListener("mouseup",U),e.value.dragging.enable(),P.updateProperties(),a.value=null,Di(()=>{a.value=P}),$e(P,"Circle"))};e.value.on("mousemove",R),document.addEventListener("mouseup",U)})}),Q.on("mousedown",me=>{if(!e.value)return;Ke.DomEvent.stopPropagation(me),e.value.dragging.disable();let T=!0;const ne=P.getLatLng(),ae=me.latlng,q=U=>{if(!T)return;const H=U.latlng.lng-ae.lng,$=U.latlng.lat-ae.lat,ce=Ke.latLng(ne.lat+$,ne.lng+H);Ke.Circle.prototype.setLatLng.call(P,ce),Q.setLatLng(ce),Ae.forEach((ue,V)=>{const K=P.calculatePointOnCircle(oe[V]);ue.setLatLng(K)}),Q.measureDiv&&(Q.measureDiv.innerHTML=[hn(P.getRadius(),"m","Rayon"),hn(P.getRadius()*2,"m","Diamtre"),hn(Math.PI*Math.pow(P.getRadius(),2),"m","Surface")].join("<br>"))},R=()=>{T=!1,e.value&&(e.value.off("mousemove",q),document.removeEventListener("mouseup",R),e.value.dragging.enable(),P.updateProperties(),a.value=null,Di(()=>{a.value=P}),$e(P,"Circle"))};e.value.on("mousemove",q),document.addEventListener("mouseup",R)}),P.on("circle:resized",()=>{$e(P,"Circle")}),a.value=P},Be=P=>{if(!e.value||!t.value)return;if(!(P instanceof Ca)){console.warn("La couche n'est pas une instance de Rectangle");return}const F=P;k();const G=F.getBounds(),Q=G.getCenter(),Ae=[G.getNorthWest(),G.getNorthEast(),G.getSouthEast(),G.getSouthWest()],oe=w(Q,"#059669");x.push(oe),_(oe,F,()=>{const{width:ae,height:q}=F.getDimensions(),R=ae*q;return[hn(ae,"m","Largeur"),hn(q,"m","Hauteur"),hn(R,"m","Surface")].join("<br>")});const me=[];Ae.forEach((ae,q)=>{const R=w(ae,"#DC2626");me.push(R),x.push(R),_(R,F,()=>{const{width:U,height:H}=F.getDimensions();return[hn(U,"m","Largeur"),hn(H,"m","Hauteur")].join("<br>")}),R.on("mousedown",U=>{if(!e.value)return;Ke.DomEvent.stopPropagation(U),e.value.dragging.disable();const H=ce=>{F.resizeFromCorner(q,ce.latlng);const ue=F.getBounds(),V=[ue.getNorthWest(),ue.getNorthEast(),ue.getSouthEast(),ue.getSouthWest()];R.setLatLng(ce.latlng),oe.setLatLng(ue.getCenter()),me.forEach((ye,ve)=>{ve!==q&&ye.setLatLng(V[ve])});const K=F.getMidPoints();T.forEach((ye,ve)=>{ye.setLatLng(K[ve]);const{width:ee,height:Ge}=F.getDimensions(),tt=ve%2===0?ee:Ge;ye.measureDiv&&(ye.measureDiv.innerHTML=[hn(tt,"m","Longueur du ct"),hn(tt/2,"m","Distance au coin")].join("<br>"))})},$=()=>{e.value&&(e.value.off("mousemove",H),document.removeEventListener("mouseup",$),e.value.dragging.enable(),F.updateProperties(),a.value=null,Di(()=>{a.value=F}))};e.value.on("mousemove",H),document.addEventListener("mouseup",$)})});const T=[];F.getMidPoints().forEach((ae,q)=>{const R=w(ae,"#2563EB");T.push(R),x.push(R),_(R,F,()=>{const{width:U,height:H}=F.getDimensions(),$=q%2===0?U:H;return[hn($,"m","Longueur du ct"),hn($/2,"m","Distance au coin")].join("<br>")}),R.on("mousedown",U=>{Ke.DomEvent.stopPropagation(U),e.value.dragging.disable();const H=ce=>{const ue=e.value.mouseEventToLatLng(ce.originalEvent),V=F.getBounds(),K=V.getNorthWest(),ye=V.getSouthEast();let ve;if(q%2===0){const Ue=(K.lng+ye.lng)/2;ve=Ke.latLng(ue.lat,Ue)}else{const Ue=(K.lat+ye.lat)/2;ve=Ke.latLng(Ue,ue.lng)}F.resizeFromSide(q,ve);const ee=F.getBounds(),Ge=[ee.getNorthWest(),ee.getNorthEast(),ee.getSouthEast(),ee.getSouthWest()];oe.setLatLng(ee.getCenter()),me.forEach((Ue,nt)=>{Ue.setLatLng(Ge[nt])});const tt=F.getMidPoints();T.forEach((Ue,nt)=>{Ue.setLatLng(tt[nt]);const{width:st,height:Ct}=F.getDimensions(),xt=nt%2===0?st:Ct;Ue.measureDiv&&(Ue.measureDiv.innerHTML=[hn(xt,"m","Longueur du ct"),hn(xt/2,"m","Distance au coin")].join("<br>"))})},$=()=>{e.value.dragging.enable(),e.value.off("mousemove",H),document.removeEventListener("mouseup",$),F.updateProperties(),a.value=null,Di(()=>{a.value=F})};e.value.on("mousemove",H),document.addEventListener("mouseup",$)})}),oe.on("mousedown",ae=>{if(!e.value)return;Ke.DomEvent.stopPropagation(ae),e.value.dragging.disable();let q=!0;const R=H=>{if(!q)return;F.moveFromCenter(H.latlng),oe.setLatLng(H.latlng);const $=F.getBounds(),ce=[$.getNorthWest(),$.getNorthEast(),$.getSouthEast(),$.getSouthWest()];me.forEach((V,K)=>{V.setLatLng(ce[K])});const ue=F.getMidPoints();if(T.forEach((V,K)=>{V.setLatLng(ue[K])}),oe.measureDiv){const{width:V,height:K}=F.getDimensions(),ye=V*K;oe.measureDiv.innerHTML=[hn(V,"m","Largeur"),hn(K,"m","Hauteur"),hn(ye,"m","Surface")].join("<br>")}},U=()=>{q=!1,e.value&&(e.value.off("mousemove",R),document.removeEventListener("mouseup",U),e.value.dragging.enable(),F.updateProperties(),a.value=null,Di(()=>{a.value=F}))};e.value.on("mousemove",R),document.addEventListener("mouseup",U)})},ze=P=>{if(!e.value||!t.value)return;k();const F=P.getLatLngs();let G=null;if(P instanceof Ji){const oe=P.getCenter();G=w(oe,"#059669"),x.push(G),_(G,P,()=>{const me=P.getLength()||0;return hn(me,"m","Longueur totale")}),G.on("mousedown",me=>{if(!e.value)return;Ke.DomEvent.stopPropagation(me),e.value.dragging.disable();let T=!0;const ne=me.latlng,ae=[...P.getLatLngs()];x.forEach((U,H)=>{H>0&&U.setStyle({opacity:0,fillOpacity:0})});const q=U=>{if(!T)return;const H=U.latlng.lng-ne.lng,$=U.latlng.lat-ne.lat,ce=ae.map(ue=>Ke.latLng(ue.lat+$,ue.lng+H));Ke.Polyline.prototype.setLatLngs.call(P,ce),G==null||G.setLatLng(U.latlng)},R=()=>{T=!1,e.value&&(e.value.off("mousemove",q),document.removeEventListener("mouseup",R),e.value.dragging.enable(),k(),ze(P),P instanceof Ji&&(P.updateProperties(),$e(P,"Line")),a.value=P)};e.value.on("mousemove",q),document.addEventListener("mouseup",R)})}F.forEach((oe,me)=>{const T=w(oe,"#DC2626");x.push(T),_(T,P,()=>{let ne=0,ae=0;return P instanceof Ji?(ne=P.getLength()||0,ae=P.getLengthToVertex(me)):(ne=F.reduce((q,R,U)=>U===0?0:q+R.distanceTo(F[U-1]),0),ae=F.slice(0,me+1).reduce((q,R,U)=>U===0?0:q+R.distanceTo(F[U-1]),0)),[hn(ae,"m","Distance depuis le dbut"),hn(ne,"m","Longueur totale")].join("<br>")}),T.on("mousedown",ne=>{if(!e.value)return;Ke.DomEvent.stopPropagation(ne),e.value.dragging.disable();let ae=!0;G&&(G.setStyle({opacity:0,fillOpacity:0}),G.measureDiv&&(G.measureDiv.style.display="none"));const q=[];me>0&&q.push(me-1),me<F.length-1&&q.push(me);const R=q.map($=>F.length+$),U=$=>{ae&&(P instanceof Ji?P.moveVertex(me,$.latlng,!1):(F[me]=$.latlng,P.setLatLngs(F)),T.setLatLng($.latlng),Ae(q,R))},H=()=>{if(ae=!1,!!e.value){if(e.value.off("mousemove",U),document.removeEventListener("mouseup",H),e.value.dragging.enable(),P instanceof Ji&&(P.updateProperties(),$e(P,"Line")),G&&P instanceof Ji){const $=P.getCenter();G.setLatLng($),G.setStyle({opacity:1,fillOpacity:1}),G.measureDiv&&(G.measureDiv.style.display="")}a.value=null,Di(()=>{a.value=P})}};e.value.on("mousemove",U),document.addEventListener("mouseup",H)})});const Q=()=>{const oe=P.getLatLngs(),me=P instanceof Ji?oe.length+1:oe.length;x.slice(me).forEach(ne=>{var ae;ne&&typeof ne.remove=="function"&&((ae=n.value)==null||ae.removeLayer(ne))}),x=x.slice(0,me),(P instanceof Ji?P.getMidPoints():Array.from({length:oe.length-1},(ne,ae)=>{const q=oe[ae],R=oe[ae+1];return Ke.latLng((q.lat+R.lat)/2,(q.lng+R.lng)/2)})).forEach((ne,ae)=>{const q=w(ne,"#2563EB");x.push(q),_(q,P,()=>{let R=0,U=0,H=0;if(P instanceof Ji)R=P.getSegmentLengthAt(ae),U=P.getLength()||0,H=P.getLengthToVertex(ae)+R/2;else{const $=oe[ae],ce=oe[ae+1];R=$.distanceTo(ce),U=oe.reduce((ue,V,K)=>K===0?0:ue+V.distanceTo(oe[K-1]),0),H=oe.slice(0,ae+1).reduce((ue,V,K)=>K===0?0:ue+V.distanceTo(oe[K-1]),0)+R/2}return[hn(R,"m","Longueur du segment"),hn(R/2,"m","Demi-segment"),hn(H,"m","Distance depuis le dbut"),hn(U,"m","Longueur totale")].join("<br>")}),q.on("mousedown",R=>{if(!e.value)return;Ke.DomEvent.stopPropagation(R),e.value.dragging.disable();let U=!0;const H=ae,$=P.getLatLngs(),ce=x.find(K=>K.options&&K.options.color==="#059669");ce&&(ce.setStyle({opacity:0,fillOpacity:0}),ce.measureDiv&&(ce.measureDiv.style.display="none"));const ue=K=>{if(U){if(P instanceof Ji)P.addVertex(H,K.latlng,!1);else{const ye=$.slice();ye.splice(H+1,0,K.latlng),P.setLatLngs(ye)}k(),ze(P),V()}},V=()=>{U=!1,e.value&&(e.value.off("mousemove",ue),document.removeEventListener("mouseup",V),e.value.dragging.enable(),P instanceof Ji&&(P.updateProperties(),$e(P,"Line")),a.value=null,Di(()=>{a.value=P}))};e.value.on("mousemove",ue),document.addEventListener("mouseup",V)})})},Ae=(oe,me)=>{const T=P.getLatLngs();oe.forEach((ne,ae)=>{if(ne<0||ne>=T.length-1)return;const q=me[ae];if(q>=0&&q<x.length){let R;if(P instanceof Ji){const H=P.getMidPointAt(ne);if(!H)return;R=H}else{const H=T[ne],$=T[ne+1];R=Ke.latLng((H.lat+$.lat)/2,(H.lng+$.lng)/2)}const U=x[q];if(U&&U.setLatLng){U.setLatLng(R);const H=U;if(H.measureDiv){let $=0,ce=0,ue=0;if(P instanceof Ji)$=P.getSegmentLengthAt(ne),ce=P.getLength()||0,ue=P.getLengthToVertex(ne)+$/2;else{const V=T[ne],K=T[ne+1];$=V.distanceTo(K),ce=0,ue=0;for(let ye=0;ye<T.length-1;ye++){const ve=T[ye].distanceTo(T[ye+1]);ce+=ve,ye<ne?ue+=ve:ye===ne&&(ue+=ve/2)}}H.measureDiv.innerHTML=[hn($,"m","Longueur du segment"),hn($/2,"m","Demi-segment"),hn(ue,"m","Distance depuis le dbut"),hn(ce,"m","Longueur totale")].join("<br>")}}}})};Q(),P instanceof El&&(P.updateElevationProfile().then(()=>{console.log("[useMapDrawing] ElevationLine properties updated:",{length:P.properties.length,elevationData:P.getElevationData()})}),x.forEach((oe,me)=>{const T=P.getElevationData();T[me]&&(_(oe,P,()=>{const ne=T[me];return[hn(ne.distance,"m","Distance"),hn(ne.elevation,"m","Altitude"),hn(P.properties.elevationGain,"m","Dnivel +"),hn(P.properties.elevationLoss,"m","Dnivel -")].join("<br>")}),oe.on("mousedown",ne=>{if(!e.value)return;Ke.DomEvent.stopPropagation(ne),e.value.dragging.disable();const ae=R=>{P.moveVertex(me,R.latlng,!1),oe.setLatLng(R.latlng)},q=()=>{e.value&&(e.value.off("mousemove",ae),document.removeEventListener("mouseup",q),e.value.dragging.enable(),P instanceof El&&(P.updateElevationProfile(),a.value=null,Di(()=>{a.value=P})))};e.value.on("mousemove",ae),document.addEventListener("mouseup",q)}))}),P.on("elevation:updated",()=>{x.forEach((oe,me)=>{const T=P.getElevationData();if(T[me]&&oe.measureDiv){const ne=T[me];oe.measureDiv.innerHTML=[hn(ne.distance,"m","Distance"),hn(ne.elevation,"m","Altitude"),hn(P.properties.elevationGain,"m","Dnivel +"),hn(P.properties.elevationLoss,"m","Dnivel -")].join("<br>")}})}),e.value&&e.value.pm.setGlobalOptions({preventMarkerRemoval:!0,preventVertexEdit:!0}))},te=P=>{if(!e.value||!t.value)return;k();const F=P.getLatLngs()[0],G=F.map(ae=>[ae.lng,ae.lat]);G.push(G[0]);const Q=Sl([G]),Ae=Eu(Q),oe=F.reduce((ae,q,R)=>{const U=F[(R+1)%F.length];return ae+q.distanceTo(U)},0);let me;if(typeof P.getCenter=="function")try{me=P.getCenter()}catch(ae){console.warn("Erreur lors de la rcupration du centre du polygone via getCenter(), utilisation de la mthode alternative",ae);const q=bc(Q);me=Ke.latLng(q.geometry.coordinates[1],q.geometry.coordinates[0])}else{const ae=bc(Q);me=Ke.latLng(ae.geometry.coordinates[1],ae.geometry.coordinates[0])}const T=w(me,"#059669");x.push(T),_(T,P,()=>[hn(oe,"m","Primtre"),hn(Ae,"m","Surface")].join("<br>")),T.on("mousedown",ae=>{if(!e.value)return;Ke.DomEvent.stopPropagation(ae),e.value.dragging.disable();let q=!0;const R=ae.latlng,U=[...F];x.forEach((ue,V)=>{V>0&&ue.setStyle({opacity:0,fillOpacity:0})});const H=xu(ue=>{if(!q)return;const V=ue.latlng.lng-R.lng,K=ue.latlng.lat-R.lat,ye=U.map(ve=>Ke.latLng(ve.lat+K,ve.lng+V));Ke.Polygon.prototype.setLatLngs.call(P,[ye]),T.setLatLng(ue.latlng)},16),$=ue=>{q&&H(ue)},ce=()=>{if(q=!1,!!e.value){if(e.value.off("mousemove",$),document.removeEventListener("mouseup",ce),e.value.dragging.enable(),P.properties){const ue=P.getLatLngs()[0],V=ue.map(ye=>[ye.lng,ye.lat]);V.push(V[0]);const K=Sl([V]);P.properties.area=Eu(K),P.properties.perimeter=ue.reduce((ye,ve,ee)=>{const Ge=ue[(ee+1)%ue.length];return ye+ve.distanceTo(Ge)},0),P.properties.surfaceInterieure=P.properties.area,P.properties.surfaceExterieure=P.properties.area}k(),te(P),a.value=null,Di(()=>{a.value=P})}};e.value.on("mousemove",$),document.addEventListener("mouseup",ce)}),F.forEach((ae,q)=>{const R=w(ae,"#DC2626");x.push(R),_(R,P,()=>{const U=F[(q-1+F.length)%F.length],H=F[(q+1)%F.length],$=ae.distanceTo(U),ce=ae.distanceTo(H);return[hn($,"m","Distance au point prcdent"),hn(ce,"m","Distance au point suivant"),hn(oe,"m","Primtre total"),hn(Ae,"m","Surface")].join("<br>")}),R.on("mousedown",U=>{if(Ke.DomEvent.stopPropagation(U),!e.value)return;e.value.dragging.disable();let H=!0;T&&(T.setStyle({opacity:0,fillOpacity:0}),T.measureDiv&&(T.measureDiv.style.display="none"));const $=xu(V=>{if(!H)return;F[q]=V.latlng,Ke.Polygon.prototype.setLatLngs.call(P,[F]),R.setLatLng(V.latlng);const K=x.slice(F.length+1),ye=(q-1+F.length)%F.length,ve=K[ye];if(ve){const Ge=F[ye],tt=F[q],Ue=Ke.latLng((Ge.lat+tt.lat)/2,(Ge.lng+tt.lng)/2);ve.setLatLng(Ue)}const ee=K[q];if(ee){const Ge=F[q],tt=F[(q+1)%F.length],Ue=Ke.latLng((Ge.lat+tt.lat)/2,(Ge.lng+tt.lng)/2);ee.setLatLng(Ue)}},16),ce=V=>{H&&$(V)},ue=()=>{if(H=!1,!!e.value){if(e.value.off("mousemove",ce),document.removeEventListener("mouseup",ue),e.value.dragging.enable(),P.properties){const V=P.getLatLngs()[0].map(ye=>[ye.lng,ye.lat]);V.push(V[0]);const K=Sl([V]);P.properties.area=Eu(K),P.properties.perimeter=F.reduce((ye,ve,ee)=>{const Ge=F[(ee+1)%F.length];return ye+ve.distanceTo(Ge)},0),P.properties.surfaceInterieure=P.properties.area,P.properties.surfaceExterieure=P.properties.area}k(),te(P),a.value=null,Di(()=>{a.value=P})}};e.value.on("mousemove",ce),document.addEventListener("mouseup",ue)})}),(()=>{const ae=P.getLatLngs()[0];x.slice(ae.length+1).forEach(R=>{n.value&&n.value.removeLayer(R)}),x=x.slice(0,ae.length+1);const q=new Array(ae.length);for(let R=0;R<ae.length;R++){const U=ae[R],H=ae[(R+1)%ae.length];q[R]=Pe(U,H)}q.forEach((R,U)=>{const H=w(R,"#2563EB");x.push(H),_(H,P,()=>{const $=ae[U],ce=ae[(U+1)%ae.length],ue=$.distanceTo(ce);return[hn(ue,"m","Longueur du segment"),hn(oe,"m","Primtre total"),hn(Ae,"m","Surface")].join("<br>")}),H.on("mousedown",$=>{if(!e.value)return;Ke.DomEvent.stopPropagation($),e.value.dragging.disable();let ce=!0;const ue=U;T&&(T.setStyle({opacity:0,fillOpacity:0}),T.measureDiv&&(T.measureDiv.style.display="none"));const V=[...P.getLatLngs()[0]];V.splice((ue+1)%V.length,0,R),P.setLatLngs([V]),k(),te(P);const K=ue+1,ye=1+K,ve=K<x.length-1?x[ye]:null;if(ve){const ee=tt=>{if(!ce)return;const Ue=P.getLatLngs()[0];Ue[K]=tt.latlng,P.setLatLngs([Ue]),ve.setLatLng(tt.latlng);const nt=x.slice(1+Ue.length),st=(K-1+Ue.length)%Ue.length,Ct=K;if(nt[st]){const xt=Ue[st],Ot=Ue[K],$t=Ke.latLng((xt.lat+Ot.lat)/2,(xt.lng+Ot.lng)/2);nt[st].setLatLng($t)}if(nt[Ct]){const xt=Ue[K],Ot=Ue[(K+1)%Ue.length],$t=Ke.latLng((xt.lat+Ot.lat)/2,(xt.lng+Ot.lng)/2);nt[Ct].setLatLng($t)}},Ge=()=>{if(ce=!1,!!e.value){if(e.value.off("mousemove",ee),document.removeEventListener("mouseup",Ge),e.value.dragging.enable(),P.properties){const tt=P.getLatLngs()[0].map(nt=>[nt.lng,nt.lat]);tt.push(tt[0]);const Ue=Sl([tt]);P.properties.area=Eu(Ue),P.properties.perimeter=P.getLatLngs()[0].reduce((nt,st,Ct,xt)=>{const Ot=xt[(Ct+1)%xt.length];return nt+st.distanceTo(Ot)},0)}k(),te(P),a.value=null,Di(()=>{a.value=P})}};e.value.on("mousemove",ee),document.addEventListener("mouseup",Ge)}else e.value.dragging.enable(),k(),te(P)})})})()},J=P=>{if(!e.value||!t.value)return;k();const F=P.getCenter(),G=P.getStartAngle(),Q=P.getStopAngle(),Ae=P.getOpeningAngle(),oe=P.calculatePointOnArc(G),me=P.calculatePointOnArc(Q),T=w(oe,"#DC2626"),ne=w(me,"#DC2626");x.push(T,ne);const ae=w(F,"#059669");x.push(ae);let q=null;if(Ae>5){const R=P.calculateMidpointPosition();q=w(R,"#2563EB"),x.push(q),q.on("mousedown",U=>{if(!e.value)return;Ke.DomEvent.stopPropagation(U),e.value.dragging.disable();let H=!0;const $=ue=>{if(!H)return;const V=F.distanceTo(ue.latlng);P.setRadius(V);const K=P.calculatePointOnArc(G),ye=P.calculatePointOnArc(Q),ve=P.calculateMidpointPosition();T.setLatLng(K),ne.setLatLng(ye),q==null||q.setLatLng(ve),P.updateProperties(),a.value=P},ce=()=>{H=!1,e.value&&(e.value.off("mousemove",$),document.removeEventListener("mouseup",ce),e.value.dragging.enable(),P.updateProperties(),a.value=null,Di(()=>{a.value=P}),$e(P,"Semicircle"))};e.value.on("mousemove",$),document.addEventListener("mouseup",ce)})}[T,ne].forEach((R,U)=>{R.on("mousedown",H=>{if(!e.value)return;Ke.DomEvent.stopPropagation(H),e.value.dragging.disable();let $=!0;const ce=V=>{if(!$||!e.value)return;const K=V.latlng.lng-F.lng,ye=V.latlng.lat-F.lat;let ve=(Math.atan2(ye,K)*180/Math.PI+360)%360;U===0?P.setAngles(ve,P.getStopAngle()):P.setAngles(P.getStartAngle(),ve);const ee=P.getStartAngle(),Ge=P.getStopAngle(),tt=P.getOpeningAngle(),Ue=P.calculatePointOnArc(ee),nt=P.calculatePointOnArc(Ge);if(T.setLatLng(Ue),ne.setLatLng(nt),q&&tt>5){const st=P.calculateMidpointPosition();q.setLatLng(st),q.setStyle({opacity:1,fillOpacity:1})}else q&&q.setStyle({opacity:0,fillOpacity:0});P.updateProperties(),a.value=P},ue=()=>{$=!1,e.value&&(e.value.off("mousemove",ce),document.removeEventListener("mouseup",ue),e.value.dragging.enable(),P.updateProperties(),a.value=null,Di(()=>{a.value=P}),$e(P,"Semicircle"),J(P))};e.value.on("mousemove",ce),document.addEventListener("mouseup",ue)})}),ae.on("mousedown",R=>{if(!e.value)return;Ke.DomEvent.stopPropagation(R),e.value.dragging.disable();let U=!0;const H=ce=>{if(!U)return;P.setCenter(ce.latlng),ae.setLatLng(ce.latlng);const ue=P.getStartAngle(),V=P.getStopAngle(),K=P.getOpeningAngle(),ye=P.calculatePointOnArc(ue),ve=P.calculatePointOnArc(V);if(T.setLatLng(ye),ne.setLatLng(ve),q&&K>5){const ee=P.calculateMidpointPosition();q.setLatLng(ee),q.setStyle({opacity:1,fillOpacity:1})}else q&&q.setStyle({opacity:0,fillOpacity:0});P.updateProperties(),a.value=P},$=()=>{U=!1,e.value&&(e.value.off("mousemove",H),document.removeEventListener("mouseup",$),e.value.dragging.enable(),P.updateProperties(),a.value=null,Di(()=>{a.value=P}),$e(P,"Semicircle"))};e.value.on("mousemove",H),document.addEventListener("mouseup",$)})},Ee=P=>{var F;if(!(!e.value||!i.value)){if(console.log("[generateTempControlPoints] Gnration des points temporaires pour",{layerType:P.constructor.name,properties:P.properties,isPolygon:P instanceof Bu||P instanceof Ke.Polygon}),i.value.clearLayers(),P instanceof Bo){const G=(F=P.getBounds)==null?void 0:F.call(P).getCenter();if(G){const Q=Ke.circleMarker(G,{radius:0,className:"text-hint-marker",pmIgnore:!0});i.value.addLayer(Q)}return}try{if(P instanceof Bu||P instanceof Ke.Polygon){let G=[];try{if("getLatLngs"in P){const Ae=P.getLatLngs();if(Array.isArray(Ae)&&Ae.length>0){const oe=Ae[0];Array.isArray(oe)?G=oe:oe instanceof Ke.LatLng&&(G=Ae)}}}catch(Ae){console.error("[generateTempControlPoints] Erreur lors de la rcupration des points du polygone:",Ae);return}let Q=null;try{if(P instanceof Bu&&typeof P.getCenter=="function")Q=P.getCenter();else{const Ae=G.map(T=>[T.lng,T.lat]);Ae.push(Ae[0]);const oe=Sl([Ae]),me=bc(oe);Q=Ke.latLng(me.geometry.coordinates[1],me.geometry.coordinates[0])}if(Q&&Q.lat!==void 0&&Q.lng!==void 0){const Ae=w(Q,"#059669");i.value.addLayer(Ae)}}catch(Ae){console.warn("[generateTempControlPoints] Erreur lors du calcul du centre du polygone:",Ae)}G.forEach(Ae=>{if(Ae&&Ae.lat!==void 0&&Ae.lng!==void 0){const oe=w(Ae,"#DC2626");i.value.addLayer(oe)}});for(let Ae=0;Ae<G.length;Ae++){const oe=G[Ae],me=G[(Ae+1)%G.length];if(oe&&me&&oe.lat!==void 0&&oe.lng!==void 0&&me.lat!==void 0&&me.lng!==void 0){const T=Ke.latLng((oe.lat+me.lat)/2,(oe.lng+me.lng)/2),ne=w(T,"#2563EB");i.value.addLayer(ne)}}}else P instanceof rc;console.log("[generateTempControlPoints] Points temporaires gnrs",{count:i.value.getLayers().length})}catch(G){console.error("[generateTempControlPoints] Erreur lors de la gnration des points temporaires:",G)}}},he=P=>{if(!e.value||!t.value||!P.getBounds)return;const F=P;k(),F.on("edit:start",()=>{k()}),F.on("edit:end",()=>{he(F)});const G=F.getBounds(),Q=G.getCenter(),Ae=F.properties.rotation||0,oe=U=>{if(Ae===0)return U;const H=Ae*Math.PI/180,$=Math.cos(H),ce=Math.sin(H),ue=U.lng-Q.lng,V=U.lat-Q.lat,K=ue*$-V*ce,ye=ue*ce+V*$;return Ke.latLng(Q.lat+ye,Q.lng+K)},me=[G.getNorthWest(),G.getNorthEast(),G.getSouthEast(),G.getSouthWest()].map(U=>oe(U)),T=F.getMidPoints().map(U=>oe(U)),ne=w(Q,"#059669");ne.addTo(e.value),x.push(ne),_(ne,F,()=>{const{width:U,height:H}=F.getDimensions(),$=U*H;return[hn(U,"m","Largeur"),hn(H,"m","Hauteur"),hn($,"m","Surface"),`Rotation: ${Ae.toFixed(1)}`].join("<br>")});const ae=me.map((U,H)=>{const $=w(U,"#DC2626");return $.addTo(e.value),x.push($),_($,F,()=>{const{width:ce,height:ue}=F.getDimensions();return[hn(ce,"m","Largeur"),hn(ue,"m","Hauteur")].join("<br>")}),$.on("mousedown",ce=>{if(!e.value)return;Ke.DomEvent.stopPropagation(ce),e.value.dragging.disable();const ue=(H+2)%4,V=me[ue];F.startResize();const K=xu(ee=>{const Ge=Ke.latLngBounds(V,ee.latlng);F.updateResizePreview(Ge)},16),ye=ee=>K(ee),ve=()=>{if(!e.value)return;e.value.off("mousemove",ye),document.removeEventListener("mouseup",ve),e.value.dragging.enable();const ee=Ke.latLngBounds(V,$.getLatLng());F.endResize(ee),a.value=null,Di(()=>{a.value=F})};e.value.on("mousemove",ye),document.addEventListener("mouseup",ve)}),$}),q=T.map((U,H)=>{const $=w(U,"#2563EB");return $.addTo(e.value),x.push($),_($,F,()=>{const{width:ce,height:ue}=F.getDimensions(),V=H%2===0?ce:ue;return[hn(V,"m","Longueur du ct"),hn(V/2,"m","Distance au coin"),`Rotation: ${Ae.toFixed(1)}`].join("<br>")}),$.on("mousedown",ce=>{if(!e.value)return;Ke.DomEvent.stopPropagation(ce),e.value.dragging.disable(),F.startResize();const ue=xu(ye=>{const ve=F.getBounds();let ee;switch(H){case 0:ee=Ke.latLngBounds(Ke.latLng(ye.latlng.lat,ve.getWest()),Ke.latLng(ve.getSouth(),ve.getEast()));break;case 1:ee=Ke.latLngBounds(Ke.latLng(ve.getNorth(),ve.getWest()),Ke.latLng(ve.getSouth(),ye.latlng.lng));break;case 2:ee=Ke.latLngBounds(Ke.latLng(ve.getNorth(),ve.getWest()),Ke.latLng(ye.latlng.lat,ve.getEast()));break;case 3:ee=Ke.latLngBounds(Ke.latLng(ve.getNorth(),ye.latlng.lng),Ke.latLng(ve.getSouth(),ve.getEast()));break;default:return}F.updateResizePreview(ee)},16),V=ye=>ue(ye),K=()=>{if(!e.value)return;e.value.off("mousemove",V),document.removeEventListener("mouseup",K),e.value.dragging.enable();const ye=F.getBounds();let ve;switch(H){case 0:ve=Ke.latLngBounds(Ke.latLng($.getLatLng().lat,ye.getWest()),Ke.latLng(ye.getSouth(),ye.getEast()));break;case 1:ve=Ke.latLngBounds(Ke.latLng(ye.getNorth(),ye.getWest()),Ke.latLng(ye.getSouth(),$.getLatLng().lng));break;case 2:ve=Ke.latLngBounds(Ke.latLng(ye.getNorth(),ye.getWest()),Ke.latLng($.getLatLng().lat,ye.getEast()));break;case 3:ve=Ke.latLngBounds(Ke.latLng(ye.getNorth(),$.getLatLng().lng),Ke.latLng(ye.getSouth(),ye.getEast()));break;default:return}F.endResize(ve),a.value=null,Di(()=>{a.value=F})};e.value.on("mousemove",V),document.addEventListener("mouseup",K)}),$});ne.on("mousedown",U=>{if(!e.value)return;Ke.DomEvent.stopPropagation(U),e.value.dragging.disable();const H=F.getBounds().getCenter(),$=U.latlng;F.startResize();const ce=xu(K=>{const ye=K.latlng.lng-$.lng,ve=K.latlng.lat-$.lat,ee=Ke.latLng(H.lat+ve,H.lng+ye),Ge=F.getBounds(),tt=Ge.getEast()-Ge.getWest(),Ue=Ge.getNorth()-Ge.getSouth(),nt=Ke.latLngBounds(Ke.latLng(ee.lat-Ue/2,ee.lng-tt/2),Ke.latLng(ee.lat+Ue/2,ee.lng+tt/2));F.updateResizePreview(nt)},16),ue=K=>ce(K),V=()=>{if(!e.value)return;e.value.off("mousemove",ue),document.removeEventListener("mouseup",V),e.value.dragging.enable();const K=F.getBounds(),ye=K.getEast()-K.getWest(),ve=K.getNorth()-K.getSouth(),ee=ne.getLatLng(),Ge=Ke.latLngBounds(Ke.latLng(ee.lat-ve/2,ee.lng-ye/2),Ke.latLng(ee.lat+ve/2,ee.lng+ye/2));F.endResize(Ge),a.value=null,Di(()=>{a.value=F})};e.value.on("mousemove",ue),document.addEventListener("mouseup",V)}),F.on("resize:update",U=>{const H=U.bounds,$=H.getCenter(),ce=[H.getNorthWest(),H.getNorthEast(),H.getSouthEast(),H.getSouthWest()].map(V=>oe(V));ae.forEach((V,K)=>{V.setLatLng(ce[K])}),ne.setLatLng($);const ue=[Ke.latLng((ce[0].lat+ce[1].lat)/2,(ce[0].lng+ce[1].lng)/2),Ke.latLng((ce[1].lat+ce[2].lat)/2,(ce[1].lng+ce[2].lng)/2),Ke.latLng((ce[2].lat+ce[3].lat)/2,(ce[2].lng+ce[3].lng)/2),Ke.latLng((ce[3].lat+ce[0].lat)/2,(ce[3].lng+ce[0].lng)/2)].map(V=>oe(V));q.forEach((V,K)=>{V.setLatLng(ue[K])})});const R=()=>{F.off("edit:start"),F.off("edit:end"),F.off("resize:update")};x.cleanup=R};return{map:e,featureGroup:t,controlPointsGroup:n,tempControlPointsGroup:i,currentTool:o,selectedShape:a,isDrawing:u,initMap:W,setDrawingTool:Z,updateShapeStyle:se,updateShapeProperties:Se,updateTextFixedSize:z,adjustView:O,clearActiveControlPoints:k}}function RL(){const e=Dt(null),t=Dt(""),n=Dt("Ville"),i=Dt(null),o={Ville:Zi.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:" OpenStreetMap contributors",maxZoom:19,updateWhenZooming:!1,updateWhenIdle:!0,noWrap:!0,keepBuffer:5}),Satellite:Zi.tileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",{attribution:" Esri",maxZoom:19,updateWhenZooming:!1,updateWhenIdle:!0,noWrap:!0,keepBuffer:5}),Cadastre:Zi.tileLayer("https://data.geopf.fr/wmts?SERVICE=WMTS&REQUEST=GetTile&VERSION=1.0.0&LAYER=CADASTRALPARCELS.PARCELLAIRE_EXPRESS&STYLE=normal&FORMAT=image/png&TILEMATRIXSET=PM&TILEMATRIX={z}&TILEROW={y}&TILECOL={x}",{attribution:"Cadastre - Carte  IGN/Geoportail",maxZoom:19,updateWhenZooming:!1,updateWhenIdle:!0,noWrap:!0,keepBuffer:5})};return{map:e,searchQuery:t,currentBaseMap:n,baseMaps:o,initMap:f=>{e.value=f,f.options.zoomSnap=.5,f.options.wheelPxPerZoomLevel=120,i.value=o[n.value],i.value.addTo(f),f.on("baselayerchange",v=>{n.value=v.name,i.value=v.layer,v.name==="Cadastre"?e.value.options.zoomAnimation=!1:e.value.options.zoomAnimation=!0,setTimeout(()=>{e.value&&e.value.invalidateSize(!0)},100)})},searchLocation:async()=>{if(!(!e.value||!t.value))try{const v=await(await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(t.value)}`)).json();if(v&&v.length>0){const{lat:_,lon:x}=v[0],k=n.value!=="Cadastre";e.value.setView([_,x],13,{animate:k})}}catch(f){console.error("Erreur lors de la recherche de localisation:",f)}},changeBaseMap:f=>{if(!(!e.value||!o[f]))try{if(n.value===f)return;i.value&&e.value.hasLayer(i.value)&&e.value.removeLayer(i.value),setTimeout(()=>{if(!e.value)return;e.value.options.zoomAnimation=f!=="Cadastre",i.value=o[f],i.value.addTo(e.value),n.value=f,e.value.invalidateSize(!0);const v=e.value.getZoom();e.value.setView(e.value.getCenter(),v,{animate:!1})},50)}catch(v){console.error("Erreur lors du changement de carte de base:",v)}}}}const cp=id("irrigation",{state:()=>({plans:[],currentPlan:null,loading:!1,error:null,autoSaveInterval:null,unsavedChanges:!1,planHistory:[]}),getters:{getPlanById:e=>t=>e.plans.find(n=>n.id===t),hasUnsavedChanges:e=>e.unsavedChanges,getCurrentPlanHistory:e=>e.planHistory},actions:{async fetchPlans(){var t,n;const e=ds();this.loading=!0;try{let i="/plans/";const o={};e.isConcessionnaire?o.concessionnaire=(t=e.user)==null?void 0:t.id:e.isAgriculteur&&(o.agriculteur=(n=e.user)==null?void 0:n.id);const a=await fn.get(i,{params:o});this.plans=a.data}catch(i){throw this.error="Erreur lors du chargement des plans",i}finally{this.loading=!1}},async fetchPlansWithDetails(){var t,n;const e=ds();this.loading=!0;try{let i="/plans/";const o={include_details:!0};e.isConcessionnaire?o.concessionnaire=(t=e.user)==null?void 0:t.id:e.isAgriculteur&&(o.agriculteur=(n=e.user)==null?void 0:n.id),console.log("[IrrigationStore] Fetching plans with params:",o);const a=await fn.get(i,{params:o});console.log("[IrrigationStore] Plans received (raw):",JSON.stringify(a.data,null,2)),a.data.forEach((d,f)=>{console.log(`
[IrrigationStore] Plan ${f+1} (ID: ${d.id||"N/A"}) types:`,{usine:typeof d.usine,concessionnaire:typeof d.concessionnaire,agriculteur:typeof d.agriculteur,usineValue:d.usine,concessionnaireValue:d.concessionnaire,agriculteurValue:d.agriculteur})});const u=a.data.map(d=>{const f={...d,usine:typeof d.usine=="object"?d.usine:null,concessionnaire:typeof d.concessionnaire=="object"?d.concessionnaire:null,agriculteur:typeof d.agriculteur=="object"?d.agriculteur:null};return console.log(`[IrrigationStore] Plan ${d.id} trait:`,{usine:f.usine,concessionnaire:f.concessionnaire,agriculteur:f.agriculteur}),f});return this.plans=u,{data:u}}catch(i){throw console.error("[IrrigationStore] Error fetching plans:",i),this.error="Erreur lors du chargement des plans",i}finally{this.loading=!1}},async fetchClientPlans(e){this.loading=!0;try{return(await nh.getAgriculteurPlans(e)).data}catch(t){throw this.error="Erreur lors du chargement des plans du client",t}finally{this.loading=!1}},async createPlan(e){var n;this.clearCurrentPlan(),this.loading=!0;const t=_c();try{const i=ds();((n=i.user)==null?void 0:n.user_type)==="agriculteur"&&(e={...e,agriculteur:i.user.id,concessionnaire:i.user.concessionnaire,usine:i.user.usine});const o=await nh.createPlan(e);return this.plans.push(o.data),t.success(`Le plan "${o.data.nom}" a t cr avec succs`),o.data}catch(i){const o=i instanceof Error?i.message:String(i);throw console.error("Error creating plan:",o),this.error=o,t.error(`Erreur lors de la cration du plan : ${o}`),i}finally{this.loading=!1}},async createPlanForClient(e,t){this.clearCurrentPlan(),this.loading=!0;try{const n={...e,agriculteur:t},i=await nh.createPlanForAgriculteur(n);return this.plans.push(i.data),i.data}catch(n){const i=n instanceof Error?n.message:String(n);throw console.error("Error creating plan for client:",i),this.error="Erreur lors de la cration du plan pour le client",n}finally{this.loading=!1}},startAutoSave(){this.autoSaveInterval||(this.autoSaveInterval=setInterval(async()=>{this.unsavedChanges&&this.currentPlan&&await this.savePlan(this.currentPlan.id)},3e4))},stopAutoSave(){this.autoSaveInterval&&(clearInterval(this.autoSaveInterval),this.autoSaveInterval=null)},async savePlan(e){var t,n,i;if(!this.unsavedChanges){console.log("[IrrigationStore][savePlan] Aucun changement  sauvegarder");return}console.log("[IrrigationStore][savePlan] Dbut de la sauvegarde",{planId:e,currentPlan:(t=this.currentPlan)==null?void 0:t.id,hasUnsavedChanges:this.unsavedChanges}),this.loading=!0;try{const o=await fn.patch(`/plans/${e}/`,{...this.currentPlan,version:((n=this.currentPlan)==null?void 0:n.version)||1});console.log("[IrrigationStore][savePlan] Rponse reue",{status:o.status,data:o.data});const a=this.plans.findIndex(u=>u.id===e);return a!==-1&&(console.log("[IrrigationStore][savePlan] Mise  jour du plan dans la liste",{index:a,oldPlan:this.plans[a],newPlan:o.data}),this.plans[a]=o.data),((i=this.currentPlan)==null?void 0:i.id)===e&&(console.log("[IrrigationStore][savePlan] Mise  jour du plan courant"),this.currentPlan=o.data),this.unsavedChanges=!1,o.data}catch(o){if(console.error("[IrrigationStore][savePlan] ERREUR:",o),console.error("[IrrigationStore][savePlan] Stack trace:",o instanceof Error?o.stack:"No stack trace"),o&&typeof o=="object"&&"response"in o){const a=o;console.error("[IrrigationStore][savePlan] Rponse d'erreur:",{status:a.response.status,statusText:a.response.statusText,data:a.response.data})}throw this.error="Erreur lors de la sauvegarde du plan",o}finally{this.loading=!1}},async updatePlanDetails(e,t){var d;console.log("Mise  jour du plan avec les donnes:",t);const{agriculteur_id:n,concessionnaire_id:i,usine_id:o,...a}=t,u=_c();try{const f=ds(),v={...a};if(((d=f.user)==null?void 0:d.user_type)==="usine"){if(!i&&!t.concessionnaire)throw new Error("La slection d'un concessionnaire est obligatoire");if(!n&&!t.agriculteur)throw new Error("La slection d'un agriculteur est obligatoire")}n!==void 0&&(v.agriculteur_id=n),i!==void 0&&(v.concessionnaire_id=i),o!==void 0&&(v.usine_id=o);const _=await fn.patch(`/plans/${e}/`,v);this.currentPlan&&this.currentPlan.id===e&&(this.currentPlan={...this.currentPlan,..._.data});const x=this.plans.findIndex(k=>k.id===e);return x!==-1&&(this.plans[x]={...this.plans[x],..._.data}),_.data}catch(f){throw console.error("Erreur lors de la mise  jour du plan:",f),u.error(`Erreur lors de la mise  jour du plan : ${f instanceof Error?f.message:String(f)}`),f}},async fetchPlanHistory(e){this.loading=!0;try{const t=await fn.get(`/plans/${e}/historique/`);return this.planHistory=t.data,t.data}catch(t){throw this.error="Erreur lors de la rcupration de l'historique",t}finally{this.loading=!1}},async restorePlanVersion(e,t){var n;this.loading=!0;try{const i=await fn.post(`/plans/${e}/restaurer/`,{version_id:t});((n=this.currentPlan)==null?void 0:n.id)===e&&(this.currentPlan=i.data);const o=this.plans.findIndex(a=>a.id===e);return o!==-1&&(this.plans[o]=i.data),i.data}catch(i){throw this.error="Erreur lors de la restauration de la version",i}finally{this.loading=!1}},setCurrentPlan(e){this.currentPlan=e,this.startAutoSave()},clearCurrentPlan(){this.currentPlan=null,this.unsavedChanges=!1,this.autoSaveInterval&&(clearInterval(this.autoSaveInterval),this.autoSaveInterval=null)},markUnsavedChanges(){this.unsavedChanges=!0},async deletePlan(e){var n;this.loading=!0;const t=_c();try{const i=this.plans.find(o=>o.id===e);await nh.deletePlan(e),this.plans=this.plans.filter(o=>o.id!==e),((n=this.currentPlan)==null?void 0:n.id)===e&&this.clearCurrentPlan(),t.success(`Le plan "${(i==null?void 0:i.nom)||""}" a t supprim avec succs`)}catch(i){throw this.error="Erreur lors de la suppression du plan",t.error(`Erreur lors de la suppression du plan : ${i instanceof Error?i.message:String(i)}`),i}finally{this.loading=!1}}}});function _h(e){return"content"in e&&"bounds"in e}function OL(e){return e&&Array.isArray(e.points)&&e.points.length>0&&Array.isArray(e.points[0])&&e.points[0].length===2}function IL(e){return e&&Array.isArray(e.points)&&e.points.length>0&&Array.isArray(e.points[0])&&e.points[0].length===2}function FL(e){return e&&Array.isArray(e.points)&&e.points.length>0&&Array.isArray(e.points[0])&&e.points[0].length===2}function sg(e){var i,o,a,u,d,f,v,_,x,k,w,N,z,W;console.log("[DrawingStore] Conversion de la forme en lment",{type:(i=e.properties)==null?void 0:i.type,properties:e.properties,bounds:(o=e.getBounds)==null?void 0:o.call(e),shape:e});let t,n;if(e instanceof Bo||((a=e.properties)==null?void 0:a.type)==="TextRectangle"){t="TEXTE";const O=e.getBounds();return n={bounds:{southWest:[O.getSouthWest().lng,O.getSouthWest().lat],northEast:[O.getNorthEast().lng,O.getNorthEast().lat]},content:e.properties.text||"",style:{...e.properties.style,textStyle:{color:((u=e.properties.style.textStyle)==null?void 0:u.color)||"#000000",fontSize:((d=e.properties.style.textStyle)==null?void 0:d.fontSize)||"14px",fontFamily:((f=e.properties.style.textStyle)==null?void 0:f.fontFamily)||"Arial, sans-serif",textAlign:((v=e.properties.style.textStyle)==null?void 0:v.textAlign)||"center",backgroundColor:((_=e.properties.style.textStyle)==null?void 0:_.backgroundColor)||"#FFFFFF",backgroundOpacity:((x=e.properties.style.textStyle)==null?void 0:x.backgroundOpacity)??1,bold:((k=e.properties.style.textStyle)==null?void 0:k.bold)||!1,italic:((w=e.properties.style.textStyle)==null?void 0:w.italic)||!1}},rotation:e.properties.rotation||0},console.log("[DrawingStore] TextRectangle converti",{type_forme:t,data:n,originalProperties:e.properties}),{type_forme:t,data:n}}switch((N=e.properties)==null?void 0:N.type){case"Polygon":t="POLYGON",n={points:e.getLatLngs()[0].map(Ne=>[Ne.lng,Ne.lat]),style:{color:e.properties.style.color||"#3388ff",weight:e.properties.style.weight||3,opacity:e.properties.style.opacity||1,fillColor:e.properties.style.fillColor||"#3388ff",fillOpacity:e.properties.style.fillOpacity||.2,dashArray:e.properties.style.dashArray||""}};break;case"Semicircle":t="DEMI_CERCLE";const Z=e.getCenter?e.getCenter():e.getLatLng();n={center:[Z.lng,Z.lat],radius:e.getRadius(),startAngle:e.properties.startAngle||0,endAngle:e.properties.stopAngle||180,style:{color:e.properties.style.color||"#3388ff",weight:e.properties.style.weight||3,opacity:e.properties.style.opacity||1,fillColor:e.properties.style.fillColor||"#3388ff",fillOpacity:e.properties.style.fillOpacity||.2,dashArray:e.properties.style.dashArray||""}};break;case"ElevationLine":t="ELEVATIONLINE",n={points:e.getLatLngs().map(Ne=>[Ne.lng,Ne.lat]),style:{color:e.properties.style.color||"#FF4500",weight:e.properties.style.weight||4,opacity:e.properties.style.opacity||.8},elevationData:e.getElevationData(),samplePointStyle:e.properties.samplePointStyle,minMaxPointStyle:e.properties.minMaxPointStyle};break;case"Rectangle":t="RECTANGLE",n={bounds:{southWest:[e.getBounds().getSouthWest().lng,e.getBounds().getSouthWest().lat],northEast:[e.getBounds().getNorthEast().lng,e.getBounds().getNorthEast().lat]},style:((z=e.properties)==null?void 0:z.style)||{}};break;case"Line":t="LIGNE",n={points:e.getLatLngs().map(Ne=>[Ne.lng,Ne.lat]),style:e.properties.style||{}};break;default:console.warn("[DrawingStore] Type de forme non gr:",(W=e.properties)==null?void 0:W.type),t="UNKNOWN",n={}}return console.log("[DrawingStore] lment converti",{type_forme:t,data:n}),{type_forme:t,data:n}}function jL(e){var t,n,i,o,a,u,d,f,v,_,x,k,w,N,z,W,O,Z,se,Se,Ne,$e;switch(console.log("[DrawingStore] Conversion de l'lment stock en forme",{element:e}),e.type_forme){case"TEXTE":{if(!_h(e.data))return console.error("[DrawingStore] Donnes invalides pour TextRectangle"),null;const Pe=e.data;if(!Pe.bounds)return console.error("[DrawingStore] Donnes de bounds manquantes pour TextRectangle"),null;const xe=new Ke.LatLngBounds(Ke.latLng(Pe.bounds.southWest[1],Pe.bounds.southWest[0]),Ke.latLng(Pe.bounds.northEast[1],Pe.bounds.northEast[0])),Be={color:((t=Pe.style)==null?void 0:t.color)||"#3388ff",fillColor:((n=Pe.style)==null?void 0:n.fillColor)||"#3388ff",fillOpacity:((i=Pe.style)==null?void 0:i.fillOpacity)||.2,weight:((o=Pe.style)==null?void 0:o.weight)||3,opacity:((a=Pe.style)==null?void 0:a.opacity)||1,textStyle:{color:((u=Pe.style.textStyle)==null?void 0:u.color)||"#000000",fontSize:((d=Pe.style.textStyle)==null?void 0:d.fontSize)||"14px",fontFamily:((f=Pe.style.textStyle)==null?void 0:f.fontFamily)||"Arial, sans-serif",textAlign:((v=Pe.style.textStyle)==null?void 0:v.textAlign)||"center",backgroundColor:((_=Pe.style.textStyle)==null?void 0:_.backgroundColor)||"#FFFFFF",backgroundOpacity:((x=Pe.style.textStyle)==null?void 0:x.backgroundOpacity)??1,bold:((k=Pe.style.textStyle)==null?void 0:k.bold)||!1,italic:((w=Pe.style.textStyle)==null?void 0:w.italic)||!1}},ze=new Bo(xe,Pe.content||"Double-cliquez pour diter",Be);return Pe.rotation&&ze.setRotation(Pe.rotation),ze}case"POLYGON":{const Pe=e.data;if(!OL(Pe))return console.error("[DrawingStore] Donnes invalides pour Polygon"),null;const xe=Pe.points.map(ze=>Ke.latLng(ze[1],ze[0])),Be=new Bu([xe],{color:((N=Pe.style)==null?void 0:N.color)||"#3388ff",weight:((z=Pe.style)==null?void 0:z.weight)||3,opacity:((W=Pe.style)==null?void 0:W.opacity)||1,fillColor:((O=Pe.style)==null?void 0:O.fillColor)||"#3388ff",fillOpacity:((Z=Pe.style)==null?void 0:Z.fillOpacity)||.2,dashArray:((se=Pe.style)==null?void 0:se.dashArray)||""});return Be.updateProperties(),Be}case"ELEVATIONLINE":{const Pe=e.data;if(!IL(Pe))return console.error("[DrawingStore] Donnes invalides pour ElevationLine"),null;const xe=Pe.points.map(ze=>Ke.latLng(ze[1],ze[0])),Be=new El(xe,{color:((Se=Pe.style)==null?void 0:Se.color)||"#FF4500",weight:((Ne=Pe.style)==null?void 0:Ne.weight)||4,opacity:(($e=Pe.style)==null?void 0:$e.opacity)||.8});return Pe.samplePointStyle&&Be.setSamplePointStyle(Pe.samplePointStyle),Pe.minMaxPointStyle&&Be.setMinMaxPointStyle(Pe.minMaxPointStyle),Be.updateElevationProfile(),Be}case"LIGNE":{const Pe=e.data;if(!FL(Pe))return console.error("[DrawingStore] Donnes invalides pour Ligne"),null;const xe=Pe.points.map(ze=>Ke.latLng(ze[1],ze[0])),Be=new Ji(xe,Pe.style);return Be.updateProperties(),Be}case"DEMI_CERCLE":{const Pe=e.data;if(!Pe.center||!Pe.radius)return console.error("[DrawingStore] Donnes invalides pour Semicircle"),null;const xe=new nl(Ke.latLng(Pe.center[1],Pe.center[0]),Pe.radius,Pe.startAngle,Pe.endAngle,Pe.style);xe.properties={type:"Semicircle",radius:Pe.radius,startAngle:Pe.startAngle,stopAngle:Pe.endAngle,style:Pe.style};const Be=Math.PI*Math.pow(Pe.radius,2)*((Pe.endAngle-Pe.startAngle)/360),ze=2*Pe.radius+Math.PI*Pe.radius*((Pe.endAngle-Pe.startAngle)/180),te=Math.PI*Pe.radius*((Pe.endAngle-Pe.startAngle)/180);return xe.properties.area=Be,xe.properties.perimeter=ze,xe.properties.arcLength=te,xe.properties.openingAngle=Pe.endAngle-Pe.startAngle,xe}default:return console.warn("[DrawingStore] Type non gr pour la restauration:",e.type_forme),null}}const U1=id("drawing",{state:()=>({currentPlanId:null,elements:[],selectedElement:null,unsavedChanges:!1,loading:!1,error:null,currentTool:"",currentStyle:{strokeStyle:"solid",strokeWidth:2,strokeColor:"#2563EB",fillColor:"#3B82F6",fillOpacity:.2},lastUsedType:null}),getters:{hasUnsavedChanges:e=>e.unsavedChanges,getCurrentElements:e=>e.elements,getSelectedElement:e=>e.selectedElement,getCurrentTool:e=>e.currentTool,getCurrentStyle:e=>e.currentStyle,getLastUsedType:e=>e.lastUsedType},actions:{setCurrentPlan(e){window.dispatchEvent(new CustomEvent("clearControlPoints")),this.currentPlanId=e,e===null&&this.clearElements(),this.selectedElement=null,this.unsavedChanges=!1,this.currentTool="",this.lastUsedType=null,this.currentStyle={strokeStyle:"solid",strokeWidth:2,strokeColor:"#2563EB",fillColor:"#3B82F6",fillOpacity:.2}},clearCurrentPlan(){this.currentPlanId=null,this.elements=[],this.selectedElement=null,this.unsavedChanges=!1,this.loading=!1,this.error=null},clearElements(){this.elements=[],this.selectedElement=null,this.unsavedChanges=!1,this.error=null},addElement(e){var t;if(console.log("[DrawingStore] Ajout d'un lment",{element:e,isLeafletLayer:e instanceof Ke.Layer,hasProperties:!!e.properties,properties:e.properties,type:(t=e.properties)==null?void 0:t.type}),e instanceof Ke.Layer&&e.properties){const n=sg(e);console.log("[DrawingStore] lment converti avant ajout",{original:e,converted:n,type:n.type_forme,data:n.data}),this.elements.push(n)}else!e.type_forme&&this.lastUsedType&&(e.type_forme=this.lastUsedType),this.elements.push(e);this.unsavedChanges=!0,console.log("[DrawingStore] tat aprs ajout",{elements:this.elements,unsavedChanges:this.unsavedChanges})},updateElement(e){const t=this.elements.findIndex(n=>n.id===e.id);if(t!==-1){const n=this.elements[t].type_forme;this.elements[t]={...e,type_forme:n},this.unsavedChanges=!0}},removeElement(e){const t=this.elements.findIndex(n=>n.id===e);t!==-1&&(this.elements.splice(t,1),this.unsavedChanges=!0)},selectElement(e){this.selectedElement=e},setCurrentTool(e){this.currentTool=e,["CERCLE","RECTANGLE","DEMI_CERCLE","LIGNE","TEXTE"].includes(e)&&(this.lastUsedType=e)},setCurrentStyle(e){this.currentStyle={...this.currentStyle,...e}},async loadPlanElements(e){this.loading=!0;try{console.log("[DrawingStore] Dbut du chargement du plan",{planId:e});const n=(await fn.get(`/plans/${e}/`)).data;return console.log("[DrawingStore] Donnes du plan reues",{formes:n.formes,preferences:n.preferences}),this.elements=n.formes.map(i=>{if(console.log("[DrawingStore] Traitement de la forme stocke",{id:i.id,type_forme:i.type_forme,data:i.data,isTextRectangle:i.type_forme==="TEXTE"||i.data&&_h(i.data)}),i.type_forme)return console.log("[DrawingStore] Forme dj au format lment",{type_forme:i.type_forme,data:i.data}),{id:i.id,type_forme:i.type_forme,data:i.data||{}};try{const o=jL(i);if(o)return console.log("[DrawingStore] Forme convertie avec succs",{originalType:i.type_forme,convertedType:o.type,properties:o.properties}),sg(o)}catch(o){console.error("[DrawingStore] Erreur lors de la conversion de la forme",{error:o,forme:i})}return console.warn("[DrawingStore] Utilisation de la forme sans conversion",{type_forme:i.type_forme,data:i.data}),i}),console.log(`[DrawingStore] Plan ${e} - Charg ${this.elements.length} lments`,{elements:this.elements.map(i=>({id:i.id,type_forme:i.type_forme,isTextRectangle:i.type_forme==="TEXTE"||_h(i.data)}))}),this.currentPlanId=e,this.unsavedChanges=!1,n.preferences&&(console.log("[DrawingStore] Chargement des prfrences",n.preferences),n.preferences.currentTool&&this.setCurrentTool(n.preferences.currentTool),n.preferences.currentStyle&&(this.currentStyle={...this.currentStyle,...n.preferences.currentStyle}),n.preferences.lastUsedType&&(this.lastUsedType=n.preferences.lastUsedType)),this.elements}catch(t){throw console.error("[DrawingStore] Erreur lors du chargement des lments:",t),this.error="Erreur lors du chargement des lments du plan",t}finally{this.loading=!1}},async saveToPlan(e,t){var n;this.loading=!0;try{const i=e||this.currentPlanId;if(console.log("[DrawingStore][saveToPlan] Dbut de la sauvegarde",{targetPlanId:i,currentPlanId:this.currentPlanId,elementsCount:this.elements.length,elementsToDelete:t==null?void 0:t.elementsToDelete}),!i)throw new Error("Aucun plan slectionn pour la sauvegarde");console.log("[DrawingStore][saveToPlan] tat des lments avant sauvegarde:",{elements:this.elements.map(f=>({id:f.id,type_forme:f.type_forme,data:{hasPoints:"points"in f.data,points:"points"in f.data?f.data.points:null,hasBounds:"bounds"in f.data,bounds:"bounds"in f.data?f.data.bounds:null,hasContent:"content"in f.data,content:"content"in f.data?f.data.content:null,style:f.data.style}}))});const o=this.elements.map(f=>(console.log("[DrawingStore][saveToPlan] Prparation lment pour sauvegarde",{id:f.id,type_forme:f.type_forme,isTextRectangle:f.type_forme==="TEXTE"||_h(f.data),dataType:f.data?Object.keys(f.data):null,dataContent:f.data}),{...f,type_forme:f.type_forme||this.lastUsedType})),a=(t==null?void 0:t.elementsToDelete)||[],u=`/plans/${i}/save_with_elements/`;console.log("[DrawingStore][saveToPlan] Prparation requte API",{url:u,method:"POST",formesCount:o.length,elementsToDeleteCount:a.length});const d=await fn.post(u,{formes:o,connexions:[],annotations:[],elementsToDelete:a,preferences:{currentTool:this.currentTool,currentStyle:this.currentStyle,lastUsedType:this.lastUsedType}});return console.log("[DrawingStore][saveToPlan] Rponse reue",{status:d.status,formesCount:(n=d.data.formes)==null?void 0:n.length,data:d.data}),this.elements=d.data.formes.map(f=>(console.log("[DrawingStore][saveToPlan] Mise  jour lment aprs sauvegarde",{forme:f,type_forme:f.type_forme}),{...f,type_forme:f.type_forme})),this.unsavedChanges=!1,d.data}catch(i){throw console.error("[DrawingStore][saveToPlan] ERREUR:",i),console.error("[DrawingStore][saveToPlan] Stack trace:",i instanceof Error?i.stack:"No stack trace"),i.response&&console.error("[DrawingStore][saveToPlan] Rponse d'erreur:",{status:i.response.status,statusText:i.response.statusText,data:i.response.data}),this.error="Erreur lors de la sauvegarde du plan",i}finally{this.loading=!1}}}}),zL={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[4000]"},UL={class:"bg-white rounded-lg p-6 max-w-2xl w-full mx-4"},$L={key:0,class:"mb-4"},qL={key:0,class:"animate-pulse"},VL=["value"],GL={key:1,class:"mb-4"},HL={key:0,class:"animate-pulse"},WL=["disabled"],ZL={value:null},KL=["value"],YL={key:2,class:"mb-4"},JL={key:0,class:"animate-pulse"},XL=["disabled"],QL={value:null},eC=["value"],tC={class:"mb-4"},nC={class:"mb-6"},iC={class:"flex justify-end space-x-3"},rC=["disabled"],sC={key:0},oC={key:1},$1=Hs({__name:"NewPlanModal",props:{modelValue:{type:Boolean}},emits:["update:modelValue","created","concessionnaireSelected","clientSelected"],setup(e,{expose:t,emit:n}){const i=e,o=n,a=ds(),u=cp(),d=U1(),f=Dt(!1),v=Dt(null),_=Dt([]),x=Dt([]),k=Dt([]),w=Dt(null),N=Dt(null),z=Dt(!1),W=Dt(!1),O=Dt(!1),Z=Dt({nom:"",description:"",usine:null,concessionnaire:null,client:null}),se=jn(()=>{var te,J,Ee;return((te=a.user)==null?void 0:te.user_type)==="admin"?Z.value.nom.trim()&&Z.value.usine&&Z.value.concessionnaire&&Z.value.client:((J=a.user)==null?void 0:J.user_type)==="usine"?Z.value.nom.trim()&&Z.value.concessionnaire&&Z.value.client:((Ee=a.user)==null?void 0:Ee.user_type)==="concessionnaire"?Z.value.nom.trim()&&Z.value.client:Z.value.nom.trim()});Qi(()=>Z.value.usine,async te=>{i.modelValue&&(Z.value.concessionnaire=null,Z.value.client=null,x.value=[],te?await Se(te):_.value=[])}),Qi(()=>Z.value.concessionnaire,async te=>{i.modelValue&&(Z.value.client=null,te?await Ne(te):x.value=[])}),Qi(()=>i.modelValue,te=>{var J,Ee,he;te?((J=a.user)==null?void 0:J.user_type)==="admin"?Be():((Ee=a.user)==null?void 0:Ee.user_type)==="usine"?Se(a.user.id):((he=a.user)==null?void 0:he.user_type)==="concessionnaire"&&Ne(a.user.id):(Z.value={nom:"",description:"",usine:null,concessionnaire:null,client:null},w.value=null,N.value=null,x.value=[],_.value=[],k.value=[],v.value=null)});async function Se(te){z.value=!0;try{if(te)_.value=await a.fetchUsineConcessionnaires(te);else{const J=await uo.getConcessionnaires();_.value=J.data}}catch(J){console.error("[NewPlanModal] Error loading concessionnaires:",J),_.value=[]}finally{z.value=!1}}async function Ne(te){W.value=!0;try{x.value=await a.fetchConcessionnaireAgriculteurs(te)}catch(J){console.error("[NewPlanModal] Error loading clients:",J),x.value=[]}finally{W.value=!1}}async function $e(te){i.modelValue&&(w.value=te,Z.value.concessionnaire=te.id,await Ne(te.id),o("concessionnaireSelected",te))}function Pe(te){i.modelValue&&(N.value=te,Z.value.client=te.id,o("clientSelected",te))}function xe(){o("update:modelValue",!1),Z.value={nom:"",description:"",usine:null,concessionnaire:null,client:null},w.value=null,N.value=null,x.value=[],v.value=null}async function Be(){O.value=!0;try{k.value=await a.fetchUsines()}catch(te){console.error("[NewPlanModal] Error loading usines:",te),k.value=[]}finally{O.value=!1}}async function ze(){var te,J,Ee,he,P,F;v.value=null,f.value=!0;try{const G={nom:Z.value.nom.trim(),description:Z.value.description.trim()};((te=a.user)==null?void 0:te.user_type)==="admin"?(G.usine=Z.value.usine,G.concessionnaire=Z.value.concessionnaire,G.agriculteur=Z.value.client):((J=a.user)==null?void 0:J.user_type)==="usine"?(G.usine=a.user.id,G.concessionnaire=Z.value.concessionnaire,G.agriculteur=Z.value.client):((Ee=a.user)==null?void 0:Ee.user_type)==="concessionnaire"?(G.usine=a.user.usine,G.concessionnaire=a.user.id,G.agriculteur=Z.value.client):((he=a.user)==null?void 0:he.user_type)==="agriculteur"&&(G.usine=a.user.usine,G.concessionnaire=a.user.concessionnaire,G.agriculteur=a.user.id),console.log("Donnes du plan  crer:",G),u.clearCurrentPlan(),d.setCurrentPlan(null);const Q=await u.createPlan(G);o("created",Q.id),xe()}catch(G){console.error("[NewPlanModal] Error creating plan:",G),console.error("Response data:",(P=G.response)==null?void 0:P.data);let Q="Une erreur est survenue lors de la cration du plan";(F=G.response)!=null&&F.data&&(typeof G.response.data=="object"?Q=Object.entries(G.response.data).map(([Ae,oe])=>Array.isArray(oe)?`${Ae}: ${oe.join(", ")}`:`${Ae}: ${oe}`).join(`
`):typeof G.response.data=="string"&&(Q=G.response.data)),v.value=Q}finally{f.value=!1}}return t({concessionnaires:_,concessionnaireClients:x,selectedConcessionnaire:w,selectedClient:N,loadConcessionnaires:Se,loadConcessionnaireClients:Ne,selectConcessionnaire:$e,selectClient:Pe}),(te,J)=>{var Ee,he,P,F;return te.modelValue?(Ie(),je("div",zL,[A("div",UL,[A("div",{class:"flex justify-between items-center mb-4"},[J[6]||(J[6]=A("h2",{class:"text-xl font-semibold text-gray-900"},"Crer un nouveau plan",-1)),A("button",{onClick:xe,class:"text-gray-400 hover:text-gray-500"},J[5]||(J[5]=[A("svg",{class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),mn(a).isAdmin?(Ie(),je("div",$L,[J[9]||(J[9]=A("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Usine",-1)),O.value?(Ie(),je("div",qL,J[7]||(J[7]=[A("div",{class:"h-10 bg-gray-200 rounded"},null,-1)]))):un((Ie(),je("select",{key:1,"onUpdate:modelValue":J[0]||(J[0]=G=>Z.value.usine=G),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500"},[J[8]||(J[8]=A("option",{value:null},"Slectionnez une usine",-1)),(Ie(!0),je(Qt,null,En(k.value,G=>(Ie(),je("option",{key:G.id,value:G.id},Bt(mn(co)(G)),9,VL))),128))],512)),[[vr,Z.value.usine]])])):Wt("",!0),((Ee=mn(a).user)==null?void 0:Ee.user_type)==="admin"||((he=mn(a).user)==null?void 0:he.user_type)==="usine"?(Ie(),je("div",GL,[J[11]||(J[11]=A("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Concessionnaire",-1)),z.value?(Ie(),je("div",HL,J[10]||(J[10]=[A("div",{class:"h-10 bg-gray-200 rounded"},null,-1)]))):un((Ie(),je("select",{key:1,id:"edit-concessionnaire","onUpdate:modelValue":J[1]||(J[1]=G=>Z.value.concessionnaire=G),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",disabled:!_.value.length||mn(a).isAdmin&&!Z.value.usine},[A("option",ZL,Bt(_.value.length?"Slectionnez un concessionnaire":"Aucun concessionnaire disponible"),1),(Ie(!0),je(Qt,null,En(_.value,G=>(Ie(),je("option",{key:G.id,value:G.id},Bt(mn(co)(G)),9,KL))),128))],8,WL)),[[vr,Z.value.concessionnaire]])])):Wt("",!0),((P=mn(a).user)==null?void 0:P.user_type)!=="agriculteur"?(Ie(),je("div",YL,[J[13]||(J[13]=A("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Agriculteur",-1)),W.value?(Ie(),je("div",JL,J[12]||(J[12]=[A("div",{class:"h-10 bg-gray-200 rounded"},null,-1)]))):un((Ie(),je("select",{key:1,id:"edit-agriculteur","onUpdate:modelValue":J[2]||(J[2]=G=>Z.value.client=G),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",disabled:!x.value.length||((F=mn(a).user)==null?void 0:F.user_type)!=="concessionnaire"&&!Z.value.concessionnaire},[A("option",QL,Bt(x.value.length?"Slectionnez un agriculteur":"Aucun agriculteur disponible"),1),(Ie(!0),je(Qt,null,En(x.value,G=>(Ie(),je("option",{key:G.id,value:G.id},Bt(mn(co)(G)),9,eC))),128))],8,XL)),[[vr,Z.value.client]])])):Wt("",!0),A("div",tC,[J[14]||(J[14]=A("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Nom du plan",-1)),un(A("input",{id:"edit-nom","onUpdate:modelValue":J[3]||(J[3]=G=>Z.value.nom=G),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"Entrez le nom du plan"},null,512),[[Zn,Z.value.nom]])]),A("div",nC,[J[15]||(J[15]=A("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Description",-1)),un(A("textarea",{id:"edit-description","onUpdate:modelValue":J[4]||(J[4]=G=>Z.value.description=G),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",rows:"3",placeholder:"Entrez une description (optionnel)"},null,512),[[Zn,Z.value.description]])]),A("div",iC,[A("button",{onClick:xe,class:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-primary-500"}," Annuler "),A("button",{onClick:ze,class:"px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500",disabled:!se.value||f.value},[f.value?(Ie(),je("span",sC,"Cration en cours...")):(Ie(),je("span",oC,"Crer"))],8,rC)])])])):Wt("",!0)}}});function yi(e){"@babel/helpers - typeof";return yi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yi(e)}var hs=Uint8Array,fo=Uint16Array,hp=Int32Array,fd=new hs([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),pd=new hs([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Mf=new hs([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),q1=function(e,t){for(var n=new fo(31),i=0;i<31;++i)n[i]=t+=1<<e[i-1];for(var o=new hp(n[30]),i=1;i<30;++i)for(var a=n[i];a<n[i+1];++a)o[a]=a-n[i]<<5|i;return{b:n,r:o}},V1=q1(fd,2),G1=V1.b,Bf=V1.r;G1[28]=258,Bf[258]=28;var H1=q1(pd,0),aC=H1.b,og=H1.r,Tf=new fo(32768);for(var Ri=0;Ri<32768;++Ri){var bl=(Ri&43690)>>1|(Ri&21845)<<1;bl=(bl&52428)>>2|(bl&13107)<<2,bl=(bl&61680)>>4|(bl&3855)<<4,Tf[Ri]=((bl&65280)>>8|(bl&255)<<8)>>1}var Ma=function(e,t,n){for(var i=e.length,o=0,a=new fo(t);o<i;++o)e[o]&&++a[e[o]-1];var u=new fo(t);for(o=1;o<t;++o)u[o]=u[o-1]+a[o-1]<<1;var d;if(n){d=new fo(1<<t);var f=15-t;for(o=0;o<i;++o)if(e[o])for(var v=o<<4|e[o],_=t-e[o],x=u[e[o]-1]++<<_,k=x|(1<<_)-1;x<=k;++x)d[Tf[x]>>f]=v}else for(d=new fo(i),o=0;o<i;++o)e[o]&&(d[o]=Tf[u[e[o]-1]++]>>15-e[o]);return d},Rl=new hs(288);for(var Ri=0;Ri<144;++Ri)Rl[Ri]=8;for(var Ri=144;Ri<256;++Ri)Rl[Ri]=9;for(var Ri=256;Ri<280;++Ri)Rl[Ri]=7;for(var Ri=280;Ri<288;++Ri)Rl[Ri]=8;var Dc=new hs(32);for(var Ri=0;Ri<32;++Ri)Dc[Ri]=5;var lC=Ma(Rl,9,0),uC=Ma(Rl,9,1),cC=Ma(Dc,5,0),hC=Ma(Dc,5,1),Hd=function(e){for(var t=e[0],n=1;n<e.length;++n)e[n]>t&&(t=e[n]);return t},Yo=function(e,t,n){var i=t/8|0;return(e[i]|e[i+1]<<8)>>(t&7)&n},Wd=function(e,t){var n=t/8|0;return(e[n]|e[n+1]<<8|e[n+2]<<16)>>(t&7)},dp=function(e){return(e+7)/8|0},W1=function(e,t,n){return(n==null||n>e.length)&&(n=e.length),new hs(e.subarray(t,n))},dC=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Xo=function(e,t,n){var i=new Error(t||dC[e]);if(i.code=e,Error.captureStackTrace&&Error.captureStackTrace(i,Xo),!n)throw i;return i},fC=function(e,t,n,i){var o=e.length,a=0;if(!o||t.f&&!t.l)return n||new hs(0);var u=!n,d=u||t.i!=2,f=t.i;u&&(n=new hs(o*3));var v=function(ue){var V=n.length;if(ue>V){var K=new hs(Math.max(V*2,ue));K.set(n),n=K}},_=t.f||0,x=t.p||0,k=t.b||0,w=t.l,N=t.d,z=t.m,W=t.n,O=o*8;do{if(!w){_=Yo(e,x,1);var Z=Yo(e,x+1,3);if(x+=3,Z)if(Z==1)w=uC,N=hC,z=9,W=5;else if(Z==2){var $e=Yo(e,x,31)+257,Pe=Yo(e,x+10,15)+4,xe=$e+Yo(e,x+5,31)+1;x+=14;for(var Be=new hs(xe),ze=new hs(19),te=0;te<Pe;++te)ze[Mf[te]]=Yo(e,x+te*3,7);x+=Pe*3;for(var J=Hd(ze),Ee=(1<<J)-1,he=Ma(ze,J,1),te=0;te<xe;){var P=he[Yo(e,x,Ee)];x+=P&15;var se=P>>4;if(se<16)Be[te++]=se;else{var F=0,G=0;for(se==16?(G=3+Yo(e,x,3),x+=2,F=Be[te-1]):se==17?(G=3+Yo(e,x,7),x+=3):se==18&&(G=11+Yo(e,x,127),x+=7);G--;)Be[te++]=F}}var Q=Be.subarray(0,$e),Ae=Be.subarray($e);z=Hd(Q),W=Hd(Ae),w=Ma(Q,z,1),N=Ma(Ae,W,1)}else Xo(1);else{var se=dp(x)+4,Se=e[se-4]|e[se-3]<<8,Ne=se+Se;if(Ne>o){f&&Xo(0);break}d&&v(k+Se),n.set(e.subarray(se,Ne),k),t.b=k+=Se,t.p=x=Ne*8,t.f=_;continue}if(x>O){f&&Xo(0);break}}d&&v(k+131072);for(var oe=(1<<z)-1,me=(1<<W)-1,T=x;;T=x){var F=w[Wd(e,x)&oe],ne=F>>4;if(x+=F&15,x>O){f&&Xo(0);break}if(F||Xo(2),ne<256)n[k++]=ne;else if(ne==256){T=x,w=null;break}else{var ae=ne-254;if(ne>264){var te=ne-257,q=fd[te];ae=Yo(e,x,(1<<q)-1)+G1[te],x+=q}var R=N[Wd(e,x)&me],U=R>>4;R||Xo(3),x+=R&15;var Ae=aC[U];if(U>3){var q=pd[U];Ae+=Wd(e,x)&(1<<q)-1,x+=q}if(x>O){f&&Xo(0);break}d&&v(k+131072);var H=k+ae;if(k<Ae){var $=a-Ae,ce=Math.min(Ae,H);for($+k<0&&Xo(3);k<ce;++k)n[k]=i[$+k]}for(;k<H;++k)n[k]=n[k-Ae]}}t.l=w,t.p=T,t.b=k,t.f=_,w&&(_=1,t.m=z,t.d=N,t.n=W)}while(!_);return k!=n.length&&u?W1(n,0,k):n.subarray(0,k)},Ja=function(e,t,n){n<<=t&7;var i=t/8|0;e[i]|=n,e[i+1]|=n>>8},sc=function(e,t,n){n<<=t&7;var i=t/8|0;e[i]|=n,e[i+1]|=n>>8,e[i+2]|=n>>16},Zd=function(e,t){for(var n=[],i=0;i<e.length;++i)e[i]&&n.push({s:i,f:e[i]});var o=n.length,a=n.slice();if(!o)return{t:K1,l:0};if(o==1){var u=new hs(n[0].s+1);return u[n[0].s]=1,{t:u,l:1}}n.sort(function(Ne,$e){return Ne.f-$e.f}),n.push({s:-1,f:25001});var d=n[0],f=n[1],v=0,_=1,x=2;for(n[0]={s:-1,f:d.f+f.f,l:d,r:f};_!=o-1;)d=n[n[v].f<n[x].f?v++:x++],f=n[v!=_&&n[v].f<n[x].f?v++:x++],n[_++]={s:-1,f:d.f+f.f,l:d,r:f};for(var k=a[0].s,i=1;i<o;++i)a[i].s>k&&(k=a[i].s);var w=new fo(k+1),N=Nf(n[_-1],w,0);if(N>t){var i=0,z=0,W=N-t,O=1<<W;for(a.sort(function($e,Pe){return w[Pe.s]-w[$e.s]||$e.f-Pe.f});i<o;++i){var Z=a[i].s;if(w[Z]>t)z+=O-(1<<N-w[Z]),w[Z]=t;else break}for(z>>=W;z>0;){var se=a[i].s;w[se]<t?z-=1<<t-w[se]++-1:++i}for(;i>=0&&z;--i){var Se=a[i].s;w[Se]==t&&(--w[Se],++z)}N=t}return{t:new hs(w),l:N}},Nf=function(e,t,n){return e.s==-1?Math.max(Nf(e.l,t,n+1),Nf(e.r,t,n+1)):t[e.s]=n},ag=function(e){for(var t=e.length;t&&!e[--t];);for(var n=new fo(++t),i=0,o=e[0],a=1,u=function(f){n[i++]=f},d=1;d<=t;++d)if(e[d]==o&&d!=t)++a;else{if(!o&&a>2){for(;a>138;a-=138)u(32754);a>2&&(u(a>10?a-11<<5|28690:a-3<<5|12305),a=0)}else if(a>3){for(u(o),--a;a>6;a-=6)u(8304);a>2&&(u(a-3<<5|8208),a=0)}for(;a--;)u(o);a=1,o=e[d]}return{c:n.subarray(0,i),n:t}},oc=function(e,t){for(var n=0,i=0;i<t.length;++i)n+=e[i]*t[i];return n},Z1=function(e,t,n){var i=n.length,o=dp(t+2);e[o]=i&255,e[o+1]=i>>8,e[o+2]=e[o]^255,e[o+3]=e[o+1]^255;for(var a=0;a<i;++a)e[o+a+4]=n[a];return(o+4+i)*8},lg=function(e,t,n,i,o,a,u,d,f,v,_){Ja(t,_++,n),++o[256];for(var x=Zd(o,15),k=x.t,w=x.l,N=Zd(a,15),z=N.t,W=N.l,O=ag(k),Z=O.c,se=O.n,Se=ag(z),Ne=Se.c,$e=Se.n,Pe=new fo(19),xe=0;xe<Z.length;++xe)++Pe[Z[xe]&31];for(var xe=0;xe<Ne.length;++xe)++Pe[Ne[xe]&31];for(var Be=Zd(Pe,7),ze=Be.t,te=Be.l,J=19;J>4&&!ze[Mf[J-1]];--J);var Ee=v+5<<3,he=oc(o,Rl)+oc(a,Dc)+u,P=oc(o,k)+oc(a,z)+u+14+3*J+oc(Pe,ze)+2*Pe[16]+3*Pe[17]+7*Pe[18];if(f>=0&&Ee<=he&&Ee<=P)return Z1(t,_,e.subarray(f,f+v));var F,G,Q,Ae;if(Ja(t,_,1+(P<he)),_+=2,P<he){F=Ma(k,w,0),G=k,Q=Ma(z,W,0),Ae=z;var oe=Ma(ze,te,0);Ja(t,_,se-257),Ja(t,_+5,$e-1),Ja(t,_+10,J-4),_+=14;for(var xe=0;xe<J;++xe)Ja(t,_+3*xe,ze[Mf[xe]]);_+=3*J;for(var me=[Z,Ne],T=0;T<2;++T)for(var ne=me[T],xe=0;xe<ne.length;++xe){var ae=ne[xe]&31;Ja(t,_,oe[ae]),_+=ze[ae],ae>15&&(Ja(t,_,ne[xe]>>5&127),_+=ne[xe]>>12)}}else F=lC,G=Rl,Q=cC,Ae=Dc;for(var xe=0;xe<d;++xe){var q=i[xe];if(q>255){var ae=q>>18&31;sc(t,_,F[ae+257]),_+=G[ae+257],ae>7&&(Ja(t,_,q>>23&31),_+=fd[ae]);var R=q&31;sc(t,_,Q[R]),_+=Ae[R],R>3&&(sc(t,_,q>>5&8191),_+=pd[R])}else sc(t,_,F[q]),_+=G[q]}return sc(t,_,F[256]),_+G[256]},pC=new hp([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),K1=new hs(0),gC=function(e,t,n,i,o,a){var u=a.z||e.length,d=new hs(i+u+5*(1+Math.ceil(u/7e3))+o),f=d.subarray(i,d.length-o),v=a.l,_=(a.r||0)&7;if(t){_&&(f[0]=a.r>>3);for(var x=pC[t-1],k=x>>13,w=x&8191,N=(1<<n)-1,z=a.p||new fo(32768),W=a.h||new fo(N+1),O=Math.ceil(n/3),Z=2*O,se=function(ye){return(e[ye]^e[ye+1]<<O^e[ye+2]<<Z)&N},Se=new hp(25e3),Ne=new fo(288),$e=new fo(32),Pe=0,xe=0,Be=a.i||0,ze=0,te=a.w||0,J=0;Be+2<u;++Be){var Ee=se(Be),he=Be&32767,P=W[Ee];if(z[he]=P,W[Ee]=he,te<=Be){var F=u-Be;if((Pe>7e3||ze>24576)&&(F>423||!v)){_=lg(e,f,0,Se,Ne,$e,xe,ze,J,Be-J,_),ze=Pe=xe=0,J=Be;for(var G=0;G<286;++G)Ne[G]=0;for(var G=0;G<30;++G)$e[G]=0}var Q=2,Ae=0,oe=w,me=he-P&32767;if(F>2&&Ee==se(Be-me))for(var T=Math.min(k,F)-1,ne=Math.min(32767,Be),ae=Math.min(258,F);me<=ne&&--oe&&he!=P;){if(e[Be+Q]==e[Be+Q-me]){for(var q=0;q<ae&&e[Be+q]==e[Be+q-me];++q);if(q>Q){if(Q=q,Ae=me,q>T)break;for(var R=Math.min(me,q-2),U=0,G=0;G<R;++G){var H=Be-me+G&32767,$=z[H],ce=H-$&32767;ce>U&&(U=ce,P=H)}}}he=P,P=z[he],me+=he-P&32767}if(Ae){Se[ze++]=268435456|Bf[Q]<<18|og[Ae];var ue=Bf[Q]&31,V=og[Ae]&31;xe+=fd[ue]+pd[V],++Ne[257+ue],++$e[V],te=Be+Q,++Pe}else Se[ze++]=e[Be],++Ne[e[Be]]}}for(Be=Math.max(Be,te);Be<u;++Be)Se[ze++]=e[Be],++Ne[e[Be]];_=lg(e,f,v,Se,Ne,$e,xe,ze,J,Be-J,_),v||(a.r=_&7|f[_/8|0]<<3,_-=7,a.h=W,a.p=z,a.i=Be,a.w=te)}else{for(var Be=a.w||0;Be<u+v;Be+=65535){var K=Be+65535;K>=u&&(f[_/8|0]=v,K=u),_=Z1(f,_+1,e.subarray(Be,K))}a.i=u}return W1(d,0,i+dp(_)+o)},Y1=function(){var e=1,t=0;return{p:function(n){for(var i=e,o=t,a=n.length|0,u=0;u!=a;){for(var d=Math.min(u+2655,a);u<d;++u)o+=i+=n[u];i=(i&65535)+15*(i>>16),o=(o&65535)+15*(o>>16)}e=i,t=o},d:function(){return e%=65521,t%=65521,(e&255)<<24|(e&65280)<<8|(t&255)<<8|t>>8}}},mC=function(e,t,n,i,o){if(!o&&(o={l:1},t.dictionary)){var a=t.dictionary.subarray(-32768),u=new hs(a.length+e.length);u.set(a),u.set(e,a.length),e=u,o.w=a.length}return gC(e,t.level==null?6:t.level,t.mem==null?o.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+t.mem,n,i,o)},J1=function(e,t,n){for(;n;++t)e[t]=n,n>>>=8},vC=function(e,t){var n=t.level,i=n==0?0:n<6?1:n==9?3:2;if(e[0]=120,e[1]=i<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var o=Y1();o.p(t.dictionary),J1(e,2,o.d())}},yC=function(e,t){return((e[0]&15)!=8||e[0]>>4>7||(e[0]<<8|e[1])%31)&&Xo(6,"invalid zlib data"),(e[1]>>5&1)==1&&Xo(6,"invalid zlib data: "+(e[1]&32?"need":"unexpected")+" dictionary"),(e[1]>>3&4)+2};function Df(e,t){t||(t={});var n=Y1();n.p(e);var i=mC(e,t,t.dictionary?6:2,4);return vC(i,t),J1(i,i.length-4,n.d()),i}function _C(e,t){return fC(e.subarray(yC(e),-4),{i:2},t,t)}var bC=typeof TextDecoder<"u"&&new TextDecoder,wC=0;try{bC.decode(K1,{stream:!0}),wC=1}catch{}var kn=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function Kd(){kn.console&&typeof kn.console.log=="function"&&kn.console.log.apply(kn.console,arguments)}var xi={log:Kd,warn:function(e){kn.console&&(typeof kn.console.warn=="function"?kn.console.warn.apply(kn.console,arguments):Kd.call(null,arguments))},error:function(e){kn.console&&(typeof kn.console.error=="function"?kn.console.error.apply(kn.console,arguments):Kd(e))}};function Yd(e,t,n){var i=new XMLHttpRequest;i.open("GET",e),i.responseType="blob",i.onload=function(){Yl(i.response,t,n)},i.onerror=function(){xi.error("could not download file")},i.send()}function ug(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function rh(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var wc,Rf,Yl=kn.saveAs||((typeof window>"u"?"undefined":yi(window))!=="object"||window!==kn?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(e,t,n){var i=kn.URL||kn.webkitURL,o=document.createElement("a");t=t||e.name||"download",o.download=t,o.rel="noopener",typeof e=="string"?(o.href=e,o.origin!==location.origin?ug(o.href)?Yd(e,t,n):rh(o,o.target="_blank"):rh(o)):(o.href=i.createObjectURL(e),setTimeout(function(){i.revokeObjectURL(o.href)},4e4),setTimeout(function(){rh(o)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,n){if(t=t||e.name||"download",typeof e=="string")if(ug(e))Yd(e,t,n);else{var i=document.createElement("a");i.href=e,i.target="_blank",setTimeout(function(){rh(i)})}else navigator.msSaveOrOpenBlob(function(o,a){return a===void 0?a={autoBom:!1}:yi(a)!=="object"&&(xi.warn("Deprecated: Expected third argument to be a object"),a={autoBom:!a}),a.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(o.type)?new Blob(["\uFEFF",o],{type:o.type}):o}(e,n),t)}:function(e,t,n,i){if((i=i||open("","_blank"))&&(i.document.title=i.document.body.innerText="downloading..."),typeof e=="string")return Yd(e,t,n);var o=e.type==="application/octet-stream",a=/constructor/i.test(kn.HTMLElement)||kn.safari,u=/CriOS\/[\d]+/.test(navigator.userAgent);if((u||o&&a)&&(typeof FileReader>"u"?"undefined":yi(FileReader))==="object"){var d=new FileReader;d.onloadend=function(){var _=d.result;_=u?_:_.replace(/^data:[^;]*;/,"data:attachment/file;"),i?i.location.href=_:location=_,i=null},d.readAsDataURL(e)}else{var f=kn.URL||kn.webkitURL,v=f.createObjectURL(e);i?i.location=v:location.href=v,i=null,setTimeout(function(){f.revokeObjectURL(v)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function X1(e){var t;e=e||"",this.ok=!1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var n=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(d){return[parseInt(d[1]),parseInt(d[2]),parseInt(d[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(d){return[parseInt(d[1],16),parseInt(d[2],16),parseInt(d[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(d){return[parseInt(d[1]+d[1],16),parseInt(d[2]+d[2],16),parseInt(d[3]+d[3],16)]}}],i=0;i<n.length;i++){var o=n[i].re,a=n[i].process,u=o.exec(e);u&&(t=a(u),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var d=this.r.toString(16),f=this.g.toString(16),v=this.b.toString(16);return d.length==1&&(d="0"+d),f.length==1&&(f="0"+f),v.length==1&&(v="0"+v),"#"+d+f+v}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function Jd(e,t){var n=e[0],i=e[1],o=e[2],a=e[3];n=rs(n,i,o,a,t[0],7,-680876936),a=rs(a,n,i,o,t[1],12,-389564586),o=rs(o,a,n,i,t[2],17,606105819),i=rs(i,o,a,n,t[3],22,-1044525330),n=rs(n,i,o,a,t[4],7,-176418897),a=rs(a,n,i,o,t[5],12,1200080426),o=rs(o,a,n,i,t[6],17,-1473231341),i=rs(i,o,a,n,t[7],22,-45705983),n=rs(n,i,o,a,t[8],7,1770035416),a=rs(a,n,i,o,t[9],12,-1958414417),o=rs(o,a,n,i,t[10],17,-42063),i=rs(i,o,a,n,t[11],22,-1990404162),n=rs(n,i,o,a,t[12],7,1804603682),a=rs(a,n,i,o,t[13],12,-40341101),o=rs(o,a,n,i,t[14],17,-1502002290),n=ss(n,i=rs(i,o,a,n,t[15],22,1236535329),o,a,t[1],5,-165796510),a=ss(a,n,i,o,t[6],9,-1069501632),o=ss(o,a,n,i,t[11],14,643717713),i=ss(i,o,a,n,t[0],20,-373897302),n=ss(n,i,o,a,t[5],5,-701558691),a=ss(a,n,i,o,t[10],9,38016083),o=ss(o,a,n,i,t[15],14,-660478335),i=ss(i,o,a,n,t[4],20,-405537848),n=ss(n,i,o,a,t[9],5,568446438),a=ss(a,n,i,o,t[14],9,-1019803690),o=ss(o,a,n,i,t[3],14,-187363961),i=ss(i,o,a,n,t[8],20,1163531501),n=ss(n,i,o,a,t[13],5,-1444681467),a=ss(a,n,i,o,t[2],9,-51403784),o=ss(o,a,n,i,t[7],14,1735328473),n=os(n,i=ss(i,o,a,n,t[12],20,-1926607734),o,a,t[5],4,-378558),a=os(a,n,i,o,t[8],11,-2022574463),o=os(o,a,n,i,t[11],16,1839030562),i=os(i,o,a,n,t[14],23,-35309556),n=os(n,i,o,a,t[1],4,-1530992060),a=os(a,n,i,o,t[4],11,1272893353),o=os(o,a,n,i,t[7],16,-155497632),i=os(i,o,a,n,t[10],23,-1094730640),n=os(n,i,o,a,t[13],4,681279174),a=os(a,n,i,o,t[0],11,-358537222),o=os(o,a,n,i,t[3],16,-722521979),i=os(i,o,a,n,t[6],23,76029189),n=os(n,i,o,a,t[9],4,-640364487),a=os(a,n,i,o,t[12],11,-421815835),o=os(o,a,n,i,t[15],16,530742520),n=as(n,i=os(i,o,a,n,t[2],23,-995338651),o,a,t[0],6,-198630844),a=as(a,n,i,o,t[7],10,1126891415),o=as(o,a,n,i,t[14],15,-1416354905),i=as(i,o,a,n,t[5],21,-57434055),n=as(n,i,o,a,t[12],6,1700485571),a=as(a,n,i,o,t[3],10,-1894986606),o=as(o,a,n,i,t[10],15,-1051523),i=as(i,o,a,n,t[1],21,-2054922799),n=as(n,i,o,a,t[8],6,1873313359),a=as(a,n,i,o,t[15],10,-30611744),o=as(o,a,n,i,t[6],15,-1560198380),i=as(i,o,a,n,t[13],21,1309151649),n=as(n,i,o,a,t[4],6,-145523070),a=as(a,n,i,o,t[11],10,-1120210379),o=as(o,a,n,i,t[2],15,718787259),i=as(i,o,a,n,t[9],21,-343485551),e[0]=Ml(n,e[0]),e[1]=Ml(i,e[1]),e[2]=Ml(o,e[2]),e[3]=Ml(a,e[3])}function gd(e,t,n,i,o,a){return t=Ml(Ml(t,e),Ml(i,a)),Ml(t<<o|t>>>32-o,n)}function rs(e,t,n,i,o,a,u){return gd(t&n|~t&i,e,t,o,a,u)}function ss(e,t,n,i,o,a,u){return gd(t&i|n&~i,e,t,o,a,u)}function os(e,t,n,i,o,a,u){return gd(t^n^i,e,t,o,a,u)}function as(e,t,n,i,o,a,u){return gd(n^(t|~i),e,t,o,a,u)}function Q1(e){var t,n=e.length,i=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)Jd(i,xC(e.substring(t-64,t)));e=e.substring(t-64);var o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)o[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(o[t>>2]|=128<<(t%4<<3),t>55)for(Jd(i,o),t=0;t<16;t++)o[t]=0;return o[14]=8*n,Jd(i,o),i}function xC(e){var t,n=[];for(t=0;t<64;t+=4)n[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return n}wc=kn.atob.bind(kn),Rf=kn.btoa.bind(kn);var cg="0123456789abcdef".split("");function LC(e){for(var t="",n=0;n<4;n++)t+=cg[e>>8*n+4&15]+cg[e>>8*n&15];return t}function CC(e){return String.fromCharCode((255&e)>>0,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function Of(e){return Q1(e).map(CC).join("")}var PC=function(e){for(var t=0;t<e.length;t++)e[t]=LC(e[t]);return e.join("")}(Q1("hello"))!="5d41402abc4b2a76b9719d911017c592";function Ml(e,t){if(PC){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}return e+t&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function If(e,t){var n,i,o,a;if(e!==n){for(var u=(o=e,a=1+(256/e.length>>0),new Array(a+1).join(o)),d=[],f=0;f<256;f++)d[f]=f;var v=0;for(f=0;f<256;f++){var _=d[f];v=(v+_+u.charCodeAt(f))%256,d[f]=d[v],d[v]=_}n=e,i=d}else d=i;var x=t.length,k=0,w=0,N="";for(f=0;f<x;f++)w=(w+(_=d[k=(k+1)%256]))%256,d[k]=d[w],d[w]=_,u=d[(d[k]+d[w])%256],N+=String.fromCharCode(t.charCodeAt(f)^u);return N}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var hg={print:4,modify:8,copy:16,"annot-forms":32};function Au(e,t,n,i){this.v=1,this.r=2;var o=192;e.forEach(function(d){if(hg.perm!==void 0)throw new Error("Invalid permission: "+d);o+=hg[d]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var a=(t+this.padding).substr(0,32),u=(n+this.padding).substr(0,32);this.O=this.processOwnerPassword(a,u),this.P=-(1+(255^o)),this.encryptionKey=Of(a+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(i)).substr(0,5),this.U=If(this.encryptionKey,this.padding)}function Mu(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var t="",n=e.length,i=0;i<n;i++){var o=e.charCodeAt(i);o<33||o===35||o===37||o===40||o===41||o===47||o===60||o===62||o===91||o===93||o===123||o===125||o>126?t+="#"+("0"+o.toString(16)).slice(-2):t+=e[i]}return t}function dg(e){if(yi(e)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(n,i,o){if(o=o||!1,typeof n!="string"||typeof i!="function"||typeof o!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(n)||(t[n]={});var a=Math.random().toString(35);return t[n][a]=[i,!!o],a},this.unsubscribe=function(n){for(var i in t)if(t[i][n])return delete t[i][n],Object.keys(t[i]).length===0&&delete t[i],!0;return!1},this.publish=function(n){if(t.hasOwnProperty(n)){var i=Array.prototype.slice.call(arguments,1),o=[];for(var a in t[n]){var u=t[n][a];try{u[0].apply(e,i)}catch(d){kn.console&&xi.error("jsPDF PubSub Error",d.message,d)}u[1]&&o.push(a)}o.length&&o.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function zh(e){if(!(this instanceof zh))return new zh(e);var t="opacity,stroke-opacity".split(",");for(var n in e)e.hasOwnProperty(n)&&t.indexOf(n)>=0&&(this[n]=e[n]);this.id="",this.objectNumber=-1}function ev(e,t){this.gState=e,this.matrix=t,this.id="",this.objectNumber=-1}function Xl(e,t,n,i,o){if(!(this instanceof Xl))return new Xl(e,t,n,i,o);this.type=e==="axial"?2:3,this.coords=t,this.colors=n,ev.call(this,i,o)}function Tu(e,t,n,i,o){if(!(this instanceof Tu))return new Tu(e,t,n,i,o);this.boundingBox=e,this.xStep=t,this.yStep=n,this.stream="",this.cloneIndex=0,ev.call(this,i,o)}function Cn(e){var t,n=typeof arguments[0]=="string"?arguments[0]:"p",i=arguments[1],o=arguments[2],a=arguments[3],u=[],d=1,f=16,v="S",_=null;yi(e=e||{})==="object"&&(n=e.orientation,i=e.unit||i,o=e.format||o,a=e.compress||e.compressPdf||a,(_=e.encryption||null)!==null&&(_.userPassword=_.userPassword||"",_.ownerPassword=_.ownerPassword||"",_.userPermissions=_.userPermissions||[]),d=typeof e.userUnit=="number"?Math.abs(e.userUnit):1,e.precision!==void 0&&(t=e.precision),e.floatPrecision!==void 0&&(f=e.floatPrecision),v=e.defaultPathOperation||"S"),u=e.filters||(a===!0?["FlateEncode"]:u),i=i||"mm",n=(""+(n||"P")).toLowerCase();var x=e.putOnlyUsedFonts||!1,k={},w={internal:{},__private__:{}};w.__private__.PubSub=dg;var N="1.3",z=w.__private__.getPdfVersion=function(){return N};w.__private__.setPdfVersion=function(C){N=C};var W={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};w.__private__.getPageFormats=function(){return W};var O=w.__private__.getPageFormat=function(C){return W[C]};o=o||"a4";var Z={COMPAT:"compat",ADVANCED:"advanced"},se=Z.COMPAT;function Se(){this.saveGraphicsState(),ee(new sn(At,0,0,-At,0,xo()*At).toString()+" cm"),this.setFontSize(this.getFontSize()/At),v="n",se=Z.ADVANCED}function Ne(){this.restoreGraphicsState(),v="S",se=Z.COMPAT}var $e=w.__private__.combineFontStyleAndFontWeight=function(C,ie){if(C=="bold"&&ie=="normal"||C=="bold"&&ie==400||C=="normal"&&ie=="italic"||C=="bold"&&ie=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return ie&&(C=ie==400||ie==="normal"?C==="italic"?"italic":"normal":ie!=700&&ie!=="bold"||C!=="normal"?(ie==700?"bold":ie)+""+C:"bold"),C};w.advancedAPI=function(C){var ie=se===Z.COMPAT;return ie&&Se.call(this),typeof C!="function"||(C(this),ie&&Ne.call(this)),this},w.compatAPI=function(C){var ie=se===Z.ADVANCED;return ie&&Ne.call(this),typeof C!="function"||(C(this),ie&&Se.call(this)),this},w.isAdvancedAPI=function(){return se===Z.ADVANCED};var Pe,xe=function(C){if(se!==Z.ADVANCED)throw new Error(C+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},Be=w.roundToPrecision=w.__private__.roundToPrecision=function(C,ie){var De=t||ie;if(isNaN(C)||isNaN(De))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return C.toFixed(De).replace(/0+$/,"")};Pe=w.hpf=w.__private__.hpf=typeof f=="number"?function(C){if(isNaN(C))throw new Error("Invalid argument passed to jsPDF.hpf");return Be(C,f)}:f==="smart"?function(C){if(isNaN(C))throw new Error("Invalid argument passed to jsPDF.hpf");return Be(C,C>-1&&C<1?16:5)}:function(C){if(isNaN(C))throw new Error("Invalid argument passed to jsPDF.hpf");return Be(C,16)};var ze=w.f2=w.__private__.f2=function(C){if(isNaN(C))throw new Error("Invalid argument passed to jsPDF.f2");return Be(C,2)},te=w.__private__.f3=function(C){if(isNaN(C))throw new Error("Invalid argument passed to jsPDF.f3");return Be(C,3)},J=w.scale=w.__private__.scale=function(C){if(isNaN(C))throw new Error("Invalid argument passed to jsPDF.scale");return se===Z.COMPAT?C*At:se===Z.ADVANCED?C:void 0},Ee=function(C){return se===Z.COMPAT?xo()-C:se===Z.ADVANCED?C:void 0},he=function(C){return J(Ee(C))};w.__private__.setPrecision=w.setPrecision=function(C){typeof parseInt(C,10)=="number"&&(t=parseInt(C,10))};var P,F="00000000000000000000000000000000",G=w.__private__.getFileId=function(){return F},Q=w.__private__.setFileId=function(C){return F=C!==void 0&&/^[a-fA-F0-9]{32}$/.test(C)?C.toUpperCase():F.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),_!==null&&($i=new Au(_.userPermissions,_.userPassword,_.ownerPassword,F)),F};w.setFileId=function(C){return Q(C),this},w.getFileId=function(){return G()};var Ae=w.__private__.convertDateToPDFDate=function(C){var ie=C.getTimezoneOffset(),De=ie<0?"+":"-",We=Math.floor(Math.abs(ie/60)),ut=Math.abs(ie%60),wt=[De,ae(We),"'",ae(ut),"'"].join("");return["D:",C.getFullYear(),ae(C.getMonth()+1),ae(C.getDate()),ae(C.getHours()),ae(C.getMinutes()),ae(C.getSeconds()),wt].join("")},oe=w.__private__.convertPDFDateToDate=function(C){var ie=parseInt(C.substr(2,4),10),De=parseInt(C.substr(6,2),10)-1,We=parseInt(C.substr(8,2),10),ut=parseInt(C.substr(10,2),10),wt=parseInt(C.substr(12,2),10),zt=parseInt(C.substr(14,2),10);return new Date(ie,De,We,ut,wt,zt,0)},me=w.__private__.setCreationDate=function(C){var ie;if(C===void 0&&(C=new Date),C instanceof Date)ie=Ae(C);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(C))throw new Error("Invalid argument passed to jsPDF.setCreationDate");ie=C}return P=ie},T=w.__private__.getCreationDate=function(C){var ie=P;return C==="jsDate"&&(ie=oe(P)),ie};w.setCreationDate=function(C){return me(C),this},w.getCreationDate=function(C){return T(C)};var ne,ae=w.__private__.padd2=function(C){return("0"+parseInt(C)).slice(-2)},q=w.__private__.padd2Hex=function(C){return("00"+(C=C.toString())).substr(C.length)},R=0,U=[],H=[],$=0,ce=[],ue=[],V=!1,K=H,ye=function(){R=0,$=0,H=[],U=[],ce=[],ui=_t(),yr=_t()};w.__private__.setCustomOutputDestination=function(C){V=!0,K=C};var ve=function(C){V||(K=C)};w.__private__.resetCustomOutputDestination=function(){V=!1,K=H};var ee=w.__private__.out=function(C){return C=C.toString(),$+=C.length+1,K.push(C),K},Ge=w.__private__.write=function(C){return ee(arguments.length===1?C.toString():Array.prototype.join.call(arguments," "))},tt=w.__private__.getArrayBuffer=function(C){for(var ie=C.length,De=new ArrayBuffer(ie),We=new Uint8Array(De);ie--;)We[ie]=C.charCodeAt(ie);return De},Ue=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];w.__private__.getStandardFonts=function(){return Ue};var nt=e.fontSize||16;w.__private__.setFontSize=w.setFontSize=function(C){return nt=se===Z.ADVANCED?C/At:C,this};var st,Ct=w.__private__.getFontSize=w.getFontSize=function(){return se===Z.COMPAT?nt:nt*At},xt=e.R2L||!1;w.__private__.setR2L=w.setR2L=function(C){return xt=C,this},w.__private__.getR2L=w.getR2L=function(){return xt};var Ot,$t=w.__private__.setZoomMode=function(C){var ie=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(C))st=C;else if(isNaN(C)){if(ie.indexOf(C)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+C+'" is not recognized.');st=C}else st=parseInt(C,10)};w.__private__.getZoomMode=function(){return st};var Gt,ft=w.__private__.setPageMode=function(C){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(C)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+C+'" is not recognized.');Ot=C};w.__private__.getPageMode=function(){return Ot};var Fe=w.__private__.setLayoutMode=function(C){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(C)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+C+'" is not recognized.');Gt=C};w.__private__.getLayoutMode=function(){return Gt},w.__private__.setDisplayMode=w.setDisplayMode=function(C,ie,De){return $t(C),Fe(ie),ft(De),this};var kt={title:"",subject:"",author:"",keywords:"",creator:""};w.__private__.getDocumentProperty=function(C){if(Object.keys(kt).indexOf(C)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return kt[C]},w.__private__.getDocumentProperties=function(){return kt},w.__private__.setDocumentProperties=w.setProperties=w.setDocumentProperties=function(C){for(var ie in kt)kt.hasOwnProperty(ie)&&C[ie]&&(kt[ie]=C[ie]);return this},w.__private__.setDocumentProperty=function(C,ie){if(Object.keys(kt).indexOf(C)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return kt[C]=ie};var Et,At,et,ot,wn,Zt={},rn={},Gn=[],Tn={},Kn={},Hn={},Ui={},Oi=null,zn=0,Ut=[],An=new dg(w),bi=e.hotfixes||[],Yn={},wi={},pi=[],sn=function C(ie,De,We,ut,wt,zt){if(!(this instanceof C))return new C(ie,De,We,ut,wt,zt);isNaN(ie)&&(ie=1),isNaN(De)&&(De=0),isNaN(We)&&(We=0),isNaN(ut)&&(ut=1),isNaN(wt)&&(wt=0),isNaN(zt)&&(zt=0),this._matrix=[ie,De,We,ut,wt,zt]};Object.defineProperty(sn.prototype,"sx",{get:function(){return this._matrix[0]},set:function(C){this._matrix[0]=C}}),Object.defineProperty(sn.prototype,"shy",{get:function(){return this._matrix[1]},set:function(C){this._matrix[1]=C}}),Object.defineProperty(sn.prototype,"shx",{get:function(){return this._matrix[2]},set:function(C){this._matrix[2]=C}}),Object.defineProperty(sn.prototype,"sy",{get:function(){return this._matrix[3]},set:function(C){this._matrix[3]=C}}),Object.defineProperty(sn.prototype,"tx",{get:function(){return this._matrix[4]},set:function(C){this._matrix[4]=C}}),Object.defineProperty(sn.prototype,"ty",{get:function(){return this._matrix[5]},set:function(C){this._matrix[5]=C}}),Object.defineProperty(sn.prototype,"a",{get:function(){return this._matrix[0]},set:function(C){this._matrix[0]=C}}),Object.defineProperty(sn.prototype,"b",{get:function(){return this._matrix[1]},set:function(C){this._matrix[1]=C}}),Object.defineProperty(sn.prototype,"c",{get:function(){return this._matrix[2]},set:function(C){this._matrix[2]=C}}),Object.defineProperty(sn.prototype,"d",{get:function(){return this._matrix[3]},set:function(C){this._matrix[3]=C}}),Object.defineProperty(sn.prototype,"e",{get:function(){return this._matrix[4]},set:function(C){this._matrix[4]=C}}),Object.defineProperty(sn.prototype,"f",{get:function(){return this._matrix[5]},set:function(C){this._matrix[5]=C}}),Object.defineProperty(sn.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(sn.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(sn.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(sn.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),sn.prototype.join=function(C){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(Pe).join(C)},sn.prototype.multiply=function(C){var ie=C.sx*this.sx+C.shy*this.shx,De=C.sx*this.shy+C.shy*this.sy,We=C.shx*this.sx+C.sy*this.shx,ut=C.shx*this.shy+C.sy*this.sy,wt=C.tx*this.sx+C.ty*this.shx+this.tx,zt=C.tx*this.shy+C.ty*this.sy+this.ty;return new sn(ie,De,We,ut,wt,zt)},sn.prototype.decompose=function(){var C=this.sx,ie=this.shy,De=this.shx,We=this.sy,ut=this.tx,wt=this.ty,zt=Math.sqrt(C*C+ie*ie),Kt=(C/=zt)*De+(ie/=zt)*We;De-=C*Kt,We-=ie*Kt;var en=Math.sqrt(De*De+We*We);return Kt/=en,C*(We/=en)<ie*(De/=en)&&(C=-C,ie=-ie,Kt=-Kt,zt=-zt),{scale:new sn(zt,0,0,en,0,0),translate:new sn(1,0,0,1,ut,wt),rotate:new sn(C,ie,-ie,C,0,0),skew:new sn(1,0,Kt,1,0,0)}},sn.prototype.toString=function(C){return this.join(" ")},sn.prototype.inversed=function(){var C=this.sx,ie=this.shy,De=this.shx,We=this.sy,ut=this.tx,wt=this.ty,zt=1/(C*We-ie*De),Kt=We*zt,en=-ie*zt,ln=-De*zt,Ln=C*zt;return new sn(Kt,en,ln,Ln,-Kt*ut-ln*wt,-en*ut-Ln*wt)},sn.prototype.applyToPoint=function(C){var ie=C.x*this.sx+C.y*this.shx+this.tx,De=C.x*this.shy+C.y*this.sy+this.ty;return new Vo(ie,De)},sn.prototype.applyToRectangle=function(C){var ie=this.applyToPoint(C),De=this.applyToPoint(new Vo(C.x+C.w,C.y+C.h));return new Jr(ie.x,ie.y,De.x-ie.x,De.y-ie.y)},sn.prototype.clone=function(){var C=this.sx,ie=this.shy,De=this.shx,We=this.sy,ut=this.tx,wt=this.ty;return new sn(C,ie,De,We,ut,wt)},w.Matrix=sn;var gn=w.matrixMult=function(C,ie){return ie.multiply(C)},Yt=new sn(1,0,0,1,0,0);w.unitMatrix=w.identityMatrix=Yt;var gi=function(C,ie){if(!Kn[C]){var De=(ie instanceof Xl?"Sh":"P")+(Object.keys(Tn).length+1).toString(10);ie.id=De,Kn[C]=De,Tn[De]=ie,An.publish("addPattern",ie)}};w.ShadingPattern=Xl,w.TilingPattern=Tu,w.addShadingPattern=function(C,ie){return xe("addShadingPattern()"),gi(C,ie),this},w.beginTilingPattern=function(C){xe("beginTilingPattern()"),Ua(C.boundingBox[0],C.boundingBox[1],C.boundingBox[2]-C.boundingBox[0],C.boundingBox[3]-C.boundingBox[1],C.matrix)},w.endTilingPattern=function(C,ie){xe("endTilingPattern()"),ie.stream=ue[ne].join(`
`),gi(C,ie),An.publish("endTilingPattern",ie),pi.pop().restore()};var Rn=w.__private__.newObject=function(){var C=_t();return Xn(C,!0),C},_t=w.__private__.newObjectDeferred=function(){return R++,U[R]=function(){return $},R},Xn=function(C,ie){return ie=typeof ie=="boolean"&&ie,U[C]=$,ie&&ee(C+" 0 obj"),C},Ii=w.__private__.newAdditionalObject=function(){var C={objId:_t(),content:""};return ce.push(C),C},ui=_t(),yr=_t(),lr=w.__private__.decodeColorString=function(C){var ie=C.split(" ");if(ie.length!==2||ie[1]!=="g"&&ie[1]!=="G")ie.length===5&&(ie[4]==="k"||ie[4]==="K")&&(ie=[(1-ie[0])*(1-ie[3]),(1-ie[1])*(1-ie[3]),(1-ie[2])*(1-ie[3]),"r"]);else{var De=parseFloat(ie[0]);ie=[De,De,De,"r"]}for(var We="#",ut=0;ut<3;ut++)We+=("0"+Math.floor(255*parseFloat(ie[ut])).toString(16)).slice(-2);return We},_r=w.__private__.encodeColorString=function(C){var ie;typeof C=="string"&&(C={ch1:C});var De=C.ch1,We=C.ch2,ut=C.ch3,wt=C.ch4,zt=C.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof De=="string"&&De.charAt(0)!=="#"){var Kt=new X1(De);if(Kt.ok)De=Kt.toHex();else if(!/^\d*\.?\d*$/.test(De))throw new Error('Invalid color "'+De+'" passed to jsPDF.encodeColorString.')}if(typeof De=="string"&&/^#[0-9A-Fa-f]{3}$/.test(De)&&(De="#"+De[1]+De[1]+De[2]+De[2]+De[3]+De[3]),typeof De=="string"&&/^#[0-9A-Fa-f]{6}$/.test(De)){var en=parseInt(De.substr(1),16);De=en>>16&255,We=en>>8&255,ut=255&en}if(We===void 0||wt===void 0&&De===We&&We===ut)if(typeof De=="string")ie=De+" "+zt[0];else switch(C.precision){case 2:ie=ze(De/255)+" "+zt[0];break;case 3:default:ie=te(De/255)+" "+zt[0]}else if(wt===void 0||yi(wt)==="object"){if(wt&&!isNaN(wt.a)&&wt.a===0)return ie=["1.","1.","1.",zt[1]].join(" ");if(typeof De=="string")ie=[De,We,ut,zt[1]].join(" ");else switch(C.precision){case 2:ie=[ze(De/255),ze(We/255),ze(ut/255),zt[1]].join(" ");break;default:case 3:ie=[te(De/255),te(We/255),te(ut/255),zt[1]].join(" ")}}else if(typeof De=="string")ie=[De,We,ut,wt,zt[2]].join(" ");else switch(C.precision){case 2:ie=[ze(De),ze(We),ze(ut),ze(wt),zt[2]].join(" ");break;case 3:default:ie=[te(De),te(We),te(ut),te(wt),zt[2]].join(" ")}return ie},Ki=w.__private__.getFilters=function(){return u},ur=w.__private__.putStream=function(C){var ie=(C=C||{}).data||"",De=C.filters||Ki(),We=C.alreadyAppliedFilters||[],ut=C.addLength1||!1,wt=ie.length,zt=C.objectId,Kt=function(Vi){return Vi};if(_!==null&&zt===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");_!==null&&(Kt=$i.encryptor(zt,0));var en={};De===!0&&(De=["FlateEncode"]);var ln=C.additionalKeyValues||[],Ln=(en=Cn.API.processDataByFilters!==void 0?Cn.API.processDataByFilters(ie,De):{data:ie,reverseChain:[]}).reverseChain+(Array.isArray(We)?We.join(" "):We.toString());if(en.data.length!==0&&(ln.push({key:"Length",value:en.data.length}),ut===!0&&ln.push({key:"Length1",value:wt})),Ln.length!=0)if(Ln.split("/").length-1==1)ln.push({key:"Filter",value:Ln});else{ln.push({key:"Filter",value:"["+Ln+"]"});for(var Fn=0;Fn<ln.length;Fn+=1)if(ln[Fn].key==="DecodeParms"){for(var mi=[],Wn=0;Wn<en.reverseChain.split("/").length-1;Wn+=1)mi.push("null");mi.push(ln[Fn].value),ln[Fn].value="["+mi.join(" ")+"]"}}ee("<<");for(var ei=0;ei<ln.length;ei++)ee("/"+ln[ei].key+" "+ln[ei].value);ee(">>"),en.data.length!==0&&(ee("stream"),ee(Kt(en.data)),ee("endstream"))},jr=w.__private__.putPage=function(C){var ie=C.number,De=C.data,We=C.objId,ut=C.contentsObjId;Xn(We,!0),ee("<</Type /Page"),ee("/Parent "+C.rootDictionaryObjId+" 0 R"),ee("/Resources "+C.resourceDictionaryObjId+" 0 R"),ee("/MediaBox ["+parseFloat(Pe(C.mediaBox.bottomLeftX))+" "+parseFloat(Pe(C.mediaBox.bottomLeftY))+" "+Pe(C.mediaBox.topRightX)+" "+Pe(C.mediaBox.topRightY)+"]"),C.cropBox!==null&&ee("/CropBox ["+Pe(C.cropBox.bottomLeftX)+" "+Pe(C.cropBox.bottomLeftY)+" "+Pe(C.cropBox.topRightX)+" "+Pe(C.cropBox.topRightY)+"]"),C.bleedBox!==null&&ee("/BleedBox ["+Pe(C.bleedBox.bottomLeftX)+" "+Pe(C.bleedBox.bottomLeftY)+" "+Pe(C.bleedBox.topRightX)+" "+Pe(C.bleedBox.topRightY)+"]"),C.trimBox!==null&&ee("/TrimBox ["+Pe(C.trimBox.bottomLeftX)+" "+Pe(C.trimBox.bottomLeftY)+" "+Pe(C.trimBox.topRightX)+" "+Pe(C.trimBox.topRightY)+"]"),C.artBox!==null&&ee("/ArtBox ["+Pe(C.artBox.bottomLeftX)+" "+Pe(C.artBox.bottomLeftY)+" "+Pe(C.artBox.topRightX)+" "+Pe(C.artBox.topRightY)+"]"),typeof C.userUnit=="number"&&C.userUnit!==1&&ee("/UserUnit "+C.userUnit),An.publish("putPage",{objId:We,pageContext:Ut[ie],pageNumber:ie,page:De}),ee("/Contents "+ut+" 0 R"),ee(">>"),ee("endobj");var wt=De.join(`
`);return se===Z.ADVANCED&&(wt+=`
Q`),Xn(ut,!0),ur({data:wt,filters:Ki(),objectId:ut}),ee("endobj"),We},Es=w.__private__.putPages=function(){var C,ie,De=[];for(C=1;C<=zn;C++)Ut[C].objId=_t(),Ut[C].contentsObjId=_t();for(C=1;C<=zn;C++)De.push(jr({number:C,data:ue[C],objId:Ut[C].objId,contentsObjId:Ut[C].contentsObjId,mediaBox:Ut[C].mediaBox,cropBox:Ut[C].cropBox,bleedBox:Ut[C].bleedBox,trimBox:Ut[C].trimBox,artBox:Ut[C].artBox,userUnit:Ut[C].userUnit,rootDictionaryObjId:ui,resourceDictionaryObjId:yr}));Xn(ui,!0),ee("<</Type /Pages");var We="/Kids [";for(ie=0;ie<zn;ie++)We+=De[ie]+" 0 R ";ee(We+"]"),ee("/Count "+zn),ee(">>"),ee("endobj"),An.publish("postPutPages")},Zs=function(C){An.publish("putFont",{font:C,out:ee,newObject:Rn,putStream:ur}),C.isAlreadyPutted!==!0&&(C.objectNumber=Rn(),ee("<<"),ee("/Type /Font"),ee("/BaseFont /"+Mu(C.postScriptName)),ee("/Subtype /Type1"),typeof C.encoding=="string"&&ee("/Encoding /"+C.encoding),ee("/FirstChar 32"),ee("/LastChar 255"),ee(">>"),ee("endobj"))},Ks=function(){for(var C in Zt)Zt.hasOwnProperty(C)&&(x===!1||x===!0&&k.hasOwnProperty(C))&&Zs(Zt[C])},Gr=function(C){C.objectNumber=Rn();var ie=[];ie.push({key:"Type",value:"/XObject"}),ie.push({key:"Subtype",value:"/Form"}),ie.push({key:"BBox",value:"["+[Pe(C.x),Pe(C.y),Pe(C.x+C.width),Pe(C.y+C.height)].join(" ")+"]"}),ie.push({key:"Matrix",value:"["+C.matrix.toString()+"]"});var De=C.pages[1].join(`
`);ur({data:De,additionalKeyValues:ie,objectId:C.objectNumber}),ee("endobj")},fs=function(){for(var C in Yn)Yn.hasOwnProperty(C)&&Gr(Yn[C])},As=function(C,ie){var De,We=[],ut=1/(ie-1);for(De=0;De<1;De+=ut)We.push(De);if(We.push(1),C[0].offset!=0){var wt={offset:0,color:C[0].color};C.unshift(wt)}if(C[C.length-1].offset!=1){var zt={offset:1,color:C[C.length-1].color};C.push(zt)}for(var Kt="",en=0,ln=0;ln<We.length;ln++){for(De=We[ln];De>C[en+1].offset;)en++;var Ln=C[en].offset,Fn=(De-Ln)/(C[en+1].offset-Ln),mi=C[en].color,Wn=C[en+1].color;Kt+=q(Math.round((1-Fn)*mi[0]+Fn*Wn[0]).toString(16))+q(Math.round((1-Fn)*mi[1]+Fn*Wn[1]).toString(16))+q(Math.round((1-Fn)*mi[2]+Fn*Wn[2]).toString(16))}return Kt.trim()},aa=function(C,ie){ie||(ie=21);var De=Rn(),We=As(C.colors,ie),ut=[];ut.push({key:"FunctionType",value:"0"}),ut.push({key:"Domain",value:"[0.0 1.0]"}),ut.push({key:"Size",value:"["+ie+"]"}),ut.push({key:"BitsPerSample",value:"8"}),ut.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),ut.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),ur({data:We,additionalKeyValues:ut,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:De}),ee("endobj"),C.objectNumber=Rn(),ee("<< /ShadingType "+C.type),ee("/ColorSpace /DeviceRGB");var wt="/Coords ["+Pe(parseFloat(C.coords[0]))+" "+Pe(parseFloat(C.coords[1]))+" ";C.type===2?wt+=Pe(parseFloat(C.coords[2]))+" "+Pe(parseFloat(C.coords[3])):wt+=Pe(parseFloat(C.coords[2]))+" "+Pe(parseFloat(C.coords[3]))+" "+Pe(parseFloat(C.coords[4]))+" "+Pe(parseFloat(C.coords[5])),ee(wt+="]"),C.matrix&&ee("/Matrix ["+C.matrix.toString()+"]"),ee("/Function "+De+" 0 R"),ee("/Extend [true true]"),ee(">>"),ee("endobj")},la=function(C,ie){var De=_t(),We=Rn();ie.push({resourcesOid:De,objectOid:We}),C.objectNumber=We;var ut=[];ut.push({key:"Type",value:"/Pattern"}),ut.push({key:"PatternType",value:"1"}),ut.push({key:"PaintType",value:"1"}),ut.push({key:"TilingType",value:"1"}),ut.push({key:"BBox",value:"["+C.boundingBox.map(Pe).join(" ")+"]"}),ut.push({key:"XStep",value:Pe(C.xStep)}),ut.push({key:"YStep",value:Pe(C.yStep)}),ut.push({key:"Resources",value:De+" 0 R"}),C.matrix&&ut.push({key:"Matrix",value:"["+C.matrix.toString()+"]"}),ur({data:C.stream,additionalKeyValues:ut,objectId:C.objectNumber}),ee("endobj")},Ys=function(C){var ie;for(ie in Tn)Tn.hasOwnProperty(ie)&&(Tn[ie]instanceof Xl?aa(Tn[ie]):Tn[ie]instanceof Tu&&la(Tn[ie],C))},Io=function(C){for(var ie in C.objectNumber=Rn(),ee("<<"),C)switch(ie){case"opacity":ee("/ca "+ze(C[ie]));break;case"stroke-opacity":ee("/CA "+ze(C[ie]))}ee(">>"),ee("endobj")},ua=function(){var C;for(C in Hn)Hn.hasOwnProperty(C)&&Io(Hn[C])},Ms=function(){for(var C in ee("/XObject <<"),Yn)Yn.hasOwnProperty(C)&&Yn[C].objectNumber>=0&&ee("/"+C+" "+Yn[C].objectNumber+" 0 R");An.publish("putXobjectDict"),ee(">>")},Bs=function(){$i.oid=Rn(),ee("<<"),ee("/Filter /Standard"),ee("/V "+$i.v),ee("/R "+$i.r),ee("/U <"+$i.toHexString($i.U)+">"),ee("/O <"+$i.toHexString($i.O)+">"),ee("/P "+$i.P),ee(">>"),ee("endobj")},go=function(){for(var C in ee("/Font <<"),Zt)Zt.hasOwnProperty(C)&&(x===!1||x===!0&&k.hasOwnProperty(C))&&ee("/"+C+" "+Zt[C].objectNumber+" 0 R");ee(">>")},Fo=function(){if(Object.keys(Tn).length>0){for(var C in ee("/Shading <<"),Tn)Tn.hasOwnProperty(C)&&Tn[C]instanceof Xl&&Tn[C].objectNumber>=0&&ee("/"+C+" "+Tn[C].objectNumber+" 0 R");An.publish("putShadingPatternDict"),ee(">>")}},cr=function(C){if(Object.keys(Tn).length>0){for(var ie in ee("/Pattern <<"),Tn)Tn.hasOwnProperty(ie)&&Tn[ie]instanceof w.TilingPattern&&Tn[ie].objectNumber>=0&&Tn[ie].objectNumber<C&&ee("/"+ie+" "+Tn[ie].objectNumber+" 0 R");An.publish("putTilingPatternDict"),ee(">>")}},On=function(){if(Object.keys(Hn).length>0){var C;for(C in ee("/ExtGState <<"),Hn)Hn.hasOwnProperty(C)&&Hn[C].objectNumber>=0&&ee("/"+C+" "+Hn[C].objectNumber+" 0 R");An.publish("putGStateDict"),ee(">>")}},yn=function(C){Xn(C.resourcesOid,!0),ee("<<"),ee("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),go(),Fo(),cr(C.objectOid),On(),Ms(),ee(">>"),ee("endobj")},ps=function(){var C=[];Ks(),ua(),fs(),Ys(C),An.publish("putResources"),C.forEach(yn),yn({resourcesOid:yr,objectOid:Number.MAX_SAFE_INTEGER}),An.publish("postPutResources")},Hr=function(){An.publish("putAdditionalObjects");for(var C=0;C<ce.length;C++){var ie=ce[C];Xn(ie.objId,!0),ee(ie.content),ee("endobj")}An.publish("postPutAdditionalObjects")},zr=function(C){rn[C.fontName]=rn[C.fontName]||{},rn[C.fontName][C.fontStyle]=C.id},Ts=function(C,ie,De,We,ut){var wt={id:"F"+(Object.keys(Zt).length+1).toString(10),postScriptName:C,fontName:ie,fontStyle:De,encoding:We,isStandardFont:ut||!1,metadata:{}};return An.publish("addFont",{font:wt,instance:this}),Zt[wt.id]=wt,zr(wt),wt.id},xn=function(C){for(var ie=0,De=Ue.length;ie<De;ie++){var We=Ts.call(this,C[ie][0],C[ie][1],C[ie][2],Ue[ie][3],!0);x===!1&&(k[We]=!0);var ut=C[ie][0].split("-");zr({id:We,fontName:ut[0],fontStyle:ut[1]||""})}An.publish("addFonts",{fonts:Zt,dictionary:rn})},qn=function(C){return C.foo=function(){try{return C.apply(this,arguments)}catch(We){var ie=We.stack||"";~ie.indexOf(" at ")&&(ie=ie.split(" at ")[1]);var De="Error in function "+ie.split(`
`)[0].split("<")[0]+": "+We.message;if(!kn.console)throw new Error(De);kn.console.error(De,We),kn.alert&&alert(De)}},C.foo.bar=C,C.foo},ki=function(C,ie){var De,We,ut,wt,zt,Kt,en,ln,Ln;if(ut=(ie=ie||{}).sourceEncoding||"Unicode",zt=ie.outputEncoding,(ie.autoencode||zt)&&Zt[Et].metadata&&Zt[Et].metadata[ut]&&Zt[Et].metadata[ut].encoding&&(wt=Zt[Et].metadata[ut].encoding,!zt&&Zt[Et].encoding&&(zt=Zt[Et].encoding),!zt&&wt.codePages&&(zt=wt.codePages[0]),typeof zt=="string"&&(zt=wt[zt]),zt)){for(en=!1,Kt=[],De=0,We=C.length;De<We;De++)(ln=zt[C.charCodeAt(De)])?Kt.push(String.fromCharCode(ln)):Kt.push(C[De]),Kt[De].charCodeAt(0)>>8&&(en=!0);C=Kt.join("")}for(De=C.length;en===void 0&&De!==0;)C.charCodeAt(De-1)>>8&&(en=!0),De--;if(!en)return C;for(Kt=ie.noBOM?[]:[254,255],De=0,We=C.length;De<We;De++){if((Ln=(ln=C.charCodeAt(De))>>8)>>8)throw new Error("Character at position "+De+" of string '"+C+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Kt.push(Ln),Kt.push(ln-(Ln<<8))}return String.fromCharCode.apply(void 0,Kt)},Vn=w.__private__.pdfEscape=w.pdfEscape=function(C,ie){return ki(C,ie).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Qn=w.__private__.beginPage=function(C){ue[++zn]=[],Ut[zn]={objId:0,contentsObjId:0,userUnit:Number(d),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(C[0]),topRightY:Number(C[1])}},Wr(zn),ve(ue[ne])},ci=function(C,ie){var De,We,ut;switch(n=ie||n,typeof C=="string"&&(De=O(C.toLowerCase()),Array.isArray(De)&&(We=De[0],ut=De[1])),Array.isArray(C)&&(We=C[0]*At,ut=C[1]*At),isNaN(We)&&(We=o[0],ut=o[1]),(We>14400||ut>14400)&&(xi.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),We=Math.min(14400,We),ut=Math.min(14400,ut)),o=[We,ut],n.substr(0,1)){case"l":ut>We&&(o=[ut,We]);break;case"p":We>ut&&(o=[ut,We])}Qn(o),$o(fa),ee(Er),ma!==0&&ee(ma+" J"),qi!==0&&ee(qi+" j"),An.publish("addPage",{pageNumber:zn})},gs=function(C){C>0&&C<=zn&&(ue.splice(C,1),Ut.splice(C,1),zn--,ne>zn&&(ne=zn),this.setPage(ne))},Wr=function(C){C>0&&C<=zn&&(ne=C)},_i=w.__private__.getNumberOfPages=w.getNumberOfPages=function(){return ue.length-1},Ns=function(C,ie,De){var We,ut=void 0;return De=De||{},C=C!==void 0?C:Zt[Et].fontName,ie=ie!==void 0?ie:Zt[Et].fontStyle,We=C.toLowerCase(),rn[We]!==void 0&&rn[We][ie]!==void 0?ut=rn[We][ie]:rn[C]!==void 0&&rn[C][ie]!==void 0?ut=rn[C][ie]:De.disableWarning===!1&&xi.warn("Unable to look up font label for font '"+C+"', '"+ie+"'. Refer to getFontList() for available fonts."),ut||De.noFallback||(ut=rn.times[ie])==null&&(ut=rn.times.normal),ut},jo=w.__private__.putInfo=function(){var C=Rn(),ie=function(We){return We};for(var De in _!==null&&(ie=$i.encryptor(C,0)),ee("<<"),ee("/Producer ("+Vn(ie("jsPDF "+Cn.version))+")"),kt)kt.hasOwnProperty(De)&&kt[De]&&ee("/"+De.substr(0,1).toUpperCase()+De.substr(1)+" ("+Vn(ie(kt[De]))+")");ee("/CreationDate ("+Vn(ie(P))+")"),ee(">>"),ee("endobj")},Js=w.__private__.putCatalog=function(C){var ie=(C=C||{}).rootDictionaryObjId||ui;switch(Rn(),ee("<<"),ee("/Type /Catalog"),ee("/Pages "+ie+" 0 R"),st||(st="fullwidth"),st){case"fullwidth":ee("/OpenAction [3 0 R /FitH null]");break;case"fullheight":ee("/OpenAction [3 0 R /FitV null]");break;case"fullpage":ee("/OpenAction [3 0 R /Fit]");break;case"original":ee("/OpenAction [3 0 R /XYZ null null 1]");break;default:var De=""+st;De.substr(De.length-1)==="%"&&(st=parseInt(st)/100),typeof st=="number"&&ee("/OpenAction [3 0 R /XYZ null null "+ze(st)+"]")}switch(Gt||(Gt="continuous"),Gt){case"continuous":ee("/PageLayout /OneColumn");break;case"single":ee("/PageLayout /SinglePage");break;case"two":case"twoleft":ee("/PageLayout /TwoColumnLeft");break;case"tworight":ee("/PageLayout /TwoColumnRight")}Ot&&ee("/PageMode /"+Ot),An.publish("putCatalog"),ee(">>"),ee("endobj")},Da=w.__private__.putTrailer=function(){ee("trailer"),ee("<<"),ee("/Size "+(R+1)),ee("/Root "+R+" 0 R"),ee("/Info "+(R-1)+" 0 R"),_!==null&&ee("/Encrypt "+$i.oid+" 0 R"),ee("/ID [ <"+F+"> <"+F+"> ]"),ee(">>")},mo=w.__private__.putHeader=function(){ee("%PDF-"+N),ee("%")},Ra=w.__private__.putXRef=function(){var C="0000000000";ee("xref"),ee("0 "+(R+1)),ee("0000000000 65535 f ");for(var ie=1;ie<=R;ie++)typeof U[ie]=="function"?ee((C+U[ie]()).slice(-10)+" 00000 n "):U[ie]!==void 0?ee((C+U[ie]).slice(-10)+" 00000 n "):ee("0000000000 00000 n ")},ms=w.__private__.buildDocument=function(){ye(),ve(H),An.publish("buildDocument"),mo(),Es(),Hr(),ps(),_!==null&&Bs(),jo(),Js();var C=$;return Ra(),Da(),ee("startxref"),ee(""+C),ee("%%EOF"),ve(ue[ne]),H.join(`
`)},Xs=w.__private__.getBlob=function(C){return new Blob([tt(C)],{type:"application/pdf"})},vo=w.output=w.__private__.output=qn(function(C,ie){switch(typeof(ie=ie||{})=="string"?ie={filename:ie}:ie.filename=ie.filename||"generated.pdf",C){case void 0:return ms();case"save":w.save(ie.filename);break;case"arraybuffer":return tt(ms());case"blob":return Xs(ms());case"bloburi":case"bloburl":if(kn.URL!==void 0&&typeof kn.URL.createObjectURL=="function")return kn.URL&&kn.URL.createObjectURL(Xs(ms()))||void 0;xi.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var De="",We=ms();try{De=Rf(We)}catch{De=Rf(unescape(encodeURIComponent(We)))}return"data:application/pdf;filename="+ie.filename+";base64,"+De;case"pdfobjectnewwindow":if(Object.prototype.toString.call(kn)==="[object Window]"){var ut="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",wt=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';ie.pdfObjectUrl&&(ut=ie.pdfObjectUrl,wt="");var zt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+ut+'"'+wt+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(ie)+");<\/script></body></html>",Kt=kn.open();return Kt!==null&&Kt.document.write(zt),Kt}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(kn)==="[object Window]"){var en='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(ie.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+ie.filename+'" width="500px" height="400px" /></body></html>',ln=kn.open();if(ln!==null){ln.document.write(en);var Ln=this;ln.document.documentElement.querySelector("#pdfViewer").onload=function(){ln.document.title=ie.filename,ln.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Ln.output("bloburl"))}}return ln}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(kn)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Fn='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",ie)+'"></iframe></body></html>',mi=kn.open();if(mi!==null&&(mi.document.write(Fn),mi.document.title=ie.filename),mi||typeof safari>"u")return mi;break;case"datauri":case"dataurl":return kn.document.location.href=this.output("datauristring",ie);default:return null}}),ca=function(C){return Array.isArray(bi)===!0&&bi.indexOf(C)>-1};switch(i){case"pt":At=1;break;case"mm":At=72/25.4;break;case"cm":At=72/2.54;break;case"in":At=72;break;case"px":At=ca("px_scaling")==1?.75:96/72;break;case"pc":case"em":At=12;break;case"ex":At=6;break;default:if(typeof i!="number")throw new Error("Invalid unit: "+i);At=i}var $i=null;me(),Q();var sl=function(C){return _!==null?$i.encryptor(C,0):function(ie){return ie}},ha=w.__private__.getPageInfo=w.getPageInfo=function(C){if(isNaN(C)||C%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Ut[C].objId,pageNumber:C,pageContext:Ut[C]}},Pn=w.__private__.getPageInfoByObjId=function(C){if(isNaN(C)||C%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var ie in Ut)if(Ut[ie].objId===C)break;return ha(ie)},Sn=w.__private__.getCurrentPageInfo=w.getCurrentPageInfo=function(){return{objId:Ut[ne].objId,pageNumber:ne,pageContext:Ut[ne]}};w.addPage=function(){return ci.apply(this,arguments),this},w.setPage=function(){return Wr.apply(this,arguments),ve.call(this,ue[ne]),this},w.insertPage=function(C){return this.addPage(),this.movePage(ne,C),this},w.movePage=function(C,ie){var De,We;if(C>ie){De=ue[C],We=Ut[C];for(var ut=C;ut>ie;ut--)ue[ut]=ue[ut-1],Ut[ut]=Ut[ut-1];ue[ie]=De,Ut[ie]=We,this.setPage(ie)}else if(C<ie){De=ue[C],We=Ut[C];for(var wt=C;wt<ie;wt++)ue[wt]=ue[wt+1],Ut[wt]=Ut[wt+1];ue[ie]=De,Ut[ie]=We,this.setPage(ie)}return this},w.deletePage=function(){return gs.apply(this,arguments),this},w.__private__.text=w.text=function(C,ie,De,We,ut){var wt,zt,Kt,en,ln,Ln,Fn,mi,Wn,ei=(We=We||{}).scope||this;if(typeof C=="number"&&typeof ie=="number"&&(typeof De=="string"||Array.isArray(De))){var Vi=De;De=ie,ie=C,C=Vi}if(arguments[3]instanceof sn?(xe("The transform parameter of text() with a Matrix value"),Wn=ut):(Kt=arguments[4],en=arguments[5],yi(Fn=arguments[3])==="object"&&Fn!==null||(typeof Kt=="string"&&(en=Kt,Kt=null),typeof Fn=="string"&&(en=Fn,Fn=null),typeof Fn=="number"&&(Kt=Fn,Fn=null),We={flags:Fn,angle:Kt,align:en})),isNaN(ie)||isNaN(De)||C==null)throw new Error("Invalid arguments passed to jsPDF.text");if(C.length===0)return ei;var Fi="",$r=!1,oi=typeof We.lineHeightFactor=="number"?We.lineHeightFactor:Uo,wr=ei.internal.scaleFactor;function ll(ri){return ri=ri.split("	").join(Array(We.TabLen||9).join(" ")),Vn(ri,Fn)}function xr(ri){for(var ti,Ti=ri.concat(),ai=[],_s=Ti.length;_s--;)typeof(ti=Ti.shift())=="string"?ai.push(ti):Array.isArray(ri)&&(ti.length===1||ti[1]===void 0&&ti[2]===void 0)?ai.push(ti[0]):ai.push([ti[0],ti[1],ti[2]]);return ai}function qa(ri,ti){var Ti;if(typeof ri=="string")Ti=ti(ri)[0];else if(Array.isArray(ri)){for(var ai,_s,ko=ri.concat(),js=[],cl=ko.length;cl--;)typeof(ai=ko.shift())=="string"?js.push(ti(ai)[0]):Array.isArray(ai)&&typeof ai[0]=="string"&&(_s=ti(ai[0],ai[1],ai[2]),js.push([_s[0],_s[1],_s[2]]));Ti=js}return Ti}var vs=!1,Va=!0;if(typeof C=="string")vs=!0;else if(Array.isArray(C)){var to=C.concat();zt=[];for(var no,ji=to.length;ji--;)(typeof(no=to.shift())!="string"||Array.isArray(no)&&typeof no[0]!="string")&&(Va=!1);vs=Va}if(vs===!1)throw new Error('Type of text must be string or Array. "'+C+'" is not recognized.');typeof C=="string"&&(C=C.match(/[\r?\n]/)?C.split(/\r\n|\r|\n/g):[C]);var _a=nt/ei.internal.scaleFactor,Ar=_a*(oi-1);switch(We.baseline){case"bottom":De-=Ar;break;case"top":De+=_a-Ar;break;case"hanging":De+=_a-2*Ar;break;case"middle":De+=_a/2-Ar}if((Ln=We.maxWidth||0)>0&&(typeof C=="string"?C=ei.splitTextToSize(C,Ln):Object.prototype.toString.call(C)==="[object Array]"&&(C=C.reduce(function(ri,ti){return ri.concat(ei.splitTextToSize(ti,Ln))},[]))),wt={text:C,x:ie,y:De,options:We,mutex:{pdfEscape:Vn,activeFontKey:Et,fonts:Zt,activeFontSize:nt}},An.publish("preProcessText",wt),C=wt.text,Kt=(We=wt.options).angle,!(Wn instanceof sn)&&Kt&&typeof Kt=="number"){Kt*=Math.PI/180,We.rotationDirection===0&&(Kt=-Kt),se===Z.ADVANCED&&(Kt=-Kt);var Lr=Math.cos(Kt),ba=Math.sin(Kt);Wn=new sn(Lr,ba,-ba,Lr,0,0)}else Kt&&Kt instanceof sn&&(Wn=Kt);se!==Z.ADVANCED||Wn||(Wn=Yt),(ln=We.charSpace||ga)!==void 0&&(Fi+=Pe(J(ln))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(mi=We.horizontalScale)!==void 0&&(Fi+=Pe(100*mi)+` Tz
`),We.lang;var hr=-1,io=We.renderingMode!==void 0?We.renderingMode:We.stroke,qr=ei.internal.getCurrentPageInfo().pageContext;switch(io){case 0:case!1:case"fill":hr=0;break;case 1:case!0:case"stroke":hr=1;break;case 2:case"fillThenStroke":hr=2;break;case 3:case"invisible":hr=3;break;case 4:case"fillAndAddForClipping":hr=4;break;case 5:case"strokeAndAddPathForClipping":hr=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":hr=6;break;case 7:case"addToPathForClipping":hr=7}var ul=qr.usedRenderingMode!==void 0?qr.usedRenderingMode:-1;hr!==-1?Fi+=hr+` Tr
`:ul!==-1&&(Fi+=`0 Tr
`),hr!==-1&&(qr.usedRenderingMode=hr),en=We.align||"left";var Gi,Rs=nt*oi,Xr=ei.internal.pageSize.getWidth(),Ho=Zt[Et];ln=We.charSpace||ga,Ln=We.maxWidth||0,Fn=Object.assign({autoencode:!0,noBOM:!0},We.flags);var ro=[],Os=function(ri){return ei.getStringUnitWidth(ri,{font:Ho,charSpace:ln,fontSize:nt,doKerning:!1})*nt/wr};if(Object.prototype.toString.call(C)==="[object Array]"){var er;zt=xr(C),en!=="left"&&(Gi=zt.map(Os));var Yi,ys=0;if(en==="right"){ie-=Gi[0],C=[],ji=zt.length;for(var Mr=0;Mr<ji;Mr++)Mr===0?(Yi=dn(ie),er=br(De)):(Yi=J(ys-Gi[Mr]),er=-Rs),C.push([zt[Mr],Yi,er]),ys=Gi[Mr]}else if(en==="center"){ie-=Gi[0]/2,C=[],ji=zt.length;for(var Qr=0;Qr<ji;Qr++)Qr===0?(Yi=dn(ie),er=br(De)):(Yi=J((ys-Gi[Qr])/2),er=-Rs),C.push([zt[Qr],Yi,er]),ys=Gi[Qr]}else if(en==="left"){C=[],ji=zt.length;for(var so=0;so<ji;so++)C.push(zt[so])}else if(en==="justify"&&Ho.encoding==="Identity-H"){C=[],ji=zt.length,Ln=Ln!==0?Ln:Xr;for(var es=0,Si=0;Si<ji;Si++)if(er=Si===0?br(De):-Rs,Yi=Si===0?dn(ie):es,Si<ji-1){var Is=J((Ln-Gi[Si])/(zt[Si].split(" ").length-1)),Cr=zt[Si].split(" ");C.push([Cr[0]+" ",Yi,er]),es=0;for(var dr=1;dr<Cr.length;dr++){var Wo=(Os(Cr[dr-1]+" "+Cr[dr])-Os(Cr[dr]))*wr+Is;dr==Cr.length-1?C.push([Cr[dr],Wo,0]):C.push([Cr[dr]+" ",Wo,0]),es-=Wo}}else C.push([zt[Si],Yi,er]);C.push(["",es,0])}else{if(en!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(C=[],ji=zt.length,Ln=Ln!==0?Ln:Xr,Si=0;Si<ji;Si++)er=Si===0?br(De):-Rs,Yi=Si===0?dn(ie):0,Si<ji-1?ro.push(Pe(J((Ln-Gi[Si])/(zt[Si].split(" ").length-1)))):ro.push(0),C.push([zt[Si],Yi,er])}}var Ga=typeof We.R2L=="boolean"?We.R2L:xt;Ga===!0&&(C=qa(C,function(ri,ti,Ti){return[ri.split("").reverse().join(""),ti,Ti]})),wt={text:C,x:ie,y:De,options:We,mutex:{pdfEscape:Vn,activeFontKey:Et,fonts:Zt,activeFontSize:nt}},An.publish("postProcessText",wt),C=wt.text,$r=wt.mutex.isHex||!1;var Ha=Zt[Et].encoding;Ha!=="WinAnsiEncoding"&&Ha!=="StandardEncoding"||(C=qa(C,function(ri,ti,Ti){return[ll(ri),ti,Ti]})),zt=xr(C),C=[];for(var fr,Br,Lo,Fs=0,wa=1,Co=Array.isArray(zt[0])?wa:Fs,Po="",oo=function(ri,ti,Ti){var ai="";return Ti instanceof sn?(Ti=typeof We.angle=="number"?gn(Ti,new sn(1,0,0,1,ri,ti)):gn(new sn(1,0,0,1,ri,ti),Ti),se===Z.ADVANCED&&(Ti=gn(new sn(1,0,0,-1,0,0),Ti)),ai=Ti.join(" ")+` Tm
`):ai=Pe(ri)+" "+Pe(ti)+` Td
`,ai},ts=0;ts<zt.length;ts++){switch(Po="",Co){case wa:Lo=($r?"<":"(")+zt[ts][0]+($r?">":")"),fr=parseFloat(zt[ts][1]),Br=parseFloat(zt[ts][2]);break;case Fs:Lo=($r?"<":"(")+zt[ts]+($r?">":")"),fr=dn(ie),Br=br(De)}ro!==void 0&&ro[ts]!==void 0&&(Po=ro[ts]+` Tw
`),ts===0?C.push(Po+oo(fr,Br,Wn)+Lo):Co===Fs?C.push(Po+Lo):Co===wa&&C.push(Po+oo(fr,Br,Wn)+Lo)}C=Co===Fs?C.join(` Tj
T* `):C.join(` Tj
`),C+=` Tj
`;var tr=`BT
/`;return tr+=Et+" "+nt+` Tf
`,tr+=Pe(nt*oi)+` TL
`,tr+=Ds+`
`,tr+=Fi,tr+=C,ee(tr+="ET"),k[Et]=!0,ei};var Zr=w.__private__.clip=w.clip=function(C){return ee(C==="evenodd"?"W*":"W"),this};w.clipEvenOdd=function(){return Zr("evenodd")},w.__private__.discardPath=w.discardPath=function(){return ee("n"),this};var Un=w.__private__.isValidStyle=function(C){var ie=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(C)!==-1&&(ie=!0),ie};w.__private__.setDefaultPathOperation=w.setDefaultPathOperation=function(C){return Un(C)&&(v=C),this};var Oa=w.__private__.getStyle=w.getStyle=function(C){var ie=v;switch(C){case"D":case"S":ie="S";break;case"F":ie="f";break;case"FD":case"DF":ie="B";break;case"f":case"f*":case"B":case"B*":ie=C}return ie},da=w.close=function(){return ee("h"),this};w.stroke=function(){return ee("S"),this},w.fill=function(C){return yo("f",C),this},w.fillEvenOdd=function(C){return yo("f*",C),this},w.fillStroke=function(C){return yo("B",C),this},w.fillStrokeEvenOdd=function(C){return yo("B*",C),this};var yo=function(C,ie){yi(ie)==="object"?Ia(ie,C):ee(C)},Kr=function(C){C===null||se===Z.ADVANCED&&C===void 0||(C=Oa(C),ee(C))};function Qs(C,ie,De,We,ut){var wt=new Tu(ie||this.boundingBox,De||this.xStep,We||this.yStep,this.gState,ut||this.matrix);wt.stream=this.stream;var zt=C+"$$"+this.cloneIndex+++"$$";return gi(zt,wt),wt}var Ia=function(C,ie){var De=Kn[C.key],We=Tn[De];if(We instanceof Xl)ee("q"),ee(zo(ie)),We.gState&&w.setGState(We.gState),ee(C.matrix.toString()+" cm"),ee("/"+De+" sh"),ee("Q");else if(We instanceof Tu){var ut=new sn(1,0,0,-1,0,xo());C.matrix&&(ut=ut.multiply(C.matrix||Yt),De=Qs.call(We,C.key,C.boundingBox,C.xStep,C.yStep,ut).id),ee("q"),ee("/Pattern cs"),ee("/"+De+" scn"),We.gState&&w.setGState(We.gState),ee(ie),ee("Q")}},zo=function(C){switch(C){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},Mi=w.moveTo=function(C,ie){return ee(Pe(J(C))+" "+Pe(he(ie))+" m"),this},Ur=w.lineTo=function(C,ie){return ee(Pe(J(C))+" "+Pe(he(ie))+" l"),this},eo=w.curveTo=function(C,ie,De,We,ut,wt){return ee([Pe(J(C)),Pe(he(ie)),Pe(J(De)),Pe(he(We)),Pe(J(ut)),Pe(he(wt)),"c"].join(" ")),this};w.__private__.line=w.line=function(C,ie,De,We,ut){if(isNaN(C)||isNaN(ie)||isNaN(De)||isNaN(We)||!Un(ut))throw new Error("Invalid arguments passed to jsPDF.line");return se===Z.COMPAT?this.lines([[De-C,We-ie]],C,ie,[1,1],ut||"S"):this.lines([[De-C,We-ie]],C,ie,[1,1]).stroke()},w.__private__.lines=w.lines=function(C,ie,De,We,ut,wt){var zt,Kt,en,ln,Ln,Fn,mi,Wn,ei,Vi,Fi,$r;if(typeof C=="number"&&($r=De,De=ie,ie=C,C=$r),We=We||[1,1],wt=wt||!1,isNaN(ie)||isNaN(De)||!Array.isArray(C)||!Array.isArray(We)||!Un(ut)||typeof wt!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Mi(ie,De),zt=We[0],Kt=We[1],ln=C.length,Vi=ie,Fi=De,en=0;en<ln;en++)(Ln=C[en]).length===2?(Vi=Ln[0]*zt+Vi,Fi=Ln[1]*Kt+Fi,Ur(Vi,Fi)):(Fn=Ln[0]*zt+Vi,mi=Ln[1]*Kt+Fi,Wn=Ln[2]*zt+Vi,ei=Ln[3]*Kt+Fi,Vi=Ln[4]*zt+Vi,Fi=Ln[5]*Kt+Fi,eo(Fn,mi,Wn,ei,Vi,Fi));return wt&&da(),Kr(ut),this},w.path=function(C){for(var ie=0;ie<C.length;ie++){var De=C[ie],We=De.c;switch(De.op){case"m":Mi(We[0],We[1]);break;case"l":Ur(We[0],We[1]);break;case"c":eo.apply(this,We);break;case"h":da()}}return this},w.__private__.rect=w.rect=function(C,ie,De,We,ut){if(isNaN(C)||isNaN(ie)||isNaN(De)||isNaN(We)||!Un(ut))throw new Error("Invalid arguments passed to jsPDF.rect");return se===Z.COMPAT&&(We=-We),ee([Pe(J(C)),Pe(he(ie)),Pe(J(De)),Pe(J(We)),"re"].join(" ")),Kr(ut),this},w.__private__.triangle=w.triangle=function(C,ie,De,We,ut,wt,zt){if(isNaN(C)||isNaN(ie)||isNaN(De)||isNaN(We)||isNaN(ut)||isNaN(wt)||!Un(zt))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[De-C,We-ie],[ut-De,wt-We],[C-ut,ie-wt]],C,ie,[1,1],zt,!0),this},w.__private__.roundedRect=w.roundedRect=function(C,ie,De,We,ut,wt,zt){if(isNaN(C)||isNaN(ie)||isNaN(De)||isNaN(We)||isNaN(ut)||isNaN(wt)||!Un(zt))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Kt=4/3*(Math.SQRT2-1);return ut=Math.min(ut,.5*De),wt=Math.min(wt,.5*We),this.lines([[De-2*ut,0],[ut*Kt,0,ut,wt-wt*Kt,ut,wt],[0,We-2*wt],[0,wt*Kt,-ut*Kt,wt,-ut,wt],[2*ut-De,0],[-ut*Kt,0,-ut,-wt*Kt,-ut,-wt],[0,2*wt-We],[0,-wt*Kt,ut*Kt,-wt,ut,-wt]],C+ut,ie,[1,1],zt,!0),this},w.__private__.ellipse=w.ellipse=function(C,ie,De,We,ut){if(isNaN(C)||isNaN(ie)||isNaN(De)||isNaN(We)||!Un(ut))throw new Error("Invalid arguments passed to jsPDF.ellipse");var wt=4/3*(Math.SQRT2-1)*De,zt=4/3*(Math.SQRT2-1)*We;return Mi(C+De,ie),eo(C+De,ie-zt,C+wt,ie-We,C,ie-We),eo(C-wt,ie-We,C-De,ie-zt,C-De,ie),eo(C-De,ie+zt,C-wt,ie+We,C,ie+We),eo(C+wt,ie+We,C+De,ie+zt,C+De,ie),Kr(ut),this},w.__private__.circle=w.circle=function(C,ie,De,We){if(isNaN(C)||isNaN(ie)||isNaN(De)||!Un(We))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(C,ie,De,De,We)},w.setFont=function(C,ie,De){return De&&(ie=$e(ie,De)),Et=Ns(C,ie,{disableWarning:!1}),this};var ol=w.__private__.getFont=w.getFont=function(){return Zt[Ns.apply(w,arguments)]};w.__private__.getFontList=w.getFontList=function(){var C,ie,De={};for(C in rn)if(rn.hasOwnProperty(C))for(ie in De[C]=[],rn[C])rn[C].hasOwnProperty(ie)&&De[C].push(ie);return De},w.addFont=function(C,ie,De,We,ut){var wt=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&wt.indexOf(arguments[3])!==-1?ut=arguments[3]:arguments[3]&&wt.indexOf(arguments[3])==-1&&(De=$e(De,We)),ut=ut||"Identity-H",Ts.call(this,C,ie,De,ut)};var Uo,fa=e.lineWidth||.200025,_o=w.__private__.getLineWidth=w.getLineWidth=function(){return fa},$o=w.__private__.setLineWidth=w.setLineWidth=function(C){return fa=C,ee(Pe(J(C))+" w"),this};w.__private__.setLineDash=Cn.API.setLineDash=Cn.API.setLineDashPattern=function(C,ie){if(C=C||[],ie=ie||0,isNaN(ie)||!Array.isArray(C))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return C=C.map(function(De){return Pe(J(De))}).join(" "),ie=Pe(J(ie)),ee("["+C+"] "+ie+" d"),this};var Fa=w.__private__.getLineHeight=w.getLineHeight=function(){return nt*Uo};w.__private__.getLineHeight=w.getLineHeight=function(){return nt*Uo};var In=w.__private__.setLineHeightFactor=w.setLineHeightFactor=function(C){return typeof(C=C||1.15)=="number"&&(Uo=C),this},ja=w.__private__.getLineHeightFactor=w.getLineHeightFactor=function(){return Uo};In(e.lineHeight);var dn=w.__private__.getHorizontalCoordinate=function(C){return J(C)},br=w.__private__.getVerticalCoordinate=function(C){return se===Z.ADVANCED?C:Ut[ne].mediaBox.topRightY-Ut[ne].mediaBox.bottomLeftY-J(C)},qo=w.__private__.getHorizontalCoordinateString=w.getHorizontalCoordinateString=function(C){return Pe(dn(C))},bo=w.__private__.getVerticalCoordinateString=w.getVerticalCoordinateString=function(C){return Pe(br(C))},Er=e.strokeColor||"0 G";w.__private__.getStrokeColor=w.getDrawColor=function(){return lr(Er)},w.__private__.setStrokeColor=w.setDrawColor=function(C,ie,De,We){return Er=_r({ch1:C,ch2:ie,ch3:De,ch4:We,pdfColorType:"draw",precision:2}),ee(Er),this};var za=e.fillColor||"0 g";w.__private__.getFillColor=w.getFillColor=function(){return lr(za)},w.__private__.setFillColor=w.setFillColor=function(C,ie,De,We){return za=_r({ch1:C,ch2:ie,ch3:De,ch4:We,pdfColorType:"fill",precision:2}),ee(za),this};var Ds=e.textColor||"0 g",pa=w.__private__.getTextColor=w.getTextColor=function(){return lr(Ds)};w.__private__.setTextColor=w.setTextColor=function(C,ie,De,We){return Ds=_r({ch1:C,ch2:ie,ch3:De,ch4:We,pdfColorType:"text",precision:3}),this};var ga=e.charSpace,Yr=w.__private__.getCharSpace=w.getCharSpace=function(){return parseFloat(ga||0)};w.__private__.setCharSpace=w.setCharSpace=function(C){if(isNaN(C))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return ga=C,this};var ma=0;w.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},w.__private__.setLineCap=w.setLineCap=function(C){var ie=w.CapJoinStyles[C];if(ie===void 0)throw new Error("Line cap style of '"+C+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return ma=ie,ee(ie+" J"),this};var qi=0;w.__private__.setLineJoin=w.setLineJoin=function(C){var ie=w.CapJoinStyles[C];if(ie===void 0)throw new Error("Line join style of '"+C+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return qi=ie,ee(ie+" j"),this},w.__private__.setLineMiterLimit=w.__private__.setMiterLimit=w.setLineMiterLimit=w.setMiterLimit=function(C){if(C=C||0,isNaN(C))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return ee(Pe(J(C))+" M"),this},w.GState=zh,w.setGState=function(C){(C=typeof C=="string"?Hn[Ui[C]]:al(null,C)).equals(Oi)||(ee("/"+C.id+" gs"),Oi=C)};var al=function(C,ie){if(!C||!Ui[C]){var De=!1;for(var We in Hn)if(Hn.hasOwnProperty(We)&&Hn[We].equals(ie)){De=!0;break}if(De)ie=Hn[We];else{var ut="GS"+(Object.keys(Hn).length+1).toString(10);Hn[ut]=ie,ie.id=ut}return C&&(Ui[C]=ie.id),An.publish("addGState",ie),ie}};w.addGState=function(C,ie){return al(C,ie),this},w.saveGraphicsState=function(){return ee("q"),Gn.push({key:Et,size:nt,color:Ds}),this},w.restoreGraphicsState=function(){ee("Q");var C=Gn.pop();return Et=C.key,nt=C.size,Ds=C.color,Oi=null,this},w.setCurrentTransformationMatrix=function(C){return ee(C.toString()+" cm"),this},w.comment=function(C){return ee("#"+C),this};var Vo=function(C,ie){var De=C||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return De},set:function(wt){isNaN(wt)||(De=parseFloat(wt))}});var We=ie||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return We},set:function(wt){isNaN(wt)||(We=parseFloat(wt))}});var ut="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return ut},set:function(wt){ut=wt.toString()}}),this},Jr=function(C,ie,De,We){Vo.call(this,C,ie),this.type="rect";var ut=De||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return ut},set:function(zt){isNaN(zt)||(ut=parseFloat(zt))}});var wt=We||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return wt},set:function(zt){isNaN(zt)||(wt=parseFloat(zt))}}),this},va=function(){this.page=zn,this.currentPage=ne,this.pages=ue.slice(0),this.pagesContext=Ut.slice(0),this.x=et,this.y=ot,this.matrix=wn,this.width=wo(ne),this.height=xo(ne),this.outputDestination=K,this.id="",this.objectNumber=-1};va.prototype.restore=function(){zn=this.page,ne=this.currentPage,Ut=this.pagesContext,ue=this.pages,et=this.x,ot=this.y,wn=this.matrix,Go(ne,this.width),Bi(ne,this.height),K=this.outputDestination};var Ua=function(C,ie,De,We,ut){pi.push(new va),zn=ne=0,ue=[],et=C,ot=ie,wn=ut,Qn([De,We])},$a=function(C){if(wi[C])pi.pop().restore();else{var ie=new va,De="Xo"+(Object.keys(Yn).length+1).toString(10);ie.id=De,wi[C]=De,Yn[De]=ie,An.publish("addFormObject",ie),pi.pop().restore()}};for(var ya in w.beginFormObject=function(C,ie,De,We,ut){return Ua(C,ie,De,We,ut),this},w.endFormObject=function(C){return $a(C),this},w.doFormObject=function(C,ie){var De=Yn[wi[C]];return ee("q"),ee(ie.toString()+" cm"),ee("/"+De.id+" Do"),ee("Q"),this},w.getFormObject=function(C){var ie=Yn[wi[C]];return{x:ie.x,y:ie.y,width:ie.width,height:ie.height,matrix:ie.matrix}},w.save=function(C,ie){return C=C||"generated.pdf",(ie=ie||{}).returnPromise=ie.returnPromise||!1,ie.returnPromise===!1?(Yl(Xs(ms()),C),typeof Yl.unload=="function"&&kn.setTimeout&&setTimeout(Yl.unload,911),this):new Promise(function(De,We){try{var ut=Yl(Xs(ms()),C);typeof Yl.unload=="function"&&kn.setTimeout&&setTimeout(Yl.unload,911),De(ut)}catch(wt){We(wt.message)}})},Cn.API)Cn.API.hasOwnProperty(ya)&&(ya==="events"&&Cn.API.events.length?function(C,ie){var De,We,ut;for(ut=ie.length-1;ut!==-1;ut--)De=ie[ut][0],We=ie[ut][1],C.subscribe.apply(C,[De].concat(typeof We=="function"?[We]:We))}(An,Cn.API.events):w[ya]=Cn.API[ya]);var wo=w.getPageWidth=function(C){return(Ut[C=C||ne].mediaBox.topRightX-Ut[C].mediaBox.bottomLeftX)/At},Go=w.setPageWidth=function(C,ie){Ut[C].mediaBox.topRightX=ie*At+Ut[C].mediaBox.bottomLeftX},xo=w.getPageHeight=function(C){return(Ut[C=C||ne].mediaBox.topRightY-Ut[C].mediaBox.bottomLeftY)/At},Bi=w.setPageHeight=function(C,ie){Ut[C].mediaBox.topRightY=ie*At+Ut[C].mediaBox.bottomLeftY};return w.internal={pdfEscape:Vn,getStyle:Oa,getFont:ol,getFontSize:Ct,getCharSpace:Yr,getTextColor:pa,getLineHeight:Fa,getLineHeightFactor:ja,getLineWidth:_o,write:Ge,getHorizontalCoordinate:dn,getVerticalCoordinate:br,getCoordinateString:qo,getVerticalCoordinateString:bo,collections:{},newObject:Rn,newAdditionalObject:Ii,newObjectDeferred:_t,newObjectDeferredBegin:Xn,getFilters:Ki,putStream:ur,events:An,scaleFactor:At,pageSize:{getWidth:function(){return wo(ne)},setWidth:function(C){Go(ne,C)},getHeight:function(){return xo(ne)},setHeight:function(C){Bi(ne,C)}},encryptionOptions:_,encryption:$i,getEncryptor:sl,output:vo,getNumberOfPages:_i,pages:ue,out:ee,f2:ze,f3:te,getPageInfo:ha,getPageInfoByObjId:Pn,getCurrentPageInfo:Sn,getPDFVersion:z,Point:Vo,Rectangle:Jr,Matrix:sn,hasHotfix:ca},Object.defineProperty(w.internal.pageSize,"width",{get:function(){return wo(ne)},set:function(C){Go(ne,C)},enumerable:!0,configurable:!0}),Object.defineProperty(w.internal.pageSize,"height",{get:function(){return xo(ne)},set:function(C){Bi(ne,C)},enumerable:!0,configurable:!0}),xn.call(w,Ue),Et="F1",ci(o,n),An.publish("initialized"),w}Au.prototype.lsbFirstWord=function(e){return String.fromCharCode(e>>0&255,e>>8&255,e>>16&255,e>>24&255)},Au.prototype.toHexString=function(e){return e.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Au.prototype.hexToBytes=function(e){for(var t=[],n=0;n<e.length;n+=2)t.push(String.fromCharCode(parseInt(e.substr(n,2),16)));return t.join("")},Au.prototype.processOwnerPassword=function(e,t){return If(Of(t).substr(0,5),e)},Au.prototype.encryptor=function(e,t){var n=Of(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&t,t>>8&255)).substr(0,10);return function(i){return If(n,i)}},zh.prototype.equals=function(e){var t,n="id,objectNumber,equals";if(!e||yi(e)!==yi(this))return!1;var i=0;for(t in this)if(!(n.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!e.hasOwnProperty(t)||this[t]!==e[t])return!1;i++}for(t in e)e.hasOwnProperty(t)&&n.indexOf(t)<0&&i--;return i===0},Cn.API={events:[]},Cn.version="3.0.0";var Xi=Cn.API,fp=1,hu=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Lu=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Mn=function(e){return e.toFixed(2)},wl=function(e){return e.toFixed(5)};Xi.__acroform__={};var Ws=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},fg=function(e){return e*fp},Pa=function(e){var t=new nv,n=on.internal.getHeight(e)||0,i=on.internal.getWidth(e)||0;return t.BBox=[0,0,Number(Mn(i)),Number(Mn(n))],t},kC=Xi.__acroform__.setBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|=1<<t},SC=Xi.__acroform__.clearBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&=~(1<<t)},EC=Xi.__acroform__.getBit=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return e&1<<t?1:0},nr=Xi.__acroform__.getBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return EC(e,t-1)},ir=Xi.__acroform__.setBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return kC(e,t-1)},rr=Xi.__acroform__.clearBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return SC(e,t-1)},AC=Xi.__acroform__.calculateCoordinates=function(e,t){var n=t.internal.getHorizontalCoordinate,i=t.internal.getVerticalCoordinate,o=e[0],a=e[1],u=e[2],d=e[3],f={};return f.lowerLeft_X=n(o)||0,f.lowerLeft_Y=i(a+d)||0,f.upperRight_X=n(o+u)||0,f.upperRight_Y=i(a)||0,[Number(Mn(f.lowerLeft_X)),Number(Mn(f.lowerLeft_Y)),Number(Mn(f.upperRight_X)),Number(Mn(f.upperRight_Y))]},MC=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var t=[],n=e._V||e.DV,i=Ff(e,n),o=e.scope.internal.getFont(e.fontName,e.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(e.scope.__private__.encodeColorString(e.color)),t.push("/"+o+" "+Mn(i.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(i.text),t.push("ET"),t.push("Q"),t.push("EMC");var a=Pa(e);return a.scope=e.scope,a.stream=t.join(`
`),a}},Ff=function(e,t){var n=e.fontSize===0?e.maxFontSize:e.fontSize,i={text:"",fontSize:""},o=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");o=e.multiline?o.map(function(te){return te.split(`
`)}):o.map(function(te){return[te]});var a=n,u=on.internal.getHeight(e)||0;u=u<0?-u:u;var d=on.internal.getWidth(e)||0;d=d<0?-d:d;var f=function(te,J,Ee){if(te+1<o.length){var he=J+" "+o[te+1][0];return sh(he,e,Ee).width<=d-4}return!1};a++;e:for(;a>0;){t="",a--;var v,_,x=sh("3",e,a).height,k=e.multiline?u-a:(u-x)/2,w=k+=2,N=0,z=0,W=0;if(a<=0){t=`(...) Tj
`,t+="% Width of Text: "+sh(t,e,a=12).width+", FieldWidth:"+d+`
`;break}for(var O="",Z=0,se=0;se<o.length;se++)if(o.hasOwnProperty(se)){var Se=!1;if(o[se].length!==1&&W!==o[se].length-1){if((x+2)*(Z+2)+2>u)continue e;O+=o[se][W],Se=!0,z=se,se--}else{O=(O+=o[se][W]+" ").substr(O.length-1)==" "?O.substr(0,O.length-1):O;var Ne=parseInt(se),$e=f(Ne,O,a),Pe=se>=o.length-1;if($e&&!Pe){O+=" ",W=0;continue}if($e||Pe){if(Pe)z=Ne;else if(e.multiline&&(x+2)*(Z+2)+2>u)continue e}else{if(!e.multiline||(x+2)*(Z+2)+2>u)continue e;z=Ne}}for(var xe="",Be=N;Be<=z;Be++){var ze=o[Be];if(e.multiline){if(Be===z){xe+=ze[W]+" ",W=(W+1)%ze.length;continue}if(Be===N){xe+=ze[ze.length-1]+" ";continue}}xe+=ze[0]+" "}switch(xe=xe.substr(xe.length-1)==" "?xe.substr(0,xe.length-1):xe,_=sh(xe,e,a).width,e.textAlign){case"right":v=d-_-2;break;case"center":v=(d-_)/2;break;case"left":default:v=2}t+=Mn(v)+" "+Mn(w)+` Td
`,t+="("+hu(xe)+`) Tj
`,t+=-Mn(v)+` 0 Td
`,w=-(a+2),_=0,N=Se?z:z+1,Z++,O=""}break}return i.text=t,i.fontSize=a,i},sh=function(e,t,n){var i=t.scope.internal.getFont(t.fontName,t.fontStyle),o=t.scope.getStringUnitWidth(e,{font:i,fontSize:parseFloat(n),charSpace:0})*parseFloat(n);return{height:t.scope.getStringUnitWidth("3",{font:i,fontSize:parseFloat(n),charSpace:0})*parseFloat(n)*1.5,width:o}},BC={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},TC=function(e,t){var n={type:"reference",object:e};t.internal.getPageInfo(e.page).pageContext.annotations.find(function(i){return i.type===n.type&&i.object===n.object})===void 0&&t.internal.getPageInfo(e.page).pageContext.annotations.push(n)},NC=function(e,t){for(var n in e)if(e.hasOwnProperty(n)){var i=n,o=e[n];t.internal.newObjectDeferredBegin(o.objId,!0),yi(o)==="object"&&typeof o.putStream=="function"&&o.putStream(),delete e[i]}},DC=function(e,t){if(t.scope=e,e.internal!==void 0&&(e.internal.acroformPlugin===void 0||e.internal.acroformPlugin.isInitialized===!1)){if(sa.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(BC)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");fp=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new iv,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){(function(n){n.internal.events.unsubscribe(n.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete n.internal.acroformPlugin.acroFormDictionaryRoot._eventID,n.internal.acroformPlugin.printedOut=!0})(e)}),e.internal.events.subscribe("buildDocument",function(){(function(n){n.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var i=n.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];a.objId=void 0,a.hasAnnotation&&TC(a,n)}})(e)}),e.internal.events.subscribe("putCatalog",function(){(function(n){if(n.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");n.internal.write("/AcroForm "+n.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(e)}),e.internal.events.subscribe("postPutPages",function(n){(function(i,o){var a=!i;for(var u in i||(o.internal.newObjectDeferredBegin(o.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),o.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),i=i||o.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(i.hasOwnProperty(u)){var d=i[u],f=[],v=d.Rect;if(d.Rect&&(d.Rect=AC(d.Rect,o)),o.internal.newObjectDeferredBegin(d.objId,!0),d.DA=on.createDefaultAppearanceStream(d),yi(d)==="object"&&typeof d.getKeyValueListForStream=="function"&&(f=d.getKeyValueListForStream()),d.Rect=v,d.hasAppearanceStream&&!d.appearanceStreamContent){var _=MC(d);f.push({key:"AP",value:"<</N "+_+">>"}),o.internal.acroformPlugin.xForms.push(_)}if(d.appearanceStreamContent){var x="";for(var k in d.appearanceStreamContent)if(d.appearanceStreamContent.hasOwnProperty(k)){var w=d.appearanceStreamContent[k];if(x+="/"+k+" ",x+="<<",Object.keys(w).length>=1||Array.isArray(w)){for(var u in w)if(w.hasOwnProperty(u)){var N=w[u];typeof N=="function"&&(N=N.call(o,d)),x+="/"+u+" "+N+" ",o.internal.acroformPlugin.xForms.indexOf(N)>=0||o.internal.acroformPlugin.xForms.push(N)}}else typeof(N=w)=="function"&&(N=N.call(o,d)),x+="/"+u+" "+N,o.internal.acroformPlugin.xForms.indexOf(N)>=0||o.internal.acroformPlugin.xForms.push(N);x+=">>"}f.push({key:"AP",value:`<<
`+x+">>"})}o.internal.putStream({additionalKeyValues:f,objectId:d.objId}),o.internal.out("endobj")}a&&NC(o.internal.acroformPlugin.xForms,o)})(n,e)}),e.internal.acroformPlugin.isInitialized=!0}},tv=Xi.__acroform__.arrayToPdfArray=function(e,t,n){var i=function(u){return u};if(Array.isArray(e)){for(var o="[",a=0;a<e.length;a++)switch(a!==0&&(o+=" "),yi(e[a])){case"boolean":case"number":case"object":o+=e[a].toString();break;case"string":e[a].substr(0,1)!=="/"?(t!==void 0&&n&&(i=n.internal.getEncryptor(t)),o+="("+hu(i(e[a].toString()))+")"):o+=e[a].toString()}return o+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},Xd=function(e,t,n){var i=function(o){return o};return t!==void 0&&n&&(i=n.internal.getEncryptor(t)),(e=e||"").toString(),e="("+hu(i(e))+")"},Ea=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Ea.prototype.toString=function(){return this.objId+" 0 R"},Ea.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},Ea.prototype.getKeyValueListForStream=function(){var e=[],t=Object.getOwnPropertyNames(this).filter(function(a){return a!="content"&&a!="appearanceStreamContent"&&a!="scope"&&a!="objId"&&a.substring(0,1)!="_"});for(var n in t)if(Object.getOwnPropertyDescriptor(this,t[n]).configurable===!1){var i=t[n],o=this[i];o&&(Array.isArray(o)?e.push({key:i,value:tv(o,this.objId,this.scope)}):o instanceof Ea?(o.scope=this.scope,e.push({key:i,value:o.objId+" 0 R"})):typeof o!="function"&&e.push({key:i,value:o}))}return e};var nv=function(){Ea.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(n){t=n}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(n){e=n.trim()},get:function(){return e||null}})};Ws(nv,Ea);var iv=function(){Ea.call(this);var e,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var n=function(i){return i};return this.scope&&(n=this.scope.internal.getEncryptor(this.objId)),"("+hu(n(e))+")"}},set:function(n){e=n}})};Ws(iv,Ea);var sa=function e(){Ea.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(O){if(isNaN(O))throw new Error('Invalid value "'+O+'" for attribute F supplied.');t=O}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!nr(t,3)},set:function(O){O?this.F=ir(t,3):this.F=rr(t,3)}});var n=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return n},set:function(O){if(isNaN(O))throw new Error('Invalid value "'+O+'" for attribute Ff supplied.');n=O}});var i=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(i.length!==0)return i},set:function(O){i=O!==void 0?O:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[0])?0:i[0]},set:function(O){i[0]=O}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[1])?0:i[1]},set:function(O){i[1]=O}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[2])?0:i[2]},set:function(O){i[2]=O}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[3])?0:i[3]},set:function(O){i[3]=O}});var o="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return o},set:function(O){switch(O){case"/Btn":case"/Tx":case"/Ch":case"/Sig":o=O;break;default:throw new Error('Invalid value "'+O+'" for attribute FT supplied.')}}});var a=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!a||a.length<1){if(this instanceof Uh)return;a="FieldObject"+e.FieldNum++}var O=function(Z){return Z};return this.scope&&(O=this.scope.internal.getEncryptor(this.objId)),"("+hu(O(a))+")"},set:function(O){a=O.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return a},set:function(O){a=O}});var u="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return u},set:function(O){u=O}});var d="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return d},set:function(O){d=O}});var f=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return f},set:function(O){f=O}});var v=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return v===void 0?50/fp:v},set:function(O){v=O}});var _="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return _},set:function(O){_=O}});var x="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!x||this instanceof Uh||this instanceof su))return Xd(x,this.objId,this.scope)},set:function(O){O=O.toString(),x=O}});var k=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(k)return this instanceof Or?k:Xd(k,this.objId,this.scope)},set:function(O){O=O.toString(),k=this instanceof Or?O:O.substr(0,1)==="("?Lu(O.substr(1,O.length-2)):Lu(O)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Or?Lu(k.substr(1,k.length-1)):k},set:function(O){O=O.toString(),k=this instanceof Or?"/"+O:O}});var w=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(w)return w},set:function(O){this.V=O}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(w)return this instanceof Or?w:Xd(w,this.objId,this.scope)},set:function(O){O=O.toString(),w=this instanceof Or?O:O.substr(0,1)==="("?Lu(O.substr(1,O.length-2)):Lu(O)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Or?Lu(w.substr(1,w.length-1)):w},set:function(O){O=O.toString(),w=this instanceof Or?"/"+O:O}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var N,z=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return z},set:function(O){O=!!O,z=O}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(N)return N},set:function(O){N=O}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!nr(this.Ff,1)},set:function(O){O?this.Ff=ir(this.Ff,1):this.Ff=rr(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!nr(this.Ff,2)},set:function(O){O?this.Ff=ir(this.Ff,2):this.Ff=rr(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!nr(this.Ff,3)},set:function(O){O?this.Ff=ir(this.Ff,3):this.Ff=rr(this.Ff,3)}});var W=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(W!==null)return W},set:function(O){if([0,1,2].indexOf(O)===-1)throw new Error('Invalid value "'+O+'" for attribute Q supplied.');W=O}}),Object.defineProperty(this,"textAlign",{get:function(){var O;switch(W){case 0:default:O="left";break;case 1:O="center";break;case 2:O="right"}return O},configurable:!0,enumerable:!0,set:function(O){switch(O){case"right":case 2:W=2;break;case"center":case 1:W=1;break;case"left":case 0:default:W=0}}})};Ws(sa,Ea);var Ou=function(){sa.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(n){e=n}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(n){e=n}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return tv(t,this.objId,this.scope)},set:function(n){var i,o;o=[],typeof(i=n)=="string"&&(o=function(a,u,d){d||(d=1);for(var f,v=[];f=u.exec(a);)v.push(f[d]);return v}(i,/\((.*?)\)/g)),t=o}}),this.getOptions=function(){return t},this.setOptions=function(n){t=n,this.sort&&t.sort()},this.addOption=function(n){n=(n=n||"").toString(),t.push(n),this.sort&&t.sort()},this.removeOption=function(n,i){for(i=i||!1,n=(n=n||"").toString();t.indexOf(n)!==-1&&(t.splice(t.indexOf(n),1),i!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!nr(this.Ff,18)},set:function(n){n?this.Ff=ir(this.Ff,18):this.Ff=rr(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!nr(this.Ff,19)},set:function(n){this.combo===!0&&(n?this.Ff=ir(this.Ff,19):this.Ff=rr(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!nr(this.Ff,20)},set:function(n){n?(this.Ff=ir(this.Ff,20),t.sort()):this.Ff=rr(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!nr(this.Ff,22)},set:function(n){n?this.Ff=ir(this.Ff,22):this.Ff=rr(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!nr(this.Ff,23)},set:function(n){n?this.Ff=ir(this.Ff,23):this.Ff=rr(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!nr(this.Ff,27)},set:function(n){n?this.Ff=ir(this.Ff,27):this.Ff=rr(this.Ff,27)}}),this.hasAppearanceStream=!1};Ws(Ou,sa);var Iu=function(){Ou.call(this),this.fontName="helvetica",this.combo=!1};Ws(Iu,Ou);var Fu=function(){Iu.call(this),this.combo=!0};Ws(Fu,Iu);var bh=function(){Fu.call(this),this.edit=!0};Ws(bh,Fu);var Or=function(){sa.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!nr(this.Ff,15)},set:function(n){n?this.Ff=ir(this.Ff,15):this.Ff=rr(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!nr(this.Ff,16)},set:function(n){n?this.Ff=ir(this.Ff,16):this.Ff=rr(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!nr(this.Ff,17)},set:function(n){n?this.Ff=ir(this.Ff,17):this.Ff=rr(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!nr(this.Ff,26)},set:function(n){n?this.Ff=ir(this.Ff,26):this.Ff=rr(this.Ff,26)}});var e,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var n=function(a){return a};if(this.scope&&(n=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var i,o=[];for(i in o.push("<<"),t)o.push("/"+i+" ("+hu(n(t[i]))+")");return o.push(">>"),o.join(`
`)}},set:function(n){yi(n)==="object"&&(t=n)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(n){typeof n=="string"&&(t.CA=n)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(n){e=n}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(n){e="/"+n}})};Ws(Or,sa);var wh=function(){Or.call(this),this.pushButton=!0};Ws(wh,Or);var ju=function(){Or.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t!==void 0?t:[]}})};Ws(ju,Or);var Uh=function(){var e,t;sa.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(o){e=o}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(o){t=o}});var n,i={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var o=function(d){return d};this.scope&&(o=this.scope.internal.getEncryptor(this.objId));var a,u=[];for(a in u.push("<<"),i)u.push("/"+a+" ("+hu(o(i[a]))+")");return u.push(">>"),u.join(`
`)},set:function(o){yi(o)==="object"&&(i=o)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return i.CA||""},set:function(o){typeof o=="string"&&(i.CA=o)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return n},set:function(o){n=o}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return n.substr(1,n.length-1)},set:function(o){n="/"+o}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=on.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Ws(Uh,sa),ju.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var n=this.Kids[t];n.appearanceStreamContent=e.createAppearanceStream(n.optionName),n.caption=e.getCA()}},ju.prototype.createOption=function(e){var t=new Uh;return t.Parent=this,t.optionName=e,this.Kids.push(t),RC.call(this.scope,t),t};var xh=function(){Or.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=on.CheckBox.createAppearanceStream()};Ws(xh,Or);var su=function(){sa.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!nr(this.Ff,13)},set:function(t){t?this.Ff=ir(this.Ff,13):this.Ff=rr(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!nr(this.Ff,21)},set:function(t){t?this.Ff=ir(this.Ff,21):this.Ff=rr(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!nr(this.Ff,23)},set:function(t){t?this.Ff=ir(this.Ff,23):this.Ff=rr(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!nr(this.Ff,24)},set:function(t){t?this.Ff=ir(this.Ff,24):this.Ff=rr(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!nr(this.Ff,25)},set:function(t){t?this.Ff=ir(this.Ff,25):this.Ff=rr(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!nr(this.Ff,26)},set:function(t){t?this.Ff=ir(this.Ff,26):this.Ff=rr(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){Number.isInteger(t)&&(e=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Ws(su,sa);var Lh=function(){su.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!nr(this.Ff,14)},set:function(e){e?this.Ff=ir(this.Ff,14):this.Ff=rr(this.Ff,14)}}),this.password=!0};Ws(Lh,su);var on={CheckBox:{createAppearanceStream:function(){return{N:{On:on.CheckBox.YesNormal},D:{On:on.CheckBox.YesPushDown,Off:on.CheckBox.OffPushDown}}},YesPushDown:function(e){var t=Pa(e);t.scope=e.scope;var n=[],i=e.scope.internal.getFont(e.fontName,e.fontStyle).id,o=e.scope.__private__.encodeColorString(e.color),a=Ff(e,e.caption);return n.push("0.749023 g"),n.push("0 0 "+Mn(on.internal.getWidth(e))+" "+Mn(on.internal.getHeight(e))+" re"),n.push("f"),n.push("BMC"),n.push("q"),n.push("0 0 1 rg"),n.push("/"+i+" "+Mn(a.fontSize)+" Tf "+o),n.push("BT"),n.push(a.text),n.push("ET"),n.push("Q"),n.push("EMC"),t.stream=n.join(`
`),t},YesNormal:function(e){var t=Pa(e);t.scope=e.scope;var n=e.scope.internal.getFont(e.fontName,e.fontStyle).id,i=e.scope.__private__.encodeColorString(e.color),o=[],a=on.internal.getHeight(e),u=on.internal.getWidth(e),d=Ff(e,e.caption);return o.push("1 g"),o.push("0 0 "+Mn(u)+" "+Mn(a)+" re"),o.push("f"),o.push("q"),o.push("0 0 1 rg"),o.push("0 0 "+Mn(u-1)+" "+Mn(a-1)+" re"),o.push("W"),o.push("n"),o.push("0 g"),o.push("BT"),o.push("/"+n+" "+Mn(d.fontSize)+" Tf "+i),o.push(d.text),o.push("ET"),o.push("Q"),t.stream=o.join(`
`),t},OffPushDown:function(e){var t=Pa(e);t.scope=e.scope;var n=[];return n.push("0.749023 g"),n.push("0 0 "+Mn(on.internal.getWidth(e))+" "+Mn(on.internal.getHeight(e))+" re"),n.push("f"),t.stream=n.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(e){var t={D:{Off:on.RadioButton.Circle.OffPushDown},N:{}};return t.N[e]=on.RadioButton.Circle.YesNormal,t.D[e]=on.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(e){var t=Pa(e);t.scope=e.scope;var n=[],i=on.internal.getWidth(e)<=on.internal.getHeight(e)?on.internal.getWidth(e)/4:on.internal.getHeight(e)/4;i=Number((.9*i).toFixed(5));var o=on.internal.Bezier_C,a=Number((i*o).toFixed(5));return n.push("q"),n.push("1 0 0 1 "+wl(on.internal.getWidth(e)/2)+" "+wl(on.internal.getHeight(e)/2)+" cm"),n.push(i+" 0 m"),n.push(i+" "+a+" "+a+" "+i+" 0 "+i+" c"),n.push("-"+a+" "+i+" -"+i+" "+a+" -"+i+" 0 c"),n.push("-"+i+" -"+a+" -"+a+" -"+i+" 0 -"+i+" c"),n.push(a+" -"+i+" "+i+" -"+a+" "+i+" 0 c"),n.push("f"),n.push("Q"),t.stream=n.join(`
`),t},YesPushDown:function(e){var t=Pa(e);t.scope=e.scope;var n=[],i=on.internal.getWidth(e)<=on.internal.getHeight(e)?on.internal.getWidth(e)/4:on.internal.getHeight(e)/4;i=Number((.9*i).toFixed(5));var o=Number((2*i).toFixed(5)),a=Number((o*on.internal.Bezier_C).toFixed(5)),u=Number((i*on.internal.Bezier_C).toFixed(5));return n.push("0.749023 g"),n.push("q"),n.push("1 0 0 1 "+wl(on.internal.getWidth(e)/2)+" "+wl(on.internal.getHeight(e)/2)+" cm"),n.push(o+" 0 m"),n.push(o+" "+a+" "+a+" "+o+" 0 "+o+" c"),n.push("-"+a+" "+o+" -"+o+" "+a+" -"+o+" 0 c"),n.push("-"+o+" -"+a+" -"+a+" -"+o+" 0 -"+o+" c"),n.push(a+" -"+o+" "+o+" -"+a+" "+o+" 0 c"),n.push("f"),n.push("Q"),n.push("0 g"),n.push("q"),n.push("1 0 0 1 "+wl(on.internal.getWidth(e)/2)+" "+wl(on.internal.getHeight(e)/2)+" cm"),n.push(i+" 0 m"),n.push(i+" "+u+" "+u+" "+i+" 0 "+i+" c"),n.push("-"+u+" "+i+" -"+i+" "+u+" -"+i+" 0 c"),n.push("-"+i+" -"+u+" -"+u+" -"+i+" 0 -"+i+" c"),n.push(u+" -"+i+" "+i+" -"+u+" "+i+" 0 c"),n.push("f"),n.push("Q"),t.stream=n.join(`
`),t},OffPushDown:function(e){var t=Pa(e);t.scope=e.scope;var n=[],i=on.internal.getWidth(e)<=on.internal.getHeight(e)?on.internal.getWidth(e)/4:on.internal.getHeight(e)/4;i=Number((.9*i).toFixed(5));var o=Number((2*i).toFixed(5)),a=Number((o*on.internal.Bezier_C).toFixed(5));return n.push("0.749023 g"),n.push("q"),n.push("1 0 0 1 "+wl(on.internal.getWidth(e)/2)+" "+wl(on.internal.getHeight(e)/2)+" cm"),n.push(o+" 0 m"),n.push(o+" "+a+" "+a+" "+o+" 0 "+o+" c"),n.push("-"+a+" "+o+" -"+o+" "+a+" -"+o+" 0 c"),n.push("-"+o+" -"+a+" -"+a+" -"+o+" 0 -"+o+" c"),n.push(a+" -"+o+" "+o+" -"+a+" "+o+" 0 c"),n.push("f"),n.push("Q"),t.stream=n.join(`
`),t}},Cross:{createAppearanceStream:function(e){var t={D:{Off:on.RadioButton.Cross.OffPushDown},N:{}};return t.N[e]=on.RadioButton.Cross.YesNormal,t.D[e]=on.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(e){var t=Pa(e);t.scope=e.scope;var n=[],i=on.internal.calculateCross(e);return n.push("q"),n.push("1 1 "+Mn(on.internal.getWidth(e)-2)+" "+Mn(on.internal.getHeight(e)-2)+" re"),n.push("W"),n.push("n"),n.push(Mn(i.x1.x)+" "+Mn(i.x1.y)+" m"),n.push(Mn(i.x2.x)+" "+Mn(i.x2.y)+" l"),n.push(Mn(i.x4.x)+" "+Mn(i.x4.y)+" m"),n.push(Mn(i.x3.x)+" "+Mn(i.x3.y)+" l"),n.push("s"),n.push("Q"),t.stream=n.join(`
`),t},YesPushDown:function(e){var t=Pa(e);t.scope=e.scope;var n=on.internal.calculateCross(e),i=[];return i.push("0.749023 g"),i.push("0 0 "+Mn(on.internal.getWidth(e))+" "+Mn(on.internal.getHeight(e))+" re"),i.push("f"),i.push("q"),i.push("1 1 "+Mn(on.internal.getWidth(e)-2)+" "+Mn(on.internal.getHeight(e)-2)+" re"),i.push("W"),i.push("n"),i.push(Mn(n.x1.x)+" "+Mn(n.x1.y)+" m"),i.push(Mn(n.x2.x)+" "+Mn(n.x2.y)+" l"),i.push(Mn(n.x4.x)+" "+Mn(n.x4.y)+" m"),i.push(Mn(n.x3.x)+" "+Mn(n.x3.y)+" l"),i.push("s"),i.push("Q"),t.stream=i.join(`
`),t},OffPushDown:function(e){var t=Pa(e);t.scope=e.scope;var n=[];return n.push("0.749023 g"),n.push("0 0 "+Mn(on.internal.getWidth(e))+" "+Mn(on.internal.getHeight(e))+" re"),n.push("f"),t.stream=n.join(`
`),t}}},createDefaultAppearanceStream:function(e){var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,n=e.scope.__private__.encodeColorString(e.color);return"/"+t+" "+e.fontSize+" Tf "+n}};on.internal={Bezier_C:.551915024494,calculateCross:function(e){var t=on.internal.getWidth(e),n=on.internal.getHeight(e),i=Math.min(t,n);return{x1:{x:(t-i)/2,y:(n-i)/2+i},x2:{x:(t-i)/2+i,y:(n-i)/2},x3:{x:(t-i)/2,y:(n-i)/2},x4:{x:(t-i)/2+i,y:(n-i)/2+i}}}},on.internal.getWidth=function(e){var t=0;return yi(e)==="object"&&(t=fg(e.Rect[2])),t},on.internal.getHeight=function(e){var t=0;return yi(e)==="object"&&(t=fg(e.Rect[3])),t};var RC=Xi.addField=function(e){if(DC(this,e),!(e instanceof sa))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=e).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};Xi.AcroFormChoiceField=Ou,Xi.AcroFormListBox=Iu,Xi.AcroFormComboBox=Fu,Xi.AcroFormEditBox=bh,Xi.AcroFormButton=Or,Xi.AcroFormPushButton=wh,Xi.AcroFormRadioButton=ju,Xi.AcroFormCheckBox=xh,Xi.AcroFormTextField=su,Xi.AcroFormPasswordField=Lh,Xi.AcroFormAppearance=on,Xi.AcroForm={ChoiceField:Ou,ListBox:Iu,ComboBox:Fu,EditBox:bh,Button:Or,PushButton:wh,RadioButton:ju,CheckBox:xh,TextField:su,PasswordField:Lh,Appearance:on},Cn.AcroForm={ChoiceField:Ou,ListBox:Iu,ComboBox:Fu,EditBox:bh,Button:Or,PushButton:wh,RadioButton:ju,CheckBox:xh,TextField:su,PasswordField:Lh,Appearance:on};Cn.AcroForm;function rv(e){return e.reduce(function(t,n,i){return t[n]=i,t},{})}(function(e){e.__addimage__={};var t="UNKNOWN",n={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},i=e.__addimage__.getImageFileTypeByImageData=function(te,J){var Ee,he,P,F,G,Q=t;if((J=J||t)==="RGBA"||te.data!==void 0&&te.data instanceof Uint8ClampedArray&&"height"in te&&"width"in te)return"RGBA";if($e(te))for(G in n)for(P=n[G],Ee=0;Ee<P.length;Ee+=1){for(F=!0,he=0;he<P[Ee].length;he+=1)if(P[Ee][he]!==void 0&&P[Ee][he]!==te[he]){F=!1;break}if(F===!0){Q=G;break}}else for(G in n)for(P=n[G],Ee=0;Ee<P.length;Ee+=1){for(F=!0,he=0;he<P[Ee].length;he+=1)if(P[Ee][he]!==void 0&&P[Ee][he]!==te.charCodeAt(he)){F=!1;break}if(F===!0){Q=G;break}}return Q===t&&J!==t&&(Q=J),Q},o=function te(J){for(var Ee=this.internal.write,he=this.internal.putStream,P=(0,this.internal.getFilters)();P.indexOf("FlateEncode")!==-1;)P.splice(P.indexOf("FlateEncode"),1);J.objectId=this.internal.newObject();var F=[];if(F.push({key:"Type",value:"/XObject"}),F.push({key:"Subtype",value:"/Image"}),F.push({key:"Width",value:J.width}),F.push({key:"Height",value:J.height}),J.colorSpace===W.INDEXED?F.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(J.palette.length/3-1)+" "+("sMask"in J&&J.sMask!==void 0?J.objectId+2:J.objectId+1)+" 0 R]"}):(F.push({key:"ColorSpace",value:"/"+J.colorSpace}),J.colorSpace===W.DEVICE_CMYK&&F.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),F.push({key:"BitsPerComponent",value:J.bitsPerComponent}),"decodeParameters"in J&&J.decodeParameters!==void 0&&F.push({key:"DecodeParms",value:"<<"+J.decodeParameters+">>"}),"transparency"in J&&Array.isArray(J.transparency)){for(var G="",Q=0,Ae=J.transparency.length;Q<Ae;Q++)G+=J.transparency[Q]+" "+J.transparency[Q]+" ";F.push({key:"Mask",value:"["+G+"]"})}J.sMask!==void 0&&F.push({key:"SMask",value:J.objectId+1+" 0 R"});var oe=J.filter!==void 0?["/"+J.filter]:void 0;if(he({data:J.data,additionalKeyValues:F,alreadyAppliedFilters:oe,objectId:J.objectId}),Ee("endobj"),"sMask"in J&&J.sMask!==void 0){var me="/Predictor "+J.predictor+" /Colors 1 /BitsPerComponent "+J.bitsPerComponent+" /Columns "+J.width,T={width:J.width,height:J.height,colorSpace:"DeviceGray",bitsPerComponent:J.bitsPerComponent,decodeParameters:me,data:J.sMask};"filter"in J&&(T.filter=J.filter),te.call(this,T)}if(J.colorSpace===W.INDEXED){var ne=this.internal.newObject();he({data:xe(new Uint8Array(J.palette)),objectId:ne}),Ee("endobj")}},a=function(){var te=this.internal.collections.addImage_images;for(var J in te)o.call(this,te[J])},u=function(){var te,J=this.internal.collections.addImage_images,Ee=this.internal.write;for(var he in J)Ee("/I"+(te=J[he]).index,te.objectId,"0","R")},d=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",a),this.internal.events.subscribe("putXobjectDict",u))},f=function(){var te=this.internal.collections.addImage_images;return d.call(this),te},v=function(){return Object.keys(this.internal.collections.addImage_images).length},_=function(te){return typeof e["process"+te.toUpperCase()]=="function"},x=function(te){return yi(te)==="object"&&te.nodeType===1},k=function(te,J){if(te.nodeName==="IMG"&&te.hasAttribute("src")){var Ee=""+te.getAttribute("src");if(Ee.indexOf("data:image/")===0)return wc(unescape(Ee).split("base64,").pop());var he=e.loadFile(Ee,!0);if(he!==void 0)return he}if(te.nodeName==="CANVAS"){if(te.width===0||te.height===0)throw new Error("Given canvas must have data. Canvas width: "+te.width+", height: "+te.height);var P;switch(J){case"PNG":P="image/png";break;case"WEBP":P="image/webp";break;case"JPEG":case"JPG":default:P="image/jpeg"}return wc(te.toDataURL(P,1).split("base64,").pop())}},w=function(te){var J=this.internal.collections.addImage_images;if(J){for(var Ee in J)if(te===J[Ee].alias)return J[Ee]}},N=function(te,J,Ee){return te||J||(te=-96,J=-96),te<0&&(te=-1*Ee.width*72/te/this.internal.scaleFactor),J<0&&(J=-1*Ee.height*72/J/this.internal.scaleFactor),te===0&&(te=J*Ee.width/Ee.height),J===0&&(J=te*Ee.height/Ee.width),[te,J]},z=function(te,J,Ee,he,P,F){var G=N.call(this,Ee,he,P),Q=this.internal.getCoordinateString,Ae=this.internal.getVerticalCoordinateString,oe=f.call(this);if(Ee=G[0],he=G[1],oe[P.index]=P,F){F*=Math.PI/180;var me=Math.cos(F),T=Math.sin(F),ne=function(q){return q.toFixed(4)},ae=[ne(me),ne(T),ne(-1*T),ne(me),0,0,"cm"]}this.internal.write("q"),F?(this.internal.write([1,"0","0",1,Q(te),Ae(J+he),"cm"].join(" ")),this.internal.write(ae.join(" ")),this.internal.write([Q(Ee),"0","0",Q(he),"0","0","cm"].join(" "))):this.internal.write([Q(Ee),"0","0",Q(he),Q(te),Ae(J+he),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+P.index+" Do"),this.internal.write("Q")},W=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var O=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},Z=e.__addimage__.sHashCode=function(te){var J,Ee,he=0;if(typeof te=="string")for(Ee=te.length,J=0;J<Ee;J++)he=(he<<5)-he+te.charCodeAt(J),he|=0;else if($e(te))for(Ee=te.byteLength/2,J=0;J<Ee;J++)he=(he<<5)-he+te[J],he|=0;return he},se=e.__addimage__.validateStringAsBase64=function(te){(te=te||"").toString().trim();var J=!0;return te.length===0&&(J=!1),te.length%4!=0&&(J=!1),/^[A-Za-z0-9+/]+$/.test(te.substr(0,te.length-2))===!1&&(J=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(te.substr(-2))===!1&&(J=!1),J},Se=e.__addimage__.extractImageFromDataUrl=function(te){var J=(te=te||"").split("base64,"),Ee=null;if(J.length===2){var he=/^data:(\w*\/\w*);*(charset=(?!charset=)[\w=-]*)*;*$/.exec(J[0]);Array.isArray(he)&&(Ee={mimeType:he[1],charset:he[2],data:J[1]})}return Ee},Ne=e.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};e.__addimage__.isArrayBuffer=function(te){return Ne()&&te instanceof ArrayBuffer};var $e=e.__addimage__.isArrayBufferView=function(te){return Ne()&&typeof Uint32Array<"u"&&(te instanceof Int8Array||te instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&te instanceof Uint8ClampedArray||te instanceof Int16Array||te instanceof Uint16Array||te instanceof Int32Array||te instanceof Uint32Array||te instanceof Float32Array||te instanceof Float64Array)},Pe=e.__addimage__.binaryStringToUint8Array=function(te){for(var J=te.length,Ee=new Uint8Array(J),he=0;he<J;he++)Ee[he]=te.charCodeAt(he);return Ee},xe=e.__addimage__.arrayBufferToBinaryString=function(te){for(var J="",Ee=$e(te)?te:new Uint8Array(te),he=0;he<Ee.length;he+=8192)J+=String.fromCharCode.apply(null,Ee.subarray(he,he+8192));return J};e.addImage=function(){var te,J,Ee,he,P,F,G,Q,Ae;if(typeof arguments[1]=="number"?(J=t,Ee=arguments[1],he=arguments[2],P=arguments[3],F=arguments[4],G=arguments[5],Q=arguments[6],Ae=arguments[7]):(J=arguments[1],Ee=arguments[2],he=arguments[3],P=arguments[4],F=arguments[5],G=arguments[6],Q=arguments[7],Ae=arguments[8]),yi(te=arguments[0])==="object"&&!x(te)&&"imageData"in te){var oe=te;te=oe.imageData,J=oe.format||J||t,Ee=oe.x||Ee||0,he=oe.y||he||0,P=oe.w||oe.width||P,F=oe.h||oe.height||F,G=oe.alias||G,Q=oe.compression||Q,Ae=oe.rotation||oe.angle||Ae}var me=this.internal.getFilters();if(Q===void 0&&me.indexOf("FlateEncode")!==-1&&(Q="SLOW"),isNaN(Ee)||isNaN(he))throw new Error("Invalid coordinates passed to jsPDF.addImage");d.call(this);var T=Be.call(this,te,J,G,Q);return z.call(this,Ee,he,P,F,T,Ae),this};var Be=function(te,J,Ee,he){var P,F,G;if(typeof te=="string"&&i(te)===t){te=unescape(te);var Q=ze(te,!1);(Q!==""||(Q=e.loadFile(te,!0))!==void 0)&&(te=Q)}if(x(te)&&(te=k(te,J)),J=i(te,J),!_(J))throw new Error("addImage does not support files of type '"+J+"', please ensure that a plugin for '"+J+"' support is added.");if(((G=Ee)==null||G.length===0)&&(Ee=function(Ae){return typeof Ae=="string"||$e(Ae)?Z(Ae):$e(Ae.data)?Z(Ae.data):null}(te)),(P=w.call(this,Ee))||(Ne()&&(te instanceof Uint8Array||J==="RGBA"||(F=te,te=Pe(te))),P=this["process"+J.toUpperCase()](te,v.call(this),Ee,function(Ae){return Ae&&typeof Ae=="string"&&(Ae=Ae.toUpperCase()),Ae in e.image_compression?Ae:O.NONE}(he),F)),!P)throw new Error("An unknown error occurred whilst processing the image.");return P},ze=e.__addimage__.convertBase64ToBinaryString=function(te,J){var Ee;J=typeof J!="boolean"||J;var he,P="";if(typeof te=="string"){he=(Ee=Se(te))!==null?Ee.data:te;try{P=wc(he)}catch(F){if(J)throw se(he)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+F.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return P};e.getImageProperties=function(te){var J,Ee,he="";if(x(te)&&(te=k(te)),typeof te=="string"&&i(te)===t&&((he=ze(te,!1))===""&&(he=e.loadFile(te)||""),te=he),Ee=i(te),!_(Ee))throw new Error("addImage does not support files of type '"+Ee+"', please ensure that a plugin for '"+Ee+"' support is added.");if(!Ne()||te instanceof Uint8Array||(te=Pe(te)),!(J=this["process"+Ee.toUpperCase()](te)))throw new Error("An unknown error occurred whilst processing the image");return J.fileType=Ee,J}})(Cn.API),function(e){var t=function(n){if(n!==void 0&&n!="")return!0};Cn.API.events.push(["addPage",function(n){this.internal.getPageInfo(n.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(n){for(var i,o,a,u=this.internal.getCoordinateString,d=this.internal.getVerticalCoordinateString,f=this.internal.getPageInfoByObjId(n.objId),v=n.pageContext.annotations,_=!1,x=0;x<v.length&&!_;x++)switch((i=v[x]).type){case"link":(t(i.options.url)||t(i.options.pageNumber))&&(_=!0);break;case"reference":case"text":case"freetext":_=!0}if(_!=0){this.internal.write("/Annots [");for(var k=0;k<v.length;k++){i=v[k];var w=this.internal.pdfEscape,N=this.internal.getEncryptor(n.objId);switch(i.type){case"reference":this.internal.write(" "+i.object.objId+" 0 R ");break;case"text":var z=this.internal.newAdditionalObject(),W=this.internal.newAdditionalObject(),O=this.internal.getEncryptor(z.objId),Z=i.title||"Note";a="<</Type /Annot /Subtype /Text "+(o="/Rect ["+u(i.bounds.x)+" "+d(i.bounds.y+i.bounds.h)+" "+u(i.bounds.x+i.bounds.w)+" "+d(i.bounds.y)+"] ")+"/Contents ("+w(O(i.contents))+")",a+=" /Popup "+W.objId+" 0 R",a+=" /P "+f.objId+" 0 R",a+=" /T ("+w(O(Z))+") >>",z.content=a;var se=z.objId+" 0 R";a="<</Type /Annot /Subtype /Popup "+(o="/Rect ["+u(i.bounds.x+30)+" "+d(i.bounds.y+i.bounds.h)+" "+u(i.bounds.x+i.bounds.w+30)+" "+d(i.bounds.y)+"] ")+" /Parent "+se,i.open&&(a+=" /Open true"),a+=" >>",W.content=a,this.internal.write(z.objId,"0 R",W.objId,"0 R");break;case"freetext":o="/Rect ["+u(i.bounds.x)+" "+d(i.bounds.y)+" "+u(i.bounds.x+i.bounds.w)+" "+d(i.bounds.y+i.bounds.h)+"] ";var Se=i.color||"#000000";a="<</Type /Annot /Subtype /FreeText "+o+"/Contents ("+w(N(i.contents))+")",a+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+Se+")",a+=" /Border [0 0 0]",a+=" >>",this.internal.write(a);break;case"link":if(i.options.name){var Ne=this.annotations._nameMap[i.options.name];i.options.pageNumber=Ne.page,i.options.top=Ne.y}else i.options.top||(i.options.top=0);if(o="/Rect ["+i.finalBounds.x+" "+i.finalBounds.y+" "+i.finalBounds.w+" "+i.finalBounds.h+"] ",a="",i.options.url)a="<</Type /Annot /Subtype /Link "+o+"/Border [0 0 0] /A <</S /URI /URI ("+w(N(i.options.url))+") >>";else if(i.options.pageNumber)switch(a="<</Type /Annot /Subtype /Link "+o+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(i.options.pageNumber).objId+" 0 R",i.options.magFactor=i.options.magFactor||"XYZ",i.options.magFactor){case"Fit":a+=" /Fit]";break;case"FitH":a+=" /FitH "+i.options.top+"]";break;case"FitV":i.options.left=i.options.left||0,a+=" /FitV "+i.options.left+"]";break;case"XYZ":default:var $e=d(i.options.top);i.options.left=i.options.left||0,i.options.zoom===void 0&&(i.options.zoom=0),a+=" /XYZ "+i.options.left+" "+$e+" "+i.options.zoom+"]"}a!=""&&(a+=" >>",this.internal.write(a))}}this.internal.write("]")}}]),e.createAnnotation=function(n){var i=this.internal.getCurrentPageInfo();switch(n.type){case"link":this.link(n.bounds.x,n.bounds.y,n.bounds.w,n.bounds.h,n);break;case"text":case"freetext":i.pageContext.annotations.push(n)}},e.link=function(n,i,o,a,u){var d=this.internal.getCurrentPageInfo(),f=this.internal.getCoordinateString,v=this.internal.getVerticalCoordinateString;d.pageContext.annotations.push({finalBounds:{x:f(n),y:v(i),w:f(n+o),h:v(i+a)},options:u,type:"link"})},e.textWithLink=function(n,i,o,a){var u,d,f=this.getTextWidth(n),v=this.internal.getLineHeight()/this.internal.scaleFactor;if(a.maxWidth!==void 0){d=a.maxWidth;var _=this.splitTextToSize(n,d).length;u=Math.ceil(v*_)}else d=f,u=v;return this.text(n,i,o,a),o+=.2*v,a.align==="center"&&(i-=f/2),a.align==="right"&&(i-=f),this.link(i,o-v,d,u,a),f},e.getTextWidth=function(n){var i=this.internal.getFontSize();return this.getStringUnitWidth(n)*i/this.internal.scaleFactor}}(Cn.API),function(e){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},n={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},i={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},o=[1570,1571,1573,1575];e.__arabicParser__={};var a=e.__arabicParser__.isInArabicSubstitutionA=function(z){return t[z.charCodeAt(0)]!==void 0},u=e.__arabicParser__.isArabicLetter=function(z){return typeof z=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(z)},d=e.__arabicParser__.isArabicEndLetter=function(z){return u(z)&&a(z)&&t[z.charCodeAt(0)].length<=2},f=e.__arabicParser__.isArabicAlfLetter=function(z){return u(z)&&o.indexOf(z.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(z){return u(z)&&a(z)&&t[z.charCodeAt(0)].length>=1};var v=e.__arabicParser__.arabicLetterHasFinalForm=function(z){return u(z)&&a(z)&&t[z.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(z){return u(z)&&a(z)&&t[z.charCodeAt(0)].length>=3};var _=e.__arabicParser__.arabicLetterHasMedialForm=function(z){return u(z)&&a(z)&&t[z.charCodeAt(0)].length==4},x=e.__arabicParser__.resolveLigatures=function(z){var W=0,O=n,Z="",se=0;for(W=0;W<z.length;W+=1)O[z.charCodeAt(W)]!==void 0?(se++,typeof(O=O[z.charCodeAt(W)])=="number"&&(Z+=String.fromCharCode(O),O=n,se=0),W===z.length-1&&(O=n,Z+=z.charAt(W-(se-1)),W-=se-1,se=0)):(O=n,Z+=z.charAt(W-se),W-=se,se=0);return Z};e.__arabicParser__.isArabicDiacritic=function(z){return z!==void 0&&i[z.charCodeAt(0)]!==void 0};var k=e.__arabicParser__.getCorrectForm=function(z,W,O){return u(z)?a(z)===!1?-1:!v(z)||!u(W)&&!u(O)||!u(O)&&d(W)||d(z)&&!u(W)||d(z)&&f(W)||d(z)&&d(W)?0:_(z)&&u(W)&&!d(W)&&u(O)&&v(O)?3:d(z)||!u(O)?1:2:-1},w=function(z){var W=0,O=0,Z=0,se="",Se="",Ne="",$e=(z=z||"").split("\\s+"),Pe=[];for(W=0;W<$e.length;W+=1){for(Pe.push(""),O=0;O<$e[W].length;O+=1)se=$e[W][O],Se=$e[W][O-1],Ne=$e[W][O+1],u(se)?(Z=k(se,Se,Ne),Pe[W]+=Z!==-1?String.fromCharCode(t[se.charCodeAt(0)][Z]):se):Pe[W]+=se;Pe[W]=x(Pe[W])}return Pe.join(" ")},N=e.__arabicParser__.processArabic=e.processArabic=function(){var z,W=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,O=[];if(Array.isArray(W)){var Z=0;for(O=[],Z=0;Z<W.length;Z+=1)Array.isArray(W[Z])?O.push([w(W[Z][0]),W[Z][1],W[Z][2]]):O.push([w(W[Z])]);z=O}else z=w(W);return typeof arguments[0]=="string"?z:(arguments[0].text=z,arguments[0])};e.events.push(["preProcessText",N])}(Cn.API),Cn.API.autoPrint=function(e){var t;switch((e=e||{}).variant=e.variant||"non-conform",e.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})}return this},function(e){var t=function(){var n=void 0;Object.defineProperty(this,"pdf",{get:function(){return n},set:function(d){n=d}});var i=150;Object.defineProperty(this,"width",{get:function(){return i},set:function(d){i=isNaN(d)||Number.isInteger(d)===!1||d<0?150:d,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=i+1)}});var o=300;Object.defineProperty(this,"height",{get:function(){return o},set:function(d){o=isNaN(d)||Number.isInteger(d)===!1||d<0?300:d,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=o+1)}});var a=[];Object.defineProperty(this,"childNodes",{get:function(){return a},set:function(d){a=d}});var u={};Object.defineProperty(this,"style",{get:function(){return u},set:function(d){u=d}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(n,i){var o;if((n=n||"2d")!=="2d")return null;for(o in i)this.pdf.context2d.hasOwnProperty(o)&&(this.pdf.context2d[o]=i[o]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(Cn.API),function(e){var t={left:0,top:0,bottom:0,right:0},n=!1,i=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),o.call(this))},o=function(){this.internal.__cell__.lastCell=new a,this.internal.__cell__.pages=1},a=function(){var f=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return f},set:function(z){f=z}});var v=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return v},set:function(z){v=z}});var _=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return _},set:function(z){_=z}});var x=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return x},set:function(z){x=z}});var k=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return k},set:function(z){k=z}});var w=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return w},set:function(z){w=z}});var N=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return N},set:function(z){N=z}}),this};a.prototype.clone=function(){return new a(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},a.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(f){return i.call(this),this.internal.__cell__.headerFunction=typeof f=="function"?f:void 0,this},e.getTextDimensions=function(f,v){i.call(this);var _=(v=v||{}).fontSize||this.getFontSize(),x=v.font||this.getFont(),k=v.scaleFactor||this.internal.scaleFactor,w=0,N=0,z=0,W=this;if(!Array.isArray(f)&&typeof f!="string"){if(typeof f!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");f=String(f)}var O=v.maxWidth;O>0?typeof f=="string"?f=this.splitTextToSize(f,O):Object.prototype.toString.call(f)==="[object Array]"&&(f=f.reduce(function(se,Se){return se.concat(W.splitTextToSize(Se,O))},[])):f=Array.isArray(f)?f:[f];for(var Z=0;Z<f.length;Z++)w<(z=this.getStringUnitWidth(f[Z],{font:x})*_)&&(w=z);return w!==0&&(N=f.length),{w:w/=k,h:Math.max((N*_*this.getLineHeightFactor()-_*(this.getLineHeightFactor()-1))/k,0)}},e.cellAddPage=function(){i.call(this),this.addPage();var f=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new a(f.left,f.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var u=e.cell=function(){var f;f=arguments[0]instanceof a?arguments[0]:new a(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),i.call(this);var v=this.internal.__cell__.lastCell,_=this.internal.__cell__.padding,x=this.internal.__cell__.margins||t,k=this.internal.__cell__.tableHeaderRow,w=this.internal.__cell__.printHeaders;return v.lineNumber!==void 0&&(v.lineNumber===f.lineNumber?(f.x=(v.x||0)+(v.width||0),f.y=v.y||0):v.y+v.height+f.height+x.bottom>this.getPageHeight()?(this.cellAddPage(),f.y=x.top,w&&k&&(this.printHeaderRow(f.lineNumber,!0),f.y+=k[0].height)):f.y=v.y+v.height||f.y),f.text[0]!==void 0&&(this.rect(f.x,f.y,f.width,f.height,n===!0?"FD":void 0),f.align==="right"?this.text(f.text,f.x+f.width-_,f.y+_,{align:"right",baseline:"top"}):f.align==="center"?this.text(f.text,f.x+f.width/2,f.y+_,{align:"center",baseline:"top",maxWidth:f.width-_-_}):this.text(f.text,f.x+_,f.y+_,{align:"left",baseline:"top",maxWidth:f.width-_-_})),this.internal.__cell__.lastCell=f,this};e.table=function(f,v,_,x,k){if(i.call(this),!_)throw new Error("No data for PDF table.");var w,N,z,W,O=[],Z=[],se=[],Se={},Ne={},$e=[],Pe=[],xe=(k=k||{}).autoSize||!1,Be=k.printHeaders!==!1,ze=k.css&&k.css["font-size"]!==void 0?16*k.css["font-size"]:k.fontSize||12,te=k.margins||Object.assign({width:this.getPageWidth()},t),J=typeof k.padding=="number"?k.padding:3,Ee=k.headerBackgroundColor||"#c8c8c8",he=k.headerTextColor||"#000";if(o.call(this),this.internal.__cell__.printHeaders=Be,this.internal.__cell__.margins=te,this.internal.__cell__.table_font_size=ze,this.internal.__cell__.padding=J,this.internal.__cell__.headerBackgroundColor=Ee,this.internal.__cell__.headerTextColor=he,this.setFontSize(ze),x==null)Z=O=Object.keys(_[0]),se=O.map(function(){return"left"});else if(Array.isArray(x)&&yi(x[0])==="object")for(O=x.map(function(oe){return oe.name}),Z=x.map(function(oe){return oe.prompt||oe.name||""}),se=x.map(function(oe){return oe.align||"left"}),w=0;w<x.length;w+=1)Ne[x[w].name]=x[w].width*(19.049976/25.4);else Array.isArray(x)&&typeof x[0]=="string"&&(Z=O=x,se=O.map(function(){return"left"}));if(xe||Array.isArray(x)&&typeof x[0]=="string")for(w=0;w<O.length;w+=1){for(Se[W=O[w]]=_.map(function(oe){return oe[W]}),this.setFont(void 0,"bold"),$e.push(this.getTextDimensions(Z[w],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),N=Se[W],this.setFont(void 0,"normal"),z=0;z<N.length;z+=1)$e.push(this.getTextDimensions(N[z],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);Ne[W]=Math.max.apply(null,$e)+J+J,$e=[]}if(Be){var P={};for(w=0;w<O.length;w+=1)P[O[w]]={},P[O[w]].text=Z[w],P[O[w]].align=se[w];var F=d.call(this,P,Ne);Pe=O.map(function(oe){return new a(f,v,Ne[oe],F,P[oe].text,void 0,P[oe].align)}),this.setTableHeaderRow(Pe),this.printHeaderRow(1,!1)}var G=x.reduce(function(oe,me){return oe[me.name]=me.align,oe},{});for(w=0;w<_.length;w+=1){"rowStart"in k&&k.rowStart instanceof Function&&k.rowStart({row:w,data:_[w]},this);var Q=d.call(this,_[w],Ne);for(z=0;z<O.length;z+=1){var Ae=_[w][O[z]];"cellStart"in k&&k.cellStart instanceof Function&&k.cellStart({row:w,col:z,data:Ae},this),u.call(this,new a(f,v,Ne[O[z]],Q,Ae,w+2,G[O[z]]))}}return this.internal.__cell__.table_x=f,this.internal.__cell__.table_y=v,this};var d=function(f,v){var _=this.internal.__cell__.padding,x=this.internal.__cell__.table_font_size,k=this.internal.scaleFactor;return Object.keys(f).map(function(w){var N=f[w];return this.splitTextToSize(N.hasOwnProperty("text")?N.text:N,v[w]-_-_)},this).map(function(w){return this.getLineHeightFactor()*w.length*x/k+_+_},this).reduce(function(w,N){return Math.max(w,N)},0)};e.setTableHeaderRow=function(f){i.call(this),this.internal.__cell__.tableHeaderRow=f},e.printHeaderRow=function(f,v){if(i.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var _;if(n=!0,typeof this.internal.__cell__.headerFunction=="function"){var x=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new a(x[0],x[1],x[2],x[3],void 0,-1)}this.setFont(void 0,"bold");for(var k=[],w=0;w<this.internal.__cell__.tableHeaderRow.length;w+=1){_=this.internal.__cell__.tableHeaderRow[w].clone(),v&&(_.y=this.internal.__cell__.margins.top||0,k.push(_)),_.lineNumber=f;var N=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),u.call(this,_),this.setTextColor(N)}k.length>0&&this.setTableHeaderRow(k),this.setFont(void 0,"normal"),n=!1}}(Cn.API);var sv={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},ov=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],jf=rv(ov),av=[100,200,300,400,500,600,700,800,900],OC=rv(av);function zf(e){var t=e.family.replace(/"|'/g,"").toLowerCase(),n=function(a){return sv[a=a||"normal"]?a:"normal"}(e.style),i=function(a){if(!a)return 400;if(typeof a=="number")return a>=100&&a<=900&&a%100==0?a:400;if(/^\d00$/.test(a))return parseInt(a);switch(a){case"bold":return 700;case"normal":default:return 400}}(e.weight),o=function(a){return typeof jf[a=a||"normal"]=="number"?a:"normal"}(e.stretch);return{family:t,style:n,weight:i,stretch:o,src:e.src||[],ref:e.ref||{name:t,style:[o,n,i].join(" ")}}}function pg(e,t,n,i){var o;for(o=n;o>=0&&o<t.length;o+=i)if(e[t[o]])return e[t[o]];for(o=n;o>=0&&o<t.length;o-=i)if(e[t[o]])return e[t[o]]}var IC={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},gg={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function mg(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function FC(e,t,n){for(var i=(n=n||{}).defaultFontFamily||"times",o=Object.assign({},IC,n.genericFontFamilies||{}),a=null,u=null,d=0;d<t.length;++d)if(o[(a=zf(t[d])).family]&&(a.family=o[a.family]),e.hasOwnProperty(a.family)){u=e[a.family];break}if(!(u=u||e[i]))throw new Error("Could not find a font-family for the rule '"+mg(a)+"' and default family '"+i+"'.");if(u=function(f,v){if(v[f])return v[f];var _=jf[f],x=_<=jf.normal?-1:1,k=pg(v,ov,_,x);if(!k)throw new Error("Could not find a matching font-stretch value for "+f);return k}(a.stretch,u),u=function(f,v){if(v[f])return v[f];for(var _=sv[f],x=0;x<_.length;++x)if(v[_[x]])return v[_[x]];throw new Error("Could not find a matching font-style for "+f)}(a.style,u),!(u=function(f,v){if(v[f])return v[f];if(f===400&&v[500])return v[500];if(f===500&&v[400])return v[400];var _=OC[f],x=pg(v,av,_,f<400?-1:1);if(!x)throw new Error("Could not find a matching font-weight for value "+f);return x}(a.weight,u)))throw new Error("Failed to resolve a font for the rule '"+mg(a)+"'.");return u}function vg(e){return e.trimLeft()}function jC(e,t){for(var n=0;n<e.length;){if(e.charAt(n)===t)return[e.substring(0,n),e.substring(n+1)];n+=1}return null}function zC(e){var t=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],e.substring(t[0].length)]}var oh,yg,_g,Qd=["times"];(function(e){var t,n,i,o,a,u,d,f,v,_=function(T){return T=T||{},this.isStrokeTransparent=T.isStrokeTransparent||!1,this.strokeOpacity=T.strokeOpacity||1,this.strokeStyle=T.strokeStyle||"#000000",this.fillStyle=T.fillStyle||"#000000",this.isFillTransparent=T.isFillTransparent||!1,this.fillOpacity=T.fillOpacity||1,this.font=T.font||"10px sans-serif",this.textBaseline=T.textBaseline||"alphabetic",this.textAlign=T.textAlign||"left",this.lineWidth=T.lineWidth||1,this.lineJoin=T.lineJoin||"miter",this.lineCap=T.lineCap||"butt",this.path=T.path||[],this.transform=T.transform!==void 0?T.transform.clone():new f,this.globalCompositeOperation=T.globalCompositeOperation||"normal",this.globalAlpha=T.globalAlpha||1,this.clip_path=T.clip_path||[],this.currentPoint=T.currentPoint||new u,this.miterLimit=T.miterLimit||10,this.lastPoint=T.lastPoint||new u,this.lineDashOffset=T.lineDashOffset||0,this.lineDash=T.lineDash||[],this.margin=T.margin||[0,0,0,0],this.prevPageLastElemOffset=T.prevPageLastElemOffset||0,this.ignoreClearRect=typeof T.ignoreClearRect!="boolean"||T.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new x(this),t=this.internal.f2,n=this.internal.getCoordinateString,i=this.internal.getVerticalCoordinateString,o=this.internal.getHorizontalCoordinate,a=this.internal.getVerticalCoordinate,u=this.internal.Point,d=this.internal.Rectangle,f=this.internal.Matrix,v=new _}]);var x=function(T){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var ne=T;Object.defineProperty(this,"pdf",{get:function(){return ne}});var ae=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return ae},set:function(ve){ae=!!ve}});var q=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return q},set:function(ve){q=!!ve}});var R=0;Object.defineProperty(this,"posX",{get:function(){return R},set:function(ve){isNaN(ve)||(R=ve)}});var U=0;Object.defineProperty(this,"posY",{get:function(){return U},set:function(ve){isNaN(ve)||(U=ve)}}),Object.defineProperty(this,"margin",{get:function(){return v.margin},set:function(ve){var ee;typeof ve=="number"?ee=[ve,ve,ve,ve]:((ee=new Array(4))[0]=ve[0],ee[1]=ve.length>=2?ve[1]:ee[0],ee[2]=ve.length>=3?ve[2]:ee[0],ee[3]=ve.length>=4?ve[3]:ee[1]),v.margin=ee}});var H=!1;Object.defineProperty(this,"autoPaging",{get:function(){return H},set:function(ve){H=ve}});var $=0;Object.defineProperty(this,"lastBreak",{get:function(){return $},set:function(ve){$=ve}});var ce=[];Object.defineProperty(this,"pageBreaks",{get:function(){return ce},set:function(ve){ce=ve}}),Object.defineProperty(this,"ctx",{get:function(){return v},set:function(ve){ve instanceof _&&(v=ve)}}),Object.defineProperty(this,"path",{get:function(){return v.path},set:function(ve){v.path=ve}});var ue=[];Object.defineProperty(this,"ctxStack",{get:function(){return ue},set:function(ve){ue=ve}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(ve){var ee;ee=k(ve),this.ctx.fillStyle=ee.style,this.ctx.isFillTransparent=ee.a===0,this.ctx.fillOpacity=ee.a,this.pdf.setFillColor(ee.r,ee.g,ee.b,{a:ee.a}),this.pdf.setTextColor(ee.r,ee.g,ee.b,{a:ee.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(ve){var ee=k(ve);this.ctx.strokeStyle=ee.style,this.ctx.isStrokeTransparent=ee.a===0,this.ctx.strokeOpacity=ee.a,ee.a===0?this.pdf.setDrawColor(255,255,255):(ee.a,this.pdf.setDrawColor(ee.r,ee.g,ee.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(ve){["butt","round","square"].indexOf(ve)!==-1&&(this.ctx.lineCap=ve,this.pdf.setLineCap(ve))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(ve){isNaN(ve)||(this.ctx.lineWidth=ve,this.pdf.setLineWidth(ve))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(ve){["bevel","round","miter"].indexOf(ve)!==-1&&(this.ctx.lineJoin=ve,this.pdf.setLineJoin(ve))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(ve){isNaN(ve)||(this.ctx.miterLimit=ve,this.pdf.setMiterLimit(ve))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(ve){this.ctx.textBaseline=ve}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(ve){["right","end","center","left","start"].indexOf(ve)!==-1&&(this.ctx.textAlign=ve)}});var V=null;function K(ve,ee){if(V===null){var Ge=function(tt){var Ue=[];return Object.keys(tt).forEach(function(nt){tt[nt].forEach(function(st){var Ct=null;switch(st){case"bold":Ct={family:nt,weight:"bold"};break;case"italic":Ct={family:nt,style:"italic"};break;case"bolditalic":Ct={family:nt,weight:"bold",style:"italic"};break;case"":case"normal":Ct={family:nt}}Ct!==null&&(Ct.ref={name:nt,style:st},Ue.push(Ct))})}),Ue}(ve.getFontList());V=function(tt){for(var Ue={},nt=0;nt<tt.length;++nt){var st=zf(tt[nt]),Ct=st.family,xt=st.stretch,Ot=st.style,$t=st.weight;Ue[Ct]=Ue[Ct]||{},Ue[Ct][xt]=Ue[Ct][xt]||{},Ue[Ct][xt][Ot]=Ue[Ct][xt][Ot]||{},Ue[Ct][xt][Ot][$t]=st}return Ue}(Ge.concat(ee))}return V}var ye=null;Object.defineProperty(this,"fontFaces",{get:function(){return ye},set:function(ve){V=null,ye=ve}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(ve){var ee;if(this.ctx.font=ve,(ee=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(ve))!==null){var Ge=ee[1],tt=(ee[2],ee[3]),Ue=ee[4],nt=(ee[5],ee[6]),st=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Ue)[2];Ue=Math.floor(st==="px"?parseFloat(Ue)*this.pdf.internal.scaleFactor:st==="em"?parseFloat(Ue)*this.pdf.getFontSize():parseFloat(Ue)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Ue);var Ct=function(kt){var Et,At,et=[],ot=kt.trim();if(ot==="")return Qd;if(ot in gg)return[gg[ot]];for(;ot!=="";){switch(At=null,Et=(ot=vg(ot)).charAt(0)){case'"':case"'":At=jC(ot.substring(1),Et);break;default:At=zC(ot)}if(At===null||(et.push(At[0]),(ot=vg(At[1]))!==""&&ot.charAt(0)!==","))return Qd;ot=ot.replace(/^,/,"")}return et}(nt);if(this.fontFaces){var xt=FC(K(this.pdf,this.fontFaces),Ct.map(function(kt){return{family:kt,stretch:"normal",weight:tt,style:Ge}}));this.pdf.setFont(xt.ref.name,xt.ref.style)}else{var Ot="";(tt==="bold"||parseInt(tt,10)>=700||Ge==="bold")&&(Ot="bold"),Ge==="italic"&&(Ot+="italic"),Ot.length===0&&(Ot="normal");for(var $t="",Gt={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},ft=0;ft<Ct.length;ft++){if(this.pdf.internal.getFont(Ct[ft],Ot,{noFallback:!0,disableWarning:!0})!==void 0){$t=Ct[ft];break}if(Ot==="bolditalic"&&this.pdf.internal.getFont(Ct[ft],"bold",{noFallback:!0,disableWarning:!0})!==void 0)$t=Ct[ft],Ot="bold";else if(this.pdf.internal.getFont(Ct[ft],"normal",{noFallback:!0,disableWarning:!0})!==void 0){$t=Ct[ft],Ot="normal";break}}if($t===""){for(var Fe=0;Fe<Ct.length;Fe++)if(Gt[Ct[Fe]]){$t=Gt[Ct[Fe]];break}}$t=$t===""?"Times":$t,this.pdf.setFont($t,Ot)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(ve){this.ctx.globalCompositeOperation=ve}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(ve){this.ctx.globalAlpha=ve}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(ve){this.ctx.lineDashOffset=ve,me.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(ve){this.ctx.lineDash=ve,me.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(ve){this.ctx.ignoreClearRect=!!ve}})};x.prototype.setLineDash=function(T){this.lineDash=T},x.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},x.prototype.fill=function(){Se.call(this,"fill",!1)},x.prototype.stroke=function(){Se.call(this,"stroke",!1)},x.prototype.beginPath=function(){this.path=[{type:"begin"}]},x.prototype.moveTo=function(T,ne){if(isNaN(T)||isNaN(ne))throw xi.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var ae=this.ctx.transform.applyToPoint(new u(T,ne));this.path.push({type:"mt",x:ae.x,y:ae.y}),this.ctx.lastPoint=new u(T,ne)},x.prototype.closePath=function(){var T=new u(0,0),ne=0;for(ne=this.path.length-1;ne!==-1;ne--)if(this.path[ne].type==="begin"&&yi(this.path[ne+1])==="object"&&typeof this.path[ne+1].x=="number"){T=new u(this.path[ne+1].x,this.path[ne+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new u(T.x,T.y)},x.prototype.lineTo=function(T,ne){if(isNaN(T)||isNaN(ne))throw xi.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var ae=this.ctx.transform.applyToPoint(new u(T,ne));this.path.push({type:"lt",x:ae.x,y:ae.y}),this.ctx.lastPoint=new u(ae.x,ae.y)},x.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),Se.call(this,null,!0)},x.prototype.quadraticCurveTo=function(T,ne,ae,q){if(isNaN(ae)||isNaN(q)||isNaN(T)||isNaN(ne))throw xi.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var R=this.ctx.transform.applyToPoint(new u(ae,q)),U=this.ctx.transform.applyToPoint(new u(T,ne));this.path.push({type:"qct",x1:U.x,y1:U.y,x:R.x,y:R.y}),this.ctx.lastPoint=new u(R.x,R.y)},x.prototype.bezierCurveTo=function(T,ne,ae,q,R,U){if(isNaN(R)||isNaN(U)||isNaN(T)||isNaN(ne)||isNaN(ae)||isNaN(q))throw xi.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var H=this.ctx.transform.applyToPoint(new u(R,U)),$=this.ctx.transform.applyToPoint(new u(T,ne)),ce=this.ctx.transform.applyToPoint(new u(ae,q));this.path.push({type:"bct",x1:$.x,y1:$.y,x2:ce.x,y2:ce.y,x:H.x,y:H.y}),this.ctx.lastPoint=new u(H.x,H.y)},x.prototype.arc=function(T,ne,ae,q,R,U){if(isNaN(T)||isNaN(ne)||isNaN(ae)||isNaN(q)||isNaN(R))throw xi.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(U=!!U,!this.ctx.transform.isIdentity){var H=this.ctx.transform.applyToPoint(new u(T,ne));T=H.x,ne=H.y;var $=this.ctx.transform.applyToPoint(new u(0,ae)),ce=this.ctx.transform.applyToPoint(new u(0,0));ae=Math.sqrt(Math.pow($.x-ce.x,2)+Math.pow($.y-ce.y,2))}Math.abs(R-q)>=2*Math.PI&&(q=0,R=2*Math.PI),this.path.push({type:"arc",x:T,y:ne,radius:ae,startAngle:q,endAngle:R,counterclockwise:U})},x.prototype.arcTo=function(T,ne,ae,q,R){throw new Error("arcTo not implemented.")},x.prototype.rect=function(T,ne,ae,q){if(isNaN(T)||isNaN(ne)||isNaN(ae)||isNaN(q))throw xi.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(T,ne),this.lineTo(T+ae,ne),this.lineTo(T+ae,ne+q),this.lineTo(T,ne+q),this.lineTo(T,ne),this.lineTo(T+ae,ne),this.lineTo(T,ne)},x.prototype.fillRect=function(T,ne,ae,q){if(isNaN(T)||isNaN(ne)||isNaN(ae)||isNaN(q))throw xi.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!w.call(this)){var R={};this.lineCap!=="butt"&&(R.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(R.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(T,ne,ae,q),this.fill(),R.hasOwnProperty("lineCap")&&(this.lineCap=R.lineCap),R.hasOwnProperty("lineJoin")&&(this.lineJoin=R.lineJoin)}},x.prototype.strokeRect=function(T,ne,ae,q){if(isNaN(T)||isNaN(ne)||isNaN(ae)||isNaN(q))throw xi.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");N.call(this)||(this.beginPath(),this.rect(T,ne,ae,q),this.stroke())},x.prototype.clearRect=function(T,ne,ae,q){if(isNaN(T)||isNaN(ne)||isNaN(ae)||isNaN(q))throw xi.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(T,ne,ae,q))},x.prototype.save=function(T){T=typeof T!="boolean"||T;for(var ne=this.pdf.internal.getCurrentPageInfo().pageNumber,ae=0;ae<this.pdf.internal.getNumberOfPages();ae++)this.pdf.setPage(ae+1),this.pdf.internal.out("q");if(this.pdf.setPage(ne),T){this.ctx.fontSize=this.pdf.internal.getFontSize();var q=new _(this.ctx);this.ctxStack.push(this.ctx),this.ctx=q}},x.prototype.restore=function(T){T=typeof T!="boolean"||T;for(var ne=this.pdf.internal.getCurrentPageInfo().pageNumber,ae=0;ae<this.pdf.internal.getNumberOfPages();ae++)this.pdf.setPage(ae+1),this.pdf.internal.out("Q");this.pdf.setPage(ne),T&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},x.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var k=function(T){var ne,ae,q,R;if(T.isCanvasGradient===!0&&(T=T.getColor()),!T)return{r:0,g:0,b:0,a:0,style:T};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(T))ne=0,ae=0,q=0,R=0;else{var U=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(T);if(U!==null)ne=parseInt(U[1]),ae=parseInt(U[2]),q=parseInt(U[3]),R=1;else if((U=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(T))!==null)ne=parseInt(U[1]),ae=parseInt(U[2]),q=parseInt(U[3]),R=parseFloat(U[4]);else{if(R=1,typeof T=="string"&&T.charAt(0)!=="#"){var H=new X1(T);T=H.ok?H.toHex():"#000000"}T.length===4?(ne=T.substring(1,2),ne+=ne,ae=T.substring(2,3),ae+=ae,q=T.substring(3,4),q+=q):(ne=T.substring(1,3),ae=T.substring(3,5),q=T.substring(5,7)),ne=parseInt(ne,16),ae=parseInt(ae,16),q=parseInt(q,16)}}return{r:ne,g:ae,b:q,a:R,style:T}},w=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},N=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};x.prototype.fillText=function(T,ne,ae,q){if(isNaN(ne)||isNaN(ae)||typeof T!="string")throw xi.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(q=isNaN(q)?void 0:q,!w.call(this)){var R=Q(this.ctx.transform.rotation),U=this.ctx.transform.scaleX;J.call(this,{text:T,x:ne,y:ae,scale:U,angle:R,align:this.textAlign,maxWidth:q})}},x.prototype.strokeText=function(T,ne,ae,q){if(isNaN(ne)||isNaN(ae)||typeof T!="string")throw xi.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!N.call(this)){q=isNaN(q)?void 0:q;var R=Q(this.ctx.transform.rotation),U=this.ctx.transform.scaleX;J.call(this,{text:T,x:ne,y:ae,scale:U,renderingMode:"stroke",angle:R,align:this.textAlign,maxWidth:q})}},x.prototype.measureText=function(T){if(typeof T!="string")throw xi.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var ne=this.pdf,ae=this.pdf.internal.scaleFactor,q=ne.internal.getFontSize(),R=ne.getStringUnitWidth(T)*q/ne.internal.scaleFactor,U=function(H){var $=(H=H||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return $}}),this};return new U({width:R*=Math.round(96*ae/72*1e4)/1e4})},x.prototype.scale=function(T,ne){if(isNaN(T)||isNaN(ne))throw xi.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var ae=new f(T,0,0,ne,0,0);this.ctx.transform=this.ctx.transform.multiply(ae)},x.prototype.rotate=function(T){if(isNaN(T))throw xi.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var ne=new f(Math.cos(T),Math.sin(T),-Math.sin(T),Math.cos(T),0,0);this.ctx.transform=this.ctx.transform.multiply(ne)},x.prototype.translate=function(T,ne){if(isNaN(T)||isNaN(ne))throw xi.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var ae=new f(1,0,0,1,T,ne);this.ctx.transform=this.ctx.transform.multiply(ae)},x.prototype.transform=function(T,ne,ae,q,R,U){if(isNaN(T)||isNaN(ne)||isNaN(ae)||isNaN(q)||isNaN(R)||isNaN(U))throw xi.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var H=new f(T,ne,ae,q,R,U);this.ctx.transform=this.ctx.transform.multiply(H)},x.prototype.setTransform=function(T,ne,ae,q,R,U){T=isNaN(T)?1:T,ne=isNaN(ne)?0:ne,ae=isNaN(ae)?0:ae,q=isNaN(q)?1:q,R=isNaN(R)?0:R,U=isNaN(U)?0:U,this.ctx.transform=new f(T,ne,ae,q,R,U)};var z=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};x.prototype.drawImage=function(T,ne,ae,q,R,U,H,$,ce){var ue=this.pdf.getImageProperties(T),V=1,K=1,ye=1,ve=1;q!==void 0&&$!==void 0&&(ye=$/q,ve=ce/R,V=ue.width/q*$/q,K=ue.height/R*ce/R),U===void 0&&(U=ne,H=ae,ne=0,ae=0),q!==void 0&&$===void 0&&($=q,ce=R),q===void 0&&$===void 0&&($=ue.width,ce=ue.height);for(var ee,Ge=this.ctx.transform.decompose(),tt=Q(Ge.rotate.shx),Ue=new f,nt=(Ue=(Ue=(Ue=Ue.multiply(Ge.translate)).multiply(Ge.skew)).multiply(Ge.scale)).applyToRectangle(new d(U-ne*ye,H-ae*ve,q*V,R*K)),st=W.call(this,nt),Ct=[],xt=0;xt<st.length;xt+=1)Ct.indexOf(st[xt])===-1&&Ct.push(st[xt]);if(se(Ct),this.autoPaging)for(var Ot=Ct[0],$t=Ct[Ct.length-1],Gt=Ot;Gt<$t+1;Gt++){this.pdf.setPage(Gt);var ft=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Fe=Gt===1?this.posY+this.margin[0]:this.margin[0],kt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Et=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],At=Gt===1?0:kt+(Gt-2)*Et;if(this.ctx.clip_path.length!==0){var et=this.path;ee=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=Z(ee,this.posX+this.margin[3],-At+Fe+this.ctx.prevPageLastElemOffset),Ne.call(this,"fill",!0),this.path=et}var ot=JSON.parse(JSON.stringify(nt));ot=Z([ot],this.posX+this.margin[3],-At+Fe+this.ctx.prevPageLastElemOffset)[0];var wn=(Gt>Ot||Gt<$t)&&z.call(this);wn&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],ft,Et,null).clip().discardPath()),this.pdf.addImage(T,"JPEG",ot.x,ot.y,ot.w,ot.h,null,null,tt),wn&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(T,"JPEG",nt.x,nt.y,nt.w,nt.h,null,null,tt)};var W=function(T,ne,ae){var q=[];ne=ne||this.pdf.internal.pageSize.width,ae=ae||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var R=this.posY+this.ctx.prevPageLastElemOffset;switch(T.type){default:case"mt":case"lt":q.push(Math.floor((T.y+R)/ae)+1);break;case"arc":q.push(Math.floor((T.y+R-T.radius)/ae)+1),q.push(Math.floor((T.y+R+T.radius)/ae)+1);break;case"qct":var U=Ae(this.ctx.lastPoint.x,this.ctx.lastPoint.y,T.x1,T.y1,T.x,T.y);q.push(Math.floor((U.y+R)/ae)+1),q.push(Math.floor((U.y+U.h+R)/ae)+1);break;case"bct":var H=oe(this.ctx.lastPoint.x,this.ctx.lastPoint.y,T.x1,T.y1,T.x2,T.y2,T.x,T.y);q.push(Math.floor((H.y+R)/ae)+1),q.push(Math.floor((H.y+H.h+R)/ae)+1);break;case"rect":q.push(Math.floor((T.y+R)/ae)+1),q.push(Math.floor((T.y+T.h+R)/ae)+1)}for(var $=0;$<q.length;$+=1)for(;this.pdf.internal.getNumberOfPages()<q[$];)O.call(this);return q},O=function(){var T=this.fillStyle,ne=this.strokeStyle,ae=this.font,q=this.lineCap,R=this.lineWidth,U=this.lineJoin;this.pdf.addPage(),this.fillStyle=T,this.strokeStyle=ne,this.font=ae,this.lineCap=q,this.lineWidth=R,this.lineJoin=U},Z=function(T,ne,ae){for(var q=0;q<T.length;q++)switch(T[q].type){case"bct":T[q].x2+=ne,T[q].y2+=ae;case"qct":T[q].x1+=ne,T[q].y1+=ae;case"mt":case"lt":case"arc":default:T[q].x+=ne,T[q].y+=ae}return T},se=function(T){return T.sort(function(ne,ae){return ne-ae})},Se=function(T,ne){for(var ae,q,R=this.fillStyle,U=this.strokeStyle,H=this.lineCap,$=this.lineWidth,ce=Math.abs($*this.ctx.transform.scaleX),ue=this.lineJoin,V=JSON.parse(JSON.stringify(this.path)),K=JSON.parse(JSON.stringify(this.path)),ye=[],ve=0;ve<K.length;ve++)if(K[ve].x!==void 0)for(var ee=W.call(this,K[ve]),Ge=0;Ge<ee.length;Ge+=1)ye.indexOf(ee[Ge])===-1&&ye.push(ee[Ge]);for(var tt=0;tt<ye.length;tt++)for(;this.pdf.internal.getNumberOfPages()<ye[tt];)O.call(this);if(se(ye),this.autoPaging)for(var Ue=ye[0],nt=ye[ye.length-1],st=Ue;st<nt+1;st++){this.pdf.setPage(st),this.fillStyle=R,this.strokeStyle=U,this.lineCap=H,this.lineWidth=ce,this.lineJoin=ue;var Ct=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],xt=st===1?this.posY+this.margin[0]:this.margin[0],Ot=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],$t=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Gt=st===1?0:Ot+(st-2)*$t;if(this.ctx.clip_path.length!==0){var ft=this.path;ae=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=Z(ae,this.posX+this.margin[3],-Gt+xt+this.ctx.prevPageLastElemOffset),Ne.call(this,T,!0),this.path=ft}if(q=JSON.parse(JSON.stringify(V)),this.path=Z(q,this.posX+this.margin[3],-Gt+xt+this.ctx.prevPageLastElemOffset),ne===!1||st===0){var Fe=(st>Ue||st<nt)&&z.call(this);Fe&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ct,$t,null).clip().discardPath()),Ne.call(this,T,ne),Fe&&this.pdf.restoreGraphicsState()}this.lineWidth=$}else this.lineWidth=ce,Ne.call(this,T,ne),this.lineWidth=$;this.path=V},Ne=function(T,ne){if((T!=="stroke"||ne||!N.call(this))&&(T==="stroke"||ne||!w.call(this))){for(var ae,q,R=[],U=this.path,H=0;H<U.length;H++){var $=U[H];switch($.type){case"begin":R.push({begin:!0});break;case"close":R.push({close:!0});break;case"mt":R.push({start:$,deltas:[],abs:[]});break;case"lt":var ce=R.length;if(U[H-1]&&!isNaN(U[H-1].x)&&(ae=[$.x-U[H-1].x,$.y-U[H-1].y],ce>0)){for(;ce>=0;ce--)if(R[ce-1].close!==!0&&R[ce-1].begin!==!0){R[ce-1].deltas.push(ae),R[ce-1].abs.push($);break}}break;case"bct":ae=[$.x1-U[H-1].x,$.y1-U[H-1].y,$.x2-U[H-1].x,$.y2-U[H-1].y,$.x-U[H-1].x,$.y-U[H-1].y],R[R.length-1].deltas.push(ae);break;case"qct":var ue=U[H-1].x+2/3*($.x1-U[H-1].x),V=U[H-1].y+2/3*($.y1-U[H-1].y),K=$.x+2/3*($.x1-$.x),ye=$.y+2/3*($.y1-$.y),ve=$.x,ee=$.y;ae=[ue-U[H-1].x,V-U[H-1].y,K-U[H-1].x,ye-U[H-1].y,ve-U[H-1].x,ee-U[H-1].y],R[R.length-1].deltas.push(ae);break;case"arc":R.push({deltas:[],abs:[],arc:!0}),Array.isArray(R[R.length-1].abs)&&R[R.length-1].abs.push($)}}q=ne?null:T==="stroke"?"stroke":"fill";for(var Ge=!1,tt=0;tt<R.length;tt++)if(R[tt].arc)for(var Ue=R[tt].abs,nt=0;nt<Ue.length;nt++){var st=Ue[nt];st.type==="arc"?xe.call(this,st.x,st.y,st.radius,st.startAngle,st.endAngle,st.counterclockwise,void 0,ne,!Ge):Ee.call(this,st.x,st.y),Ge=!0}else if(R[tt].close===!0)this.pdf.internal.out("h"),Ge=!1;else if(R[tt].begin!==!0){var Ct=R[tt].start.x,xt=R[tt].start.y;he.call(this,R[tt].deltas,Ct,xt),Ge=!0}q&&Be.call(this,q),ne&&ze.call(this)}},$e=function(T){var ne=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,ae=ne*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return T-ae;case"top":return T+ne-ae;case"hanging":return T+ne-2*ae;case"middle":return T+ne/2-ae;case"ideographic":return T;case"alphabetic":default:return T}},Pe=function(T){return T+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};x.prototype.createLinearGradient=function(){var T=function(){};return T.colorStops=[],T.addColorStop=function(ne,ae){this.colorStops.push([ne,ae])},T.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},T.isCanvasGradient=!0,T},x.prototype.createPattern=function(){return this.createLinearGradient()},x.prototype.createRadialGradient=function(){return this.createLinearGradient()};var xe=function(T,ne,ae,q,R,U,H,$,ce){for(var ue=F.call(this,ae,q,R,U),V=0;V<ue.length;V++){var K=ue[V];V===0&&(ce?te.call(this,K.x1+T,K.y1+ne):Ee.call(this,K.x1+T,K.y1+ne)),P.call(this,T,ne,K.x2,K.y2,K.x3,K.y3,K.x4,K.y4)}$?ze.call(this):Be.call(this,H)},Be=function(T){switch(T){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},ze=function(){this.pdf.clip(),this.pdf.discardPath()},te=function(T,ne){this.pdf.internal.out(n(T)+" "+i(ne)+" m")},J=function(T){var ne;switch(T.align){case"right":case"end":ne="right";break;case"center":ne="center";break;case"left":case"start":default:ne="left"}var ae=this.pdf.getTextDimensions(T.text),q=$e.call(this,T.y),R=Pe.call(this,q)-ae.h,U=this.ctx.transform.applyToPoint(new u(T.x,q)),H=this.ctx.transform.decompose(),$=new f;$=($=($=$.multiply(H.translate)).multiply(H.skew)).multiply(H.scale);for(var ce,ue,V,K=this.ctx.transform.applyToRectangle(new d(T.x,q,ae.w,ae.h)),ye=$.applyToRectangle(new d(T.x,R,ae.w,ae.h)),ve=W.call(this,ye),ee=[],Ge=0;Ge<ve.length;Ge+=1)ee.indexOf(ve[Ge])===-1&&ee.push(ve[Ge]);if(se(ee),this.autoPaging)for(var tt=ee[0],Ue=ee[ee.length-1],nt=tt;nt<Ue+1;nt++){this.pdf.setPage(nt);var st=nt===1?this.posY+this.margin[0]:this.margin[0],Ct=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],xt=this.pdf.internal.pageSize.height-this.margin[2],Ot=xt-this.margin[0],$t=this.pdf.internal.pageSize.width-this.margin[1],Gt=$t-this.margin[3],ft=nt===1?0:Ct+(nt-2)*Ot;if(this.ctx.clip_path.length!==0){var Fe=this.path;ce=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=Z(ce,this.posX+this.margin[3],-1*ft+st),Ne.call(this,"fill",!0),this.path=Fe}var kt=Z([JSON.parse(JSON.stringify(ye))],this.posX+this.margin[3],-ft+st+this.ctx.prevPageLastElemOffset)[0];T.scale>=.01&&(ue=this.pdf.internal.getFontSize(),this.pdf.setFontSize(ue*T.scale),V=this.lineWidth,this.lineWidth=V*T.scale);var Et=this.autoPaging!=="text";if(Et||kt.y+kt.h<=xt){if(Et||kt.y>=st&&kt.x<=$t){var At=Et?T.text:this.pdf.splitTextToSize(T.text,T.maxWidth||$t-kt.x)[0],et=Z([JSON.parse(JSON.stringify(K))],this.posX+this.margin[3],-ft+st+this.ctx.prevPageLastElemOffset)[0],ot=Et&&(nt>tt||nt<Ue)&&z.call(this);ot&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Gt,Ot,null).clip().discardPath()),this.pdf.text(At,et.x,et.y,{angle:T.angle,align:ne,renderingMode:T.renderingMode}),ot&&this.pdf.restoreGraphicsState()}}else kt.y<xt&&(this.ctx.prevPageLastElemOffset+=xt-kt.y);T.scale>=.01&&(this.pdf.setFontSize(ue),this.lineWidth=V)}else T.scale>=.01&&(ue=this.pdf.internal.getFontSize(),this.pdf.setFontSize(ue*T.scale),V=this.lineWidth,this.lineWidth=V*T.scale),this.pdf.text(T.text,U.x+this.posX,U.y+this.posY,{angle:T.angle,align:ne,renderingMode:T.renderingMode,maxWidth:T.maxWidth}),T.scale>=.01&&(this.pdf.setFontSize(ue),this.lineWidth=V)},Ee=function(T,ne,ae,q){ae=ae||0,q=q||0,this.pdf.internal.out(n(T+ae)+" "+i(ne+q)+" l")},he=function(T,ne,ae){return this.pdf.lines(T,ne,ae,null,null)},P=function(T,ne,ae,q,R,U,H,$){this.pdf.internal.out([t(o(ae+T)),t(a(q+ne)),t(o(R+T)),t(a(U+ne)),t(o(H+T)),t(a($+ne)),"c"].join(" "))},F=function(T,ne,ae,q){for(var R=2*Math.PI,U=Math.PI/2;ne>ae;)ne-=R;var H=Math.abs(ae-ne);H<R&&q&&(H=R-H);for(var $=[],ce=q?-1:1,ue=ne;H>1e-5;){var V=ue+ce*Math.min(H,U);$.push(G.call(this,T,ue,V)),H-=Math.abs(V-ue),ue=V}return $},G=function(T,ne,ae){var q=(ae-ne)/2,R=T*Math.cos(q),U=T*Math.sin(q),H=R,$=-U,ce=H*H+$*$,ue=ce+H*R+$*U,V=4/3*(Math.sqrt(2*ce*ue)-ue)/(H*U-$*R),K=H-V*$,ye=$+V*H,ve=K,ee=-ye,Ge=q+ne,tt=Math.cos(Ge),Ue=Math.sin(Ge);return{x1:T*Math.cos(ne),y1:T*Math.sin(ne),x2:K*tt-ye*Ue,y2:K*Ue+ye*tt,x3:ve*tt-ee*Ue,y3:ve*Ue+ee*tt,x4:T*Math.cos(ae),y4:T*Math.sin(ae)}},Q=function(T){return 180*T/Math.PI},Ae=function(T,ne,ae,q,R,U){var H=T+.5*(ae-T),$=ne+.5*(q-ne),ce=R+.5*(ae-R),ue=U+.5*(q-U),V=Math.min(T,R,H,ce),K=Math.max(T,R,H,ce),ye=Math.min(ne,U,$,ue),ve=Math.max(ne,U,$,ue);return new d(V,ye,K-V,ve-ye)},oe=function(T,ne,ae,q,R,U,H,$){var ce,ue,V,K,ye,ve,ee,Ge,tt,Ue,nt,st,Ct,xt,Ot=ae-T,$t=q-ne,Gt=R-ae,ft=U-q,Fe=H-R,kt=$-U;for(ue=0;ue<41;ue++)tt=(ee=(V=T+(ce=ue/40)*Ot)+ce*((ye=ae+ce*Gt)-V))+ce*(ye+ce*(R+ce*Fe-ye)-ee),Ue=(Ge=(K=ne+ce*$t)+ce*((ve=q+ce*ft)-K))+ce*(ve+ce*(U+ce*kt-ve)-Ge),ue==0?(nt=tt,st=Ue,Ct=tt,xt=Ue):(nt=Math.min(nt,tt),st=Math.min(st,Ue),Ct=Math.max(Ct,tt),xt=Math.max(xt,Ue));return new d(Math.round(nt),Math.round(st),Math.round(Ct-nt),Math.round(xt-st))},me=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var T,ne,ae=(T=this.ctx.lineDash,ne=this.ctx.lineDashOffset,JSON.stringify({lineDash:T,lineDashOffset:ne}));this.prevLineDash!==ae&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=ae)}}})(Cn.API),function(e){var t=function(a){var u,d,f,v,_,x,k,w,N,z;for(d=[],f=0,v=(a+=u="\0\0\0\0".slice(a.length%4||4)).length;v>f;f+=4)(_=(a.charCodeAt(f)<<24)+(a.charCodeAt(f+1)<<16)+(a.charCodeAt(f+2)<<8)+a.charCodeAt(f+3))!==0?(x=(_=((_=((_=((_=(_-(z=_%85))/85)-(N=_%85))/85)-(w=_%85))/85)-(k=_%85))/85)%85,d.push(x+33,k+33,w+33,N+33,z+33)):d.push(122);return function(W,O){for(var Z=O;Z>0;Z--)W.pop()}(d,u.length),String.fromCharCode.apply(String,d)+"~>"},n=function(a){var u,d,f,v,_,x=String,k="length",w=255,N="charCodeAt",z="slice",W="replace";for(a[z](-2),a=a[z](0,-2)[W](/\s/g,"")[W]("z","!!!!!"),f=[],v=0,_=(a+=u="uuuuu"[z](a[k]%5||5))[k];_>v;v+=5)d=52200625*(a[N](v)-33)+614125*(a[N](v+1)-33)+7225*(a[N](v+2)-33)+85*(a[N](v+3)-33)+(a[N](v+4)-33),f.push(w&d>>24,w&d>>16,w&d>>8,w&d);return function(O,Z){for(var se=Z;se>0;se--)O.pop()}(f,u[k]),x.fromCharCode.apply(x,f)},i=function(a){var u=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((a=a.replace(/\s/g,"")).indexOf(">")!==-1&&(a=a.substr(0,a.indexOf(">"))),a.length%2&&(a+="0"),u.test(a)===!1)return"";for(var d="",f=0;f<a.length;f+=2)d+=String.fromCharCode("0x"+(a[f]+a[f+1]));return d},o=function(a){for(var u=new Uint8Array(a.length),d=a.length;d--;)u[d]=a.charCodeAt(d);return a=(u=Df(u)).reduce(function(f,v){return f+String.fromCharCode(v)},"")};e.processDataByFilters=function(a,u){var d=0,f=a||"",v=[];for(typeof(u=u||[])=="string"&&(u=[u]),d=0;d<u.length;d+=1)switch(u[d]){case"ASCII85Decode":case"/ASCII85Decode":f=n(f),v.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":f=t(f),v.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":f=i(f),v.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":f=f.split("").map(function(_){return("0"+_.charCodeAt().toString(16)).slice(-2)}).join("")+">",v.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":f=o(f),v.push("/FlateDecode");break;default:throw new Error('The filter: "'+u[d]+'" is not implemented')}return{data:f,reverseChain:v.reverse().join(" ")}}}(Cn.API),function(e){e.loadFile=function(t,n,i){return function(o,a,u){a=a!==!1,u=typeof u=="function"?u:function(){};var d=void 0;try{d=function(f,v,_){var x=new XMLHttpRequest,k=0,w=function(N){var z=N.length,W=[],O=String.fromCharCode;for(k=0;k<z;k+=1)W.push(O(255&N.charCodeAt(k)));return W.join("")};if(x.open("GET",f,!v),x.overrideMimeType("text/plain; charset=x-user-defined"),v===!1&&(x.onload=function(){x.status===200?_(w(this.responseText)):_(void 0)}),x.send(null),v&&x.status===200)return w(x.responseText)}(o,a,u)}catch{}return d}(t,n,i)},e.loadImageFile=e.loadFile}(Cn.API),function(e){function t(){return(kn.html2canvas?Promise.resolve(kn.html2canvas):eu(()=>import("./html2canvas.esm.js"),[])).catch(function(u){return Promise.reject(new Error("Could not load html2canvas: "+u))}).then(function(u){return u.default?u.default:u})}function n(){return(kn.DOMPurify?Promise.resolve(kn.DOMPurify):eu(()=>import("./purify.es.js"),[])).catch(function(u){return Promise.reject(new Error("Could not load dompurify: "+u))}).then(function(u){return u.default?u.default:u})}var i=function(u){var d=yi(u);return d==="undefined"?"undefined":d==="string"||u instanceof String?"string":d==="number"||u instanceof Number?"number":d==="function"||u instanceof Function?"function":u&&u.constructor===Array?"array":u&&u.nodeType===1?"element":d==="object"?"object":"unknown"},o=function(u,d){var f=document.createElement(u);for(var v in d.className&&(f.className=d.className),d.innerHTML&&d.dompurify&&(f.innerHTML=d.dompurify.sanitize(d.innerHTML)),d.style)f.style[v]=d.style[v];return f},a=function u(d){var f=Object.assign(u.convert(Promise.resolve()),JSON.parse(JSON.stringify(u.template))),v=u.convert(Promise.resolve(),f);return v=(v=v.setProgress(1,u,1,[u])).set(d)};(a.prototype=Object.create(Promise.prototype)).constructor=a,a.convert=function(u,d){return u.__proto__=d||a.prototype,u},a.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},a.prototype.from=function(u,d){return this.then(function(){switch(d=d||function(f){switch(i(f)){case"string":return"string";case"element":return f.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(u)){case"string":return this.then(n).then(function(f){return this.set({src:o("div",{innerHTML:u,dompurify:f})})});case"element":return this.set({src:u});case"canvas":return this.set({canvas:u});case"img":return this.set({img:u});default:return this.error("Unknown source type.")}})},a.prototype.to=function(u){switch(u){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},a.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var u={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},d=function f(v,_){for(var x=v.nodeType===3?document.createTextNode(v.nodeValue):v.cloneNode(!1),k=v.firstChild;k;k=k.nextSibling)_!==!0&&k.nodeType===1&&k.nodeName==="SCRIPT"||x.appendChild(f(k,_));return v.nodeType===1&&(v.nodeName==="CANVAS"?(x.width=v.width,x.height=v.height,x.getContext("2d").drawImage(v,0,0)):v.nodeName!=="TEXTAREA"&&v.nodeName!=="SELECT"||(x.value=v.value),x.addEventListener("load",function(){x.scrollTop=v.scrollTop,x.scrollLeft=v.scrollLeft},!0)),x}(this.prop.src,this.opt.html2canvas.javascriptEnabled);d.tagName==="BODY"&&(u.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=o("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=o("div",{className:"html2pdf__container",style:u}),this.prop.container.appendChild(d),this.prop.container.firstChild.appendChild(o("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},a.prototype.toCanvas=function(){var u=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(u).then(t).then(function(d){var f=Object.assign({},this.opt.html2canvas);return delete f.onrendered,d(this.prop.container,f)}).then(function(d){(this.opt.html2canvas.onrendered||function(){})(d),this.prop.canvas=d,document.body.removeChild(this.prop.overlay)})},a.prototype.toContext2d=function(){var u=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(u).then(t).then(function(d){var f=this.opt.jsPDF,v=this.opt.fontFaces,_=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,x=Object.assign({async:!0,allowTaint:!0,scale:_,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete x.onrendered,f.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,f.context2d.posX=this.opt.x,f.context2d.posY=this.opt.y,f.context2d.margin=this.opt.margin,f.context2d.fontFaces=v,v)for(var k=0;k<v.length;++k){var w=v[k],N=w.src.find(function(z){return z.format==="truetype"});N&&f.addFont(N.url,w.ref.name,w.ref.style)}return x.windowHeight=x.windowHeight||0,x.windowHeight=x.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):x.windowHeight,f.context2d.save(!0),d(this.prop.container,x)}).then(function(d){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(d),this.prop.canvas=d,document.body.removeChild(this.prop.overlay)})},a.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var u=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=u})},a.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},a.prototype.output=function(u,d,f){return(f=f||"pdf").toLowerCase()==="img"||f.toLowerCase()==="image"?this.outputImg(u,d):this.outputPdf(u,d)},a.prototype.outputPdf=function(u,d){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(u,d)})},a.prototype.outputImg=function(u){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(u){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+u+'" is not supported.'}})},a.prototype.save=function(u){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(u?{filename:u}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},a.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},a.prototype.set=function(u){if(i(u)!=="object")return this;var d=Object.keys(u||{}).map(function(f){if(f in a.template.prop)return function(){this.prop[f]=u[f]};switch(f){case"margin":return this.setMargin.bind(this,u.margin);case"jsPDF":return function(){return this.opt.jsPDF=u.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,u.pageSize);default:return function(){this.opt[f]=u[f]}}},this);return this.then(function(){return this.thenList(d)})},a.prototype.get=function(u,d){return this.then(function(){var f=u in a.template.prop?this.prop[u]:this.opt[u];return d?d(f):f})},a.prototype.setMargin=function(u){return this.then(function(){switch(i(u)){case"number":u=[u,u,u,u];case"array":if(u.length===2&&(u=[u[0],u[1],u[0],u[1]]),u.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=u}).then(this.setPageSize)},a.prototype.setPageSize=function(u){function d(f,v){return Math.floor(f*v/72*96)}return this.then(function(){(u=u||Cn.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(u.inner={width:u.width-this.opt.margin[1]-this.opt.margin[3],height:u.height-this.opt.margin[0]-this.opt.margin[2]},u.inner.px={width:d(u.inner.width,u.k),height:d(u.inner.height,u.k)},u.inner.ratio=u.inner.height/u.inner.width),this.prop.pageSize=u})},a.prototype.setProgress=function(u,d,f,v){return u!=null&&(this.progress.val=u),d!=null&&(this.progress.state=d),f!=null&&(this.progress.n=f),v!=null&&(this.progress.stack=v),this.progress.ratio=this.progress.val/this.progress.state,this},a.prototype.updateProgress=function(u,d,f,v){return this.setProgress(u?this.progress.val+u:null,d||null,f?this.progress.n+f:null,v?this.progress.stack.concat(v):null)},a.prototype.then=function(u,d){var f=this;return this.thenCore(u,d,function(v,_){return f.updateProgress(null,null,1,[v]),Promise.prototype.then.call(this,function(x){return f.updateProgress(null,v),x}).then(v,_).then(function(x){return f.updateProgress(1),x})})},a.prototype.thenCore=function(u,d,f){f=f||Promise.prototype.then,u&&(u=u.bind(this)),d&&(d=d.bind(this));var v=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:a.convert(Object.assign({},this),Promise.prototype),_=f.call(v,u,d);return a.convert(_,this.__proto__)},a.prototype.thenExternal=function(u,d){return Promise.prototype.then.call(this,u,d)},a.prototype.thenList=function(u){var d=this;return u.forEach(function(f){d=d.thenCore(f)}),d},a.prototype.catch=function(u){u&&(u=u.bind(this));var d=Promise.prototype.catch.call(this,u);return a.convert(d,this)},a.prototype.catchExternal=function(u){return Promise.prototype.catch.call(this,u)},a.prototype.error=function(u){return this.then(function(){throw new Error(u)})},a.prototype.using=a.prototype.set,a.prototype.saveAs=a.prototype.save,a.prototype.export=a.prototype.output,a.prototype.run=a.prototype.then,Cn.getPageSize=function(u,d,f){if(yi(u)==="object"){var v=u;u=v.orientation,d=v.unit||d,f=v.format||f}d=d||"mm",f=f||"a4",u=(""+(u||"P")).toLowerCase();var _,x=(""+f).toLowerCase(),k={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(d){case"pt":_=1;break;case"mm":_=72/25.4;break;case"cm":_=72/2.54;break;case"in":_=72;break;case"px":_=.75;break;case"pc":case"em":_=12;break;case"ex":_=6;break;default:throw"Invalid unit: "+d}var w,N=0,z=0;if(k.hasOwnProperty(x))N=k[x][1]/_,z=k[x][0]/_;else try{N=f[1],z=f[0]}catch{throw new Error("Invalid format: "+f)}if(u==="p"||u==="portrait")u="p",z>N&&(w=z,z=N,N=w);else{if(u!=="l"&&u!=="landscape")throw"Invalid orientation: "+u;u="l",N>z&&(w=z,z=N,N=w)}return{width:z,height:N,unit:d,k:_,orientation:u}},e.html=function(u,d){(d=d||{}).callback=d.callback||function(){},d.html2canvas=d.html2canvas||{},d.html2canvas.canvas=d.html2canvas.canvas||this.canvas,d.jsPDF=d.jsPDF||this,d.fontFaces=d.fontFaces?d.fontFaces.map(zf):null;var f=new a(d);return d.worker?f:f.from(u).doCallback()}}(Cn.API),Cn.API.addJS=function(e){return _g=e,this.internal.events.subscribe("postPutResources",function(){oh=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(oh+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),yg=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+_g+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){oh!==void 0&&yg!==void 0&&this.internal.out("/Names <</JavaScript "+oh+" 0 R>>")}),this},function(e){var t;e.events.push(["postPutResources",function(){var n=this,i=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var o=n.outline.render().split(/\r\n/),a=0;a<o.length;a++){var u=o[a],d=i.exec(u);if(d!=null){var f=d[1];n.internal.newObjectDeferredBegin(f,!1)}n.internal.write(u)}if(this.outline.createNamedDestinations){var v=this.internal.pages.length,_=[];for(a=0;a<v;a++){var x=n.internal.newObject();_.push(x);var k=n.internal.getPageInfo(a+1);n.internal.write("<< /D["+k.objId+" 0 R /XYZ null null null]>> endobj")}var w=n.internal.newObject();for(n.internal.write("<< /Names [ "),a=0;a<_.length;a++)n.internal.write("(page_"+(a+1)+")"+_[a]+" 0 R");n.internal.write(" ] >>","endobj"),t=n.internal.newObject(),n.internal.write("<< /Dests "+w+" 0 R"),n.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+t+" 0 R"))}]),e.events.push(["initialized",function(){var n=this;n.outline={createNamedDestinations:!1,root:{children:[]}},n.outline.add=function(i,o,a){var u={title:o,options:a,children:[]};return i==null&&(i=this.root),i.children.push(u),u},n.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=n,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},n.outline.genIds_r=function(i){i.id=n.internal.newObjectDeferred();for(var o=0;o<i.children.length;o++)this.genIds_r(i.children[o])},n.outline.renderRoot=function(i){this.objStart(i),this.line("/Type /Outlines"),i.children.length>0&&(this.line("/First "+this.makeRef(i.children[0])),this.line("/Last "+this.makeRef(i.children[i.children.length-1]))),this.line("/Count "+this.count_r({count:0},i)),this.objEnd()},n.outline.renderItems=function(i){for(var o=this.ctx.pdf.internal.getVerticalCoordinateString,a=0;a<i.children.length;a++){var u=i.children[a];this.objStart(u),this.line("/Title "+this.makeString(u.title)),this.line("/Parent "+this.makeRef(i)),a>0&&this.line("/Prev "+this.makeRef(i.children[a-1])),a<i.children.length-1&&this.line("/Next "+this.makeRef(i.children[a+1])),u.children.length>0&&(this.line("/First "+this.makeRef(u.children[0])),this.line("/Last "+this.makeRef(u.children[u.children.length-1])));var d=this.count=this.count_r({count:0},u);if(d>0&&this.line("/Count "+d),u.options&&u.options.pageNumber){var f=n.internal.getPageInfo(u.options.pageNumber);this.line("/Dest ["+f.objId+" 0 R /XYZ 0 "+o(0)+" 0]")}this.objEnd()}for(var v=0;v<i.children.length;v++)this.renderItems(i.children[v])},n.outline.line=function(i){this.ctx.val+=i+`\r
`},n.outline.makeRef=function(i){return i.id+" 0 R"},n.outline.makeString=function(i){return"("+n.internal.pdfEscape(i)+")"},n.outline.objStart=function(i){this.ctx.val+=`\r
`+i.id+` 0 obj\r
<<\r
`},n.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},n.outline.count_r=function(i,o){for(var a=0;a<o.children.length;a++)i.count++,this.count_r(i,o.children[a]);return i.count}}])}(Cn.API),function(e){var t=[192,193,194,195,196,197,198,199];e.processJPEG=function(n,i,o,a,u,d){var f,v=this.decode.DCT_DECODE,_=null;if(typeof n=="string"||this.__addimage__.isArrayBuffer(n)||this.__addimage__.isArrayBufferView(n)){switch(n=u||n,n=this.__addimage__.isArrayBuffer(n)?new Uint8Array(n):n,(f=function(x){for(var k,w=256*x.charCodeAt(4)+x.charCodeAt(5),N=x.length,z={width:0,height:0,numcomponents:1},W=4;W<N;W+=2){if(W+=w,t.indexOf(x.charCodeAt(W+1))!==-1){k=256*x.charCodeAt(W+5)+x.charCodeAt(W+6),z={width:256*x.charCodeAt(W+7)+x.charCodeAt(W+8),height:k,numcomponents:x.charCodeAt(W+9)};break}w=256*x.charCodeAt(W+2)+x.charCodeAt(W+3)}return z}(n=this.__addimage__.isArrayBufferView(n)?this.__addimage__.arrayBufferToBinaryString(n):n)).numcomponents){case 1:d=this.color_spaces.DEVICE_GRAY;break;case 4:d=this.color_spaces.DEVICE_CMYK;break;case 3:d=this.color_spaces.DEVICE_RGB}_={data:n,width:f.width,height:f.height,colorSpace:d,bitsPerComponent:8,filter:v,index:i,alias:o}}return _}}(Cn.API);var Cu,ah,bg,wg,xg,UC=function(){var e,t,n;function i(a){var u,d,f,v,_,x,k,w,N,z,W,O,Z,se;for(this.data=a,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},x=null;;){switch(u=this.readUInt32(),N=(function(){var Se,Ne;for(Ne=[],Se=0;Se<4;++Se)Ne.push(String.fromCharCode(this.data[this.pos++]));return Ne}).call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(u);break;case"fcTL":x&&this.animation.frames.push(x),this.pos+=4,x={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},_=this.readUInt16(),v=this.readUInt16()||100,x.delay=1e3*_/v,x.disposeOp=this.data[this.pos++],x.blendOp=this.data[this.pos++],x.data=[];break;case"IDAT":case"fdAT":for(N==="fdAT"&&(this.pos+=4,u-=4),a=(x!=null?x.data:void 0)||this.imgData,O=0;0<=u?O<u:O>u;0<=u?++O:--O)a.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(f=this.palette.length/3,this.transparency.indexed=this.read(u),this.transparency.indexed.length>f)throw new Error("More transparent colors than palette size");if((z=f-this.transparency.indexed.length)>0)for(Z=0;0<=z?Z<z:Z>z;0<=z?++Z:--Z)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(u)[0];break;case 2:this.transparency.rgb=this.read(u)}break;case"tEXt":k=(W=this.read(u)).indexOf(0),w=String.fromCharCode.apply(String,W.slice(0,k)),this.text[w]=String.fromCharCode.apply(String,W.slice(k+1));break;case"IEND":return x&&this.animation.frames.push(x),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=(se=this.colorType)===4||se===6,d=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*d,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=u}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}i.prototype.read=function(a){var u,d;for(d=[],u=0;0<=a?u<a:u>a;0<=a?++u:--u)d.push(this.data[this.pos++]);return d},i.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},i.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},i.prototype.decodePixels=function(a){var u=this.pixelBitlength/8,d=new Uint8Array(this.width*this.height*u),f=0,v=this;if(a==null&&(a=this.imgData),a.length===0)return new Uint8Array(0);function _(x,k,w,N){var z,W,O,Z,se,Se,Ne,$e,Pe,xe,Be,ze,te,J,Ee,he,P,F,G,Q,Ae,oe=Math.ceil((v.width-x)/w),me=Math.ceil((v.height-k)/N),T=v.width==oe&&v.height==me;for(J=u*oe,ze=T?d:new Uint8Array(J*me),Se=a.length,te=0,W=0;te<me&&f<Se;){switch(a[f++]){case 0:for(Z=P=0;P<J;Z=P+=1)ze[W++]=a[f++];break;case 1:for(Z=F=0;F<J;Z=F+=1)z=a[f++],se=Z<u?0:ze[W-u],ze[W++]=(z+se)%256;break;case 2:for(Z=G=0;G<J;Z=G+=1)z=a[f++],O=(Z-Z%u)/u,Ee=te&&ze[(te-1)*J+O*u+Z%u],ze[W++]=(Ee+z)%256;break;case 3:for(Z=Q=0;Q<J;Z=Q+=1)z=a[f++],O=(Z-Z%u)/u,se=Z<u?0:ze[W-u],Ee=te&&ze[(te-1)*J+O*u+Z%u],ze[W++]=(z+Math.floor((se+Ee)/2))%256;break;case 4:for(Z=Ae=0;Ae<J;Z=Ae+=1)z=a[f++],O=(Z-Z%u)/u,se=Z<u?0:ze[W-u],te===0?Ee=he=0:(Ee=ze[(te-1)*J+O*u+Z%u],he=O&&ze[(te-1)*J+(O-1)*u+Z%u]),Ne=se+Ee-he,$e=Math.abs(Ne-se),xe=Math.abs(Ne-Ee),Be=Math.abs(Ne-he),Pe=$e<=xe&&$e<=Be?se:xe<=Be?Ee:he,ze[W++]=(z+Pe)%256;break;default:throw new Error("Invalid filter algorithm: "+a[f-1])}if(!T){var ne=((k+te*N)*v.width+x)*u,ae=te*J;for(Z=0;Z<oe;Z+=1){for(var q=0;q<u;q+=1)d[ne++]=ze[ae++];ne+=(w-1)*u}}te++}}return a=_C(a),v.interlaceMethod==1?(_(0,0,8,8),_(4,0,8,8),_(0,4,4,8),_(2,0,4,4),_(0,2,2,4),_(1,0,2,2),_(0,1,1,2)):_(0,0,1,1),d},i.prototype.decodePalette=function(){var a,u,d,f,v,_,x,k,w;for(d=this.palette,_=this.transparency.indexed||[],v=new Uint8Array((_.length||0)+d.length),f=0,a=0,u=x=0,k=d.length;x<k;u=x+=3)v[f++]=d[u],v[f++]=d[u+1],v[f++]=d[u+2],v[f++]=(w=_[a++])!=null?w:255;return v},i.prototype.copyToImageData=function(a,u){var d,f,v,_,x,k,w,N,z,W,O;if(f=this.colors,z=null,d=this.hasAlphaChannel,this.palette.length&&(z=(O=this._decodedPalette)!=null?O:this._decodedPalette=this.decodePalette(),f=4,d=!0),N=(v=a.data||a).length,x=z||u,_=k=0,f===1)for(;_<N;)w=z?4*u[_/4]:k,W=x[w++],v[_++]=W,v[_++]=W,v[_++]=W,v[_++]=d?x[w++]:255,k=w;else for(;_<N;)w=z?4*u[_/4]:k,v[_++]=x[w++],v[_++]=x[w++],v[_++]=x[w++],v[_++]=d?x[w++]:255,k=w},i.prototype.decode=function(){var a;return a=new Uint8Array(this.width*this.height*4),this.copyToImageData(a,this.decodePixels()),a};var o=function(){if(Object.prototype.toString.call(kn)==="[object Window]"){try{t=kn.document.createElement("canvas"),n=t.getContext("2d")}catch{return!1}return!0}return!1};return o(),e=function(a){var u;if(o()===!0)return n.width=a.width,n.height=a.height,n.clearRect(0,0,a.width,a.height),n.putImageData(a,0,0),(u=new Image).src=t.toDataURL(),u;throw new Error("This method requires a Browser with Canvas-capability.")},i.prototype.decodeFrames=function(a){var u,d,f,v,_,x,k,w;if(this.animation){for(w=[],d=_=0,x=(k=this.animation.frames).length;_<x;d=++_)u=k[d],f=a.createImageData(u.width,u.height),v=this.decodePixels(new Uint8Array(u.data)),this.copyToImageData(f,v),u.imageData=f,w.push(u.image=e(f));return w}},i.prototype.renderFrame=function(a,u){var d,f,v;return d=(f=this.animation.frames)[u],v=f[u-1],u===0&&a.clearRect(0,0,this.width,this.height),(v!=null?v.disposeOp:void 0)===1?a.clearRect(v.xOffset,v.yOffset,v.width,v.height):(v!=null?v.disposeOp:void 0)===2&&a.putImageData(v.imageData,v.xOffset,v.yOffset),d.blendOp===0&&a.clearRect(d.xOffset,d.yOffset,d.width,d.height),a.drawImage(d.image,d.xOffset,d.yOffset)},i.prototype.animate=function(a){var u,d,f,v,_,x,k=this;return d=0,x=this.animation,v=x.numFrames,f=x.frames,_=x.numPlays,(u=function(){var w,N;if(w=d++%v,N=f[w],k.renderFrame(a,w),v>1&&d/v<_)return k.animation._timeout=setTimeout(u,N.delay)})()},i.prototype.stopAnimation=function(){var a;return clearTimeout((a=this.animation)!=null?a._timeout:void 0)},i.prototype.render=function(a){var u,d;return a._png&&a._png.stopAnimation(),a._png=this,a.width=this.width,a.height=this.height,u=a.getContext("2d"),this.animation?(this.decodeFrames(u),this.animate(u)):(d=u.createImageData(this.width,this.height),this.copyToImageData(d,this.decodePixels()),u.putImageData(d,0,0))},i}();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function $C(e){var t=0;if(e[t++]!==71||e[t++]!==73||e[t++]!==70||e[t++]!==56||(e[t++]+1&253)!=56||e[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var n=e[t++]|e[t++]<<8,i=e[t++]|e[t++]<<8,o=e[t++],a=o>>7,u=1<<(7&o)+1;e[t++],e[t++];var d=null,f=null;a&&(d=t,f=u,t+=3*u);var v=!0,_=[],x=0,k=null,w=0,N=null;for(this.width=n,this.height=i;v&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(e[t]!==11||e[t+1]==78&&e[t+2]==69&&e[t+3]==84&&e[t+4]==83&&e[t+5]==67&&e[t+6]==65&&e[t+7]==80&&e[t+8]==69&&e[t+9]==50&&e[t+10]==46&&e[t+11]==48&&e[t+12]==3&&e[t+13]==1&&e[t+16]==0)t+=14,N=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!((te=e[t++])>=0))throw Error("Invalid block size");if(te===0)break;t+=te}break;case 249:if(e[t++]!==4||e[t+4]!==0)throw new Error("Invalid graphics extension block.");var z=e[t++];x=e[t++]|e[t++]<<8,k=e[t++],!(1&z)&&(k=null),w=z>>2&7,t++;break;case 254:for(;;){if(!((te=e[t++])>=0))throw Error("Invalid block size");if(te===0)break;t+=te}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var W=e[t++]|e[t++]<<8,O=e[t++]|e[t++]<<8,Z=e[t++]|e[t++]<<8,se=e[t++]|e[t++]<<8,Se=e[t++],Ne=Se>>6&1,$e=1<<(7&Se)+1,Pe=d,xe=f,Be=!1;Se>>7&&(Be=!0,Pe=t,xe=$e,t+=3*$e);var ze=t;for(t++;;){var te;if(!((te=e[t++])>=0))throw Error("Invalid block size");if(te===0)break;t+=te}_.push({x:W,y:O,width:Z,height:se,has_local_palette:Be,palette_offset:Pe,palette_size:xe,data_offset:ze,data_length:t-ze,transparent_index:k,interlaced:!!Ne,delay:x,disposal:w});break;case 59:v=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return _.length},this.loopCount=function(){return N},this.frameInfo=function(J){if(J<0||J>=_.length)throw new Error("Frame index out of range.");return _[J]},this.decodeAndBlitFrameBGRA=function(J,Ee){var he=this.frameInfo(J),P=he.width*he.height,F=new Uint8Array(P);Lg(e,he.data_offset,F,P);var G=he.palette_offset,Q=he.transparent_index;Q===null&&(Q=256);var Ae=he.width,oe=n-Ae,me=Ae,T=4*(he.y*n+he.x),ne=4*((he.y+he.height)*n+he.x),ae=T,q=4*oe;he.interlaced===!0&&(q+=4*n*7);for(var R=8,U=0,H=F.length;U<H;++U){var $=F[U];if(me===0&&(me=Ae,(ae+=q)>=ne&&(q=4*oe+4*n*(R-1),ae=T+(Ae+oe)*(R<<1),R>>=1)),$===Q)ae+=4;else{var ce=e[G+3*$],ue=e[G+3*$+1],V=e[G+3*$+2];Ee[ae++]=V,Ee[ae++]=ue,Ee[ae++]=ce,Ee[ae++]=255}--me}},this.decodeAndBlitFrameRGBA=function(J,Ee){var he=this.frameInfo(J),P=he.width*he.height,F=new Uint8Array(P);Lg(e,he.data_offset,F,P);var G=he.palette_offset,Q=he.transparent_index;Q===null&&(Q=256);var Ae=he.width,oe=n-Ae,me=Ae,T=4*(he.y*n+he.x),ne=4*((he.y+he.height)*n+he.x),ae=T,q=4*oe;he.interlaced===!0&&(q+=4*n*7);for(var R=8,U=0,H=F.length;U<H;++U){var $=F[U];if(me===0&&(me=Ae,(ae+=q)>=ne&&(q=4*oe+4*n*(R-1),ae=T+(Ae+oe)*(R<<1),R>>=1)),$===Q)ae+=4;else{var ce=e[G+3*$],ue=e[G+3*$+1],V=e[G+3*$+2];Ee[ae++]=ce,Ee[ae++]=ue,Ee[ae++]=V,Ee[ae++]=255}--me}}}function Lg(e,t,n,i){for(var o=e[t++],a=1<<o,u=a+1,d=u+1,f=o+1,v=(1<<f)-1,_=0,x=0,k=0,w=e[t++],N=new Int32Array(4096),z=null;;){for(;_<16&&w!==0;)x|=e[t++]<<_,_+=8,w===1?w=e[t++]:--w;if(_<f)break;var W=x&v;if(x>>=f,_-=f,W!==a){if(W===u)break;for(var O=W<d?W:z,Z=0,se=O;se>a;)se=N[se]>>8,++Z;var Se=se;if(k+Z+(O!==W?1:0)>i)return void xi.log("Warning, gif stream longer than expected.");n[k++]=Se;var Ne=k+=Z;for(O!==W&&(n[k++]=Se),se=O;Z--;)se=N[se],n[--Ne]=255&se,se>>=8;z!==null&&d<4096&&(N[d++]=z<<8|Se,d>=v+1&&f<12&&(++f,v=v<<1|1)),z=W}else d=u+1,v=(1<<(f=o+1))-1,z=null}return k!==i&&xi.log("Warning, gif stream shorter than expected."),n}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function ef(e){var t,n,i,o,a,u=Math.floor,d=new Array(64),f=new Array(64),v=new Array(64),_=new Array(64),x=new Array(65535),k=new Array(65535),w=new Array(64),N=new Array(64),z=[],W=0,O=7,Z=new Array(64),se=new Array(64),Se=new Array(64),Ne=new Array(256),$e=new Array(2048),Pe=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],xe=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],Be=[0,1,2,3,4,5,6,7,8,9,10,11],ze=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],te=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],J=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],Ee=[0,1,2,3,4,5,6,7,8,9,10,11],he=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],P=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function F(T,ne){for(var ae=0,q=0,R=new Array,U=1;U<=16;U++){for(var H=1;H<=T[U];H++)R[ne[q]]=[],R[ne[q]][0]=ae,R[ne[q]][1]=U,q++,ae++;ae*=2}return R}function G(T){for(var ne=T[0],ae=T[1]-1;ae>=0;)ne&1<<ae&&(W|=1<<O),ae--,--O<0&&(W==255?(Q(255),Q(0)):Q(W),O=7,W=0)}function Q(T){z.push(T)}function Ae(T){Q(T>>8&255),Q(255&T)}function oe(T,ne,ae,q,R){for(var U,H=R[0],$=R[240],ce=function(Ue,nt){var st,Ct,xt,Ot,$t,Gt,ft,Fe,kt,Et,At=0;for(kt=0;kt<8;++kt){st=Ue[At],Ct=Ue[At+1],xt=Ue[At+2],Ot=Ue[At+3],$t=Ue[At+4],Gt=Ue[At+5],ft=Ue[At+6];var et=st+(Fe=Ue[At+7]),ot=st-Fe,wn=Ct+ft,Zt=Ct-ft,rn=xt+Gt,Gn=xt-Gt,Tn=Ot+$t,Kn=Ot-$t,Hn=et+Tn,Ui=et-Tn,Oi=wn+rn,zn=wn-rn;Ue[At]=Hn+Oi,Ue[At+4]=Hn-Oi;var Ut=.707106781*(zn+Ui);Ue[At+2]=Ui+Ut,Ue[At+6]=Ui-Ut;var An=.382683433*((Hn=Kn+Gn)-(zn=Zt+ot)),bi=.5411961*Hn+An,Yn=1.306562965*zn+An,wi=.707106781*(Oi=Gn+Zt),pi=ot+wi,sn=ot-wi;Ue[At+5]=sn+bi,Ue[At+3]=sn-bi,Ue[At+1]=pi+Yn,Ue[At+7]=pi-Yn,At+=8}for(At=0,kt=0;kt<8;++kt){st=Ue[At],Ct=Ue[At+8],xt=Ue[At+16],Ot=Ue[At+24],$t=Ue[At+32],Gt=Ue[At+40],ft=Ue[At+48];var gn=st+(Fe=Ue[At+56]),Yt=st-Fe,gi=Ct+ft,Rn=Ct-ft,_t=xt+Gt,Xn=xt-Gt,Ii=Ot+$t,ui=Ot-$t,yr=gn+Ii,lr=gn-Ii,_r=gi+_t,Ki=gi-_t;Ue[At]=yr+_r,Ue[At+32]=yr-_r;var ur=.707106781*(Ki+lr);Ue[At+16]=lr+ur,Ue[At+48]=lr-ur;var jr=.382683433*((yr=ui+Xn)-(Ki=Rn+Yt)),Es=.5411961*yr+jr,Zs=1.306562965*Ki+jr,Ks=.707106781*(_r=Xn+Rn),Gr=Yt+Ks,fs=Yt-Ks;Ue[At+40]=fs+Es,Ue[At+24]=fs-Es,Ue[At+8]=Gr+Zs,Ue[At+56]=Gr-Zs,At++}for(kt=0;kt<64;++kt)Et=Ue[kt]*nt[kt],w[kt]=Et>0?Et+.5|0:Et-.5|0;return w}(T,ne),ue=0;ue<64;++ue)N[Pe[ue]]=ce[ue];var V=N[0]-ae;ae=N[0],V==0?G(q[0]):(G(q[k[U=32767+V]]),G(x[U]));for(var K=63;K>0&&N[K]==0;)K--;if(K==0)return G(H),ae;for(var ye,ve=1;ve<=K;){for(var ee=ve;N[ve]==0&&ve<=K;)++ve;var Ge=ve-ee;if(Ge>=16){ye=Ge>>4;for(var tt=1;tt<=ye;++tt)G($);Ge&=15}U=32767+N[ve],G(R[(Ge<<4)+k[U]]),G(x[U]),ve++}return K!=63&&G(H),ae}function me(T){T=Math.min(Math.max(T,1),100),a!=T&&(function(ne){for(var ae=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],q=0;q<64;q++){var R=u((ae[q]*ne+50)/100);R=Math.min(Math.max(R,1),255),d[Pe[q]]=R}for(var U=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],H=0;H<64;H++){var $=u((U[H]*ne+50)/100);$=Math.min(Math.max($,1),255),f[Pe[H]]=$}for(var ce=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],ue=0,V=0;V<8;V++)for(var K=0;K<8;K++)v[ue]=1/(d[Pe[ue]]*ce[V]*ce[K]*8),_[ue]=1/(f[Pe[ue]]*ce[V]*ce[K]*8),ue++}(T<50?Math.floor(5e3/T):Math.floor(200-2*T)),a=T)}this.encode=function(T,ne){ne&&me(ne),z=new Array,W=0,O=7,Ae(65496),Ae(65504),Ae(16),Q(74),Q(70),Q(73),Q(70),Q(0),Q(1),Q(1),Q(0),Ae(1),Ae(1),Q(0),Q(0),function(){Ae(65499),Ae(132),Q(0);for(var Ct=0;Ct<64;Ct++)Q(d[Ct]);Q(1);for(var xt=0;xt<64;xt++)Q(f[xt])}(),function(Ct,xt){Ae(65472),Ae(17),Q(8),Ae(xt),Ae(Ct),Q(3),Q(1),Q(17),Q(0),Q(2),Q(17),Q(1),Q(3),Q(17),Q(1)}(T.width,T.height),function(){Ae(65476),Ae(418),Q(0);for(var Ct=0;Ct<16;Ct++)Q(xe[Ct+1]);for(var xt=0;xt<=11;xt++)Q(Be[xt]);Q(16);for(var Ot=0;Ot<16;Ot++)Q(ze[Ot+1]);for(var $t=0;$t<=161;$t++)Q(te[$t]);Q(1);for(var Gt=0;Gt<16;Gt++)Q(J[Gt+1]);for(var ft=0;ft<=11;ft++)Q(Ee[ft]);Q(17);for(var Fe=0;Fe<16;Fe++)Q(he[Fe+1]);for(var kt=0;kt<=161;kt++)Q(P[kt])}(),Ae(65498),Ae(12),Q(3),Q(1),Q(0),Q(2),Q(17),Q(3),Q(17),Q(0),Q(63),Q(0);var ae=0,q=0,R=0;W=0,O=7,this.encode.displayName="_encode_";for(var U,H,$,ce,ue,V,K,ye,ve,ee=T.data,Ge=T.width,tt=T.height,Ue=4*Ge,nt=0;nt<tt;){for(U=0;U<Ue;){for(ue=Ue*nt+U,K=-1,ye=0,ve=0;ve<64;ve++)V=ue+(ye=ve>>3)*Ue+(K=4*(7&ve)),nt+ye>=tt&&(V-=Ue*(nt+1+ye-tt)),U+K>=Ue&&(V-=U+K-Ue+4),H=ee[V++],$=ee[V++],ce=ee[V++],Z[ve]=($e[H]+$e[$+256>>0]+$e[ce+512>>0]>>16)-128,se[ve]=($e[H+768>>0]+$e[$+1024>>0]+$e[ce+1280>>0]>>16)-128,Se[ve]=($e[H+1280>>0]+$e[$+1536>>0]+$e[ce+1792>>0]>>16)-128;ae=oe(Z,v,ae,t,i),q=oe(se,_,q,n,o),R=oe(Se,_,R,n,o),U+=32}nt+=8}if(O>=0){var st=[];st[1]=O+1,st[0]=(1<<O+1)-1,G(st)}return Ae(65497),new Uint8Array(z)},e=e||50,function(){for(var T=String.fromCharCode,ne=0;ne<256;ne++)Ne[ne]=T(ne)}(),t=F(xe,Be),n=F(J,Ee),i=F(ze,te),o=F(he,P),function(){for(var T=1,ne=2,ae=1;ae<=15;ae++){for(var q=T;q<ne;q++)k[32767+q]=ae,x[32767+q]=[],x[32767+q][1]=ae,x[32767+q][0]=q;for(var R=-(ne-1);R<=-T;R++)k[32767+R]=ae,x[32767+R]=[],x[32767+R][1]=ae,x[32767+R][0]=ne-1+R;T<<=1,ne<<=1}}(),function(){for(var T=0;T<256;T++)$e[T]=19595*T,$e[T+256>>0]=38470*T,$e[T+512>>0]=7471*T+32768,$e[T+768>>0]=-11059*T,$e[T+1024>>0]=-21709*T,$e[T+1280>>0]=32768*T+8421375,$e[T+1536>>0]=-27439*T,$e[T+1792>>0]=-5329*T}(),me(e)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Jo(e,t){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function Cg(e){function t(xe){if(!xe)throw Error("assert :P")}function n(xe,Be,ze){for(var te=0;4>te;te++)if(xe[Be+te]!=ze.charCodeAt(te))return!0;return!1}function i(xe,Be,ze,te,J){for(var Ee=0;Ee<J;Ee++)xe[Be+Ee]=ze[te+Ee]}function o(xe,Be,ze,te){for(var J=0;J<te;J++)xe[Be+J]=ze}function a(xe){return new Int32Array(xe)}function u(xe,Be){for(var ze=[],te=0;te<xe;te++)ze.push(new Be);return ze}function d(xe,Be){var ze=[];return function te(J,Ee,he){for(var P=he[Ee],F=0;F<P&&(J.push(he.length>Ee+1?[]:new Be),!(he.length<Ee+1));F++)te(J[F],Ee+1,he)}(ze,0,xe),ze}var f=function(){var xe=this;function Be(p,b){for(var M=1<<b-1>>>0;p&M;)M>>>=1;return M?(p&M-1)+M:p}function ze(p,b,M,I,re){t(!(I%M));do p[b+(I-=M)]=re;while(0<I)}function te(p,b,M,I,re){if(t(2328>=re),512>=re)var fe=a(512);else if((fe=a(re))==null)return 0;return function(ge,_e,be,Me,Ye,mt){var vt,lt,St=_e,Lt=1<<be,Qe=a(16),rt=a(16);for(t(Ye!=0),t(Me!=null),t(ge!=null),t(0<be),lt=0;lt<Ye;++lt){if(15<Me[lt])return 0;++Qe[Me[lt]]}if(Qe[0]==Ye)return 0;for(rt[1]=0,vt=1;15>vt;++vt){if(Qe[vt]>1<<vt)return 0;rt[vt+1]=rt[vt]+Qe[vt]}for(lt=0;lt<Ye;++lt)vt=Me[lt],0<Me[lt]&&(mt[rt[vt]++]=lt);if(rt[15]==1)return(Me=new J).g=0,Me.value=mt[0],ze(ge,St,1,Lt,Me),Lt;var Mt,Ft=-1,Nt=Lt-1,tn=0,Ht=1,pn=1,s=1<<be;for(lt=0,vt=1,Ye=2;vt<=be;++vt,Ye<<=1){if(Ht+=pn<<=1,0>(pn-=Qe[vt]))return 0;for(;0<Qe[vt];--Qe[vt])(Me=new J).g=vt,Me.value=mt[lt++],ze(ge,St+tn,Ye,s,Me),tn=Be(tn,vt)}for(vt=be+1,Ye=2;15>=vt;++vt,Ye<<=1){if(Ht+=pn<<=1,0>(pn-=Qe[vt]))return 0;for(;0<Qe[vt];--Qe[vt]){if(Me=new J,(tn&Nt)!=Ft){for(St+=s,Mt=1<<(Ft=vt)-be;15>Ft&&!(0>=(Mt-=Qe[Ft]));)++Ft,Mt<<=1;Lt+=s=1<<(Mt=Ft-be),ge[_e+(Ft=tn&Nt)].g=Mt+be,ge[_e+Ft].value=St-_e-Ft}Me.g=vt-be,Me.value=mt[lt++],ze(ge,St+(tn>>be),Ye,s,Me),tn=Be(tn,vt)}}return Ht!=2*rt[15]-1?0:Lt}(p,b,M,I,re,fe)}function J(){this.value=this.g=0}function Ee(){this.value=this.g=0}function he(){this.G=u(5,J),this.H=a(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=u(ji,Ee)}function P(p,b,M,I){t(p!=null),t(b!=null),t(2147483648>I),p.Ca=254,p.I=0,p.b=-8,p.Ka=0,p.oa=b,p.pa=M,p.Jd=b,p.Yc=M+I,p.Zc=4<=I?M+I-4+1:M,U(p)}function F(p,b){for(var M=0;0<b--;)M|=$(p,128)<<b;return M}function G(p,b){var M=F(p,b);return H(p)?-M:M}function Q(p,b,M,I){var re,fe=0;for(t(p!=null),t(b!=null),t(4294967288>I),p.Sb=I,p.Ra=0,p.u=0,p.h=0,4<I&&(I=4),re=0;re<I;++re)fe+=b[M+re]<<8*re;p.Ra=fe,p.bb=I,p.oa=b,p.pa=M}function Ae(p){for(;8<=p.u&&p.bb<p.Sb;)p.Ra>>>=8,p.Ra+=p.oa[p.pa+p.bb]<<Lr-8>>>0,++p.bb,p.u-=8;ae(p)&&(p.h=1,p.u=0)}function oe(p,b){if(t(0<=b),!p.h&&b<=Ar){var M=ne(p)&_a[b];return p.u+=b,Ae(p),M}return p.h=1,p.u=0}function me(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function T(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function ne(p){return p.Ra>>>(p.u&Lr-1)>>>0}function ae(p){return t(p.bb<=p.Sb),p.h||p.bb==p.Sb&&p.u>Lr}function q(p,b){p.u=b,p.h=ae(p)}function R(p){p.u>=ba&&(t(p.u>=ba),Ae(p))}function U(p){t(p!=null&&p.oa!=null),p.pa<p.Zc?(p.I=(p.oa[p.pa++]|p.I<<8)>>>0,p.b+=8):(t(p!=null&&p.oa!=null),p.pa<p.Yc?(p.b+=8,p.I=p.oa[p.pa++]|p.I<<8):p.Ka?p.b=0:(p.I<<=8,p.b+=8,p.Ka=1))}function H(p){return F(p,1)}function $(p,b){var M=p.Ca;0>p.b&&U(p);var I=p.b,re=M*b>>>8,fe=(p.I>>>I>re)+0;for(fe?(M-=re,p.I-=re+1<<I>>>0):M=re+1,I=M,re=0;256<=I;)re+=8,I>>=8;return I=7^re+hr[I],p.b-=I,p.Ca=(M<<I)-1,fe}function ce(p,b,M){p[b+0]=M>>24&255,p[b+1]=M>>16&255,p[b+2]=M>>8&255,p[b+3]=M>>0&255}function ue(p,b){return p[b+0]<<0|p[b+1]<<8}function V(p,b){return ue(p,b)|p[b+2]<<16}function K(p,b){return ue(p,b)|ue(p,b+2)<<16}function ye(p,b){var M=1<<b;return t(p!=null),t(0<b),p.X=a(M),p.X==null?0:(p.Mb=32-b,p.Xa=b,1)}function ve(p,b){t(p!=null),t(b!=null),t(p.Xa==b.Xa),i(b.X,0,p.X,0,1<<b.Xa)}function ee(){this.X=[],this.Xa=this.Mb=0}function Ge(p,b,M,I){t(M!=null),t(I!=null);var re=M[0],fe=I[0];return re==0&&(re=(p*fe+b/2)/b),fe==0&&(fe=(b*re+p/2)/p),0>=re||0>=fe?0:(M[0]=re,I[0]=fe,1)}function tt(p,b){return p+(1<<b)-1>>>b}function Ue(p,b){return((4278255360&p)+(4278255360&b)>>>0&4278255360)+((16711935&p)+(16711935&b)>>>0&16711935)>>>0}function nt(p,b){xe[b]=function(M,I,re,fe,ge,_e,be){var Me;for(Me=0;Me<ge;++Me){var Ye=xe[p](_e[be+Me-1],re,fe+Me);_e[be+Me]=Ue(M[I+Me],Ye)}}}function st(){this.ud=this.hd=this.jd=0}function Ct(p,b){return((4278124286&(p^b))>>>1)+(p&b)>>>0}function xt(p){return 0<=p&&256>p?p:0>p?0:255<p?255:void 0}function Ot(p,b){return xt(p+(p-b+.5>>1))}function $t(p,b,M){return Math.abs(b-M)-Math.abs(p-M)}function Gt(p,b,M,I,re,fe,ge){for(I=fe[ge-1],M=0;M<re;++M)fe[ge+M]=I=Ue(p[b+M],I)}function ft(p,b,M,I,re){var fe;for(fe=0;fe<M;++fe){var ge=p[b+fe],_e=ge>>8&255,be=16711935&(be=(be=16711935&ge)+((_e<<16)+_e));I[re+fe]=(4278255360&ge)+be>>>0}}function Fe(p,b){b.jd=p>>0&255,b.hd=p>>8&255,b.ud=p>>16&255}function kt(p,b,M,I,re,fe){var ge;for(ge=0;ge<I;++ge){var _e=b[M+ge],be=_e>>>8,Me=_e,Ye=255&(Ye=(Ye=_e>>>16)+((p.jd<<24>>24)*(be<<24>>24)>>>5));Me=255&(Me=(Me=Me+((p.hd<<24>>24)*(be<<24>>24)>>>5))+((p.ud<<24>>24)*(Ye<<24>>24)>>>5)),re[fe+ge]=(4278255360&_e)+(Ye<<16)+Me}}function Et(p,b,M,I,re){xe[b]=function(fe,ge,_e,be,Me,Ye,mt,vt,lt){for(be=mt;be<vt;++be)for(mt=0;mt<lt;++mt)Me[Ye++]=re(_e[I(fe[ge++])])},xe[p]=function(fe,ge,_e,be,Me,Ye,mt){var vt=8>>fe.b,lt=fe.Ea,St=fe.K[0],Lt=fe.w;if(8>vt)for(fe=(1<<fe.b)-1,Lt=(1<<vt)-1;ge<_e;++ge){var Qe,rt=0;for(Qe=0;Qe<lt;++Qe)Qe&fe||(rt=I(be[Me++])),Ye[mt++]=re(St[rt&Lt]),rt>>=vt}else xe["VP8LMapColor"+M](be,Me,St,Lt,Ye,mt,ge,_e,lt)}}function At(p,b,M,I,re){for(M=b+M;b<M;){var fe=p[b++];I[re++]=fe>>16&255,I[re++]=fe>>8&255,I[re++]=fe>>0&255}}function et(p,b,M,I,re){for(M=b+M;b<M;){var fe=p[b++];I[re++]=fe>>16&255,I[re++]=fe>>8&255,I[re++]=fe>>0&255,I[re++]=fe>>24&255}}function ot(p,b,M,I,re){for(M=b+M;b<M;){var fe=(ge=p[b++])>>16&240|ge>>12&15,ge=ge>>0&240|ge>>28&15;I[re++]=fe,I[re++]=ge}}function wn(p,b,M,I,re){for(M=b+M;b<M;){var fe=(ge=p[b++])>>16&248|ge>>13&7,ge=ge>>5&224|ge>>3&31;I[re++]=fe,I[re++]=ge}}function Zt(p,b,M,I,re){for(M=b+M;b<M;){var fe=p[b++];I[re++]=fe>>0&255,I[re++]=fe>>8&255,I[re++]=fe>>16&255}}function rn(p,b,M,I,re,fe){if(fe==0)for(M=b+M;b<M;)ce(I,((fe=p[b++])[0]>>24|fe[1]>>8&65280|fe[2]<<8&16711680|fe[3]<<24)>>>0),re+=32;else i(I,re,p,b,M)}function Gn(p,b){xe[b][0]=xe[p+"0"],xe[b][1]=xe[p+"1"],xe[b][2]=xe[p+"2"],xe[b][3]=xe[p+"3"],xe[b][4]=xe[p+"4"],xe[b][5]=xe[p+"5"],xe[b][6]=xe[p+"6"],xe[b][7]=xe[p+"7"],xe[b][8]=xe[p+"8"],xe[b][9]=xe[p+"9"],xe[b][10]=xe[p+"10"],xe[b][11]=xe[p+"11"],xe[b][12]=xe[p+"12"],xe[b][13]=xe[p+"13"],xe[b][14]=xe[p+"0"],xe[b][15]=xe[p+"0"]}function Tn(p){return p==Pr||p==kr||p==zs||p==r}function Kn(){this.eb=[],this.size=this.A=this.fb=0}function Hn(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Ui(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new Kn,this.f.kb=new Hn,this.sd=null}function Oi(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function zn(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Ut(p){return alert("todo:WebPSamplerProcessPlane"),p.T}function An(p,b){var M=p.T,I=b.ba.f.RGBA,re=I.eb,fe=I.fb+p.ka*I.A,ge=gr[b.ba.S],_e=p.y,be=p.O,Me=p.f,Ye=p.N,mt=p.ea,vt=p.W,lt=b.cc,St=b.dc,Lt=b.Mc,Qe=b.Nc,rt=p.ka,Mt=p.ka+p.T,Ft=p.U,Nt=Ft+1>>1;for(rt==0?ge(_e,be,null,null,Me,Ye,mt,vt,Me,Ye,mt,vt,re,fe,null,null,Ft):(ge(b.ec,b.fc,_e,be,lt,St,Lt,Qe,Me,Ye,mt,vt,re,fe-I.A,re,fe,Ft),++M);rt+2<Mt;rt+=2)lt=Me,St=Ye,Lt=mt,Qe=vt,Ye+=p.Rc,vt+=p.Rc,fe+=2*I.A,ge(_e,(be+=2*p.fa)-p.fa,_e,be,lt,St,Lt,Qe,Me,Ye,mt,vt,re,fe-I.A,re,fe,Ft);return be+=p.fa,p.j+Mt<p.o?(i(b.ec,b.fc,_e,be,Ft),i(b.cc,b.dc,Me,Ye,Nt),i(b.Mc,b.Nc,mt,vt,Nt),M--):1&Mt||ge(_e,be,null,null,Me,Ye,mt,vt,Me,Ye,mt,vt,re,fe+I.A,null,null,Ft),M}function bi(p,b,M){var I=p.F,re=[p.J];if(I!=null){var fe=p.U,ge=b.ba.S,_e=ge==ns||ge==zs;b=b.ba.f.RGBA;var be=[0],Me=p.ka;be[0]=p.T,p.Kb&&(Me==0?--be[0]:(--Me,re[0]-=p.width),p.j+p.ka+p.T==p.o&&(be[0]=p.o-p.j-Me));var Ye=b.eb;Me=b.fb+Me*b.A,p=ti(I,re[0],p.width,fe,be,Ye,Me+(_e?0:3),b.A),t(M==be),p&&Tn(ge)&&tr(Ye,Me,_e,fe,be,b.A)}return 0}function Yn(p){var b=p.ma,M=b.ba.S,I=11>M,re=M==_n||M==Zo||M==ns||M==pr||M==12||Tn(M);if(b.memory=null,b.Ib=null,b.Jb=null,b.Nd=null,!Va(b.Oa,p,re?11:12))return 0;if(re&&Tn(M)&&zt(),p.da)alert("todo:use_scaling");else{if(I){if(b.Ib=Ut,p.Kb){if(M=p.U+1>>1,b.memory=a(p.U+2*M),b.memory==null)return 0;b.ec=b.memory,b.fc=0,b.cc=b.ec,b.dc=b.fc+p.U,b.Mc=b.cc,b.Nc=b.dc+M,b.Ib=An,zt()}}else alert("todo:EmitYUV");re&&(b.Jb=bi,I&&ut())}if(I&&!fl){for(p=0;256>p;++p)gu[p]=89858*(p-128)+$l>>pu,mu[p]=-22014*(p-128)+$l,yd[p]=-45773*(p-128),vd[p]=113618*(p-128)+$l>>pu;for(p=ql;p<Zu;++p)b=76283*(p-16)+$l>>pu,vu[p-ql]=oi(b,255),$c[p-ql]=oi(b+8>>4,15);fl=1}return 1}function wi(p){var b=p.ma,M=p.U,I=p.T;return t(!(1&p.ka)),0>=M||0>=I?0:(M=b.Ib(p,b),b.Jb!=null&&b.Jb(p,b,M),b.Dc+=M,1)}function pi(p){p.ma.memory=null}function sn(p,b,M,I){return oe(p,8)!=47?0:(b[0]=oe(p,14)+1,M[0]=oe(p,14)+1,I[0]=oe(p,1),oe(p,3)!=0?0:!p.h)}function gn(p,b){if(4>p)return p+1;var M=p-2>>1;return(2+(1&p)<<M)+oe(b,M)+1}function Yt(p,b){return 120<b?b-120:1<=(M=((M=Ve[b-1])>>4)*p+(8-(15&M)))?M:1;var M}function gi(p,b,M){var I=ne(M),re=p[b+=255&I].g-8;return 0<re&&(q(M,M.u+8),I=ne(M),b+=p[b].value,b+=I&(1<<re)-1),q(M,M.u+p[b].g),p[b].value}function Rn(p,b,M){return M.g+=p.g,M.value+=p.value<<b>>>0,t(8>=M.g),p.g}function _t(p,b,M){var I=p.xc;return t((b=I==0?0:p.vc[p.md*(M>>I)+(b>>I)])<p.Wb),p.Ya[b]}function Xn(p,b,M,I){var re=p.ab,fe=p.c*b,ge=p.C;b=ge+b;var _e=M,be=I;for(I=p.Ta,M=p.Ua;0<re--;){var Me=p.gc[re],Ye=ge,mt=b,vt=_e,lt=be,St=(be=I,_e=M,Me.Ea);switch(t(Ye<mt),t(mt<=Me.nc),Me.hc){case 2:ul(vt,lt,(mt-Ye)*St,be,_e);break;case 0:var Lt=Ye,Qe=mt,rt=be,Mt=_e,Ft=(s=Me).Ea;Lt==0&&(io(vt,lt,null,null,1,rt,Mt),Gt(vt,lt+1,0,0,Ft-1,rt,Mt+1),lt+=Ft,Mt+=Ft,++Lt);for(var Nt=1<<s.b,tn=Nt-1,Ht=tt(Ft,s.b),pn=s.K,s=s.w+(Lt>>s.b)*Ht;Lt<Qe;){var l=pn,h=s,g=1;for(qr(vt,lt,rt,Mt-Ft,1,rt,Mt);g<Ft;){var y=(g&~tn)+Nt;y>Ft&&(y=Ft),(0,ro[l[h++]>>8&15])(vt,lt+ +g,rt,Mt+g-Ft,y-g,rt,Mt+g),g=y}lt+=Ft,Mt+=Ft,++Lt&tn||(s+=Ht)}mt!=Me.nc&&i(be,_e-St,be,_e+(mt-Ye-1)*St,St);break;case 1:for(St=vt,Qe=lt,Ft=(vt=Me.Ea)-(Mt=vt&~(rt=(lt=1<<Me.b)-1)),Lt=tt(vt,Me.b),Nt=Me.K,Me=Me.w+(Ye>>Me.b)*Lt;Ye<mt;){for(tn=Nt,Ht=Me,pn=new st,s=Qe+Mt,l=Qe+vt;Qe<s;)Fe(tn[Ht++],pn),Os(pn,St,Qe,lt,be,_e),Qe+=lt,_e+=lt;Qe<l&&(Fe(tn[Ht++],pn),Os(pn,St,Qe,Ft,be,_e),Qe+=Ft,_e+=Ft),++Ye&rt||(Me+=Lt)}break;case 3:if(vt==be&&lt==_e&&0<Me.b){for(Qe=be,vt=St=_e+(mt-Ye)*St-(Mt=(mt-Ye)*tt(Me.Ea,Me.b)),lt=be,rt=_e,Lt=[],Mt=(Ft=Mt)-1;0<=Mt;--Mt)Lt[Mt]=lt[rt+Mt];for(Mt=Ft-1;0<=Mt;--Mt)Qe[vt+Mt]=Lt[Mt];Gi(Me,Ye,mt,be,St,be,_e)}else Gi(Me,Ye,mt,vt,lt,be,_e)}_e=I,be=M}be!=M&&i(I,M,_e,be,fe)}function Ii(p,b){var M=p.V,I=p.Ba+p.c*p.C,re=b-p.C;if(t(b<=p.l.o),t(16>=re),0<re){var fe=p.l,ge=p.Ta,_e=p.Ua,be=fe.width;if(Xn(p,re,M,I),re=_e=[_e],t((M=p.C)<(I=b)),t(fe.v<fe.va),I>fe.o&&(I=fe.o),M<fe.j){var Me=fe.j-M;M=fe.j,re[0]+=Me*be}if(M>=I?M=0:(re[0]+=4*fe.v,fe.ka=M-fe.j,fe.U=fe.va-fe.v,fe.T=I-M,M=1),M){if(_e=_e[0],11>(M=p.ca).S){var Ye=M.f.RGBA,mt=(I=M.S,re=fe.U,fe=fe.T,Me=Ye.eb,Ye.A),vt=fe;for(Ye=Ye.fb+p.Ma*Ye.A;0<vt--;){var lt=ge,St=_e,Lt=re,Qe=Me,rt=Ye;switch(I){case Nr:er(lt,St,Lt,Qe,rt);break;case _n:Yi(lt,St,Lt,Qe,rt);break;case Pr:Yi(lt,St,Lt,Qe,rt),tr(Qe,rt,0,Lt,1,0);break;case hl:Qr(lt,St,Lt,Qe,rt);break;case Zo:rn(lt,St,Lt,Qe,rt,1);break;case kr:rn(lt,St,Lt,Qe,rt,1),tr(Qe,rt,0,Lt,1,0);break;case ns:rn(lt,St,Lt,Qe,rt,0);break;case zs:rn(lt,St,Lt,Qe,rt,0),tr(Qe,rt,1,Lt,1,0);break;case pr:ys(lt,St,Lt,Qe,rt);break;case r:ys(lt,St,Lt,Qe,rt),ri(Qe,rt,Lt,1,0);break;case jl:Mr(lt,St,Lt,Qe,rt);break;default:t(0)}_e+=be,Ye+=mt}p.Ma+=fe}else alert("todo:EmitRescaledRowsYUVA");t(p.Ma<=M.height)}}p.C=b,t(p.C<=p.i)}function ui(p){var b;if(0<p.ua)return 0;for(b=0;b<p.Wb;++b){var M=p.Ya[b].G,I=p.Ya[b].H;if(0<M[1][I[1]+0].g||0<M[2][I[2]+0].g||0<M[3][I[3]+0].g)return 0}return 1}function yr(p,b,M,I,re,fe){if(p.Z!=0){var ge=p.qd,_e=p.rd;for(t(si[p.Z]!=null);b<M;++b)si[p.Z](ge,_e,I,re,I,re,fe),ge=I,_e=re,re+=fe;p.qd=ge,p.rd=_e}}function lr(p,b){var M=p.l.ma,I=M.Z==0||M.Z==1?p.l.j:p.C;if(I=p.C<I?I:p.C,t(b<=p.l.o),b>I){var re=p.l.width,fe=M.ca,ge=M.tb+re*I,_e=p.V,be=p.Ba+p.c*I,Me=p.gc;t(p.ab==1),t(Me[0].hc==3),Xr(Me[0],I,b,_e,be,fe,ge),yr(M,I,b,fe,ge,re)}p.C=p.Ma=b}function _r(p,b,M,I,re,fe,ge){var _e=p.$/I,be=p.$%I,Me=p.m,Ye=p.s,mt=M+p.$,vt=mt;re=M+I*re;var lt=M+I*fe,St=280+Ye.ua,Lt=p.Pb?_e:16777216,Qe=0<Ye.ua?Ye.Wa:null,rt=Ye.wc,Mt=mt<lt?_t(Ye,be,_e):null;t(p.C<fe),t(lt<=re);var Ft=!1;e:for(;;){for(;Ft||mt<lt;){var Nt=0;if(_e>=Lt){var tn=mt-M;t((Lt=p).Pb),Lt.wd=Lt.m,Lt.xd=tn,0<Lt.s.ua&&ve(Lt.s.Wa,Lt.s.vb),Lt=_e+bt}if(be&rt||(Mt=_t(Ye,be,_e)),t(Mt!=null),Mt.Qb&&(b[mt]=Mt.qb,Ft=!0),!Ft)if(R(Me),Mt.jc){Nt=Me,tn=b;var Ht=mt,pn=Mt.pd[ne(Nt)&ji-1];t(Mt.jc),256>pn.g?(q(Nt,Nt.u+pn.g),tn[Ht]=pn.value,Nt=0):(q(Nt,Nt.u+pn.g-256),t(256<=pn.value),Nt=pn.value),Nt==0&&(Ft=!0)}else Nt=gi(Mt.G[0],Mt.H[0],Me);if(Me.h)break;if(Ft||256>Nt){if(!Ft)if(Mt.nd)b[mt]=(Mt.qb|Nt<<8)>>>0;else{if(R(Me),Ft=gi(Mt.G[1],Mt.H[1],Me),R(Me),tn=gi(Mt.G[2],Mt.H[2],Me),Ht=gi(Mt.G[3],Mt.H[3],Me),Me.h)break;b[mt]=(Ht<<24|Ft<<16|Nt<<8|tn)>>>0}if(Ft=!1,++mt,++be>=I&&(be=0,++_e,ge!=null&&_e<=fe&&!(_e%16)&&ge(p,_e),Qe!=null))for(;vt<mt;)Nt=b[vt++],Qe.X[(506832829*Nt&4294967295)>>>Qe.Mb]=Nt}else if(280>Nt){if(Nt=gn(Nt-256,Me),tn=gi(Mt.G[4],Mt.H[4],Me),R(Me),tn=Yt(I,tn=gn(tn,Me)),Me.h)break;if(mt-M<tn||re-mt<Nt)break e;for(Ht=0;Ht<Nt;++Ht)b[mt+Ht]=b[mt+Ht-tn];for(mt+=Nt,be+=Nt;be>=I;)be-=I,++_e,ge!=null&&_e<=fe&&!(_e%16)&&ge(p,_e);if(t(mt<=re),be&rt&&(Mt=_t(Ye,be,_e)),Qe!=null)for(;vt<mt;)Nt=b[vt++],Qe.X[(506832829*Nt&4294967295)>>>Qe.Mb]=Nt}else{if(!(Nt<St))break e;for(Ft=Nt-280,t(Qe!=null);vt<mt;)Nt=b[vt++],Qe.X[(506832829*Nt&4294967295)>>>Qe.Mb]=Nt;Nt=mt,t(!(Ft>>>(tn=Qe).Xa)),b[Nt]=tn.X[Ft],Ft=!0}Ft||t(Me.h==ae(Me))}if(p.Pb&&Me.h&&mt<re)t(p.m.h),p.a=5,p.m=p.wd,p.$=p.xd,0<p.s.ua&&ve(p.s.vb,p.s.Wa);else{if(Me.h)break e;ge!=null&&ge(p,_e>fe?fe:_e),p.a=0,p.$=mt-M}return 1}return p.a=3,0}function Ki(p){t(p!=null),p.vc=null,p.yc=null,p.Ya=null;var b=p.Wa;b!=null&&(b.X=null),p.vb=null,t(p!=null)}function ur(){var p=new $a;return p==null?null:(p.a=0,p.xb=Ul,Gn("Predictor","VP8LPredictors"),Gn("Predictor","VP8LPredictors_C"),Gn("PredictorAdd","VP8LPredictorsAdd"),Gn("PredictorAdd","VP8LPredictorsAdd_C"),ul=ft,Os=kt,er=At,Yi=et,ys=ot,Mr=wn,Qr=Zt,xe.VP8LMapColor32b=Rs,xe.VP8LMapColor8b=Ho,p)}function jr(p,b,M,I,re){var fe=1,ge=[p],_e=[b],be=I.m,Me=I.s,Ye=null,mt=0;e:for(;;){if(M)for(;fe&&oe(be,1);){var vt=ge,lt=_e,St=I,Lt=1,Qe=St.m,rt=St.gc[St.ab],Mt=oe(Qe,2);if(St.Oc&1<<Mt)fe=0;else{switch(St.Oc|=1<<Mt,rt.hc=Mt,rt.Ea=vt[0],rt.nc=lt[0],rt.K=[null],++St.ab,t(4>=St.ab),Mt){case 0:case 1:rt.b=oe(Qe,3)+2,Lt=jr(tt(rt.Ea,rt.b),tt(rt.nc,rt.b),0,St,rt.K),rt.K=rt.K[0];break;case 3:var Ft,Nt=oe(Qe,8)+1,tn=16<Nt?0:4<Nt?1:2<Nt?2:3;if(vt[0]=tt(rt.Ea,tn),rt.b=tn,Ft=Lt=jr(Nt,1,0,St,rt.K)){var Ht,pn=Nt,s=rt,l=1<<(8>>s.b),h=a(l);if(h==null)Ft=0;else{var g=s.K[0],y=s.w;for(h[0]=s.K[0][0],Ht=1;Ht<1*pn;++Ht)h[Ht]=Ue(g[y+Ht],h[Ht-1]);for(;Ht<4*l;++Ht)h[Ht]=0;s.K[0]=null,s.K[0]=h,Ft=1}}Lt=Ft;break;case 2:break;default:t(0)}fe=Lt}}if(ge=ge[0],_e=_e[0],fe&&oe(be,1)&&!(fe=1<=(mt=oe(be,4))&&11>=mt)){I.a=3;break e}var S;if(S=fe)t:{var B,D,Y,le=I,Oe=ge,Te=_e,it=mt,pt=M,Tt=le.m,qt=le.s,Vt=[null],bn=1,Re=0,qe=dt[it];n:for(;;){if(pt&&oe(Tt,1)){var Je=oe(Tt,3)+2,yt=tt(Oe,Je),at=tt(Te,Je),gt=yt*at;if(!jr(yt,at,0,le,Vt))break n;for(Vt=Vt[0],qt.xc=Je,B=0;B<gt;++B){var X=Vt[B]>>8&65535;Vt[B]=X,X>=bn&&(bn=X+1)}}if(Tt.h)break n;for(D=0;5>D;++D){var de=E[D];!D&&0<it&&(de+=1<<it),Re<de&&(Re=de)}var Le=u(bn*qe,J),we=bn,Ce=u(we,he);if(Ce==null)var ke=null;else t(65536>=we),ke=Ce;var Ze=a(Re);if(ke==null||Ze==null||Le==null){le.a=1;break n}var He=Le;for(B=Y=0;B<bn;++B){var Xe=ke[B],ht=Xe.G,ct=Xe.H,Rt=0,Xt=1,nn=0;for(D=0;5>D;++D){de=E[D],ht[D]=He,ct[D]=Y,!D&&0<it&&(de+=1<<it);r:{var an,Jn=de,ni=le,$n=Ze,hi=He,Rr=Y,pl=0,Eo=ni.m,Ku=oe(Eo,1);if(o($n,0,0,Jn),Ku){var Ao=oe(Eo,1)+1,Vl=oe(Eo,1),ws=oe(Eo,Vl==0?1:8);$n[ws]=1,Ao==2&&($n[ws=oe(Eo,8)]=1);var mr=1}else{var Ni=a(19),gp=oe(Eo,4)+4;if(19<gp){ni.a=3;var Wc=0;break r}for(an=0;an<gp;++an)Ni[pe[an]]=oe(Eo,3);var _d=void 0,Yu=void 0,mp=ni,fv=Ni,Zc=Jn,vp=$n,bd=0,gl=mp.m,yp=8,_p=u(128,J);i:for(;te(_p,0,7,fv,19);){if(oe(gl,1)){var pv=2+2*oe(gl,3);if((_d=2+oe(gl,pv))>Zc)break i}else _d=Zc;for(Yu=0;Yu<Zc&&_d--;){R(gl);var bp=_p[0+(127&ne(gl))];q(gl,gl.u+bp.g);var _u=bp.value;if(16>_u)vp[Yu++]=_u,_u!=0&&(yp=_u);else{var gv=_u==16,wp=_u-16,mv=m[wp],xp=oe(gl,c[wp])+mv;if(Yu+xp>Zc)break i;for(var vv=gv?yp:0;0<xp--;)vp[Yu++]=vv}}bd=1;break i}bd||(mp.a=3),mr=bd}(mr=mr&&!Eo.h)&&(pl=te(hi,Rr,8,$n,Jn)),mr&&pl!=0?Wc=pl:(ni.a=3,Wc=0)}if(Wc==0)break n;if(Xt&&j[D]==1&&(Xt=He[Y].g==0),Rt+=He[Y].g,Y+=Wc,3>=D){var Ju,wd=Ze[0];for(Ju=1;Ju<de;++Ju)Ze[Ju]>wd&&(wd=Ze[Ju]);nn+=wd}}if(Xe.nd=Xt,Xe.Qb=0,Xt&&(Xe.qb=(ht[3][ct[3]+0].value<<24|ht[1][ct[1]+0].value<<16|ht[2][ct[2]+0].value)>>>0,Rt==0&&256>ht[0][ct[0]+0].value&&(Xe.Qb=1,Xe.qb+=ht[0][ct[0]+0].value<<8)),Xe.jc=!Xe.Qb&&6>nn,Xe.jc){var Kc,Wa=Xe;for(Kc=0;Kc<ji;++Kc){var ml=Kc,vl=Wa.pd[ml],Yc=Wa.G[0][Wa.H[0]+ml];256<=Yc.value?(vl.g=Yc.g+256,vl.value=Yc.value):(vl.g=0,vl.value=0,ml>>=Rn(Yc,8,vl),ml>>=Rn(Wa.G[1][Wa.H[1]+ml],16,vl),ml>>=Rn(Wa.G[2][Wa.H[2]+ml],0,vl),Rn(Wa.G[3][Wa.H[3]+ml],24,vl))}}}qt.vc=Vt,qt.Wb=bn,qt.Ya=ke,qt.yc=Le,S=1;break t}S=0}if(!(fe=S)){I.a=3;break e}if(0<mt){if(Me.ua=1<<mt,!ye(Me.Wa,mt)){I.a=1,fe=0;break e}}else Me.ua=0;var xd=I,Lp=ge,yv=_e,Ld=xd.s,Cd=Ld.xc;if(xd.c=Lp,xd.i=yv,Ld.md=tt(Lp,Cd),Ld.wc=Cd==0?-1:(1<<Cd)-1,M){I.xb=Hu;break e}if((Ye=a(ge*_e))==null){I.a=1,fe=0;break e}fe=(fe=_r(I,Ye,0,ge,_e,_e,null))&&!be.h;break e}return fe?(re!=null?re[0]=Ye:(t(Ye==null),t(M)),I.$=0,M||Ki(Me)):Ki(Me),fe}function Es(p,b){var M=p.c*p.i,I=M+b+16*b;return t(p.c<=b),p.V=a(I),p.V==null?(p.Ta=null,p.Ua=0,p.a=1,0):(p.Ta=p.V,p.Ua=p.Ba+M+b,1)}function Zs(p,b){var M=p.C,I=b-M,re=p.V,fe=p.Ba+p.c*M;for(t(b<=p.l.o);0<I;){var ge=16<I?16:I,_e=p.l.ma,be=p.l.width,Me=be*ge,Ye=_e.ca,mt=_e.tb+be*M,vt=p.Ta,lt=p.Ua;Xn(p,ge,re,fe),Ti(vt,lt,Ye,mt,Me),yr(_e,M,M+ge,Ye,mt,be),I-=ge,re+=ge*p.c,M+=ge}t(M==b),p.C=p.Ma=b}function Ks(){this.ub=this.yd=this.td=this.Rb=0}function Gr(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function fs(){this.Fb=this.Bb=this.Cb=0,this.Zb=a(4),this.Lb=a(4)}function As(){this.Yb=function(){var p=[];return function b(M,I,re){for(var fe=re[I],ge=0;ge<fe&&(M.push(re.length>I+1?[]:0),!(re.length<I+1));ge++)b(M[ge],I+1,re)}(p,0,[3,11]),p}()}function aa(){this.jb=a(3),this.Wc=d([4,8],As),this.Xc=d([4,17],As)}function la(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new a(4),this.od=new a(4)}function Ys(){this.ld=this.La=this.dd=this.tc=0}function Io(){this.Na=this.la=0}function ua(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Ms(){this.ad=a(384),this.Za=0,this.Ob=a(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Bs(){this.uc=this.M=this.Nb=0,this.wa=Array(new Ys),this.Y=0,this.ya=Array(new Ms),this.aa=0,this.l=new cr}function go(){this.y=a(16),this.f=a(8),this.ea=a(8)}function Fo(){this.cb=this.a=0,this.sc="",this.m=new me,this.Od=new Ks,this.Kc=new Gr,this.ed=new la,this.Qa=new fs,this.Ic=this.$c=this.Aa=0,this.D=new Bs,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=u(8,me),this.ia=0,this.pb=u(4,ua),this.Pa=new aa,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new go),this.Hd=0,this.rb=Array(new Io),this.sb=0,this.wa=Array(new Ys),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Ms),this.L=this.aa=0,this.gd=d([4,2],Ys),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function cr(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function On(){var p=new Fo;return p!=null&&(p.a=0,p.sc="OK",p.cb=0,p.Xb=0,cn||(cn=zr)),p}function yn(p,b,M){return p.a==0&&(p.a=b,p.sc=M,p.cb=0),0}function ps(p,b,M){return 3<=M&&p[b+0]==157&&p[b+1]==1&&p[b+2]==42}function Hr(p,b){if(p==null)return 0;if(p.a=0,p.sc="OK",b==null)return yn(p,2,"null VP8Io passed to VP8GetHeaders()");var M=b.data,I=b.w,re=b.ha;if(4>re)return yn(p,7,"Truncated header.");var fe=M[I+0]|M[I+1]<<8|M[I+2]<<16,ge=p.Od;if(ge.Rb=!(1&fe),ge.td=fe>>1&7,ge.yd=fe>>4&1,ge.ub=fe>>5,3<ge.td)return yn(p,3,"Incorrect keyframe parameters.");if(!ge.yd)return yn(p,4,"Frame not displayable.");I+=3,re-=3;var _e=p.Kc;if(ge.Rb){if(7>re)return yn(p,7,"cannot parse picture header");if(!ps(M,I,re))return yn(p,3,"Bad code word");_e.c=16383&(M[I+4]<<8|M[I+3]),_e.Td=M[I+4]>>6,_e.i=16383&(M[I+6]<<8|M[I+5]),_e.Ud=M[I+6]>>6,I+=7,re-=7,p.za=_e.c+15>>4,p.Ub=_e.i+15>>4,b.width=_e.c,b.height=_e.i,b.Da=0,b.j=0,b.v=0,b.va=b.width,b.o=b.height,b.da=0,b.ib=b.width,b.hb=b.height,b.U=b.width,b.T=b.height,o((fe=p.Pa).jb,0,255,fe.jb.length),t((fe=p.Qa)!=null),fe.Cb=0,fe.Bb=0,fe.Fb=1,o(fe.Zb,0,0,fe.Zb.length),o(fe.Lb,0,0,fe.Lb)}if(ge.ub>re)return yn(p,7,"bad partition length");P(fe=p.m,M,I,ge.ub),I+=ge.ub,re-=ge.ub,ge.Rb&&(_e.Ld=H(fe),_e.Kd=H(fe)),_e=p.Qa;var be,Me=p.Pa;if(t(fe!=null),t(_e!=null),_e.Cb=H(fe),_e.Cb){if(_e.Bb=H(fe),H(fe)){for(_e.Fb=H(fe),be=0;4>be;++be)_e.Zb[be]=H(fe)?G(fe,7):0;for(be=0;4>be;++be)_e.Lb[be]=H(fe)?G(fe,6):0}if(_e.Bb)for(be=0;3>be;++be)Me.jb[be]=H(fe)?F(fe,8):255}else _e.Bb=0;if(fe.Ka)return yn(p,3,"cannot parse segment header");if((_e=p.ed).zd=H(fe),_e.Tb=F(fe,6),_e.wb=F(fe,3),_e.Pc=H(fe),_e.Pc&&H(fe)){for(Me=0;4>Me;++Me)H(fe)&&(_e.vd[Me]=G(fe,6));for(Me=0;4>Me;++Me)H(fe)&&(_e.od[Me]=G(fe,6))}if(p.L=_e.Tb==0?0:_e.zd?1:2,fe.Ka)return yn(p,3,"cannot parse filter header");var Ye=re;if(re=be=I,I=be+Ye,_e=Ye,p.Xb=(1<<F(p.m,2))-1,Ye<3*(Me=p.Xb))M=7;else{for(be+=3*Me,_e-=3*Me,Ye=0;Ye<Me;++Ye){var mt=M[re+0]|M[re+1]<<8|M[re+2]<<16;mt>_e&&(mt=_e),P(p.Jc[+Ye],M,be,mt),be+=mt,_e-=mt,re+=3}P(p.Jc[+Me],M,be,_e),M=be<I?0:5}if(M!=0)return yn(p,M,"cannot parse partitions");for(M=F(be=p.m,7),re=H(be)?G(be,4):0,I=H(be)?G(be,4):0,_e=H(be)?G(be,4):0,Me=H(be)?G(be,4):0,be=H(be)?G(be,4):0,Ye=p.Qa,mt=0;4>mt;++mt){if(Ye.Cb){var vt=Ye.Zb[mt];Ye.Fb||(vt+=M)}else{if(0<mt){p.pb[mt]=p.pb[0];continue}vt=M}var lt=p.pb[mt];lt.Sc[0]=It[oi(vt+re,127)],lt.Sc[1]=Jt[oi(vt+0,127)],lt.Eb[0]=2*It[oi(vt+I,127)],lt.Eb[1]=101581*Jt[oi(vt+_e,127)]>>16,8>lt.Eb[1]&&(lt.Eb[1]=8),lt.Qc[0]=It[oi(vt+Me,117)],lt.Qc[1]=Jt[oi(vt+be,127)],lt.lc=vt+be}if(!ge.Rb)return yn(p,4,"Not a key frame.");for(H(fe),ge=p.Pa,M=0;4>M;++M){for(re=0;8>re;++re)for(I=0;3>I;++I)for(_e=0;11>_e;++_e)Me=$(fe,Us[M][re][I][_e])?F(fe,8):Dr[M][re][I][_e],ge.Wc[M][re].Yb[I][_e]=Me;for(re=0;17>re;++re)ge.Xc[M][re]=ge.Wc[M][zl[re]]}return p.kc=H(fe),p.kc&&(p.Bd=F(fe,8)),p.cb=1}function zr(p,b,M,I,re,fe,ge){var _e=b[re].Yb[M];for(M=0;16>re;++re){if(!$(p,_e[M+0]))return re;for(;!$(p,_e[M+1]);)if(_e=b[++re].Yb[0],M=0,re==16)return 16;var be=b[re+1].Yb;if($(p,_e[M+2])){var Me=p,Ye=0;if($(Me,(vt=_e)[(mt=M)+3]))if($(Me,vt[mt+6])){for(_e=0,mt=2*(Ye=$(Me,vt[mt+8]))+(vt=$(Me,vt[mt+9+Ye])),Ye=0,vt=Nn[mt];vt[_e];++_e)Ye+=Ye+$(Me,vt[_e]);Ye+=3+(8<<mt)}else $(Me,vt[mt+7])?(Ye=7+2*$(Me,165),Ye+=$(Me,145)):Ye=5+$(Me,159);else Ye=$(Me,vt[mt+4])?3+$(Me,vt[mt+5]):2;_e=be[2]}else Ye=1,_e=be[1];be=ge+Sr[re],0>(Me=p).b&&U(Me);var mt,vt=Me.b,lt=(mt=Me.Ca>>1)-(Me.I>>vt)>>31;--Me.b,Me.Ca+=lt,Me.Ca|=1,Me.I-=(mt+1&lt)<<vt,fe[be]=((Ye^lt)-lt)*I[(0<re)+0]}return 16}function Ts(p){var b=p.rb[p.sb-1];b.la=0,b.Na=0,o(p.zc,0,0,p.zc.length),p.ja=0}function xn(p,b){if(p==null)return 0;if(b==null)return yn(p,2,"NULL VP8Io parameter in VP8Decode().");if(!p.cb&&!Hr(p,b))return 0;if(t(p.cb),b.ac==null||b.ac(b)){b.ob&&(p.L=0);var M=yu[p.L];if(p.L==2?(p.yb=0,p.zb=0):(p.yb=b.v-M>>4,p.zb=b.j-M>>4,0>p.yb&&(p.yb=0),0>p.zb&&(p.zb=0)),p.Va=b.o+15+M>>4,p.Hb=b.va+15+M>>4,p.Hb>p.za&&(p.Hb=p.za),p.Va>p.Ub&&(p.Va=p.Ub),0<p.L){var I=p.ed;for(M=0;4>M;++M){var re;if(p.Qa.Cb){var fe=p.Qa.Lb[M];p.Qa.Fb||(fe+=I.Tb)}else fe=I.Tb;for(re=0;1>=re;++re){var ge=p.gd[M][re],_e=fe;if(I.Pc&&(_e+=I.vd[0],re&&(_e+=I.od[0])),0<(_e=0>_e?0:63<_e?63:_e)){var be=_e;0<I.wb&&(be=4<I.wb?be>>2:be>>1)>9-I.wb&&(be=9-I.wb),1>be&&(be=1),ge.dd=be,ge.tc=2*_e+be,ge.ld=40<=_e?2:15<=_e?1:0}else ge.tc=0;ge.La=re}}}M=0}else yn(p,6,"Frame setup failed"),M=p.a;if(M=M==0){if(M){p.$c=0,0<p.Aa||(p.Ic=Gc);e:{M=p.Ic,I=4*(be=p.za);var Me=32*be,Ye=be+1,mt=0<p.L?be*(0<p.Aa?2:1):0,vt=(p.Aa==2?2:1)*be;if((ge=I+832+(re=3*(16*M+yu[p.L])/2*Me)+(fe=p.Fa!=null&&0<p.Fa.length?p.Kc.c*p.Kc.i:0))!=ge)M=0;else{if(ge>p.Vb){if(p.Vb=0,p.Ec=a(ge),p.Fc=0,p.Ec==null){M=yn(p,1,"no memory during frame initialization.");break e}p.Vb=ge}ge=p.Ec,_e=p.Fc,p.Ac=ge,p.Bc=_e,_e+=I,p.Gd=u(Me,go),p.Hd=0,p.rb=u(Ye+1,Io),p.sb=1,p.wa=mt?u(mt,Ys):null,p.Y=0,p.D.Nb=0,p.D.wa=p.wa,p.D.Y=p.Y,0<p.Aa&&(p.D.Y+=be),t(!0),p.oc=ge,p.pc=_e,_e+=832,p.ya=u(vt,Ms),p.aa=0,p.D.ya=p.ya,p.D.aa=p.aa,p.Aa==2&&(p.D.aa+=be),p.R=16*be,p.B=8*be,be=(Me=yu[p.L])*p.R,Me=Me/2*p.B,p.sa=ge,p.ta=_e+be,p.qa=p.sa,p.ra=p.ta+16*M*p.R+Me,p.Ha=p.qa,p.Ia=p.ra+8*M*p.B+Me,p.$c=0,_e+=re,p.mb=fe?ge:null,p.nb=fe?_e:null,t(_e+fe<=p.Fc+p.Vb),Ts(p),o(p.Ac,p.Bc,0,I),M=1}}if(M){if(b.ka=0,b.y=p.sa,b.O=p.ta,b.f=p.qa,b.N=p.ra,b.ea=p.Ha,b.Vd=p.Ia,b.fa=p.R,b.Rc=p.B,b.F=null,b.J=0,!cl){for(M=-255;255>=M;++M)ai[255+M]=0>M?-M:M;for(M=-1020;1020>=M;++M)_s[1020+M]=-128>M?-128:127<M?127:M;for(M=-112;112>=M;++M)ko[112+M]=-16>M?-16:15<M?15:M;for(M=-255;510>=M;++M)js[255+M]=0>M?0:255<M?255:M;cl=1}so=jo,es=gs,Is=Wr,Cr=_i,dr=Ns,Si=ci,Wo=za,Ga=Ds,Ha=Yr,fr=ma,Br=pa,Lo=ga,Fs=qi,wa=al,Co=ja,Po=dn,oo=br,ts=qo,is[0]=Un,is[1]=Da,is[2]=Sn,is[3]=Zr,is[4]=Oa,is[5]=yo,is[6]=da,is[7]=Kr,is[8]=Ia,is[9]=Qs,bs[0]=ca,bs[1]=Ra,bs[2]=ms,bs[3]=Xs,bs[4]=$i,bs[5]=sl,bs[6]=ha,Vr[0]=eo,Vr[1]=mo,Vr[2]=zo,Vr[3]=Mi,Vr[4]=Uo,Vr[5]=ol,Vr[6]=fa,M=1}else M=0}M&&(M=function(lt,St){for(lt.M=0;lt.M<lt.Va;++lt.M){var Lt,Qe=lt.Jc[lt.M&lt.Xb],rt=lt.m,Mt=lt;for(Lt=0;Lt<Mt.za;++Lt){var Ft=rt,Nt=Mt,tn=Nt.Ac,Ht=Nt.Bc+4*Lt,pn=Nt.zc,s=Nt.ya[Nt.aa+Lt];if(Nt.Qa.Bb?s.$b=$(Ft,Nt.Pa.jb[0])?2+$(Ft,Nt.Pa.jb[2]):$(Ft,Nt.Pa.jb[1]):s.$b=0,Nt.kc&&(s.Ad=$(Ft,Nt.Bd)),s.Za=!$(Ft,145)+0,s.Za){var l=s.Ob,h=0;for(Nt=0;4>Nt;++Nt){var g,y=pn[0+Nt];for(g=0;4>g;++g){y=Ei[tn[Ht+g]][y];for(var S=Wi[$(Ft,y[0])];0<S;)S=Wi[2*S+$(Ft,y[S])];y=-S,tn[Ht+g]=y}i(l,h,tn,Ht,4),h+=4,pn[0+Nt]=y}}else y=$(Ft,156)?$(Ft,128)?1:3:$(Ft,163)?2:0,s.Ob[0]=y,o(tn,Ht,y,4),o(pn,0,y,4);s.Dd=$(Ft,142)?$(Ft,114)?$(Ft,183)?1:3:2:0}if(Mt.m.Ka)return yn(lt,7,"Premature end-of-partition0 encountered.");for(;lt.ja<lt.za;++lt.ja){if(Mt=Qe,Ft=(rt=lt).rb[rt.sb-1],tn=rt.rb[rt.sb+rt.ja],Lt=rt.ya[rt.aa+rt.ja],Ht=rt.kc?Lt.Ad:0)Ft.la=tn.la=0,Lt.Za||(Ft.Na=tn.Na=0),Lt.Hc=0,Lt.Gc=0,Lt.ia=0;else{var B,D;if(Ft=tn,tn=Mt,Ht=rt.Pa.Xc,pn=rt.ya[rt.aa+rt.ja],s=rt.pb[pn.$b],Nt=pn.ad,l=0,h=rt.rb[rt.sb-1],y=g=0,o(Nt,l,0,384),pn.Za)var Y=0,le=Ht[3];else{S=a(16);var Oe=Ft.Na+h.Na;if(Oe=cn(tn,Ht[1],Oe,s.Eb,0,S,0),Ft.Na=h.Na=(0<Oe)+0,1<Oe)so(S,0,Nt,l);else{var Te=S[0]+3>>3;for(S=0;256>S;S+=16)Nt[l+S]=Te}Y=1,le=Ht[0]}var it=15&Ft.la,pt=15&h.la;for(S=0;4>S;++S){var Tt=1&pt;for(Te=D=0;4>Te;++Te)it=it>>1|(Tt=(Oe=cn(tn,le,Oe=Tt+(1&it),s.Sc,Y,Nt,l))>Y)<<7,D=D<<2|(3<Oe?3:1<Oe?2:Nt[l+0]!=0),l+=16;it>>=4,pt=pt>>1|Tt<<7,g=(g<<8|D)>>>0}for(le=it,Y=pt>>4,B=0;4>B;B+=2){for(D=0,it=Ft.la>>4+B,pt=h.la>>4+B,S=0;2>S;++S){for(Tt=1&pt,Te=0;2>Te;++Te)Oe=Tt+(1&it),it=it>>1|(Tt=0<(Oe=cn(tn,Ht[2],Oe,s.Qc,0,Nt,l)))<<3,D=D<<2|(3<Oe?3:1<Oe?2:Nt[l+0]!=0),l+=16;it>>=2,pt=pt>>1|Tt<<5}y|=D<<4*B,le|=it<<4<<B,Y|=(240&pt)<<B}Ft.la=le,h.la=Y,pn.Hc=g,pn.Gc=y,pn.ia=43690&y?0:s.ia,Ht=!(g|y)}if(0<rt.L&&(rt.wa[rt.Y+rt.ja]=rt.gd[Lt.$b][Lt.Za],rt.wa[rt.Y+rt.ja].La|=!Ht),Mt.Ka)return yn(lt,7,"Premature end-of-file encountered.")}if(Ts(lt),rt=St,Mt=1,Lt=(Qe=lt).D,Ft=0<Qe.L&&Qe.M>=Qe.zb&&Qe.M<=Qe.Va,Qe.Aa==0)e:{if(Lt.M=Qe.M,Lt.uc=Ft,qa(Qe,Lt),Mt=1,Lt=(D=Qe.D).Nb,Ft=(y=yu[Qe.L])*Qe.R,tn=y/2*Qe.B,S=16*Lt*Qe.R,Te=8*Lt*Qe.B,Ht=Qe.sa,pn=Qe.ta-Ft+S,s=Qe.qa,Nt=Qe.ra-tn+Te,l=Qe.Ha,h=Qe.Ia-tn+Te,pt=(it=D.M)==0,g=it>=Qe.Va-1,Qe.Aa==2&&qa(Qe,D),D.uc)for(Tt=(Oe=Qe).D.M,t(Oe.D.uc),D=Oe.yb;D<Oe.Hb;++D){Y=D,le=Tt;var qt=(Vt=(de=Oe).D).Nb;B=de.R;var Vt=Vt.wa[Vt.Y+Y],bn=de.sa,Re=de.ta+16*qt*B+16*Y,qe=Vt.dd,Je=Vt.tc;if(Je!=0)if(t(3<=Je),de.L==1)0<Y&&Po(bn,Re,B,Je+4),Vt.La&&ts(bn,Re,B,Je),0<le&&Co(bn,Re,B,Je+4),Vt.La&&oo(bn,Re,B,Je);else{var yt=de.B,at=de.qa,gt=de.ra+8*qt*yt+8*Y,X=de.Ha,de=de.Ia+8*qt*yt+8*Y;qt=Vt.ld,0<Y&&(Ga(bn,Re,B,Je+4,qe,qt),fr(at,gt,X,de,yt,Je+4,qe,qt)),Vt.La&&(Lo(bn,Re,B,Je,qe,qt),wa(at,gt,X,de,yt,Je,qe,qt)),0<le&&(Wo(bn,Re,B,Je+4,qe,qt),Ha(at,gt,X,de,yt,Je+4,qe,qt)),Vt.La&&(Br(bn,Re,B,Je,qe,qt),Fs(at,gt,X,de,yt,Je,qe,qt))}}if(Qe.ia&&alert("todo:DitherRow"),rt.put!=null){if(D=16*it,it=16*(it+1),pt?(rt.y=Qe.sa,rt.O=Qe.ta+S,rt.f=Qe.qa,rt.N=Qe.ra+Te,rt.ea=Qe.Ha,rt.W=Qe.Ia+Te):(D-=y,rt.y=Ht,rt.O=pn,rt.f=s,rt.N=Nt,rt.ea=l,rt.W=h),g||(it-=y),it>rt.o&&(it=rt.o),rt.F=null,rt.J=null,Qe.Fa!=null&&0<Qe.Fa.length&&D<it&&(rt.J=Bi(Qe,rt,D,it-D),rt.F=Qe.mb,rt.F==null&&rt.F.length==0)){Mt=yn(Qe,3,"Could not decode alpha data.");break e}D<rt.j&&(y=rt.j-D,D=rt.j,t(!(1&y)),rt.O+=Qe.R*y,rt.N+=Qe.B*(y>>1),rt.W+=Qe.B*(y>>1),rt.F!=null&&(rt.J+=rt.width*y)),D<it&&(rt.O+=rt.v,rt.N+=rt.v>>1,rt.W+=rt.v>>1,rt.F!=null&&(rt.J+=rt.v),rt.ka=D-rt.j,rt.U=rt.va-rt.v,rt.T=it-D,Mt=rt.put(rt))}Lt+1!=Qe.Ic||g||(i(Qe.sa,Qe.ta-Ft,Ht,pn+16*Qe.R,Ft),i(Qe.qa,Qe.ra-tn,s,Nt+8*Qe.B,tn),i(Qe.Ha,Qe.Ia-tn,l,h+8*Qe.B,tn))}if(!Mt)return yn(lt,6,"Output aborted.")}return 1}(p,b)),b.bc!=null&&b.bc(b),M&=1}return M?(p.cb=0,M):0}function qn(p,b,M,I,re){re=p[b+M+32*I]+(re>>3),p[b+M+32*I]=-256&re?0>re?0:255:re}function ki(p,b,M,I,re,fe){qn(p,b,0,M,I+re),qn(p,b,1,M,I+fe),qn(p,b,2,M,I-fe),qn(p,b,3,M,I-re)}function Vn(p){return(20091*p>>16)+p}function Qn(p,b,M,I){var re,fe=0,ge=a(16);for(re=0;4>re;++re){var _e=p[b+0]+p[b+8],be=p[b+0]-p[b+8],Me=(35468*p[b+4]>>16)-Vn(p[b+12]),Ye=Vn(p[b+4])+(35468*p[b+12]>>16);ge[fe+0]=_e+Ye,ge[fe+1]=be+Me,ge[fe+2]=be-Me,ge[fe+3]=_e-Ye,fe+=4,b++}for(re=fe=0;4>re;++re)_e=(p=ge[fe+0]+4)+ge[fe+8],be=p-ge[fe+8],Me=(35468*ge[fe+4]>>16)-Vn(ge[fe+12]),qn(M,I,0,0,_e+(Ye=Vn(ge[fe+4])+(35468*ge[fe+12]>>16))),qn(M,I,1,0,be+Me),qn(M,I,2,0,be-Me),qn(M,I,3,0,_e-Ye),fe++,I+=32}function ci(p,b,M,I){var re=p[b+0]+4,fe=35468*p[b+4]>>16,ge=Vn(p[b+4]),_e=35468*p[b+1]>>16;ki(M,I,0,re+ge,p=Vn(p[b+1]),_e),ki(M,I,1,re+fe,p,_e),ki(M,I,2,re-fe,p,_e),ki(M,I,3,re-ge,p,_e)}function gs(p,b,M,I,re){Qn(p,b,M,I),re&&Qn(p,b+16,M,I+4)}function Wr(p,b,M,I){es(p,b+0,M,I,1),es(p,b+32,M,I+128,1)}function _i(p,b,M,I){var re;for(p=p[b+0]+4,re=0;4>re;++re)for(b=0;4>b;++b)qn(M,I,b,re,p)}function Ns(p,b,M,I){p[b+0]&&Cr(p,b+0,M,I),p[b+16]&&Cr(p,b+16,M,I+4),p[b+32]&&Cr(p,b+32,M,I+128),p[b+48]&&Cr(p,b+48,M,I+128+4)}function jo(p,b,M,I){var re,fe=a(16);for(re=0;4>re;++re){var ge=p[b+0+re]+p[b+12+re],_e=p[b+4+re]+p[b+8+re],be=p[b+4+re]-p[b+8+re],Me=p[b+0+re]-p[b+12+re];fe[0+re]=ge+_e,fe[8+re]=ge-_e,fe[4+re]=Me+be,fe[12+re]=Me-be}for(re=0;4>re;++re)ge=(p=fe[0+4*re]+3)+fe[3+4*re],_e=fe[1+4*re]+fe[2+4*re],be=fe[1+4*re]-fe[2+4*re],Me=p-fe[3+4*re],M[I+0]=ge+_e>>3,M[I+16]=Me+be>>3,M[I+32]=ge-_e>>3,M[I+48]=Me-be>>3,I+=64}function Js(p,b,M){var I,re=b-32,fe=li,ge=255-p[re-1];for(I=0;I<M;++I){var _e,be=fe,Me=ge+p[b-1];for(_e=0;_e<M;++_e)p[b+_e]=be[Me+p[re+_e]];b+=32}}function Da(p,b){Js(p,b,4)}function mo(p,b){Js(p,b,8)}function Ra(p,b){Js(p,b,16)}function ms(p,b){var M;for(M=0;16>M;++M)i(p,b+32*M,p,b-32,16)}function Xs(p,b){var M;for(M=16;0<M;--M)o(p,b,p[b-1],16),b+=32}function vo(p,b,M){var I;for(I=0;16>I;++I)o(b,M+32*I,p,16)}function ca(p,b){var M,I=16;for(M=0;16>M;++M)I+=p[b-1+32*M]+p[b+M-32];vo(I>>5,p,b)}function $i(p,b){var M,I=8;for(M=0;16>M;++M)I+=p[b-1+32*M];vo(I>>4,p,b)}function sl(p,b){var M,I=8;for(M=0;16>M;++M)I+=p[b+M-32];vo(I>>4,p,b)}function ha(p,b){vo(128,p,b)}function Pn(p,b,M){return p+2*b+M+2>>2}function Sn(p,b){var M,I=b-32;for(I=new Uint8Array([Pn(p[I-1],p[I+0],p[I+1]),Pn(p[I+0],p[I+1],p[I+2]),Pn(p[I+1],p[I+2],p[I+3]),Pn(p[I+2],p[I+3],p[I+4])]),M=0;4>M;++M)i(p,b+32*M,I,0,I.length)}function Zr(p,b){var M=p[b-1],I=p[b-1+32],re=p[b-1+64],fe=p[b-1+96];ce(p,b+0,16843009*Pn(p[b-1-32],M,I)),ce(p,b+32,16843009*Pn(M,I,re)),ce(p,b+64,16843009*Pn(I,re,fe)),ce(p,b+96,16843009*Pn(re,fe,fe))}function Un(p,b){var M,I=4;for(M=0;4>M;++M)I+=p[b+M-32]+p[b-1+32*M];for(I>>=3,M=0;4>M;++M)o(p,b+32*M,I,4)}function Oa(p,b){var M=p[b-1+0],I=p[b-1+32],re=p[b-1+64],fe=p[b-1-32],ge=p[b+0-32],_e=p[b+1-32],be=p[b+2-32],Me=p[b+3-32];p[b+0+96]=Pn(I,re,p[b-1+96]),p[b+1+96]=p[b+0+64]=Pn(M,I,re),p[b+2+96]=p[b+1+64]=p[b+0+32]=Pn(fe,M,I),p[b+3+96]=p[b+2+64]=p[b+1+32]=p[b+0+0]=Pn(ge,fe,M),p[b+3+64]=p[b+2+32]=p[b+1+0]=Pn(_e,ge,fe),p[b+3+32]=p[b+2+0]=Pn(be,_e,ge),p[b+3+0]=Pn(Me,be,_e)}function da(p,b){var M=p[b+1-32],I=p[b+2-32],re=p[b+3-32],fe=p[b+4-32],ge=p[b+5-32],_e=p[b+6-32],be=p[b+7-32];p[b+0+0]=Pn(p[b+0-32],M,I),p[b+1+0]=p[b+0+32]=Pn(M,I,re),p[b+2+0]=p[b+1+32]=p[b+0+64]=Pn(I,re,fe),p[b+3+0]=p[b+2+32]=p[b+1+64]=p[b+0+96]=Pn(re,fe,ge),p[b+3+32]=p[b+2+64]=p[b+1+96]=Pn(fe,ge,_e),p[b+3+64]=p[b+2+96]=Pn(ge,_e,be),p[b+3+96]=Pn(_e,be,be)}function yo(p,b){var M=p[b-1+0],I=p[b-1+32],re=p[b-1+64],fe=p[b-1-32],ge=p[b+0-32],_e=p[b+1-32],be=p[b+2-32],Me=p[b+3-32];p[b+0+0]=p[b+1+64]=fe+ge+1>>1,p[b+1+0]=p[b+2+64]=ge+_e+1>>1,p[b+2+0]=p[b+3+64]=_e+be+1>>1,p[b+3+0]=be+Me+1>>1,p[b+0+96]=Pn(re,I,M),p[b+0+64]=Pn(I,M,fe),p[b+0+32]=p[b+1+96]=Pn(M,fe,ge),p[b+1+32]=p[b+2+96]=Pn(fe,ge,_e),p[b+2+32]=p[b+3+96]=Pn(ge,_e,be),p[b+3+32]=Pn(_e,be,Me)}function Kr(p,b){var M=p[b+0-32],I=p[b+1-32],re=p[b+2-32],fe=p[b+3-32],ge=p[b+4-32],_e=p[b+5-32],be=p[b+6-32],Me=p[b+7-32];p[b+0+0]=M+I+1>>1,p[b+1+0]=p[b+0+64]=I+re+1>>1,p[b+2+0]=p[b+1+64]=re+fe+1>>1,p[b+3+0]=p[b+2+64]=fe+ge+1>>1,p[b+0+32]=Pn(M,I,re),p[b+1+32]=p[b+0+96]=Pn(I,re,fe),p[b+2+32]=p[b+1+96]=Pn(re,fe,ge),p[b+3+32]=p[b+2+96]=Pn(fe,ge,_e),p[b+3+64]=Pn(ge,_e,be),p[b+3+96]=Pn(_e,be,Me)}function Qs(p,b){var M=p[b-1+0],I=p[b-1+32],re=p[b-1+64],fe=p[b-1+96];p[b+0+0]=M+I+1>>1,p[b+2+0]=p[b+0+32]=I+re+1>>1,p[b+2+32]=p[b+0+64]=re+fe+1>>1,p[b+1+0]=Pn(M,I,re),p[b+3+0]=p[b+1+32]=Pn(I,re,fe),p[b+3+32]=p[b+1+64]=Pn(re,fe,fe),p[b+3+64]=p[b+2+64]=p[b+0+96]=p[b+1+96]=p[b+2+96]=p[b+3+96]=fe}function Ia(p,b){var M=p[b-1+0],I=p[b-1+32],re=p[b-1+64],fe=p[b-1+96],ge=p[b-1-32],_e=p[b+0-32],be=p[b+1-32],Me=p[b+2-32];p[b+0+0]=p[b+2+32]=M+ge+1>>1,p[b+0+32]=p[b+2+64]=I+M+1>>1,p[b+0+64]=p[b+2+96]=re+I+1>>1,p[b+0+96]=fe+re+1>>1,p[b+3+0]=Pn(_e,be,Me),p[b+2+0]=Pn(ge,_e,be),p[b+1+0]=p[b+3+32]=Pn(M,ge,_e),p[b+1+32]=p[b+3+64]=Pn(I,M,ge),p[b+1+64]=p[b+3+96]=Pn(re,I,M),p[b+1+96]=Pn(fe,re,I)}function zo(p,b){var M;for(M=0;8>M;++M)i(p,b+32*M,p,b-32,8)}function Mi(p,b){var M;for(M=0;8>M;++M)o(p,b,p[b-1],8),b+=32}function Ur(p,b,M){var I;for(I=0;8>I;++I)o(b,M+32*I,p,8)}function eo(p,b){var M,I=8;for(M=0;8>M;++M)I+=p[b+M-32]+p[b-1+32*M];Ur(I>>4,p,b)}function ol(p,b){var M,I=4;for(M=0;8>M;++M)I+=p[b+M-32];Ur(I>>3,p,b)}function Uo(p,b){var M,I=4;for(M=0;8>M;++M)I+=p[b-1+32*M];Ur(I>>3,p,b)}function fa(p,b){Ur(128,p,b)}function _o(p,b,M){var I=p[b-M],re=p[b+0],fe=3*(re-I)+So[1020+p[b-2*M]-p[b+M]],ge=Hi[112+(fe+4>>3)];p[b-M]=li[255+I+Hi[112+(fe+3>>3)]],p[b+0]=li[255+re-ge]}function $o(p,b,M,I){var re=p[b+0],fe=p[b+M];return Tr[255+p[b-2*M]-p[b-M]]>I||Tr[255+fe-re]>I}function Fa(p,b,M,I){return 4*Tr[255+p[b-M]-p[b+0]]+Tr[255+p[b-2*M]-p[b+M]]<=I}function In(p,b,M,I,re){var fe=p[b-3*M],ge=p[b-2*M],_e=p[b-M],be=p[b+0],Me=p[b+M],Ye=p[b+2*M],mt=p[b+3*M];return 4*Tr[255+_e-be]+Tr[255+ge-Me]>I?0:Tr[255+p[b-4*M]-fe]<=re&&Tr[255+fe-ge]<=re&&Tr[255+ge-_e]<=re&&Tr[255+mt-Ye]<=re&&Tr[255+Ye-Me]<=re&&Tr[255+Me-be]<=re}function ja(p,b,M,I){var re=2*I+1;for(I=0;16>I;++I)Fa(p,b+I,M,re)&&_o(p,b+I,M)}function dn(p,b,M,I){var re=2*I+1;for(I=0;16>I;++I)Fa(p,b+I*M,1,re)&&_o(p,b+I*M,1)}function br(p,b,M,I){var re;for(re=3;0<re;--re)ja(p,b+=4*M,M,I)}function qo(p,b,M,I){var re;for(re=3;0<re;--re)dn(p,b+=4,M,I)}function bo(p,b,M,I,re,fe,ge,_e){for(fe=2*fe+1;0<re--;){if(In(p,b,M,fe,ge))if($o(p,b,M,_e))_o(p,b,M);else{var be=p,Me=b,Ye=M,mt=be[Me-2*Ye],vt=be[Me-Ye],lt=be[Me+0],St=be[Me+Ye],Lt=be[Me+2*Ye],Qe=27*(Mt=So[1020+3*(lt-vt)+So[1020+mt-St]])+63>>7,rt=18*Mt+63>>7,Mt=9*Mt+63>>7;be[Me-3*Ye]=li[255+be[Me-3*Ye]+Mt],be[Me-2*Ye]=li[255+mt+rt],be[Me-Ye]=li[255+vt+Qe],be[Me+0]=li[255+lt-Qe],be[Me+Ye]=li[255+St-rt],be[Me+2*Ye]=li[255+Lt-Mt]}b+=I}}function Er(p,b,M,I,re,fe,ge,_e){for(fe=2*fe+1;0<re--;){if(In(p,b,M,fe,ge))if($o(p,b,M,_e))_o(p,b,M);else{var be=p,Me=b,Ye=M,mt=be[Me-Ye],vt=be[Me+0],lt=be[Me+Ye],St=Hi[112+((Lt=3*(vt-mt))+4>>3)],Lt=Hi[112+(Lt+3>>3)],Qe=St+1>>1;be[Me-2*Ye]=li[255+be[Me-2*Ye]+Qe],be[Me-Ye]=li[255+mt+Lt],be[Me+0]=li[255+vt-St],be[Me+Ye]=li[255+lt-Qe]}b+=I}}function za(p,b,M,I,re,fe){bo(p,b,M,1,16,I,re,fe)}function Ds(p,b,M,I,re,fe){bo(p,b,1,M,16,I,re,fe)}function pa(p,b,M,I,re,fe){var ge;for(ge=3;0<ge;--ge)Er(p,b+=4*M,M,1,16,I,re,fe)}function ga(p,b,M,I,re,fe){var ge;for(ge=3;0<ge;--ge)Er(p,b+=4,1,M,16,I,re,fe)}function Yr(p,b,M,I,re,fe,ge,_e){bo(p,b,re,1,8,fe,ge,_e),bo(M,I,re,1,8,fe,ge,_e)}function ma(p,b,M,I,re,fe,ge,_e){bo(p,b,1,re,8,fe,ge,_e),bo(M,I,1,re,8,fe,ge,_e)}function qi(p,b,M,I,re,fe,ge,_e){Er(p,b+4*re,re,1,8,fe,ge,_e),Er(M,I+4*re,re,1,8,fe,ge,_e)}function al(p,b,M,I,re,fe,ge,_e){Er(p,b+4,1,re,8,fe,ge,_e),Er(M,I+4,1,re,8,fe,ge,_e)}function Vo(){this.ba=new Ui,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new zn,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Jr(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function va(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Ua(){this.ua=0,this.Wa=new ee,this.vb=new ee,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new he,this.yc=new J}function $a(){this.xb=this.a=0,this.l=new cr,this.ca=new Ui,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new T,this.Pb=0,this.wd=new T,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Ua,this.ab=0,this.gc=u(4,va),this.Oc=0}function ya(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new cr,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function wo(p,b,M,I,re,fe,ge){for(p=p==null?0:p[b+0],b=0;b<ge;++b)re[fe+b]=p+M[I+b]&255,p=re[fe+b]}function Go(p,b,M,I,re,fe,ge){var _e;if(p==null)wo(null,null,M,I,re,fe,ge);else for(_e=0;_e<ge;++_e)re[fe+_e]=p[b+_e]+M[I+_e]&255}function xo(p,b,M,I,re,fe,ge){if(p==null)wo(null,null,M,I,re,fe,ge);else{var _e,be=p[b+0],Me=be,Ye=be;for(_e=0;_e<ge;++_e)Me=Ye+(be=p[b+_e])-Me,Ye=M[I+_e]+(-256&Me?0>Me?0:255:Me)&255,Me=be,re[fe+_e]=Ye}}function Bi(p,b,M,I){var re=b.width,fe=b.o;if(t(p!=null&&b!=null),0>M||0>=I||M+I>fe)return null;if(!p.Cc){if(p.ga==null){var ge;if(p.ga=new ya,(ge=p.ga==null)||(ge=b.width*b.o,t(p.Gb.length==0),p.Gb=a(ge),p.Uc=0,p.Gb==null?ge=0:(p.mb=p.Gb,p.nb=p.Uc,p.rc=null,ge=1),ge=!ge),!ge){ge=p.ga;var _e=p.Fa,be=p.P,Me=p.qc,Ye=p.mb,mt=p.nb,vt=be+1,lt=Me-1,St=ge.l;if(t(_e!=null&&Ye!=null&&b!=null),si[0]=null,si[1]=wo,si[2]=Go,si[3]=xo,ge.ca=Ye,ge.tb=mt,ge.c=b.width,ge.i=b.height,t(0<ge.c&&0<ge.i),1>=Me)b=0;else if(ge.$a=_e[be+0]>>0&3,ge.Z=_e[be+0]>>2&3,ge.Lc=_e[be+0]>>4&3,be=_e[be+0]>>6&3,0>ge.$a||1<ge.$a||4<=ge.Z||1<ge.Lc||be)b=0;else if(St.put=wi,St.ac=Yn,St.bc=pi,St.ma=ge,St.width=b.width,St.height=b.height,St.Da=b.Da,St.v=b.v,St.va=b.va,St.j=b.j,St.o=b.o,ge.$a)e:{t(ge.$a==1),b=ur();t:for(;;){if(b==null){b=0;break e}if(t(ge!=null),ge.mc=b,b.c=ge.c,b.i=ge.i,b.l=ge.l,b.l.ma=ge,b.l.width=ge.c,b.l.height=ge.i,b.a=0,Q(b.m,_e,vt,lt),!jr(ge.c,ge.i,1,b,null)||(b.ab==1&&b.gc[0].hc==3&&ui(b.s)?(ge.ic=1,_e=b.c*b.i,b.Ta=null,b.Ua=0,b.V=a(_e),b.Ba=0,b.V==null?(b.a=1,b=0):b=1):(ge.ic=0,b=Es(b,ge.c)),!b))break t;b=1;break e}ge.mc=null,b=0}else b=lt>=ge.c*ge.i;ge=!b}if(ge)return null;p.ga.Lc!=1?p.Ga=0:I=fe-M}t(p.ga!=null),t(M+I<=fe);e:{if(b=(_e=p.ga).c,fe=_e.l.o,_e.$a==0){if(vt=p.rc,lt=p.Vc,St=p.Fa,be=p.P+1+M*b,Me=p.mb,Ye=p.nb+M*b,t(be<=p.P+p.qc),_e.Z!=0)for(t(si[_e.Z]!=null),ge=0;ge<I;++ge)si[_e.Z](vt,lt,St,be,Me,Ye,b),vt=Me,lt=Ye,Ye+=b,be+=b;else for(ge=0;ge<I;++ge)i(Me,Ye,St,be,b),vt=Me,lt=Ye,Ye+=b,be+=b;p.rc=vt,p.Vc=lt}else{if(t(_e.mc!=null),b=M+I,t((ge=_e.mc)!=null),t(b<=ge.i),ge.C>=b)b=1;else if(_e.ic||ut(),_e.ic){_e=ge.V,vt=ge.Ba,lt=ge.c;var Lt=ge.i,Qe=(St=1,be=ge.$/lt,Me=ge.$%lt,Ye=ge.m,mt=ge.s,ge.$),rt=lt*Lt,Mt=lt*b,Ft=mt.wc,Nt=Qe<Mt?_t(mt,Me,be):null;t(Qe<=rt),t(b<=Lt),t(ui(mt));t:for(;;){for(;!Ye.h&&Qe<Mt;){if(Me&Ft||(Nt=_t(mt,Me,be)),t(Nt!=null),R(Ye),256>(Lt=gi(Nt.G[0],Nt.H[0],Ye)))_e[vt+Qe]=Lt,++Qe,++Me>=lt&&(Me=0,++be<=b&&!(be%16)&&lr(ge,be));else{if(!(280>Lt)){St=0;break t}Lt=gn(Lt-256,Ye);var tn,Ht=gi(Nt.G[4],Nt.H[4],Ye);if(R(Ye),!(Qe>=(Ht=Yt(lt,Ht=gn(Ht,Ye)))&&rt-Qe>=Lt)){St=0;break t}for(tn=0;tn<Lt;++tn)_e[vt+Qe+tn]=_e[vt+Qe+tn-Ht];for(Qe+=Lt,Me+=Lt;Me>=lt;)Me-=lt,++be<=b&&!(be%16)&&lr(ge,be);Qe<Mt&&Me&Ft&&(Nt=_t(mt,Me,be))}t(Ye.h==ae(Ye))}lr(ge,be>b?b:be);break t}!St||Ye.h&&Qe<rt?(St=0,ge.a=Ye.h?5:3):ge.$=Qe,b=St}else b=_r(ge,ge.V,ge.Ba,ge.c,ge.i,b,Zs);if(!b){I=0;break e}}M+I>=fe&&(p.Cc=1),I=1}if(!I)return null;if(p.Cc&&((I=p.ga)!=null&&(I.mc=null),p.ga=null,0<p.Ga))return alert("todo:WebPDequantizeLevels"),null}return p.nb+M*re}function C(p,b,M,I,re,fe){for(;0<re--;){var ge,_e=p,be=b+(M?1:0),Me=p,Ye=b+(M?0:3);for(ge=0;ge<I;++ge){var mt=Me[Ye+4*ge];mt!=255&&(mt*=32897,_e[be+4*ge+0]=_e[be+4*ge+0]*mt>>23,_e[be+4*ge+1]=_e[be+4*ge+1]*mt>>23,_e[be+4*ge+2]=_e[be+4*ge+2]*mt>>23)}b+=fe}}function ie(p,b,M,I,re){for(;0<I--;){var fe;for(fe=0;fe<M;++fe){var ge=p[b+2*fe+0],_e=15&(Me=p[b+2*fe+1]),be=4369*_e,Me=(240&Me|Me>>4)*be>>16;p[b+2*fe+0]=(240&ge|ge>>4)*be>>16&240|(15&ge|ge<<4)*be>>16>>4&15,p[b+2*fe+1]=240&Me|_e}b+=re}}function De(p,b,M,I,re,fe,ge,_e){var be,Me,Ye=255;for(Me=0;Me<re;++Me){for(be=0;be<I;++be){var mt=p[b+be];fe[ge+4*be]=mt,Ye&=mt}b+=M,ge+=_e}return Ye!=255}function We(p,b,M,I,re){var fe;for(fe=0;fe<re;++fe)M[I+fe]=p[b+fe]>>8}function ut(){tr=C,ri=ie,ti=De,Ti=We}function wt(p,b,M){xe[p]=function(I,re,fe,ge,_e,be,Me,Ye,mt,vt,lt,St,Lt,Qe,rt,Mt,Ft){var Nt,tn=Ft-1>>1,Ht=_e[be+0]|Me[Ye+0]<<16,pn=mt[vt+0]|lt[St+0]<<16;t(I!=null);var s=3*Ht+pn+131074>>2;for(b(I[re+0],255&s,s>>16,Lt,Qe),fe!=null&&(s=3*pn+Ht+131074>>2,b(fe[ge+0],255&s,s>>16,rt,Mt)),Nt=1;Nt<=tn;++Nt){var l=_e[be+Nt]|Me[Ye+Nt]<<16,h=mt[vt+Nt]|lt[St+Nt]<<16,g=Ht+l+pn+h+524296,y=g+2*(l+pn)>>3;s=y+Ht>>1,Ht=(g=g+2*(Ht+h)>>3)+l>>1,b(I[re+2*Nt-1],255&s,s>>16,Lt,Qe+(2*Nt-1)*M),b(I[re+2*Nt-0],255&Ht,Ht>>16,Lt,Qe+(2*Nt-0)*M),fe!=null&&(s=g+pn>>1,Ht=y+h>>1,b(fe[ge+2*Nt-1],255&s,s>>16,rt,Mt+(2*Nt-1)*M),b(fe[ge+2*Nt+0],255&Ht,Ht>>16,rt,Mt+(2*Nt+0)*M)),Ht=l,pn=h}1&Ft||(s=3*Ht+pn+131074>>2,b(I[re+Ft-1],255&s,s>>16,Lt,Qe+(Ft-1)*M),fe!=null&&(s=3*pn+Ht+131074>>2,b(fe[ge+Ft-1],255&s,s>>16,rt,Mt+(Ft-1)*M)))}}function zt(){gr[Nr]=Wu,gr[_n]=du,gr[hl]=$s,gr[Zo]=Ko,gr[ns]=dl,gr[pr]=fu,gr[jl]=Uc,gr[Pr]=du,gr[kr]=Ko,gr[zs]=dl,gr[r]=fu}function Kt(p){return p&-16384?0>p?0:255:p>>md}function en(p,b){return Kt((19077*p>>8)+(26149*b>>8)-14234)}function ln(p,b,M){return Kt((19077*p>>8)-(6419*b>>8)-(13320*M>>8)+8708)}function Ln(p,b){return Kt((19077*p>>8)+(33050*b>>8)-17685)}function Fn(p,b,M,I,re){I[re+0]=en(p,M),I[re+1]=ln(p,b,M),I[re+2]=Ln(p,b)}function mi(p,b,M,I,re){I[re+0]=Ln(p,b),I[re+1]=ln(p,b,M),I[re+2]=en(p,M)}function Wn(p,b,M,I,re){var fe=ln(p,b,M);b=fe<<3&224|Ln(p,b)>>3,I[re+0]=248&en(p,M)|fe>>5,I[re+1]=b}function ei(p,b,M,I,re){var fe=240&Ln(p,b)|15;I[re+0]=240&en(p,M)|ln(p,b,M)>>4,I[re+1]=fe}function Vi(p,b,M,I,re){I[re+0]=255,Fn(p,b,M,I,re+1)}function Fi(p,b,M,I,re){mi(p,b,M,I,re),I[re+3]=255}function $r(p,b,M,I,re){Fn(p,b,M,I,re),I[re+3]=255}function oi(p,b){return 0>p?0:p>b?b:p}function wr(p,b,M){xe[p]=function(I,re,fe,ge,_e,be,Me,Ye,mt){for(var vt=Ye+(-2&mt)*M;Ye!=vt;)b(I[re+0],fe[ge+0],_e[be+0],Me,Ye),b(I[re+1],fe[ge+0],_e[be+0],Me,Ye+M),re+=2,++ge,++be,Ye+=2*M;1&mt&&b(I[re+0],fe[ge+0],_e[be+0],Me,Ye)}}function ll(p,b,M){return M==0?p==0?b==0?6:5:b==0?4:0:M}function xr(p,b,M,I,re){switch(p>>>30){case 3:es(b,M,I,re,0);break;case 2:Si(b,M,I,re);break;case 1:Cr(b,M,I,re)}}function qa(p,b){var M,I,re=b.M,fe=b.Nb,ge=p.oc,_e=p.pc+40,be=p.oc,Me=p.pc+584,Ye=p.oc,mt=p.pc+600;for(M=0;16>M;++M)ge[_e+32*M-1]=129;for(M=0;8>M;++M)be[Me+32*M-1]=129,Ye[mt+32*M-1]=129;for(0<re?ge[_e-1-32]=be[Me-1-32]=Ye[mt-1-32]=129:(o(ge,_e-32-1,127,21),o(be,Me-32-1,127,9),o(Ye,mt-32-1,127,9)),I=0;I<p.za;++I){var vt=b.ya[b.aa+I];if(0<I){for(M=-1;16>M;++M)i(ge,_e+32*M-4,ge,_e+32*M+12,4);for(M=-1;8>M;++M)i(be,Me+32*M-4,be,Me+32*M+4,4),i(Ye,mt+32*M-4,Ye,mt+32*M+4,4)}var lt=p.Gd,St=p.Hd+I,Lt=vt.ad,Qe=vt.Hc;if(0<re&&(i(ge,_e-32,lt[St].y,0,16),i(be,Me-32,lt[St].f,0,8),i(Ye,mt-32,lt[St].ea,0,8)),vt.Za){var rt=ge,Mt=_e-32+16;for(0<re&&(I>=p.za-1?o(rt,Mt,lt[St].y[15],4):i(rt,Mt,lt[St+1].y,0,4)),M=0;4>M;M++)rt[Mt+128+M]=rt[Mt+256+M]=rt[Mt+384+M]=rt[Mt+0+M];for(M=0;16>M;++M,Qe<<=2)rt=ge,Mt=_e+qc[M],is[vt.Ob[M]](rt,Mt),xr(Qe,Lt,16*+M,rt,Mt)}else if(rt=ll(I,re,vt.Ob[0]),bs[rt](ge,_e),Qe!=0)for(M=0;16>M;++M,Qe<<=2)xr(Qe,Lt,16*+M,ge,_e+qc[M]);for(M=vt.Gc,rt=ll(I,re,vt.Dd),Vr[rt](be,Me),Vr[rt](Ye,mt),Qe=Lt,rt=be,Mt=Me,255&(vt=M>>0)&&(170&vt?Is(Qe,256,rt,Mt):dr(Qe,256,rt,Mt)),vt=Ye,Qe=mt,255&(M>>=8)&&(170&M?Is(Lt,320,vt,Qe):dr(Lt,320,vt,Qe)),re<p.Ub-1&&(i(lt[St].y,0,ge,_e+480,16),i(lt[St].f,0,be,Me+224,8),i(lt[St].ea,0,Ye,mt+224,8)),M=8*fe*p.B,lt=p.sa,St=p.ta+16*I+16*fe*p.R,Lt=p.qa,vt=p.ra+8*I+M,Qe=p.Ha,rt=p.Ia+8*I+M,M=0;16>M;++M)i(lt,St+M*p.R,ge,_e+32*M,16);for(M=0;8>M;++M)i(Lt,vt+M*p.B,be,Me+32*M,8),i(Qe,rt+M*p.B,Ye,mt+32*M,8)}}function vs(p,b,M,I,re,fe,ge,_e,be){var Me=[0],Ye=[0],mt=0,vt=be!=null?be.kd:0,lt=be??new Jr;if(p==null||12>M)return 7;lt.data=p,lt.w=b,lt.ha=M,b=[b],M=[M],lt.gb=[lt.gb];e:{var St=b,Lt=M,Qe=lt.gb;if(t(p!=null),t(Lt!=null),t(Qe!=null),Qe[0]=0,12<=Lt[0]&&!n(p,St[0],"RIFF")){if(n(p,St[0]+8,"WEBP")){Qe=3;break e}var rt=K(p,St[0]+4);if(12>rt||4294967286<rt){Qe=3;break e}if(vt&&rt>Lt[0]-8){Qe=7;break e}Qe[0]=rt,St[0]+=12,Lt[0]-=12}Qe=0}if(Qe!=0)return Qe;for(rt=0<lt.gb[0],M=M[0];;){e:{var Mt=p;Lt=b,Qe=M;var Ft=Me,Nt=Ye,tn=St=[0];if((s=mt=[mt])[0]=0,8>Qe[0])Qe=7;else{if(!n(Mt,Lt[0],"VP8X")){if(K(Mt,Lt[0]+4)!=10){Qe=3;break e}if(18>Qe[0]){Qe=7;break e}var Ht=K(Mt,Lt[0]+8),pn=1+V(Mt,Lt[0]+12);if(2147483648<=pn*(Mt=1+V(Mt,Lt[0]+15))){Qe=3;break e}tn!=null&&(tn[0]=Ht),Ft!=null&&(Ft[0]=pn),Nt!=null&&(Nt[0]=Mt),Lt[0]+=18,Qe[0]-=18,s[0]=1}Qe=0}}if(mt=mt[0],St=St[0],Qe!=0)return Qe;if(Lt=!!(2&St),!rt&&mt)return 3;if(fe!=null&&(fe[0]=!!(16&St)),ge!=null&&(ge[0]=Lt),_e!=null&&(_e[0]=0),ge=Me[0],St=Ye[0],mt&&Lt&&be==null){Qe=0;break}if(4>M){Qe=7;break}if(rt&&mt||!rt&&!mt&&!n(p,b[0],"ALPH")){M=[M],lt.na=[lt.na],lt.P=[lt.P],lt.Sa=[lt.Sa];e:{Ht=p,Qe=b,rt=M;var s=lt.gb;Ft=lt.na,Nt=lt.P,tn=lt.Sa,pn=22,t(Ht!=null),t(rt!=null),Mt=Qe[0];var l=rt[0];for(t(Ft!=null),t(tn!=null),Ft[0]=null,Nt[0]=null,tn[0]=0;;){if(Qe[0]=Mt,rt[0]=l,8>l){Qe=7;break e}var h=K(Ht,Mt+4);if(4294967286<h){Qe=3;break e}var g=8+h+1&-2;if(pn+=g,0<s&&pn>s){Qe=3;break e}if(!n(Ht,Mt,"VP8 ")||!n(Ht,Mt,"VP8L")){Qe=0;break e}if(l[0]<g){Qe=7;break e}n(Ht,Mt,"ALPH")||(Ft[0]=Ht,Nt[0]=Mt+8,tn[0]=h),Mt+=g,l-=g}}if(M=M[0],lt.na=lt.na[0],lt.P=lt.P[0],lt.Sa=lt.Sa[0],Qe!=0)break}M=[M],lt.Ja=[lt.Ja],lt.xa=[lt.xa];e:if(s=p,Qe=b,rt=M,Ft=lt.gb[0],Nt=lt.Ja,tn=lt.xa,Ht=Qe[0],Mt=!n(s,Ht,"VP8 "),pn=!n(s,Ht,"VP8L"),t(s!=null),t(rt!=null),t(Nt!=null),t(tn!=null),8>rt[0])Qe=7;else{if(Mt||pn){if(s=K(s,Ht+4),12<=Ft&&s>Ft-12){Qe=3;break e}if(vt&&s>rt[0]-8){Qe=7;break e}Nt[0]=s,Qe[0]+=8,rt[0]-=8,tn[0]=pn}else tn[0]=5<=rt[0]&&s[Ht+0]==47&&!(s[Ht+4]>>5),Nt[0]=rt[0];Qe=0}if(M=M[0],lt.Ja=lt.Ja[0],lt.xa=lt.xa[0],b=b[0],Qe!=0)break;if(4294967286<lt.Ja)return 3;if(_e==null||Lt||(_e[0]=lt.xa?2:1),ge=[ge],St=[St],lt.xa){if(5>M){Qe=7;break}_e=ge,vt=St,Lt=fe,p==null||5>M?p=0:5<=M&&p[b+0]==47&&!(p[b+4]>>5)?(rt=[0],s=[0],Ft=[0],Q(Nt=new T,p,b,M),sn(Nt,rt,s,Ft)?(_e!=null&&(_e[0]=rt[0]),vt!=null&&(vt[0]=s[0]),Lt!=null&&(Lt[0]=Ft[0]),p=1):p=0):p=0}else{if(10>M){Qe=7;break}_e=St,p==null||10>M||!ps(p,b+3,M-3)?p=0:(vt=p[b+0]|p[b+1]<<8|p[b+2]<<16,Lt=16383&(p[b+7]<<8|p[b+6]),p=16383&(p[b+9]<<8|p[b+8]),1&vt||3<(vt>>1&7)||!(vt>>4&1)||vt>>5>=lt.Ja||!Lt||!p?p=0:(ge&&(ge[0]=Lt),_e&&(_e[0]=p),p=1))}if(!p||(ge=ge[0],St=St[0],mt&&(Me[0]!=ge||Ye[0]!=St)))return 3;be!=null&&(be[0]=lt,be.offset=b-be.w,t(4294967286>b-be.w),t(be.offset==be.ha-M));break}return Qe==0||Qe==7&&mt&&be==null?(fe!=null&&(fe[0]|=lt.na!=null&&0<lt.na.length),I!=null&&(I[0]=ge),re!=null&&(re[0]=St),0):Qe}function Va(p,b,M){var I=b.width,re=b.height,fe=0,ge=0,_e=I,be=re;if(b.Da=p!=null&&0<p.Da,b.Da&&(_e=p.cd,be=p.bd,fe=p.v,ge=p.j,11>M||(fe&=-2,ge&=-2),0>fe||0>ge||0>=_e||0>=be||fe+_e>I||ge+be>re))return 0;if(b.v=fe,b.j=ge,b.va=fe+_e,b.o=ge+be,b.U=_e,b.T=be,b.da=p!=null&&0<p.da,b.da){if(!Ge(_e,be,M=[p.ib],fe=[p.hb]))return 0;b.ib=M[0],b.hb=fe[0]}return b.ob=p!=null&&p.ob,b.Kb=p==null||!p.Sd,b.da&&(b.ob=b.ib<3*I/4&&b.hb<3*re/4,b.Kb=0),1}function to(p){if(p==null)return 2;if(11>p.S){var b=p.f.RGBA;b.fb+=(p.height-1)*b.A,b.A=-b.A}else b=p.f.kb,p=p.height,b.O+=(p-1)*b.fa,b.fa=-b.fa,b.N+=(p-1>>1)*b.Ab,b.Ab=-b.Ab,b.W+=(p-1>>1)*b.Db,b.Db=-b.Db,b.F!=null&&(b.J+=(p-1)*b.lb,b.lb=-b.lb);return 0}function no(p,b,M,I){if(I==null||0>=p||0>=b)return 2;if(M!=null){if(M.Da){var re=M.cd,fe=M.bd,ge=-2&M.v,_e=-2&M.j;if(0>ge||0>_e||0>=re||0>=fe||ge+re>p||_e+fe>b)return 2;p=re,b=fe}if(M.da){if(!Ge(p,b,re=[M.ib],fe=[M.hb]))return 2;p=re[0],b=fe[0]}}I.width=p,I.height=b;e:{var be=I.width,Me=I.height;if(p=I.S,0>=be||0>=Me||!(p>=Nr&&13>p))p=2;else{if(0>=I.Rd&&I.sd==null){ge=fe=re=b=0;var Ye=(_e=be*Hc[p])*Me;if(11>p||(fe=(Me+1)/2*(b=(be+1)/2),p==12&&(ge=(re=be)*Me)),(Me=a(Ye+2*fe+ge))==null){p=1;break e}I.sd=Me,11>p?((be=I.f.RGBA).eb=Me,be.fb=0,be.A=_e,be.size=Ye):((be=I.f.kb).y=Me,be.O=0,be.fa=_e,be.Fd=Ye,be.f=Me,be.N=0+Ye,be.Ab=b,be.Cd=fe,be.ea=Me,be.W=0+Ye+fe,be.Db=b,be.Ed=fe,p==12&&(be.F=Me,be.J=0+Ye+2*fe),be.Tc=ge,be.lb=re)}if(b=1,re=I.S,fe=I.width,ge=I.height,re>=Nr&&13>re)if(11>re)p=I.f.RGBA,b&=(_e=Math.abs(p.A))*(ge-1)+fe<=p.size,b&=_e>=fe*Hc[re],b&=p.eb!=null;else{p=I.f.kb,_e=(fe+1)/2,Ye=(ge+1)/2,be=Math.abs(p.fa),Me=Math.abs(p.Ab);var mt=Math.abs(p.Db),vt=Math.abs(p.lb),lt=vt*(ge-1)+fe;b&=be*(ge-1)+fe<=p.Fd,b&=Me*(Ye-1)+_e<=p.Cd,b=(b&=mt*(Ye-1)+_e<=p.Ed)&be>=fe&Me>=_e&mt>=_e,b&=p.y!=null,b&=p.f!=null,b&=p.ea!=null,re==12&&(b&=vt>=fe,b&=lt<=p.Tc,b&=p.F!=null)}else b=0;p=b?0:2}}return p!=0||M!=null&&M.fd&&(p=to(I)),p}var ji=64,_a=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Ar=24,Lr=32,ba=8,hr=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];nt("Predictor0","PredictorAdd0"),xe.Predictor0=function(){return 4278190080},xe.Predictor1=function(p){return p},xe.Predictor2=function(p,b,M){return b[M+0]},xe.Predictor3=function(p,b,M){return b[M+1]},xe.Predictor4=function(p,b,M){return b[M-1]},xe.Predictor5=function(p,b,M){return Ct(Ct(p,b[M+1]),b[M+0])},xe.Predictor6=function(p,b,M){return Ct(p,b[M-1])},xe.Predictor7=function(p,b,M){return Ct(p,b[M+0])},xe.Predictor8=function(p,b,M){return Ct(b[M-1],b[M+0])},xe.Predictor9=function(p,b,M){return Ct(b[M+0],b[M+1])},xe.Predictor10=function(p,b,M){return Ct(Ct(p,b[M-1]),Ct(b[M+0],b[M+1]))},xe.Predictor11=function(p,b,M){var I=b[M+0];return 0>=$t(I>>24&255,p>>24&255,(b=b[M-1])>>24&255)+$t(I>>16&255,p>>16&255,b>>16&255)+$t(I>>8&255,p>>8&255,b>>8&255)+$t(255&I,255&p,255&b)?I:p},xe.Predictor12=function(p,b,M){var I=b[M+0];return(xt((p>>24&255)+(I>>24&255)-((b=b[M-1])>>24&255))<<24|xt((p>>16&255)+(I>>16&255)-(b>>16&255))<<16|xt((p>>8&255)+(I>>8&255)-(b>>8&255))<<8|xt((255&p)+(255&I)-(255&b)))>>>0},xe.Predictor13=function(p,b,M){var I=b[M-1];return(Ot((p=Ct(p,b[M+0]))>>24&255,I>>24&255)<<24|Ot(p>>16&255,I>>16&255)<<16|Ot(p>>8&255,I>>8&255)<<8|Ot(p>>0&255,I>>0&255))>>>0};var io=xe.PredictorAdd0;xe.PredictorAdd1=Gt,nt("Predictor2","PredictorAdd2"),nt("Predictor3","PredictorAdd3"),nt("Predictor4","PredictorAdd4"),nt("Predictor5","PredictorAdd5"),nt("Predictor6","PredictorAdd6"),nt("Predictor7","PredictorAdd7"),nt("Predictor8","PredictorAdd8"),nt("Predictor9","PredictorAdd9"),nt("Predictor10","PredictorAdd10"),nt("Predictor11","PredictorAdd11"),nt("Predictor12","PredictorAdd12"),nt("Predictor13","PredictorAdd13");var qr=xe.PredictorAdd2;Et("ColorIndexInverseTransform","MapARGB","32b",function(p){return p>>8&255},function(p){return p}),Et("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(p){return p},function(p){return p>>8&255});var ul,Gi=xe.ColorIndexInverseTransform,Rs=xe.MapARGB,Xr=xe.VP8LColorIndexInverseTransformAlpha,Ho=xe.MapAlpha,ro=xe.VP8LPredictorsAdd=[];ro.length=16,(xe.VP8LPredictors=[]).length=16,(xe.VP8LPredictorsAdd_C=[]).length=16,(xe.VP8LPredictors_C=[]).length=16;var Os,er,Yi,ys,Mr,Qr,so,es,Si,Is,Cr,dr,Wo,Ga,Ha,fr,Br,Lo,Fs,wa,Co,Po,oo,ts,tr,ri,ti,Ti,ai=a(511),_s=a(2041),ko=a(225),js=a(767),cl=0,So=_s,Hi=ko,li=js,Tr=ai,Nr=0,_n=1,hl=2,Zo=3,ns=4,pr=5,jl=6,Pr=7,kr=8,zs=9,r=10,c=[2,3,7],m=[3,3,11],E=[280,256,256,256,40],j=[0,1,1,1,0],pe=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],Ve=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],dt=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],bt=8,It=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Jt=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],cn=null,Nn=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],Sr=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],Wi=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],Dr=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],Ei=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],Us=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],zl=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],bs=[],is=[],Vr=[],Hu=1,Ul=2,si=[],gr=[];wt("UpsampleRgbLinePair",Fn,3),wt("UpsampleBgrLinePair",mi,3),wt("UpsampleRgbaLinePair",$r,4),wt("UpsampleBgraLinePair",Fi,4),wt("UpsampleArgbLinePair",Vi,4),wt("UpsampleRgba4444LinePair",ei,2),wt("UpsampleRgb565LinePair",Wn,2);var Wu=xe.UpsampleRgbLinePair,$s=xe.UpsampleBgrLinePair,du=xe.UpsampleRgbaLinePair,Ko=xe.UpsampleBgraLinePair,dl=xe.UpsampleArgbLinePair,fu=xe.UpsampleRgba4444LinePair,Uc=xe.UpsampleRgb565LinePair,pu=16,$l=1<<pu-1,ql=-227,Zu=482,md=6,fl=0,gu=a(256),vd=a(256),yd=a(256),mu=a(256),vu=a(Zu-ql),$c=a(Zu-ql);wr("YuvToRgbRow",Fn,3),wr("YuvToBgrRow",mi,3),wr("YuvToRgbaRow",$r,4),wr("YuvToBgraRow",Fi,4),wr("YuvToArgbRow",Vi,4),wr("YuvToRgba4444Row",ei,2),wr("YuvToRgb565Row",Wn,2);var qc=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],yu=[0,2,8],Vc=[8,7,6,4,4,2,2,2,1,1,1,1],Gc=1;this.WebPDecodeRGBA=function(p,b,M,I,re){var fe=_n,ge=new Vo,_e=new Ui;ge.ba=_e,_e.S=fe,_e.width=[_e.width],_e.height=[_e.height];var be=_e.width,Me=_e.height,Ye=new Oi;if(Ye==null||p==null)var mt=2;else t(Ye!=null),mt=vs(p,b,M,Ye.width,Ye.height,Ye.Pd,Ye.Qd,Ye.format,null);if(mt!=0?be=0:(be!=null&&(be[0]=Ye.width[0]),Me!=null&&(Me[0]=Ye.height[0]),be=1),be){_e.width=_e.width[0],_e.height=_e.height[0],I!=null&&(I[0]=_e.width),re!=null&&(re[0]=_e.height);e:{if(I=new cr,(re=new Jr).data=p,re.w=b,re.ha=M,re.kd=1,b=[0],t(re!=null),((p=vs(re.data,re.w,re.ha,null,null,null,b,null,re))==0||p==7)&&b[0]&&(p=4),(b=p)==0){if(t(ge!=null),I.data=re.data,I.w=re.w+re.offset,I.ha=re.ha-re.offset,I.put=wi,I.ac=Yn,I.bc=pi,I.ma=ge,re.xa){if((p=ur())==null){ge=1;break e}if(function(vt,lt){var St=[0],Lt=[0],Qe=[0];t:for(;;){if(vt==null)return 0;if(lt==null)return vt.a=2,0;if(vt.l=lt,vt.a=0,Q(vt.m,lt.data,lt.w,lt.ha),!sn(vt.m,St,Lt,Qe)){vt.a=3;break t}if(vt.xb=Ul,lt.width=St[0],lt.height=Lt[0],!jr(St[0],Lt[0],1,vt,null))break t;return 1}return t(vt.a!=0),0}(p,I)){if(I=(b=no(I.width,I.height,ge.Oa,ge.ba))==0){t:{I=p;n:for(;;){if(I==null){I=0;break t}if(t(I.s.yc!=null),t(I.s.Ya!=null),t(0<I.s.Wb),t((M=I.l)!=null),t((re=M.ma)!=null),I.xb!=0){if(I.ca=re.ba,I.tb=re.tb,t(I.ca!=null),!Va(re.Oa,M,Zo)){I.a=2;break n}if(!Es(I,M.width)||M.da)break n;if((M.da||Tn(I.ca.S))&&ut(),11>I.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),I.ca.f.kb.F!=null&&ut()),I.Pb&&0<I.s.ua&&I.s.vb.X==null&&!ye(I.s.vb,I.s.Wa.Xa)){I.a=1;break n}I.xb=0}if(!_r(I,I.V,I.Ba,I.c,I.i,M.o,Ii))break n;re.Dc=I.Ma,I=1;break t}t(I.a!=0),I=0}I=!I}I&&(b=p.a)}else b=p.a}else{if((p=new On)==null){ge=1;break e}if(p.Fa=re.na,p.P=re.P,p.qc=re.Sa,Hr(p,I)){if((b=no(I.width,I.height,ge.Oa,ge.ba))==0){if(p.Aa=0,M=ge.Oa,t((re=p)!=null),M!=null){if(0<(be=0>(be=M.Md)?0:100<be?255:255*be/100)){for(Me=Ye=0;4>Me;++Me)12>(mt=re.pb[Me]).lc&&(mt.ia=be*Vc[0>mt.lc?0:mt.lc]>>3),Ye|=mt.ia;Ye&&(alert("todo:VP8InitRandom"),re.ia=1)}re.Ga=M.Id,100<re.Ga?re.Ga=100:0>re.Ga&&(re.Ga=0)}xn(p,I)||(b=p.a)}}else b=p.a}b==0&&ge.Oa!=null&&ge.Oa.fd&&(b=to(ge.ba))}ge=b}fe=ge!=0?null:11>fe?_e.f.RGBA.eb:_e.f.kb.y}else fe=null;return fe};var Hc=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function v(xe,Be){for(var ze="",te=0;te<4;te++)ze+=String.fromCharCode(xe[Be++]);return ze}function _(xe,Be){return(xe[Be+0]<<0|xe[Be+1]<<8|xe[Be+2]<<16)>>>0}function x(xe,Be){return(xe[Be+0]<<0|xe[Be+1]<<8|xe[Be+2]<<16|xe[Be+3]<<24)>>>0}new f;var k=[0],w=[0],N=[],z=new f,W=e,O=function(xe,Be){var ze={},te=0,J=!1,Ee=0,he=0;if(ze.frames=[],!function(ne,ae,q,R){for(var U=0;U<R;U++)if(ne[ae+U]!=q.charCodeAt(U))return!0;return!1}(xe,Be,"RIFF",4)){var P,F;for(x(xe,Be+=4),Be+=8;Be<xe.length;){var G=v(xe,Be),Q=x(xe,Be+=4);Be+=4;var Ae=Q+(1&Q);switch(G){case"VP8 ":case"VP8L":ze.frames[te]===void 0&&(ze.frames[te]={}),(T=ze.frames[te]).src_off=J?he:Be-8,T.src_size=Ee+Q+8,te++,J&&(J=!1,Ee=0,he=0);break;case"VP8X":(T=ze.header={}).feature_flags=xe[Be];var oe=Be+4;T.canvas_width=1+_(xe,oe),oe+=3,T.canvas_height=1+_(xe,oe),oe+=3;break;case"ALPH":J=!0,Ee=Ae+8,he=Be-8;break;case"ANIM":(T=ze.header).bgcolor=x(xe,Be),oe=Be+4,T.loop_count=(P=xe)[(F=oe)+0]<<0|P[F+1]<<8,oe+=2;break;case"ANMF":var me,T;(T=ze.frames[te]={}).offset_x=2*_(xe,Be),Be+=3,T.offset_y=2*_(xe,Be),Be+=3,T.width=1+_(xe,Be),Be+=3,T.height=1+_(xe,Be),Be+=3,T.duration=_(xe,Be),Be+=3,me=xe[Be++],T.dispose=1&me,T.blend=me>>1&1}G!="ANMF"&&(Be+=Ae)}return ze}}(W,0);O.response=W,O.rgbaoutput=!0,O.dataurl=!1;var Z=O.header?O.header:null,se=O.frames?O.frames:null;if(Z){Z.loop_counter=Z.loop_count,k=[Z.canvas_height],w=[Z.canvas_width];for(var Se=0;Se<se.length&&se[Se].blend!=0;Se++);}var Ne=se[0],$e=z.WebPDecodeRGBA(W,Ne.src_off,Ne.src_size,w,k);Ne.rgba=$e,Ne.imgwidth=w[0],Ne.imgheight=k[0];for(var Pe=0;Pe<w[0]*k[0]*4;Pe++)N[Pe]=$e[Pe];return this.width=w,this.height=k,this.data=N,this}(function(e){var t=function(){return typeof Df=="function"},n=function(k,w,N,z){var W=4,O=u;switch(z){case e.image_compression.FAST:W=1,O=a;break;case e.image_compression.MEDIUM:W=6,O=d;break;case e.image_compression.SLOW:W=9,O=f}k=i(k,w,N,O);var Z=Df(k,{level:W});return e.__addimage__.arrayBufferToBinaryString(Z)},i=function(k,w,N,z){for(var W,O,Z,se=k.length/w,Se=new Uint8Array(k.length+se),Ne=_(),$e=0;$e<se;$e+=1){if(Z=$e*w,W=k.subarray(Z,Z+w),z)Se.set(z(W,N,O),Z+$e);else{for(var Pe,xe=Ne.length,Be=[];Pe<xe;Pe+=1)Be[Pe]=Ne[Pe](W,N,O);var ze=x(Be.concat());Se.set(Be[ze],Z+$e)}O=W}return Se},o=function(k){var w=Array.apply([],k);return w.unshift(0),w},a=function(k,w){var N,z=[],W=k.length;z[0]=1;for(var O=0;O<W;O+=1)N=k[O-w]||0,z[O+1]=k[O]-N+256&255;return z},u=function(k,w,N){var z,W=[],O=k.length;W[0]=2;for(var Z=0;Z<O;Z+=1)z=N&&N[Z]||0,W[Z+1]=k[Z]-z+256&255;return W},d=function(k,w,N){var z,W,O=[],Z=k.length;O[0]=3;for(var se=0;se<Z;se+=1)z=k[se-w]||0,W=N&&N[se]||0,O[se+1]=k[se]+256-(z+W>>>1)&255;return O},f=function(k,w,N){var z,W,O,Z,se=[],Se=k.length;se[0]=4;for(var Ne=0;Ne<Se;Ne+=1)z=k[Ne-w]||0,W=N&&N[Ne]||0,O=N&&N[Ne-w]||0,Z=v(z,W,O),se[Ne+1]=k[Ne]-Z+256&255;return se},v=function(k,w,N){if(k===w&&w===N)return k;var z=Math.abs(w-N),W=Math.abs(k-N),O=Math.abs(k+w-N-N);return z<=W&&z<=O?k:W<=O?w:N},_=function(){return[o,a,u,d,f]},x=function(k){var w=k.map(function(N){return N.reduce(function(z,W){return z+Math.abs(W)},0)});return w.indexOf(Math.min.apply(null,w))};e.processPNG=function(k,w,N,z){var W,O,Z,se,Se,Ne,$e,Pe,xe,Be,ze,te,J,Ee,he,P=this.decode.FLATE_DECODE,F="";if(this.__addimage__.isArrayBuffer(k)&&(k=new Uint8Array(k)),this.__addimage__.isArrayBufferView(k)){if(k=(Z=new UC(k)).imgData,O=Z.bits,W=Z.colorSpace,Se=Z.colors,[4,6].indexOf(Z.colorType)!==-1){if(Z.bits===8){xe=(Pe=Z.pixelBitlength==32?new Uint32Array(Z.decodePixels().buffer):Z.pixelBitlength==16?new Uint16Array(Z.decodePixels().buffer):new Uint8Array(Z.decodePixels().buffer)).length,ze=new Uint8Array(xe*Z.colors),Be=new Uint8Array(xe);var G,Q=Z.pixelBitlength-Z.bits;for(Ee=0,he=0;Ee<xe;Ee++){for(J=Pe[Ee],G=0;G<Q;)ze[he++]=J>>>G&255,G+=Z.bits;Be[Ee]=J>>>G&255}}if(Z.bits===16){xe=(Pe=new Uint32Array(Z.decodePixels().buffer)).length,ze=new Uint8Array(xe*(32/Z.pixelBitlength)*Z.colors),Be=new Uint8Array(xe*(32/Z.pixelBitlength)),te=Z.colors>1,Ee=0,he=0;for(var Ae=0;Ee<xe;)J=Pe[Ee++],ze[he++]=J>>>0&255,te&&(ze[he++]=J>>>16&255,J=Pe[Ee++],ze[he++]=J>>>0&255),Be[Ae++]=J>>>16&255;O=8}z!==e.image_compression.NONE&&t()?(k=n(ze,Z.width*Z.colors,Z.colors,z),$e=n(Be,Z.width,1,z)):(k=ze,$e=Be,P=void 0)}if(Z.colorType===3&&(W=this.color_spaces.INDEXED,Ne=Z.palette,Z.transparency.indexed)){var oe=Z.transparency.indexed,me=0;for(Ee=0,xe=oe.length;Ee<xe;++Ee)me+=oe[Ee];if((me/=255)===xe-1&&oe.indexOf(0)!==-1)se=[oe.indexOf(0)];else if(me!==xe){for(Pe=Z.decodePixels(),Be=new Uint8Array(Pe.length),Ee=0,xe=Pe.length;Ee<xe;Ee++)Be[Ee]=oe[Pe[Ee]];$e=n(Be,Z.width,1)}}var T=function(ne){var ae;switch(ne){case e.image_compression.FAST:ae=11;break;case e.image_compression.MEDIUM:ae=13;break;case e.image_compression.SLOW:ae=14;break;default:ae=12}return ae}(z);return P===this.decode.FLATE_DECODE&&(F="/Predictor "+T+" "),F+="/Colors "+Se+" /BitsPerComponent "+O+" /Columns "+Z.width,(this.__addimage__.isArrayBuffer(k)||this.__addimage__.isArrayBufferView(k))&&(k=this.__addimage__.arrayBufferToBinaryString(k)),($e&&this.__addimage__.isArrayBuffer($e)||this.__addimage__.isArrayBufferView($e))&&($e=this.__addimage__.arrayBufferToBinaryString($e)),{alias:N,data:k,index:w,filter:P,decodeParameters:F,transparency:se,palette:Ne,sMask:$e,predictor:T,width:Z.width,height:Z.height,bitsPerComponent:O,colorSpace:W}}}})(Cn.API),function(e){e.processGIF89A=function(t,n,i,o){var a=new $C(t),u=a.width,d=a.height,f=[];a.decodeAndBlitFrameRGBA(0,f);var v={data:f,width:u,height:d},_=new ef(100).encode(v,100);return e.processJPEG.call(this,_,n,i,o)},e.processGIF87A=e.processGIF89A}(Cn.API),Jo.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var t=0;t<e;t++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:o,green:i,blue:n,quad:a}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Jo.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[e]()}catch(n){xi.log("bit decode error:"+n)}},Jo.prototype.bit1=function(){var e,t=Math.ceil(this.width/8),n=t%4;for(e=this.height-1;e>=0;e--){for(var i=this.bottom_up?e:this.height-1-e,o=0;o<t;o++)for(var a=this.datav.getUint8(this.pos++,!0),u=i*this.width*4+8*o*4,d=0;d<8&&8*o+d<this.width;d++){var f=this.palette[a>>7-d&1];this.data[u+4*d]=f.blue,this.data[u+4*d+1]=f.green,this.data[u+4*d+2]=f.red,this.data[u+4*d+3]=255}n!==0&&(this.pos+=4-n)}},Jo.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),t=e%4,n=this.height-1;n>=0;n--){for(var i=this.bottom_up?n:this.height-1-n,o=0;o<e;o++){var a=this.datav.getUint8(this.pos++,!0),u=i*this.width*4+2*o*4,d=a>>4,f=15&a,v=this.palette[d];if(this.data[u]=v.blue,this.data[u+1]=v.green,this.data[u+2]=v.red,this.data[u+3]=255,2*o+1>=this.width)break;v=this.palette[f],this.data[u+4]=v.blue,this.data[u+4+1]=v.green,this.data[u+4+2]=v.red,this.data[u+4+3]=255}t!==0&&(this.pos+=4-t)}},Jo.prototype.bit8=function(){for(var e=this.width%4,t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,i=0;i<this.width;i++){var o=this.datav.getUint8(this.pos++,!0),a=n*this.width*4+4*i;if(o<this.palette.length){var u=this.palette[o];this.data[a]=u.red,this.data[a+1]=u.green,this.data[a+2]=u.blue,this.data[a+3]=255}else this.data[a]=255,this.data[a+1]=255,this.data[a+2]=255,this.data[a+3]=255}e!==0&&(this.pos+=4-e)}},Jo.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),n=this.height-1;n>=0;n--){for(var i=this.bottom_up?n:this.height-1-n,o=0;o<this.width;o++){var a=this.datav.getUint16(this.pos,!0);this.pos+=2;var u=(a&t)/t*255|0,d=(a>>5&t)/t*255|0,f=(a>>10&t)/t*255|0,v=a>>15?255:0,_=i*this.width*4+4*o;this.data[_]=f,this.data[_+1]=d,this.data[_+2]=u,this.data[_+3]=v}this.pos+=e}},Jo.prototype.bit16=function(){for(var e=this.width%3,t=parseInt("11111",2),n=parseInt("111111",2),i=this.height-1;i>=0;i--){for(var o=this.bottom_up?i:this.height-1-i,a=0;a<this.width;a++){var u=this.datav.getUint16(this.pos,!0);this.pos+=2;var d=(u&t)/t*255|0,f=(u>>5&n)/n*255|0,v=(u>>11)/t*255|0,_=o*this.width*4+4*a;this.data[_]=v,this.data[_+1]=f,this.data[_+2]=d,this.data[_+3]=255}this.pos+=e}},Jo.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var i=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),u=t*this.width*4+4*n;this.data[u]=a,this.data[u+1]=o,this.data[u+2]=i,this.data[u+3]=255}this.pos+=this.width%4}},Jo.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var i=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),u=this.datav.getUint8(this.pos++,!0),d=t*this.width*4+4*n;this.data[d]=a,this.data[d+1]=o,this.data[d+2]=i,this.data[d+3]=u}},Jo.prototype.getData=function(){return this.data},function(e){e.processBMP=function(t,n,i,o){var a=new Jo(t,!1),u=a.width,d=a.height,f={data:a.getData(),width:u,height:d},v=new ef(100).encode(f,100);return e.processJPEG.call(this,v,n,i,o)}}(Cn.API),Cg.prototype.getData=function(){return this.data},function(e){e.processWEBP=function(t,n,i,o){var a=new Cg(t),u=a.width,d=a.height,f={data:a.getData(),width:u,height:d},v=new ef(100).encode(f,100);return e.processJPEG.call(this,v,n,i,o)}}(Cn.API),Cn.API.processRGBA=function(e,t,n){for(var i=e.data,o=i.length,a=new Uint8Array(o/4*3),u=new Uint8Array(o/4),d=0,f=0,v=0;v<o;v+=4){var _=i[v],x=i[v+1],k=i[v+2],w=i[v+3];a[d++]=_,a[d++]=x,a[d++]=k,u[f++]=w}var N=this.__addimage__.arrayBufferToBinaryString(a);return{alpha:this.__addimage__.arrayBufferToBinaryString(u),data:N,index:t,alias:n,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},Cn.API.setLanguage=function(e){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]!==void 0&&(this.internal.languageSettings.languageCode=e,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Cu=Cn.API,ah=Cu.getCharWidthsArray=function(e,t){var n,i,o=(t=t||{}).font||this.internal.getFont(),a=t.fontSize||this.internal.getFontSize(),u=t.charSpace||this.internal.getCharSpace(),d=t.widths?t.widths:o.metadata.Unicode.widths,f=d.fof?d.fof:1,v=t.kerning?t.kerning:o.metadata.Unicode.kerning,_=v.fof?v.fof:1,x=t.doKerning!==!1,k=0,w=e.length,N=0,z=d[0]||f,W=[];for(n=0;n<w;n++)i=e.charCodeAt(n),typeof o.metadata.widthOfString=="function"?W.push((o.metadata.widthOfGlyph(o.metadata.characterToGlyph(i))+u*(1e3/a)||0)/1e3):(k=x&&yi(v[i])==="object"&&!isNaN(parseInt(v[i][N],10))?v[i][N]/_:0,W.push((d[i]||z)/f+k)),N=i;return W},bg=Cu.getStringUnitWidth=function(e,t){var n=(t=t||{}).fontSize||this.internal.getFontSize(),i=t.font||this.internal.getFont(),o=t.charSpace||this.internal.getCharSpace();return Cu.processArabic&&(e=Cu.processArabic(e)),typeof i.metadata.widthOfString=="function"?i.metadata.widthOfString(e,n,o)/n:ah.apply(this,arguments).reduce(function(a,u){return a+u},0)},wg=function(e,t,n,i){for(var o=[],a=0,u=e.length,d=0;a!==u&&d+t[a]<n;)d+=t[a],a++;o.push(e.slice(0,a));var f=a;for(d=0;a!==u;)d+t[a]>i&&(o.push(e.slice(f,a)),d=0,f=a),d+=t[a],a++;return f!==a&&o.push(e.slice(f,a)),o},xg=function(e,t,n){n||(n={});var i,o,a,u,d,f,v,_=[],x=[_],k=n.textIndent||0,w=0,N=0,z=e.split(" "),W=ah.apply(this,[" ",n])[0];if(f=n.lineIndent===-1?z[0].length+2:n.lineIndent||0){var O=Array(f).join(" "),Z=[];z.map(function(Se){(Se=Se.split(/\s*\n/)).length>1?Z=Z.concat(Se.map(function(Ne,$e){return($e&&Ne.length?`
`:"")+Ne})):Z.push(Se[0])}),z=Z,f=bg.apply(this,[O,n])}for(a=0,u=z.length;a<u;a++){var se=0;if(i=z[a],f&&i[0]==`
`&&(i=i.substr(1),se=1),k+w+(N=(o=ah.apply(this,[i,n])).reduce(function(Se,Ne){return Se+Ne},0))>t||se){if(N>t){for(d=wg.apply(this,[i,o,t-(k+w),t]),_.push(d.shift()),_=[d.pop()];d.length;)x.push([d.shift()]);N=o.slice(i.length-(_[0]?_[0].length:0)).reduce(function(Se,Ne){return Se+Ne},0)}else _=[i];x.push(_),k=N+f,w=W}else _.push(i),k+=w+N,w=W}return v=f?function(Se,Ne){return(Ne?O:"")+Se.join(" ")}:function(Se){return Se.join(" ")},x.map(v)},Cu.splitTextToSize=function(e,t,n){var i,o=(n=n||{}).fontSize||this.internal.getFontSize(),a=(function(_){if(_.widths&&_.kerning)return{widths:_.widths,kerning:_.kerning};var x=this.internal.getFont(_.fontName,_.fontStyle);return x.metadata.Unicode?{widths:x.metadata.Unicode.widths||{0:1},kerning:x.metadata.Unicode.kerning||{}}:{font:x.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,n);i=Array.isArray(e)?e:String(e).split(/\r?\n/);var u=1*this.internal.scaleFactor*t/o;a.textIndent=n.textIndent?1*n.textIndent*this.internal.scaleFactor/o:0,a.lineIndent=n.lineIndent;var d,f,v=[];for(d=0,f=i.length;d<f;d++)v=v.concat(xg.apply(this,[i[d],u,a]));return v},function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var t="klmnopqrstuvwxyz",n={},i={},o=0;o<t.length;o++)n[t[o]]="0123456789abcdef"[o],i["0123456789abcdef"[o]]=t[o];var a=function(x){return"0x"+parseInt(x,10).toString(16)},u=e.__fontmetrics__.compress=function(x){var k,w,N,z,W=["{"];for(var O in x){if(k=x[O],isNaN(parseInt(O,10))?w="'"+O+"'":(O=parseInt(O,10),w=(w=a(O).slice(2)).slice(0,-1)+i[w.slice(-1)]),typeof k=="number")k<0?(N=a(k).slice(3),z="-"):(N=a(k).slice(2),z=""),N=z+N.slice(0,-1)+i[N.slice(-1)];else{if(yi(k)!=="object")throw new Error("Don't know what to do with value type "+yi(k)+".");N=u(k)}W.push(w+N)}return W.push("}"),W.join("")},d=e.__fontmetrics__.uncompress=function(x){if(typeof x!="string")throw new Error("Invalid argument passed to uncompress.");for(var k,w,N,z,W={},O=1,Z=W,se=[],Se="",Ne="",$e=x.length-1,Pe=1;Pe<$e;Pe+=1)(z=x[Pe])=="'"?k?(N=k.join(""),k=void 0):k=[]:k?k.push(z):z=="{"?(se.push([Z,N]),Z={},N=void 0):z=="}"?((w=se.pop())[0][w[1]]=Z,N=void 0,Z=w[0]):z=="-"?O=-1:N===void 0?n.hasOwnProperty(z)?(Se+=n[z],N=parseInt(Se,16)*O,O=1,Se=""):Se+=z:n.hasOwnProperty(z)?(Ne+=n[z],Z[N]=parseInt(Ne,16)*O,O=1,N=void 0,Ne=""):Ne+=z;return W},f={codePages:["WinAnsiEncoding"],WinAnsiEncoding:d("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},v={Unicode:{Courier:f,"Courier-Bold":f,"Courier-BoldOblique":f,"Courier-Oblique":f,Helvetica:f,"Helvetica-Bold":f,"Helvetica-BoldOblique":f,"Helvetica-Oblique":f,"Times-Roman":f,"Times-Bold":f,"Times-BoldItalic":f,"Times-Italic":f}},_={Unicode:{"Courier-Oblique":d("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":d("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":d("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:d("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":d("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":d("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:d("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:d("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":d("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:d("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":d("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":d("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":d("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":d("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(x){var k=x.font,w=_.Unicode[k.postScriptName];w&&(k.metadata.Unicode={},k.metadata.Unicode.widths=w.widths,k.metadata.Unicode.kerning=w.kerning);var N=v.Unicode[k.postScriptName];N&&(k.metadata.Unicode.encoding=N,k.encoding=N.codePages[0])}])}(Cn.API),function(e){var t=function(n){for(var i=n.length,o=new Uint8Array(i),a=0;a<i;a++)o[a]=n.charCodeAt(a);return o};e.API.events.push(["addFont",function(n){var i=void 0,o=n.font,a=n.instance;if(!o.isStandardFont){if(a===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+o.postScriptName+"').");if(typeof(i=a.existsFileInVFS(o.postScriptName)===!1?a.loadFile(o.postScriptName):a.getFileFromVFS(o.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+o.postScriptName+"').");(function(u,d){d=/^\x00\x01\x00\x00/.test(d)?t(d):t(wc(d)),u.metadata=e.API.TTFFont.open(d),u.metadata.Unicode=u.metadata.Unicode||{encoding:{},kerning:{},widths:[]},u.metadata.glyIdsUsed=[0]})(o,i)}}])}(Cn),function(e){function t(){return(kn.canvg?Promise.resolve(kn.canvg):eu(()=>import("./index.es.js"),[])).catch(function(n){return Promise.reject(new Error("Could not load canvg: "+n))}).then(function(n){return n.default?n.default:n})}Cn.API.addSvgAsImage=function(n,i,o,a,u,d,f,v){if(isNaN(i)||isNaN(o))throw xi.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(a)||isNaN(u))throw xi.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var _=document.createElement("canvas");_.width=a,_.height=u;var x=_.getContext("2d");x.fillStyle="#fff",x.fillRect(0,0,_.width,_.height);var k={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},w=this;return t().then(function(N){return N.fromString(x,n,k)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(N){return N.render(k)}).then(function(){w.addImage(_.toDataURL("image/jpeg",1),i,o,a,u,f,v)})}}(),Cn.API.putTotalPages=function(e){var t,n=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(e,"g"),n=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),n=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var i=1;i<=this.internal.getNumberOfPages();i++)for(var o=0;o<this.internal.pages[i].length;o++)this.internal.pages[i][o]=this.internal.pages[i][o].replace(t,n);return this},Cn.API.viewerPreferences=function(e,t){var n;e=e||{},t=t||!1;var i,o,a,u={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},d=Object.keys(u),f=[],v=0,_=0,x=0;function k(N,z){var W,O=!1;for(W=0;W<N.length;W+=1)N[W]===z&&(O=!0);return O}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(u)),this.internal.viewerpreferences.isSubscribed=!1),n=this.internal.viewerpreferences.configuration,e==="reset"||t===!0){var w=d.length;for(x=0;x<w;x+=1)n[d[x]].value=n[d[x]].defaultValue,n[d[x]].explicitSet=!1}if(yi(e)==="object"){for(o in e)if(a=e[o],k(d,o)&&a!==void 0){if(n[o].type==="boolean"&&typeof a=="boolean")n[o].value=a;else if(n[o].type==="name"&&k(n[o].valueSet,a))n[o].value=a;else if(n[o].type==="integer"&&Number.isInteger(a))n[o].value=a;else if(n[o].type==="array"){for(v=0;v<a.length;v+=1)if(i=!0,a[v].length===1&&typeof a[v][0]=="number")f.push(String(a[v]-1));else if(a[v].length>1){for(_=0;_<a[v].length;_+=1)typeof a[v][_]!="number"&&(i=!1);i===!0&&f.push([a[v][0]-1,a[v][1]-1].join(" "))}n[o].value="["+f.join(" ")+"]"}else n[o].value=n[o].defaultValue;n[o].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var N,z=[];for(N in n)n[N].explicitSet===!0&&(n[N].type==="name"?z.push("/"+N+" /"+n[N].value):z.push("/"+N+" "+n[N].value));z.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+z.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=n,this},function(e){var t=function(){var i='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',o=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),a=unescape(encodeURIComponent(i)),u=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),d=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),f=unescape(encodeURIComponent("</x:xmpmeta>")),v=a.length+u.length+d.length+o.length+f.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+v+" >>"),this.internal.write("stream"),this.internal.write(o+a+u+d+f),this.internal.write("endstream"),this.internal.write("endobj")},n=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};e.addMetadata=function(i,o){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:i,namespaceuri:o||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",n),this.internal.events.subscribe("postPutResources",t)),this}}(Cn.API),function(e){var t=e.API,n=t.pdfEscape16=function(a,u){for(var d,f=u.metadata.Unicode.widths,v=["","0","00","000","0000"],_=[""],x=0,k=a.length;x<k;++x){if(d=u.metadata.characterToGlyph(a.charCodeAt(x)),u.metadata.glyIdsUsed.push(d),u.metadata.toUnicode[d]=a.charCodeAt(x),f.indexOf(d)==-1&&(f.push(d),f.push([parseInt(u.metadata.widthOfGlyph(d),10)])),d=="0")return _.join("");d=d.toString(16),_.push(v[4-d.length],d)}return _.join("")},i=function(a){var u,d,f,v,_,x,k;for(_=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,f=[],x=0,k=(d=Object.keys(a).sort(function(w,N){return w-N})).length;x<k;x++)u=d[x],f.length>=100&&(_+=`
`+f.length+` beginbfchar
`+f.join(`
`)+`
endbfchar`,f=[]),a[u]!==void 0&&a[u]!==null&&typeof a[u].toString=="function"&&(v=("0000"+a[u].toString(16)).slice(-4),u=("0000"+(+u).toString(16)).slice(-4),f.push("<"+u+"><"+v+">"));return f.length&&(_+=`
`+f.length+` beginbfchar
`+f.join(`
`)+`
endbfchar
`),_+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(a){(function(u){var d=u.font,f=u.out,v=u.newObject,_=u.putStream;if(d.metadata instanceof e.API.TTFFont&&d.encoding==="Identity-H"){for(var x=d.metadata.Unicode.widths,k=d.metadata.subset.encode(d.metadata.glyIdsUsed,1),w="",N=0;N<k.length;N++)w+=String.fromCharCode(k[N]);var z=v();_({data:w,addLength1:!0,objectId:z}),f("endobj");var W=v();_({data:i(d.metadata.toUnicode),addLength1:!0,objectId:W}),f("endobj");var O=v();f("<<"),f("/Type /FontDescriptor"),f("/FontName /"+Mu(d.fontName)),f("/FontFile2 "+z+" 0 R"),f("/FontBBox "+e.API.PDFObject.convert(d.metadata.bbox)),f("/Flags "+d.metadata.flags),f("/StemV "+d.metadata.stemV),f("/ItalicAngle "+d.metadata.italicAngle),f("/Ascent "+d.metadata.ascender),f("/Descent "+d.metadata.decender),f("/CapHeight "+d.metadata.capHeight),f(">>"),f("endobj");var Z=v();f("<<"),f("/Type /Font"),f("/BaseFont /"+Mu(d.fontName)),f("/FontDescriptor "+O+" 0 R"),f("/W "+e.API.PDFObject.convert(x)),f("/CIDToGIDMap /Identity"),f("/DW 1000"),f("/Subtype /CIDFontType2"),f("/CIDSystemInfo"),f("<<"),f("/Supplement 0"),f("/Registry (Adobe)"),f("/Ordering ("+d.encoding+")"),f(">>"),f(">>"),f("endobj"),d.objectNumber=v(),f("<<"),f("/Type /Font"),f("/Subtype /Type0"),f("/ToUnicode "+W+" 0 R"),f("/BaseFont /"+Mu(d.fontName)),f("/Encoding /"+d.encoding),f("/DescendantFonts ["+Z+" 0 R]"),f(">>"),f("endobj"),d.isAlreadyPutted=!0}})(a)}]),t.events.push(["putFont",function(a){(function(u){var d=u.font,f=u.out,v=u.newObject,_=u.putStream;if(d.metadata instanceof e.API.TTFFont&&d.encoding==="WinAnsiEncoding"){for(var x=d.metadata.rawData,k="",w=0;w<x.length;w++)k+=String.fromCharCode(x[w]);var N=v();_({data:k,addLength1:!0,objectId:N}),f("endobj");var z=v();_({data:i(d.metadata.toUnicode),addLength1:!0,objectId:z}),f("endobj");var W=v();f("<<"),f("/Descent "+d.metadata.decender),f("/CapHeight "+d.metadata.capHeight),f("/StemV "+d.metadata.stemV),f("/Type /FontDescriptor"),f("/FontFile2 "+N+" 0 R"),f("/Flags 96"),f("/FontBBox "+e.API.PDFObject.convert(d.metadata.bbox)),f("/FontName /"+Mu(d.fontName)),f("/ItalicAngle "+d.metadata.italicAngle),f("/Ascent "+d.metadata.ascender),f(">>"),f("endobj"),d.objectNumber=v();for(var O=0;O<d.metadata.hmtx.widths.length;O++)d.metadata.hmtx.widths[O]=parseInt(d.metadata.hmtx.widths[O]*(1e3/d.metadata.head.unitsPerEm));f("<</Subtype/TrueType/Type/Font/ToUnicode "+z+" 0 R/BaseFont/"+Mu(d.fontName)+"/FontDescriptor "+W+" 0 R/Encoding/"+d.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(d.metadata.hmtx.widths)+">>"),f("endobj"),d.isAlreadyPutted=!0}})(a)}]);var o=function(a){var u,d=a.text||"",f=a.x,v=a.y,_=a.options||{},x=a.mutex||{},k=x.pdfEscape,w=x.activeFontKey,N=x.fonts,z=w,W="",O=0,Z="",se=N[z].encoding;if(N[z].encoding!=="Identity-H")return{text:d,x:f,y:v,options:_,mutex:x};for(Z=d,z=w,Array.isArray(d)&&(Z=d[0]),O=0;O<Z.length;O+=1)N[z].metadata.hasOwnProperty("cmap")&&(u=N[z].metadata.cmap.unicode.codeMap[Z[O].charCodeAt(0)]),u||Z[O].charCodeAt(0)<256&&N[z].metadata.hasOwnProperty("Unicode")?W+=Z[O]:W+="";var Se="";return parseInt(z.slice(1))<14||se==="WinAnsiEncoding"?Se=k(W,z).split("").map(function(Ne){return Ne.charCodeAt(0).toString(16)}).join(""):se==="Identity-H"&&(Se=n(W,N[z])),x.isHex=!0,{text:Se,x:f,y:v,options:_,mutex:x}};t.events.push(["postProcessText",function(a){var u=a.text||"",d=[],f={text:u,x:a.x,y:a.y,options:a.options,mutex:a.mutex};if(Array.isArray(u)){var v=0;for(v=0;v<u.length;v+=1)Array.isArray(u[v])&&u[v].length===3?d.push([o(Object.assign({},f,{text:u[v][0]})).text,u[v][1],u[v][2]]):d.push(o(Object.assign({},f,{text:u[v]})).text);a.text=d}else a.text=o(Object.assign({},f,{text:u})).text}])}(Cn),function(e){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(n){return t.call(this),this.internal.vFS[n]!==void 0},e.addFileToVFS=function(n,i){return t.call(this),this.internal.vFS[n]=i,this},e.getFileFromVFS=function(n){return t.call(this),this.internal.vFS[n]!==void 0?this.internal.vFS[n]:null}}(Cn.API),function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(i){var o,a,u,d,f,v,_,x=t,k=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],w=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],N={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},z={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},W=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],O=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),Z=!1,se=0;this.__bidiEngine__={};var Se=function(te){var J=te.charCodeAt(),Ee=J>>8,he=z[Ee];return he!==void 0?x[256*he+(255&J)]:Ee===252||Ee===253?"AL":O.test(Ee)?"L":Ee===8?"R":"N"},Ne=function(te){for(var J,Ee=0;Ee<te.length;Ee++){if((J=Se(te.charAt(Ee)))==="L")return!1;if(J==="R")return!0}return!1},$e=function(te,J,Ee,he){var P,F,G,Q,Ae=J[he];switch(Ae){case"L":case"R":Z=!1;break;case"N":case"AN":break;case"EN":Z&&(Ae="AN");break;case"AL":Z=!0,Ae="R";break;case"WS":Ae="N";break;case"CS":he<1||he+1>=J.length||(P=Ee[he-1])!=="EN"&&P!=="AN"||(F=J[he+1])!=="EN"&&F!=="AN"?Ae="N":Z&&(F="AN"),Ae=F===P?F:"N";break;case"ES":Ae=(P=he>0?Ee[he-1]:"B")==="EN"&&he+1<J.length&&J[he+1]==="EN"?"EN":"N";break;case"ET":if(he>0&&Ee[he-1]==="EN"){Ae="EN";break}if(Z){Ae="N";break}for(G=he+1,Q=J.length;G<Q&&J[G]==="ET";)G++;Ae=G<Q&&J[G]==="EN"?"EN":"N";break;case"NSM":if(u&&!d){for(Q=J.length,G=he+1;G<Q&&J[G]==="NSM";)G++;if(G<Q){var oe=te[he],me=oe>=1425&&oe<=2303||oe===64286;if(P=J[G],me&&(P==="R"||P==="AL")){Ae="R";break}}}Ae=he<1||(P=J[he-1])==="B"?"N":Ee[he-1];break;case"B":Z=!1,o=!0,Ae=se;break;case"S":a=!0,Ae="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":Z=!1;break;case"BN":Ae="N"}return Ae},Pe=function(te,J,Ee){var he=te.split("");return Ee&&xe(he,Ee,{hiLevel:se}),he.reverse(),J&&J.reverse(),he.join("")},xe=function(te,J,Ee){var he,P,F,G,Q,Ae=-1,oe=te.length,me=0,T=[],ne=se?w:k,ae=[];for(Z=!1,o=!1,a=!1,P=0;P<oe;P++)ae[P]=Se(te[P]);for(F=0;F<oe;F++){if(Q=me,T[F]=$e(te,ae,T,F),he=240&(me=ne[Q][N[T[F]]]),me&=15,J[F]=G=ne[me][5],he>0)if(he===16){for(P=Ae;P<F;P++)J[P]=1;Ae=-1}else Ae=-1;if(ne[me][6])Ae===-1&&(Ae=F);else if(Ae>-1){for(P=Ae;P<F;P++)J[P]=G;Ae=-1}ae[F]==="B"&&(J[F]=0),Ee.hiLevel|=G}a&&function(q,R,U){for(var H=0;H<U;H++)if(q[H]==="S"){R[H]=se;for(var $=H-1;$>=0&&q[$]==="WS";$--)R[$]=se}}(ae,J,oe)},Be=function(te,J,Ee,he,P){if(!(P.hiLevel<te)){if(te===1&&se===1&&!o)return J.reverse(),void(Ee&&Ee.reverse());for(var F,G,Q,Ae,oe=J.length,me=0;me<oe;){if(he[me]>=te){for(Q=me+1;Q<oe&&he[Q]>=te;)Q++;for(Ae=me,G=Q-1;Ae<G;Ae++,G--)F=J[Ae],J[Ae]=J[G],J[G]=F,Ee&&(F=Ee[Ae],Ee[Ae]=Ee[G],Ee[G]=F);me=Q}me++}}},ze=function(te,J,Ee){var he=te.split(""),P={hiLevel:se};return Ee||(Ee=[]),xe(he,Ee,P),function(F,G,Q){if(Q.hiLevel!==0&&_)for(var Ae,oe=0;oe<F.length;oe++)G[oe]===1&&(Ae=W.indexOf(F[oe]))>=0&&(F[oe]=W[Ae+1])}(he,Ee,P),Be(2,he,J,Ee,P),Be(1,he,J,Ee,P),he.join("")};return this.__bidiEngine__.doBidiReorder=function(te,J,Ee){if(function(P,F){if(F)for(var G=0;G<P.length;G++)F[G]=G;d===void 0&&(d=Ne(P)),v===void 0&&(v=Ne(P))}(te,J),u||!f||v)if(u&&f&&d^v)se=d?1:0,te=Pe(te,J,Ee);else if(!u&&f&&v)se=d?1:0,te=ze(te,J,Ee),te=Pe(te,J);else if(!u||d||f||v){if(u&&!f&&d^v)te=Pe(te,J),d?(se=0,te=ze(te,J,Ee)):(se=1,te=ze(te,J,Ee),te=Pe(te,J));else if(u&&d&&!f&&v)se=1,te=ze(te,J,Ee),te=Pe(te,J);else if(!u&&!f&&d^v){var he=_;d?(se=1,te=ze(te,J,Ee),se=0,_=!1,te=ze(te,J,Ee),_=he):(se=0,te=ze(te,J,Ee),te=Pe(te,J),se=1,_=!1,te=ze(te,J,Ee),_=he,te=Pe(te,J))}}else se=0,te=ze(te,J,Ee);else se=d?1:0,te=ze(te,J,Ee);return te},this.__bidiEngine__.setOptions=function(te){te&&(u=te.isInputVisual,f=te.isOutputVisual,d=te.isInputRtl,v=te.isOutputRtl,_=te.isSymmetricSwapping)},this.__bidiEngine__.setOptions(i),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],n=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(i){var o=i.text,a=(i.x,i.y,i.options||{}),u=(i.mutex,a.lang,[]);if(a.isInputVisual=typeof a.isInputVisual!="boolean"||a.isInputVisual,n.setOptions(a),Object.prototype.toString.call(o)==="[object Array]"){var d=0;for(u=[],d=0;d<o.length;d+=1)Object.prototype.toString.call(o[d])==="[object Array]"?u.push([n.doBidiReorder(o[d][0]),o[d][1],o[d][2]]):u.push([n.doBidiReorder(o[d])]);i.text=u}else i.text=n.doBidiReorder(o);n.setOptions({isInputVisual:!0})}])}(Cn),Cn.API.TTFFont=function(){function e(t){var n;if(this.rawData=t,n=this.contents=new Ol(t),this.contents.pos=4,n.readString(4)==="ttcf")throw new Error("TTCF not supported.");n.pos=0,this.parse(),this.subset=new iP(this),this.registerTTF()}return e.open=function(t){return new e(t)},e.prototype.parse=function(){return this.directory=new qC(this.contents),this.head=new GC(this),this.name=new YC(this),this.cmap=new lv(this),this.toUnicode={},this.hhea=new HC(this),this.maxp=new JC(this),this.hmtx=new XC(this),this.post=new ZC(this),this.os2=new WC(this),this.loca=new nP(this),this.glyf=new QC(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var t,n,i,o,a;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var u,d,f,v;for(v=[],u=0,d=(f=this.bbox).length;u<d;u++)t=f[u],v.push(Math.round(t*this.scaleFactor));return v}).call(this),this.stemV=0,this.post.exists?(i=255&(o=this.post.italic_angle),32768&(n=o>>16)&&(n=-(1+(65535^n))),this.italicAngle=+(n+"."+i)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(a=this.familyClass)===1||a===2||a===3||a===4||a===5||a===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(t){var n;return((n=this.cmap.unicode)!=null?n.codeMap[t]:void 0)||0},e.prototype.widthOfGlyph=function(t){var n;return n=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*n},e.prototype.widthOfString=function(t,n,i){var o,a,u,d;for(u=0,a=0,d=(t=""+t).length;0<=d?a<d:a>d;a=0<=d?++a:--a)o=t.charCodeAt(a),u+=this.widthOfGlyph(this.characterToGlyph(o))+i*(1e3/n)||0;return u*(n/1e3)},e.prototype.lineHeight=function(t,n){var i;return n==null&&(n=!1),i=n?this.lineGap:0,(this.ascender+i-this.decender)/1e3*t},e}();var oa,Ol=function(){function e(t){this.data=t??[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(t){return this.data[this.pos++]=t},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},e.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},e.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},e.prototype.readString=function(t){var n,i;for(i=[],n=0;0<=t?n<t:n>t;n=0<=t?++n:--n)i[n]=String.fromCharCode(this.readByte());return i.join("")},e.prototype.writeString=function(t){var n,i,o;for(o=[],n=0,i=t.length;0<=i?n<i:n>i;n=0<=i?++n:--n)o.push(this.writeByte(t.charCodeAt(n)));return o},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(t){return this.writeInt16(t)},e.prototype.readLongLong=function(){var t,n,i,o,a,u,d,f;return t=this.readByte(),n=this.readByte(),i=this.readByte(),o=this.readByte(),a=this.readByte(),u=this.readByte(),d=this.readByte(),f=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^n)+1099511627776*(255^i)+4294967296*(255^o)+16777216*(255^a)+65536*(255^u)+256*(255^d)+(255^f)+1):72057594037927940*t+281474976710656*n+1099511627776*i+4294967296*o+16777216*a+65536*u+256*d+f},e.prototype.writeLongLong=function(t){var n,i;return n=Math.floor(t/4294967296),i=4294967295&t,this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n),this.writeByte(i>>24&255),this.writeByte(i>>16&255),this.writeByte(i>>8&255),this.writeByte(255&i)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(t){return this.writeInt32(t)},e.prototype.read=function(t){var n,i;for(n=[],i=0;0<=t?i<t:i>t;i=0<=t?++i:--i)n.push(this.readByte());return n},e.prototype.write=function(t){var n,i,o,a;for(a=[],i=0,o=t.length;i<o;i++)n=t[i],a.push(this.writeByte(n));return a},e}(),qC=function(){var e;function t(n){var i,o,a;for(this.scalarType=n.readInt(),this.tableCount=n.readShort(),this.searchRange=n.readShort(),this.entrySelector=n.readShort(),this.rangeShift=n.readShort(),this.tables={},o=0,a=this.tableCount;0<=a?o<a:o>a;o=0<=a?++o:--o)i={tag:n.readString(4),checksum:n.readInt(),offset:n.readInt(),length:n.readInt()},this.tables[i.tag]=i}return t.prototype.encode=function(n){var i,o,a,u,d,f,v,_,x,k,w,N,z;for(z in w=Object.keys(n).length,f=Math.log(2),x=16*Math.floor(Math.log(w)/f),u=Math.floor(x/f),_=16*w-x,(o=new Ol).writeInt(this.scalarType),o.writeShort(w),o.writeShort(x),o.writeShort(u),o.writeShort(_),a=16*w,v=o.pos+a,d=null,N=[],n)for(k=n[z],o.writeString(z),o.writeInt(e(k)),o.writeInt(v),o.writeInt(k.length),N=N.concat(k),z==="head"&&(d=v),v+=k.length;v%4;)N.push(0),v++;return o.write(N),i=2981146554-e(o.data),o.pos=d+8,o.writeUInt32(i),o.data},e=function(n){var i,o,a,u;for(n=uv.call(n);n.length%4;)n.push(0);for(a=new Ol(n),o=0,i=0,u=n.length;i<u;i=i+=4)o+=a.readUInt32();return 4294967295&o},t}(),VC={}.hasOwnProperty,Na=function(e,t){for(var n in t)VC.call(t,n)&&(e[n]=t[n]);function i(){this.constructor=e}return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};oa=function(){function e(t){var n;this.file=t,n=this.file.directory.tables[this.tag],this.exists=!!n,n&&(this.offset=n.offset,this.length=n.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var GC=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Na(t,oa),t.prototype.tag="head",t.prototype.parse=function(n){return n.pos=this.offset,this.version=n.readInt(),this.revision=n.readInt(),this.checkSumAdjustment=n.readInt(),this.magicNumber=n.readInt(),this.flags=n.readShort(),this.unitsPerEm=n.readShort(),this.created=n.readLongLong(),this.modified=n.readLongLong(),this.xMin=n.readShort(),this.yMin=n.readShort(),this.xMax=n.readShort(),this.yMax=n.readShort(),this.macStyle=n.readShort(),this.lowestRecPPEM=n.readShort(),this.fontDirectionHint=n.readShort(),this.indexToLocFormat=n.readShort(),this.glyphDataFormat=n.readShort()},t.prototype.encode=function(n){var i;return(i=new Ol).writeInt(this.version),i.writeInt(this.revision),i.writeInt(this.checkSumAdjustment),i.writeInt(this.magicNumber),i.writeShort(this.flags),i.writeShort(this.unitsPerEm),i.writeLongLong(this.created),i.writeLongLong(this.modified),i.writeShort(this.xMin),i.writeShort(this.yMin),i.writeShort(this.xMax),i.writeShort(this.yMax),i.writeShort(this.macStyle),i.writeShort(this.lowestRecPPEM),i.writeShort(this.fontDirectionHint),i.writeShort(n),i.writeShort(this.glyphDataFormat),i.data},t}(),Pg=function(){function e(t,n){var i,o,a,u,d,f,v,_,x,k,w,N,z,W,O,Z,se;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=n+t.readInt(),x=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(f=0;f<256;++f)this.codeMap[f]=t.readByte();break;case 4:for(w=t.readUInt16(),k=w/2,t.pos+=6,a=function(){var Se,Ne;for(Ne=[],f=Se=0;0<=k?Se<k:Se>k;f=0<=k?++Se:--Se)Ne.push(t.readUInt16());return Ne}(),t.pos+=2,z=function(){var Se,Ne;for(Ne=[],f=Se=0;0<=k?Se<k:Se>k;f=0<=k?++Se:--Se)Ne.push(t.readUInt16());return Ne}(),v=function(){var Se,Ne;for(Ne=[],f=Se=0;0<=k?Se<k:Se>k;f=0<=k?++Se:--Se)Ne.push(t.readUInt16());return Ne}(),_=function(){var Se,Ne;for(Ne=[],f=Se=0;0<=k?Se<k:Se>k;f=0<=k?++Se:--Se)Ne.push(t.readUInt16());return Ne}(),o=(this.length-t.pos+this.offset)/2,d=function(){var Se,Ne;for(Ne=[],f=Se=0;0<=o?Se<o:Se>o;f=0<=o?++Se:--Se)Ne.push(t.readUInt16());return Ne}(),f=O=0,se=a.length;O<se;f=++O)for(W=a[f],i=Z=N=z[f];N<=W?Z<=W:Z>=W;i=N<=W?++Z:--Z)_[f]===0?u=i+v[f]:(u=d[_[f]/2+(i-N)-(k-f)]||0)!==0&&(u+=v[f]),this.codeMap[i]=65535&u}t.pos=x}return e.encode=function(t,n){var i,o,a,u,d,f,v,_,x,k,w,N,z,W,O,Z,se,Se,Ne,$e,Pe,xe,Be,ze,te,J,Ee,he,P,F,G,Q,Ae,oe,me,T,ne,ae,q,R,U,H,$,ce,ue,V;switch(he=new Ol,u=Object.keys(t).sort(function(K,ye){return K-ye}),n){case"macroman":for(z=0,W=function(){var K=[];for(N=0;N<256;++N)K.push(0);return K}(),Z={0:0},a={},P=0,Ae=u.length;P<Ae;P++)Z[$=t[o=u[P]]]==null&&(Z[$]=++z),a[o]={old:t[o],new:Z[t[o]]},W[o]=Z[t[o]];return he.writeUInt16(1),he.writeUInt16(0),he.writeUInt32(12),he.writeUInt16(0),he.writeUInt16(262),he.writeUInt16(0),he.write(W),{charMap:a,subtable:he.data,maxGlyphID:z+1};case"unicode":for(J=[],x=[],se=0,Z={},i={},O=v=null,F=0,oe=u.length;F<oe;F++)Z[Ne=t[o=u[F]]]==null&&(Z[Ne]=++se),i[o]={old:Ne,new:Z[Ne]},d=Z[Ne]-o,O!=null&&d===v||(O&&x.push(O),J.push(o),v=d),O=o;for(O&&x.push(O),x.push(65535),J.push(65535),ze=2*(Be=J.length),xe=2*Math.pow(Math.log(Be)/Math.LN2,2),k=Math.log(xe/2)/Math.LN2,Pe=2*Be-xe,f=[],$e=[],w=[],N=G=0,me=J.length;G<me;N=++G){if(te=J[N],_=x[N],te===65535){f.push(0),$e.push(0);break}if(te-(Ee=i[te].new)>=32768)for(f.push(0),$e.push(2*(w.length+Be-N)),o=Q=te;te<=_?Q<=_:Q>=_;o=te<=_?++Q:--Q)w.push(i[o].new);else f.push(Ee-te),$e.push(0)}for(he.writeUInt16(3),he.writeUInt16(1),he.writeUInt32(12),he.writeUInt16(4),he.writeUInt16(16+8*Be+2*w.length),he.writeUInt16(0),he.writeUInt16(ze),he.writeUInt16(xe),he.writeUInt16(k),he.writeUInt16(Pe),U=0,T=x.length;U<T;U++)o=x[U],he.writeUInt16(o);for(he.writeUInt16(0),H=0,ne=J.length;H<ne;H++)o=J[H],he.writeUInt16(o);for(ce=0,ae=f.length;ce<ae;ce++)d=f[ce],he.writeUInt16(d);for(ue=0,q=$e.length;ue<q;ue++)Se=$e[ue],he.writeUInt16(Se);for(V=0,R=w.length;V<R;V++)z=w[V],he.writeUInt16(z);return{charMap:i,subtable:he.data,maxGlyphID:se+1}}},e}(),lv=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Na(t,oa),t.prototype.tag="cmap",t.prototype.parse=function(n){var i,o,a;for(n.pos=this.offset,this.version=n.readUInt16(),a=n.readUInt16(),this.tables=[],this.unicode=null,o=0;0<=a?o<a:o>a;o=0<=a?++o:--o)i=new Pg(n,this.offset),this.tables.push(i),i.isUnicode&&this.unicode==null&&(this.unicode=i);return!0},t.encode=function(n,i){var o,a;return i==null&&(i="macroman"),o=Pg.encode(n,i),(a=new Ol).writeUInt16(0),a.writeUInt16(1),o.table=a.data.concat(o.subtable),o},t}(),HC=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Na(t,oa),t.prototype.tag="hhea",t.prototype.parse=function(n){return n.pos=this.offset,this.version=n.readInt(),this.ascender=n.readShort(),this.decender=n.readShort(),this.lineGap=n.readShort(),this.advanceWidthMax=n.readShort(),this.minLeftSideBearing=n.readShort(),this.minRightSideBearing=n.readShort(),this.xMaxExtent=n.readShort(),this.caretSlopeRise=n.readShort(),this.caretSlopeRun=n.readShort(),this.caretOffset=n.readShort(),n.pos+=8,this.metricDataFormat=n.readShort(),this.numberOfMetrics=n.readUInt16()},t}(),WC=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Na(t,oa),t.prototype.tag="OS/2",t.prototype.parse=function(n){if(n.pos=this.offset,this.version=n.readUInt16(),this.averageCharWidth=n.readShort(),this.weightClass=n.readUInt16(),this.widthClass=n.readUInt16(),this.type=n.readShort(),this.ySubscriptXSize=n.readShort(),this.ySubscriptYSize=n.readShort(),this.ySubscriptXOffset=n.readShort(),this.ySubscriptYOffset=n.readShort(),this.ySuperscriptXSize=n.readShort(),this.ySuperscriptYSize=n.readShort(),this.ySuperscriptXOffset=n.readShort(),this.ySuperscriptYOffset=n.readShort(),this.yStrikeoutSize=n.readShort(),this.yStrikeoutPosition=n.readShort(),this.familyClass=n.readShort(),this.panose=function(){var i,o;for(o=[],i=0;i<10;++i)o.push(n.readByte());return o}(),this.charRange=function(){var i,o;for(o=[],i=0;i<4;++i)o.push(n.readInt());return o}(),this.vendorID=n.readString(4),this.selection=n.readShort(),this.firstCharIndex=n.readShort(),this.lastCharIndex=n.readShort(),this.version>0&&(this.ascent=n.readShort(),this.descent=n.readShort(),this.lineGap=n.readShort(),this.winAscent=n.readShort(),this.winDescent=n.readShort(),this.codePageRange=function(){var i,o;for(o=[],i=0;i<2;i=++i)o.push(n.readInt());return o}(),this.version>1))return this.xHeight=n.readShort(),this.capHeight=n.readShort(),this.defaultChar=n.readShort(),this.breakChar=n.readShort(),this.maxContext=n.readShort()},t}(),ZC=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Na(t,oa),t.prototype.tag="post",t.prototype.parse=function(n){var i,o,a;switch(n.pos=this.offset,this.format=n.readInt(),this.italicAngle=n.readInt(),this.underlinePosition=n.readShort(),this.underlineThickness=n.readShort(),this.isFixedPitch=n.readInt(),this.minMemType42=n.readInt(),this.maxMemType42=n.readInt(),this.minMemType1=n.readInt(),this.maxMemType1=n.readInt(),this.format){case 65536:break;case 131072:var u;for(o=n.readUInt16(),this.glyphNameIndex=[],u=0;0<=o?u<o:u>o;u=0<=o?++u:--u)this.glyphNameIndex.push(n.readUInt16());for(this.names=[],a=[];n.pos<this.offset+this.length;)i=n.readByte(),a.push(this.names.push(n.readString(i)));return a;case 151552:return o=n.readUInt16(),this.offsets=n.read(o);case 196608:break;case 262144:return this.map=(function(){var d,f,v;for(v=[],u=d=0,f=this.file.maxp.numGlyphs;0<=f?d<f:d>f;u=0<=f?++d:--d)v.push(n.readUInt32());return v}).call(this)}},t}(),KC=function(e,t){this.raw=e,this.length=e.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},YC=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Na(t,oa),t.prototype.tag="name",t.prototype.parse=function(n){var i,o,a,u,d,f,v,_,x,k,w;for(n.pos=this.offset,n.readShort(),i=n.readShort(),f=n.readShort(),o=[],u=0;0<=i?u<i:u>i;u=0<=i?++u:--u)o.push({platformID:n.readShort(),encodingID:n.readShort(),languageID:n.readShort(),nameID:n.readShort(),length:n.readShort(),offset:this.offset+f+n.readShort()});for(v={},u=x=0,k=o.length;x<k;u=++x)a=o[u],n.pos=a.offset,_=n.readString(a.length),d=new KC(_,a),v[w=a.nameID]==null&&(v[w]=[]),v[a.nameID].push(d);this.strings=v,this.copyright=v[0],this.fontFamily=v[1],this.fontSubfamily=v[2],this.uniqueSubfamily=v[3],this.fontName=v[4],this.version=v[5];try{this.postscriptName=v[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=v[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=v[7],this.manufacturer=v[8],this.designer=v[9],this.description=v[10],this.vendorUrl=v[11],this.designerUrl=v[12],this.license=v[13],this.licenseUrl=v[14],this.preferredFamily=v[15],this.preferredSubfamily=v[17],this.compatibleFull=v[18],this.sampleText=v[19]},t}(),JC=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Na(t,oa),t.prototype.tag="maxp",t.prototype.parse=function(n){return n.pos=this.offset,this.version=n.readInt(),this.numGlyphs=n.readUInt16(),this.maxPoints=n.readUInt16(),this.maxContours=n.readUInt16(),this.maxCompositePoints=n.readUInt16(),this.maxComponentContours=n.readUInt16(),this.maxZones=n.readUInt16(),this.maxTwilightPoints=n.readUInt16(),this.maxStorage=n.readUInt16(),this.maxFunctionDefs=n.readUInt16(),this.maxInstructionDefs=n.readUInt16(),this.maxStackElements=n.readUInt16(),this.maxSizeOfInstructions=n.readUInt16(),this.maxComponentElements=n.readUInt16(),this.maxComponentDepth=n.readUInt16()},t}(),XC=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Na(t,oa),t.prototype.tag="hmtx",t.prototype.parse=function(n){var i,o,a,u,d,f,v;for(n.pos=this.offset,this.metrics=[],i=0,f=this.file.hhea.numberOfMetrics;0<=f?i<f:i>f;i=0<=f?++i:--i)this.metrics.push({advance:n.readUInt16(),lsb:n.readInt16()});for(a=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var _,x;for(x=[],i=_=0;0<=a?_<a:_>a;i=0<=a?++_:--_)x.push(n.readInt16());return x}(),this.widths=(function(){var _,x,k,w;for(w=[],_=0,x=(k=this.metrics).length;_<x;_++)u=k[_],w.push(u.advance);return w}).call(this),o=this.widths[this.widths.length-1],v=[],i=d=0;0<=a?d<a:d>a;i=0<=a?++d:--d)v.push(this.widths.push(o));return v},t.prototype.forGlyph=function(n){return n in this.metrics?this.metrics[n]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[n-this.metrics.length]}},t}(),uv=[].slice,QC=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Na(t,oa),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(n){var i,o,a,u,d,f,v,_,x,k;return n in this.cache?this.cache[n]:(u=this.file.loca,i=this.file.contents,o=u.indexOf(n),(a=u.lengthOf(n))===0?this.cache[n]=null:(i.pos=this.offset+o,d=(f=new Ol(i.read(a))).readShort(),_=f.readShort(),k=f.readShort(),v=f.readShort(),x=f.readShort(),this.cache[n]=d===-1?new tP(f,_,k,v,x):new eP(f,d,_,k,v,x),this.cache[n]))},t.prototype.encode=function(n,i,o){var a,u,d,f,v;for(d=[],u=[],f=0,v=i.length;f<v;f++)a=n[i[f]],u.push(d.length),a&&(d=d.concat(a.encode(o)));return u.push(d.length),{table:d,offsets:u}},t}(),eP=function(){function e(t,n,i,o,a,u){this.raw=t,this.numberOfContours=n,this.xMin=i,this.yMin=o,this.xMax=a,this.yMax=u,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),tP=function(){function e(t,n,i,o,a){var u,d;for(this.raw=t,this.xMin=n,this.yMin=i,this.xMax=o,this.yMax=a,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],u=this.raw;d=u.readShort(),this.glyphOffsets.push(u.pos),this.glyphIDs.push(u.readUInt16()),32&d;)u.pos+=1&d?4:2,128&d?u.pos+=8:64&d?u.pos+=4:8&d&&(u.pos+=2)}return e.prototype.encode=function(){var t,n,i;for(n=new Ol(uv.call(this.raw.data)),t=0,i=this.glyphIDs.length;t<i;++t)n.pos=this.glyphOffsets[t];return n.data},e}(),nP=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Na(t,oa),t.prototype.tag="loca",t.prototype.parse=function(n){var i,o;return n.pos=this.offset,i=this.file.head.indexToLocFormat,this.offsets=i===0?(function(){var a,u;for(u=[],o=0,a=this.length;o<a;o+=2)u.push(2*n.readUInt16());return u}).call(this):(function(){var a,u;for(u=[],o=0,a=this.length;o<a;o+=4)u.push(n.readUInt32());return u}).call(this)},t.prototype.indexOf=function(n){return this.offsets[n]},t.prototype.lengthOf=function(n){return this.offsets[n+1]-this.offsets[n]},t.prototype.encode=function(n,i){for(var o=new Uint32Array(this.offsets.length),a=0,u=0,d=0;d<o.length;++d)if(o[d]=a,u<i.length&&i[u]==d){++u,o[d]=a;var f=this.offsets[d],v=this.offsets[d+1]-f;v>0&&(a+=v)}for(var _=new Array(4*o.length),x=0;x<o.length;++x)_[4*x+3]=255&o[x],_[4*x+2]=(65280&o[x])>>8,_[4*x+1]=(16711680&o[x])>>16,_[4*x]=(4278190080&o[x])>>24;return _},t}(),iP=function(){function e(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var t,n,i,o,a;for(n in o=this.font.cmap.tables[0].codeMap,t={},a=this.subset)i=a[n],t[n]=o[i];return t},e.prototype.glyphsFor=function(t){var n,i,o,a,u,d,f;for(o={},u=0,d=t.length;u<d;u++)o[a=t[u]]=this.font.glyf.glyphFor(a);for(a in n=[],o)(i=o[a])!=null&&i.compound&&n.push.apply(n,i.glyphIDs);if(n.length>0)for(a in f=this.glyphsFor(n))i=f[a],o[a]=i;return o},e.prototype.encode=function(t,n){var i,o,a,u,d,f,v,_,x,k,w,N,z,W,O;for(o in i=lv.encode(this.generateCmap(),"unicode"),u=this.glyphsFor(t),w={0:0},O=i.charMap)w[(f=O[o]).old]=f.new;for(N in k=i.maxGlyphID,u)N in w||(w[N]=k++);return _=function(Z){var se,Se;for(se in Se={},Z)Se[Z[se]]=se;return Se}(w),x=Object.keys(_).sort(function(Z,se){return Z-se}),z=function(){var Z,se,Se;for(Se=[],Z=0,se=x.length;Z<se;Z++)d=x[Z],Se.push(_[d]);return Se}(),a=this.font.glyf.encode(u,z,w),v=this.font.loca.encode(a.offsets,z),W={cmap:this.font.cmap.raw(),glyf:a.table,loca:v,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(n)},this.font.os2.exists&&(W["OS/2"]=this.font.os2.raw()),this.font.directory.encode(W)},e}();Cn.API.PDFObject=function(){var e;function t(){}return e=function(n,i){return(Array(i+1).join("0")+n).slice(-i)},t.convert=function(n){var i,o,a,u;if(Array.isArray(n))return"["+function(){var d,f,v;for(v=[],d=0,f=n.length;d<f;d++)i=n[d],v.push(t.convert(i));return v}().join(" ")+"]";if(typeof n=="string")return"/"+n;if(n!=null&&n.isString)return"("+n+")";if(n instanceof Date)return"(D:"+e(n.getUTCFullYear(),4)+e(n.getUTCMonth(),2)+e(n.getUTCDate(),2)+e(n.getUTCHours(),2)+e(n.getUTCMinutes(),2)+e(n.getUTCSeconds(),2)+"Z)";if({}.toString.call(n)==="[object Object]"){for(o in a=["<<"],n)u=n[o],a.push("/"+o+" "+t.convert(u));return a.push(">>"),a.join(`
`)}return""+n},t}();const rP={class:"h-full flex"},sP={class:"flex-1 relative"},oP={key:0,class:"absolute inset-0 bg-black/30 backdrop-blur-sm z-[2000] flex items-center justify-center"},aP={key:1,class:"absolute inset-0 flex items-center justify-center bg-gray-50 z-[3000]"},lP={class:"text-center max-w-lg mx-auto p-8"},uP={class:"space-y-4"},cP={class:"map-parent"},hP={key:0,class:"z-[3000]"},dP={class:"map-content flex"},fP={class:"flex-1 relative"},pP={key:0,class:"w-64 bg-white border-l border-gray-200 flex-shrink-0 z-[2000]"},gP={key:1,class:"absolute inset-0 flex items-center justify-center bg-white bg-opacity-75 z-50"},mP={key:2,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[3000]"},vP={class:"bg-white rounded-lg p-6 max-w-2xl w-full mx-4"},yP={class:"flex justify-between items-center mb-4"},_P={key:0,class:"space-y-4"},bP={key:0,class:"space-y-2"},wP={class:"grid grid-cols-1 gap-2 max-h-96 overflow-y-auto"},xP=["onClick"],LP={class:"font-medium text-gray-900"},CP={key:1,class:"space-y-2"},PP={class:"flex items-center mb-4"},kP={class:"text-sm text-gray-600"},SP={class:"grid grid-cols-1 gap-2 max-h-96 overflow-y-auto"},EP=["onClick"],AP={class:"font-medium text-gray-900"},MP={key:2,class:"space-y-2"},BP={class:"flex items-center mb-4"},TP={class:"text-sm text-gray-600"},NP={class:"grid grid-cols-1 gap-2 max-h-96 overflow-y-auto"},DP={key:0,class:"text-center py-8"},RP=["onClick"],OP={class:"font-medium text-gray-900"},IP={key:3,class:"space-y-2"},FP={class:"flex items-center mb-4"},jP={class:"text-sm text-gray-600"},zP={class:"grid grid-cols-1 gap-2 max-h-96 overflow-y-auto"},UP=["onClick"],$P={class:"font-medium text-gray-900"},qP={class:"text-sm text-gray-500"},VP={class:"text-xs text-gray-400 mt-1"},GP={key:1,class:"space-y-4"},HP={key:0,class:"space-y-2"},WP={class:"grid grid-cols-1 gap-2 max-h-96 overflow-y-auto"},ZP={key:0,class:"text-center py-8"},KP=["onClick"],YP={class:"font-medium text-gray-900"},JP={key:1,class:"space-y-2"},XP={class:"flex items-center mb-4"},QP={class:"text-sm text-gray-600"},ek={class:"grid grid-cols-1 gap-2 max-h-96 overflow-y-auto"},tk=["onClick"],nk={class:"font-medium text-gray-900"},ik={class:"text-sm text-gray-500"},rk={class:"text-xs text-gray-400 mt-1"},sk={key:2,class:"space-y-4"},ok={key:0,class:"space-y-2"},ak={class:"grid grid-cols-1 gap-2 max-h-96 overflow-y-auto"},lk=["onClick"],uk={class:"font-medium text-gray-900"},ck={key:1,class:"space-y-2"},hk={class:"flex items-center mb-4"},dk={class:"text-sm text-gray-600"},fk={class:"grid grid-cols-1 gap-2 max-h-96 overflow-y-auto"},pk={key:0,class:"text-center py-8"},gk=["onClick"],mk={class:"font-medium text-gray-900"},vk={key:2,class:"space-y-2"},yk={class:"flex items-center mb-4"},_k={class:"text-sm text-gray-600"},bk={class:"grid grid-cols-1 gap-2 max-h-96 overflow-y-auto"},wk=["onClick"],xk={class:"font-medium text-gray-900"},Lk={class:"text-sm text-gray-500"},Ck={class:"text-xs text-gray-400 mt-1"},Pk={key:3,class:"max-h-96 overflow-y-auto"},kk={key:0,class:"text-center py-8"},Sk={key:1,class:"space-y-2"},Ek=["onClick"],Ak={class:"font-medium text-gray-900"},Mk={class:"text-sm text-gray-500"},Bk={class:"text-xs text-gray-400 mt-1"},kg=Hs({__name:"MapView",setup(e){const t=Dt(null),n=cp(),i=U1(),o=Dt([]),{currentTool:a,selectedShape:u,map:d,initMap:f,setDrawingTool:v,updateShapeStyle:_,updateShapeProperties:x,featureGroup:k,adjustView:w,clearActiveControlPoints:N}=DL(),{initMap:z,changeBaseMap:W}=RL(),O=Dt(!1),Z=Dt(!1),se=Dt(null),Se=Dt(!1),Ne=Dt(null),$e=ds(),Pe=Dt([]),xe=Dt([]),Be=Dt([]),ze=Dt(null),te=Dt(null),J=Dt(!1),Ee=Dt(!1),he=Dt(!1),P=Dt(null),F=jn(()=>{var ft,Fe;return console.log("[MapView][filteredClients] Computing with:",{userType:(ft=$e.user)==null?void 0:ft.user_type,selectedConcessionnaire:ze.value,concessionnaireAgriculteurs:xe.value,agriculteurCount:((Fe=xe.value)==null?void 0:Fe.length)||0}),$e.isConcessionnaire||ze.value?xe.value:[]}),G=jn(()=>{var ft;return u.value?{type:((ft=u.value.properties)==null?void 0:ft.type)||"unknown",properties:u.value.properties||{},layer:u.value}:null});function Q(ft){const Fe=ft.getCenter(),kt=ft.getZoom(),Et={lat:Fe.lat,lng:Fe.lng,zoom:kt};document.cookie=`mapState=${JSON.stringify(Et)};max-age=2592000;path=/`}function Ae(){const Fe=document.cookie.split(";").find(kt=>kt.trim().startsWith("mapState="));if(Fe)try{return JSON.parse(Fe.split("=")[1])}catch(kt){return console.error("Erreur lors de la lecture du cookie de position:",kt),null}return null}Ta(async()=>{var ft,Fe;try{if(await n.fetchPlans(),($e.isAdmin||$e.isUsine)&&await nt(),$e.isUsine){J.value=!0;try{const ot=await fn.get("/users/",{params:{role:"CONCESSIONNAIRE",usine:(ft=$e.user)==null?void 0:ft.id}});Pe.value=ot.data}catch(ot){console.error("Error loading concessionnaires:",ot),Pe.value=[]}finally{J.value=!1}}if($e.isConcessionnaire){Ee.value=!0;try{const ot=await $e.fetchConcessionnaireAgriculteurs(((Fe=$e.user)==null?void 0:Fe.id)||0);xe.value=Array.isArray(ot)?ot:[ot]}catch(ot){console.error("Error loading clients:",ot)}finally{Ee.value=!1}}const kt=Ae(),Et=kt?[kt.lat,kt.lng]:[46.603354,1.888334],At=(kt==null?void 0:kt.zoom)??6;if(t.value&&!d.value){const ot=f(t.value,Et,At);ot.pm.setLang("fr"),ot.pm.addControls({rotateMode:!1}),z(ot),ot.on("moveend",()=>{Q(ot)}),window.addEventListener("map-set-location",wn=>{if(ot&&wn.detail){const{lat:Zt,lng:rn,zoom:Gn}=wn.detail;ot.flyTo([Zt,rn],Gn,{duration:1.5,easeLinearity:.25})}})}const et=localStorage.getItem("lastPlanId");if(et)try{console.log("[MapView][onMounted] Tentative de chargement du dernier plan:",et),await T(parseInt(et))}catch(ot){console.error("[MapView][onMounted] Erreur chargement dernier plan:",ot),se.value=null,n.clearCurrentPlan(),i.clearCurrentPlan(),oe(),localStorage.removeItem("lastPlanId")}else console.log("[MapView][onMounted] Aucun dernier plan  charger"),se.value=null,n.clearCurrentPlan(),i.clearCurrentPlan(),oe();window.addEventListener("shape:created",ot=>{const{shape:wn,type:Zt,properties:rn}=ot.detail;console.log("[MapView] Nouvelle forme cre",{shape:wn,type:Zt,properties:rn}),i.addElement(wn)})}catch(kt){console.error("Error during component mount:",kt),se.value=null,n.clearCurrentPlan(),i.clearCurrentPlan(),oe(),localStorage.removeItem("lastPlanId")}}),Qi(()=>i.hasUnsavedChanges,ft=>{console.log("[MapView][watch drawingStore.hasUnsavedChanges]",ft),ft&&se.value&&n.markUnsavedChanges()}),Qi(d,async ft=>{console.log(`
[MapView][watch map] Nouvelle carte:`,!!ft),ft&&n.currentPlan&&(console.log("[MapView][watch map] Plan courant trouv:",n.currentPlan.id),oe(),await i.loadPlanElements(n.currentPlan.id),await T(n.currentPlan.id))}),Qi(()=>n.currentPlan,async ft=>{var Fe,kt,Et;console.log(`
[MapView][watch currentPlan] ====== CHANGEMENT DE PLAN ======`),console.log("[MapView][watch currentPlan] Nouveau plan:",ft==null?void 0:ft.id);try{if(ft){console.log("[MapView][watch currentPlan] Mise  jour du plan courant..."),se.value=ft,n.setCurrentPlan(ft),i.setCurrentPlan(ft.id);const At=document.querySelector(".map-parent");At instanceof HTMLElement&&(At.style.display="block"),console.log("[MapView][watch currentPlan] Plan mis  jour avec succs")}else{console.log("[MapView][watch currentPlan] Nettoyage du plan courant..."),se.value=null,oe(),n.clearCurrentPlan(),i.clearCurrentPlan();const At=document.querySelector(".map-parent");At instanceof HTMLElement&&(At.style.display="none")}}catch(At){console.error("[MapView][watch currentPlan] ERREUR:",At),se.value=null,oe(),n.clearCurrentPlan(),i.clearCurrentPlan()}console.log("[MapView][watch currentPlan] tat final:",{currentPlanId:(Fe=se.value)==null?void 0:Fe.id,storePlanId:(kt=n.currentPlan)==null?void 0:kt.id,mapVisible:d.value!==null,mapParentDisplay:(Et=document.querySelector(".map-parent"))==null?void 0:Et.getAttribute("style")}),console.log(`[MapView][watch currentPlan] ====== FIN CHANGEMENT ======
`)},{immediate:!0}),Yh(()=>{d.value&&d.value.off("moveend"),window.removeEventListener("shape:created",()=>{})});function oe(){k.value&&k.value.clearLayers(),o.value=[],N(),u.value=null,a.value=""}async function me(ft){try{oe(),await i.loadPlanElements(ft);const Fe=n.getPlanById(ft);Fe?(se.value=Fe,n.setCurrentPlan(Fe),i.setCurrentPlan(Fe.id),localStorage.setItem("lastPlanId",Fe.id.toString()),d.value&&k.value&&(i.getCurrentElements.forEach(kt=>{var ot,wn,Zt,rn,Gn,Tn,Kn,Hn,Ui,Oi,zn,Ut,An,bi,Yn,wi,pi,sn,gn,Yt,gi,Rn;if(!k.value||!kt.data)return;let Et=null;const{style:At={},...et}=kt.data;switch(kt.type_forme){case"TEXTE":{const _t=kt.data;if(console.log("[refreshMapWithPlan] Cration TextRectangle",{bounds:_t.bounds,content:_t.content,style:_t.style}),!_t.bounds){console.error("Bounds manquants pour TextRectangle");return}const Xn=Zi.latLngBounds(Zi.latLng(_t.bounds.southWest[1],_t.bounds.southWest[0]),Zi.latLng(_t.bounds.northEast[1],_t.bounds.northEast[0]));Et=new Bo(Xn,_t.content||"Double-cliquez pour diter",{color:((ot=_t.style)==null?void 0:ot.color)||"#3388ff",weight:((wn=_t.style)==null?void 0:wn.weight)||3,opacity:((Zt=_t.style)==null?void 0:Zt.opacity)||1,fillColor:((rn=_t.style)==null?void 0:rn.fillColor)||"#3388ff",fillOpacity:((Gn=_t.style)==null?void 0:Gn.fillOpacity)||.2,textStyle:{color:((Kn=(Tn=_t.style)==null?void 0:Tn.textStyle)==null?void 0:Kn.color)||"#000000",fontSize:((Ui=(Hn=_t.style)==null?void 0:Hn.textStyle)==null?void 0:Ui.fontSize)||"14px",fontFamily:((zn=(Oi=_t.style)==null?void 0:Oi.textStyle)==null?void 0:zn.fontFamily)||"Arial, sans-serif",textAlign:((An=(Ut=_t.style)==null?void 0:Ut.textStyle)==null?void 0:An.textAlign)||"center",backgroundColor:((Yn=(bi=_t.style)==null?void 0:bi.textStyle)==null?void 0:Yn.backgroundColor)||"#FFFFFF",backgroundOpacity:((pi=(wi=_t.style)==null?void 0:wi.textStyle)==null?void 0:pi.backgroundOpacity)??1,bold:((gn=(sn=_t.style)==null?void 0:sn.textStyle)==null?void 0:gn.bold)||!1,italic:((gi=(Yt=_t.style)==null?void 0:Yt.textStyle)==null?void 0:gi.italic)||!1}}),_t.rotation&&typeof Et.setRotation=="function"&&Et.setRotation(_t.rotation),Et.properties={type:"TextRectangle",text:_t.content||"Double-cliquez pour diter",style:_t.style,rotation:_t.rotation||0};break}case"POLYGON":{const _t=kt.data;if(_t.points&&_t.points.length>0){const Xn=_t.points.map(Ii=>Zi.latLng(Ii[1],Ii[0]));Et=new Bu([Xn],{..._t.style,pmIgnore:!1}),Et.updateProperties(),console.log("[refreshMapWithPlan] Polygon restaur",{points:Xn.length,style:_t.style,properties:Et.properties})}break}case"CERCLE":{const _t=et;_t.center&&_t.radius&&(Et=Zi.circle([_t.center[1],_t.center[0]],{...At,radius:_t.radius}));break}case"RECTANGLE":{const _t=et;_t.bounds&&(Et=Zi.rectangle([[_t.bounds.southWest[1],_t.bounds.southWest[0]],[_t.bounds.northEast[1],_t.bounds.northEast[0]]],At));break}case"DEMI_CERCLE":{const _t=et;if(_t.center&&_t.radius){Et=new nl(Zi.latLng(_t.center[1],_t.center[0]),_t.radius,_t.startAngle,_t.endAngle,At),Et.properties={type:"Semicircle",radius:_t.radius,startAngle:_t.startAngle,stopAngle:_t.endAngle,style:At};const Xn=Math.PI*Math.pow(_t.radius,2)*((_t.endAngle-_t.startAngle)/360),Ii=2*_t.radius+Math.PI*_t.radius*((_t.endAngle-_t.startAngle)/180),ui=Math.PI*_t.radius*((_t.endAngle-_t.startAngle)/180);Et.properties.area=Xn,Et.properties.perimeter=Ii,Et.properties.arcLength=ui,Et.properties.openingAngle=_t.endAngle-_t.startAngle,console.log("[loadPlan] Demi-cercle restaur avec proprits:",Et.properties)}break}case"LIGNE":{const _t=et;if(_t.points){const Xn=_t.points.map(ui=>Zi.latLng(ui[1],ui[0]));Et=Zi.polyline(Xn,At),Et.properties={type:"Line",style:At};let Ii=0;for(let ui=1;ui<Xn.length;ui++)Ii+=Xn[ui].distanceTo(Xn[ui-1]);if(Et.properties.length=Ii,_t.hasOwnProperty("dimensions")&&_t.dimensions&&(Et.properties.dimensions=_t.dimensions,_t.dimensions.width&&Ii)){const ui=Ii*_t.dimensions.width;Et.properties.surfaceInfluence=ui}console.log("[loadPlan] Ligne restaure avec proprits:",Et.properties)}break}}Et&&(Et._dbId=kt.id,(Rn=k.value)==null||Rn.addLayer(Et),o.value.push({id:kt.id,type:kt.type_forme,layer:Et,properties:Et.properties}))}),w()),console.log(`Plan ${ft} charg avec succs avec ${i.getCurrentElements.length} formes`)):console.error(`Plan ${ft} introuvable aprs chargement`),Z.value=!1}catch(Fe){throw console.error("Erreur lors du rafrachissement de la carte:",Fe),Fe}}async function T(ft){var Fe;console.log(`
[MapView][loadPlan] ====== DBUT CHARGEMENT PLAN ======`),console.log("[MapView][loadPlan] Tentative de chargement du plan:",ft);try{const kt=n.getPlanById(ft);if(console.log("[MapView][loadPlan] Plan trouv dans le store:",!!kt),!kt){console.log("[MapView][loadPlan] Plan non trouv dans le store, vrification API...");try{await fn.get(`/plans/${ft}/`)}catch(Et){throw((Fe=Et.response)==null?void 0:Fe.status)===404&&(console.warn("[MapView][loadPlan] Plan non trouv - Nettoyage du localStorage"),localStorage.removeItem("lastPlanId"),se.value=null,n.clearCurrentPlan(),i.clearCurrentPlan(),oe()),Et}}console.log("[MapView][loadPlan] Rafrachissement de la carte..."),await me(ft),Z.value=!1,console.log("[MapView][loadPlan] Invalidation de la taille de la carte..."),ye(),console.log("[MapView][loadPlan] Plan charg avec succs:",{planId:ft,elementsCount:i.getCurrentElements.length})}catch(kt){throw console.error("Erreur lors du chargement du plan:",kt),se.value=null,n.clearCurrentPlan(),i.clearCurrentPlan(),oe(),localStorage.removeItem("lastPlanId"),kt}}async function ne(){var ft;if(!se.value||!k.value){console.warn("Aucun plan actif ou groupe de formes  sauvegarder");return}Se.value=!0,Ne.value="saving";try{const Fe=[],kt=new Set(i.getCurrentElements.filter(ot=>ot.id!==void 0).map(ot=>ot.id)),Et=new Set;console.log("[savePlan] Dbut de la sauvegarde",{featureGroupLayers:k.value.getLayers().length,existingIds:Array.from(kt),currentElements:i.getCurrentElements}),k.value.eachLayer(ot=>{var wn,Zt,rn,Gn,Tn,Kn,Hn,Ui,Oi,zn,Ut,An,bi,Yn,wi,pi,sn,gn,Yt,gi,Rn,_t,Xn,Ii,ui,yr,lr,_r,Ki,ur,jr,Es,Zs,Ks,Gr,fs,As,aa,la,Ys,Io,ua,Ms,Bs,go,Fo,cr,On,yn,ps,Hr,zr,Ts,xn,qn;if(console.log("[savePlan] Traitement de la couche",{type:(wn=ot.properties)==null?void 0:wn.type,isPolygon:ot instanceof Zi.Polygon,isCircleArc:ot instanceof nl,properties:ot.properties}),ot instanceof Bo){const ki=ot.getBounds(),Vn=((Zt=ot.properties)==null?void 0:Zt.text)||"",Qn={style:{color:((rn=ot.options)==null?void 0:rn.color)||"#3388ff",fillColor:((Gn=ot.options)==null?void 0:Gn.fillColor)||"#3388ff",fillOpacity:((Tn=ot.options)==null?void 0:Tn.fillOpacity)||.2,weight:((Kn=ot.options)==null?void 0:Kn.weight)||3,opacity:((Hn=ot.options)==null?void 0:Hn.opacity)||1,textStyle:{color:((zn=(Oi=(Ui=ot.properties)==null?void 0:Ui.style)==null?void 0:Oi.textStyle)==null?void 0:zn.color)||"#000000",fontSize:((bi=(An=(Ut=ot.properties)==null?void 0:Ut.style)==null?void 0:An.textStyle)==null?void 0:bi.fontSize)||"14px",fontFamily:((pi=(wi=(Yn=ot.properties)==null?void 0:Yn.style)==null?void 0:wi.textStyle)==null?void 0:pi.fontFamily)||"Arial, sans-serif",textAlign:((Yt=(gn=(sn=ot.properties)==null?void 0:sn.style)==null?void 0:gn.textStyle)==null?void 0:Yt.textAlign)||"center",backgroundColor:((_t=(Rn=(gi=ot.properties)==null?void 0:gi.style)==null?void 0:Rn.textStyle)==null?void 0:_t.backgroundColor)||"#FFFFFF",backgroundOpacity:((ui=(Ii=(Xn=ot.properties)==null?void 0:Xn.style)==null?void 0:Ii.textStyle)==null?void 0:ui.backgroundOpacity)??1,bold:((_r=(lr=(yr=ot.properties)==null?void 0:yr.style)==null?void 0:lr.textStyle)==null?void 0:_r.bold)||!1,italic:((jr=(ur=(Ki=ot.properties)==null?void 0:Ki.style)==null?void 0:ur.textStyle)==null?void 0:jr.italic)||!1}},bounds:{southWest:[ki.getSouthWest().lng,ki.getSouthWest().lat],northEast:[ki.getNorthEast().lng,ki.getNorthEast().lat]},content:Vn};Fe.push({id:ot._dbId,type_forme:"TEXTE",data:Qn}),ot._dbId&&Et.add(ot._dbId);return}else if(ot instanceof nl||((Es=ot.properties)==null?void 0:Es.type)==="Semicircle"){const ki=typeof ot.getCenter=="function"?ot.getCenter():ot.getLatLng(),Vn={center:[ki.lng,ki.lat],radius:ot.getRadius(),startAngle:((Zs=ot.properties)==null?void 0:Zs.startAngle)||0,endAngle:((Ks=ot.properties)==null?void 0:Ks.stopAngle)||180,style:{color:((Gr=ot.options)==null?void 0:Gr.color)||"#3388ff",fillColor:((fs=ot.options)==null?void 0:fs.fillColor)||"#3388ff",fillOpacity:((As=ot.options)==null?void 0:As.fillOpacity)||.2,weight:((aa=ot.options)==null?void 0:aa.weight)||3,opacity:((la=ot.options)==null?void 0:la.opacity)||1}};Fe.push({id:ot._dbId,type_forme:"DEMI_CERCLE",data:Vn}),ot._dbId&&Et.add(ot._dbId),console.log("[savePlan] Demi-cercle ajout aux lments",{id:ot._dbId,center:Vn.center,radius:Vn.radius,angles:[Vn.startAngle,Vn.endAngle],style:Vn.style})}else if(ot instanceof Zi.Polygon&&!(ot instanceof Zi.Rectangle)){const Qn={points:ot.getLatLngs()[0].map(ci=>[ci.lng,ci.lat]),style:{color:((Ys=ot.options)==null?void 0:Ys.color)||"#3388ff",fillColor:((Io=ot.options)==null?void 0:Io.fillColor)||"#3388ff",fillOpacity:((ua=ot.options)==null?void 0:ua.fillOpacity)||.2,weight:((Ms=ot.options)==null?void 0:Ms.weight)||3,opacity:((Bs=ot.options)==null?void 0:Bs.opacity)||1}};Fe.push({id:ot._dbId,type_forme:"POLYGON",data:Qn}),ot._dbId&&Et.add(ot._dbId),console.log("[savePlan] Polygone ajout aux lments",{id:ot._dbId,points:Qn.points.length,style:Qn.style})}else{const ki={style:{color:((go=ot.options)==null?void 0:go.color)||"#3388ff",fillColor:((Fo=ot.options)==null?void 0:Fo.fillColor)||"#3388ff",fillOpacity:((cr=ot.options)==null?void 0:cr.fillOpacity)||.2,weight:((On=ot.options)==null?void 0:On.weight)||3,opacity:((yn=ot.options)==null?void 0:yn.opacity)||1}};let Vn,Qn;if(ot instanceof Zi.Circle)Vn="CERCLE",Qn={...ki,center:[ot.getLatLng().lng,ot.getLatLng().lat],radius:ot.getRadius()};else if(ot instanceof Zi.Rectangle){Vn="RECTANGLE";const ci=ot.getBounds();Qn={...ki,bounds:{southWest:[ci.getSouthWest().lng,ci.getSouthWest().lat],northEast:[ci.getNorthEast().lng,ci.getNorthEast().lat]}}}else if(((ps=ot.properties)==null?void 0:ps.type)==="Semicircle"){Vn="DEMI_CERCLE";let ci;typeof ot.getLatLng=="function"?ci=ot.getLatLng():ot.getCenter&&typeof ot.getCenter=="function"?ci=ot.getCenter():ot._latlng?ci=ot._latlng:ci={lat:0,lng:0};const gs=ot.getRadius?ot.getRadius():0,Wr=((zr=(Hr=ot.properties)==null?void 0:Hr.style)==null?void 0:zr.startAngle)||0,_i=((xn=(Ts=ot.properties)==null?void 0:Ts.style)==null?void 0:xn.stopAngle)||180;Qn={...ki,center:[ci.lng,ci.lat],radius:gs,startAngle:Wr,endAngle:_i}}else if(ot instanceof Zi.Polyline&&!(ot instanceof Zi.Polygon)){Vn="LIGNE";const ci=ot.getLatLngs();Qn={...ki,points:ci.map(gs=>[gs.lng,gs.lat])}}if(Vn&&Qn){let ci=ot._elementId;ot._dbId&&(ci=ot._dbId,typeof ci=="number"&&Et.add(ci)),Fe.push({id:ci,type_forme:Vn,data:{...Qn,rotation:((qn=ot.properties)==null?void 0:qn.rotation)||0}})}}}),console.log("[savePlan] lments  sauvegarder",{totalElements:Fe.length,elements:Fe.map(ot=>({type:ot.type_forme,hasPoints:"points"in ot.data,hasStyle:"style"in ot.data}))});const At=Array.from(kt).filter(ot=>!Et.has(ot));i.elements=Fe;const et=await i.saveToPlan(se.value.id,{elementsToDelete:At});if(et&&((ft=se.value)!=null&&ft.id)){const ot=se.value.id;se.value={...se.value,...et},n.updatePlanDetails(ot,et)}Ne.value="success",setTimeout(()=>{Ne.value=null},3e3)}catch(Fe){console.error("Erreur lors de la sauvegarde du plan:",Fe),Ne.value=null}finally{Se.value=!1}}Jh(()=>{$e.user||$(),n.clearCurrentPlan(),i.clearCurrentPlan()});function ae(ft){x(ft)}function q(ft){try{const Fe=new Date(ft);return isNaN(Fe.getTime())?(console.error("Date invalide reue:",ft),"Date invalide"):new Intl.DateTimeFormat("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",timeZone:"Europe/Paris"}).format(Fe)}catch(Fe){return console.error("Erreur lors du formatage de la date:",Fe),"Date invalide"}}const R=()=>{k.value&&w()},U=()=>{u.value&&k.value&&(v(""),k.value.removeLayer(u.value),u.value=null)};async function H(ft){console.log(`onPlanCreated - Tentative de chargement du plan ${ft}`),await n.fetchPlans();const Fe=n.getPlanById(ft);Fe?(console.log(`Plan ${ft} trouv, chargement en cours...`),localStorage.setItem("lastPlanId",ft.toString()),se.value=Fe,n.setCurrentPlan(Fe),i.setCurrentPlan(Fe.id),O.value=!1,ye(),console.log(`Plan ${ft} charg avec succs`)):console.error(`Plan ${ft} introuvable aprs cration! Vrifiez les permissions.`)}Qi(ze,async ft=>{var Fe;if(ft&&((Fe=$e.user)==null?void 0:Fe.user_type)==="admin"){Ee.value=!0;try{const kt=await $e.fetchConcessionnaireAgriculteurs(ft.id);xe.value=Array.isArray(kt)?kt:[kt]}catch(kt){console.error("[MapView][watch selectedConcessionnaire] Error:",kt),xe.value=[]}finally{Ee.value=!1}}});function $(){localStorage.removeItem("lastPlanId")}function ce(ft,Fe="m"){return Fe==="m"?`${(ft/1e4).toFixed(2)} ha`:Fe==="m"?ft>=1e3?`${(ft/1e3).toFixed(2)} km`:`${ft.toFixed(2)} m`:`${ft.toFixed(2)} ${Fe}`}const ue=Dt(!1);function V(ft){return{Circle:"Cercle",Rectangle:"Rectangle",Semicircle:"Demi-cercle",Line:"Ligne",Polygon:"Polygone",TextRectangle:"Rectangle avec texte"}[ft]||ft}async function K(){var ft,Fe,kt;if(!(!se.value||!d.value||!k.value))try{console.log("Sauvegarde automatique avant gnration de la synthse..."),await ne(),await new Promise(Kn=>setTimeout(Kn,1e3)),ue.value=!0;const Et=se.value.concessionnaire_details,At=se.value.client_details;u.value&&(N(),u.value=null);const et=new Cn("l","mm","a4"),ot=et.internal.pageSize.getWidth(),wn=et.internal.pageSize.getHeight(),Zt=new Image;Zt.src=K0,await new Promise(Kn=>{Zt.onload=()=>Kn(),Zt.onerror=()=>Kn()}),et.addImage(Zt,"JPEG",(ot-60)/2,20,60,60),et.setFontSize(24),et.setTextColor(0),et.text(se.value.nom||"Sans titre",ot/2,100,{align:"center"});let rn=120;if(et.setFontSize(14),Et&&(et.setFont("helvetica","bold"),et.text("Concessionnaire:",20,rn),et.setFont("helvetica","normal"),et.text(`${Et.first_name} ${Et.last_name}${Et.company_name?` (${Et.company_name})`:""}`,20,rn+8),rn+=25),At&&(et.setFont("helvetica","bold"),et.text("Client:",20,rn),et.setFont("helvetica","normal"),et.text(`${At.first_name} ${At.last_name}${At.company_name?` (${At.company_name})`:""}`,20,rn+8),rn+=25),se.value.description){et.setFont("helvetica","bold"),et.text("Description:",20,rn),et.setFont("helvetica","normal");const Kn=et.splitTextToSize(se.value.description,150);et.text(Kn,20,rn+8),rn+=10*Kn.length+15}et.setFontSize(10),et.setTextColor(100),et.text(`Date de cration: ${q(se.value.date_creation)}`,20,wn-20),et.text(`Dernire modification: ${q(se.value.date_modification)}`,ot-20,wn-20,{align:"right"});const Gn=[];k.value.eachLayer(Kn=>Gn.push(Kn));const Tn=Zi.simpleMapScreenshoter({hideElementsWithSelectors:[".leaflet-control-container",".leaflet-pm-toolbar",".leaflet-grid-layer",".leaflet-grid-label"],preventDownload:!0}).addTo(d.value);await new Promise(Kn=>setTimeout(Kn,3e3));for(let Kn=0;Kn<Gn.length;Kn++){et.addPage();const Hn=30;et.addImage(Zt,"JPEG",ot-Hn-10,10,Hn,30),et.setFontSize(8),et.setTextColor(100);let Oi=25;Et&&(et.text(`Concessionnaire: ${Et.first_name} ${Et.last_name}${Et.company_name?` (${Et.company_name})`:""}`,20,Oi),Oi+=10),At&&et.text(`Client: ${At.first_name} ${At.last_name}${At.company_name?` (${At.company_name})`:""}`,20,Oi),et.setDrawColor(200,200,200),et.setLineWidth(.5),et.line(20,45,ot-20,45);const zn=Gn[Kn],Ut=zn.properties;Ut&&(et.setTextColor(0),et.setFontSize(16),et.setFont("helvetica","bold"),et.text(V(Ut.type),20,60));const An=((ft=zn.getBounds)==null?void 0:ft.call(zn))||((Fe=zn.getLatLng)==null?void 0:Fe.call(zn));An&&d.value.fitBounds(An instanceof Zi.LatLng?Zi.latLngBounds([An]):An,{padding:[50,50]}),await new Promise(bi=>setTimeout(bi,2e3)),d.value.invalidateSize(),await new Promise(bi=>{const Yn=()=>{var gn;const wi=(gn=d.value)==null?void 0:gn.getContainer();if(!wi){bi();return}const pi=wi.querySelectorAll(".leaflet-tile-loaded");wi.querySelectorAll(".leaflet-tile-loading").length===0&&pi.length>0?bi():setTimeout(Yn,100)};Yn()});try{const bi=await Tn.takeScreen("image"),Yn=await new Promise((gn,Yt)=>{const gi=new Image;gi.onload=()=>gn(gi),gi.onerror=Rn=>Yt(Rn),gi.src=bi}),wi=ot*.6-30;let pi=Yn.height*wi/Yn.width;pi>wn*.9&&(pi=wn*.9);const sn=Math.max(80,(wn-pi)/2);if(et.addImage(Yn,"PNG",20,sn,wi,pi),Ut){const gn=ot*.6+10;let Yt=70;et.setFontSize(12),et.setFont("helvetica","normal"),Ut.type==="Circle"?(et.text(`Rayon: ${ce(Ut.radius)}`,gn,Yt),Yt+=10,et.text(`Diamtre: ${ce(Ut.radius*2)}`,gn,Yt),Yt+=10,et.text(`Surface: ${ce(Ut.area,"m")}`,gn,Yt),Yt+=10,et.text(`Primtre: ${ce(Ut.perimeter)}`,gn,Yt),Yt+=10,Ut.surfaceInterieure&&(et.text(`Surface intrieure: ${ce(Ut.surfaceInterieure,"m")}`,gn,Yt),Yt+=10),Ut.surfaceExterieure&&(et.text(`Surface extrieure: ${ce(Ut.surfaceExterieure,"m")}`,gn,Yt),Yt+=10)):Ut.type==="Rectangle"?(et.text(`Largeur: ${ce(Ut.width)}`,gn,Yt),Yt+=10,et.text(`Hauteur: ${ce(Ut.height)}`,gn,Yt),Yt+=10,et.text(`Surface: ${ce(Ut.area,"m")}`,gn,Yt),Yt+=10,et.text(`Primtre: ${ce(Ut.perimeter)}`,gn,Yt),Yt+=10,Ut.surfaceInterieure&&(et.text(`Surface intrieure: ${ce(Ut.surfaceInterieure,"m")}`,gn,Yt),Yt+=10),Ut.surfaceExterieure&&(et.text(`Surface extrieure: ${ce(Ut.surfaceExterieure,"m")}`,gn,Yt),Yt+=10)):Ut.type==="Line"?(et.text(`Longueur: ${ce(Ut.length)}`,gn,Yt),Yt+=10,(kt=Ut.dimensions)!=null&&kt.width&&(et.text(`Largeur d'influence: ${ce(Ut.dimensions.width)}`,gn,Yt),Yt+=10),Ut.surfaceInfluence&&(et.text(`Surface d'influence: ${ce(Ut.surfaceInfluence,"m")}`,gn,Yt),Yt+=10)):Ut.type==="Polygon"?(et.text(`Surface: ${ce(Ut.area,"m")}`,gn,Yt),Yt+=10,et.text(`Primtre: ${ce(Ut.perimeter)}`,gn,Yt),Yt+=10,Ut.surfaceInterieure&&(et.text(`Surface intrieure: ${ce(Ut.surfaceInterieure,"m")}`,gn,Yt),Yt+=10),Ut.surfaceExterieure&&(et.text(`Surface extrieure: ${ce(Ut.surfaceExterieure,"m")}`,gn,Yt),Yt+=10)):Ut.type==="Semicircle"&&(et.text(`Rayon: ${ce(Ut.radius)}`,gn,Yt),Yt+=10,et.text(`Diamtre: ${ce(Ut.radius*2)}`,gn,Yt),Yt+=10,et.text(`Surface: ${ce(Ut.area,"m")}`,gn,Yt),Yt+=10,et.text(`Primtre: ${ce(Ut.perimeter)}`,gn,Yt),Yt+=10,et.text(`Longueur d'arc: ${ce(Ut.arcLength)}`,gn,Yt),Yt+=10,et.text(`Angle d'ouverture: ${Ut.openingAngle.toFixed(1)}`,gn,Yt),Yt+=10,Ut.surfaceInterieure&&(et.text(`Surface intrieure: ${ce(Ut.surfaceInterieure,"m")}`,gn,Yt),Yt+=10),Ut.surfaceExterieure&&(et.text(`Surface extrieure: ${ce(Ut.surfaceExterieure,"m")}`,gn,Yt),Yt+=10))}}catch(bi){console.error(`[generateSynthesis] Erreur capture forme ${Kn+1}:`,bi)}}d.value.removeControl(Tn),et.save(`synthese_${se.value.nom}.pdf`)}catch(Et){console.error("[generateSynthesis] Erreur:",Et),alert("Une erreur est survenue lors de la gnration de la synthse. Veuillez ressayer.")}finally{ue.value=!1}}function ye(){d.value&&Di(()=>{var ft,Fe;(ft=d.value)==null||ft.invalidateSize(),(Fe=k.value)!=null&&Fe.getLayers().length&&w()})}Qi(se,ft=>{ft&&Di(()=>{ye()})});const ve=Dt(null),ee=Dt(!1),Ge=Dt([]),tt=jn(()=>{if(console.log("[MapView][filteredConcessionnaires] Computing with:",{selectedUsine:ve.value,concessionnaires:Pe.value,concessionnairesLength:Pe.value.length}),!ve.value)return[];const ft=Pe.value.filter(Fe=>{var At,et,ot;const kt=Fe.usine,Et=typeof kt=="object"&&kt!==null?kt.id:kt;return console.log("[MapView][filteredConcessionnaires] Checking concessionnaire:",{concessionnaire:Fe,concessionnaireUsine:kt,concessionnaireUsineId:Et,selectedUsineId:(At=ve.value)==null?void 0:At.id,matches:Et===((et=ve.value)==null?void 0:et.id)}),Et===((ot=ve.value)==null?void 0:ot.id)});return console.log("[MapView][filteredConcessionnaires] Filtered result:",ft),ft});function Ue(ft){if(!ft)return"";const Fe=ft.first_name||"",kt=ft.last_name?ft.last_name.toUpperCase():"",Et=ft.company_name||ft.role||"";return`${Fe} ${kt} (${Et})`}async function nt(){ee.value=!0;try{const ft=await fn.get("/users/",{params:{role:"USINE"}});Ge.value=ft.data}catch(ft){console.error("[MapView] Error loading usines:",ft),Ge.value=[]}finally{ee.value=!1}}async function st(ft){console.log("[MapView][selectUsine] Slection de l'usine:",ft),ve.value=ft,J.value=!0;try{console.log("[MapView][selectUsine] Envoi de la requte avec params:",{role:"CONCESSIONNAIRE",usine:ft.id});const Fe=await fn.get("/users/",{params:{role:"CONCESSIONNAIRE",usine:ft.id}});console.log("[MapView][selectUsine] Rponse reue:",Fe.data),Pe.value=Fe.data,console.log("[MapView][selectUsine] Concessionnaires mis  jour:",Pe.value)}catch(Fe){console.error("[MapView] Error loading concessionnaires for usine:",Fe),Pe.value=[]}finally{J.value=!1}}function Ct(){ve.value=null,ze.value=null,te.value=null,Pe.value=[],xe.value=[],Be.value=[]}function xt(){ze.value=null,te.value=null,xe.value=[],Be.value=[]}function Ot(){te.value=null,Be.value=[]}async function $t(ft){var Fe,kt,Et,At,et,ot;console.log(`
[MapView][selectConcessionnaire] ====== DBUT SLECTION CONCESSIONNAIRE ======`),console.log("Informations du concessionnaire:",{id:ft.id,username:ft.username,company:ft.company_name,role:ft.role}),console.log("Contexte utilisateur:",{userType:(Fe=$e.user)==null?void 0:Fe.user_type,userId:(kt=$e.user)==null?void 0:kt.id,userRole:(Et=$e.user)==null?void 0:Et.role,selectedUsineId:(At=ve.value)==null?void 0:At.id}),ze.value=ft,Ee.value=!0;try{const wn={role:"AGRICULTEUR",concessionnaire:ft.id};$e.isUsine?(console.log("Ajout de l'ID de l'usine connecte:",(et=$e.user)==null?void 0:et.id),wn.usine=(ot=$e.user)==null?void 0:ot.id):ve.value&&(console.log("Ajout de l'ID de l'usine slectionne:",ve.value.id),wn.usine=ve.value.id),console.log("Paramtres de la requte:",wn);const Zt=await fn.get("/users/",{params:wn});console.log("Rponse reue du serveur:",{status:Zt.status,dataLength:Array.isArray(Zt.data)?Zt.data.length:"non-array",data:Zt.data}),Array.isArray(Zt.data)?(xe.value=Zt.data,console.log(`${Zt.data.length} agriculteurs chargs`),Zt.data.forEach((rn,Gn)=>{console.log(`Agriculteur ${Gn+1}:`,{id:rn.id,username:rn.username,company:rn.company_name,concessionnaire:rn.concessionnaire})})):(console.warn("Format de rponse inattendu:",Zt.data),xe.value=[]),xe.value.length===0&&console.warn("Aucun agriculteur trouv pour ce concessionnaire")}catch(wn){if(console.error("ERREUR lors du chargement des agriculteurs:",wn),wn&&typeof wn=="object"&&"response"in wn){const Zt=wn;console.error("Dtails de l'erreur:",{status:Zt.response.status,data:Zt.response.data})}xe.value=[]}finally{Ee.value=!1,console.log(`[MapView][selectConcessionnaire] ====== FIN SLECTION CONCESSIONNAIRE ======
`)}}async function Gt(ft){var Fe;te.value=ft,he.value=!0;try{const kt={agriculteur:ft.id};$e.isUsine?kt.usine=(Fe=$e.user)==null?void 0:Fe.id:ve.value&&(kt.usine=ve.value.id),ze.value&&(kt.concessionnaire=ze.value.id);const Et=await fn.get("/plans/",{params:kt});Be.value=Et.data}catch(kt){console.error("[MapView] Error loading client plans:",kt),Be.value=[]}finally{he.value=!1}}return(ft,Fe)=>{var kt,Et,At;return Ie(),je("div",rP,[A("div",sP,[ue.value?(Ie(),je("div",oP,Fe[8]||(Fe[8]=[gc('<div class="bg-white/90 rounded-2xl p-8 max-w-md shadow-2xl border border-gray-100"><div class="flex flex-col items-center"><div class="relative w-24 h-24 mb-6"><div class="absolute inset-0 border-4 border-primary-200 rounded-full"></div><div class="absolute inset-0 border-4 border-primary-600 border-t-transparent rounded-full animate-spin"></div><div class="absolute inset-2 border-2 border-primary-400/30 rounded-full animate-pulse"></div><div class="absolute inset-0 flex items-center justify-center"><svg class="w-8 h-8 text-primary-600 animate-bounce" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg></div></div><h3 class="text-xl font-semibold text-gray-900 mb-2"> Gnration de la synthse </h3><div class="space-y-2 text-center"><p class="text-primary-600 font-medium"> Capture des formes en cours... </p><p class="text-sm text-gray-500"> Nous optimisons la qualit de vos captures pour un rendu parfait </p></div></div></div>',1)]))):Wt("",!0),se.value?Wt("",!0):(Ie(),je("div",aP,[A("div",lP,[Fe[11]||(Fe[11]=gc('<div class="relative w-48 h-48 mx-auto mb-12 rounded-full bg-gradient-to-br from-primary-100 to-primary-50 p-8 shadow-lg ring-4 ring-white"><img src="'+K0+'" alt="IrrigationDesign Logo" class="w-full h-full object-contain filter drop-shadow-md"><div class="absolute inset-0 rounded-full bg-gradient-to-t from-transparent to-white/10 pointer-events-none"></div></div><h1 class="text-3xl font-bold text-gray-900 mb-4">Bienvenue sur IrrigationDesign</h1><p class="text-gray-600 mb-8">Pour commencer  dessiner, vous devez d&#39;abord crer un nouveau plan ou charger un plan existant.</p>',3)),A("div",uP,[A("button",{onClick:Fe[0]||(Fe[0]=et=>O.value=!0),class:"w-full flex items-center justify-center px-4 py-3 bg-primary-600 text-white rounded-lg hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 transition-colors duration-200"},Fe[9]||(Fe[9]=[A("svg",{class:"w-6 h-6 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),vi(" Crer un nouveau plan ")])),A("button",{onClick:Fe[1]||(Fe[1]=et=>Z.value=!0),class:"w-full flex items-center justify-center px-4 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 transition-colors duration-200"},Fe[10]||(Fe[10]=[A("svg",{class:"w-6 h-6 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})],-1),vi(" Charger un plan existant ")]))])])])),un(A("div",cP,[se.value&&!ue.value?(Ie(),je("div",hP,[Ci(fL,{"last-save":(kt=se.value)!=null&&kt.date_modification?new Date(se.value.date_modification):void 0,"plan-name":(Et=se.value)==null?void 0:Et.nom,"plan-description":(At=se.value)==null?void 0:At.description,"save-status":Ne.value,onChangeMapType:mn(W),onCreateNewPlan:Fe[2]||(Fe[2]=et=>O.value=!0),onLoadPlan:Fe[3]||(Fe[3]=et=>Z.value=!0),onSavePlan:ne,onAdjustView:R,onGenerateSummary:K},null,8,["last-save","plan-name","plan-description","save-status","onChangeMapType"])])):Wt("",!0),A("div",dP,[A("div",fP,[A("div",{ref_key:"mapContainer",ref:t,class:"absolute inset-0 z-[1000]"},null,512)]),se.value&&!ue.value?(Ie(),je("div",pP,[Ci(Nx,{"current-tool":mn(a),"selected-shape":G.value,onToolChange:mn(v),onStyleUpdate:mn(_),onPropertiesUpdate:ae,onDeleteShape:U},null,8,["current-tool","selected-shape","onToolChange","onStyleUpdate"])])):Wt("",!0)]),ue.value?(Ie(),je("div",gP,Fe[12]||(Fe[12]=[gc('<div class="text-center"><div class="mb-4"><svg class="animate-spin h-10 w-10 mx-auto text-blue-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg></div><p class="text-lg font-medium text-gray-900">Gnration de la synthse en cours...</p><p class="text-sm text-gray-500 mt-2">Veuillez patienter pendant que nous analysons votre plan.</p></div>',1)]))):Wt("",!0)],512),[[dh,se.value]]),Ci($1,{ref_key:"newPlanModalRef",ref:P,modelValue:O.value,"onUpdate:modelValue":Fe[4]||(Fe[4]=et=>O.value=et),onCreated:H,onConcessionnaireSelected:Fe[5]||(Fe[5]=et=>ze.value=et),onClientSelected:Fe[6]||(Fe[6]=et=>te.value=et)},null,8,["modelValue"]),Z.value?(Ie(),je("div",mP,[A("div",vP,[A("div",yP,[Fe[14]||(Fe[14]=A("h2",{class:"text-xl font-semibold text-gray-900"},"Charger un plan existant",-1)),A("button",{onClick:Fe[7]||(Fe[7]=et=>Z.value=!1),class:"text-gray-400 hover:text-gray-500 focus:outline-none"},Fe[13]||(Fe[13]=[A("svg",{class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),mn($e).isAdmin?(Ie(),je("div",_P,[ve.value?ze.value?te.value?(Ie(),je("div",IP,[A("div",FP,[A("button",{onClick:Ot,class:"flex items-center text-sm text-gray-600 hover:text-gray-900"},Fe[29]||(Fe[29]=[A("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),vi(" Retour  la liste des clients ")])),Fe[30]||(Fe[30]=A("span",{class:"mx-2 text-gray-400"},"|",-1)),A("span",jP,Bt(Ue(te.value)),1)]),Fe[32]||(Fe[32]=A("h3",{class:"font-medium text-gray-700"},"Plans disponibles",-1)),A("div",zP,[he.value?(Ie(),je(Qt,{key:0},En(3,et=>A("div",{key:et,class:"animate-pulse"},Fe[31]||(Fe[31]=[A("div",{class:"p-3 bg-white rounded-lg border border-gray-200"},[A("div",{class:"h-5 bg-gray-200 rounded w-3/4 mb-2"}),A("div",{class:"h-4 bg-gray-100 rounded w-2/3 mb-2"}),A("div",{class:"h-3 bg-gray-50 rounded w-1/3"})],-1)]))),64)):(Ie(!0),je(Qt,{key:1},En(Be.value,et=>(Ie(),je("button",{key:et.id,onClick:ot=>T(et.id),class:"w-full px-4 py-3 text-left bg-white hover:bg-gray-50 rounded-lg border border-gray-200 transition-colors duration-200"},[A("div",$P,Bt(et.nom),1),A("div",qP,Bt(et.description),1),A("div",VP," Modifi le "+Bt(q(et.date_modification)),1)],8,UP))),128))])])):(Ie(),je("div",MP,[A("div",BP,[A("button",{onClick:xt,class:"flex items-center text-sm text-gray-600 hover:text-gray-900"},Fe[23]||(Fe[23]=[A("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),vi(" Retour  la liste des concessionnaires ")])),Fe[24]||(Fe[24]=A("span",{class:"mx-2 text-gray-400"},"|",-1)),A("span",TP,Bt(Ue(ze.value)),1)]),Fe[28]||(Fe[28]=A("h3",{class:"font-medium text-gray-700"},"Slectionnez un agriculteur",-1)),A("div",NP,[Ee.value?(Ie(),je(Qt,{key:0},En(3,et=>A("div",{key:et,class:"animate-pulse"},Fe[25]||(Fe[25]=[A("div",{class:"p-3 bg-white rounded-lg border border-gray-200"},[A("div",{class:"h-5 bg-gray-200 rounded w-3/4 mb-2"}),A("div",{class:"h-4 bg-gray-100 rounded w-1/2"})],-1)]))),64)):(Ie(),je(Qt,{key:1},[F.value.length===0?(Ie(),je("div",DP,Fe[26]||(Fe[26]=[A("div",{class:"text-gray-500 mb-2"},"Aucun agriculteur trouv pour ce concessionnaire",-1),A("div",{class:"text-sm text-gray-400"}," Veuillez vrifier que des agriculteurs ont t assigns  ce concessionnaire ",-1)]))):(Ie(!0),je(Qt,{key:1},En(F.value,et=>(Ie(),je("button",{key:et.id,onClick:ot=>Gt(et),class:"flex items-center p-3 text-left bg-white hover:bg-gray-50 rounded-lg border border-gray-200 transition-colors duration-200"},[A("div",null,[A("div",OP,Bt(Ue(et)),1)]),Fe[27]||(Fe[27]=A("svg",{class:"w-5 h-5 ml-auto text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1))],8,RP))),128))],64))])])):(Ie(),je("div",CP,[A("div",PP,[A("button",{onClick:Ct,class:"flex items-center text-sm text-gray-600 hover:text-gray-900"},Fe[18]||(Fe[18]=[A("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),vi(" Retour  la liste des usines ")])),Fe[19]||(Fe[19]=A("span",{class:"mx-2 text-gray-400"},"|",-1)),A("span",kP,Bt(Ue(ve.value)),1)]),Fe[22]||(Fe[22]=A("h3",{class:"font-medium text-gray-700"},"Slectionnez un concessionnaire",-1)),A("div",SP,[J.value?(Ie(),je(Qt,{key:0},En(3,et=>A("div",{key:et,class:"animate-pulse"},Fe[20]||(Fe[20]=[A("div",{class:"p-3 bg-white rounded-lg border border-gray-200"},[A("div",{class:"h-5 bg-gray-200 rounded w-3/4 mb-2"}),A("div",{class:"h-4 bg-gray-100 rounded w-1/2"})],-1)]))),64)):(Ie(!0),je(Qt,{key:1},En(tt.value,et=>(Ie(),je("button",{key:et.id,onClick:ot=>$t(et),class:"flex items-center p-3 text-left bg-white hover:bg-gray-50 rounded-lg border border-gray-200 transition-colors duration-200"},[A("div",null,[A("div",AP,Bt(Ue(et)),1)]),Fe[21]||(Fe[21]=A("svg",{class:"w-5 h-5 ml-auto text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1))],8,EP))),128))])])):(Ie(),je("div",bP,[Fe[17]||(Fe[17]=A("h3",{class:"font-medium text-gray-700"},"Slectionnez une usine",-1)),A("div",wP,[ee.value?(Ie(),je(Qt,{key:0},En(3,et=>A("div",{key:et,class:"animate-pulse"},Fe[15]||(Fe[15]=[A("div",{class:"p-3 bg-white rounded-lg border border-gray-200"},[A("div",{class:"h-5 bg-gray-200 rounded w-3/4 mb-2"}),A("div",{class:"h-4 bg-gray-100 rounded w-1/2"})],-1)]))),64)):(Ie(!0),je(Qt,{key:1},En(Ge.value,et=>(Ie(),je("button",{key:et.id,onClick:ot=>st(et),class:"flex items-center p-3 text-left bg-white hover:bg-gray-50 rounded-lg border border-gray-200 transition-colors duration-200"},[A("div",null,[A("div",LP,Bt(Ue(et)),1)]),Fe[16]||(Fe[16]=A("svg",{class:"w-5 h-5 ml-auto text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1))],8,xP))),128))])]))])):mn($e).isConcessionnaire?(Ie(),je("div",GP,[te.value?(Ie(),je("div",JP,[A("div",XP,[A("button",{onClick:Ot,class:"flex items-center text-sm text-gray-600 hover:text-gray-900"},Fe[37]||(Fe[37]=[A("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),vi(" Retour  la liste des clients ")])),Fe[38]||(Fe[38]=A("span",{class:"mx-2 text-gray-400"},"|",-1)),A("span",QP,Bt(Ue(te.value)),1)]),Fe[40]||(Fe[40]=A("h3",{class:"font-medium text-gray-700"},"Plans disponibles",-1)),A("div",ek,[he.value?(Ie(),je(Qt,{key:0},En(3,et=>A("div",{key:et,class:"animate-pulse"},Fe[39]||(Fe[39]=[A("div",{class:"p-3 bg-white rounded-lg border border-gray-200"},[A("div",{class:"h-5 bg-gray-200 rounded w-3/4 mb-2"}),A("div",{class:"h-4 bg-gray-100 rounded w-2/3 mb-2"}),A("div",{class:"h-3 bg-gray-50 rounded w-1/3"})],-1)]))),64)):(Ie(!0),je(Qt,{key:1},En(Be.value,et=>(Ie(),je("button",{key:et.id,onClick:ot=>T(et.id),class:"w-full px-4 py-3 text-left bg-white hover:bg-gray-50 rounded-lg border border-gray-200 transition-colors duration-200"},[A("div",nk,Bt(et.nom),1),A("div",ik,Bt(et.description),1),A("div",rk," Modifi le "+Bt(q(et.date_modification)),1)],8,tk))),128))])])):(Ie(),je("div",HP,[Fe[36]||(Fe[36]=A("h3",{class:"font-medium text-gray-700"},"Slectionnez un agriculteur",-1)),A("div",WP,[Ee.value?(Ie(),je(Qt,{key:0},En(3,et=>A("div",{key:et,class:"animate-pulse"},Fe[33]||(Fe[33]=[A("div",{class:"p-3 bg-white rounded-lg border border-gray-200"},[A("div",{class:"h-5 bg-gray-200 rounded w-3/4 mb-2"}),A("div",{class:"h-4 bg-gray-100 rounded w-1/2"})],-1)]))),64)):(Ie(),je(Qt,{key:1},[F.value.length===0?(Ie(),je("div",ZP,Fe[34]||(Fe[34]=[A("div",{class:"text-gray-500 mb-2"},"Aucun agriculteur trouv pour ce concessionnaire",-1),A("div",{class:"text-sm text-gray-400"}," Veuillez vrifier que des agriculteurs ont t assigns  ce concessionnaire ",-1)]))):(Ie(!0),je(Qt,{key:1},En(F.value,et=>(Ie(),je("button",{key:et.id,onClick:ot=>Gt(et),class:"flex items-center p-3 text-left bg-white hover:bg-gray-50 rounded-lg border border-gray-200 transition-colors duration-200"},[A("div",null,[A("div",YP,Bt(Ue(et)),1)]),Fe[35]||(Fe[35]=A("svg",{class:"w-5 h-5 ml-auto text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1))],8,KP))),128))],64))])]))])):mn($e).isUsine?(Ie(),je("div",sk,[ze.value?te.value?(Ie(),je("div",vk,[A("div",yk,[A("button",{onClick:Ot,class:"flex items-center text-sm text-gray-600 hover:text-gray-900"},Fe[50]||(Fe[50]=[A("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),vi(" Retour  la liste des clients ")])),Fe[51]||(Fe[51]=A("span",{class:"mx-2 text-gray-400"},"|",-1)),A("span",_k,Bt(Ue(te.value)),1)]),Fe[53]||(Fe[53]=A("h3",{class:"font-medium text-gray-700"},"Plans disponibles",-1)),A("div",bk,[he.value?(Ie(),je(Qt,{key:0},En(3,et=>A("div",{key:et,class:"animate-pulse"},Fe[52]||(Fe[52]=[A("div",{class:"p-3 bg-white rounded-lg border border-gray-200"},[A("div",{class:"h-5 bg-gray-200 rounded w-3/4 mb-2"}),A("div",{class:"h-4 bg-gray-100 rounded w-2/3 mb-2"}),A("div",{class:"h-3 bg-gray-50 rounded w-1/3"})],-1)]))),64)):(Ie(!0),je(Qt,{key:1},En(Be.value,et=>(Ie(),je("button",{key:et.id,onClick:ot=>T(et.id),class:"w-full px-4 py-3 text-left bg-white hover:bg-gray-50 rounded-lg border border-gray-200 transition-colors duration-200"},[A("div",xk,Bt(et.nom),1),A("div",Lk,Bt(et.description),1),A("div",Ck," Modifi le "+Bt(q(et.date_modification)),1)],8,wk))),128))])])):(Ie(),je("div",ck,[A("div",hk,[A("button",{onClick:xt,class:"flex items-center text-sm text-gray-600 hover:text-gray-900"},Fe[44]||(Fe[44]=[A("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),vi(" Retour  la liste des concessionnaires ")])),Fe[45]||(Fe[45]=A("span",{class:"mx-2 text-gray-400"},"|",-1)),A("span",dk,Bt(Ue(ze.value)),1)]),Fe[49]||(Fe[49]=A("h3",{class:"font-medium text-gray-700"},"Slectionnez un agriculteur",-1)),A("div",fk,[Ee.value?(Ie(),je(Qt,{key:0},En(3,et=>A("div",{key:et,class:"animate-pulse"},Fe[46]||(Fe[46]=[A("div",{class:"p-3 bg-white rounded-lg border border-gray-200"},[A("div",{class:"h-5 bg-gray-200 rounded w-3/4 mb-2"}),A("div",{class:"h-4 bg-gray-100 rounded w-1/2"})],-1)]))),64)):(Ie(),je(Qt,{key:1},[F.value.length===0?(Ie(),je("div",pk,Fe[47]||(Fe[47]=[A("div",{class:"text-gray-500 mb-2"},"Aucun agriculteur trouv pour ce concessionnaire",-1),A("div",{class:"text-sm text-gray-400"}," Veuillez vrifier que des agriculteurs ont t assigns  ce concessionnaire ",-1)]))):(Ie(!0),je(Qt,{key:1},En(F.value,et=>(Ie(),je("button",{key:et.id,onClick:ot=>Gt(et),class:"flex items-center p-3 text-left bg-white hover:bg-gray-50 rounded-lg border border-gray-200 transition-colors duration-200"},[A("div",null,[A("div",mk,Bt(Ue(et)),1)]),Fe[48]||(Fe[48]=A("svg",{class:"w-5 h-5 ml-auto text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1))],8,gk))),128))],64))])])):(Ie(),je("div",ok,[Fe[43]||(Fe[43]=A("h3",{class:"font-medium text-gray-700"},"Slectionnez un concessionnaire",-1)),A("div",ak,[J.value?(Ie(),je(Qt,{key:0},En(3,et=>A("div",{key:et,class:"animate-pulse"},Fe[41]||(Fe[41]=[A("div",{class:"p-3 bg-white rounded-lg border border-gray-200"},[A("div",{class:"h-5 bg-gray-200 rounded w-3/4 mb-2"}),A("div",{class:"h-4 bg-gray-100 rounded w-1/2"})],-1)]))),64)):(Ie(!0),je(Qt,{key:1},En(Pe.value,et=>(Ie(),je("button",{key:et.id,onClick:ot=>$t(et),class:"flex items-center p-3 text-left bg-white hover:bg-gray-50 rounded-lg border border-gray-200 transition-colors duration-200"},[A("div",null,[A("div",uk,Bt(Ue(et)),1)]),Fe[42]||(Fe[42]=A("svg",{class:"w-5 h-5 ml-auto text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1))],8,lk))),128))])]))])):(Ie(),je("div",Pk,[mn(n).plans.length===0?(Ie(),je("div",kk,Fe[54]||(Fe[54]=[A("p",{class:"text-gray-500"},"Aucun plan disponible",-1)]))):(Ie(),je("div",Sk,[(Ie(!0),je(Qt,null,En(mn(n).plans,et=>(Ie(),je("button",{key:et.id,onClick:ot=>T(et.id),class:"w-full px-4 py-3 text-left bg-white hover:bg-gray-50 rounded-lg border border-gray-200 transition-colors duration-200"},[A("div",Ak,Bt(et.nom),1),A("div",Mk,Bt(et.description),1),A("div",Bk," Modifi le "+Bt(q(et.date_modification)),1)],8,Ek))),128))]))]))])])):Wt("",!0)])])}}}),Tk={class:"fixed inset-0 z-50 overflow-y-auto"},Nk={class:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0"},Dk={class:"inline-block align-bottom bg-white rounded-lg px-4 pt-5 pb-4 text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full sm:p-6",role:"dialog","aria-modal":"true","aria-labelledby":"modal-headline"},Rk={class:"mt-3 text-center sm:mt-0 sm:text-left"},Ok={class:"text-lg leading-6 font-medium text-gray-900",id:"modal-headline"},Ik={class:"mt-4"},Fk={key:0,class:"mb-4 rounded-md bg-red-50 p-4"},jk={class:"flex"},zk={class:"ml-3"},Uk={class:"text-sm font-medium text-red-800"},$k={key:0},qk={key:1},Vk=["value"],Gk={key:2},Hk={key:3},Wk=["value"],Zk={class:"grid grid-cols-1 gap-y-6 gap-x-4 sm:grid-cols-2"},Kk={key:0,class:"mt-2 text-sm text-red-600"},Yk={key:0,class:"mt-2 text-sm text-red-600"},Jk={key:4},Xk={key:5},Qk={key:0,class:"mt-2 text-sm text-red-600"},e6={class:"flex justify-end space-x-3"},t6=["disabled"],n6={key:0,class:"mr-2"},i6=Hs({__name:"UserFormModal",props:{user:{type:Object,default:()=>({})},concessionnaires:{type:Array,default:()=>[]},usines:{type:Array,default:()=>[]},isAdmin:{type:Boolean,default:!1},isUsine:{type:Boolean,default:!1},currentConcessionnaire:{type:String,default:void 0},currentUsine:{type:String,default:void 0},apiErrors:{type:Array,default:()=>[]},refreshKey:{type:Number,default:0}},emits:["close","save","refresh"],setup(e,{emit:t}){const n=e,i=t,o=Dt(!1),a=Dt(""),u=Dt(""),d=Dt(""),f=Dt(""),v=Dt(""),_=il({id:void 0,first_name:"",last_name:"",username:"",email:"",password:"",company_name:"",role:n.isUsine?"CONCESSIONNAIRE":n.isAdmin?"ADMIN":"AGRICULTEUR",concessionnaire:null,usine:null,is_active:!0});Ta(()=>{var k;(k=n.user)!=null&&k.id?(_.id=n.user.id,_.first_name=n.user.first_name||"",_.last_name=n.user.last_name||"",_.username=n.user.username||"",_.email=n.user.email||"",_.company_name=n.user.company_name||"",_.role=n.user.role||"AGRICULTEUR",_.is_active=n.user.is_active??!0,n.user.concessionnaire?typeof n.user.concessionnaire=="object"?_.concessionnaire=n.user.concessionnaire.id:_.concessionnaire=n.user.concessionnaire:n.user.concessionnaire_id?_.concessionnaire=n.user.concessionnaire_id:n.currentConcessionnaire&&(_.concessionnaire=parseInt(n.currentConcessionnaire)),n.user.usine?typeof n.user.usine=="object"?_.usine=n.user.usine.id:_.usine=n.user.usine:n.user.usine_id?_.usine=n.user.usine_id:n.currentUsine&&(_.usine=parseInt(n.currentUsine))):(n.currentConcessionnaire&&(_.concessionnaire=parseInt(n.currentConcessionnaire)),n.currentUsine&&(_.usine=parseInt(n.currentUsine)),n.isUsine?_.role="CONCESSIONNAIRE":n.isAdmin||(_.role="AGRICULTEUR"))}),hf(()=>{_.role==="ADMIN"||_.role==="USINE"?(_.concessionnaire=null,_.usine=null):_.role==="CONCESSIONNAIRE"&&(_.concessionnaire=null,n.isUsine&&n.currentUsine&&(_.usine=parseInt(n.currentUsine)))}),hf(()=>{a.value="",u.value="",d.value="",f.value="",n.apiErrors&&n.apiErrors.length>0&&n.apiErrors.forEach(k=>{switch(k.field){case"email":a.value=k.message;break;case"username":u.value=k.message;break;case"password":d.value=k.message;break;case"non_field_error":default:f.value=k.message;break}})});async function x(){a.value="",u.value="",d.value="",f.value="";let k=!0;if(_.id||(_.password!==v.value?(d.value="Les mots de passe ne correspondent pas",k=!1):_.password.length<8&&(d.value="Le mot de passe doit contenir au moins 8 caractres",k=!1)),!!k){o.value=!0;try{const w={..._};_.id&&delete w.password,n.isUsine&&["CONCESSIONNAIRE","AGRICULTEUR"].includes(_.role)&&(w.usine_id=n.currentUsine?parseInt(n.currentUsine):void 0),w.concessionnaire&&(w.concessionnaire_id=w.concessionnaire,delete w.concessionnaire),n.currentConcessionnaire&&_.role==="AGRICULTEUR"&&(w.concessionnaire_id=parseInt(n.currentConcessionnaire)),await i("save",w),i("refresh")}catch(w){console.error("Erreur locale:",w)}finally{o.value=!1}}}return(k,w)=>(Ie(),je("div",Tk,[A("div",Nk,[w[29]||(w[29]=A("div",{class:"fixed inset-0 transition-opacity","aria-hidden":"true"},[A("div",{class:"absolute inset-0 bg-gray-500 opacity-75"})],-1)),w[30]||(w[30]=A("span",{class:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true"},"",-1)),A("div",Dk,[A("div",null,[A("div",Rk,[A("h3",Ok,Bt(e.user?"Modifier l'utilisateur":"Nouvel utilisateur"),1),A("div",Ik,[f.value?(Ie(),je("div",Fk,[A("div",jk,[w[12]||(w[12]=A("div",{class:"flex-shrink-0"},[A("svg",{class:"h-5 w-5 text-red-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},[A("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})])],-1)),A("div",zk,[A("h3",Uk,Bt(f.value),1)])])])):Wt("",!0),A("form",{onSubmit:td(x,["prevent"]),class:"space-y-6"},[e.isAdmin?(Ie(),je("div",$k,[w[14]||(w[14]=A("label",{for:"role",class:"block text-sm font-medium text-gray-700"},"Type d'utilisateur",-1)),un(A("select",{id:"role","onUpdate:modelValue":w[0]||(w[0]=N=>_.role=N),class:"mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm",required:""},w[13]||(w[13]=[A("option",{value:"ADMIN"},"Administrateur",-1),A("option",{value:"USINE"},"Usine",-1),A("option",{value:"CONCESSIONNAIRE"},"Concessionnaire",-1),A("option",{value:"AGRICULTEUR"},"Agriculteur",-1)]),512),[[vr,_.role]])])):Wt("",!0),e.isAdmin&&_.role==="CONCESSIONNAIRE"?(Ie(),je("div",qk,[w[16]||(w[16]=A("label",{for:"usine",class:"block text-sm font-medium text-gray-700"},"Usine",-1)),un(A("select",{id:"usine","onUpdate:modelValue":w[1]||(w[1]=N=>_.usine=N),class:"mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm"},[w[15]||(w[15]=A("option",{value:null},"-- Slectionner une usine --",-1)),(Ie(!0),je(Qt,null,En(e.usines,N=>(Ie(),je("option",{key:N.id,value:N.id},Bt(N.first_name)+" "+Bt(N.last_name)+" ("+Bt(N.company_name||"Usine")+") ",9,Vk))),128))],512),[[vr,_.usine]])])):Wt("",!0),e.isUsine&&!_.id?(Ie(),je("div",Gk,[w[18]||(w[18]=A("label",{for:"role",class:"block text-sm font-medium text-gray-700"},"Type d'utilisateur",-1)),un(A("select",{id:"role","onUpdate:modelValue":w[2]||(w[2]=N=>_.role=N),class:"mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm",required:""},w[17]||(w[17]=[A("option",{value:"CONCESSIONNAIRE"},"Concessionnaire",-1),A("option",{value:"AGRICULTEUR"},"Agriculteur",-1)]),512),[[vr,_.role]])])):Wt("",!0),(e.isAdmin||e.isUsine)&&_.role==="AGRICULTEUR"&&!e.currentConcessionnaire?(Ie(),je("div",Hk,[w[20]||(w[20]=A("label",{for:"concessionnaire",class:"block text-sm font-medium text-gray-700"},"Concessionnaire",-1)),un(A("select",{id:"concessionnaire","onUpdate:modelValue":w[3]||(w[3]=N=>_.concessionnaire=N),class:"mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm",required:""},[w[19]||(w[19]=A("option",{value:null},"-- Slectionner un concessionnaire --",-1)),(Ie(!0),je(Qt,null,En(e.concessionnaires,N=>(Ie(),je("option",{key:N.id,value:N.id},Bt(N.first_name)+" "+Bt(N.last_name)+" ("+Bt(N.company_name||"Concessionnaire")+") ",9,Wk))),128))],512),[[vr,_.concessionnaire]])])):Wt("",!0),A("div",Zk,[A("div",null,[w[21]||(w[21]=A("label",{for:"first_name",class:"block text-sm font-medium text-gray-700"},"Prnom",-1)),un(A("input",{type:"text",id:"first_name","onUpdate:modelValue":w[4]||(w[4]=N=>_.first_name=N),class:"mt-1 focus:ring-primary-500 focus:border-primary-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"},null,512),[[Zn,_.first_name]])]),A("div",null,[w[22]||(w[22]=A("label",{for:"last_name",class:"block text-sm font-medium text-gray-700"},"Nom",-1)),un(A("input",{type:"text",id:"last_name","onUpdate:modelValue":w[5]||(w[5]=N=>_.last_name=N),class:"mt-1 focus:ring-primary-500 focus:border-primary-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"},null,512),[[Zn,_.last_name]])])]),A("div",null,[w[23]||(w[23]=A("label",{for:"email",class:"block text-sm font-medium text-gray-700"},"Email",-1)),un(A("input",{type:"email",id:"email","onUpdate:modelValue":w[6]||(w[6]=N=>_.email=N),required:"",class:"mt-1 focus:ring-primary-500 focus:border-primary-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"},null,512),[[Zn,_.email]]),a.value?(Ie(),je("div",Kk,Bt(a.value),1)):Wt("",!0)]),A("div",null,[w[24]||(w[24]=A("label",{for:"username",class:"block text-sm font-medium text-gray-700"},"Nom d'utilisateur",-1)),un(A("input",{type:"text",id:"username","onUpdate:modelValue":w[7]||(w[7]=N=>_.username=N),required:"",class:"mt-1 focus:ring-primary-500 focus:border-primary-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"},null,512),[[Zn,_.username]]),u.value?(Ie(),je("div",Yk,Bt(u.value),1)):Wt("",!0)]),A("div",null,[w[25]||(w[25]=A("label",{for:"company_name",class:"block text-sm font-medium text-gray-700"},"Entreprise",-1)),un(A("input",{type:"text",id:"company_name","onUpdate:modelValue":w[8]||(w[8]=N=>_.company_name=N),class:"mt-1 focus:ring-primary-500 focus:border-primary-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"},null,512),[[Zn,_.company_name]])]),_.id?Wt("",!0):(Ie(),je("div",Jk,[w[26]||(w[26]=A("label",{for:"password",class:"block text-sm font-medium text-gray-700"},"Mot de passe",-1)),un(A("input",{type:"password",id:"password","onUpdate:modelValue":w[9]||(w[9]=N=>_.password=N),required:"",autocomplete:"new-password",class:"mt-1 focus:ring-primary-500 focus:border-primary-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"},null,512),[[Zn,_.password]])])),_.id?Wt("",!0):(Ie(),je("div",Xk,[w[27]||(w[27]=A("label",{for:"password_confirm",class:"block text-sm font-medium text-gray-700"},"Confirmer le mot de passe",-1)),un(A("input",{type:"password",id:"password_confirm","onUpdate:modelValue":w[10]||(w[10]=N=>v.value=N),required:"",autocomplete:"new-password",class:"mt-1 focus:ring-primary-500 focus:border-primary-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"},null,512),[[Zn,v.value]]),d.value?(Ie(),je("div",Qk,Bt(d.value),1)):Wt("",!0)])),A("div",e6,[A("button",{type:"button",onClick:w[11]||(w[11]=N=>k.$emit("close")),class:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500"}," Annuler "),A("button",{type:"submit",disabled:o.value,class:"inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500"},[o.value?(Ie(),je("span",n6,w[28]||(w[28]=[A("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[A("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),A("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)]))):Wt("",!0),vi(" "+Bt(_.id?"Enregistrer":"Crer"),1)],8,t6)])],32)])])])])])]))}}),r6={class:"fixed inset-0 z-50 overflow-y-auto"},s6={class:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0"},o6={class:"inline-block align-bottom bg-white rounded-lg px-4 pt-5 pb-4 text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full sm:p-6",role:"dialog","aria-modal":"true","aria-labelledby":"modal-headline"},a6={class:"sm:flex sm:items-start"},l6={class:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left"},u6={class:"text-lg leading-6 font-medium text-gray-900",id:"modal-headline"},c6={class:"mt-2"},h6={class:"text-sm text-gray-500"},d6={class:"mt-5 sm:mt-4 sm:flex sm:flex-row-reverse"},cv=Hs({__name:"ConfirmationModal",props:{title:{type:String,required:!0},message:{type:String,required:!0}},emits:["confirm","cancel"],setup(e){return(t,n)=>(Ie(),je("div",r6,[A("div",s6,[n[3]||(n[3]=A("div",{class:"fixed inset-0 transition-opacity","aria-hidden":"true"},[A("div",{class:"absolute inset-0 bg-gray-500 opacity-75"})],-1)),n[4]||(n[4]=A("span",{class:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true"},"",-1)),A("div",o6,[A("div",a6,[n[2]||(n[2]=A("div",{class:"mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-red-100 sm:mx-0 sm:h-10 sm:w-10"},[A("svg",{class:"h-6 w-6 text-red-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})])],-1)),A("div",l6,[A("h3",u6,Bt(e.title),1),A("div",c6,[A("p",h6,Bt(e.message),1)])])]),A("div",d6,[A("button",{type:"button",class:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-red-600 text-base font-medium text-white hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 sm:ml-3 sm:w-auto sm:text-sm",onClick:n[0]||(n[0]=i=>t.$emit("confirm"))}," Confirmer "),A("button",{type:"button",class:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 sm:mt-0 sm:w-auto sm:text-sm",onClick:n[1]||(n[1]=i=>t.$emit("cancel"))}," Annuler ")])])])]))}}),f6={class:"h-full bg-gray-50"},p6={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},g6={class:"flex justify-between items-center mb-8"},m6={class:"text-3xl font-extrabold text-gray-900"},v6={key:0},y6={key:1},_6={key:2},b6={key:0},w6={key:1},x6={key:2},L6={class:"bg-white shadow rounded-lg mb-6 p-4"},C6={class:"space-y-4"},P6={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},k6={key:0},S6={key:0,value:"ADMIN"},E6={key:1,value:"USINE"},A6={key:1},M6=["value"],B6={key:2},T6=["value"],N6={class:"w-full"},D6={class:"bg-white shadow rounded-lg"},R6={class:"overflow-x-auto"},O6={class:"min-w-full divide-y divide-gray-200"},I6={class:"bg-gray-50"},F6={key:0,scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},j6={key:1,scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},z6={class:"bg-white divide-y divide-gray-200"},U6={key:0,class:"animate-pulse"},$6={key:1},q6={class:"px-6 py-4 whitespace-nowrap"},V6={class:"flex items-center"},G6={class:"flex-shrink-0 h-10 w-10"},H6={class:"h-10 w-10 rounded-full bg-primary-100 flex items-center justify-center"},W6={class:"text-primary-600 font-medium"},Z6={class:"ml-4"},K6={class:"text-sm font-medium text-gray-900"},Y6={class:"text-sm text-gray-500"},J6={class:"px-6 py-4 whitespace-nowrap"},X6={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},Q6={key:0,class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},eS={key:1,class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},tS={class:"px-6 py-4 whitespace-nowrap"},nS={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},iS=["onClick"],rS=["onClick"],sS=Hs({__name:"UserListView",setup(e){const t=ds(),n=_c(),i=Dt([]),o=Dt([]),a=Dt([]),u=Dt(!1),d=Dt(!1),f=Dt(null),v=Dt(null),_=Dt(!0),x=Dt([]),k=il({role:"",search:"",concessionnaire:"",usine:""}),w=jn(()=>t.isAdmin),N=jn(()=>t.isUsine),z=jn(()=>t.isConcessionnaire),W=jn(()=>w.value?i.value.filter(he=>he.role==="CONCESSIONNAIRE"):N.value?i.value.filter(he=>{var P,F;return he.role==="CONCESSIONNAIRE"&&((P=he.usine)==null?void 0:P.id)===((F=t.user)==null?void 0:F.id)}):[]),O=jn(()=>{let he=i.value;if(N.value&&(he=he.filter(P=>{var F,G,Q,Ae,oe;return P.role==="CONCESSIONNAIRE"?((F=P.usine)==null?void 0:F.id)===((G=t.user)==null?void 0:G.id):P.role==="AGRICULTEUR"?((Ae=(Q=P.concessionnaire)==null?void 0:Q.usine)==null?void 0:Ae.id)===((oe=t.user)==null?void 0:oe.id):!1})),z.value&&(he=he.filter(P=>{var F,G;return P.role==="AGRICULTEUR"&&(P.concessionnaire_id===((F=t.user)==null?void 0:F.id)||P.concessionnaire&&P.concessionnaire.id===((G=t.user)==null?void 0:G.id))})),(w.value||N.value)&&(k.role&&(he=he.filter(P=>P.role===k.role)),k.concessionnaire&&(he=he.filter(P=>{var G;const F=((G=P.concessionnaire)==null?void 0:G.id)||P.concessionnaire_id;return(F==null?void 0:F.toString())===k.concessionnaire.toString()})),k.usine&&w.value&&(he=he.filter(P=>{var F,G,Q,Ae,oe;return P.role==="CONCESSIONNAIRE"?((G=(F=P.usine)==null?void 0:F.id)==null?void 0:G.toString())===k.usine.toString():P.role==="AGRICULTEUR"?((oe=(Ae=(Q=P.concessionnaire)==null?void 0:Q.usine)==null?void 0:Ae.id)==null?void 0:oe.toString())===k.usine.toString():!1}))),k.search){const P=k.search.toLowerCase();he=he.filter(F=>{var G,Q,Ae,oe;return((G=F.username)==null?void 0:G.toLowerCase().includes(P))||((Q=F.email)==null?void 0:Q.toLowerCase().includes(P))||((Ae=F.first_name)==null?void 0:Ae.toLowerCase().includes(P))||((oe=F.last_name)==null?void 0:oe.toLowerCase().includes(P))||F.company_name&&F.company_name.toLowerCase().includes(P)})}return he});Ta(async()=>{await Z(),await se()});async function Z(){var he,P,F;_.value=!0;try{if(w.value)i.value=await t.fetchUsers();else if(N.value){const[G,Q]=await Promise.all([vh({role:"CONCESSIONNAIRE",usineId:(he=t.user)==null?void 0:he.id}),vh({role:"AGRICULTEUR",usineId:(P=t.user)==null?void 0:P.id})]);i.value=[...G,...Q]}else z.value&&(i.value=await vh({role:"AGRICULTEUR",concessionnaireId:(F=t.user)==null?void 0:F.id,includeDetails:!0}),console.log("Agriculteurs rcuprs:",i.value))}catch(G){console.error("Erreur lors de la rcupration des utilisateurs:",G),n.error("Erreur lors de la rcupration des utilisateurs")}finally{_.value=!1}}async function se(){try{w.value?await Promise.all([Se(),$e()]):N.value&&await Ne()}catch(he){console.error("Erreur lors de la rcupration des dpendances:",he)}}async function Se(){var he;try{w.value?o.value=await t.fetchUsersByRole({role:"CONCESSIONNAIRE"}):N.value&&(o.value=await t.fetchUsineConcessionnaires((he=t.user)==null?void 0:he.id))}catch(P){console.error("Erreur lors de la rcupration des concessionnaires:",P)}}async function Ne(){var he,P;if(!(!N.value||!((he=t.user)!=null&&he.id)))try{o.value=await t.fetchUsineConcessionnaires((P=t.user)==null?void 0:P.id)}catch(F){console.error("Erreur lors de la rcupration des concessionnaires de l'usine:",F)}}async function $e(){try{a.value=await t.fetchUsines()}catch(he){console.error("Erreur lors de la rcupration des usines:",he)}}function Pe(){f.value=null,u.value=!0}function xe(he){f.value={...he},u.value=!0}function Be(){u.value=!1,f.value=null,x.value=[]}async function ze(he){var F,G,Q,Ae,oe,me;x.value=[];const P=!!he.id;try{const T={...he};w.value?(T.usine&&typeof T.usine=="object"?T.usine_id=T.usine.id:typeof T.usine=="number"&&(T.usine_id=T.usine),T.concessionnaire&&typeof T.concessionnaire=="object"?T.concessionnaire_id=T.concessionnaire.id:typeof T.concessionnaire=="number"&&(T.concessionnaire_id=T.concessionnaire)):N.value?(T.usine_id=(F=t.user)==null?void 0:F.id,T.role==="AGRICULTEUR"&&(T.concessionnaire&&typeof T.concessionnaire=="object"?T.concessionnaire_id=T.concessionnaire.id:typeof T.concessionnaire=="number"&&(T.concessionnaire_id=T.concessionnaire))):z.value&&(T.role="AGRICULTEUR",T.concessionnaire_id=(G=t.user)==null?void 0:G.id),T.role==="CONCESSIONNAIRE"?((Q=T.usine)!=null&&Q.id?(T.usine_id=T.usine.id,delete T.usine):typeof T.usine=="number"&&(T.usine_id=T.usine,delete T.usine),delete T.concessionnaire):T.role==="AGRICULTEUR"&&((Ae=T.concessionnaire)!=null&&Ae.id?(T.concessionnaire_id=T.concessionnaire.id,delete T.concessionnaire):typeof T.concessionnaire=="number"&&(T.concessionnaire_id=T.concessionnaire,delete T.concessionnaire),delete T.usine,delete T.usine_id),P?(await t.updateUser(he.id,T),n.success("Utilisateur modifi avec succs")):(await t.createUser(T),n.success("Utilisateur cr avec succs")),await Promise.all([Z(),se()]),Be()}catch(T){console.error("Error saving user:",((oe=T.response)==null?void 0:oe.data)||T),x.value=I4(T),n.error("Erreur lors de la sauvegarde de l'utilisateur");const ne=((me=T.response)==null?void 0:me.data)||{};let ae="";throw typeof ne=="object"&&(ae=Object.entries(ne).map(([q,R])=>Array.isArray(R)?`${q}: ${R[0]}`:`${q}: ${R}`).filter(q=>q).join(`
`)),ae||(ae="Une erreur est survenue lors de la sauvegarde"),new Error(ae)}}function te(he){v.value=he,d.value=!0}async function J(){if(v.value)try{await t.deleteUser(v.value.id),n.success("Utilisateur supprim avec succs"),await Promise.all([Z(),se()]),d.value=!1,v.value=null}catch(he){throw console.error("Erreur lors de la suppression de l'utilisateur:",he),n.error("Erreur lors de la suppression de l'utilisateur"),he}}function Ee(he){var P,F,G,Q,Ae,oe,me,T;return w.value?!0:N.value?he.role==="CONCESSIONNAIRE"?((P=he.usine)==null?void 0:P.id)===((F=t.user)==null?void 0:F.id):he.role==="AGRICULTEUR"?((Q=(G=he.concessionnaire)==null?void 0:G.usine)==null?void 0:Q.id)===((Ae=t.user)==null?void 0:Ae.id):!1:z.value?he.role==="AGRICULTEUR"&&(he.concessionnaire_id===((oe=t.user)==null?void 0:oe.id)||((me=he.concessionnaire)==null?void 0:me.id)===((T=t.user)==null?void 0:T.id)):!1}return(he,P)=>{var F,G,Q,Ae;return Ie(),je("div",f6,[A("div",p6,[A("div",g6,[A("h1",m6,[w.value?(Ie(),je("span",v6,"Gestion des utilisateurs")):N.value?(Ie(),je("span",y6,"Gestion des concessionnaires et agriculteurs")):z.value?(Ie(),je("span",_6,"Gestion des agriculteurs")):Wt("",!0)]),A("button",{onClick:Pe,class:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500"},[P[5]||(P[5]=A("svg",{class:"-ml-1 mr-2 h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[A("path",{"fill-rule":"evenodd",d:"M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z","clip-rule":"evenodd"})],-1)),w.value?(Ie(),je("span",b6,"Nouvel utilisateur")):N.value?(Ie(),je("span",w6,"Nouveau concessionnaire/agriculteur")):z.value?(Ie(),je("span",x6,"Nouvel agriculteur")):Wt("",!0)])]),A("div",L6,[A("div",C6,[A("div",P6,[w.value||N.value?(Ie(),je("div",k6,[P[9]||(P[9]=A("label",{for:"role-filter",class:"block text-sm font-medium text-gray-700"},"Rle",-1)),un(A("select",{id:"role-filter","onUpdate:modelValue":P[0]||(P[0]=oe=>k.role=oe),class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md"},[P[6]||(P[6]=A("option",{value:""},"Tous les rles",-1)),w.value?(Ie(),je("option",S6,"Administrateur")):Wt("",!0),w.value?(Ie(),je("option",E6,"Usine")):Wt("",!0),P[7]||(P[7]=A("option",{value:"CONCESSIONNAIRE"},"Concessionnaire",-1)),P[8]||(P[8]=A("option",{value:"AGRICULTEUR"},"Agriculteur",-1))],512),[[vr,k.role]])])):Wt("",!0),w.value?(Ie(),je("div",A6,[P[11]||(P[11]=A("label",{for:"usine-filter",class:"block text-sm font-medium text-gray-700"},"Usine",-1)),un(A("select",{id:"usine-filter","onUpdate:modelValue":P[1]||(P[1]=oe=>k.usine=oe),class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md"},[P[10]||(P[10]=A("option",{value:""},"Toutes les usines",-1)),(Ie(!0),je(Qt,null,En(a.value,oe=>(Ie(),je("option",{key:oe.id,value:oe.id},Bt(mn(co)(oe)),9,M6))),128))],512),[[vr,k.usine]])])):Wt("",!0),w.value||N.value?(Ie(),je("div",B6,[P[13]||(P[13]=A("label",{for:"concessionnaire-filter",class:"block text-sm font-medium text-gray-700"},"Concessionnaire",-1)),un(A("select",{id:"concessionnaire-filter","onUpdate:modelValue":P[2]||(P[2]=oe=>k.concessionnaire=oe),class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md"},[P[12]||(P[12]=A("option",{value:""},"Tous les concessionnaires",-1)),(Ie(!0),je(Qt,null,En(W.value,oe=>(Ie(),je("option",{key:oe.id,value:oe.id},Bt(mn(co)(oe)),9,T6))),128))],512),[[vr,k.concessionnaire]])])):Wt("",!0)]),A("div",N6,[P[14]||(P[14]=A("label",{for:"search",class:"block text-sm font-medium text-gray-700"},"Recherche",-1)),un(A("input",{type:"text",id:"search","onUpdate:modelValue":P[3]||(P[3]=oe=>k.search=oe),placeholder:"Rechercher par nom, email, entreprise...",class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm"},null,512),[[Zn,k.search]])])])]),A("div",D6,[A("div",R6,[A("table",O6,[A("thead",I6,[A("tr",null,[P[15]||(P[15]=A("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Utilisateur ",-1)),P[16]||(P[16]=A("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Rle ",-1)),P[17]||(P[17]=A("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Email ",-1)),w.value||N.value?(Ie(),je("th",F6," Usine ")):Wt("",!0),w.value||N.value?(Ie(),je("th",j6," Concessionnaire ")):Wt("",!0),P[18]||(P[18]=A("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Statut ",-1)),P[19]||(P[19]=A("th",{scope:"col",class:"relative px-6 py-3"},[A("span",{class:"sr-only"},"Actions")],-1))])]),A("tbody",z6,[_.value?(Ie(),je("tr",U6,P[20]||(P[20]=[A("td",{colspan:"7",class:"py-4 px-6"},[A("div",{class:"h-4 bg-gray-200 rounded w-3/4"})],-1)]))):O.value.length===0?(Ie(),je("tr",$6,P[21]||(P[21]=[A("td",{colspan:"7",class:"py-4 px-6 text-center text-gray-500"}," Aucun utilisateur trouv ",-1)]))):Wt("",!0),(Ie(!0),je(Qt,null,En(O.value,oe=>{var me;return Ie(),je("tr",{key:oe.id},[A("td",q6,[A("div",V6,[A("div",G6,[A("div",H6,[A("span",W6,Bt(mn(j4)(oe.first_name,oe.last_name)),1)])]),A("div",Z6,[A("div",K6,Bt(mn(co)(oe)),1),A("div",Y6,Bt(oe.username),1)])])]),A("td",J6,[A("span",{class:zi(mn($4)())},Bt(mn(U4)(oe.role)),3)]),A("td",X6,Bt(oe.email),1),w.value||N.value?(Ie(),je("td",Q6,[oe.role==="USINE"?(Ie(),je(Qt,{key:0},[vi(" - ")],64)):oe.role==="CONCESSIONNAIRE"?(Ie(),je(Qt,{key:1},[vi(Bt(oe.usine?mn(co)(oe.usine):"Non assign"),1)],64)):oe.role==="AGRICULTEUR"?(Ie(),je(Qt,{key:2},[vi(Bt((me=oe.concessionnaire)!=null&&me.usine?mn(co)(oe.concessionnaire.usine):"Non assign"),1)],64)):(Ie(),je(Qt,{key:3},[vi(" - ")],64))])):Wt("",!0),w.value||N.value?(Ie(),je("td",eS,[oe.role==="USINE"||oe.role==="ADMIN"?(Ie(),je(Qt,{key:0},[vi(" - ")],64)):oe.role==="CONCESSIONNAIRE"?(Ie(),je(Qt,{key:1},[vi(" - ")],64)):(Ie(),je(Qt,{key:2},[vi(Bt(oe.concessionnaire?mn(co)(oe.concessionnaire):"Non assign"),1)],64))])):Wt("",!0),A("td",tS,[A("span",{class:zi(mn(q4)(oe.is_active))},Bt(oe.is_active?"Actif":"Inactif"),3)]),A("td",nS,[A("button",{onClick:T=>xe(oe),class:"text-primary-600 hover:text-primary-900 mr-4"}," Modifier ",8,iS),Ee(oe)?(Ie(),je("button",{key:0,onClick:T=>te(oe),class:"text-red-600 hover:text-red-900"}," Supprimer ",8,rS)):Wt("",!0)])])}),128))])])])])]),u.value?(Ie(),Al(i6,{key:0,user:f.value,concessionnaires:o.value,usines:a.value,"is-admin":w.value,"is-usine":N.value,"current-concessionnaire":z.value?(G=(F=mn(t).user)==null?void 0:F.id)==null?void 0:G.toString():void 0,"current-usine":N.value?(Ae=(Q=mn(t).user)==null?void 0:Q.id)==null?void 0:Ae.toString():void 0,"api-errors":x.value,onClose:Be,onSave:ze},null,8,["user","concessionnaires","usines","is-admin","is-usine","current-concessionnaire","current-usine","api-errors"])):Wt("",!0),d.value?(Ie(),Al(cv,{key:1,title:"Supprimer l'utilisateur",message:"tes-vous sr de vouloir supprimer cet utilisateur ? Cette action est irrversible.",onConfirm:J,onCancel:P[4]||(P[4]=oe=>d.value=!1)})):Wt("",!0)])}}}),oS={class:"h-full bg-gray-50"},aS={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},lS={class:"sm:flex sm:items-center"},uS={class:"sm:flex-auto"},cS={class:"text-2xl font-semibold text-gray-900"},hS={class:"mt-2 text-sm text-gray-700"},dS={key:0,class:"mt-8"},fS={class:"mb-6"},pS=["value"],gS={class:"mb-6"},mS={value:null},vS=["value"],yS={key:0,class:"mb-6"},_S={value:null},bS=["value"],wS={key:1,class:"mt-8"},xS={class:"mb-6"},LS=["value"],CS={class:"mt-8"},PS={class:"overflow-hidden shadow-sm ring-1 ring-black ring-opacity-5 rounded-lg"},kS={class:"overflow-x-auto"},SS={class:"min-w-full divide-y divide-gray-300"},ES={class:"bg-gray-50"},AS={scope:"col",class:"py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-gray-900 sm:pl-6 lg:pl-8"},MS={class:"ml-2 flex-none rounded"},BS={scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900"},TS={class:"ml-2 flex-none rounded"},NS={class:"divide-y divide-gray-200 bg-white"},DS={key:0},RS={class:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-gray-900 sm:pl-6 lg:pl-8"},OS={class:"whitespace-nowrap px-3 py-4 text-sm text-gray-500"},IS={class:"px-3 py-4 text-sm text-gray-900"},FS={key:0,class:"flex items-center"},jS={class:"h-8 w-8 flex-shrink-0"},zS={class:"h-8 w-8 rounded-full bg-primary-100 flex items-center justify-center"},US={class:"text-primary-700 font-medium text-sm"},$S={class:"ml-3"},qS={class:"font-medium"},VS={key:1,class:"text-gray-500"},GS={class:"px-3 py-4 text-sm text-gray-900"},HS={key:0,class:"flex items-center"},WS={class:"h-8 w-8 flex-shrink-0"},ZS={class:"h-8 w-8 rounded-full bg-primary-100 flex items-center justify-center"},KS={class:"text-primary-700 font-medium text-sm"},YS={class:"ml-3"},JS={class:"font-medium"},XS={key:1,class:"text-gray-500"},QS={class:"px-3 py-4 text-sm text-gray-900"},eE={key:0,class:"flex items-center"},tE={class:"h-8 w-8 flex-shrink-0"},nE={class:"h-8 w-8 rounded-full bg-primary-100 flex items-center justify-center"},iE={class:"text-primary-700 font-medium text-sm"},rE={class:"ml-3"},sE={class:"font-medium"},oE={key:1,class:"text-gray-500"},aE={class:"whitespace-nowrap px-3 py-4 text-sm text-gray-500"},lE={class:"relative whitespace-nowrap py-4 pl-3 pr-4 text-right text-sm font-medium sm:pr-6 lg:pr-8"},uE=["onClick"],cE=["onClick"],hE=["onClick"],dE={key:2,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[2000]"},fE={class:"bg-white rounded-lg p-6 max-w-md w-full"},pE={class:"flex justify-between items-center mb-4"},gE=["disabled"],mE=["disabled"],vE={key:0,class:"space-y-4"},yE={key:0},_E=["disabled"],bE=["value"],wE=["disabled"],xE=["value"],LE={key:0,class:"mt-1 text-sm text-gray-500"},CE=["disabled"],PE=["value"],kE={key:0,class:"mt-1 text-sm text-gray-500"},SE={key:1,class:"mt-4 bg-red-50 p-4 rounded-md"},EE={class:"flex"},AE={class:"ml-3"},ME={class:"text-sm font-medium text-red-800"},BE={class:"mt-5 sm:mt-6 sm:grid sm:grid-cols-2 sm:gap-3"},TE=["disabled"],NE={key:0,class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},DE=Hs({__name:"PlansView",setup(e){const t=dd(),n=cp(),i=ds(),o=Dt([]),a=Dt([]),u=Dt([]),d=Dt([]),f=Dt(!1),v=Dt(!1),_=Dt(!1),x=Dt(null),k=Dt({nom:"",description:"",client:null}),w=Dt({id:0,nom:"",description:"",usine:null,concessionnaire:null,agriculteur:null}),N=Dt(!1),z=Dt(null),W=Dt(null),O=Dt(null),Z=Dt("date_modification"),se=Dt("desc"),Se=Dt(null),Ne=jn(()=>W.value?d.value.filter(H=>typeof H.concessionnaire=="object"&&H.concessionnaire?H.concessionnaire.id===W.value:H.concessionnaire===W.value||H.concessionnaire_id===W.value):d.value),$e=jn(()=>{let H=o.value;console.log(`
[PlansView] Filtering plans:`,H.map(ce=>({id:ce.id,usine:ce.usine,concessionnaire:ce.concessionnaire,agriculteur:ce.agriculteur}))),i.isAdmin?(Se.value&&(H=H.filter(ce=>{var ue;return typeof ce.usine=="object"?((ue=ce.usine)==null?void 0:ue.id)===Se.value:ce.usine===Se.value})),W.value&&(H=H.filter(ce=>{var ue;return typeof ce.concessionnaire=="object"?((ue=ce.concessionnaire)==null?void 0:ue.id)===W.value:ce.concessionnaire===W.value}),O.value&&(H=H.filter(ce=>{var ue;return typeof ce.agriculteur=="object"?((ue=ce.agriculteur)==null?void 0:ue.id)===O.value:ce.agriculteur===O.value})))):i.isConcessionnaire&&(H=H.filter(ce=>{var ue,V,K;return typeof ce.concessionnaire=="object"?((ue=ce.concessionnaire)==null?void 0:ue.id)===((V=i.user)==null?void 0:V.id):ce.concessionnaire===((K=i.user)==null?void 0:K.id)}),O.value&&(H=H.filter(ce=>{var ue;return typeof ce.agriculteur=="object"?((ue=ce.agriculteur)==null?void 0:ue.id)===O.value:ce.agriculteur===O.value})));const $=[...H].sort((ce,ue)=>{if(Z.value==="nom")return se.value==="asc"?ce.nom.localeCompare(ue.nom):ue.nom.localeCompare(ce.nom);{const V=new Date(ce[Z.value]).getTime(),K=new Date(ue[Z.value]).getTime();return se.value==="asc"?V-K:K-V}});return console.log("[PlansView] Final filtered and sorted plans:",$.map(ce=>({id:ce.id,usine:ce.usine,concessionnaire:ce.concessionnaire,agriculteur:ce.agriculteur}))),$}),Pe=jn(()=>i.isAdmin?{title:"Tous les plans",description:"Liste complte des plans",plans:o.value}:i.isConcessionnaire?{title:"Plans des agriculteurs",description:"Plans o vous tes assign comme concessionnaire",plans:o.value.filter(H=>{var $,ce,ue;return typeof H.concessionnaire=="object"?(($=H.concessionnaire)==null?void 0:$.id)===((ce=i.user)==null?void 0:ce.id):H.concessionnaire===((ue=i.user)==null?void 0:ue.id)})}:{title:"Mes plans",description:"Plans qui vous sont assigns ou que vous avez crs",plans:o.value.filter(H=>{var ue,V,K,ye;const $=H.createur.id===((ue=i.user)==null?void 0:ue.id);let ce=!1;return typeof H.agriculteur=="object"?ce=((V=H.agriculteur)==null?void 0:V.id)===((K=i.user)==null?void 0:K.id):ce=H.agriculteur===((ye=i.user)==null?void 0:ye.id),ce||$})}),xe=jn(()=>Se.value?a.value.filter(H=>{var $;return typeof H.usine=="object"?(($=H.usine)==null?void 0:$.id)===Se.value:H.usine_id===Se.value}):a.value),Be=jn(()=>w.value.usine?a.value.filter(H=>{var $;return typeof H.usine=="object"?(($=H.usine)==null?void 0:$.id)===w.value.usine:H.usine_id===w.value.usine}):[]),ze=jn(()=>!w.value.usine||!w.value.concessionnaire?[]:d.value.filter(H=>typeof H.concessionnaire=="object"&&H.concessionnaire?H.concessionnaire.id===w.value.concessionnaire:H.concessionnaire===w.value.concessionnaire||H.concessionnaire_id===w.value.concessionnaire));Ta(async()=>{var H;await te(),i.isAdmin?await J():i.isConcessionnaire&&await he(((H=i.user)==null?void 0:H.id)||0)});async function te(){try{const H=await n.fetchPlansWithDetails();o.value=H.data}catch(H){console.error("Erreur lors du chargement des plans:",H)}}async function J(){try{console.log("Chargement des usines..."),u.value=await i.fetchUsines(),console.log("Usines charges:",u.value)}catch(H){console.error("Erreur lors du chargement des usines:",H)}}async function Ee(H){try{if(console.log("Chargement des concessionnaires pour l'usine:",H),H===void 0){const $=await i.fetchUsersByRole({role:"CONCESSIONNAIRE"});a.value=$}else a.value=await i.fetchUsineConcessionnaires(H);console.log("Concessionnaires chargs:",a.value)}catch($){console.error("Erreur lors du chargement des concessionnaires:",$)}}async function he(H){try{console.log("Chargement des agriculteurs pour le concessionnaire:",H);const $=await vh({role:"AGRICULTEUR",concessionnaireId:H});d.value=$.map(ce=>({...ce,concessionnaire_id:H})),console.log("Agriculteurs chargs:",d.value)}catch($){console.error("Erreur lors du chargement des agriculteurs:",$)}}function P(){f.value=!0,k.value={nom:"",description:"",client:null}}async function F(H){console.log(`
[PlansView][editPlan] ====== DBUT DITION PLAN ======`),console.log("[PlansView][editPlan] Plan reu:",{id:H.id,nom:H.nom,usine:H.usine,concessionnaire:H.concessionnaire,agriculteur:H.agriculteur});try{console.log("[PlansView][editPlan] Dfinition du plan courant dans le store..."),n.setCurrentPlan(H),console.log("[PlansView][editPlan] Sauvegarde de l'ID dans localStorage:",H.id),localStorage.setItem("lastPlanId",H.id.toString()),console.log("[PlansView][editPlan] Redirection vers la vue carte..."),await t.push("/"),console.log(`[PlansView][editPlan] ====== FIN DITION PLAN ======
`)}catch($){console.error("[PlansView][editPlan] ERREUR:",$),$ instanceof Error&&console.error("[PlansView][editPlan] Stack trace:",$.stack),alert("Une erreur est survenue lors du chargement du plan")}}async function G(H){H!=null&&H.id&&(x.value=H,_.value=!0)}async function Q(){var H,$;if((H=x.value)!=null&&H.id)try{await n.deletePlan(x.value.id),await te(),(($=n.currentPlan)==null?void 0:$.id)===x.value.id&&n.clearCurrentPlan()}catch(ce){console.error("Erreur lors de la suppression du plan:",ce),alert("Une erreur est survenue lors de la suppression du plan")}finally{_.value=!1,x.value=null}}function Ae(){_.value=!1,x.value=null}function oe(H){return new Date(H).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}function me(H){if(!H)return"";const $=H.first_name||"",ce=H.last_name||"";return($.charAt(0)+ce.charAt(0)).toUpperCase()}async function T(H){N.value=!0,z.value=null;try{i.isAdmin&&!u.value.length&&await J();const $=typeof H.usine=="object"&&H.usine?H.usine.id:H.usine,ce=typeof H.concessionnaire=="object"&&H.concessionnaire?H.concessionnaire.id:H.concessionnaire,ue=typeof H.agriculteur=="object"&&H.agriculteur?H.agriculteur.id:H.agriculteur;w.value={id:H.id,nom:H.nom,description:H.description,usine:$||null,concessionnaire:ce||null,agriculteur:ue||null},$&&await Ee($),ce&&await he(ce),v.value=!0}catch($){console.error("Erreur lors de l'ouverture du modal:",$),z.value="Erreur lors du chargement des donnes"}finally{N.value=!1}}async function ne(){var H,$,ce,ue,V;z.value=null,N.value=!0;try{if(!w.value.nom.trim())throw new Error("Le nom du plan est requis");if(w.value.agriculteur&&!w.value.concessionnaire)throw new Error("Un concessionnaire doit tre slectionn pour assigner un agriculteur");if(w.value.concessionnaire&&!w.value.usine)throw new Error("Une usine doit tre slectionne pour assigner un concessionnaire");console.log("Donnes envoyes pour la mise  jour:",{id:w.value.id,nom:w.value.nom.trim(),description:w.value.description.trim(),usine_id:w.value.usine,concessionnaire_id:w.value.concessionnaire,agriculteur_id:w.value.agriculteur});const K=await n.updatePlanDetails(w.value.id,{nom:w.value.nom.trim(),description:w.value.description.trim(),usine_id:w.value.usine,concessionnaire_id:w.value.concessionnaire,agriculteur_id:w.value.agriculteur});console.log("Rponse de la mise  jour:",K),K&&(v.value=!1,await te())}catch(K){if(console.error("Erreur lors de la mise  jour du plan:",K),($=(H=K.response)==null?void 0:H.data)!=null&&$.detail)z.value=K.response.data.detail;else if((ue=(ce=K.response)==null?void 0:ce.data)!=null&&ue.non_field_errors)z.value=K.response.data.non_field_errors[0];else if((V=K.response)!=null&&V.data){const ye=Object.entries(K.response.data).map(([ve,ee])=>`${ve}: ${Array.isArray(ee)?ee[0]:ee}`);z.value=ye.join(`
`)}else z.value=K.message||"Une erreur est survenue lors de la mise  jour du plan"}finally{N.value=!1}}Qi(()=>Se.value,async H=>{W.value=null,O.value=null,H?await Ee(H):await Ee()}),Qi(()=>W.value,async H=>{O.value=null,H&&await he(H)}),Qi(()=>w.value.usine,async H=>{H===null?(w.value.concessionnaire=null,w.value.agriculteur=null):await Ee(H)}),Qi(()=>w.value.concessionnaire,async H=>{w.value.agriculteur=null,H&&await he(H)});function ae(H){var V,K,ye;const $=i.user;if(!$)return!1;if($.user_type==="admin")return!0;if($.user_type==="usine")return typeof H.usine=="object"?((V=H.usine)==null?void 0:V.id)===$.id:H.usine===$.id;if($.user_type==="concessionnaire")return typeof H.concessionnaire=="object"?((K=H.concessionnaire)==null?void 0:K.id)===$.id:H.concessionnaire===$.id;const ce=H.createur.id===$.id;let ue=!1;return typeof H.agriculteur=="object"?ue=((ye=H.agriculteur)==null?void 0:ye.id)===$.id:ue=H.agriculteur===$.id,ue||ce}async function q(H){await te(),localStorage.setItem("lastPlanId",H.toString()),console.log(`Plan ${H} cr et dfini comme plan actif`),t.push("/")}function R(H){Z.value===H?se.value=se.value==="asc"?"desc":"asc":(Z.value=H,se.value="desc")}function U(H){return H?co(H):""}return(H,$)=>{var ce;return Ie(),je("div",oS,[A("div",aS,[A("div",lS,[A("div",uS,[A("h1",cS,Bt(Pe.value.title),1),A("p",hS,Bt(Pe.value.description),1)]),A("div",{class:"mt-4 sm:mt-0 sm:ml-16 sm:flex-none"},[A("button",{onClick:P,class:"inline-flex items-center justify-center rounded-md border border-transparent bg-primary-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 sm:w-auto"}," Nouveau plan ")])]),mn(i).isAdmin?(Ie(),je("div",dS,[A("div",fS,[$[15]||($[15]=A("label",{for:"usine-filter",class:"block text-sm font-medium text-gray-700"},"Filtrer par usine",-1)),un(A("select",{id:"usine-filter","onUpdate:modelValue":$[0]||($[0]=ue=>Se.value=ue),class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md"},[$[14]||($[14]=A("option",{value:null},"Toutes les usines",-1)),(Ie(!0),je(Qt,null,En(u.value,ue=>(Ie(),je("option",{key:ue.id,value:ue.id},Bt(U(ue)),9,pS))),128))],512),[[vr,Se.value]])]),A("div",gS,[$[16]||($[16]=A("label",{for:"concessionnaire-filter",class:"block text-sm font-medium text-gray-700"},"Filtrer par concessionnaire",-1)),un(A("select",{id:"concessionnaire-filter","onUpdate:modelValue":$[1]||($[1]=ue=>W.value=ue),class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md"},[A("option",mS,Bt(xe.value.length?"Tous les concessionnaires":"Aucun concessionnaire disponible"),1),(Ie(!0),je(Qt,null,En(xe.value,ue=>(Ie(),je("option",{key:ue.id,value:ue.id},Bt(U(ue)),9,vS))),128))],512),[[vr,W.value]])]),W.value?(Ie(),je("div",yS,[$[17]||($[17]=A("label",{for:"agriculteur-filter",class:"block text-sm font-medium text-gray-700"},"Filtrer par agriculteur",-1)),un(A("select",{id:"agriculteur-filter","onUpdate:modelValue":$[2]||($[2]=ue=>O.value=ue),class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md"},[A("option",_S,Bt(Ne.value.length?"Tous les agriculteurs":"Aucun agriculteur disponible"),1),(Ie(!0),je(Qt,null,En(Ne.value,ue=>(Ie(),je("option",{key:ue.id,value:ue.id},Bt(U(ue)),9,bS))),128))],512),[[vr,O.value]])])):Wt("",!0)])):mn(i).isConcessionnaire?(Ie(),je("div",wS,[A("div",xS,[$[19]||($[19]=A("label",{for:"agriculteur-filter",class:"block text-sm font-medium text-gray-700"},"Filtrer par agriculteur",-1)),un(A("select",{id:"agriculteur-filter","onUpdate:modelValue":$[3]||($[3]=ue=>O.value=ue),class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md"},[$[18]||($[18]=A("option",{value:null},"Tous les agriculteurs",-1)),(Ie(!0),je(Qt,null,En(d.value,ue=>(Ie(),je("option",{key:ue.id,value:ue.id},Bt(U(ue)),9,LS))),128))],512),[[vr,O.value]])])])):Wt("",!0),A("div",CS,[A("div",PS,[A("div",kS,[A("table",SS,[A("thead",ES,[A("tr",null,[A("th",AS,[A("button",{onClick:$[4]||($[4]=ue=>R("nom")),class:"group inline-flex items-center"},[$[21]||($[21]=vi(" Nom ")),A("span",MS,[(Ie(),je("svg",{class:zi(["h-5 w-5",{"text-gray-900":Z.value==="nom","text-gray-400":Z.value!=="nom","rotate-180":Z.value==="nom"&&se.value==="asc"}]),viewBox:"0 0 20 20",fill:"currentColor"},$[20]||($[20]=[A("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"},null,-1)]),2))])])]),$[24]||($[24]=A("th",{scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900"}," Description ",-1)),$[25]||($[25]=A("th",{scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900"}," Usine ",-1)),$[26]||($[26]=A("th",{scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900"}," Concessionnaire ",-1)),$[27]||($[27]=A("th",{scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900"}," Agriculteur ",-1)),A("th",BS,[A("button",{onClick:$[5]||($[5]=ue=>R("date_modification")),class:"group inline-flex items-center"},[$[23]||($[23]=vi(" Dernire modification ")),A("span",TS,[(Ie(),je("svg",{class:zi(["h-5 w-5",{"text-gray-900":Z.value==="date_modification","text-gray-400":Z.value!=="date_modification","rotate-180":Z.value==="date_modification"&&se.value==="asc"}]),viewBox:"0 0 20 20",fill:"currentColor"},$[22]||($[22]=[A("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"},null,-1)]),2))])])]),$[28]||($[28]=A("th",{scope:"col",class:"relative py-3.5 pl-3 pr-4 sm:pr-6 lg:pr-8"},[A("span",{class:"sr-only"},"Actions")],-1))])]),A("tbody",NS,[$e.value.length===0?(Ie(),je("tr",DS,$[29]||($[29]=[A("td",{colspan:"7",class:"py-4 px-6 text-center text-gray-500"}," Aucun plan disponible ",-1)]))):Wt("",!0),(Ie(!0),je(Qt,null,En($e.value,ue=>(Ie(),je("tr",{key:ue.id,class:"hover:bg-gray-50"},[A("td",RS,Bt(ue.nom),1),A("td",OS,Bt(ue.description||"-"),1),A("td",IS,[ue.usine&&typeof ue.usine=="object"?(Ie(),je("div",FS,[A("div",jS,[A("div",zS,[A("span",US,Bt(me(ue.usine)),1)])]),A("div",$S,[A("div",qS,Bt(mn(co)(ue.usine)),1)])])):(Ie(),je("div",VS," Non assign "))]),A("td",GS,[ue.concessionnaire&&typeof ue.concessionnaire=="object"?(Ie(),je("div",HS,[A("div",WS,[A("div",ZS,[A("span",KS,Bt(me(ue.concessionnaire)),1)])]),A("div",YS,[A("div",JS,Bt(mn(co)(ue.concessionnaire)),1)])])):(Ie(),je("div",XS," Non assign "))]),A("td",QS,[ue.agriculteur&&typeof ue.agriculteur=="object"?(Ie(),je("div",eE,[A("div",tE,[A("div",nE,[A("span",iE,Bt(me(ue.agriculteur)),1)])]),A("div",rE,[A("div",sE,Bt(mn(co)(ue.agriculteur)),1)])])):(Ie(),je("div",oE," Non assign "))]),A("td",aE,Bt(oe(ue.date_modification)),1),A("td",lE,[A("button",{onClick:V=>F(ue),class:"text-primary-600 hover:text-primary-900 mr-4"}," Ouvrir ",8,uE),A("button",{onClick:V=>T(ue),class:"text-primary-600 hover:text-primary-900 mr-4"}," Modifier ",8,cE),ae(ue)?(Ie(),je("button",{key:0,onClick:V=>G(ue),class:"text-red-600 hover:text-red-900"}," Supprimer ",8,hE)):Wt("",!0)])]))),128))])])])])]),Ci($1,{modelValue:f.value,"onUpdate:modelValue":$[6]||($[6]=ue=>f.value=ue),concessionnaires:a.value,clients:d.value,onCreated:q},null,8,["modelValue","concessionnaires","clients"]),v.value?(Ie(),je("div",dE,[A("div",fE,[A("div",pE,[$[31]||($[31]=A("h2",{class:"text-xl font-semibold text-gray-900"},"Modifier le plan",-1)),A("button",{onClick:$[7]||($[7]=ue=>v.value=!1),class:"text-gray-400 hover:text-gray-500 focus:outline-none"},$[30]||($[30]=[A("svg",{class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),A("form",{onSubmit:td(ne,["prevent"]),class:"space-y-4"},[A("div",null,[$[32]||($[32]=A("label",{for:"edit-nom",class:"block text-sm font-medium text-gray-700"}," Nom ",-1)),un(A("input",{type:"text",id:"edit-nom","onUpdate:modelValue":$[8]||($[8]=ue=>w.value.nom=ue),disabled:N.value,class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm disabled:bg-gray-100 disabled:cursor-not-allowed",required:""},null,8,gE),[[Zn,w.value.nom]])]),A("div",null,[$[33]||($[33]=A("label",{for:"edit-description",class:"block text-sm font-medium text-gray-700"}," Description ",-1)),un(A("textarea",{id:"edit-description","onUpdate:modelValue":$[9]||($[9]=ue=>w.value.description=ue),disabled:N.value,rows:"3",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm disabled:bg-gray-100 disabled:cursor-not-allowed"},null,8,mE),[[Zn,w.value.description]])]),mn(i).isAdmin||((ce=mn(i).user)==null?void 0:ce.user_type)==="usine"?(Ie(),je("div",vE,[mn(i).isAdmin?(Ie(),je("div",yE,[$[35]||($[35]=A("label",{for:"edit-usine",class:"block text-sm font-medium text-gray-700"}," Usine ",-1)),un(A("select",{id:"edit-usine","onUpdate:modelValue":$[10]||($[10]=ue=>w.value.usine=ue),disabled:N.value,class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md disabled:bg-gray-100 disabled:cursor-not-allowed"},[$[34]||($[34]=A("option",{value:null},"Slectionner une usine",-1)),(Ie(!0),je(Qt,null,En(u.value,ue=>(Ie(),je("option",{key:ue.id,value:ue.id},Bt(U(ue)),9,bE))),128))],8,_E),[[vr,w.value.usine]])])):Wt("",!0),A("div",null,[$[37]||($[37]=A("label",{for:"edit-concessionnaire",class:"block text-sm font-medium text-gray-700"}," Concessionnaire ",-1)),un(A("select",{id:"edit-concessionnaire","onUpdate:modelValue":$[11]||($[11]=ue=>w.value.concessionnaire=ue),disabled:mn(i).isAdmin&&!w.value.usine||N.value,class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md disabled:bg-gray-100 disabled:cursor-not-allowed"},[$[36]||($[36]=A("option",{value:null},"Slectionner un concessionnaire",-1)),(Ie(!0),je(Qt,null,En(Be.value,ue=>(Ie(),je("option",{key:ue.id,value:ue.id},Bt(U(ue)),9,xE))),128))],8,wE),[[vr,w.value.concessionnaire]]),mn(i).isAdmin&&!w.value.usine?(Ie(),je("p",LE," Veuillez d'abord slectionner une usine ")):Wt("",!0)]),A("div",null,[$[39]||($[39]=A("label",{for:"edit-agriculteur",class:"block text-sm font-medium text-gray-700"}," Agriculteur ",-1)),un(A("select",{id:"edit-agriculteur","onUpdate:modelValue":$[12]||($[12]=ue=>w.value.agriculteur=ue),disabled:!w.value.concessionnaire||N.value,class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md disabled:bg-gray-100 disabled:cursor-not-allowed"},[$[38]||($[38]=A("option",{value:null},"Slectionner un agriculteur",-1)),(Ie(!0),je(Qt,null,En(ze.value,ue=>(Ie(),je("option",{key:ue.id,value:ue.id},Bt(U(ue)),9,PE))),128))],8,CE),[[vr,w.value.agriculteur]]),w.value.concessionnaire?Wt("",!0):(Ie(),je("p",kE," Veuillez d'abord slectionner un concessionnaire "))])])):Wt("",!0),z.value?(Ie(),je("div",SE,[A("div",EE,[$[40]||($[40]=A("div",{class:"flex-shrink-0"},[A("svg",{class:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor"},[A("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})])],-1)),A("div",AE,[A("p",ME,Bt(z.value),1)])])])):Wt("",!0),A("div",BE,[A("button",{type:"button",class:"mt-3 inline-flex w-full justify-center rounded-md border border-gray-300 bg-white px-4 py-2 text-base font-medium text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 sm:mt-0 sm:text-sm",onClick:$[13]||($[13]=ue=>v.value=!1)}," Annuler "),A("button",{type:"submit",disabled:N.value,class:"inline-flex w-full justify-center rounded-md border border-transparent bg-primary-600 px-4 py-2 text-base font-medium text-white shadow-sm hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 sm:text-sm disabled:opacity-50"},[N.value?(Ie(),je("svg",NE,$[41]||($[41]=[A("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),A("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):Wt("",!0),vi(" "+Bt(N.value?"Enregistrement...":"Enregistrer"),1)],8,TE)])],32)])])):Wt("",!0),_.value?(Ie(),Al(cv,{key:3,title:"Supprimer le plan",message:"tes-vous sr de vouloir supprimer ce plan ? Cette action est irrversible.",onConfirm:Q,onCancel:Ae})):Wt("",!0)])])}}}),hv=V5({history:w5("/"),routes:[{path:"/",name:"home",component:kg,meta:{requiresAuth:!0,allowedRoles:["admin","usine","concessionnaire","agriculteur"]}},{path:"/plans",name:"plans",component:DE,meta:{requiresAuth:!0,allowedRoles:["admin","usine","concessionnaire","agriculteur"]}},{path:"/users",name:"users",component:sS,meta:{requiresAuth:!0,allowedRoles:["admin","usine","concessionnaire"]}},{path:"/profile",name:"profile",component:()=>eu(()=>import("./ProfileView.js"),[]),meta:{requiresAuth:!0,allowedRoles:["admin","usine","concessionnaire","agriculteur"]}},{path:"/login",name:"login",component:Aw,meta:{requiresGuest:!0}},{path:"/forgot-password",name:"forgot-password",component:()=>eu(()=>import("./ForgotPasswordView.js"),[]),meta:{requiresGuest:!0}},{path:"/reset-password/:token",name:"reset-password",component:()=>eu(()=>import("./ResetPasswordView.js"),[]),meta:{requiresGuest:!0}},{path:"/change-password",name:"changePassword",component:cw,meta:{requiresAuth:!0,allowedRoles:["admin","usine","concessionnaire","agriculteur"]}},{path:"/map",name:"map",component:kg,meta:{requiresAuth:!0}},{path:"/:pathMatch(.*)*",name:"not-found",component:()=>eu(()=>import("./NotFoundView.js"),[])}]});hv.beforeEach(async(e,t,n)=>{var d,f;const i=ds();if(console.log("Route:",e.path,"Auth state:",{initialized:i.initialized,isAuthenticated:i.isAuthenticated,user:i.user}),!i.initialized)try{await i.initialize(window.INITIAL_STATE)}catch(v){console.error("Error initializing auth store:",v)}const o=i.isAuthenticated,a=(d=i.user)==null?void 0:d.must_change_password,u=(f=i.user)==null?void 0:f.user_type;if(e.meta.requiresAuth&&!o){n("/login");return}if(o&&a&&e.name!=="changePassword"){n({name:"changePassword"});return}if(e.name==="changePassword"&&!a){n({name:"home"});return}if(e.meta.allowedRoles&&u&&!e.meta.allowedRoles.includes(u)){n({name:"home"});return}if(e.meta.requiresGuest&&o){n({name:"home"});return}n()});const pp=X2($3),dv=t_();pp.use(dv);pp.use(hv);const RE=ds(dv);window.INITIAL_STATE&&RE.initialize(window.INITIAL_STATE);pp.mount("#app");export{yi as _,il as a,A as b,je as c,Hs as d,Wt as e,un as f,Ie as g,gc as h,vi as i,Ci as j,Qo as k,Ey as l,tA as m,zi as n,Ta as o,dd as p,To as q,Dt as r,A1 as s,Bt as t,ds as u,Zn as v,td as w};
