var bv=Object.defineProperty;var wv=(e,t,n)=>t in e?bv(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var jt=(e,t,n)=>wv(e,typeof t!="symbol"?t+"":t,n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const u of a.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&i(u)}).observe(document,{childList:!0,subtree:!0});function n(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(o){if(o.ep)return;o.ep=!0;const a=n(o);fetch(o.href,a)}})();/**
* @vue/shared v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function Uf(e){const t=Object.create(null);for(const n of e.split(","))t[n]=1;return n=>n in t}const Ci={},Tu=[],Ma=()=>{},xv=()=>!1,qh=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),$f=e=>e.startsWith("onUpdate:"),Fr=Object.assign,qf=(e,t)=>{const n=e.indexOf(t);n>-1&&e.splice(n,1)},Lv=Object.prototype.hasOwnProperty,fi=(e,t)=>Lv.call(e,t),yn=Array.isArray,Nu=e=>Rc(e)==="[object Map]",qu=e=>Rc(e)==="[object Set]",Cp=e=>Rc(e)==="[object Date]",Nn=e=>typeof e=="function",or=e=>typeof e=="string",Ta=e=>typeof e=="symbol",ki=e=>e!==null&&typeof e=="object",Eg=e=>(ki(e)||Nn(e))&&Nn(e.then)&&Nn(e.catch),Sg=Object.prototype.toString,Rc=e=>Sg.call(e),Cv=e=>Rc(e).slice(8,-1),Ag=e=>Rc(e)==="[object Object]",Vf=e=>or(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,uc=Uf(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Vh=e=>{const t=Object.create(null);return n=>t[n]||(t[n]=e(n))},Pv=/-(\w)/g,Oo=Vh(e=>e.replace(Pv,(t,n)=>n?n.toUpperCase():"")),kv=/\B([A-Z])/g,uu=Vh(e=>e.replace(kv,"-$1").toLowerCase()),Gh=Vh(e=>e.charAt(0).toUpperCase()+e.slice(1)),Pd=Vh(e=>e?`on${Gh(e)}`:""),Ml=(e,t)=>!Object.is(e,t),uh=(e,...t)=>{for(let n=0;n<e.length;n++)e[n](...t)},Mg=(e,t,n,i=!1)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:i,value:n})},Ph=e=>{const t=parseFloat(e);return isNaN(t)?e:t},Ev=e=>{const t=or(e)?Number(e):NaN;return isNaN(t)?e:t};let Pp;const Hh=()=>Pp||(Pp=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Oc(e){if(yn(e)){const t={};for(let n=0;n<e.length;n++){const i=e[n],o=or(i)?Bv(i):Oc(i);if(o)for(const a in o)t[a]=o[a]}return t}else if(or(e)||ki(e))return e}const Sv=/;(?![^(]*\))/g,Av=/:([^]+)/,Mv=/\/\*[^]*?\*\//g;function Bv(e){const t={};return e.replace(Mv,"").split(Sv).forEach(n=>{if(n){const i=n.split(Av);i.length>1&&(t[i[0].trim()]=i[1].trim())}}),t}function zi(e){let t="";if(or(e))t=e;else if(yn(e))for(let n=0;n<e.length;n++){const i=zi(e[n]);i&&(t+=i+" ")}else if(ki(e))for(const n in e)e[n]&&(t+=n+" ");return t.trim()}const Tv="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Nv=Uf(Tv);function Bg(e){return!!e||e===""}function Dv(e,t){if(e.length!==t.length)return!1;let n=!0;for(let i=0;n&&i<e.length;i++)n=su(e[i],t[i]);return n}function su(e,t){if(e===t)return!0;let n=Cp(e),i=Cp(t);if(n||i)return n&&i?e.getTime()===t.getTime():!1;if(n=Ta(e),i=Ta(t),n||i)return e===t;if(n=yn(e),i=yn(t),n||i)return n&&i?Dv(e,t):!1;if(n=ki(e),i=ki(t),n||i){if(!n||!i)return!1;const o=Object.keys(e).length,a=Object.keys(t).length;if(o!==a)return!1;for(const u in e){const d=e.hasOwnProperty(u),f=t.hasOwnProperty(u);if(d&&!f||!d&&f||!su(e[u],t[u]))return!1}}return String(e)===String(t)}function Gf(e,t){return e.findIndex(n=>su(n,t))}const Tg=e=>!!(e&&e.__v_isRef===!0),Tt=e=>or(e)?e:e==null?"":yn(e)||ki(e)&&(e.toString===Sg||!Nn(e.toString))?Tg(e)?Tt(e.value):JSON.stringify(e,Ng,2):String(e),Ng=(e,t)=>Tg(t)?Ng(e,t.value):Nu(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((n,[i,o],a)=>(n[kd(i,a)+" =>"]=o,n),{})}:qu(t)?{[`Set(${t.size})`]:[...t.values()].map(n=>kd(n))}:Ta(t)?kd(t):ki(t)&&!yn(t)&&!Ag(t)?String(t):t,kd=(e,t="")=>{var n;return Ta(e)?`Symbol(${(n=e.description)!=null?n:t})`:e};/**
* @vue/reactivity v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Cs;class Dg{constructor(t=!1){this.detached=t,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Cs,!t&&Cs&&(this.index=(Cs.scopes||(Cs.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,n;if(this.scopes)for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].pause();for(t=0,n=this.effects.length;t<n;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,n;if(this.scopes)for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].resume();for(t=0,n=this.effects.length;t<n;t++)this.effects[t].resume()}}run(t){if(this._active){const n=Cs;try{return Cs=this,t()}finally{Cs=n}}}on(){Cs=this}off(){Cs=this.parent}stop(t){if(this._active){this._active=!1;let n,i;for(n=0,i=this.effects.length;n<i;n++)this.effects[n].stop();for(this.effects.length=0,n=0,i=this.cleanups.length;n<i;n++)this.cleanups[n]();if(this.cleanups.length=0,this.scopes){for(n=0,i=this.scopes.length;n<i;n++)this.scopes[n].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!t){const o=this.parent.scopes.pop();o&&o!==this&&(this.parent.scopes[this.index]=o,o.index=this.index)}this.parent=void 0}}}function Rg(e){return new Dg(e)}function Og(){return Cs}function Rv(e,t=!1){Cs&&Cs.cleanups.push(e)}let Mi;const Ed=new WeakSet;class Ig{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Cs&&Cs.active&&Cs.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Ed.has(this)&&(Ed.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||jg(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,kp(this),zg(this);const t=Mi,n=na;Mi=this,na=!0;try{return this.fn()}finally{Ug(this),Mi=t,na=n,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)Zf(t);this.deps=this.depsTail=void 0,kp(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Ed.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){tf(this)&&this.run()}get dirty(){return tf(this)}}let Fg=0,cc,hc;function jg(e,t=!1){if(e.flags|=8,t){e.next=hc,hc=e;return}e.next=cc,cc=e}function Hf(){Fg++}function Wf(){if(--Fg>0)return;if(hc){let t=hc;for(hc=void 0;t;){const n=t.next;t.next=void 0,t.flags&=-9,t=n}}let e;for(;cc;){let t=cc;for(cc=void 0;t;){const n=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(i){e||(e=i)}t=n}}if(e)throw e}function zg(e){for(let t=e.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function Ug(e){let t,n=e.depsTail,i=n;for(;i;){const o=i.prevDep;i.version===-1?(i===n&&(n=o),Zf(i),Ov(i)):t=i,i.dep.activeLink=i.prevActiveLink,i.prevActiveLink=void 0,i=o}e.deps=t,e.depsTail=n}function tf(e){for(let t=e.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&($g(t.dep.computed)||t.dep.version!==t.version))return!0;return!!e._dirty}function $g(e){if(e.flags&4&&!(e.flags&16)||(e.flags&=-17,e.globalVersion===xc))return;e.globalVersion=xc;const t=e.dep;if(e.flags|=2,t.version>0&&!e.isSSR&&e.deps&&!tf(e)){e.flags&=-3;return}const n=Mi,i=na;Mi=e,na=!0;try{zg(e);const o=e.fn(e._value);(t.version===0||Ml(o,e._value))&&(e._value=o,t.version++)}catch(o){throw t.version++,o}finally{Mi=n,na=i,Ug(e),e.flags&=-3}}function Zf(e,t=!1){const{dep:n,prevSub:i,nextSub:o}=e;if(i&&(i.nextSub=o,e.prevSub=void 0),o&&(o.prevSub=i,e.nextSub=void 0),n.subs===e&&(n.subs=i,!i&&n.computed)){n.computed.flags&=-5;for(let a=n.computed.deps;a;a=a.nextDep)Zf(a,!0)}!t&&!--n.sc&&n.map&&n.map.delete(n.key)}function Ov(e){const{prevDep:t,nextDep:n}=e;t&&(t.nextDep=n,e.prevDep=void 0),n&&(n.prevDep=t,e.nextDep=void 0)}let na=!0;const qg=[];function Ol(){qg.push(na),na=!1}function Il(){const e=qg.pop();na=e===void 0?!0:e}function kp(e){const{cleanup:t}=e;if(e.cleanup=void 0,t){const n=Mi;Mi=void 0;try{t()}finally{Mi=n}}}let xc=0;class Iv{constructor(t,n){this.sub=t,this.dep=n,this.version=n.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Kf{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(t){if(!Mi||!na||Mi===this.computed)return;let n=this.activeLink;if(n===void 0||n.sub!==Mi)n=this.activeLink=new Iv(Mi,this),Mi.deps?(n.prevDep=Mi.depsTail,Mi.depsTail.nextDep=n,Mi.depsTail=n):Mi.deps=Mi.depsTail=n,Vg(n);else if(n.version===-1&&(n.version=this.version,n.nextDep)){const i=n.nextDep;i.prevDep=n.prevDep,n.prevDep&&(n.prevDep.nextDep=i),n.prevDep=Mi.depsTail,n.nextDep=void 0,Mi.depsTail.nextDep=n,Mi.depsTail=n,Mi.deps===n&&(Mi.deps=i)}return n}trigger(t){this.version++,xc++,this.notify(t)}notify(t){Hf();try{for(let n=this.subs;n;n=n.prevSub)n.sub.notify()&&n.sub.dep.notify()}finally{Wf()}}}function Vg(e){if(e.dep.sc++,e.sub.flags&4){const t=e.dep.computed;if(t&&!e.dep.subs){t.flags|=20;for(let i=t.deps;i;i=i.nextDep)Vg(i)}const n=e.dep.subs;n!==e&&(e.prevSub=n,n&&(n.nextSub=e)),e.dep.subs=e}}const kh=new WeakMap,tu=Symbol(""),nf=Symbol(""),Lc=Symbol("");function ls(e,t,n){if(na&&Mi){let i=kh.get(e);i||kh.set(e,i=new Map);let o=i.get(n);o||(i.set(n,o=new Kf),o.map=i,o.key=n),o.track()}}function Qa(e,t,n,i,o,a){const u=kh.get(e);if(!u){xc++;return}const d=f=>{f&&f.trigger()};if(Hf(),t==="clear")u.forEach(d);else{const f=yn(e),m=f&&Vf(n);if(f&&n==="length"){const y=Number(i);u.forEach((x,k)=>{(k==="length"||k===Lc||!Ta(k)&&k>=y)&&d(x)})}else switch((n!==void 0||u.has(void 0))&&d(u.get(n)),m&&d(u.get(Lc)),t){case"add":f?m&&d(u.get("length")):(d(u.get(tu)),Nu(e)&&d(u.get(nf)));break;case"delete":f||(d(u.get(tu)),Nu(e)&&d(u.get(nf)));break;case"set":Nu(e)&&d(u.get(tu));break}}Wf()}function Fv(e,t){const n=kh.get(e);return n&&n.get(t)}function _u(e){const t=ii(e);return t===e?t:(ls(t,"iterate",Lc),No(e)?t:t.map(us))}function Wh(e){return ls(e=ii(e),"iterate",Lc),e}const jv={__proto__:null,[Symbol.iterator](){return Sd(this,Symbol.iterator,us)},concat(...e){return _u(this).concat(...e.map(t=>yn(t)?_u(t):t))},entries(){return Sd(this,"entries",e=>(e[1]=us(e[1]),e))},every(e,t){return Za(this,"every",e,t,void 0,arguments)},filter(e,t){return Za(this,"filter",e,t,n=>n.map(us),arguments)},find(e,t){return Za(this,"find",e,t,us,arguments)},findIndex(e,t){return Za(this,"findIndex",e,t,void 0,arguments)},findLast(e,t){return Za(this,"findLast",e,t,us,arguments)},findLastIndex(e,t){return Za(this,"findLastIndex",e,t,void 0,arguments)},forEach(e,t){return Za(this,"forEach",e,t,void 0,arguments)},includes(...e){return Ad(this,"includes",e)},indexOf(...e){return Ad(this,"indexOf",e)},join(e){return _u(this).join(e)},lastIndexOf(...e){return Ad(this,"lastIndexOf",e)},map(e,t){return Za(this,"map",e,t,void 0,arguments)},pop(){return Xu(this,"pop")},push(...e){return Xu(this,"push",e)},reduce(e,...t){return Ep(this,"reduce",e,t)},reduceRight(e,...t){return Ep(this,"reduceRight",e,t)},shift(){return Xu(this,"shift")},some(e,t){return Za(this,"some",e,t,void 0,arguments)},splice(...e){return Xu(this,"splice",e)},toReversed(){return _u(this).toReversed()},toSorted(e){return _u(this).toSorted(e)},toSpliced(...e){return _u(this).toSpliced(...e)},unshift(...e){return Xu(this,"unshift",e)},values(){return Sd(this,"values",us)}};function Sd(e,t,n){const i=Wh(e),o=i[t]();return i!==e&&!No(e)&&(o._next=o.next,o.next=()=>{const a=o._next();return a.value&&(a.value=n(a.value)),a}),o}const zv=Array.prototype;function Za(e,t,n,i,o,a){const u=Wh(e),d=u!==e&&!No(e),f=u[t];if(f!==zv[t]){const x=f.apply(e,a);return d?us(x):x}let m=n;u!==e&&(d?m=function(x,k){return n.call(this,us(x),k,e)}:n.length>2&&(m=function(x,k){return n.call(this,x,k,e)}));const y=f.call(u,m,i);return d&&o?o(y):y}function Ep(e,t,n,i){const o=Wh(e);let a=n;return o!==e&&(No(e)?n.length>3&&(a=function(u,d,f){return n.call(this,u,d,f,e)}):a=function(u,d,f){return n.call(this,u,us(d),f,e)}),o[t](a,...i)}function Ad(e,t,n){const i=ii(e);ls(i,"iterate",Lc);const o=i[t](...n);return(o===-1||o===!1)&&Xf(n[0])?(n[0]=ii(n[0]),i[t](...n)):o}function Xu(e,t,n=[]){Ol(),Hf();const i=ii(e)[t].apply(e,n);return Wf(),Il(),i}const Uv=Uf("__proto__,__v_isRef,__isVue"),Gg=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(Ta));function $v(e){Ta(e)||(e=String(e));const t=ii(this);return ls(t,"has",e),t.hasOwnProperty(e)}class Hg{constructor(t=!1,n=!1){this._isReadonly=t,this._isShallow=n}get(t,n,i){if(n==="__v_skip")return t.__v_skip;const o=this._isReadonly,a=this._isShallow;if(n==="__v_isReactive")return!o;if(n==="__v_isReadonly")return o;if(n==="__v_isShallow")return a;if(n==="__v_raw")return i===(o?a?Xv:Yg:a?Kg:Zg).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(i)?t:void 0;const u=yn(t);if(!o){let f;if(u&&(f=jv[n]))return f;if(n==="hasOwnProperty")return $v}const d=Reflect.get(t,n,sr(t)?t:i);return(Ta(n)?Gg.has(n):Uv(n))||(o||ls(t,"get",n),a)?d:sr(d)?u&&Vf(n)?d:d.value:ki(d)?o?Xg(d):il(d):d}}class Wg extends Hg{constructor(t=!1){super(!1,t)}set(t,n,i,o){let a=t[n];if(!this._isShallow){const f=ou(a);if(!No(i)&&!ou(i)&&(a=ii(a),i=ii(i)),!yn(t)&&sr(a)&&!sr(i))return f?!1:(a.value=i,!0)}const u=yn(t)&&Vf(n)?Number(n)<t.length:fi(t,n),d=Reflect.set(t,n,i,sr(t)?t:o);return t===ii(o)&&(u?Ml(i,a)&&Qa(t,"set",n,i):Qa(t,"add",n,i)),d}deleteProperty(t,n){const i=fi(t,n);t[n];const o=Reflect.deleteProperty(t,n);return o&&i&&Qa(t,"delete",n,void 0),o}has(t,n){const i=Reflect.has(t,n);return(!Ta(n)||!Gg.has(n))&&ls(t,"has",n),i}ownKeys(t){return ls(t,"iterate",yn(t)?"length":tu),Reflect.ownKeys(t)}}class qv extends Hg{constructor(t=!1){super(!0,t)}set(t,n){return!0}deleteProperty(t,n){return!0}}const Vv=new Wg,Gv=new qv,Hv=new Wg(!0);const rf=e=>e,Xc=e=>Reflect.getPrototypeOf(e);function Wv(e,t,n){return function(...i){const o=this.__v_raw,a=ii(o),u=Nu(a),d=e==="entries"||e===Symbol.iterator&&u,f=e==="keys"&&u,m=o[e](...i),y=n?rf:t?sf:us;return!t&&ls(a,"iterate",f?nf:tu),{next(){const{value:x,done:k}=m.next();return k?{value:x,done:k}:{value:d?[y(x[0]),y(x[1])]:y(x),done:k}},[Symbol.iterator](){return this}}}}function Qc(e){return function(...t){return e==="delete"?!1:e==="clear"?void 0:this}}function Zv(e,t){const n={get(o){const a=this.__v_raw,u=ii(a),d=ii(o);e||(Ml(o,d)&&ls(u,"get",o),ls(u,"get",d));const{has:f}=Xc(u),m=t?rf:e?sf:us;if(f.call(u,o))return m(a.get(o));if(f.call(u,d))return m(a.get(d));a!==u&&a.get(o)},get size(){const o=this.__v_raw;return!e&&ls(ii(o),"iterate",tu),Reflect.get(o,"size",o)},has(o){const a=this.__v_raw,u=ii(a),d=ii(o);return e||(Ml(o,d)&&ls(u,"has",o),ls(u,"has",d)),o===d?a.has(o):a.has(o)||a.has(d)},forEach(o,a){const u=this,d=u.__v_raw,f=ii(d),m=t?rf:e?sf:us;return!e&&ls(f,"iterate",tu),d.forEach((y,x)=>o.call(a,m(y),m(x),u))}};return Fr(n,e?{add:Qc("add"),set:Qc("set"),delete:Qc("delete"),clear:Qc("clear")}:{add(o){!t&&!No(o)&&!ou(o)&&(o=ii(o));const a=ii(this);return Xc(a).has.call(a,o)||(a.add(o),Qa(a,"add",o,o)),this},set(o,a){!t&&!No(a)&&!ou(a)&&(a=ii(a));const u=ii(this),{has:d,get:f}=Xc(u);let m=d.call(u,o);m||(o=ii(o),m=d.call(u,o));const y=f.call(u,o);return u.set(o,a),m?Ml(a,y)&&Qa(u,"set",o,a):Qa(u,"add",o,a),this},delete(o){const a=ii(this),{has:u,get:d}=Xc(a);let f=u.call(a,o);f||(o=ii(o),f=u.call(a,o)),d&&d.call(a,o);const m=a.delete(o);return f&&Qa(a,"delete",o,void 0),m},clear(){const o=ii(this),a=o.size!==0,u=o.clear();return a&&Qa(o,"clear",void 0,void 0),u}}),["keys","values","entries",Symbol.iterator].forEach(o=>{n[o]=Wv(o,e,t)}),n}function Yf(e,t){const n=Zv(e,t);return(i,o,a)=>o==="__v_isReactive"?!e:o==="__v_isReadonly"?e:o==="__v_raw"?i:Reflect.get(fi(n,o)&&o in i?n:i,o,a)}const Kv={get:Yf(!1,!1)},Yv={get:Yf(!1,!0)},Jv={get:Yf(!0,!1)};const Zg=new WeakMap,Kg=new WeakMap,Yg=new WeakMap,Xv=new WeakMap;function Qv(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function ey(e){return e.__v_skip||!Object.isExtensible(e)?0:Qv(Cv(e))}function il(e){return ou(e)?e:Jf(e,!1,Vv,Kv,Zg)}function Jg(e){return Jf(e,!1,Hv,Yv,Kg)}function Xg(e){return Jf(e,!0,Gv,Jv,Yg)}function Jf(e,t,n,i,o){if(!ki(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const a=o.get(e);if(a)return a;const u=ey(e);if(u===0)return e;const d=new Proxy(e,u===2?i:n);return o.set(e,d),d}function Bl(e){return ou(e)?Bl(e.__v_raw):!!(e&&e.__v_isReactive)}function ou(e){return!!(e&&e.__v_isReadonly)}function No(e){return!!(e&&e.__v_isShallow)}function Xf(e){return e?!!e.__v_raw:!1}function ii(e){const t=e&&e.__v_raw;return t?ii(t):e}function Qf(e){return!fi(e,"__v_skip")&&Object.isExtensible(e)&&Mg(e,"__v_skip",!0),e}const us=e=>ki(e)?il(e):e,sf=e=>ki(e)?Xg(e):e;function sr(e){return e?e.__v_isRef===!0:!1}function Nt(e){return Qg(e,!1)}function ty(e){return Qg(e,!0)}function Qg(e,t){return sr(e)?e:new ny(e,t)}class ny{constructor(t,n){this.dep=new Kf,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=n?t:ii(t),this._value=n?t:us(t),this.__v_isShallow=n}get value(){return this.dep.track(),this._value}set value(t){const n=this._rawValue,i=this.__v_isShallow||No(t)||ou(t);t=i?t:ii(t),Ml(t,n)&&(this._rawValue=t,this._value=i?t:us(t),this.dep.trigger())}}function vn(e){return sr(e)?e.value:e}const iy={get:(e,t,n)=>t==="__v_raw"?e:vn(Reflect.get(e,t,n)),set:(e,t,n,i)=>{const o=e[t];return sr(o)&&!sr(n)?(o.value=n,!0):Reflect.set(e,t,n,i)}};function em(e){return Bl(e)?e:new Proxy(e,iy)}function ry(e){const t=yn(e)?new Array(e.length):{};for(const n in e)t[n]=oy(e,n);return t}class sy{constructor(t,n,i){this._object=t,this._key=n,this._defaultValue=i,this.__v_isRef=!0,this._value=void 0}get value(){const t=this._object[this._key];return this._value=t===void 0?this._defaultValue:t}set value(t){this._object[this._key]=t}get dep(){return Fv(ii(this._object),this._key)}}function oy(e,t,n){const i=e[t];return sr(i)?i:new sy(e,t,n)}class ay{constructor(t,n,i){this.fn=t,this.setter=n,this._value=void 0,this.dep=new Kf(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=xc-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!n,this.isSSR=i}notify(){if(this.flags|=16,!(this.flags&8)&&Mi!==this)return jg(this,!0),!0}get value(){const t=this.dep.track();return $g(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function ly(e,t,n=!1){let i,o;return Nn(e)?i=e:(i=e.get,o=e.set),new ay(i,o,n)}const eh={},Eh=new WeakMap;let Zl;function uy(e,t=!1,n=Zl){if(n){let i=Eh.get(n);i||Eh.set(n,i=[]),i.push(e)}}function cy(e,t,n=Ci){const{immediate:i,deep:o,once:a,scheduler:u,augmentJob:d,call:f}=n,m=we=>o?we:No(we)||o===!1||o===0?el(we,1):el(we);let y,x,k,b,T=!1,$=!1;if(sr(e)?(x=()=>e.value,T=No(e)):Bl(e)?(x=()=>m(e),T=!0):yn(e)?($=!0,T=e.some(we=>Bl(we)||No(we)),x=()=>e.map(we=>{if(sr(we))return we.value;if(Bl(we))return m(we);if(Nn(we))return f?f(we,2):we()})):Nn(e)?t?x=f?()=>f(e,2):e:x=()=>{if(k){Ol();try{k()}finally{Il()}}const we=Zl;Zl=y;try{return f?f(e,3,[b]):e(b)}finally{Zl=we}}:x=Ma,t&&o){const we=x,Be=o===!0?1/0:o;x=()=>el(we(),Be)}const H=Og(),I=()=>{y.stop(),H&&H.active&&qf(H.effects,y)};if(a&&t){const we=t;t=(...Be)=>{we(...Be),I()}}let Q=$?new Array(e.length).fill(eh):eh;const se=we=>{if(!(!(y.flags&1)||!y.dirty&&!we))if(t){const Be=y.run();if(o||T||($?Be.some(($e,Ue)=>Ml($e,Q[Ue])):Ml(Be,Q))){k&&k();const $e=Zl;Zl=y;try{const Ue=[Be,Q===eh?void 0:$&&Q[0]===eh?[]:Q,b];f?f(t,3,Ue):t(...Ue),Q=Be}finally{Zl=$e}}}else y.run()};return d&&d(se),y=new Ig(x),y.scheduler=u?()=>u(se,!1):se,b=we=>uy(we,!1,y),k=y.onStop=()=>{const we=Eh.get(y);if(we){if(f)f(we,4);else for(const Be of we)Be();Eh.delete(y)}},t?i?se(!0):Q=y.run():u?u(se.bind(null,!0),!0):y.run(),I.pause=y.pause.bind(y),I.resume=y.resume.bind(y),I.stop=I,I}function el(e,t=1/0,n){if(t<=0||!ki(e)||e.__v_skip||(n=n||new Set,n.has(e)))return e;if(n.add(e),t--,sr(e))el(e.value,t,n);else if(yn(e))for(let i=0;i<e.length;i++)el(e[i],t,n);else if(qu(e)||Nu(e))e.forEach(i=>{el(i,t,n)});else if(Ag(e)){for(const i in e)el(e[i],t,n);for(const i of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,i)&&el(e[i],t,n)}return e}/**
* @vue/runtime-core v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Ic(e,t,n,i){try{return i?e(...i):e()}catch(o){Zh(o,t,n)}}function ia(e,t,n,i){if(Nn(e)){const o=Ic(e,t,n,i);return o&&Eg(o)&&o.catch(a=>{Zh(a,t,n)}),o}if(yn(e)){const o=[];for(let a=0;a<e.length;a++)o.push(ia(e[a],t,n,i));return o}}function Zh(e,t,n,i=!0){const o=t?t.vnode:null,{errorHandler:a,throwUnhandledErrorInProduction:u}=t&&t.appContext.config||Ci;if(t){let d=t.parent;const f=t.proxy,m=`https://vuejs.org/error-reference/#runtime-${n}`;for(;d;){const y=d.ec;if(y){for(let x=0;x<y.length;x++)if(y[x](e,f,m)===!1)return}d=d.parent}if(a){Ol(),Ic(a,null,10,[e,f,m]),Il();return}}hy(e,n,o,i,u)}function hy(e,t,n,i=!0,o=!1){if(o)throw e;console.error(e)}const Ps=[];let Ea=-1;const Du=[];let Ll=null,Cu=0;const tm=Promise.resolve();let Sh=null;function bi(e){const t=Sh||tm;return e?t.then(this?e.bind(this):e):t}function dy(e){let t=Ea+1,n=Ps.length;for(;t<n;){const i=t+n>>>1,o=Ps[i],a=Cc(o);a<e||a===e&&o.flags&2?t=i+1:n=i}return t}function ep(e){if(!(e.flags&1)){const t=Cc(e),n=Ps[Ps.length-1];!n||!(e.flags&2)&&t>=Cc(n)?Ps.push(e):Ps.splice(dy(t),0,e),e.flags|=1,nm()}}function nm(){Sh||(Sh=tm.then(rm))}function fy(e){yn(e)?Du.push(...e):Ll&&e.id===-1?Ll.splice(Cu+1,0,e):e.flags&1||(Du.push(e),e.flags|=1),nm()}function Sp(e,t,n=Ea+1){for(;n<Ps.length;n++){const i=Ps[n];if(i&&i.flags&2){if(e&&i.id!==e.uid)continue;Ps.splice(n,1),n--,i.flags&4&&(i.flags&=-2),i(),i.flags&4||(i.flags&=-2)}}}function im(e){if(Du.length){const t=[...new Set(Du)].sort((n,i)=>Cc(n)-Cc(i));if(Du.length=0,Ll){Ll.push(...t);return}for(Ll=t,Cu=0;Cu<Ll.length;Cu++){const n=Ll[Cu];n.flags&4&&(n.flags&=-2),n.flags&8||n(),n.flags&=-2}Ll=null,Cu=0}}const Cc=e=>e.id==null?e.flags&2?-1:1/0:e.id;function rm(e){try{for(Ea=0;Ea<Ps.length;Ea++){const t=Ps[Ea];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),Ic(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;Ea<Ps.length;Ea++){const t=Ps[Ea];t&&(t.flags&=-2)}Ea=-1,Ps.length=0,im(),Sh=null,(Ps.length||Du.length)&&rm()}}let ks=null,sm=null;function Ah(e){const t=ks;return ks=e,sm=e&&e.type.__scopeId||null,t}function ea(e,t=ks,n){if(!t||e._n)return e;const i=(...o)=>{i._d&&jp(-1);const a=Ah(t);let u;try{u=e(...o)}finally{Ah(a),i._d&&jp(1)}return u};return i._n=!0,i._c=!0,i._d=!0,i}function cn(e,t){if(ks===null)return e;const n=ed(ks),i=e.dirs||(e.dirs=[]);for(let o=0;o<t.length;o++){let[a,u,d,f=Ci]=t[o];a&&(Nn(a)&&(a={mounted:a,updated:a}),a.deep&&el(u),i.push({dir:a,instance:n,value:u,oldValue:void 0,arg:d,modifiers:f}))}return e}function Vl(e,t,n,i){const o=e.dirs,a=t&&t.dirs;for(let u=0;u<o.length;u++){const d=o[u];a&&(d.oldValue=a[u].value);let f=d.dir[i];f&&(Ol(),ia(f,n,8,[e.el,d,e,t]),Il())}}const py=Symbol("_vte"),om=e=>e.__isTeleport,Cl=Symbol("_leaveCb"),th=Symbol("_enterCb");function gy(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return ra(()=>{e.isMounted=!0}),Jh(()=>{e.isUnmounting=!0}),e}const Mo=[Function,Array],am={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Mo,onEnter:Mo,onAfterEnter:Mo,onEnterCancelled:Mo,onBeforeLeave:Mo,onLeave:Mo,onAfterLeave:Mo,onLeaveCancelled:Mo,onBeforeAppear:Mo,onAppear:Mo,onAfterAppear:Mo,onAppearCancelled:Mo},lm=e=>{const t=e.subTree;return t.component?lm(t.component):t},my={name:"BaseTransition",props:am,setup(e,{slots:t}){const n=p2(),i=gy();return()=>{const o=t.default&&hm(t.default(),!0);if(!o||!o.length)return;const a=um(o),u=ii(e),{mode:d}=u;if(i.isLeaving)return Md(a);const f=Ap(a);if(!f)return Md(a);let m=of(f,u,i,n,x=>m=x);f.type!==Vs&&Pc(f,m);let y=n.subTree&&Ap(n.subTree);if(y&&y.type!==Vs&&!Yl(f,y)&&lm(n).type!==Vs){let x=of(y,u,i,n);if(Pc(y,x),d==="out-in"&&f.type!==Vs)return i.isLeaving=!0,x.afterLeave=()=>{i.isLeaving=!1,n.job.flags&8||n.update(),delete x.afterLeave,y=void 0},Md(a);d==="in-out"&&f.type!==Vs?x.delayLeave=(k,b,T)=>{const $=cm(i,y);$[String(y.key)]=y,k[Cl]=()=>{b(),k[Cl]=void 0,delete m.delayedLeave,y=void 0},m.delayedLeave=()=>{T(),delete m.delayedLeave,y=void 0}}:y=void 0}else y&&(y=void 0);return a}}};function um(e){let t=e[0];if(e.length>1){for(const n of e)if(n.type!==Vs){t=n;break}}return t}const vy=my;function cm(e,t){const{leavingVNodes:n}=e;let i=n.get(t.type);return i||(i=Object.create(null),n.set(t.type,i)),i}function of(e,t,n,i,o){const{appear:a,mode:u,persisted:d=!1,onBeforeEnter:f,onEnter:m,onAfterEnter:y,onEnterCancelled:x,onBeforeLeave:k,onLeave:b,onAfterLeave:T,onLeaveCancelled:$,onBeforeAppear:H,onAppear:I,onAfterAppear:Q,onAppearCancelled:se}=t,we=String(e.key),Be=cm(n,e),$e=(Te,He)=>{Te&&ia(Te,i,9,He)},Ue=(Te,He)=>{const ae=He[1];$e(Te,He),yn(Te)?Te.every(re=>re.length<=1)&&ae():Te.length<=1&&ae()},Pe={mode:u,persisted:d,beforeEnter(Te){let He=f;if(!n.isMounted)if(a)He=H||f;else return;Te[Cl]&&Te[Cl](!0);const ae=Be[we];ae&&Yl(e,ae)&&ae.el[Cl]&&ae.el[Cl](),$e(He,[Te])},enter(Te){let He=m,ae=y,re=x;if(!n.isMounted)if(a)He=I||m,ae=Q||y,re=se||x;else return;let oe=!1;const Y=Te[th]=C=>{oe||(oe=!0,C?$e(re,[Te]):$e(ae,[Te]),Pe.delayedLeave&&Pe.delayedLeave(),Te[th]=void 0)};He?Ue(He,[Te,Y]):Y()},leave(Te,He){const ae=String(e.key);if(Te[th]&&Te[th](!0),n.isUnmounting)return He();$e(k,[Te]);let re=!1;const oe=Te[Cl]=Y=>{re||(re=!0,He(),Y?$e($,[Te]):$e(T,[Te]),Te[Cl]=void 0,Be[ae]===e&&delete Be[ae])};Be[ae]=e,b?Ue(b,[Te,oe]):oe()},clone(Te){const He=of(Te,t,n,i,o);return o&&o(He),He}};return Pe}function Md(e){if(Kh(e))return e=Tl(e),e.children=null,e}function Ap(e){if(!Kh(e))return om(e.type)&&e.children?um(e.children):e;const{shapeFlag:t,children:n}=e;if(n){if(t&16)return n[0];if(t&32&&Nn(n.default))return n.default()}}function Pc(e,t){e.shapeFlag&6&&e.component?(e.transition=t,Pc(e.component.subTree,t)):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function hm(e,t=!1,n){let i=[],o=0;for(let a=0;a<e.length;a++){let u=e[a];const d=n==null?u.key:String(n)+String(u.key!=null?u.key:a);u.type===Qt?(u.patchFlag&128&&o++,i=i.concat(hm(u.children,t,d))):(t||u.type!==Vs)&&i.push(d!=null?Tl(u,{key:d}):u)}if(o>1)for(let a=0;a<i.length;a++)i[a].patchFlag=-2;return i}/*! #__NO_SIDE_EFFECTS__ */function Hs(e,t){return Nn(e)?Fr({name:e.name},t,{setup:e}):e}function dm(e){e.ids=[e.ids[0]+e.ids[2]+++"-",0,0]}function Mh(e,t,n,i,o=!1){if(yn(e)){e.forEach((T,$)=>Mh(T,t&&(yn(t)?t[$]:t),n,i,o));return}if(dc(i)&&!o){i.shapeFlag&512&&i.type.__asyncResolved&&i.component.subTree.component&&Mh(e,t,n,i.component.subTree);return}const a=i.shapeFlag&4?ed(i.component):i.el,u=o?null:a,{i:d,r:f}=e,m=t&&t.r,y=d.refs===Ci?d.refs={}:d.refs,x=d.setupState,k=ii(x),b=x===Ci?()=>!1:T=>fi(k,T);if(m!=null&&m!==f&&(or(m)?(y[m]=null,b(m)&&(x[m]=null)):sr(m)&&(m.value=null)),Nn(f))Ic(f,d,12,[u,y]);else{const T=or(f),$=sr(f);if(T||$){const H=()=>{if(e.f){const I=T?b(f)?x[f]:y[f]:f.value;o?yn(I)&&qf(I,a):yn(I)?I.includes(a)||I.push(a):T?(y[f]=[a],b(f)&&(x[f]=y[f])):(f.value=[a],e.k&&(y[e.k]=f.value))}else T?(y[f]=u,b(f)&&(x[f]=u)):$&&(f.value=u,e.k&&(y[e.k]=u))};u?(H.id=-1,lo(H,n)):H()}}}Hh().requestIdleCallback;Hh().cancelIdleCallback;const dc=e=>!!e.type.__asyncLoader,Kh=e=>e.type.__isKeepAlive;function yy(e,t){fm(e,"a",t)}function _y(e,t){fm(e,"da",t)}function fm(e,t,n=Ir){const i=e.__wdc||(e.__wdc=()=>{let o=n;for(;o;){if(o.isDeactivated)return;o=o.parent}return e()});if(Yh(t,i,n),n){let o=n.parent;for(;o&&o.parent;)Kh(o.parent.vnode)&&by(i,t,n,o),o=o.parent}}function by(e,t,n,i){const o=Yh(t,e,i,!0);Fc(()=>{qf(i[t],o)},n)}function Yh(e,t,n=Ir,i=!1){if(n){const o=n[e]||(n[e]=[]),a=t.__weh||(t.__weh=(...u)=>{Ol();const d=jc(n),f=ia(t,n,e,u);return d(),Il(),f});return i?o.unshift(a):o.push(a),a}}const rl=e=>(t,n=Ir)=>{(!Ec||e==="sp")&&Yh(e,(...i)=>t(...i),n)},wy=rl("bm"),ra=rl("m"),xy=rl("bu"),Ly=rl("u"),Jh=rl("bum"),Fc=rl("um"),Cy=rl("sp"),Py=rl("rtg"),ky=rl("rtc");function Ey(e,t=Ir){Yh("ec",e,t)}const Sy="components";function Ay(e,t){return By(Sy,e,!0,t)||e}const My=Symbol.for("v-ndc");function By(e,t,n=!0,i=!1){const o=ks||Ir;if(o){const a=o.type;{const d=_2(a,!1);if(d&&(d===t||d===Oo(t)||d===Gh(Oo(t))))return a}const u=Mp(o[e]||a[e],t)||Mp(o.appContext[e],t);return!u&&i?a:u}}function Mp(e,t){return e&&(e[t]||e[Oo(t)]||e[Gh(Oo(t))])}function Mn(e,t,n,i){let o;const a=n,u=yn(e);if(u||or(e)){const d=u&&Bl(e);let f=!1;d&&(f=!No(e),e=Wh(e)),o=new Array(e.length);for(let m=0,y=e.length;m<y;m++)o[m]=t(f?us(e[m]):e[m],m,void 0,a)}else if(typeof e=="number"){o=new Array(e);for(let d=0;d<e;d++)o[d]=t(d+1,d,void 0,a)}else if(ki(e))if(e[Symbol.iterator])o=Array.from(e,(d,f)=>t(d,f,void 0,a));else{const d=Object.keys(e);o=new Array(d.length);for(let f=0,m=d.length;f<m;f++){const y=d[f];o[f]=t(e[y],y,f,a)}}else o=[];return o}const af=e=>e?Nm(e)?ed(e):af(e.parent):null,fc=Fr(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>af(e.parent),$root:e=>af(e.root),$host:e=>e.ce,$emit:e=>e.emit,$options:e=>gm(e),$forceUpdate:e=>e.f||(e.f=()=>{ep(e.update)}),$nextTick:e=>e.n||(e.n=bi.bind(e.proxy)),$watch:e=>Qy.bind(e)}),Bd=(e,t)=>e!==Ci&&!e.__isScriptSetup&&fi(e,t),Ty={get({_:e},t){if(t==="__v_skip")return!0;const{ctx:n,setupState:i,data:o,props:a,accessCache:u,type:d,appContext:f}=e;let m;if(t[0]!=="$"){const b=u[t];if(b!==void 0)switch(b){case 1:return i[t];case 2:return o[t];case 4:return n[t];case 3:return a[t]}else{if(Bd(i,t))return u[t]=1,i[t];if(o!==Ci&&fi(o,t))return u[t]=2,o[t];if((m=e.propsOptions[0])&&fi(m,t))return u[t]=3,a[t];if(n!==Ci&&fi(n,t))return u[t]=4,n[t];lf&&(u[t]=0)}}const y=fc[t];let x,k;if(y)return t==="$attrs"&&ls(e.attrs,"get",""),y(e);if((x=d.__cssModules)&&(x=x[t]))return x;if(n!==Ci&&fi(n,t))return u[t]=4,n[t];if(k=f.config.globalProperties,fi(k,t))return k[t]},set({_:e},t,n){const{data:i,setupState:o,ctx:a}=e;return Bd(o,t)?(o[t]=n,!0):i!==Ci&&fi(i,t)?(i[t]=n,!0):fi(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(a[t]=n,!0)},has({_:{data:e,setupState:t,accessCache:n,ctx:i,appContext:o,propsOptions:a}},u){let d;return!!n[u]||e!==Ci&&fi(e,u)||Bd(t,u)||(d=a[0])&&fi(d,u)||fi(i,u)||fi(fc,u)||fi(o.config.globalProperties,u)},defineProperty(e,t,n){return n.get!=null?e._.accessCache[t]=0:fi(n,"value")&&this.set(e,t,n.value,null),Reflect.defineProperty(e,t,n)}};function Bp(e){return yn(e)?e.reduce((t,n)=>(t[n]=null,t),{}):e}let lf=!0;function Ny(e){const t=gm(e),n=e.proxy,i=e.ctx;lf=!1,t.beforeCreate&&Tp(t.beforeCreate,e,"bc");const{data:o,computed:a,methods:u,watch:d,provide:f,inject:m,created:y,beforeMount:x,mounted:k,beforeUpdate:b,updated:T,activated:$,deactivated:H,beforeDestroy:I,beforeUnmount:Q,destroyed:se,unmounted:we,render:Be,renderTracked:$e,renderTriggered:Ue,errorCaptured:Pe,serverPrefetch:Te,expose:He,inheritAttrs:ae,components:re,directives:oe,filters:Y}=t;if(m&&Dy(m,i,null),u)for(const K in u){const J=u[K];Nn(J)&&(i[K]=J.bind(n))}if(o){const K=o.call(n,n);ki(K)&&(e.data=il(K))}if(lf=!0,a)for(const K in a){const J=a[K],Ee=Nn(J)?J.bind(n,n):Nn(J.get)?J.get.bind(n,n):Ma,ue=!Nn(J)&&Nn(J.set)?J.set.bind(n):Ma,ye=Un({get:Ee,set:ue});Object.defineProperty(i,K,{enumerable:!0,configurable:!0,get:()=>ye.value,set:O=>ye.value=O})}if(d)for(const K in d)pm(d[K],i,n,K);if(f){const K=Nn(f)?f.call(n):f;Reflect.ownKeys(K).forEach(J=>{ch(J,K[J])})}y&&Tp(y,e,"c");function N(K,J){yn(J)?J.forEach(Ee=>K(Ee.bind(n))):J&&K(J.bind(n))}if(N(wy,x),N(ra,k),N(xy,b),N(Ly,T),N(yy,$),N(_y,H),N(Ey,Pe),N(ky,$e),N(Py,Ue),N(Jh,Q),N(Fc,we),N(Cy,Te),yn(He))if(He.length){const K=e.exposed||(e.exposed={});He.forEach(J=>{Object.defineProperty(K,J,{get:()=>n[J],set:Ee=>n[J]=Ee})})}else e.exposed||(e.exposed={});Be&&e.render===Ma&&(e.render=Be),ae!=null&&(e.inheritAttrs=ae),re&&(e.components=re),oe&&(e.directives=oe),Te&&dm(e)}function Dy(e,t,n=Ma){yn(e)&&(e=uf(e));for(const i in e){const o=e[i];let a;ki(o)?"default"in o?a=Do(o.from||i,o.default,!0):a=Do(o.from||i):a=Do(o),sr(a)?Object.defineProperty(t,i,{enumerable:!0,configurable:!0,get:()=>a.value,set:u=>a.value=u}):t[i]=a}}function Tp(e,t,n){ia(yn(e)?e.map(i=>i.bind(t.proxy)):e.bind(t.proxy),t,n)}function pm(e,t,n,i){let o=i.includes(".")?Sm(n,i):()=>n[i];if(or(e)){const a=t[e];Nn(a)&&Ki(o,a)}else if(Nn(e))Ki(o,e.bind(n));else if(ki(e))if(yn(e))e.forEach(a=>pm(a,t,n,i));else{const a=Nn(e.handler)?e.handler.bind(n):t[e.handler];Nn(a)&&Ki(o,a,e)}}function gm(e){const t=e.type,{mixins:n,extends:i}=t,{mixins:o,optionsCache:a,config:{optionMergeStrategies:u}}=e.appContext,d=a.get(t);let f;return d?f=d:!o.length&&!n&&!i?f=t:(f={},o.length&&o.forEach(m=>Bh(f,m,u,!0)),Bh(f,t,u)),ki(t)&&a.set(t,f),f}function Bh(e,t,n,i=!1){const{mixins:o,extends:a}=t;a&&Bh(e,a,n,!0),o&&o.forEach(u=>Bh(e,u,n,!0));for(const u in t)if(!(i&&u==="expose")){const d=Ry[u]||n&&n[u];e[u]=d?d(e[u],t[u]):t[u]}return e}const Ry={data:Np,props:Dp,emits:Dp,methods:ac,computed:ac,beforeCreate:xs,created:xs,beforeMount:xs,mounted:xs,beforeUpdate:xs,updated:xs,beforeDestroy:xs,beforeUnmount:xs,destroyed:xs,unmounted:xs,activated:xs,deactivated:xs,errorCaptured:xs,serverPrefetch:xs,components:ac,directives:ac,watch:Iy,provide:Np,inject:Oy};function Np(e,t){return t?e?function(){return Fr(Nn(e)?e.call(this,this):e,Nn(t)?t.call(this,this):t)}:t:e}function Oy(e,t){return ac(uf(e),uf(t))}function uf(e){if(yn(e)){const t={};for(let n=0;n<e.length;n++)t[e[n]]=e[n];return t}return e}function xs(e,t){return e?[...new Set([].concat(e,t))]:t}function ac(e,t){return e?Fr(Object.create(null),e,t):t}function Dp(e,t){return e?yn(e)&&yn(t)?[...new Set([...e,...t])]:Fr(Object.create(null),Bp(e),Bp(t??{})):t}function Iy(e,t){if(!e)return t;if(!t)return e;const n=Fr(Object.create(null),e);for(const i in t)n[i]=xs(e[i],t[i]);return n}function mm(){return{app:null,config:{isNativeTag:xv,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Fy=0;function jy(e,t){return function(i,o=null){Nn(i)||(i=Fr({},i)),o!=null&&!ki(o)&&(o=null);const a=mm(),u=new WeakSet,d=[];let f=!1;const m=a.app={_uid:Fy++,_component:i,_props:o,_container:null,_context:a,_instance:null,version:w2,get config(){return a.config},set config(y){},use(y,...x){return u.has(y)||(y&&Nn(y.install)?(u.add(y),y.install(m,...x)):Nn(y)&&(u.add(y),y(m,...x))),m},mixin(y){return a.mixins.includes(y)||a.mixins.push(y),m},component(y,x){return x?(a.components[y]=x,m):a.components[y]},directive(y,x){return x?(a.directives[y]=x,m):a.directives[y]},mount(y,x,k){if(!f){const b=m._ceVNode||Pi(i,o);return b.appContext=a,k===!0?k="svg":k===!1&&(k=void 0),e(b,y,k),f=!0,m._container=y,y.__vue_app__=m,ed(b.component)}},onUnmount(y){d.push(y)},unmount(){f&&(ia(d,m._instance,16),e(null,m._container),delete m._container.__vue_app__)},provide(y,x){return a.provides[y]=x,m},runWithContext(y){const x=nu;nu=m;try{return y()}finally{nu=x}}};return m}}let nu=null;function ch(e,t){if(Ir){let n=Ir.provides;const i=Ir.parent&&Ir.parent.provides;i===n&&(n=Ir.provides=Object.create(i)),n[e]=t}}function Do(e,t,n=!1){const i=Ir||ks;if(i||nu){const o=nu?nu._context.provides:i?i.parent==null?i.vnode.appContext&&i.vnode.appContext.provides:i.parent.provides:void 0;if(o&&e in o)return o[e];if(arguments.length>1)return n&&Nn(t)?t.call(i&&i.proxy):t}}function zy(){return!!(Ir||ks||nu)}const vm={},ym=()=>Object.create(vm),_m=e=>Object.getPrototypeOf(e)===vm;function Uy(e,t,n,i=!1){const o={},a=ym();e.propsDefaults=Object.create(null),bm(e,t,o,a);for(const u in e.propsOptions[0])u in o||(o[u]=void 0);n?e.props=i?o:Jg(o):e.type.props?e.props=o:e.props=a,e.attrs=a}function $y(e,t,n,i){const{props:o,attrs:a,vnode:{patchFlag:u}}=e,d=ii(o),[f]=e.propsOptions;let m=!1;if((i||u>0)&&!(u&16)){if(u&8){const y=e.vnode.dynamicProps;for(let x=0;x<y.length;x++){let k=y[x];if(Xh(e.emitsOptions,k))continue;const b=t[k];if(f)if(fi(a,k))b!==a[k]&&(a[k]=b,m=!0);else{const T=Oo(k);o[T]=cf(f,d,T,b,e,!1)}else b!==a[k]&&(a[k]=b,m=!0)}}}else{bm(e,t,o,a)&&(m=!0);let y;for(const x in d)(!t||!fi(t,x)&&((y=uu(x))===x||!fi(t,y)))&&(f?n&&(n[x]!==void 0||n[y]!==void 0)&&(o[x]=cf(f,d,x,void 0,e,!0)):delete o[x]);if(a!==d)for(const x in a)(!t||!fi(t,x))&&(delete a[x],m=!0)}m&&Qa(e.attrs,"set","")}function bm(e,t,n,i){const[o,a]=e.propsOptions;let u=!1,d;if(t)for(let f in t){if(uc(f))continue;const m=t[f];let y;o&&fi(o,y=Oo(f))?!a||!a.includes(y)?n[y]=m:(d||(d={}))[y]=m:Xh(e.emitsOptions,f)||(!(f in i)||m!==i[f])&&(i[f]=m,u=!0)}if(a){const f=ii(n),m=d||Ci;for(let y=0;y<a.length;y++){const x=a[y];n[x]=cf(o,f,x,m[x],e,!fi(m,x))}}return u}function cf(e,t,n,i,o,a){const u=e[n];if(u!=null){const d=fi(u,"default");if(d&&i===void 0){const f=u.default;if(u.type!==Function&&!u.skipFactory&&Nn(f)){const{propsDefaults:m}=o;if(n in m)i=m[n];else{const y=jc(o);i=m[n]=f.call(null,t),y()}}else i=f;o.ce&&o.ce._setProp(n,i)}u[0]&&(a&&!d?i=!1:u[1]&&(i===""||i===uu(n))&&(i=!0))}return i}const qy=new WeakMap;function wm(e,t,n=!1){const i=n?qy:t.propsCache,o=i.get(e);if(o)return o;const a=e.props,u={},d=[];let f=!1;if(!Nn(e)){const y=x=>{f=!0;const[k,b]=wm(x,t,!0);Fr(u,k),b&&d.push(...b)};!n&&t.mixins.length&&t.mixins.forEach(y),e.extends&&y(e.extends),e.mixins&&e.mixins.forEach(y)}if(!a&&!f)return ki(e)&&i.set(e,Tu),Tu;if(yn(a))for(let y=0;y<a.length;y++){const x=Oo(a[y]);Rp(x)&&(u[x]=Ci)}else if(a)for(const y in a){const x=Oo(y);if(Rp(x)){const k=a[y],b=u[x]=yn(k)||Nn(k)?{type:k}:Fr({},k),T=b.type;let $=!1,H=!0;if(yn(T))for(let I=0;I<T.length;++I){const Q=T[I],se=Nn(Q)&&Q.name;if(se==="Boolean"){$=!0;break}else se==="String"&&(H=!1)}else $=Nn(T)&&T.name==="Boolean";b[0]=$,b[1]=H,($||fi(b,"default"))&&d.push(x)}}const m=[u,d];return ki(e)&&i.set(e,m),m}function Rp(e){return e[0]!=="$"&&!uc(e)}const xm=e=>e[0]==="_"||e==="$stable",tp=e=>yn(e)?e.map(Sa):[Sa(e)],Vy=(e,t,n)=>{if(t._n)return t;const i=ea((...o)=>tp(t(...o)),n);return i._c=!1,i},Lm=(e,t,n)=>{const i=e._ctx;for(const o in e){if(xm(o))continue;const a=e[o];if(Nn(a))t[o]=Vy(o,a,i);else if(a!=null){const u=tp(a);t[o]=()=>u}}},Cm=(e,t)=>{const n=tp(t);e.slots.default=()=>n},Pm=(e,t,n)=>{for(const i in t)(n||i!=="_")&&(e[i]=t[i])},Gy=(e,t,n)=>{const i=e.slots=ym();if(e.vnode.shapeFlag&32){const o=t._;o?(Pm(i,t,n),n&&Mg(i,"_",o,!0)):Lm(t,i)}else t&&Cm(e,t)},Hy=(e,t,n)=>{const{vnode:i,slots:o}=e;let a=!0,u=Ci;if(i.shapeFlag&32){const d=t._;d?n&&d===1?a=!1:Pm(o,t,n):(a=!t.$stable,Lm(t,o)),u=t}else t&&(Cm(e,t),u={default:1});if(a)for(const d in o)!xm(d)&&u[d]==null&&delete o[d]},lo=o2;function Wy(e){return Zy(e)}function Zy(e,t){const n=Hh();n.__VUE__=!0;const{insert:i,remove:o,patchProp:a,createElement:u,createText:d,createComment:f,setText:m,setElementText:y,parentNode:x,nextSibling:k,setScopeId:b=Ma,insertStaticContent:T}=e,$=(V,Z,F,D=null,j=null,Fe=null,qe=void 0,De=null,Je=!!Z.dynamicChildren)=>{if(V===Z)return;V&&!Yl(V,Z)&&(D=ee(V),O(V,j,Fe,!0),V=null),Z.patchFlag===-2&&(Je=!1,Z.dynamicChildren=null);const{type:Ze,ref:yt,shapeFlag:wt}=Z;switch(Ze){case Qh:H(V,Z,F,D);break;case Vs:I(V,Z,F,D);break;case hh:V==null&&Q(Z,F,D,qe);break;case Qt:re(V,Z,F,D,j,Fe,qe,De,Je);break;default:wt&1?Be(V,Z,F,D,j,Fe,qe,De,Je):wt&6?oe(V,Z,F,D,j,Fe,qe,De,Je):(wt&64||wt&128)&&Ze.process(V,Z,F,D,j,Fe,qe,De,Je,de)}yt!=null&&j&&Mh(yt,V&&V.ref,Fe,Z||V,!Z)},H=(V,Z,F,D)=>{if(V==null)i(Z.el=d(Z.children),F,D);else{const j=Z.el=V.el;Z.children!==V.children&&m(j,Z.children)}},I=(V,Z,F,D)=>{V==null?i(Z.el=f(Z.children||""),F,D):Z.el=V.el},Q=(V,Z,F,D)=>{[V.el,V.anchor]=T(V.children,Z,F,D,V.el,V.anchor)},se=({el:V,anchor:Z},F,D)=>{let j;for(;V&&V!==Z;)j=k(V),i(V,F,D),V=j;i(Z,F,D)},we=({el:V,anchor:Z})=>{let F;for(;V&&V!==Z;)F=k(V),o(V),V=F;o(Z)},Be=(V,Z,F,D,j,Fe,qe,De,Je)=>{Z.type==="svg"?qe="svg":Z.type==="math"&&(qe="mathml"),V==null?$e(Z,F,D,j,Fe,qe,De,Je):Te(V,Z,j,Fe,qe,De,Je)},$e=(V,Z,F,D,j,Fe,qe,De)=>{let Je,Ze;const{props:yt,shapeFlag:wt,transition:Pt,dirs:Rt}=V;if(Je=V.el=u(V.type,Fe,yt&&yt.is,yt),wt&8?y(Je,V.children):wt&16&&Pe(V.children,Je,null,D,j,Td(V,Fe),qe,De),Rt&&Vl(V,null,D,"created"),Ue(Je,V,V.scopeId,qe,D),yt){for(const lt in yt)lt!=="value"&&!uc(lt)&&a(Je,lt,null,yt[lt],Fe,D);"value"in yt&&a(Je,"value",null,yt.value,Fe),(Ze=yt.onVnodeBeforeMount)&&Ca(Ze,D,V)}Rt&&Vl(V,null,D,"beforeMount");const qt=Ky(j,Pt);qt&&Pt.beforeEnter(Je),i(Je,Z,F),((Ze=yt&&yt.onVnodeMounted)||qt||Rt)&&lo(()=>{Ze&&Ca(Ze,D,V),qt&&Pt.enter(Je),Rt&&Vl(V,null,D,"mounted")},j)},Ue=(V,Z,F,D,j)=>{if(F&&b(V,F),D)for(let Fe=0;Fe<D.length;Fe++)b(V,D[Fe]);if(j){let Fe=j.subTree;if(Z===Fe||Mm(Fe.type)&&(Fe.ssContent===Z||Fe.ssFallback===Z)){const qe=j.vnode;Ue(V,qe,qe.scopeId,qe.slotScopeIds,j.parent)}}},Pe=(V,Z,F,D,j,Fe,qe,De,Je=0)=>{for(let Ze=Je;Ze<V.length;Ze++){const yt=V[Ze]=De?Pl(V[Ze]):Sa(V[Ze]);$(null,yt,Z,F,D,j,Fe,qe,De)}},Te=(V,Z,F,D,j,Fe,qe)=>{const De=Z.el=V.el;let{patchFlag:Je,dynamicChildren:Ze,dirs:yt}=Z;Je|=V.patchFlag&16;const wt=V.props||Ci,Pt=Z.props||Ci;let Rt;if(F&&Gl(F,!1),(Rt=Pt.onVnodeBeforeUpdate)&&Ca(Rt,F,Z,V),yt&&Vl(Z,V,F,"beforeUpdate"),F&&Gl(F,!0),(wt.innerHTML&&Pt.innerHTML==null||wt.textContent&&Pt.textContent==null)&&y(De,""),Ze?He(V.dynamicChildren,Ze,De,F,D,Td(Z,j),Fe):qe||J(V,Z,De,null,F,D,Td(Z,j),Fe,!1),Je>0){if(Je&16)ae(De,wt,Pt,F,j);else if(Je&2&&wt.class!==Pt.class&&a(De,"class",null,Pt.class,j),Je&4&&a(De,"style",wt.style,Pt.style,j),Je&8){const qt=Z.dynamicProps;for(let lt=0;lt<qt.length;lt++){const Oe=qt[lt],kt=wt[Oe],Et=Pt[Oe];(Et!==kt||Oe==="value")&&a(De,Oe,kt,Et,j,F)}}Je&1&&V.children!==Z.children&&y(De,Z.children)}else!qe&&Ze==null&&ae(De,wt,Pt,F,j);((Rt=Pt.onVnodeUpdated)||yt)&&lo(()=>{Rt&&Ca(Rt,F,Z,V),yt&&Vl(Z,V,F,"updated")},D)},He=(V,Z,F,D,j,Fe,qe)=>{for(let De=0;De<Z.length;De++){const Je=V[De],Ze=Z[De],yt=Je.el&&(Je.type===Qt||!Yl(Je,Ze)||Je.shapeFlag&70)?x(Je.el):F;$(Je,Ze,yt,null,D,j,Fe,qe,!0)}},ae=(V,Z,F,D,j)=>{if(Z!==F){if(Z!==Ci)for(const Fe in Z)!uc(Fe)&&!(Fe in F)&&a(V,Fe,Z[Fe],null,j,D);for(const Fe in F){if(uc(Fe))continue;const qe=F[Fe],De=Z[Fe];qe!==De&&Fe!=="value"&&a(V,Fe,De,qe,j,D)}"value"in F&&a(V,"value",Z.value,F.value,j)}},re=(V,Z,F,D,j,Fe,qe,De,Je)=>{const Ze=Z.el=V?V.el:d(""),yt=Z.anchor=V?V.anchor:d("");let{patchFlag:wt,dynamicChildren:Pt,slotScopeIds:Rt}=Z;Rt&&(De=De?De.concat(Rt):Rt),V==null?(i(Ze,F,D),i(yt,F,D),Pe(Z.children||[],F,yt,j,Fe,qe,De,Je)):wt>0&&wt&64&&Pt&&V.dynamicChildren?(He(V.dynamicChildren,Pt,F,j,Fe,qe,De),(Z.key!=null||j&&Z===j.subTree)&&km(V,Z,!0)):J(V,Z,F,yt,j,Fe,qe,De,Je)},oe=(V,Z,F,D,j,Fe,qe,De,Je)=>{Z.slotScopeIds=De,V==null?Z.shapeFlag&512?j.ctx.activate(Z,F,D,qe,Je):Y(Z,F,D,j,Fe,qe,Je):C(V,Z,Je)},Y=(V,Z,F,D,j,Fe,qe)=>{const De=V.component=f2(V,D,j);if(Kh(V)&&(De.ctx.renderer=de),g2(De,!1,qe),De.asyncDep){if(j&&j.registerDep(De,N,qe),!V.el){const Je=De.subTree=Pi(Vs);I(null,Je,Z,F)}}else N(De,V,Z,F,j,Fe,qe)},C=(V,Z,F)=>{const D=Z.component=V.component;if(r2(V,Z,F))if(D.asyncDep&&!D.asyncResolved){K(D,Z,F);return}else D.next=Z,D.update();else Z.el=V.el,D.vnode=Z},N=(V,Z,F,D,j,Fe,qe)=>{const De=()=>{if(V.isMounted){let{next:wt,bu:Pt,u:Rt,parent:qt,vnode:lt}=V;{const nt=Em(V);if(nt){wt&&(wt.el=lt.el,K(V,wt,qe)),nt.asyncDep.then(()=>{V.isUnmounted||De()});return}}let Oe=wt,kt;Gl(V,!1),wt?(wt.el=lt.el,K(V,wt,qe)):wt=lt,Pt&&uh(Pt),(kt=wt.props&&wt.props.onVnodeBeforeUpdate)&&Ca(kt,qt,wt,lt),Gl(V,!0);const Et=Ip(V),St=V.subTree;V.subTree=Et,$(St,Et,x(St.el),ee(St),V,j,Fe),wt.el=Et.el,Oe===null&&s2(V,Et.el),Rt&&lo(Rt,j),(kt=wt.props&&wt.props.onVnodeUpdated)&&lo(()=>Ca(kt,qt,wt,lt),j)}else{let wt;const{el:Pt,props:Rt}=Z,{bm:qt,m:lt,parent:Oe,root:kt,type:Et}=V,St=dc(Z);Gl(V,!1),qt&&uh(qt),!St&&(wt=Rt&&Rt.onVnodeBeforeMount)&&Ca(wt,Oe,Z),Gl(V,!0);{kt.ce&&kt.ce._injectChildStyle(Et);const nt=V.subTree=Ip(V);$(null,nt,F,D,V,j,Fe),Z.el=nt.el}if(lt&&lo(lt,j),!St&&(wt=Rt&&Rt.onVnodeMounted)){const nt=Z;lo(()=>Ca(wt,Oe,nt),j)}(Z.shapeFlag&256||Oe&&dc(Oe.vnode)&&Oe.vnode.shapeFlag&256)&&V.a&&lo(V.a,j),V.isMounted=!0,Z=F=D=null}};V.scope.on();const Je=V.effect=new Ig(De);V.scope.off();const Ze=V.update=Je.run.bind(Je),yt=V.job=Je.runIfDirty.bind(Je);yt.i=V,yt.id=V.uid,Je.scheduler=()=>ep(yt),Gl(V,!0),Ze()},K=(V,Z,F)=>{Z.component=V;const D=V.vnode.props;V.vnode=Z,V.next=null,$y(V,Z.props,D,F),Hy(V,Z.children,F),Ol(),Sp(V),Il()},J=(V,Z,F,D,j,Fe,qe,De,Je=!1)=>{const Ze=V&&V.children,yt=V?V.shapeFlag:0,wt=Z.children,{patchFlag:Pt,shapeFlag:Rt}=Z;if(Pt>0){if(Pt&128){ue(Ze,wt,F,D,j,Fe,qe,De,Je);return}else if(Pt&256){Ee(Ze,wt,F,D,j,Fe,qe,De,Je);return}}Rt&8?(yt&16&&_e(Ze,j,Fe),wt!==Ze&&y(F,wt)):yt&16?Rt&16?ue(Ze,wt,F,D,j,Fe,qe,De,Je):_e(Ze,j,Fe,!0):(yt&8&&y(F,""),Rt&16&&Pe(wt,F,D,j,Fe,qe,De,Je))},Ee=(V,Z,F,D,j,Fe,qe,De,Je)=>{V=V||Tu,Z=Z||Tu;const Ze=V.length,yt=Z.length,wt=Math.min(Ze,yt);let Pt;for(Pt=0;Pt<wt;Pt++){const Rt=Z[Pt]=Je?Pl(Z[Pt]):Sa(Z[Pt]);$(V[Pt],Rt,F,null,j,Fe,qe,De,Je)}Ze>yt?_e(V,j,Fe,!0,!1,wt):Pe(Z,F,D,j,Fe,qe,De,Je,wt)},ue=(V,Z,F,D,j,Fe,qe,De,Je)=>{let Ze=0;const yt=Z.length;let wt=V.length-1,Pt=yt-1;for(;Ze<=wt&&Ze<=Pt;){const Rt=V[Ze],qt=Z[Ze]=Je?Pl(Z[Ze]):Sa(Z[Ze]);if(Yl(Rt,qt))$(Rt,qt,F,null,j,Fe,qe,De,Je);else break;Ze++}for(;Ze<=wt&&Ze<=Pt;){const Rt=V[wt],qt=Z[Pt]=Je?Pl(Z[Pt]):Sa(Z[Pt]);if(Yl(Rt,qt))$(Rt,qt,F,null,j,Fe,qe,De,Je);else break;wt--,Pt--}if(Ze>wt){if(Ze<=Pt){const Rt=Pt+1,qt=Rt<yt?Z[Rt].el:D;for(;Ze<=Pt;)$(null,Z[Ze]=Je?Pl(Z[Ze]):Sa(Z[Ze]),F,qt,j,Fe,qe,De,Je),Ze++}}else if(Ze>Pt)for(;Ze<=wt;)O(V[Ze],j,Fe,!0),Ze++;else{const Rt=Ze,qt=Ze,lt=new Map;for(Ze=qt;Ze<=Pt;Ze++){const Gt=Z[Ze]=Je?Pl(Z[Ze]):Sa(Z[Ze]);Gt.key!=null&&lt.set(Gt.key,Ze)}let Oe,kt=0;const Et=Pt-qt+1;let St=!1,nt=0;const st=new Array(Et);for(Ze=0;Ze<Et;Ze++)st[Ze]=0;for(Ze=Rt;Ze<=wt;Ze++){const Gt=V[Ze];if(kt>=Et){O(Gt,j,Fe,!0);continue}let nn;if(Gt.key!=null)nn=lt.get(Gt.key);else for(Oe=qt;Oe<=Pt;Oe++)if(st[Oe-qt]===0&&Yl(Gt,Z[Oe])){nn=Oe;break}nn===void 0?O(Gt,j,Fe,!0):(st[nn-qt]=Ze+1,nn>=nt?nt=nn:St=!0,$(Gt,Z[nn],F,null,j,Fe,qe,De,Je),kt++)}const pn=St?Yy(st):Tu;for(Oe=pn.length-1,Ze=Et-1;Ze>=0;Ze--){const Gt=qt+Ze,nn=Z[Gt],$n=Gt+1<yt?Z[Gt+1].el:D;st[Ze]===0?$(null,nn,F,$n,j,Fe,qe,De,Je):St&&(Oe<0||Ze!==pn[Oe]?ye(nn,F,$n,2):Oe--)}}},ye=(V,Z,F,D,j=null)=>{const{el:Fe,type:qe,transition:De,children:Je,shapeFlag:Ze}=V;if(Ze&6){ye(V.component.subTree,Z,F,D);return}if(Ze&128){V.suspense.move(Z,F,D);return}if(Ze&64){qe.move(V,Z,F,de);return}if(qe===Qt){i(Fe,Z,F);for(let wt=0;wt<Je.length;wt++)ye(Je[wt],Z,F,D);i(V.anchor,Z,F);return}if(qe===hh){se(V,Z,F);return}if(D!==2&&Ze&1&&De)if(D===0)De.beforeEnter(Fe),i(Fe,Z,F),lo(()=>De.enter(Fe),j);else{const{leave:wt,delayLeave:Pt,afterLeave:Rt}=De,qt=()=>i(Fe,Z,F),lt=()=>{wt(Fe,()=>{qt(),Rt&&Rt()})};Pt?Pt(Fe,qt,lt):lt()}else i(Fe,Z,F)},O=(V,Z,F,D=!1,j=!1)=>{const{type:Fe,props:qe,ref:De,children:Je,dynamicChildren:Ze,shapeFlag:yt,patchFlag:wt,dirs:Pt,cacheIndex:Rt}=V;if(wt===-2&&(j=!1),De!=null&&Mh(De,null,F,V,!0),Rt!=null&&(Z.renderCache[Rt]=void 0),yt&256){Z.ctx.deactivate(V);return}const qt=yt&1&&Pt,lt=!dc(V);let Oe;if(lt&&(Oe=qe&&qe.onVnodeBeforeUnmount)&&Ca(Oe,Z,V),yt&6)fe(V.component,F,D);else{if(yt&128){V.suspense.unmount(F,D);return}qt&&Vl(V,null,Z,"beforeUnmount"),yt&64?V.type.remove(V,Z,F,de,D):Ze&&!Ze.hasOnce&&(Fe!==Qt||wt>0&&wt&64)?_e(Ze,Z,F,!1,!0):(Fe===Qt&&wt&384||!j&&yt&16)&&_e(Je,Z,F),D&&ie(V)}(lt&&(Oe=qe&&qe.onVnodeUnmounted)||qt)&&lo(()=>{Oe&&Ca(Oe,Z,V),qt&&Vl(V,null,Z,"unmounted")},F)},ie=V=>{const{type:Z,el:F,anchor:D,transition:j}=V;if(Z===Qt){le(F,D);return}if(Z===hh){we(V);return}const Fe=()=>{o(F),j&&!j.persisted&&j.afterLeave&&j.afterLeave()};if(V.shapeFlag&1&&j&&!j.persisted){const{leave:qe,delayLeave:De}=j,Je=()=>qe(F,Fe);De?De(V.el,Fe,Je):Je()}else Fe()},le=(V,Z)=>{let F;for(;V!==Z;)F=k(V),o(V),V=F;o(Z)},fe=(V,Z,F)=>{const{bum:D,scope:j,job:Fe,subTree:qe,um:De,m:Je,a:Ze}=V;Op(Je),Op(Ze),D&&uh(D),j.stop(),Fe&&(Fe.flags|=8,O(qe,V,Z,F)),De&&lo(De,Z),lo(()=>{V.isUnmounted=!0},Z),Z&&Z.pendingBranch&&!Z.isUnmounted&&V.asyncDep&&!V.asyncResolved&&V.suspenseId===Z.pendingId&&(Z.deps--,Z.deps===0&&Z.resolve())},_e=(V,Z,F,D=!1,j=!1,Fe=0)=>{for(let qe=Fe;qe<V.length;qe++)O(V[qe],Z,F,D,j)},ee=V=>{if(V.shapeFlag&6)return ee(V.component.subTree);if(V.shapeFlag&128)return V.suspense.next();const Z=k(V.anchor||V.el),F=Z&&Z[py];return F?k(F):Z};let G=!1;const q=(V,Z,F)=>{V==null?Z._vnode&&O(Z._vnode,null,null,!0):$(Z._vnode||null,V,Z,null,null,null,F),Z._vnode=V,G||(G=!0,Sp(),im(),G=!1)},de={p:$,um:O,m:ye,r:ie,mt:Y,mc:Pe,pc:J,pbc:He,n:ee,o:e};return{render:q,hydrate:void 0,createApp:jy(q)}}function Td({type:e,props:t},n){return n==="svg"&&e==="foreignObject"||n==="mathml"&&e==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:n}function Gl({effect:e,job:t},n){n?(e.flags|=32,t.flags|=4):(e.flags&=-33,t.flags&=-5)}function Ky(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}function km(e,t,n=!1){const i=e.children,o=t.children;if(yn(i)&&yn(o))for(let a=0;a<i.length;a++){const u=i[a];let d=o[a];d.shapeFlag&1&&!d.dynamicChildren&&((d.patchFlag<=0||d.patchFlag===32)&&(d=o[a]=Pl(o[a]),d.el=u.el),!n&&d.patchFlag!==-2&&km(u,d)),d.type===Qh&&(d.el=u.el)}}function Yy(e){const t=e.slice(),n=[0];let i,o,a,u,d;const f=e.length;for(i=0;i<f;i++){const m=e[i];if(m!==0){if(o=n[n.length-1],e[o]<m){t[i]=o,n.push(i);continue}for(a=0,u=n.length-1;a<u;)d=a+u>>1,e[n[d]]<m?a=d+1:u=d;m<e[n[a]]&&(a>0&&(t[i]=n[a-1]),n[a]=i)}}for(a=n.length,u=n[a-1];a-- >0;)n[a]=u,u=t[u];return n}function Em(e){const t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:Em(t)}function Op(e){if(e)for(let t=0;t<e.length;t++)e[t].flags|=8}const Jy=Symbol.for("v-scx"),Xy=()=>Do(Jy);function hf(e,t){return np(e,null,t)}function Ki(e,t,n){return np(e,t,n)}function np(e,t,n=Ci){const{immediate:i,deep:o,flush:a,once:u}=n,d=Fr({},n),f=t&&i||!t&&a!=="post";let m;if(Ec){if(a==="sync"){const b=Xy();m=b.__watcherHandles||(b.__watcherHandles=[])}else if(!f){const b=()=>{};return b.stop=Ma,b.resume=Ma,b.pause=Ma,b}}const y=Ir;d.call=(b,T,$)=>ia(b,y,T,$);let x=!1;a==="post"?d.scheduler=b=>{lo(b,y&&y.suspense)}:a!=="sync"&&(x=!0,d.scheduler=(b,T)=>{T?b():ep(b)}),d.augmentJob=b=>{t&&(b.flags|=4),x&&(b.flags|=2,y&&(b.id=y.uid,b.i=y))};const k=cy(e,t,d);return Ec&&(m?m.push(k):f&&k()),k}function Qy(e,t,n){const i=this.proxy,o=or(e)?e.includes(".")?Sm(i,e):()=>i[e]:e.bind(i,i);let a;Nn(t)?a=t:(a=t.handler,n=t);const u=jc(this),d=np(o,a.bind(i),n);return u(),d}function Sm(e,t){const n=t.split(".");return()=>{let i=e;for(let o=0;o<n.length&&i;o++)i=i[n[o]];return i}}const e2=(e,t)=>t==="modelValue"||t==="model-value"?e.modelModifiers:e[`${t}Modifiers`]||e[`${Oo(t)}Modifiers`]||e[`${uu(t)}Modifiers`];function t2(e,t,...n){if(e.isUnmounted)return;const i=e.vnode.props||Ci;let o=n;const a=t.startsWith("update:"),u=a&&e2(i,t.slice(7));u&&(u.trim&&(o=n.map(y=>or(y)?y.trim():y)),u.number&&(o=n.map(Ph)));let d,f=i[d=Pd(t)]||i[d=Pd(Oo(t))];!f&&a&&(f=i[d=Pd(uu(t))]),f&&ia(f,e,6,o);const m=i[d+"Once"];if(m){if(!e.emitted)e.emitted={};else if(e.emitted[d])return;e.emitted[d]=!0,ia(m,e,6,o)}}function Am(e,t,n=!1){const i=t.emitsCache,o=i.get(e);if(o!==void 0)return o;const a=e.emits;let u={},d=!1;if(!Nn(e)){const f=m=>{const y=Am(m,t,!0);y&&(d=!0,Fr(u,y))};!n&&t.mixins.length&&t.mixins.forEach(f),e.extends&&f(e.extends),e.mixins&&e.mixins.forEach(f)}return!a&&!d?(ki(e)&&i.set(e,null),null):(yn(a)?a.forEach(f=>u[f]=null):Fr(u,a),ki(e)&&i.set(e,u),u)}function Xh(e,t){return!e||!qh(t)?!1:(t=t.slice(2).replace(/Once$/,""),fi(e,t[0].toLowerCase()+t.slice(1))||fi(e,uu(t))||fi(e,t))}function Ip(e){const{type:t,vnode:n,proxy:i,withProxy:o,propsOptions:[a],slots:u,attrs:d,emit:f,render:m,renderCache:y,props:x,data:k,setupState:b,ctx:T,inheritAttrs:$}=e,H=Ah(e);let I,Q;try{if(n.shapeFlag&4){const we=o||i,Be=we;I=Sa(m.call(Be,we,y,x,b,k,T)),Q=d}else{const we=t;I=Sa(we.length>1?we(x,{attrs:d,slots:u,emit:f}):we(x,null)),Q=t.props?d:n2(d)}}catch(we){pc.length=0,Zh(we,e,1),I=Pi(Vs)}let se=I;if(Q&&$!==!1){const we=Object.keys(Q),{shapeFlag:Be}=se;we.length&&Be&7&&(a&&we.some($f)&&(Q=i2(Q,a)),se=Tl(se,Q,!1,!0))}return n.dirs&&(se=Tl(se,null,!1,!0),se.dirs=se.dirs?se.dirs.concat(n.dirs):n.dirs),n.transition&&Pc(se,n.transition),I=se,Ah(H),I}const n2=e=>{let t;for(const n in e)(n==="class"||n==="style"||qh(n))&&((t||(t={}))[n]=e[n]);return t},i2=(e,t)=>{const n={};for(const i in e)(!$f(i)||!(i.slice(9)in t))&&(n[i]=e[i]);return n};function r2(e,t,n){const{props:i,children:o,component:a}=e,{props:u,children:d,patchFlag:f}=t,m=a.emitsOptions;if(t.dirs||t.transition)return!0;if(n&&f>=0){if(f&1024)return!0;if(f&16)return i?Fp(i,u,m):!!u;if(f&8){const y=t.dynamicProps;for(let x=0;x<y.length;x++){const k=y[x];if(u[k]!==i[k]&&!Xh(m,k))return!0}}}else return(o||d)&&(!d||!d.$stable)?!0:i===u?!1:i?u?Fp(i,u,m):!0:!!u;return!1}function Fp(e,t,n){const i=Object.keys(t);if(i.length!==Object.keys(e).length)return!0;for(let o=0;o<i.length;o++){const a=i[o];if(t[a]!==e[a]&&!Xh(n,a))return!0}return!1}function s2({vnode:e,parent:t},n){for(;t;){const i=t.subTree;if(i.suspense&&i.suspense.activeBranch===e&&(i.el=e.el),i===e)(e=t.vnode).el=n,t=t.parent;else break}}const Mm=e=>e.__isSuspense;function o2(e,t){t&&t.pendingBranch?yn(e)?t.effects.push(...e):t.effects.push(e):fy(e)}const Qt=Symbol.for("v-fgt"),Qh=Symbol.for("v-txt"),Vs=Symbol.for("v-cmt"),hh=Symbol.for("v-stc"),pc=[];let ho=null;function je(e=!1){pc.push(ho=e?null:[])}function a2(){pc.pop(),ho=pc[pc.length-1]||null}let kc=1;function jp(e,t=!1){kc+=e,e<0&&ho&&t&&(ho.hasOnce=!0)}function Bm(e){return e.dynamicChildren=kc>0?ho||Tu:null,a2(),kc>0&&ho&&ho.push(e),e}function ze(e,t,n,i,o,a){return Bm(A(e,t,n,i,o,a,!0))}function Sl(e,t,n,i,o){return Bm(Pi(e,t,n,i,o,!0))}function Th(e){return e?e.__v_isVNode===!0:!1}function Yl(e,t){return e.type===t.type&&e.key===t.key}const Tm=({key:e})=>e??null,dh=({ref:e,ref_key:t,ref_for:n})=>(typeof e=="number"&&(e=""+e),e!=null?or(e)||sr(e)||Nn(e)?{i:ks,r:e,k:t,f:!!n}:e:null);function A(e,t=null,n=null,i=0,o=null,a=e===Qt?0:1,u=!1,d=!1){const f={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&Tm(t),ref:t&&dh(t),scopeId:sm,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:a,patchFlag:i,dynamicProps:o,dynamicChildren:null,appContext:null,ctx:ks};return d?(ip(f,n),a&128&&e.normalize(f)):n&&(f.shapeFlag|=or(n)?8:16),kc>0&&!u&&ho&&(f.patchFlag>0||a&6)&&f.patchFlag!==32&&ho.push(f),f}const Pi=l2;function l2(e,t=null,n=null,i=0,o=null,a=!1){if((!e||e===My)&&(e=Vs),Th(e)){const d=Tl(e,t,!0);return n&&ip(d,n),kc>0&&!a&&ho&&(d.shapeFlag&6?ho[ho.indexOf(e)]=d:ho.push(d)),d.patchFlag=-2,d}if(b2(e)&&(e=e.__vccOpts),t){t=u2(t);let{class:d,style:f}=t;d&&!or(d)&&(t.class=zi(d)),ki(f)&&(Xf(f)&&!yn(f)&&(f=Fr({},f)),t.style=Oc(f))}const u=or(e)?1:Mm(e)?128:om(e)?64:ki(e)?4:Nn(e)?2:0;return A(e,t,n,i,o,u,a,!0)}function u2(e){return e?Xf(e)||_m(e)?Fr({},e):e:null}function Tl(e,t,n=!1,i=!1){const{props:o,ref:a,patchFlag:u,children:d,transition:f}=e,m=t?c2(o||{},t):o,y={__v_isVNode:!0,__v_skip:!0,type:e.type,props:m,key:m&&Tm(m),ref:t&&t.ref?n&&a?yn(a)?a.concat(dh(t)):[a,dh(t)]:dh(t):a,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:d,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==Qt?u===-1?16:u|16:u,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:f,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&Tl(e.ssContent),ssFallback:e.ssFallback&&Tl(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return f&&i&&Pc(y,f.clone(y)),y}function vi(e=" ",t=0){return Pi(Qh,null,e,t)}function gc(e,t){const n=Pi(hh,null,e);return n.staticCount=t,n}function Zt(e="",t=!1){return t?(je(),Sl(Vs,null,e)):Pi(Vs,null,e)}function Sa(e){return e==null||typeof e=="boolean"?Pi(Vs):yn(e)?Pi(Qt,null,e.slice()):Th(e)?Pl(e):Pi(Qh,null,String(e))}function Pl(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:Tl(e)}function ip(e,t){let n=0;const{shapeFlag:i}=e;if(t==null)t=null;else if(yn(t))n=16;else if(typeof t=="object")if(i&65){const o=t.default;o&&(o._c&&(o._d=!1),ip(e,o()),o._c&&(o._d=!0));return}else{n=32;const o=t._;!o&&!_m(t)?t._ctx=ks:o===3&&ks&&(ks.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else Nn(t)?(t={default:t,_ctx:ks},n=32):(t=String(t),i&64?(n=16,t=[vi(t)]):n=8);e.children=t,e.shapeFlag|=n}function c2(...e){const t={};for(let n=0;n<e.length;n++){const i=e[n];for(const o in i)if(o==="class")t.class!==i.class&&(t.class=zi([t.class,i.class]));else if(o==="style")t.style=Oc([t.style,i.style]);else if(qh(o)){const a=t[o],u=i[o];u&&a!==u&&!(yn(a)&&a.includes(u))&&(t[o]=a?[].concat(a,u):u)}else o!==""&&(t[o]=i[o])}return t}function Ca(e,t,n,i=null){ia(e,t,7,[n,i])}const h2=mm();let d2=0;function f2(e,t,n){const i=e.type,o=(t?t.appContext:e.appContext)||h2,a={uid:d2++,vnode:e,type:i,parent:t,appContext:o,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new Dg(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(o.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:wm(i,o),emitsOptions:Am(i,o),emit:null,emitted:null,propsDefaults:Ci,inheritAttrs:i.inheritAttrs,ctx:Ci,data:Ci,props:Ci,attrs:Ci,slots:Ci,refs:Ci,setupState:Ci,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return a.ctx={_:a},a.root=t?t.root:a,a.emit=t2.bind(null,a),e.ce&&e.ce(a),a}let Ir=null;const p2=()=>Ir||ks;let Nh,df;{const e=Hh(),t=(n,i)=>{let o;return(o=e[n])||(o=e[n]=[]),o.push(i),a=>{o.length>1?o.forEach(u=>u(a)):o[0](a)}};Nh=t("__VUE_INSTANCE_SETTERS__",n=>Ir=n),df=t("__VUE_SSR_SETTERS__",n=>Ec=n)}const jc=e=>{const t=Ir;return Nh(e),e.scope.on(),()=>{e.scope.off(),Nh(t)}},zp=()=>{Ir&&Ir.scope.off(),Nh(null)};function Nm(e){return e.vnode.shapeFlag&4}let Ec=!1;function g2(e,t=!1,n=!1){t&&df(t);const{props:i,children:o}=e.vnode,a=Nm(e);Uy(e,i,a,t),Gy(e,o,n);const u=a?m2(e,t):void 0;return t&&df(!1),u}function m2(e,t){const n=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,Ty);const{setup:i}=n;if(i){Ol();const o=e.setupContext=i.length>1?y2(e):null,a=jc(e),u=Ic(i,e,0,[e.props,o]),d=Eg(u);if(Il(),a(),(d||e.sp)&&!dc(e)&&dm(e),d){if(u.then(zp,zp),t)return u.then(f=>{Up(e,f)}).catch(f=>{Zh(f,e,0)});e.asyncDep=u}else Up(e,u)}else Dm(e)}function Up(e,t,n){Nn(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:ki(t)&&(e.setupState=em(t)),Dm(e)}function Dm(e,t,n){const i=e.type;e.render||(e.render=i.render||Ma);{const o=jc(e);Ol();try{Ny(e)}finally{Il(),o()}}}const v2={get(e,t){return ls(e,"get",""),e[t]}};function y2(e){const t=n=>{e.exposed=n||{}};return{attrs:new Proxy(e.attrs,v2),slots:e.slots,emit:e.emit,expose:t}}function ed(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(em(Qf(e.exposed)),{get(t,n){if(n in t)return t[n];if(n in fc)return fc[n](e)},has(t,n){return n in t||n in fc}})):e.proxy}function _2(e,t=!0){return Nn(e)?e.displayName||e.name:e.name||t&&e.__name}function b2(e){return Nn(e)&&"__vccOpts"in e}const Un=(e,t)=>ly(e,t,Ec);function rp(e,t,n){const i=arguments.length;return i===2?ki(t)&&!yn(t)?Th(t)?Pi(e,null,[t]):Pi(e,t):Pi(e,null,t):(i>3?n=Array.prototype.slice.call(arguments,2):i===3&&Th(n)&&(n=[n]),Pi(e,t,n))}const w2="3.5.13";/**
* @vue/runtime-dom v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let ff;const $p=typeof window<"u"&&window.trustedTypes;if($p)try{ff=$p.createPolicy("vue",{createHTML:e=>e})}catch{}const Rm=ff?e=>ff.createHTML(e):e=>e,x2="http://www.w3.org/2000/svg",L2="http://www.w3.org/1998/Math/MathML",Xa=typeof document<"u"?document:null,qp=Xa&&Xa.createElement("template"),C2={insert:(e,t,n)=>{t.insertBefore(e,n||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,n,i)=>{const o=t==="svg"?Xa.createElementNS(x2,e):t==="mathml"?Xa.createElementNS(L2,e):n?Xa.createElement(e,{is:n}):Xa.createElement(e);return e==="select"&&i&&i.multiple!=null&&o.setAttribute("multiple",i.multiple),o},createText:e=>Xa.createTextNode(e),createComment:e=>Xa.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>Xa.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,n,i,o,a){const u=n?n.previousSibling:t.lastChild;if(o&&(o===a||o.nextSibling))for(;t.insertBefore(o.cloneNode(!0),n),!(o===a||!(o=o.nextSibling)););else{qp.innerHTML=Rm(i==="svg"?`<svg>${e}</svg>`:i==="mathml"?`<math>${e}</math>`:e);const d=qp.content;if(i==="svg"||i==="mathml"){const f=d.firstChild;for(;f.firstChild;)d.appendChild(f.firstChild);d.removeChild(f)}t.insertBefore(d,n)}return[u?u.nextSibling:t.firstChild,n?n.previousSibling:t.lastChild]}},yl="transition",Qu="animation",Sc=Symbol("_vtc"),Om={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},P2=Fr({},am,Om),k2=e=>(e.displayName="Transition",e.props=P2,e),Dh=k2((e,{slots:t})=>rp(vy,E2(e),t)),Hl=(e,t=[])=>{yn(e)?e.forEach(n=>n(...t)):e&&e(...t)},Vp=e=>e?yn(e)?e.some(t=>t.length>1):e.length>1:!1;function E2(e){const t={};for(const re in e)re in Om||(t[re]=e[re]);if(e.css===!1)return t;const{name:n="v",type:i,duration:o,enterFromClass:a=`${n}-enter-from`,enterActiveClass:u=`${n}-enter-active`,enterToClass:d=`${n}-enter-to`,appearFromClass:f=a,appearActiveClass:m=u,appearToClass:y=d,leaveFromClass:x=`${n}-leave-from`,leaveActiveClass:k=`${n}-leave-active`,leaveToClass:b=`${n}-leave-to`}=e,T=S2(o),$=T&&T[0],H=T&&T[1],{onBeforeEnter:I,onEnter:Q,onEnterCancelled:se,onLeave:we,onLeaveCancelled:Be,onBeforeAppear:$e=I,onAppear:Ue=Q,onAppearCancelled:Pe=se}=t,Te=(re,oe,Y,C)=>{re._enterCancelled=C,Wl(re,oe?y:d),Wl(re,oe?m:u),Y&&Y()},He=(re,oe)=>{re._isLeaving=!1,Wl(re,x),Wl(re,b),Wl(re,k),oe&&oe()},ae=re=>(oe,Y)=>{const C=re?Ue:Q,N=()=>Te(oe,re,Y);Hl(C,[oe,N]),Gp(()=>{Wl(oe,re?f:a),Ka(oe,re?y:d),Vp(C)||Hp(oe,i,$,N)})};return Fr(t,{onBeforeEnter(re){Hl(I,[re]),Ka(re,a),Ka(re,u)},onBeforeAppear(re){Hl($e,[re]),Ka(re,f),Ka(re,m)},onEnter:ae(!1),onAppear:ae(!0),onLeave(re,oe){re._isLeaving=!0;const Y=()=>He(re,oe);Ka(re,x),re._enterCancelled?(Ka(re,k),Kp()):(Kp(),Ka(re,k)),Gp(()=>{re._isLeaving&&(Wl(re,x),Ka(re,b),Vp(we)||Hp(re,i,H,Y))}),Hl(we,[re,Y])},onEnterCancelled(re){Te(re,!1,void 0,!0),Hl(se,[re])},onAppearCancelled(re){Te(re,!0,void 0,!0),Hl(Pe,[re])},onLeaveCancelled(re){He(re),Hl(Be,[re])}})}function S2(e){if(e==null)return null;if(ki(e))return[Nd(e.enter),Nd(e.leave)];{const t=Nd(e);return[t,t]}}function Nd(e){return Ev(e)}function Ka(e,t){t.split(/\s+/).forEach(n=>n&&e.classList.add(n)),(e[Sc]||(e[Sc]=new Set)).add(t)}function Wl(e,t){t.split(/\s+/).forEach(i=>i&&e.classList.remove(i));const n=e[Sc];n&&(n.delete(t),n.size||(e[Sc]=void 0))}function Gp(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let A2=0;function Hp(e,t,n,i){const o=e._endId=++A2,a=()=>{o===e._endId&&i()};if(n!=null)return setTimeout(a,n);const{type:u,timeout:d,propCount:f}=M2(e,t);if(!u)return i();const m=u+"end";let y=0;const x=()=>{e.removeEventListener(m,k),a()},k=b=>{b.target===e&&++y>=f&&x()};setTimeout(()=>{y<f&&x()},d+1),e.addEventListener(m,k)}function M2(e,t){const n=window.getComputedStyle(e),i=T=>(n[T]||"").split(", "),o=i(`${yl}Delay`),a=i(`${yl}Duration`),u=Wp(o,a),d=i(`${Qu}Delay`),f=i(`${Qu}Duration`),m=Wp(d,f);let y=null,x=0,k=0;t===yl?u>0&&(y=yl,x=u,k=a.length):t===Qu?m>0&&(y=Qu,x=m,k=f.length):(x=Math.max(u,m),y=x>0?u>m?yl:Qu:null,k=y?y===yl?a.length:f.length:0);const b=y===yl&&/\b(transform|all)(,|$)/.test(i(`${yl}Property`).toString());return{type:y,timeout:x,propCount:k,hasTransform:b}}function Wp(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map((n,i)=>Zp(n)+Zp(e[i])))}function Zp(e){return e==="auto"?0:Number(e.slice(0,-1).replace(",","."))*1e3}function Kp(){return document.body.offsetHeight}function B2(e,t,n){const i=e[Sc];i&&(t=(t?[t,...i]:[...i]).join(" ")),t==null?e.removeAttribute("class"):n?e.setAttribute("class",t):e.className=t}const Rh=Symbol("_vod"),Im=Symbol("_vsh"),fh={beforeMount(e,{value:t},{transition:n}){e[Rh]=e.style.display==="none"?"":e.style.display,n&&t?n.beforeEnter(e):ec(e,t)},mounted(e,{value:t},{transition:n}){n&&t&&n.enter(e)},updated(e,{value:t,oldValue:n},{transition:i}){!t!=!n&&(i?t?(i.beforeEnter(e),ec(e,!0),i.enter(e)):i.leave(e,()=>{ec(e,!1)}):ec(e,t))},beforeUnmount(e,{value:t}){ec(e,t)}};function ec(e,t){e.style.display=t?e[Rh]:"none",e[Im]=!t}const T2=Symbol(""),N2=/(^|;)\s*display\s*:/;function D2(e,t,n){const i=e.style,o=or(n);let a=!1;if(n&&!o){if(t)if(or(t))for(const u of t.split(";")){const d=u.slice(0,u.indexOf(":")).trim();n[d]==null&&ph(i,d,"")}else for(const u in t)n[u]==null&&ph(i,u,"");for(const u in n)u==="display"&&(a=!0),ph(i,u,n[u])}else if(o){if(t!==n){const u=i[T2];u&&(n+=";"+u),i.cssText=n,a=N2.test(n)}}else t&&e.removeAttribute("style");Rh in e&&(e[Rh]=a?i.display:"",e[Im]&&(i.display="none"))}const Yp=/\s*!important$/;function ph(e,t,n){if(yn(n))n.forEach(i=>ph(e,t,i));else if(n==null&&(n=""),t.startsWith("--"))e.setProperty(t,n);else{const i=R2(e,t);Yp.test(n)?e.setProperty(uu(i),n.replace(Yp,""),"important"):e[i]=n}}const Jp=["Webkit","Moz","ms"],Dd={};function R2(e,t){const n=Dd[t];if(n)return n;let i=Oo(t);if(i!=="filter"&&i in e)return Dd[t]=i;i=Gh(i);for(let o=0;o<Jp.length;o++){const a=Jp[o]+i;if(a in e)return Dd[t]=a}return t}const Xp="http://www.w3.org/1999/xlink";function Qp(e,t,n,i,o,a=Nv(t)){i&&t.startsWith("xlink:")?n==null?e.removeAttributeNS(Xp,t.slice(6,t.length)):e.setAttributeNS(Xp,t,n):n==null||a&&!Bg(n)?e.removeAttribute(t):e.setAttribute(t,a?"":Ta(n)?String(n):n)}function e0(e,t,n,i,o){if(t==="innerHTML"||t==="textContent"){n!=null&&(e[t]=t==="innerHTML"?Rm(n):n);return}const a=e.tagName;if(t==="value"&&a!=="PROGRESS"&&!a.includes("-")){const d=a==="OPTION"?e.getAttribute("value")||"":e.value,f=n==null?e.type==="checkbox"?"on":"":String(n);(d!==f||!("_value"in e))&&(e.value=f),n==null&&e.removeAttribute(t),e._value=n;return}let u=!1;if(n===""||n==null){const d=typeof e[t];d==="boolean"?n=Bg(n):n==null&&d==="string"?(n="",u=!0):d==="number"&&(n=0,u=!0)}try{e[t]=n}catch{}u&&e.removeAttribute(o||t)}function tl(e,t,n,i){e.addEventListener(t,n,i)}function O2(e,t,n,i){e.removeEventListener(t,n,i)}const t0=Symbol("_vei");function I2(e,t,n,i,o=null){const a=e[t0]||(e[t0]={}),u=a[t];if(i&&u)u.value=i;else{const[d,f]=F2(t);if(i){const m=a[t]=U2(i,o);tl(e,d,m,f)}else u&&(O2(e,d,u,f),a[t]=void 0)}}const n0=/(?:Once|Passive|Capture)$/;function F2(e){let t;if(n0.test(e)){t={};let i;for(;i=e.match(n0);)e=e.slice(0,e.length-i[0].length),t[i[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):uu(e.slice(2)),t]}let Rd=0;const j2=Promise.resolve(),z2=()=>Rd||(j2.then(()=>Rd=0),Rd=Date.now());function U2(e,t){const n=i=>{if(!i._vts)i._vts=Date.now();else if(i._vts<=n.attached)return;ia($2(i,n.value),t,5,[i])};return n.value=e,n.attached=z2(),n}function $2(e,t){if(yn(t)){const n=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{n.call(e),e._stopped=!0},t.map(i=>o=>!o._stopped&&i&&i(o))}else return t}const i0=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,q2=(e,t,n,i,o,a)=>{const u=o==="svg";t==="class"?B2(e,i,u):t==="style"?D2(e,n,i):qh(t)?$f(t)||I2(e,t,n,i,a):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):V2(e,t,i,u))?(e0(e,t,i),!e.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&Qp(e,t,i,u,a,t!=="value")):e._isVueCE&&(/[A-Z]/.test(t)||!or(i))?e0(e,Oo(t),i,a,t):(t==="true-value"?e._trueValue=i:t==="false-value"&&(e._falseValue=i),Qp(e,t,i,u))};function V2(e,t,n,i){if(i)return!!(t==="innerHTML"||t==="textContent"||t in e&&i0(t)&&Nn(n));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const o=e.tagName;if(o==="IMG"||o==="VIDEO"||o==="CANVAS"||o==="SOURCE")return!1}return i0(t)&&or(n)?!1:t in e}const Nl=e=>{const t=e.props["onUpdate:modelValue"]||!1;return yn(t)?n=>uh(t,n):t};function G2(e){e.target.composing=!0}function r0(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const Ro=Symbol("_assign"),Kn={created(e,{modifiers:{lazy:t,trim:n,number:i}},o){e[Ro]=Nl(o);const a=i||o.props&&o.props.type==="number";tl(e,t?"change":"input",u=>{if(u.target.composing)return;let d=e.value;n&&(d=d.trim()),a&&(d=Ph(d)),e[Ro](d)}),n&&tl(e,"change",()=>{e.value=e.value.trim()}),t||(tl(e,"compositionstart",G2),tl(e,"compositionend",r0),tl(e,"change",r0))},mounted(e,{value:t}){e.value=t??""},beforeUpdate(e,{value:t,oldValue:n,modifiers:{lazy:i,trim:o,number:a}},u){if(e[Ro]=Nl(u),e.composing)return;const d=(a||e.type==="number")&&!/^0\d/.test(e.value)?Ph(e.value):e.value,f=t??"";d!==f&&(document.activeElement===e&&e.type!=="range"&&(i&&t===n||o&&e.value.trim()===f)||(e.value=f))}},Fm={deep:!0,created(e,t,n){e[Ro]=Nl(n),tl(e,"change",()=>{const i=e._modelValue,o=zu(e),a=e.checked,u=e[Ro];if(yn(i)){const d=Gf(i,o),f=d!==-1;if(a&&!f)u(i.concat(o));else if(!a&&f){const m=[...i];m.splice(d,1),u(m)}}else if(qu(i)){const d=new Set(i);a?d.add(o):d.delete(o),u(d)}else u(jm(e,a))})},mounted:s0,beforeUpdate(e,t,n){e[Ro]=Nl(n),s0(e,t,n)}};function s0(e,{value:t,oldValue:n},i){e._modelValue=t;let o;if(yn(t))o=Gf(t,i.props.value)>-1;else if(qu(t))o=t.has(i.props.value);else{if(t===n)return;o=su(t,jm(e,!0))}e.checked!==o&&(e.checked=o)}const H2={created(e,{value:t},n){e.checked=su(t,n.props.value),e[Ro]=Nl(n),tl(e,"change",()=>{e[Ro](zu(e))})},beforeUpdate(e,{value:t,oldValue:n},i){e[Ro]=Nl(i),t!==n&&(e.checked=su(t,i.props.value))}},vr={deep:!0,created(e,{value:t,modifiers:{number:n}},i){const o=qu(t);tl(e,"change",()=>{const a=Array.prototype.filter.call(e.options,u=>u.selected).map(u=>n?Ph(zu(u)):zu(u));e[Ro](e.multiple?o?new Set(a):a:a[0]),e._assigning=!0,bi(()=>{e._assigning=!1})}),e[Ro]=Nl(i)},mounted(e,{value:t}){o0(e,t)},beforeUpdate(e,t,n){e[Ro]=Nl(n)},updated(e,{value:t}){e._assigning||o0(e,t)}};function o0(e,t){const n=e.multiple,i=yn(t);if(!(n&&!i&&!qu(t))){for(let o=0,a=e.options.length;o<a;o++){const u=e.options[o],d=zu(u);if(n)if(i){const f=typeof d;f==="string"||f==="number"?u.selected=t.some(m=>String(m)===String(d)):u.selected=Gf(t,d)>-1}else u.selected=t.has(d);else if(su(zu(u),t)){e.selectedIndex!==o&&(e.selectedIndex=o);return}}!n&&e.selectedIndex!==-1&&(e.selectedIndex=-1)}}function zu(e){return"_value"in e?e._value:e.value}function jm(e,t){const n=t?"_trueValue":"_falseValue";return n in e?e[n]:t}const W2={created(e,t,n){nh(e,t,n,null,"created")},mounted(e,t,n){nh(e,t,n,null,"mounted")},beforeUpdate(e,t,n,i){nh(e,t,n,i,"beforeUpdate")},updated(e,t,n,i){nh(e,t,n,i,"updated")}};function Z2(e,t){switch(e){case"SELECT":return vr;case"TEXTAREA":return Kn;default:switch(t){case"checkbox":return Fm;case"radio":return H2;default:return Kn}}}function nh(e,t,n,i,o){const u=Z2(e.tagName,n.props&&n.props.type)[o];u&&u(e,t,n,i)}const K2=["ctrl","shift","alt","meta"],Y2={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>K2.some(n=>e[`${n}Key`]&&!t.includes(n))},td=(e,t)=>{const n=e._withMods||(e._withMods={}),i=t.join(".");return n[i]||(n[i]=(o,...a)=>{for(let u=0;u<t.length;u++){const d=Y2[t[u]];if(d&&d(o,t))return}return e(o,...a)})},J2=Fr({patchProp:q2},C2);let a0;function X2(){return a0||(a0=Wy(J2))}const Q2=(...e)=>{const t=X2().createApp(...e),{mount:n}=t;return t.mount=i=>{const o=t_(i);if(!o)return;const a=t._component;!Nn(a)&&!a.render&&!a.template&&(a.template=o.innerHTML),o.nodeType===1&&(o.textContent="");const u=n(o,!1,e_(o));return o instanceof Element&&(o.removeAttribute("v-cloak"),o.setAttribute("data-v-app","")),u},t};function e_(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function t_(e){return or(e)?document.querySelector(e):e}/*!
 * pinia v2.3.1
 * (c) 2025 Eduardo San Martin Morote
 * @license MIT
 */let zm;const nd=e=>zm=e,Um=Symbol();function pf(e){return e&&typeof e=="object"&&Object.prototype.toString.call(e)==="[object Object]"&&typeof e.toJSON!="function"}var mc;(function(e){e.direct="direct",e.patchObject="patch object",e.patchFunction="patch function"})(mc||(mc={}));function n_(){const e=Rg(!0),t=e.run(()=>Nt({}));let n=[],i=[];const o=Qf({install(a){nd(o),o._a=a,a.provide(Um,o),a.config.globalProperties.$pinia=o,i.forEach(u=>n.push(u)),i=[]},use(a){return this._a?n.push(a):i.push(a),this},_p:n,_a:null,_e:e,_s:new Map,state:t});return o}const $m=()=>{};function l0(e,t,n,i=$m){e.push(t);const o=()=>{const a=e.indexOf(t);a>-1&&(e.splice(a,1),i())};return!n&&Og()&&Rv(o),o}function bu(e,...t){e.slice().forEach(n=>{n(...t)})}const i_=e=>e(),u0=Symbol(),Od=Symbol();function gf(e,t){e instanceof Map&&t instanceof Map?t.forEach((n,i)=>e.set(i,n)):e instanceof Set&&t instanceof Set&&t.forEach(e.add,e);for(const n in t){if(!t.hasOwnProperty(n))continue;const i=t[n],o=e[n];pf(o)&&pf(i)&&e.hasOwnProperty(n)&&!sr(i)&&!Bl(i)?e[n]=gf(o,i):e[n]=i}return e}const r_=Symbol();function s_(e){return!pf(e)||!e.hasOwnProperty(r_)}const{assign:xl}=Object;function o_(e){return!!(sr(e)&&e.effect)}function a_(e,t,n,i){const{state:o,actions:a,getters:u}=t,d=n.state.value[e];let f;function m(){d||(n.state.value[e]=o?o():{});const y=ry(n.state.value[e]);return xl(y,a,Object.keys(u||{}).reduce((x,k)=>(x[k]=Qf(Un(()=>{nd(n);const b=n._s.get(e);return u[k].call(b,b)})),x),{}))}return f=qm(e,m,t,n,i,!0),f}function qm(e,t,n={},i,o,a){let u;const d=xl({actions:{}},n),f={deep:!0};let m,y,x=[],k=[],b;const T=i.state.value[e];!a&&!T&&(i.state.value[e]={}),Nt({});let $;function H(Pe){let Te;m=y=!1,typeof Pe=="function"?(Pe(i.state.value[e]),Te={type:mc.patchFunction,storeId:e,events:b}):(gf(i.state.value[e],Pe),Te={type:mc.patchObject,payload:Pe,storeId:e,events:b});const He=$=Symbol();bi().then(()=>{$===He&&(m=!0)}),y=!0,bu(x,Te,i.state.value[e])}const I=a?function(){const{state:Te}=n,He=Te?Te():{};this.$patch(ae=>{xl(ae,He)})}:$m;function Q(){u.stop(),x=[],k=[],i._s.delete(e)}const se=(Pe,Te="")=>{if(u0 in Pe)return Pe[Od]=Te,Pe;const He=function(){nd(i);const ae=Array.from(arguments),re=[],oe=[];function Y(K){re.push(K)}function C(K){oe.push(K)}bu(k,{args:ae,name:He[Od],store:Be,after:Y,onError:C});let N;try{N=Pe.apply(this&&this.$id===e?this:Be,ae)}catch(K){throw bu(oe,K),K}return N instanceof Promise?N.then(K=>(bu(re,K),K)).catch(K=>(bu(oe,K),Promise.reject(K))):(bu(re,N),N)};return He[u0]=!0,He[Od]=Te,He},we={_p:i,$id:e,$onAction:l0.bind(null,k),$patch:H,$reset:I,$subscribe(Pe,Te={}){const He=l0(x,Pe,Te.detached,()=>ae()),ae=u.run(()=>Ki(()=>i.state.value[e],re=>{(Te.flush==="sync"?y:m)&&Pe({storeId:e,type:mc.direct,events:b},re)},xl({},f,Te)));return He},$dispose:Q},Be=il(we);i._s.set(e,Be);const Ue=(i._a&&i._a.runWithContext||i_)(()=>i._e.run(()=>(u=Rg()).run(()=>t({action:se}))));for(const Pe in Ue){const Te=Ue[Pe];if(sr(Te)&&!o_(Te)||Bl(Te))a||(T&&s_(Te)&&(sr(Te)?Te.value=T[Pe]:gf(Te,T[Pe])),i.state.value[e][Pe]=Te);else if(typeof Te=="function"){const He=se(Te,Pe);Ue[Pe]=He,d.actions[Pe]=Te}}return xl(Be,Ue),xl(ii(Be),Ue),Object.defineProperty(Be,"$state",{get:()=>i.state.value[e],set:Pe=>{H(Te=>{xl(Te,Pe)})}}),i._p.forEach(Pe=>{xl(Be,u.run(()=>Pe({store:Be,app:i._a,pinia:i,options:d})))}),T&&a&&n.hydrate&&n.hydrate(Be.$state,T),m=!0,y=!0,Be}/*! #__NO_SIDE_EFFECTS__ */function id(e,t,n){let i,o;const a=typeof t=="function";typeof e=="string"?(i=e,o=a?n:t):(o=e,i=e.id);function u(d,f){const m=zy();return d=d||(m?Do(Um,null):null),d&&nd(d),d=zm,d._s.has(i)||(a?qm(i,t,o,d):a_(i,o,d)),d._s.get(i)}return u.$id=i,u}function Vm(e,t){return function(){return e.apply(t,arguments)}}const{toString:l_}=Object.prototype,{getPrototypeOf:sp}=Object,rd=(e=>t=>{const n=l_.call(t);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),oa=e=>(e=e.toLowerCase(),t=>rd(t)===e),sd=e=>t=>typeof t===e,{isArray:Vu}=Array,Ac=sd("undefined");function u_(e){return e!==null&&!Ac(e)&&e.constructor!==null&&!Ac(e.constructor)&&po(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const Gm=oa("ArrayBuffer");function c_(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&Gm(e.buffer),t}const h_=sd("string"),po=sd("function"),Hm=sd("number"),od=e=>e!==null&&typeof e=="object",d_=e=>e===!0||e===!1,gh=e=>{if(rd(e)!=="object")return!1;const t=sp(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},f_=oa("Date"),p_=oa("File"),g_=oa("Blob"),m_=oa("FileList"),v_=e=>od(e)&&po(e.pipe),y_=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||po(e.append)&&((t=rd(e))==="formdata"||t==="object"&&po(e.toString)&&e.toString()==="[object FormData]"))},__=oa("URLSearchParams"),[b_,w_,x_,L_]=["ReadableStream","Request","Response","Headers"].map(oa),C_=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function zc(e,t,{allOwnKeys:n=!1}={}){if(e===null||typeof e>"u")return;let i,o;if(typeof e!="object"&&(e=[e]),Vu(e))for(i=0,o=e.length;i<o;i++)t.call(null,e[i],i,e);else{const a=n?Object.getOwnPropertyNames(e):Object.keys(e),u=a.length;let d;for(i=0;i<u;i++)d=a[i],t.call(null,e[d],d,e)}}function Wm(e,t){t=t.toLowerCase();const n=Object.keys(e);let i=n.length,o;for(;i-- >0;)if(o=n[i],t===o.toLowerCase())return o;return null}const Xl=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Zm=e=>!Ac(e)&&e!==Xl;function mf(){const{caseless:e}=Zm(this)&&this||{},t={},n=(i,o)=>{const a=e&&Wm(t,o)||o;gh(t[a])&&gh(i)?t[a]=mf(t[a],i):gh(i)?t[a]=mf({},i):Vu(i)?t[a]=i.slice():t[a]=i};for(let i=0,o=arguments.length;i<o;i++)arguments[i]&&zc(arguments[i],n);return t}const P_=(e,t,n,{allOwnKeys:i}={})=>(zc(t,(o,a)=>{n&&po(o)?e[a]=Vm(o,n):e[a]=o},{allOwnKeys:i}),e),k_=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),E_=(e,t,n,i)=>{e.prototype=Object.create(t.prototype,i),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},S_=(e,t,n,i)=>{let o,a,u;const d={};if(t=t||{},e==null)return t;do{for(o=Object.getOwnPropertyNames(e),a=o.length;a-- >0;)u=o[a],(!i||i(u,e,t))&&!d[u]&&(t[u]=e[u],d[u]=!0);e=n!==!1&&sp(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},A_=(e,t,n)=>{e=String(e),(n===void 0||n>e.length)&&(n=e.length),n-=t.length;const i=e.indexOf(t,n);return i!==-1&&i===n},M_=e=>{if(!e)return null;if(Vu(e))return e;let t=e.length;if(!Hm(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},B_=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&sp(Uint8Array)),T_=(e,t)=>{const i=(e&&e[Symbol.iterator]).call(e);let o;for(;(o=i.next())&&!o.done;){const a=o.value;t.call(e,a[0],a[1])}},N_=(e,t)=>{let n;const i=[];for(;(n=e.exec(t))!==null;)i.push(n);return i},D_=oa("HTMLFormElement"),R_=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,i,o){return i.toUpperCase()+o}),c0=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),O_=oa("RegExp"),Km=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),i={};zc(n,(o,a)=>{let u;(u=t(o,a,e))!==!1&&(i[a]=u||o)}),Object.defineProperties(e,i)},I_=e=>{Km(e,(t,n)=>{if(po(e)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const i=e[n];if(po(i)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},F_=(e,t)=>{const n={},i=o=>{o.forEach(a=>{n[a]=!0})};return Vu(e)?i(e):i(String(e).split(t)),n},j_=()=>{},z_=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t,Id="abcdefghijklmnopqrstuvwxyz",h0="0123456789",Ym={DIGIT:h0,ALPHA:Id,ALPHA_DIGIT:Id+Id.toUpperCase()+h0},U_=(e=16,t=Ym.ALPHA_DIGIT)=>{let n="";const{length:i}=t;for(;e--;)n+=t[Math.random()*i|0];return n};function $_(e){return!!(e&&po(e.append)&&e[Symbol.toStringTag]==="FormData"&&e[Symbol.iterator])}const q_=e=>{const t=new Array(10),n=(i,o)=>{if(od(i)){if(t.indexOf(i)>=0)return;if(!("toJSON"in i)){t[o]=i;const a=Vu(i)?[]:{};return zc(i,(u,d)=>{const f=n(u,o+1);!Ac(f)&&(a[d]=f)}),t[o]=void 0,a}}return i};return n(e,0)},V_=oa("AsyncFunction"),G_=e=>e&&(od(e)||po(e))&&po(e.then)&&po(e.catch),Jm=((e,t)=>e?setImmediate:t?((n,i)=>(Xl.addEventListener("message",({source:o,data:a})=>{o===Xl&&a===n&&i.length&&i.shift()()},!1),o=>{i.push(o),Xl.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",po(Xl.postMessage)),H_=typeof queueMicrotask<"u"?queueMicrotask.bind(Xl):typeof process<"u"&&process.nextTick||Jm,At={isArray:Vu,isArrayBuffer:Gm,isBuffer:u_,isFormData:y_,isArrayBufferView:c_,isString:h_,isNumber:Hm,isBoolean:d_,isObject:od,isPlainObject:gh,isReadableStream:b_,isRequest:w_,isResponse:x_,isHeaders:L_,isUndefined:Ac,isDate:f_,isFile:p_,isBlob:g_,isRegExp:O_,isFunction:po,isStream:v_,isURLSearchParams:__,isTypedArray:B_,isFileList:m_,forEach:zc,merge:mf,extend:P_,trim:C_,stripBOM:k_,inherits:E_,toFlatObject:S_,kindOf:rd,kindOfTest:oa,endsWith:A_,toArray:M_,forEachEntry:T_,matchAll:N_,isHTMLForm:D_,hasOwnProperty:c0,hasOwnProp:c0,reduceDescriptors:Km,freezeMethods:I_,toObjectSet:F_,toCamelCase:R_,noop:j_,toFiniteNumber:z_,findKey:Wm,global:Xl,isContextDefined:Zm,ALPHABET:Ym,generateString:U_,isSpecCompliantForm:$_,toJSONObject:q_,isAsyncFn:V_,isThenable:G_,setImmediate:Jm,asap:H_};function On(e,t,n,i,o){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),i&&(this.request=i),o&&(this.response=o,this.status=o.status?o.status:null)}At.inherits(On,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:At.toJSONObject(this.config),code:this.code,status:this.status}}});const Xm=On.prototype,Qm={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Qm[e]={value:e}});Object.defineProperties(On,Qm);Object.defineProperty(Xm,"isAxiosError",{value:!0});On.from=(e,t,n,i,o,a)=>{const u=Object.create(Xm);return At.toFlatObject(e,u,function(f){return f!==Error.prototype},d=>d!=="isAxiosError"),On.call(u,e.message,t,n,i,o),u.cause=e,u.name=e.name,a&&Object.assign(u,a),u};const W_=null;function vf(e){return At.isPlainObject(e)||At.isArray(e)}function e1(e){return At.endsWith(e,"[]")?e.slice(0,-2):e}function d0(e,t,n){return e?e.concat(t).map(function(o,a){return o=e1(o),!n&&a?"["+o+"]":o}).join(n?".":""):t}function Z_(e){return At.isArray(e)&&!e.some(vf)}const K_=At.toFlatObject(At,{},null,function(t){return/^is[A-Z]/.test(t)});function ad(e,t,n){if(!At.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,n=At.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function($,H){return!At.isUndefined(H[$])});const i=n.metaTokens,o=n.visitor||y,a=n.dots,u=n.indexes,f=(n.Blob||typeof Blob<"u"&&Blob)&&At.isSpecCompliantForm(t);if(!At.isFunction(o))throw new TypeError("visitor must be a function");function m(T){if(T===null)return"";if(At.isDate(T))return T.toISOString();if(!f&&At.isBlob(T))throw new On("Blob is not supported. Use a Buffer instead.");return At.isArrayBuffer(T)||At.isTypedArray(T)?f&&typeof Blob=="function"?new Blob([T]):Buffer.from(T):T}function y(T,$,H){let I=T;if(T&&!H&&typeof T=="object"){if(At.endsWith($,"{}"))$=i?$:$.slice(0,-2),T=JSON.stringify(T);else if(At.isArray(T)&&Z_(T)||(At.isFileList(T)||At.endsWith($,"[]"))&&(I=At.toArray(T)))return $=e1($),I.forEach(function(se,we){!(At.isUndefined(se)||se===null)&&t.append(u===!0?d0([$],we,a):u===null?$:$+"[]",m(se))}),!1}return vf(T)?!0:(t.append(d0(H,$,a),m(T)),!1)}const x=[],k=Object.assign(K_,{defaultVisitor:y,convertValue:m,isVisitable:vf});function b(T,$){if(!At.isUndefined(T)){if(x.indexOf(T)!==-1)throw Error("Circular reference detected in "+$.join("."));x.push(T),At.forEach(T,function(I,Q){(!(At.isUndefined(I)||I===null)&&o.call(t,I,At.isString(Q)?Q.trim():Q,$,k))===!0&&b(I,$?$.concat(Q):[Q])}),x.pop()}}if(!At.isObject(e))throw new TypeError("data must be an object");return b(e),t}function f0(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(i){return t[i]})}function op(e,t){this._pairs=[],e&&ad(e,this,t)}const t1=op.prototype;t1.append=function(t,n){this._pairs.push([t,n])};t1.toString=function(t){const n=t?function(i){return t.call(this,i,f0)}:f0;return this._pairs.map(function(o){return n(o[0])+"="+n(o[1])},"").join("&")};function Y_(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function n1(e,t,n){if(!t)return e;const i=n&&n.encode||Y_;At.isFunction(n)&&(n={serialize:n});const o=n&&n.serialize;let a;if(o?a=o(t,n):a=At.isURLSearchParams(t)?t.toString():new op(t,n).toString(i),a){const u=e.indexOf("#");u!==-1&&(e=e.slice(0,u)),e+=(e.indexOf("?")===-1?"?":"&")+a}return e}class p0{constructor(){this.handlers=[]}use(t,n,i){return this.handlers.push({fulfilled:t,rejected:n,synchronous:i?i.synchronous:!1,runWhen:i?i.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){At.forEach(this.handlers,function(i){i!==null&&t(i)})}}const i1={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},J_=typeof URLSearchParams<"u"?URLSearchParams:op,X_=typeof FormData<"u"?FormData:null,Q_=typeof Blob<"u"?Blob:null,e4={isBrowser:!0,classes:{URLSearchParams:J_,FormData:X_,Blob:Q_},protocols:["http","https","file","blob","url","data"]},ap=typeof window<"u"&&typeof document<"u",yf=typeof navigator=="object"&&navigator||void 0,t4=ap&&(!yf||["ReactNative","NativeScript","NS"].indexOf(yf.product)<0),n4=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",i4=ap&&window.location.href||"http://localhost",r4=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:ap,hasStandardBrowserEnv:t4,hasStandardBrowserWebWorkerEnv:n4,navigator:yf,origin:i4},Symbol.toStringTag,{value:"Module"})),cs={...r4,...e4};function s4(e,t){return ad(e,new cs.classes.URLSearchParams,Object.assign({visitor:function(n,i,o,a){return cs.isNode&&At.isBuffer(n)?(this.append(i,n.toString("base64")),!1):a.defaultVisitor.apply(this,arguments)}},t))}function o4(e){return At.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function a4(e){const t={},n=Object.keys(e);let i;const o=n.length;let a;for(i=0;i<o;i++)a=n[i],t[a]=e[a];return t}function r1(e){function t(n,i,o,a){let u=n[a++];if(u==="__proto__")return!0;const d=Number.isFinite(+u),f=a>=n.length;return u=!u&&At.isArray(o)?o.length:u,f?(At.hasOwnProp(o,u)?o[u]=[o[u],i]:o[u]=i,!d):((!o[u]||!At.isObject(o[u]))&&(o[u]=[]),t(n,i,o[u],a)&&At.isArray(o[u])&&(o[u]=a4(o[u])),!d)}if(At.isFormData(e)&&At.isFunction(e.entries)){const n={};return At.forEachEntry(e,(i,o)=>{t(o4(i),o,n,0)}),n}return null}function l4(e,t,n){if(At.isString(e))try{return(t||JSON.parse)(e),At.trim(e)}catch(i){if(i.name!=="SyntaxError")throw i}return(n||JSON.stringify)(e)}const Uc={transitional:i1,adapter:["xhr","http","fetch"],transformRequest:[function(t,n){const i=n.getContentType()||"",o=i.indexOf("application/json")>-1,a=At.isObject(t);if(a&&At.isHTMLForm(t)&&(t=new FormData(t)),At.isFormData(t))return o?JSON.stringify(r1(t)):t;if(At.isArrayBuffer(t)||At.isBuffer(t)||At.isStream(t)||At.isFile(t)||At.isBlob(t)||At.isReadableStream(t))return t;if(At.isArrayBufferView(t))return t.buffer;if(At.isURLSearchParams(t))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let d;if(a){if(i.indexOf("application/x-www-form-urlencoded")>-1)return s4(t,this.formSerializer).toString();if((d=At.isFileList(t))||i.indexOf("multipart/form-data")>-1){const f=this.env&&this.env.FormData;return ad(d?{"files[]":t}:t,f&&new f,this.formSerializer)}}return a||o?(n.setContentType("application/json",!1),l4(t)):t}],transformResponse:[function(t){const n=this.transitional||Uc.transitional,i=n&&n.forcedJSONParsing,o=this.responseType==="json";if(At.isResponse(t)||At.isReadableStream(t))return t;if(t&&At.isString(t)&&(i&&!this.responseType||o)){const u=!(n&&n.silentJSONParsing)&&o;try{return JSON.parse(t)}catch(d){if(u)throw d.name==="SyntaxError"?On.from(d,On.ERR_BAD_RESPONSE,this,null,this.response):d}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:cs.classes.FormData,Blob:cs.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};At.forEach(["delete","get","head","post","put","patch"],e=>{Uc.headers[e]={}});const u4=At.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),c4=e=>{const t={};let n,i,o;return e&&e.split(`
`).forEach(function(u){o=u.indexOf(":"),n=u.substring(0,o).trim().toLowerCase(),i=u.substring(o+1).trim(),!(!n||t[n]&&u4[n])&&(n==="set-cookie"?t[n]?t[n].push(i):t[n]=[i]:t[n]=t[n]?t[n]+", "+i:i)}),t},g0=Symbol("internals");function tc(e){return e&&String(e).trim().toLowerCase()}function mh(e){return e===!1||e==null?e:At.isArray(e)?e.map(mh):String(e)}function h4(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let i;for(;i=n.exec(e);)t[i[1]]=i[2];return t}const d4=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function Fd(e,t,n,i,o){if(At.isFunction(i))return i.call(this,t,n);if(o&&(t=n),!!At.isString(t)){if(At.isString(i))return t.indexOf(i)!==-1;if(At.isRegExp(i))return i.test(t)}}function f4(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,n,i)=>n.toUpperCase()+i)}function p4(e,t){const n=At.toCamelCase(" "+t);["get","set","has"].forEach(i=>{Object.defineProperty(e,i+n,{value:function(o,a,u){return this[i].call(this,t,o,a,u)},configurable:!0})})}let Gs=class{constructor(t){t&&this.set(t)}set(t,n,i){const o=this;function a(d,f,m){const y=tc(f);if(!y)throw new Error("header name must be a non-empty string");const x=At.findKey(o,y);(!x||o[x]===void 0||m===!0||m===void 0&&o[x]!==!1)&&(o[x||f]=mh(d))}const u=(d,f)=>At.forEach(d,(m,y)=>a(m,y,f));if(At.isPlainObject(t)||t instanceof this.constructor)u(t,n);else if(At.isString(t)&&(t=t.trim())&&!d4(t))u(c4(t),n);else if(At.isHeaders(t))for(const[d,f]of t.entries())a(f,d,i);else t!=null&&a(n,t,i);return this}get(t,n){if(t=tc(t),t){const i=At.findKey(this,t);if(i){const o=this[i];if(!n)return o;if(n===!0)return h4(o);if(At.isFunction(n))return n.call(this,o,i);if(At.isRegExp(n))return n.exec(o);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,n){if(t=tc(t),t){const i=At.findKey(this,t);return!!(i&&this[i]!==void 0&&(!n||Fd(this,this[i],i,n)))}return!1}delete(t,n){const i=this;let o=!1;function a(u){if(u=tc(u),u){const d=At.findKey(i,u);d&&(!n||Fd(i,i[d],d,n))&&(delete i[d],o=!0)}}return At.isArray(t)?t.forEach(a):a(t),o}clear(t){const n=Object.keys(this);let i=n.length,o=!1;for(;i--;){const a=n[i];(!t||Fd(this,this[a],a,t,!0))&&(delete this[a],o=!0)}return o}normalize(t){const n=this,i={};return At.forEach(this,(o,a)=>{const u=At.findKey(i,a);if(u){n[u]=mh(o),delete n[a];return}const d=t?f4(a):String(a).trim();d!==a&&delete n[a],n[d]=mh(o),i[d]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const n=Object.create(null);return At.forEach(this,(i,o)=>{i!=null&&i!==!1&&(n[o]=t&&At.isArray(i)?i.join(", "):i)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,n])=>t+": "+n).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...n){const i=new this(t);return n.forEach(o=>i.set(o)),i}static accessor(t){const i=(this[g0]=this[g0]={accessors:{}}).accessors,o=this.prototype;function a(u){const d=tc(u);i[d]||(p4(o,u),i[d]=!0)}return At.isArray(t)?t.forEach(a):a(t),this}};Gs.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);At.reduceDescriptors(Gs.prototype,({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(i){this[n]=i}}});At.freezeMethods(Gs);function jd(e,t){const n=this||Uc,i=t||n,o=Gs.from(i.headers);let a=i.data;return At.forEach(e,function(d){a=d.call(n,a,o.normalize(),t?t.status:void 0)}),o.normalize(),a}function s1(e){return!!(e&&e.__CANCEL__)}function Gu(e,t,n){On.call(this,e??"canceled",On.ERR_CANCELED,t,n),this.name="CanceledError"}At.inherits(Gu,On,{__CANCEL__:!0});function o1(e,t,n){const i=n.config.validateStatus;!n.status||!i||i(n.status)?e(n):t(new On("Request failed with status code "+n.status,[On.ERR_BAD_REQUEST,On.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function g4(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function m4(e,t){e=e||10;const n=new Array(e),i=new Array(e);let o=0,a=0,u;return t=t!==void 0?t:1e3,function(f){const m=Date.now(),y=i[a];u||(u=m),n[o]=f,i[o]=m;let x=a,k=0;for(;x!==o;)k+=n[x++],x=x%e;if(o=(o+1)%e,o===a&&(a=(a+1)%e),m-u<t)return;const b=y&&m-y;return b?Math.round(k*1e3/b):void 0}}function v4(e,t){let n=0,i=1e3/t,o,a;const u=(m,y=Date.now())=>{n=y,o=null,a&&(clearTimeout(a),a=null),e.apply(null,m)};return[(...m)=>{const y=Date.now(),x=y-n;x>=i?u(m,y):(o=m,a||(a=setTimeout(()=>{a=null,u(o)},i-x)))},()=>o&&u(o)]}const Oh=(e,t,n=3)=>{let i=0;const o=m4(50,250);return v4(a=>{const u=a.loaded,d=a.lengthComputable?a.total:void 0,f=u-i,m=o(f),y=u<=d;i=u;const x={loaded:u,total:d,progress:d?u/d:void 0,bytes:f,rate:m||void 0,estimated:m&&d&&y?(d-u)/m:void 0,event:a,lengthComputable:d!=null,[t?"download":"upload"]:!0};e(x)},n)},m0=(e,t)=>{const n=e!=null;return[i=>t[0]({lengthComputable:n,total:e,loaded:i}),t[1]]},v0=e=>(...t)=>At.asap(()=>e(...t)),y4=cs.hasStandardBrowserEnv?((e,t)=>n=>(n=new URL(n,cs.origin),e.protocol===n.protocol&&e.host===n.host&&(t||e.port===n.port)))(new URL(cs.origin),cs.navigator&&/(msie|trident)/i.test(cs.navigator.userAgent)):()=>!0,_4=cs.hasStandardBrowserEnv?{write(e,t,n,i,o,a){const u=[e+"="+encodeURIComponent(t)];At.isNumber(n)&&u.push("expires="+new Date(n).toGMTString()),At.isString(i)&&u.push("path="+i),At.isString(o)&&u.push("domain="+o),a===!0&&u.push("secure"),document.cookie=u.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function b4(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function w4(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function a1(e,t){return e&&!b4(t)?w4(e,t):t}const y0=e=>e instanceof Gs?{...e}:e;function au(e,t){t=t||{};const n={};function i(m,y,x,k){return At.isPlainObject(m)&&At.isPlainObject(y)?At.merge.call({caseless:k},m,y):At.isPlainObject(y)?At.merge({},y):At.isArray(y)?y.slice():y}function o(m,y,x,k){if(At.isUndefined(y)){if(!At.isUndefined(m))return i(void 0,m,x,k)}else return i(m,y,x,k)}function a(m,y){if(!At.isUndefined(y))return i(void 0,y)}function u(m,y){if(At.isUndefined(y)){if(!At.isUndefined(m))return i(void 0,m)}else return i(void 0,y)}function d(m,y,x){if(x in t)return i(m,y);if(x in e)return i(void 0,m)}const f={url:a,method:a,data:a,baseURL:u,transformRequest:u,transformResponse:u,paramsSerializer:u,timeout:u,timeoutMessage:u,withCredentials:u,withXSRFToken:u,adapter:u,responseType:u,xsrfCookieName:u,xsrfHeaderName:u,onUploadProgress:u,onDownloadProgress:u,decompress:u,maxContentLength:u,maxBodyLength:u,beforeRedirect:u,transport:u,httpAgent:u,httpsAgent:u,cancelToken:u,socketPath:u,responseEncoding:u,validateStatus:d,headers:(m,y,x)=>o(y0(m),y0(y),x,!0)};return At.forEach(Object.keys(Object.assign({},e,t)),function(y){const x=f[y]||o,k=x(e[y],t[y],y);At.isUndefined(k)&&x!==d||(n[y]=k)}),n}const l1=e=>{const t=au({},e);let{data:n,withXSRFToken:i,xsrfHeaderName:o,xsrfCookieName:a,headers:u,auth:d}=t;t.headers=u=Gs.from(u),t.url=n1(a1(t.baseURL,t.url),e.params,e.paramsSerializer),d&&u.set("Authorization","Basic "+btoa((d.username||"")+":"+(d.password?unescape(encodeURIComponent(d.password)):"")));let f;if(At.isFormData(n)){if(cs.hasStandardBrowserEnv||cs.hasStandardBrowserWebWorkerEnv)u.setContentType(void 0);else if((f=u.getContentType())!==!1){const[m,...y]=f?f.split(";").map(x=>x.trim()).filter(Boolean):[];u.setContentType([m||"multipart/form-data",...y].join("; "))}}if(cs.hasStandardBrowserEnv&&(i&&At.isFunction(i)&&(i=i(t)),i||i!==!1&&y4(t.url))){const m=o&&a&&_4.read(a);m&&u.set(o,m)}return t},x4=typeof XMLHttpRequest<"u",L4=x4&&function(e){return new Promise(function(n,i){const o=l1(e);let a=o.data;const u=Gs.from(o.headers).normalize();let{responseType:d,onUploadProgress:f,onDownloadProgress:m}=o,y,x,k,b,T;function $(){b&&b(),T&&T(),o.cancelToken&&o.cancelToken.unsubscribe(y),o.signal&&o.signal.removeEventListener("abort",y)}let H=new XMLHttpRequest;H.open(o.method.toUpperCase(),o.url,!0),H.timeout=o.timeout;function I(){if(!H)return;const se=Gs.from("getAllResponseHeaders"in H&&H.getAllResponseHeaders()),Be={data:!d||d==="text"||d==="json"?H.responseText:H.response,status:H.status,statusText:H.statusText,headers:se,config:e,request:H};o1(function(Ue){n(Ue),$()},function(Ue){i(Ue),$()},Be),H=null}"onloadend"in H?H.onloadend=I:H.onreadystatechange=function(){!H||H.readyState!==4||H.status===0&&!(H.responseURL&&H.responseURL.indexOf("file:")===0)||setTimeout(I)},H.onabort=function(){H&&(i(new On("Request aborted",On.ECONNABORTED,e,H)),H=null)},H.onerror=function(){i(new On("Network Error",On.ERR_NETWORK,e,H)),H=null},H.ontimeout=function(){let we=o.timeout?"timeout of "+o.timeout+"ms exceeded":"timeout exceeded";const Be=o.transitional||i1;o.timeoutErrorMessage&&(we=o.timeoutErrorMessage),i(new On(we,Be.clarifyTimeoutError?On.ETIMEDOUT:On.ECONNABORTED,e,H)),H=null},a===void 0&&u.setContentType(null),"setRequestHeader"in H&&At.forEach(u.toJSON(),function(we,Be){H.setRequestHeader(Be,we)}),At.isUndefined(o.withCredentials)||(H.withCredentials=!!o.withCredentials),d&&d!=="json"&&(H.responseType=o.responseType),m&&([k,T]=Oh(m,!0),H.addEventListener("progress",k)),f&&H.upload&&([x,b]=Oh(f),H.upload.addEventListener("progress",x),H.upload.addEventListener("loadend",b)),(o.cancelToken||o.signal)&&(y=se=>{H&&(i(!se||se.type?new Gu(null,e,H):se),H.abort(),H=null)},o.cancelToken&&o.cancelToken.subscribe(y),o.signal&&(o.signal.aborted?y():o.signal.addEventListener("abort",y)));const Q=g4(o.url);if(Q&&cs.protocols.indexOf(Q)===-1){i(new On("Unsupported protocol "+Q+":",On.ERR_BAD_REQUEST,e));return}H.send(a||null)})},C4=(e,t)=>{const{length:n}=e=e?e.filter(Boolean):[];if(t||n){let i=new AbortController,o;const a=function(m){if(!o){o=!0,d();const y=m instanceof Error?m:this.reason;i.abort(y instanceof On?y:new Gu(y instanceof Error?y.message:y))}};let u=t&&setTimeout(()=>{u=null,a(new On(`timeout ${t} of ms exceeded`,On.ETIMEDOUT))},t);const d=()=>{e&&(u&&clearTimeout(u),u=null,e.forEach(m=>{m.unsubscribe?m.unsubscribe(a):m.removeEventListener("abort",a)}),e=null)};e.forEach(m=>m.addEventListener("abort",a));const{signal:f}=i;return f.unsubscribe=()=>At.asap(d),f}},P4=function*(e,t){let n=e.byteLength;if(n<t){yield e;return}let i=0,o;for(;i<n;)o=i+t,yield e.slice(i,o),i=o},k4=async function*(e,t){for await(const n of E4(e))yield*P4(n,t)},E4=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:n,value:i}=await t.read();if(n)break;yield i}}finally{await t.cancel()}},_0=(e,t,n,i)=>{const o=k4(e,t);let a=0,u,d=f=>{u||(u=!0,i&&i(f))};return new ReadableStream({async pull(f){try{const{done:m,value:y}=await o.next();if(m){d(),f.close();return}let x=y.byteLength;if(n){let k=a+=x;n(k)}f.enqueue(new Uint8Array(y))}catch(m){throw d(m),m}},cancel(f){return d(f),o.return()}},{highWaterMark:2})},ld=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",u1=ld&&typeof ReadableStream=="function",S4=ld&&(typeof TextEncoder=="function"?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),c1=(e,...t)=>{try{return!!e(...t)}catch{return!1}},A4=u1&&c1(()=>{let e=!1;const t=new Request(cs.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),b0=64*1024,_f=u1&&c1(()=>At.isReadableStream(new Response("").body)),Ih={stream:_f&&(e=>e.body)};ld&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!Ih[t]&&(Ih[t]=At.isFunction(e[t])?n=>n[t]():(n,i)=>{throw new On(`Response type '${t}' is not supported`,On.ERR_NOT_SUPPORT,i)})})})(new Response);const M4=async e=>{if(e==null)return 0;if(At.isBlob(e))return e.size;if(At.isSpecCompliantForm(e))return(await new Request(cs.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(At.isArrayBufferView(e)||At.isArrayBuffer(e))return e.byteLength;if(At.isURLSearchParams(e)&&(e=e+""),At.isString(e))return(await S4(e)).byteLength},B4=async(e,t)=>{const n=At.toFiniteNumber(e.getContentLength());return n??M4(t)},T4=ld&&(async e=>{let{url:t,method:n,data:i,signal:o,cancelToken:a,timeout:u,onDownloadProgress:d,onUploadProgress:f,responseType:m,headers:y,withCredentials:x="same-origin",fetchOptions:k}=l1(e);m=m?(m+"").toLowerCase():"text";let b=C4([o,a&&a.toAbortSignal()],u),T;const $=b&&b.unsubscribe&&(()=>{b.unsubscribe()});let H;try{if(f&&A4&&n!=="get"&&n!=="head"&&(H=await B4(y,i))!==0){let Be=new Request(t,{method:"POST",body:i,duplex:"half"}),$e;if(At.isFormData(i)&&($e=Be.headers.get("content-type"))&&y.setContentType($e),Be.body){const[Ue,Pe]=m0(H,Oh(v0(f)));i=_0(Be.body,b0,Ue,Pe)}}At.isString(x)||(x=x?"include":"omit");const I="credentials"in Request.prototype;T=new Request(t,{...k,signal:b,method:n.toUpperCase(),headers:y.normalize().toJSON(),body:i,duplex:"half",credentials:I?x:void 0});let Q=await fetch(T);const se=_f&&(m==="stream"||m==="response");if(_f&&(d||se&&$)){const Be={};["status","statusText","headers"].forEach(Te=>{Be[Te]=Q[Te]});const $e=At.toFiniteNumber(Q.headers.get("content-length")),[Ue,Pe]=d&&m0($e,Oh(v0(d),!0))||[];Q=new Response(_0(Q.body,b0,Ue,()=>{Pe&&Pe(),$&&$()}),Be)}m=m||"text";let we=await Ih[At.findKey(Ih,m)||"text"](Q,e);return!se&&$&&$(),await new Promise((Be,$e)=>{o1(Be,$e,{data:we,headers:Gs.from(Q.headers),status:Q.status,statusText:Q.statusText,config:e,request:T})})}catch(I){throw $&&$(),I&&I.name==="TypeError"&&/fetch/i.test(I.message)?Object.assign(new On("Network Error",On.ERR_NETWORK,e,T),{cause:I.cause||I}):On.from(I,I&&I.code,e,T)}}),bf={http:W_,xhr:L4,fetch:T4};At.forEach(bf,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const w0=e=>`- ${e}`,N4=e=>At.isFunction(e)||e===null||e===!1,h1={getAdapter:e=>{e=At.isArray(e)?e:[e];const{length:t}=e;let n,i;const o={};for(let a=0;a<t;a++){n=e[a];let u;if(i=n,!N4(n)&&(i=bf[(u=String(n)).toLowerCase()],i===void 0))throw new On(`Unknown adapter '${u}'`);if(i)break;o[u||"#"+a]=i}if(!i){const a=Object.entries(o).map(([d,f])=>`adapter ${d} `+(f===!1?"is not supported by the environment":"is not available in the build"));let u=t?a.length>1?`since :
`+a.map(w0).join(`
`):" "+w0(a[0]):"as no adapter specified";throw new On("There is no suitable adapter to dispatch the request "+u,"ERR_NOT_SUPPORT")}return i},adapters:bf};function zd(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Gu(null,e)}function x0(e){return zd(e),e.headers=Gs.from(e.headers),e.data=jd.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),h1.getAdapter(e.adapter||Uc.adapter)(e).then(function(i){return zd(e),i.data=jd.call(e,e.transformResponse,i),i.headers=Gs.from(i.headers),i},function(i){return s1(i)||(zd(e),i&&i.response&&(i.response.data=jd.call(e,e.transformResponse,i.response),i.response.headers=Gs.from(i.response.headers))),Promise.reject(i)})}const d1="1.7.9",ud={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{ud[e]=function(i){return typeof i===e||"a"+(t<1?"n ":" ")+e}});const L0={};ud.transitional=function(t,n,i){function o(a,u){return"[Axios v"+d1+"] Transitional option '"+a+"'"+u+(i?". "+i:"")}return(a,u,d)=>{if(t===!1)throw new On(o(u," has been removed"+(n?" in "+n:"")),On.ERR_DEPRECATED);return n&&!L0[u]&&(L0[u]=!0,console.warn(o(u," has been deprecated since v"+n+" and will be removed in the near future"))),t?t(a,u,d):!0}};ud.spelling=function(t){return(n,i)=>(console.warn(`${i} is likely a misspelling of ${t}`),!0)};function D4(e,t,n){if(typeof e!="object")throw new On("options must be an object",On.ERR_BAD_OPTION_VALUE);const i=Object.keys(e);let o=i.length;for(;o-- >0;){const a=i[o],u=t[a];if(u){const d=e[a],f=d===void 0||u(d,a,e);if(f!==!0)throw new On("option "+a+" must be "+f,On.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new On("Unknown option "+a,On.ERR_BAD_OPTION)}}const vh={assertOptions:D4,validators:ud},Pa=vh.validators;let iu=class{constructor(t){this.defaults=t,this.interceptors={request:new p0,response:new p0}}async request(t,n){try{return await this._request(t,n)}catch(i){if(i instanceof Error){let o={};Error.captureStackTrace?Error.captureStackTrace(o):o=new Error;const a=o.stack?o.stack.replace(/^.+\n/,""):"";try{i.stack?a&&!String(i.stack).endsWith(a.replace(/^.+\n.+\n/,""))&&(i.stack+=`
`+a):i.stack=a}catch{}}throw i}}_request(t,n){typeof t=="string"?(n=n||{},n.url=t):n=t||{},n=au(this.defaults,n);const{transitional:i,paramsSerializer:o,headers:a}=n;i!==void 0&&vh.assertOptions(i,{silentJSONParsing:Pa.transitional(Pa.boolean),forcedJSONParsing:Pa.transitional(Pa.boolean),clarifyTimeoutError:Pa.transitional(Pa.boolean)},!1),o!=null&&(At.isFunction(o)?n.paramsSerializer={serialize:o}:vh.assertOptions(o,{encode:Pa.function,serialize:Pa.function},!0)),vh.assertOptions(n,{baseUrl:Pa.spelling("baseURL"),withXsrfToken:Pa.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let u=a&&At.merge(a.common,a[n.method]);a&&At.forEach(["delete","get","head","post","put","patch","common"],T=>{delete a[T]}),n.headers=Gs.concat(u,a);const d=[];let f=!0;this.interceptors.request.forEach(function($){typeof $.runWhen=="function"&&$.runWhen(n)===!1||(f=f&&$.synchronous,d.unshift($.fulfilled,$.rejected))});const m=[];this.interceptors.response.forEach(function($){m.push($.fulfilled,$.rejected)});let y,x=0,k;if(!f){const T=[x0.bind(this),void 0];for(T.unshift.apply(T,d),T.push.apply(T,m),k=T.length,y=Promise.resolve(n);x<k;)y=y.then(T[x++],T[x++]);return y}k=d.length;let b=n;for(x=0;x<k;){const T=d[x++],$=d[x++];try{b=T(b)}catch(H){$.call(this,H);break}}try{y=x0.call(this,b)}catch(T){return Promise.reject(T)}for(x=0,k=m.length;x<k;)y=y.then(m[x++],m[x++]);return y}getUri(t){t=au(this.defaults,t);const n=a1(t.baseURL,t.url);return n1(n,t.params,t.paramsSerializer)}};At.forEach(["delete","get","head","options"],function(t){iu.prototype[t]=function(n,i){return this.request(au(i||{},{method:t,url:n,data:(i||{}).data}))}});At.forEach(["post","put","patch"],function(t){function n(i){return function(a,u,d){return this.request(au(d||{},{method:t,headers:i?{"Content-Type":"multipart/form-data"}:{},url:a,data:u}))}}iu.prototype[t]=n(),iu.prototype[t+"Form"]=n(!0)});let R4=class f1{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(a){n=a});const i=this;this.promise.then(o=>{if(!i._listeners)return;let a=i._listeners.length;for(;a-- >0;)i._listeners[a](o);i._listeners=null}),this.promise.then=o=>{let a;const u=new Promise(d=>{i.subscribe(d),a=d}).then(o);return u.cancel=function(){i.unsubscribe(a)},u},t(function(a,u,d){i.reason||(i.reason=new Gu(a,u,d),n(i.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const n=this._listeners.indexOf(t);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const t=new AbortController,n=i=>{t.abort(i)};return this.subscribe(n),t.signal.unsubscribe=()=>this.unsubscribe(n),t.signal}static source(){let t;return{token:new f1(function(o){t=o}),cancel:t}}};function O4(e){return function(n){return e.apply(null,n)}}function I4(e){return At.isObject(e)&&e.isAxiosError===!0}const wf={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(wf).forEach(([e,t])=>{wf[t]=e});function p1(e){const t=new iu(e),n=Vm(iu.prototype.request,t);return At.extend(n,iu.prototype,t,{allOwnKeys:!0}),At.extend(n,t,null,{allOwnKeys:!0}),n.create=function(o){return p1(au(e,o))},n}const ar=p1(Uc);ar.Axios=iu;ar.CanceledError=Gu;ar.CancelToken=R4;ar.isCancel=s1;ar.VERSION=d1;ar.toFormData=ad;ar.AxiosError=On;ar.Cancel=ar.CanceledError;ar.all=function(t){return Promise.all(t)};ar.spread=O4;ar.isAxiosError=I4;ar.mergeConfig=au;ar.AxiosHeaders=Gs;ar.formToJSON=e=>r1(At.isHTMLForm(e)?new FormData(e):e);ar.getAdapter=h1.getAdapter;ar.HttpStatusCode=wf;ar.default=ar;const{Axios:GS,AxiosError:HS,CanceledError:WS,isCancel:ZS,CancelToken:KS,VERSION:YS,all:JS,Cancel:XS,isAxiosError:QS,spread:eA,toFormData:tA,AxiosHeaders:nA,HttpStatusCode:iA,formToJSON:rA,getAdapter:sA,mergeConfig:oA}=ar,fn=ar.create({baseURL:"/api",headers:{"Content-Type":"application/json",Accept:"application/json"},withCredentials:!0});function g1(e){var i;const n=`; ${document.cookie}`.split(`; ${e}=`);return n.length===2&&((i=n.pop())==null?void 0:i.split(";").shift())||null}fn.interceptors.request.use(e=>{const t=g1("access_token");return t&&(e.headers.Authorization=`Bearer ${t}`),console.log("Request config:",{url:e.url,method:e.method,headers:e.headers,withCredentials:e.withCredentials}),e},e=>(console.error("Request interceptor error:",e),Promise.reject(e)));fn.interceptors.response.use(e=>e,async e=>{var n;const t=e.config;if(((n=e.response)==null?void 0:n.status)===401&&!t._retry){t._retry=!0;try{await Es().refreshToken();const o=g1("access_token");if(o)return t.headers.Authorization=`Bearer ${o}`,fn(t)}catch(i){console.error("Token refresh failed:",i),window.location.href="/login"}}return Promise.reject(e)});function F4(e){var n;const t=[];if((n=e.response)!=null&&n.data){const i=e.response.data;typeof i=="object"&&!Array.isArray(i)?Object.entries(i).forEach(([o,a])=>{Array.isArray(a)?a.forEach(u=>{t.push({field:o,message:u})}):typeof a=="string"&&t.push({field:o,message:a})}):typeof i=="string"?t.push({field:"non_field_error",message:i}):i.detail&&t.push({field:"non_field_error",message:i.detail})}else e.message&&t.push({field:"non_field_error",message:`Erreur de connexion: ${e.message}`});return t.length===0&&t.push({field:"non_field_error",message:"Une erreur inconnue s'est produite"}),t}async function yh(e){console.log("[fetchUsersByHierarchy] Récupération des utilisateurs:",e);const t={role:e.role};e.usineId&&(t.usine=e.usineId),e.concessionnaireId&&(t.concessionnaire=e.concessionnaireId),e.includeDetails&&(t.include_plans=!0),e.search&&(t.search=e.search),console.log("[fetchUsersByHierarchy] Filtres appliqués:",t);try{const n=await uo.getUsers(t);return console.log(`[fetchUsersByHierarchy] Résultat (${n.data.length} utilisateurs):`,n.data),n.data}catch(n){throw console.error("[fetchUsersByHierarchy] Erreur lors de la récupération des utilisateurs:",n),n}}const uo={async getUsers(e={}){return await fn.get("/users/",{params:e})},async getUser(e){return await fn.get(`/users/${e}/`)},async createUser(e){return await fn.post("/users/",e)},async updateUser(e,t){return await fn.patch(`/users/${e}/`,t)},async deleteUser(e){return await fn.delete(`/users/${e}/`)},async getUsines(){return await fn.get("/users/",{params:{role:"USINE"}})},async getConcessionnaires(e){const t={role:"CONCESSIONNAIRE"};return e&&(t.usine=e),await fn.get("/users/",{params:t})},async getConcessionnaireAgriculteurs(e){return await fn.get("/users/",{params:{role:"AGRICULTEUR",concessionnaire:e}})},async getUsineAgriculteurs(e){return await fn.get("/users/",{params:{role:"AGRICULTEUR",usine:e}})},async getUsersByHierarchy(e){const t={role:e.role};return e.usineId&&(t.usine=e.usineId),e.concessionnaireId&&(t.concessionnaire=e.concessionnaireId),e.includeDetails&&(t.include_plans=!0),e.search&&(t.search=e.search),await fn.get("/users/",{params:t})},async getUsineConcessionnaires(e){return await fn.get("/users/",{params:{role:"CONCESSIONNAIRE",usine:e}})},async getAgriculteurs(e,t){const n={role:"AGRICULTEUR"};return e&&(n.concessionnaire=e),t&&(n.usine=t),await fn.get("/users/",{params:n})},async assignUsineToConcessionnaire(e,t){return await fn.patch(`/users/${e}/`,{usine:t})},async assignConcessionnaireToAgriculteur(e,t){return await fn.patch(`/users/${e}/`,{concessionnaire:t})}},ih={async getPlans(){return await fn.get("/plans/")},async createPlan(e){const t={...e,usine:e.usine?typeof e.usine=="object"&&"id"in e.usine?e.usine.id:Number(e.usine):null,concessionnaire:e.concessionnaire?typeof e.concessionnaire=="object"&&"id"in e.concessionnaire?e.concessionnaire.id:Number(e.concessionnaire):null,agriculteur:e.agriculteur?typeof e.agriculteur=="object"&&"id"in e.agriculteur?e.agriculteur.id:Number(e.agriculteur):null};return console.log("[api] Données formatées pour création:",t),await fn.post("/plans/",t)},async updatePlan(e,t){return await fn.put(`/plans/${e}/`,t)},async deletePlan(e){return await fn.delete(`/plans/${e}/`)},async getAgriculteurPlans(e){return await fn.get("/plans/",{params:{agriculteur:e}})},async createPlanForAgriculteur(e){return await fn.post("/plans/",e)},async getUsinePlans(e){return await fn.get("/plans/",{params:{usine:e}})},async getConcessionnairePlans(e){return await fn.get("/plans/",{params:{concessionnaire:e}})},async createPlanForConcessionnaire(e,t){const n={...e,concessionnaire:t};return await fn.post("/plans/",n)},async createPlanForUsine(e,t){const n={...e,usine:t};return await fn.post("/plans/",n)}};fn.defaults.baseURL="/api";fn.defaults.headers.common["Content-Type"]="application/json";fn.defaults.withCredentials=!0;function Fh(e){var i;const n=`; ${document.cookie}`.split(`; ${e}=`);return n.length===2&&((i=n.pop())==null?void 0:i.split(";").shift())||null}fn.interceptors.request.use(e=>{const t=Fh("access_token");return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>(console.error("Request interceptor error:",e),Promise.reject(e)));fn.interceptors.response.use(e=>e,async e=>{var i,o;const t=Es(),n=e.config;if(((i=e.response)==null?void 0:i.status)===401&&!n._retry&&!((o=n.url)!=null&&o.includes("/token/refresh/"))){n._retry=!0;try{if(!Fh("access_token"))throw new Error("No token available");await t.refreshToken();const u=Fh("access_token");if(u)return n.headers.Authorization=`Bearer ${u}`,fn(n)}catch(a){console.error("Token refresh failed:",a),await t.logout(),window.location.pathname!=="/login"&&(window.location.href="/login")}}return Promise.reject(e)});function j4(e,t,n=1){const i=new Date;i.setTime(i.getTime()+n*24*60*60*1e3);const o=`expires=${i.toUTCString()}`;document.cookie=`${e}=${t};${o};path=/;secure;samesite=Strict`}function co(e){if(!e)return"-";const t=e.first_name||"",n=e.last_name?e.last_name.toUpperCase():"",i=`${t} ${n}`.trim(),o=e.company_name||e.role||"";return!i&&!o?"-":i?o?`${i} (${o})`:i:`(${o})`}function z4(e="",t=""){return`${(e==null?void 0:e.charAt(0))||""}${(t==null?void 0:t.charAt(0))||""}`.toUpperCase()}const U4={ADMIN:"Administrateur",USINE:"Usine",CONCESSIONNAIRE:"Concessionnaire",AGRICULTEUR:"Agriculteur"};function $4(e){return U4[e]||e}function q4(){return"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-gray-100 text-gray-800"}function V4(e){return e?"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800":"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800"}async function G4({role:e,usineId:t,concessionnaireId:n,includeDetails:i=!1}){const o={role:e};return t&&(o.usine=t),n&&(o.concessionnaire=n),i&&(o.include_plans=!0),(await uo.getUsers(o)).data}const Es=id("auth",{state:()=>({user:null,isAuthenticated:!1,mustChangePassword:!1,initialized:!1,loading:!1,error:null,concessionnaires:[],usines:[],concessionnaires_list:[],agriculteurs:[]}),getters:{isAdmin:e=>{var t;return((t=e.user)==null?void 0:t.user_type)==="admin"},isUsine:e=>{var t;return((t=e.user)==null?void 0:t.user_type)==="usine"},isConcessionnaire:e=>{var t;return((t=e.user)==null?void 0:t.user_type)==="concessionnaire"},isAgriculteur:e=>{var t;return((t=e.user)==null?void 0:t.user_type)==="agriculteur"},currentUser:e=>e.user,hasConcessionnaire:e=>{var t;return!!((t=e.user)!=null&&t.concessionnaire)},hasUsine:e=>{var t;return!!((t=e.user)!=null&&t.usine)}},actions:{async initialize(e){if(!e){const n=await this.restoreSession();return this.initialized=!0,n}if(e.isAuthenticated&&e.user)return this.user=e.user,this.isAuthenticated=!0,this.mustChangePassword=e.user.must_change_password||!1,this.initialized=!0,!0;const t=await this.restoreSession();return this.initialized=!0,t},async restoreSession(){try{if(!Fh("access_token"))return this.isAuthenticated=!1,this.user=null,!1;const t=await fn.post("/token/refresh/");return t.data.user?(this.user=t.data.user,this.isAuthenticated=!0,this.mustChangePassword=t.data.user.must_change_password||!1,!0):(await this.fetchUserProfile(),!0)}catch(e){return console.error("Failed to restore session:",e),this.isAuthenticated=!1,this.user=null,!1}},async login(e,t){var n,i,o;try{const a=await fn.post("/token/",{username:e,password:t});if(!a.data.access)throw new Error("Token d'accès non reçu");document.cookie=`access_token=${a.data.access}; path=/; secure; samesite=Strict`;const u=await this.fetchUserProfile();return this.user=u,this.isAuthenticated=!0,!0}catch(a){throw this.isAuthenticated=!1,this.user=null,((n=a.response)==null?void 0:n.status)===401?new Error("Identifiants incorrects"):(o=(i=a.response)==null?void 0:i.data)!=null&&o.detail?new Error(a.response.data.detail):a}},async logout(){this.user=null,this.isAuthenticated=!1,this.mustChangePassword=!1,document.cookie="access_token=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT",document.cookie="refresh_token=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT"},async checkAuth(){try{return await this.fetchUserProfile(),!0}catch{return this.isAuthenticated=!1,this.user=null,!1}},async fetchUserProfile(){try{const e=await fn.get("/users/me/");return this.user=e.data,this.isAuthenticated=!0,this.mustChangePassword=e.data.must_change_password||!1,e.data}catch(e){throw this.isAuthenticated=!1,this.user=null,e}},async changePassword(e,t){try{const n=await fn.post("/users/change_password/",{old_password:e,password:t});return this.user={...this.user,must_change_password:!1},n.data}catch(n){throw console.error("Password change error:",n),n}},async refreshToken(){var e,t,n,i;try{const o=await fn.post("/token/refresh/",{},{withCredentials:!0}),{access:a}=o.data;if(!a)throw new Error("No access token received");return j4("access_token",a,1),this.isAuthenticated=!0,a}catch(o){throw console.error("Error refreshing token:",{status:(e=o.response)==null?void 0:e.status,data:(t=o.response)==null?void 0:t.data}),(((n=o.response)==null?void 0:n.status)===401||((i=o.response)==null?void 0:i.status)===403)&&await this.logout(),o}},async fetchUsers(e={}){this.loading=!0;try{return(await uo.getUsers(e)).data}catch(t){throw this.error="Erreur lors de la récupération des utilisateurs",t}finally{this.loading=!1}},async fetchUsines(){this.loading=!0;try{const e=await uo.getUsines();return this.usines=e.data,this.usines}catch(e){throw this.error="Erreur lors de la récupération des usines",e}finally{this.loading=!1}},async fetchUsineConcessionnaires(e){this.loading=!0;try{const t=await uo.getUsineConcessionnaires(e);return this.concessionnaires_list=t.data,this.concessionnaires_list}catch(t){throw this.error="Erreur lors de la récupération des concessionnaires de l'usine",t}finally{this.loading=!1}},async fetchConcessionnaireAgriculteurs(e){this.loading=!0;try{const t=await uo.getAgriculteurs(e);return this.agriculteurs=Array.isArray(t.data)?t.data:[t.data],this.agriculteurs}catch(t){throw this.error="Erreur lors de la récupération des agriculteurs",t}finally{this.loading=!1}},async fetchUsineAgriculteurs(e){this.loading=!0;try{const t=await uo.getAgriculteurs(void 0,e);return Array.isArray(t.data)?t.data:[t.data]}catch(t){throw this.error="Erreur lors de la récupération des agriculteurs de l'usine",t}finally{this.loading=!1}},async setUsineForConcessionnaire(e,t){this.loading=!0;try{return await uo.assignUsineToConcessionnaire(e,t)}catch(n){throw this.error="Erreur lors de l'assignation de l'usine au concessionnaire",n}finally{this.loading=!1}},async setConcessionnaireForAgriculteur(e,t){this.loading=!0;try{return await uo.assignConcessionnaireToAgriculteur(e,t)}catch(n){throw this.error="Erreur lors de l'assignation du concessionnaire à l'agriculteur",n}finally{this.loading=!1}},async createUser(e){this.loading=!0;try{return(await uo.createUser(e)).data}catch(t){throw this.error="Erreur lors de la création de l'utilisateur",t}finally{this.loading=!1}},async updateUser(e,t){this.loading=!0;try{return(await uo.updateUser(e,t)).data}catch(n){throw this.error="Erreur lors de la mise à jour de l'utilisateur",n}finally{this.loading=!1}},async deleteUser(e){this.loading=!0;try{return await uo.deleteUser(e),!0}catch(t){throw this.error="Erreur lors de la suppression de l'utilisateur",t}finally{this.loading=!1}},async fetchConcessionnairesLegacy(){this.loading=!0;try{const e=await fn.get("/users/",{params:{role:"concessionnaire"}});this.concessionnaires=e.data}catch(e){throw this.error="Erreur lors de la récupération des concessionnaires",e}finally{this.loading=!1}},async setConcessionnaire(e,t){this.loading=!0;try{await fn.patch(`/users/${e}/`,{concessionnaire:t}),this.user&&this.user.id===e&&(this.user.concessionnaire=t)}catch(n){throw this.error="Erreur lors de la mise à jour du concessionnaire",n}finally{this.loading=!1}},async updateUserRole(e,t){this.loading=!0;try{const n=await fn.patch(`/users/${e}/`,{role:t});return this.user&&this.user.id===e&&(this.user.user_type=t),n.data}catch(n){throw this.error="Erreur lors de la mise à jour du rôle",n}finally{this.loading=!1}},async updateUserEmail(e){var t;this.loading=!0;try{const n=await fn.patch(`/users/${(t=this.user)==null?void 0:t.id}/`,{email:e});return this.user&&(this.user.email=e),n.data}catch(n){throw this.error="Erreur lors de la mise à jour de l'email",n}finally{this.loading=!1}},checkAccess(e){return this.user?e.includes(this.user.user_type):!1},async fetchUsersByRole(e){this.loading=!0;try{return await G4(e)}catch(t){throw console.error(`Error fetching ${e.role}:`,t),t}finally{this.loading=!1}}}});/*!
  * vue-router v4.5.0
  * (c) 2024 Eduardo San Martin Morote
  * @license MIT
  */const Pu=typeof document<"u";function m1(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function H4(e){return e.__esModule||e[Symbol.toStringTag]==="Module"||e.default&&m1(e.default)}const di=Object.assign;function Ud(e,t){const n={};for(const i in t){const o=t[i];n[i]=sa(o)?o.map(e):e(o)}return n}const vc=()=>{},sa=Array.isArray,v1=/#/g,W4=/&/g,Z4=/\//g,K4=/=/g,Y4=/\?/g,y1=/\+/g,J4=/%5B/g,X4=/%5D/g,_1=/%5E/g,Q4=/%60/g,b1=/%7B/g,e5=/%7C/g,w1=/%7D/g,t5=/%20/g;function lp(e){return encodeURI(""+e).replace(e5,"|").replace(J4,"[").replace(X4,"]")}function n5(e){return lp(e).replace(b1,"{").replace(w1,"}").replace(_1,"^")}function xf(e){return lp(e).replace(y1,"%2B").replace(t5,"+").replace(v1,"%23").replace(W4,"%26").replace(Q4,"`").replace(b1,"{").replace(w1,"}").replace(_1,"^")}function i5(e){return xf(e).replace(K4,"%3D")}function r5(e){return lp(e).replace(v1,"%23").replace(Y4,"%3F")}function s5(e){return e==null?"":r5(e).replace(Z4,"%2F")}function Mc(e){try{return decodeURIComponent(""+e)}catch{}return""+e}const o5=/\/$/,a5=e=>e.replace(o5,"");function $d(e,t,n="/"){let i,o={},a="",u="";const d=t.indexOf("#");let f=t.indexOf("?");return d<f&&d>=0&&(f=-1),f>-1&&(i=t.slice(0,f),a=t.slice(f+1,d>-1?d:t.length),o=e(a)),d>-1&&(i=i||t.slice(0,d),u=t.slice(d,t.length)),i=h5(i??t,n),{fullPath:i+(a&&"?")+a+u,path:i,query:o,hash:Mc(u)}}function l5(e,t){const n=t.query?e(t.query):"";return t.path+(n&&"?")+n+(t.hash||"")}function C0(e,t){return!t||!e.toLowerCase().startsWith(t.toLowerCase())?e:e.slice(t.length)||"/"}function u5(e,t,n){const i=t.matched.length-1,o=n.matched.length-1;return i>-1&&i===o&&Uu(t.matched[i],n.matched[o])&&x1(t.params,n.params)&&e(t.query)===e(n.query)&&t.hash===n.hash}function Uu(e,t){return(e.aliasOf||e)===(t.aliasOf||t)}function x1(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(!c5(e[n],t[n]))return!1;return!0}function c5(e,t){return sa(e)?P0(e,t):sa(t)?P0(t,e):e===t}function P0(e,t){return sa(t)?e.length===t.length&&e.every((n,i)=>n===t[i]):e.length===1&&e[0]===t}function h5(e,t){if(e.startsWith("/"))return e;if(!e)return t;const n=t.split("/"),i=e.split("/"),o=i[i.length-1];(o===".."||o===".")&&i.push("");let a=n.length-1,u,d;for(u=0;u<i.length;u++)if(d=i[u],d!==".")if(d==="..")a>1&&a--;else break;return n.slice(0,a).join("/")+"/"+i.slice(u).join("/")}const _l={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};var Bc;(function(e){e.pop="pop",e.push="push"})(Bc||(Bc={}));var yc;(function(e){e.back="back",e.forward="forward",e.unknown=""})(yc||(yc={}));function d5(e){if(!e)if(Pu){const t=document.querySelector("base");e=t&&t.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),a5(e)}const f5=/^[^#]+#/;function p5(e,t){return e.replace(f5,"#")+t}function g5(e,t){const n=document.documentElement.getBoundingClientRect(),i=e.getBoundingClientRect();return{behavior:t.behavior,left:i.left-n.left-(t.left||0),top:i.top-n.top-(t.top||0)}}const cd=()=>({left:window.scrollX,top:window.scrollY});function m5(e){let t;if("el"in e){const n=e.el,i=typeof n=="string"&&n.startsWith("#"),o=typeof n=="string"?i?document.getElementById(n.slice(1)):document.querySelector(n):n;if(!o)return;t=g5(o,e)}else t=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(t.left!=null?t.left:window.scrollX,t.top!=null?t.top:window.scrollY)}function k0(e,t){return(history.state?history.state.position-t:-1)+e}const Lf=new Map;function v5(e,t){Lf.set(e,t)}function y5(e){const t=Lf.get(e);return Lf.delete(e),t}let _5=()=>location.protocol+"//"+location.host;function L1(e,t){const{pathname:n,search:i,hash:o}=t,a=e.indexOf("#");if(a>-1){let d=o.includes(e.slice(a))?e.slice(a).length:1,f=o.slice(d);return f[0]!=="/"&&(f="/"+f),C0(f,"")}return C0(n,e)+i+o}function b5(e,t,n,i){let o=[],a=[],u=null;const d=({state:k})=>{const b=L1(e,location),T=n.value,$=t.value;let H=0;if(k){if(n.value=b,t.value=k,u&&u===T){u=null;return}H=$?k.position-$.position:0}else i(b);o.forEach(I=>{I(n.value,T,{delta:H,type:Bc.pop,direction:H?H>0?yc.forward:yc.back:yc.unknown})})};function f(){u=n.value}function m(k){o.push(k);const b=()=>{const T=o.indexOf(k);T>-1&&o.splice(T,1)};return a.push(b),b}function y(){const{history:k}=window;k.state&&k.replaceState(di({},k.state,{scroll:cd()}),"")}function x(){for(const k of a)k();a=[],window.removeEventListener("popstate",d),window.removeEventListener("beforeunload",y)}return window.addEventListener("popstate",d),window.addEventListener("beforeunload",y,{passive:!0}),{pauseListeners:f,listen:m,destroy:x}}function E0(e,t,n,i=!1,o=!1){return{back:e,current:t,forward:n,replaced:i,position:window.history.length,scroll:o?cd():null}}function w5(e){const{history:t,location:n}=window,i={value:L1(e,n)},o={value:t.state};o.value||a(i.value,{back:null,current:i.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0);function a(f,m,y){const x=e.indexOf("#"),k=x>-1?(n.host&&document.querySelector("base")?e:e.slice(x))+f:_5()+e+f;try{t[y?"replaceState":"pushState"](m,"",k),o.value=m}catch(b){console.error(b),n[y?"replace":"assign"](k)}}function u(f,m){const y=di({},t.state,E0(o.value.back,f,o.value.forward,!0),m,{position:o.value.position});a(f,y,!0),i.value=f}function d(f,m){const y=di({},o.value,t.state,{forward:f,scroll:cd()});a(y.current,y,!0);const x=di({},E0(i.value,f,null),{position:y.position+1},m);a(f,x,!1),i.value=f}return{location:i,state:o,push:d,replace:u}}function x5(e){e=d5(e);const t=w5(e),n=b5(e,t.state,t.location,t.replace);function i(a,u=!0){u||n.pauseListeners(),history.go(a)}const o=di({location:"",base:e,go:i,createHref:p5.bind(null,e)},t,n);return Object.defineProperty(o,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(o,"state",{enumerable:!0,get:()=>t.state.value}),o}function L5(e){return typeof e=="string"||e&&typeof e=="object"}function C1(e){return typeof e=="string"||typeof e=="symbol"}const P1=Symbol("");var S0;(function(e){e[e.aborted=4]="aborted",e[e.cancelled=8]="cancelled",e[e.duplicated=16]="duplicated"})(S0||(S0={}));function $u(e,t){return di(new Error,{type:e,[P1]:!0},t)}function Ya(e,t){return e instanceof Error&&P1 in e&&(t==null||!!(e.type&t))}const A0="[^/]+?",C5={sensitive:!1,strict:!1,start:!0,end:!0},P5=/[.+*?^${}()[\]/\\]/g;function k5(e,t){const n=di({},C5,t),i=[];let o=n.start?"^":"";const a=[];for(const m of e){const y=m.length?[]:[90];n.strict&&!m.length&&(o+="/");for(let x=0;x<m.length;x++){const k=m[x];let b=40+(n.sensitive?.25:0);if(k.type===0)x||(o+="/"),o+=k.value.replace(P5,"\\$&"),b+=40;else if(k.type===1){const{value:T,repeatable:$,optional:H,regexp:I}=k;a.push({name:T,repeatable:$,optional:H});const Q=I||A0;if(Q!==A0){b+=10;try{new RegExp(`(${Q})`)}catch(we){throw new Error(`Invalid custom RegExp for param "${T}" (${Q}): `+we.message)}}let se=$?`((?:${Q})(?:/(?:${Q}))*)`:`(${Q})`;x||(se=H&&m.length<2?`(?:/${se})`:"/"+se),H&&(se+="?"),o+=se,b+=20,H&&(b+=-8),$&&(b+=-20),Q===".*"&&(b+=-50)}y.push(b)}i.push(y)}if(n.strict&&n.end){const m=i.length-1;i[m][i[m].length-1]+=.7000000000000001}n.strict||(o+="/?"),n.end?o+="$":n.strict&&!o.endsWith("/")&&(o+="(?:/|$)");const u=new RegExp(o,n.sensitive?"":"i");function d(m){const y=m.match(u),x={};if(!y)return null;for(let k=1;k<y.length;k++){const b=y[k]||"",T=a[k-1];x[T.name]=b&&T.repeatable?b.split("/"):b}return x}function f(m){let y="",x=!1;for(const k of e){(!x||!y.endsWith("/"))&&(y+="/"),x=!1;for(const b of k)if(b.type===0)y+=b.value;else if(b.type===1){const{value:T,repeatable:$,optional:H}=b,I=T in m?m[T]:"";if(sa(I)&&!$)throw new Error(`Provided param "${T}" is an array but it is not repeatable (* or + modifiers)`);const Q=sa(I)?I.join("/"):I;if(!Q)if(H)k.length<2&&(y.endsWith("/")?y=y.slice(0,-1):x=!0);else throw new Error(`Missing required param "${T}"`);y+=Q}}return y||"/"}return{re:u,score:i,keys:a,parse:d,stringify:f}}function E5(e,t){let n=0;for(;n<e.length&&n<t.length;){const i=t[n]-e[n];if(i)return i;n++}return e.length<t.length?e.length===1&&e[0]===80?-1:1:e.length>t.length?t.length===1&&t[0]===80?1:-1:0}function k1(e,t){let n=0;const i=e.score,o=t.score;for(;n<i.length&&n<o.length;){const a=E5(i[n],o[n]);if(a)return a;n++}if(Math.abs(o.length-i.length)===1){if(M0(i))return 1;if(M0(o))return-1}return o.length-i.length}function M0(e){const t=e[e.length-1];return e.length>0&&t[t.length-1]<0}const S5={type:0,value:""},A5=/[a-zA-Z0-9_]/;function M5(e){if(!e)return[[]];if(e==="/")return[[S5]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function t(b){throw new Error(`ERR (${n})/"${m}": ${b}`)}let n=0,i=n;const o=[];let a;function u(){a&&o.push(a),a=[]}let d=0,f,m="",y="";function x(){m&&(n===0?a.push({type:0,value:m}):n===1||n===2||n===3?(a.length>1&&(f==="*"||f==="+")&&t(`A repeatable param (${m}) must be alone in its segment. eg: '/:ids+.`),a.push({type:1,value:m,regexp:y,repeatable:f==="*"||f==="+",optional:f==="*"||f==="?"})):t("Invalid state to consume buffer"),m="")}function k(){m+=f}for(;d<e.length;){if(f=e[d++],f==="\\"&&n!==2){i=n,n=4;continue}switch(n){case 0:f==="/"?(m&&x(),u()):f===":"?(x(),n=1):k();break;case 4:k(),n=i;break;case 1:f==="("?n=2:A5.test(f)?k():(x(),n=0,f!=="*"&&f!=="?"&&f!=="+"&&d--);break;case 2:f===")"?y[y.length-1]=="\\"?y=y.slice(0,-1)+f:n=3:y+=f;break;case 3:x(),n=0,f!=="*"&&f!=="?"&&f!=="+"&&d--,y="";break;default:t("Unknown state");break}}return n===2&&t(`Unfinished custom RegExp for param "${m}"`),x(),u(),o}function B5(e,t,n){const i=k5(M5(e.path),n),o=di(i,{record:e,parent:t,children:[],alias:[]});return t&&!o.record.aliasOf==!t.record.aliasOf&&t.children.push(o),o}function T5(e,t){const n=[],i=new Map;t=D0({strict:!1,end:!0,sensitive:!1},t);function o(x){return i.get(x)}function a(x,k,b){const T=!b,$=T0(x);$.aliasOf=b&&b.record;const H=D0(t,x),I=[$];if("alias"in x){const we=typeof x.alias=="string"?[x.alias]:x.alias;for(const Be of we)I.push(T0(di({},$,{components:b?b.record.components:$.components,path:Be,aliasOf:b?b.record:$})))}let Q,se;for(const we of I){const{path:Be}=we;if(k&&Be[0]!=="/"){const $e=k.record.path,Ue=$e[$e.length-1]==="/"?"":"/";we.path=k.record.path+(Be&&Ue+Be)}if(Q=B5(we,k,H),b?b.alias.push(Q):(se=se||Q,se!==Q&&se.alias.push(Q),T&&x.name&&!N0(Q)&&u(x.name)),E1(Q)&&f(Q),$.children){const $e=$.children;for(let Ue=0;Ue<$e.length;Ue++)a($e[Ue],Q,b&&b.children[Ue])}b=b||Q}return se?()=>{u(se)}:vc}function u(x){if(C1(x)){const k=i.get(x);k&&(i.delete(x),n.splice(n.indexOf(k),1),k.children.forEach(u),k.alias.forEach(u))}else{const k=n.indexOf(x);k>-1&&(n.splice(k,1),x.record.name&&i.delete(x.record.name),x.children.forEach(u),x.alias.forEach(u))}}function d(){return n}function f(x){const k=R5(x,n);n.splice(k,0,x),x.record.name&&!N0(x)&&i.set(x.record.name,x)}function m(x,k){let b,T={},$,H;if("name"in x&&x.name){if(b=i.get(x.name),!b)throw $u(1,{location:x});H=b.record.name,T=di(B0(k.params,b.keys.filter(se=>!se.optional).concat(b.parent?b.parent.keys.filter(se=>se.optional):[]).map(se=>se.name)),x.params&&B0(x.params,b.keys.map(se=>se.name))),$=b.stringify(T)}else if(x.path!=null)$=x.path,b=n.find(se=>se.re.test($)),b&&(T=b.parse($),H=b.record.name);else{if(b=k.name?i.get(k.name):n.find(se=>se.re.test(k.path)),!b)throw $u(1,{location:x,currentLocation:k});H=b.record.name,T=di({},k.params,x.params),$=b.stringify(T)}const I=[];let Q=b;for(;Q;)I.unshift(Q.record),Q=Q.parent;return{name:H,path:$,params:T,matched:I,meta:D5(I)}}e.forEach(x=>a(x));function y(){n.length=0,i.clear()}return{addRoute:a,resolve:m,removeRoute:u,clearRoutes:y,getRoutes:d,getRecordMatcher:o}}function B0(e,t){const n={};for(const i of t)i in e&&(n[i]=e[i]);return n}function T0(e){const t={path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:e.aliasOf,beforeEnter:e.beforeEnter,props:N5(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}};return Object.defineProperty(t,"mods",{value:{}}),t}function N5(e){const t={},n=e.props||!1;if("component"in e)t.default=n;else for(const i in e.components)t[i]=typeof n=="object"?n[i]:n;return t}function N0(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function D5(e){return e.reduce((t,n)=>di(t,n.meta),{})}function D0(e,t){const n={};for(const i in e)n[i]=i in t?t[i]:e[i];return n}function R5(e,t){let n=0,i=t.length;for(;n!==i;){const a=n+i>>1;k1(e,t[a])<0?i=a:n=a+1}const o=O5(e);return o&&(i=t.lastIndexOf(o,i-1)),i}function O5(e){let t=e;for(;t=t.parent;)if(E1(t)&&k1(e,t)===0)return t}function E1({record:e}){return!!(e.name||e.components&&Object.keys(e.components).length||e.redirect)}function I5(e){const t={};if(e===""||e==="?")return t;const i=(e[0]==="?"?e.slice(1):e).split("&");for(let o=0;o<i.length;++o){const a=i[o].replace(y1," "),u=a.indexOf("="),d=Mc(u<0?a:a.slice(0,u)),f=u<0?null:Mc(a.slice(u+1));if(d in t){let m=t[d];sa(m)||(m=t[d]=[m]),m.push(f)}else t[d]=f}return t}function R0(e){let t="";for(let n in e){const i=e[n];if(n=i5(n),i==null){i!==void 0&&(t+=(t.length?"&":"")+n);continue}(sa(i)?i.map(a=>a&&xf(a)):[i&&xf(i)]).forEach(a=>{a!==void 0&&(t+=(t.length?"&":"")+n,a!=null&&(t+="="+a))})}return t}function F5(e){const t={};for(const n in e){const i=e[n];i!==void 0&&(t[n]=sa(i)?i.map(o=>o==null?null:""+o):i==null?i:""+i)}return t}const j5=Symbol(""),O0=Symbol(""),hd=Symbol(""),up=Symbol(""),Cf=Symbol("");function nc(){let e=[];function t(i){return e.push(i),()=>{const o=e.indexOf(i);o>-1&&e.splice(o,1)}}function n(){e=[]}return{add:t,list:()=>e.slice(),reset:n}}function kl(e,t,n,i,o,a=u=>u()){const u=i&&(i.enterCallbacks[o]=i.enterCallbacks[o]||[]);return()=>new Promise((d,f)=>{const m=k=>{k===!1?f($u(4,{from:n,to:t})):k instanceof Error?f(k):L5(k)?f($u(2,{from:t,to:k})):(u&&i.enterCallbacks[o]===u&&typeof k=="function"&&u.push(k),d())},y=a(()=>e.call(i&&i.instances[o],t,n,m));let x=Promise.resolve(y);e.length<3&&(x=x.then(m)),x.catch(k=>f(k))})}function qd(e,t,n,i,o=a=>a()){const a=[];for(const u of e)for(const d in u.components){let f=u.components[d];if(!(t!=="beforeRouteEnter"&&!u.instances[d]))if(m1(f)){const y=(f.__vccOpts||f)[t];y&&a.push(kl(y,n,i,u,d,o))}else{let m=f();a.push(()=>m.then(y=>{if(!y)throw new Error(`Couldn't resolve component "${d}" at "${u.path}"`);const x=H4(y)?y.default:y;u.mods[d]=y,u.components[d]=x;const b=(x.__vccOpts||x)[t];return b&&kl(b,n,i,u,d,o)()}))}}return a}function I0(e){const t=Do(hd),n=Do(up),i=Un(()=>{const f=vn(e.to);return t.resolve(f)}),o=Un(()=>{const{matched:f}=i.value,{length:m}=f,y=f[m-1],x=n.matched;if(!y||!x.length)return-1;const k=x.findIndex(Uu.bind(null,y));if(k>-1)return k;const b=F0(f[m-2]);return m>1&&F0(y)===b&&x[x.length-1].path!==b?x.findIndex(Uu.bind(null,f[m-2])):k}),a=Un(()=>o.value>-1&&q5(n.params,i.value.params)),u=Un(()=>o.value>-1&&o.value===n.matched.length-1&&x1(n.params,i.value.params));function d(f={}){if($5(f)){const m=t[vn(e.replace)?"replace":"push"](vn(e.to)).catch(vc);return e.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>m),m}return Promise.resolve()}return{route:i,href:Un(()=>i.value.href),isActive:a,isExactActive:u,navigate:d}}function z5(e){return e.length===1?e[0]:e}const U5=Hs({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:I0,setup(e,{slots:t}){const n=il(I0(e)),{options:i}=Do(hd),o=Un(()=>({[j0(e.activeClass,i.linkActiveClass,"router-link-active")]:n.isActive,[j0(e.exactActiveClass,i.linkExactActiveClass,"router-link-exact-active")]:n.isExactActive}));return()=>{const a=t.default&&z5(t.default(n));return e.custom?a:rp("a",{"aria-current":n.isExactActive?e.ariaCurrentValue:null,href:n.href,onClick:n.navigate,class:o.value},a)}}}),ku=U5;function $5(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const t=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return e.preventDefault&&e.preventDefault(),!0}}function q5(e,t){for(const n in t){const i=t[n],o=e[n];if(typeof i=="string"){if(i!==o)return!1}else if(!sa(o)||o.length!==i.length||i.some((a,u)=>a!==o[u]))return!1}return!0}function F0(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const j0=(e,t,n)=>e??t??n,V5=Hs({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:t,slots:n}){const i=Do(Cf),o=Un(()=>e.route||i.value),a=Do(O0,0),u=Un(()=>{let m=vn(a);const{matched:y}=o.value;let x;for(;(x=y[m])&&!x.components;)m++;return m}),d=Un(()=>o.value.matched[u.value]);ch(O0,Un(()=>u.value+1)),ch(j5,d),ch(Cf,o);const f=Nt();return Ki(()=>[f.value,d.value,e.name],([m,y,x],[k,b,T])=>{y&&(y.instances[x]=m,b&&b!==y&&m&&m===k&&(y.leaveGuards.size||(y.leaveGuards=b.leaveGuards),y.updateGuards.size||(y.updateGuards=b.updateGuards))),m&&y&&(!b||!Uu(y,b)||!k)&&(y.enterCallbacks[x]||[]).forEach($=>$(m))},{flush:"post"}),()=>{const m=o.value,y=e.name,x=d.value,k=x&&x.components[y];if(!k)return z0(n.default,{Component:k,route:m});const b=x.props[y],T=b?b===!0?m.params:typeof b=="function"?b(m):b:null,H=rp(k,di({},T,t,{onVnodeUnmounted:I=>{I.component.isUnmounted&&(x.instances[y]=null)},ref:f}));return z0(n.default,{Component:H,route:m})||H}}});function z0(e,t){if(!e)return null;const n=e(t);return n.length===1?n[0]:n}const S1=V5;function G5(e){const t=T5(e.routes,e),n=e.parseQuery||I5,i=e.stringifyQuery||R0,o=e.history,a=nc(),u=nc(),d=nc(),f=ty(_l);let m=_l;Pu&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const y=Ud.bind(null,ee=>""+ee),x=Ud.bind(null,s5),k=Ud.bind(null,Mc);function b(ee,G){let q,de;return C1(ee)?(q=t.getRecordMatcher(ee),de=G):de=ee,t.addRoute(de,q)}function T(ee){const G=t.getRecordMatcher(ee);G&&t.removeRoute(G)}function $(){return t.getRoutes().map(ee=>ee.record)}function H(ee){return!!t.getRecordMatcher(ee)}function I(ee,G){if(G=di({},G||f.value),typeof ee=="string"){const F=$d(n,ee,G.path),D=t.resolve({path:F.path},G),j=o.createHref(F.fullPath);return di(F,D,{params:k(D.params),hash:Mc(F.hash),redirectedFrom:void 0,href:j})}let q;if(ee.path!=null)q=di({},ee,{path:$d(n,ee.path,G.path).path});else{const F=di({},ee.params);for(const D in F)F[D]==null&&delete F[D];q=di({},ee,{params:x(F)}),G.params=x(G.params)}const de=t.resolve(q,G),ce=ee.hash||"";de.params=y(k(de.params));const V=l5(i,di({},ee,{hash:n5(ce),path:de.path})),Z=o.createHref(V);return di({fullPath:V,hash:ce,query:i===R0?F5(ee.query):ee.query||{}},de,{redirectedFrom:void 0,href:Z})}function Q(ee){return typeof ee=="string"?$d(n,ee,f.value.path):di({},ee)}function se(ee,G){if(m!==ee)return $u(8,{from:G,to:ee})}function we(ee){return Ue(ee)}function Be(ee){return we(di(Q(ee),{replace:!0}))}function $e(ee){const G=ee.matched[ee.matched.length-1];if(G&&G.redirect){const{redirect:q}=G;let de=typeof q=="function"?q(ee):q;return typeof de=="string"&&(de=de.includes("?")||de.includes("#")?de=Q(de):{path:de},de.params={}),di({query:ee.query,hash:ee.hash,params:de.path!=null?{}:ee.params},de)}}function Ue(ee,G){const q=m=I(ee),de=f.value,ce=ee.state,V=ee.force,Z=ee.replace===!0,F=$e(q);if(F)return Ue(di(Q(F),{state:typeof F=="object"?di({},ce,F.state):ce,force:V,replace:Z}),G||q);const D=q;D.redirectedFrom=G;let j;return!V&&u5(i,de,q)&&(j=$u(16,{to:D,from:de}),ye(de,de,!0,!1)),(j?Promise.resolve(j):He(D,de)).catch(Fe=>Ya(Fe)?Ya(Fe,2)?Fe:ue(Fe):J(Fe,D,de)).then(Fe=>{if(Fe){if(Ya(Fe,2))return Ue(di({replace:Z},Q(Fe.to),{state:typeof Fe.to=="object"?di({},ce,Fe.to.state):ce,force:V}),G||D)}else Fe=re(D,de,!0,Z,ce);return ae(D,de,Fe),Fe})}function Pe(ee,G){const q=se(ee,G);return q?Promise.reject(q):Promise.resolve()}function Te(ee){const G=le.values().next().value;return G&&typeof G.runWithContext=="function"?G.runWithContext(ee):ee()}function He(ee,G){let q;const[de,ce,V]=H5(ee,G);q=qd(de.reverse(),"beforeRouteLeave",ee,G);for(const F of de)F.leaveGuards.forEach(D=>{q.push(kl(D,ee,G))});const Z=Pe.bind(null,ee,G);return q.push(Z),_e(q).then(()=>{q=[];for(const F of a.list())q.push(kl(F,ee,G));return q.push(Z),_e(q)}).then(()=>{q=qd(ce,"beforeRouteUpdate",ee,G);for(const F of ce)F.updateGuards.forEach(D=>{q.push(kl(D,ee,G))});return q.push(Z),_e(q)}).then(()=>{q=[];for(const F of V)if(F.beforeEnter)if(sa(F.beforeEnter))for(const D of F.beforeEnter)q.push(kl(D,ee,G));else q.push(kl(F.beforeEnter,ee,G));return q.push(Z),_e(q)}).then(()=>(ee.matched.forEach(F=>F.enterCallbacks={}),q=qd(V,"beforeRouteEnter",ee,G,Te),q.push(Z),_e(q))).then(()=>{q=[];for(const F of u.list())q.push(kl(F,ee,G));return q.push(Z),_e(q)}).catch(F=>Ya(F,8)?F:Promise.reject(F))}function ae(ee,G,q){d.list().forEach(de=>Te(()=>de(ee,G,q)))}function re(ee,G,q,de,ce){const V=se(ee,G);if(V)return V;const Z=G===_l,F=Pu?history.state:{};q&&(de||Z?o.replace(ee.fullPath,di({scroll:Z&&F&&F.scroll},ce)):o.push(ee.fullPath,ce)),f.value=ee,ye(ee,G,q,Z),ue()}let oe;function Y(){oe||(oe=o.listen((ee,G,q)=>{if(!fe.listening)return;const de=I(ee),ce=$e(de);if(ce){Ue(di(ce,{replace:!0,force:!0}),de).catch(vc);return}m=de;const V=f.value;Pu&&v5(k0(V.fullPath,q.delta),cd()),He(de,V).catch(Z=>Ya(Z,12)?Z:Ya(Z,2)?(Ue(di(Q(Z.to),{force:!0}),de).then(F=>{Ya(F,20)&&!q.delta&&q.type===Bc.pop&&o.go(-1,!1)}).catch(vc),Promise.reject()):(q.delta&&o.go(-q.delta,!1),J(Z,de,V))).then(Z=>{Z=Z||re(de,V,!1),Z&&(q.delta&&!Ya(Z,8)?o.go(-q.delta,!1):q.type===Bc.pop&&Ya(Z,20)&&o.go(-1,!1)),ae(de,V,Z)}).catch(vc)}))}let C=nc(),N=nc(),K;function J(ee,G,q){ue(ee);const de=N.list();return de.length?de.forEach(ce=>ce(ee,G,q)):console.error(ee),Promise.reject(ee)}function Ee(){return K&&f.value!==_l?Promise.resolve():new Promise((ee,G)=>{C.add([ee,G])})}function ue(ee){return K||(K=!ee,Y(),C.list().forEach(([G,q])=>ee?q(ee):G()),C.reset()),ee}function ye(ee,G,q,de){const{scrollBehavior:ce}=e;if(!Pu||!ce)return Promise.resolve();const V=!q&&y5(k0(ee.fullPath,0))||(de||!q)&&history.state&&history.state.scroll||null;return bi().then(()=>ce(ee,G,V)).then(Z=>Z&&m5(Z)).catch(Z=>J(Z,ee,G))}const O=ee=>o.go(ee);let ie;const le=new Set,fe={currentRoute:f,listening:!0,addRoute:b,removeRoute:T,clearRoutes:t.clearRoutes,hasRoute:H,getRoutes:$,resolve:I,options:e,push:we,replace:Be,go:O,back:()=>O(-1),forward:()=>O(1),beforeEach:a.add,beforeResolve:u.add,afterEach:d.add,onError:N.add,isReady:Ee,install(ee){const G=this;ee.component("RouterLink",ku),ee.component("RouterView",S1),ee.config.globalProperties.$router=G,Object.defineProperty(ee.config.globalProperties,"$route",{enumerable:!0,get:()=>vn(f)}),Pu&&!ie&&f.value===_l&&(ie=!0,we(o.location).catch(ce=>{}));const q={};for(const ce in _l)Object.defineProperty(q,ce,{get:()=>f.value[ce],enumerable:!0});ee.provide(hd,G),ee.provide(up,Jg(q)),ee.provide(Cf,f);const de=ee.unmount;le.add(ee),ee.unmount=function(){le.delete(ee),le.size<1&&(m=_l,oe&&oe(),oe=null,f.value=_l,ie=!1,K=!1),de()}}};function _e(ee){return ee.reduce((G,q)=>G.then(()=>Te(q)),Promise.resolve())}return fe}function H5(e,t){const n=[],i=[],o=[],a=Math.max(t.matched.length,e.matched.length);for(let u=0;u<a;u++){const d=t.matched[u];d&&(e.matched.find(m=>Uu(m,d))?i.push(d):n.push(d));const f=e.matched[u];f&&(t.matched.find(m=>Uu(m,f))||o.push(f))}return[n,i,o]}function dd(){return Do(hd)}function aA(e){return Do(up)}const _c=id("notification",()=>{const e=Nt([]),t=Nt(0),n=Nt(null),i=Un(()=>[...e.value].sort((x,k)=>k.timestamp-x.timestamp));function o({type:x,message:k,duration:b=5e3}){const T=++t.value,$=Date.now(),H={id:T,type:x,message:k,duration:b,timestamp:$};return e.value.push(H),n.value=T,b>0&&setTimeout(()=>{m(T)},b),T}const a=(x,k=5e3)=>o({type:"success",message:x,duration:k}),u=(x,k=5e3)=>o({type:"error",message:x,duration:k}),d=(x,k=5e3)=>o({type:"info",message:x,duration:k}),f=(x,k=5e3)=>o({type:"warning",message:x,duration:k});function m(x){const k=e.value.findIndex(b=>b.id===x);k!==-1&&e.value.splice(k,1),n.value===x&&(n.value=null)}function y(){e.value=[],n.value=null}return{notifications:i,lastAddedId:n,addNotification:o,removeNotification:m,clearAll:y,success:a,error:u,info:d,warning:f}});var To=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function A1(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function W5(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var M1=W5,Z5=typeof To=="object"&&To&&To.Object===Object&&To,K5=Z5,Y5=K5,J5=typeof self=="object"&&self&&self.Object===Object&&self,X5=Y5||J5||Function("return this")(),B1=X5,Q5=B1,eb=function(){return Q5.Date.now()},tb=eb,nb=/\s/;function ib(e){for(var t=e.length;t--&&nb.test(e.charAt(t)););return t}var rb=ib,sb=rb,ob=/^\s+/;function ab(e){return e&&e.slice(0,sb(e)+1).replace(ob,"")}var lb=ab,ub=B1,cb=ub.Symbol,T1=cb,U0=T1,N1=Object.prototype,hb=N1.hasOwnProperty,db=N1.toString,ic=U0?U0.toStringTag:void 0;function fb(e){var t=hb.call(e,ic),n=e[ic];try{e[ic]=void 0;var i=!0}catch{}var o=db.call(e);return i&&(t?e[ic]=n:delete e[ic]),o}var pb=fb,gb=Object.prototype,mb=gb.toString;function vb(e){return mb.call(e)}var yb=vb,$0=T1,_b=pb,bb=yb,wb="[object Null]",xb="[object Undefined]",q0=$0?$0.toStringTag:void 0;function Lb(e){return e==null?e===void 0?xb:wb:q0&&q0 in Object(e)?_b(e):bb(e)}var Cb=Lb;function Pb(e){return e!=null&&typeof e=="object"}var kb=Pb,Eb=Cb,Sb=kb,Ab="[object Symbol]";function Mb(e){return typeof e=="symbol"||Sb(e)&&Eb(e)==Ab}var Bb=Mb,Tb=lb,V0=M1,Nb=Bb,G0=NaN,Db=/^[-+]0x[0-9a-f]+$/i,Rb=/^0b[01]+$/i,Ob=/^0o[0-7]+$/i,Ib=parseInt;function Fb(e){if(typeof e=="number")return e;if(Nb(e))return G0;if(V0(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=V0(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=Tb(e);var n=Rb.test(e);return n||Ob.test(e)?Ib(e.slice(2),n?2:8):Db.test(e)?G0:+e}var jb=Fb,zb=M1,Vd=tb,H0=jb,Ub="Expected a function",$b=Math.max,qb=Math.min;function Vb(e,t,n){var i,o,a,u,d,f,m=0,y=!1,x=!1,k=!0;if(typeof e!="function")throw new TypeError(Ub);t=H0(t)||0,zb(n)&&(y=!!n.leading,x="maxWait"in n,a=x?$b(H0(n.maxWait)||0,t):a,k="trailing"in n?!!n.trailing:k);function b($e){var Ue=i,Pe=o;return i=o=void 0,m=$e,u=e.apply(Pe,Ue),u}function T($e){return m=$e,d=setTimeout(I,t),y?b($e):u}function $($e){var Ue=$e-f,Pe=$e-m,Te=t-Ue;return x?qb(Te,a-Pe):Te}function H($e){var Ue=$e-f,Pe=$e-m;return f===void 0||Ue>=t||Ue<0||x&&Pe>=a}function I(){var $e=Vd();if(H($e))return Q($e);d=setTimeout(I,$($e))}function Q($e){return d=void 0,k&&i?b($e):(i=o=void 0,u)}function se(){d!==void 0&&clearTimeout(d),m=0,i=f=o=d=void 0}function we(){return d===void 0?u:Q(Vd())}function Be(){var $e=Vd(),Ue=H($e);if(i=arguments,o=this,f=$e,Ue){if(d===void 0)return T(f);if(x)return clearTimeout(d),d=setTimeout(I,t),b(f)}return d===void 0&&(d=setTimeout(I,t)),u}return Be.cancel=se,Be.flush=we,Be}var Gb=Vb;const Hb=A1(Gb),Wb={class:"relative w-full"},Zb={key:0,class:"search-results w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-y-auto"},Kb=["onClick"],W0=Hs({__name:"SearchBar",emits:["select-location"],setup(e,{emit:t}){const n=Nt(""),i=Nt([]),o=t,a=Hb(async f=>{if(f.length<3){i.value=[];return}try{const y=await(await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(f)}`)).json();i.value=y}catch(m){console.error("Erreur lors de la recherche d'adresse:",m),i.value=[]}},300);function u(){a(n.value)}function d(f){n.value=f.display_name,i.value=[],o("select-location",{lat:parseFloat(f.lat),lng:parseFloat(f.lon)})}return(f,m)=>(je(),ze("div",Wb,[cn(A("input",{"onUpdate:modelValue":m[0]||(m[0]=y=>n.value=y),onInput:u,type:"text",placeholder:"Rechercher une adresse...",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"},null,544),[[Kn,n.value]]),i.value.length>0?(je(),ze("div",Zb,[(je(!0),ze(Qt,null,Mn(i.value,y=>(je(),ze("div",{key:y.place_id,onClick:x=>d(y),class:"px-4 py-2 hover:bg-gray-100 cursor-pointer"},Tt(y.display_name),9,Kb))),128))])):Zt("",!0)]))}}),Yb={class:"h-screen flex flex-col"},Jb={key:0,class:"bg-white shadow-sm z-[2000]"},Xb={class:"mx-auto px-4 sm:px-6 lg:px-8"},Qb={class:"flex h-16 items-center justify-between"},e3={class:"flex items-center space-x-8"},t3={class:"hidden md:flex space-x-6"},n3={key:0,class:"hidden md:block flex-1 mx-8"},i3={key:1,class:"flex-1"},r3={class:"flex items-center space-x-2 md:space-x-4"},s3={class:"flex md:hidden"},o3={class:"h-6 w-6",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},a3={key:0,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 12h16M4 18h16"},l3={key:1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"},u3={class:"relative"},c3={class:"flex items-center h-full px-3 motion-reduce:transition-none"},h3={class:"flex-shrink-0"},d3={key:0,class:"h-5 w-5 text-white",viewBox:"0 0 20 20",fill:"currentColor"},f3={key:1,class:"h-5 w-5 text-white",viewBox:"0 0 20 20",fill:"currentColor"},p3={key:2,class:"h-5 w-5 text-white",viewBox:"0 0 20 20",fill:"currentColor"},g3={key:3,class:"h-5 w-5 text-white",viewBox:"0 0 20 20",fill:"currentColor"},m3={key:0,class:"ml-2 text-white font-medium message-container"},v3={key:0,class:"absolute right-0 mt-2 w-80 origin-top-right rounded-md bg-white py-1 shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none z-[3000]"},y3={class:"px-4 py-2 border-b border-gray-100 flex justify-between items-center"},_3={class:"max-h-72 overflow-y-auto"},b3={key:0,class:"px-4 py-3 text-sm text-gray-500 text-center"},w3={class:"flex items-start"},x3={class:"flex-shrink-0 mr-3"},L3={key:0,class:"h-5 w-5 text-green-400",viewBox:"0 0 20 20",fill:"currentColor"},C3={key:1,class:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor"},P3={key:2,class:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor"},k3={key:3,class:"h-5 w-5 text-blue-400",viewBox:"0 0 20 20",fill:"currentColor"},E3={class:"flex-1"},S3={class:"text-sm text-gray-800"},A3=["onClick"],M3={class:"relative"},B3={class:"hidden md:flex flex-col items-end"},T3={class:"text-sm font-medium text-gray-700"},N3={key:0,class:"text-xs text-gray-500"},D3=["src","alt"],R3={key:0,class:"absolute right-0 mt-2 w-48 origin-top-right rounded-md bg-white py-1 shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none z-[3000]"},O3={class:"md:hidden px-4 py-2 border-b border-gray-100"},I3={class:"text-sm font-medium text-gray-700"},F3={class:"text-xs text-gray-500"},j3={key:0,class:"md:hidden"},z3={class:"space-y-1 px-2 pb-3 pt-2"},U3={key:0,class:"px-4 py-3"},$3={key:0,class:"fixed inset-0 bg-white z-[2001] flex flex-col items-center justify-center p-6 text-center"},q3=Hs({__name:"App",setup(e){const t=dd(),n=Es(),i=_c(),o=Nt(!1),a=Nt(!1),u=Nt(!1),d=Nt(!1),f=Nt(!1),m=Nt(null),y=Nt(!1),x=Nt(null),k=Nt("13px"),b=Nt("65px");function T(){d.value=window.innerWidth<768}ra(()=>{T(),window.addEventListener("resize",T),window.addEventListener("resize",$)}),Jh(()=>{window.removeEventListener("resize",T),window.removeEventListener("resize",$)});function $(){if(!x.value)return;const Y=x.value.getBoundingClientRect();k.value=`${Y.top+window.scrollY+5}px`;const C=Y.left+Y.width/2;b.value=`${window.innerWidth-C-22}px`}const H=Un(()=>{const Y=n.user;if(!Y)return"";const C=`${Y.first_name} ${Y.last_name.toUpperCase()}`;return Y.company_name?`${C} (${Y.company_name})`:C}),I=Un(()=>{var C;switch((C=n.user)==null?void 0:C.user_type){case"admin":return"Accès administrateur";case"usine":return"Accès usine";case"concessionnaire":return"Accès concessionnaire";case"agriculteur":return"Accès agriculteur";default:return""}}),Q=Un(()=>{var Y;return((Y=n.user)==null?void 0:Y.user_type)==="admin"}),se=Nt(""),we=Un(()=>n.isAuthenticated),Be=[{name:"Carte",to:"/"},{name:"Plans",to:"/plans"}],$e=Un(()=>{var C,N;if(!we.value)return[];const Y=[...Be];return(Q.value||((C=n.user)==null?void 0:C.user_type)==="usine"||((N=n.user)==null?void 0:N.user_type)==="concessionnaire")&&Y.push({name:"Utilisateurs",to:"/users"}),Y}),Ue=Un(()=>we.value?[{name:"Mon profil",to:"/profile"}]:[]);async function Pe(){try{await n.logout(),t.push("/login")}catch(Y){console.error("Erreur lors de la déconnexion:",Y)}}function Te(Y){window.dispatchEvent(new CustomEvent("map-set-location",{detail:{lat:Y.lat,lng:Y.lng,zoom:16}}))}ra(async()=>{console.log("App mounted, checking auth...");try{localStorage.getItem("token")?(console.log("Token found, checking auth..."),await n.checkAuth(),await n.fetchUserProfile()):console.log("No token found")}catch(Y){console.error("Auth check error:",Y),t.push("/login")}});const He=Un(()=>{const Y="IrrigationDesign";if(!we.value)return`${Y} - Connexion`;const C=t.currentRoute.value,K={home:"Carte",plans:"Plans",users:"Utilisateurs",profile:"Mon profil",selectConcessionnaire:"Sélection du concessionnaire",changePassword:"Changement de mot de passe",map:"Carte"}[C.name]||"";return K?`${Y} - ${K}`:Y});Ki(He,Y=>{document.title=Y},{immediate:!0});const ae=Un(()=>i.notifications.length);function re(){i.clearAll(),u.value=!1}function oe(){m.value&&(y.value=!1,setTimeout(()=>{m.value=null},300))}return hf(()=>{if(i.lastAddedId!==null){const Y=i.notifications.find(C=>C.id===i.lastAddedId);Y&&bi(()=>{$(),f.value=!0,m.value={id:Y.id,message:Y.message,type:Y.type},requestAnimationFrame(()=>{setTimeout(()=>{y.value=!0,setTimeout(()=>{y.value=!1,setTimeout(()=>{var C;((C=m.value)==null?void 0:C.id)===Y.id&&(m.value=null,f.value=!1)},300)},4e3)},50)})})}}),(Y,C)=>(je(),ze("div",Yb,[we.value?(je(),ze("header",Jb,[A("nav",Xb,[A("div",Qb,[A("div",e3,[Pi(vn(ku),{to:"/",class:"text-xl font-semibold text-primary-600 truncate"},{default:ea(()=>C[5]||(C[5]=[A("span",{class:"md:inline hidden"},"IrrigationDesign",-1),A("span",{class:"md:hidden inline"},"ID",-1)])),_:1}),A("div",t3,[(je(!0),ze(Qt,null,Mn($e.value,N=>(je(),Sl(vn(ku),{key:N.name,to:N.to,class:zi(["text-sm font-medium transition-colors duration-200",[Y.$route.path===N.to?"text-primary-600 border-b-2 border-primary-500":"text-gray-500 hover:text-gray-900"]])},{default:ea(()=>[vi(Tt(N.name),1)]),_:2},1032,["to","class"]))),128))])]),Y.$route.path==="/"?(je(),ze("div",n3,[Pi(W0,{onSelectLocation:Te})])):(je(),ze("div",i3)),A("div",r3,[A("div",s3,[A("button",{onClick:C[0]||(C[0]=N=>a.value=!a.value),class:"inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-primary-500"},[C[6]||(C[6]=A("span",{class:"sr-only"},"Ouvrir le menu",-1)),(je(),ze("svg",o3,[a.value?(je(),ze("path",l3)):(je(),ze("path",a3))]))])]),A("div",u3,[A("button",{ref_key:"bellButtonRef",ref:x,onClick:C[1]||(C[1]=N=>u.value=!u.value),class:zi(["relative flex items-center justify-center p-2 text-gray-400 hover:text-gray-500 rounded-full hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2",{"animate-bell":f.value}])},C[7]||(C[7]=[A("span",{class:"sr-only"},"Voir les notifications",-1),A("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})],-1)]),2),Pi(Dh,{name:"island"},{default:ea(()=>[m.value?(je(),ze("div",{key:0,class:zi(["dynamic-island fixed z-[9999] shadow-xl",[y.value?"island-expanded":"island-pill",m.value.type==="success"?"bg-green-500":m.value.type==="error"?"bg-red-500":m.value.type==="warning"?"bg-yellow-500":"bg-blue-500"]]),style:Oc({top:k.value,right:b.value,transform:"translateZ(0)"}),onClick:oe},[A("div",c3,[A("div",h3,[m.value.type==="success"?(je(),ze("svg",d3,C[8]||(C[8]=[A("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"},null,-1)]))):m.value.type==="error"?(je(),ze("svg",f3,C[9]||(C[9]=[A("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"},null,-1)]))):m.value.type==="warning"?(je(),ze("svg",p3,C[10]||(C[10]=[A("path",{"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"},null,-1)]))):(je(),ze("svg",g3,C[11]||(C[11]=[A("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z","clip-rule":"evenodd"},null,-1)])))]),Pi(Dh,{name:"message",duration:{enter:200,leave:150}},{default:ea(()=>[y.value?(je(),ze("div",m3,Tt(m.value.message),1)):Zt("",!0)]),_:1})])],6)):Zt("",!0)]),_:1}),u.value?(je(),ze("div",v3,[A("div",y3,[C[12]||(C[12]=A("h3",{class:"text-sm font-semibold text-gray-700"},"Notifications",-1)),ae.value>0?(je(),ze("button",{key:0,onClick:re,class:"text-xs text-primary-600 hover:text-primary-800"}," Tout effacer ")):Zt("",!0)]),A("div",_3,[ae.value===0?(je(),ze("div",b3," Aucune notification ")):Zt("",!0),(je(!0),ze(Qt,null,Mn(vn(i).notifications,N=>(je(),ze("div",{key:N.id,class:"px-4 py-3 border-b border-gray-100 last:border-0 hover:bg-gray-50"},[A("div",w3,[A("div",x3,[N.type==="success"?(je(),ze("svg",L3,C[13]||(C[13]=[A("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"},null,-1)]))):N.type==="error"?(je(),ze("svg",C3,C[14]||(C[14]=[A("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"},null,-1)]))):N.type==="warning"?(je(),ze("svg",P3,C[15]||(C[15]=[A("path",{"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"},null,-1)]))):(je(),ze("svg",k3,C[16]||(C[16]=[A("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z","clip-rule":"evenodd"},null,-1)])))]),A("div",E3,[A("p",S3,Tt(N.message),1),A("button",{onClick:K=>vn(i).removeNotification(N.id),class:"text-xs text-primary-600 hover:text-primary-800 mt-1"}," Fermer ",8,A3)])])]))),128))])])):Zt("",!0)]),A("div",M3,[A("button",{onClick:C[2]||(C[2]=N=>o.value=!o.value),class:"flex items-center space-x-2 md:space-x-3 focus:outline-none"},[A("div",B3,[A("span",T3,Tt(H.value),1),I.value?(je(),ze("span",N3,Tt(I.value),1)):Zt("",!0)]),A("img",{class:"h-8 w-8 rounded-full ring-2 ring-white",src:se.value||"https://ui-avatars.com/api/?name="+encodeURIComponent(H.value),alt:H.value},null,8,D3)]),o.value?(je(),ze("div",R3,[A("div",O3,[A("div",I3,Tt(H.value),1),A("div",F3,Tt(I.value),1)]),(je(!0),ze(Qt,null,Mn(Ue.value,N=>(je(),Sl(vn(ku),{key:N.name,to:N.to,class:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-50",onClick:C[3]||(C[3]=K=>o.value=!1)},{default:ea(()=>[vi(Tt(N.name),1)]),_:2},1032,["to"]))),128)),A("button",{onClick:Pe,class:"block w-full px-4 py-2 text-left text-sm text-red-600 hover:bg-gray-50"}," Déconnexion ")])):Zt("",!0)])])]),a.value?(je(),ze("div",j3,[A("div",z3,[(je(!0),ze(Qt,null,Mn($e.value,N=>(je(),Sl(vn(ku),{key:N.name,to:N.to,class:zi(["block px-3 py-2 rounded-md text-base font-medium",[Y.$route.path===N.to?"bg-primary-50 text-primary-600":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"]]),onClick:C[4]||(C[4]=K=>a.value=!1)},{default:ea(()=>[vi(Tt(N.name),1)]),_:2},1032,["to","class"]))),128))]),Y.$route.path==="/"?(je(),ze("div",U3,[Pi(W0,{onSelectLocation:Te})])):Zt("",!0)])):Zt("",!0)])])):Zt("",!0),A("main",{class:zi([Y.$route.path==="/"?"overflow-hidden":"overflow-auto","flex-1 flex flex-col"])},[d.value&&Y.$route.path==="/"?(je(),ze("div",$3,[C[18]||(C[18]=A("svg",{class:"w-24 h-24 text-primary-500 mb-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})],-1)),C[19]||(C[19]=A("h2",{class:"text-2xl font-bold text-gray-900 mb-4"}," Version bureau recommandée ",-1)),C[20]||(C[20]=A("p",{class:"text-gray-600 mb-8 max-w-md"}," Pour une meilleure expérience de conception d'irrigation, nous vous recommandons d'utiliser un écran plus large ou un ordinateur. ",-1)),Pi(vn(ku),{to:"/plans",class:"inline-flex items-center px-4 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-primary-600 hover:bg-primary-700"},{default:ea(()=>C[17]||(C[17]=[vi(" Voir mes plans ")])),_:1})])):(je(),Sl(vn(S1),{key:1}))],2)]))}}),V3="modulepreload",G3=function(e){return"/static/frontend/"+e},Z0={},Ql=function(t,n,i){let o=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const u=document.querySelector("meta[property=csp-nonce]"),d=(u==null?void 0:u.nonce)||(u==null?void 0:u.getAttribute("nonce"));o=Promise.allSettled(n.map(f=>{if(f=G3(f),f in Z0)return;Z0[f]=!0;const m=f.endsWith(".css"),y=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${y}`))return;const x=document.createElement("link");if(x.rel=m?"stylesheet":V3,m||(x.as="script"),x.crossOrigin="",x.href=f,d&&x.setAttribute("nonce",d),document.head.appendChild(x),m)return new Promise((k,b)=>{x.addEventListener("load",k),x.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${f}`)))})}))}function a(u){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=u,window.dispatchEvent(d),!d.defaultPrevented)throw u}return o.then(u=>{for(const d of u||[])d.status==="rejected"&&a(d.reason);return t().catch(a)})},H3={class:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8"},W3={class:"max-w-md w-full space-y-8"},Z3={class:"space-y-4"},K3={class:"mt-1"},Y3={class:"mt-1"},J3={class:"mt-1"},X3={key:0,class:"rounded-md bg-red-50 p-4"},Q3={class:"flex"},ew={class:"ml-3"},tw={class:"text-sm font-medium text-red-800"},nw={key:1,class:"rounded-md bg-yellow-50 p-4"},iw={class:"flex"},rw={class:"ml-3"},sw={class:"mt-2 text-sm text-yellow-700"},ow={class:"list-disc pl-5 space-y-1"},aw=["disabled"],lw={class:"absolute left-0 inset-y-0 flex items-center pl-3"},uw={key:0,class:"h-5 w-5 text-primary-500 group-hover:text-primary-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},cw={key:1,class:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},hw=Hs({__name:"ChangePasswordForm",setup(e){const t=dd(),n=Es(),i=il({oldPassword:"",newPassword:"",confirmPassword:""}),o=Nt(!1),a=Nt("");ra(()=>{var m,y;console.log("ChangePasswordForm mounted, auth state:",{isAuthenticated:n.isAuthenticated,userId:(m=n.user)==null?void 0:m.id,mustChangePassword:(y=n.user)==null?void 0:y.must_change_password})});const u=Un(()=>{const m=[];return i.newPassword&&i.newPassword.length<8&&m.push("Le nouveau mot de passe doit contenir au moins 8 caractères"),i.newPassword&&i.confirmPassword&&i.newPassword!==i.confirmPassword&&m.push("Les mots de passe ne correspondent pas"),m}),d=Un(()=>i.oldPassword.length>0&&i.newPassword.length>=8&&i.newPassword===i.confirmPassword);async function f(){var m,y,x,k,b,T,$,H;if(!d.value){a.value="Veuillez corriger les erreurs avant de continuer";return}if(!((m=n.user)!=null&&m.id)){a.value="Erreur : utilisateur non identifié";return}o.value=!0,a.value="";try{console.log("Submitting password change..."),await n.changePassword(i.oldPassword,i.newPassword),console.log("Password changed successfully"),t.push("/")}catch(I){console.error("Password change failed:",I),(x=(y=I.response)==null?void 0:y.data)!=null&&x.detail?a.value=I.response.data.detail:(b=(k=I.response)==null?void 0:k.data)!=null&&b.old_password?a.value=I.response.data.old_password[0]:($=(T=I.response)==null?void 0:T.data)!=null&&$.password?a.value=I.response.data.password[0]:((H=I.response)==null?void 0:H.status)===401?(a.value="Session expirée, veuillez vous reconnecter",await n.logout(),t.push("/login")):a.value="Une erreur est survenue lors du changement de mot de passe"}finally{o.value=!1}}return(m,y)=>(je(),ze("div",H3,[A("div",W3,[y[12]||(y[12]=A("div",null,[A("h2",{class:"mt-6 text-center text-3xl font-extrabold text-gray-900"}," Changement de mot de passe "),A("p",{class:"mt-2 text-center text-sm text-gray-600"}," Pour des raisons de sécurité, vous devez changer votre mot de passe. ")],-1)),A("form",{class:"mt-8 space-y-6",onSubmit:td(f,["prevent"])},[A("div",Z3,[A("div",null,[y[3]||(y[3]=A("label",{for:"old-password",class:"block text-sm font-medium text-gray-700"},"Ancien mot de passe",-1)),A("div",K3,[cn(A("input",{id:"old-password","onUpdate:modelValue":y[0]||(y[0]=x=>i.oldPassword=x),name:"old-password",type:"password",required:"",autocomplete:"current-password",class:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm",placeholder:"Entrez votre mot de passe actuel"},null,512),[[Kn,i.oldPassword]])])]),A("div",null,[y[4]||(y[4]=A("label",{for:"new-password",class:"block text-sm font-medium text-gray-700"},"Nouveau mot de passe",-1)),A("div",Y3,[cn(A("input",{id:"new-password","onUpdate:modelValue":y[1]||(y[1]=x=>i.newPassword=x),name:"new-password",type:"password",required:"",autocomplete:"new-password",class:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm",placeholder:"Entrez votre nouveau mot de passe"},null,512),[[Kn,i.newPassword]])]),y[5]||(y[5]=A("p",{class:"mt-1 text-sm text-gray-500"}," Le mot de passe doit contenir au moins 8 caractères ",-1))]),A("div",null,[y[6]||(y[6]=A("label",{for:"confirm-password",class:"block text-sm font-medium text-gray-700"},"Confirmer le mot de passe",-1)),A("div",J3,[cn(A("input",{id:"confirm-password","onUpdate:modelValue":y[2]||(y[2]=x=>i.confirmPassword=x),name:"confirm-password",type:"password",required:"",autocomplete:"new-password",class:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm",placeholder:"Confirmez votre nouveau mot de passe"},null,512),[[Kn,i.confirmPassword]])])])]),a.value?(je(),ze("div",X3,[A("div",Q3,[y[7]||(y[7]=A("div",{class:"flex-shrink-0"},[A("svg",{class:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor"},[A("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})])],-1)),A("div",ew,[A("h3",tw,Tt(a.value),1)])])])):Zt("",!0),u.value.length>0?(je(),ze("div",nw,[A("div",iw,[y[9]||(y[9]=A("div",{class:"flex-shrink-0"},[A("svg",{class:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor"},[A("path",{"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"})])],-1)),A("div",rw,[y[8]||(y[8]=A("h3",{class:"text-sm font-medium text-yellow-800"},"Attention",-1)),A("div",sw,[A("ul",ow,[(je(!0),ze(Qt,null,Mn(u.value,(x,k)=>(je(),ze("li",{key:k},Tt(x),1))),128))])])])])])):Zt("",!0),A("div",null,[A("button",{type:"submit",disabled:o.value||!d.value,class:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50"},[A("span",lw,[o.value?(je(),ze("svg",cw,y[11]||(y[11]=[A("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),A("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):(je(),ze("svg",uw,y[10]||(y[10]=[A("path",{"fill-rule":"evenodd",d:"M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z","clip-rule":"evenodd"},null,-1)])))]),vi(" "+Tt(o.value?"Modification en cours...":"Changer le mot de passe"),1)],8,aw)])],32)])]))}}),dw="/static/frontend/assets/logo.svg",fw={class:"min-h-screen bg-white from-blue-50 to-white flex flex-col justify-center py-12 sm:px-6 lg:px-8"},pw={class:"mt-8 sm:mx-auto sm:w-full sm:max-w-md"},gw={class:"bg-white py-8 px-6 shadow-lg rounded-md sm:px-10"},mw={key:0,class:"rounded-md bg-red-50 p-4"},vw={class:"flex"},yw={class:"ml-3"},_w={class:"text-sm font-medium text-red-800"},bw={class:"mt-1"},ww={class:"mt-1 relative"},xw=["type"],Lw={key:0,class:"h-5 w-5 text-gray-400 hover:text-gray-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},Cw={key:1,class:"h-5 w-5 text-gray-400 hover:text-gray-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},Pw={class:"flex items-center justify-between"},kw={class:"flex items-center"},Ew={class:"text-sm"},Sw=["disabled"],Aw={key:0,class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},Mw=Hs({__name:"LoginView",setup(e){const t=dd(),n=Es(),i=Nt(!1),o=Nt(null),a=Nt(!1),u=il({username:"",password:"",rememberMe:!1});ra(()=>{var f;console.log("LoginView mounted"),console.log("INITIAL_STATE:",window.INITIAL_STATE),(f=window.INITIAL_STATE)!=null&&f.isAuthenticated&&(console.log("User is authenticated, redirecting to home"),t.push("/"))});async function d(){var f,m,y,x,k,b,T,$,H;i.value=!0,o.value=null;try{if(!u.username||!u.password){o.value="Veuillez remplir tous les champs";return}await n.login(u.username,u.password),(f=n.user)!=null&&f.must_change_password?t.push("/change-password"):t.push("/")}catch(I){console.error("Login error:",I),((m=I==null?void 0:I.response)==null?void 0:m.status)===500?o.value="Le service est temporairement indisponible. Veuillez réessayer dans quelques instants.":((y=I==null?void 0:I.response)==null?void 0:y.status)===401||((x=I==null?void 0:I.response)==null?void 0:x.status)===403?o.value="Identifiants incorrects. Veuillez vérifier votre nom d'utilisateur et mot de passe.":(b=(k=I==null?void 0:I.response)==null?void 0:k.data)!=null&&b.detail?o.value=I.response.data.detail:(H=($=(T=I==null?void 0:I.response)==null?void 0:T.data)==null?void 0:$.non_field_errors)!=null&&H[0]?o.value=I.response.data.non_field_errors[0]:(I==null?void 0:I.message)==="Network Error"?o.value="Impossible de se connecter au serveur. Veuillez vérifier votre connexion internet.":o.value="Une erreur est survenue lors de la connexion. Veuillez réessayer."}finally{i.value=!1}}return(f,m)=>{const y=Ay("router-link");return je(),ze("div",fw,[m[12]||(m[12]=A("div",{class:"sm:mx-auto sm:w-full sm:max-w-md"},[A("img",{src:dw,alt:"IrrigationDesign Logo",class:"mx-auto h-40 w-auto transition-transform duration-300 hover:scale-110"}),A("h2",{class:"mt-2 text-center text-3xl font-bold text-gray-800"}," IrrigationDesign "),A("p",{class:"mt-2 text-center text-sm text-gray-600"}," Connectez-vous pour accéder à votre espace ")],-1)),A("div",pw,[A("div",gw,[A("form",{class:"space-y-6",onSubmit:td(d,["prevent"])},[o.value?(je(),ze("div",mw,[A("div",vw,[m[4]||(m[4]=A("div",{class:"flex-shrink-0"},[A("svg",{class:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor"},[A("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})])],-1)),A("div",yw,[A("h3",_w,Tt(o.value),1)])])])):Zt("",!0),A("div",null,[m[5]||(m[5]=A("label",{for:"username",class:"block text-sm font-medium text-gray-700"}," Nom d'utilisateur ",-1)),A("div",bw,[cn(A("input",{id:"username","onUpdate:modelValue":m[0]||(m[0]=x=>u.username=x),name:"username",type:"text",required:"",autocomplete:"username",class:"appearance-none block w-full h-11 px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 sm:text-sm","aria-label":"Nom d'utilisateur"},null,512),[[Kn,u.username]])])]),A("div",null,[m[8]||(m[8]=A("label",{for:"password",class:"block text-sm font-medium text-gray-700"}," Mot de passe ",-1)),A("div",ww,[cn(A("input",{id:"password","onUpdate:modelValue":m[1]||(m[1]=x=>u.password=x),type:a.value?"text":"password",name:"password",required:"",autocomplete:"current-password",class:"appearance-none block w-full h-11 px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 sm:text-sm pr-10","aria-label":"Mot de passe"},null,8,xw),[[W2,u.password]]),A("button",{type:"button",onClick:m[2]||(m[2]=x=>a.value=!a.value),class:"absolute inset-y-0 right-0 pr-3 flex items-center","aria-label":"Afficher/masquer le mot de passe"},[a.value?(je(),ze("svg",Lw,m[6]||(m[6]=[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"},null,-1),A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"},null,-1)]))):(je(),ze("svg",Cw,m[7]||(m[7]=[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"},null,-1)])))])])]),A("div",Pw,[A("div",kw,[cn(A("input",{id:"remember-me","onUpdate:modelValue":m[3]||(m[3]=x=>u.rememberMe=x),name:"remember-me",type:"checkbox",class:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded","aria-label":"Se souvenir de moi"},null,512),[[Fm,u.rememberMe]]),m[9]||(m[9]=A("label",{for:"remember-me",class:"ml-2 block text-sm text-gray-900"}," Se souvenir de moi ",-1))]),A("div",Ew,[Pi(y,{to:"/forgot-password",class:"font-medium text-primary-600 hover:text-primary-500 transition-colors duration-200"},{default:ea(()=>m[10]||(m[10]=[vi(" Mot de passe oublié ? ")])),_:1})])]),A("div",null,[A("button",{type:"submit",disabled:i.value,class:"w-full h-11 flex justify-center items-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"Se connecter"},[i.value?(je(),ze("svg",Aw,m[11]||(m[11]=[A("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),A("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):Zt("",!0),vi(" "+Tt(i.value?"Connexion en cours...":"Se connecter"),1)],8,Sw)])],32)])])])}}}),K0="/static/frontend/assets/logo.jpeg";var Pf={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(e,t){(function(n,i){i(t)})(To,function(n){var i="1.9.4";function o(r){var c,v,S,U;for(v=1,S=arguments.length;v<S;v++){U=arguments[v];for(c in U)r[c]=U[c]}return r}var a=Object.create||function(){function r(){}return function(c){return r.prototype=c,new r}}();function u(r,c){var v=Array.prototype.slice;if(r.bind)return r.bind.apply(r,v.call(arguments,1));var S=v.call(arguments,2);return function(){return r.apply(c,S.length?S.concat(v.call(arguments)):arguments)}}var d=0;function f(r){return"_leaflet_id"in r||(r._leaflet_id=++d),r._leaflet_id}function m(r,c,v){var S,U,me,Ge;return Ge=function(){S=!1,U&&(me.apply(v,U),U=!1)},me=function(){S?U=arguments:(r.apply(v,arguments),setTimeout(Ge,c),S=!0)},me}function y(r,c,v){var S=c[1],U=c[0],me=S-U;return r===S&&v?r:((r-U)%me+me)%me+U}function x(){return!1}function k(r,c){if(c===!1)return r;var v=Math.pow(10,c===void 0?6:c);return Math.round(r*v)/v}function b(r){return r.trim?r.trim():r.replace(/^\s+|\s+$/g,"")}function T(r){return b(r).split(/\s+/)}function $(r,c){Object.prototype.hasOwnProperty.call(r,"options")||(r.options=r.options?a(r.options):{});for(var v in c)r.options[v]=c[v];return r.options}function H(r,c,v){var S=[];for(var U in r)S.push(encodeURIComponent(v?U.toUpperCase():U)+"="+encodeURIComponent(r[U]));return(!c||c.indexOf("?")===-1?"?":"&")+S.join("&")}var I=/\{ *([\w_ -]+) *\}/g;function Q(r,c){return r.replace(I,function(v,S){var U=c[S];if(U===void 0)throw new Error("No value provided for variable "+v);return typeof U=="function"&&(U=U(c)),U})}var se=Array.isArray||function(r){return Object.prototype.toString.call(r)==="[object Array]"};function we(r,c){for(var v=0;v<r.length;v++)if(r[v]===c)return v;return-1}var Be="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function $e(r){return window["webkit"+r]||window["moz"+r]||window["ms"+r]}var Ue=0;function Pe(r){var c=+new Date,v=Math.max(0,16-(c-Ue));return Ue=c+v,window.setTimeout(r,v)}var Te=window.requestAnimationFrame||$e("RequestAnimationFrame")||Pe,He=window.cancelAnimationFrame||$e("CancelAnimationFrame")||$e("CancelRequestAnimationFrame")||function(r){window.clearTimeout(r)};function ae(r,c,v){if(v&&Te===Pe)r.call(c);else return Te.call(window,u(r,c))}function re(r){r&&He.call(window,r)}var oe={__proto__:null,extend:o,create:a,bind:u,get lastId(){return d},stamp:f,throttle:m,wrapNum:y,falseFn:x,formatNum:k,trim:b,splitWords:T,setOptions:$,getParamString:H,template:Q,isArray:se,indexOf:we,emptyImageUrl:Be,requestFn:Te,cancelFn:He,requestAnimFrame:ae,cancelAnimFrame:re};function Y(){}Y.extend=function(r){var c=function(){$(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},v=c.__super__=this.prototype,S=a(v);S.constructor=c,c.prototype=S;for(var U in this)Object.prototype.hasOwnProperty.call(this,U)&&U!=="prototype"&&U!=="__super__"&&(c[U]=this[U]);return r.statics&&o(c,r.statics),r.includes&&(C(r.includes),o.apply(null,[S].concat(r.includes))),o(S,r),delete S.statics,delete S.includes,S.options&&(S.options=v.options?a(v.options):{},o(S.options,r.options)),S._initHooks=[],S.callInitHooks=function(){if(!this._initHooksCalled){v.callInitHooks&&v.callInitHooks.call(this),this._initHooksCalled=!0;for(var me=0,Ge=S._initHooks.length;me<Ge;me++)S._initHooks[me].call(this)}},c},Y.include=function(r){var c=this.prototype.options;return o(this.prototype,r),r.options&&(this.prototype.options=c,this.mergeOptions(r.options)),this},Y.mergeOptions=function(r){return o(this.prototype.options,r),this},Y.addInitHook=function(r){var c=Array.prototype.slice.call(arguments,1),v=typeof r=="function"?r:function(){this[r].apply(this,c)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(v),this};function C(r){if(!(typeof L>"u"||!L||!L.Mixin)){r=se(r)?r:[r];for(var c=0;c<r.length;c++)r[c]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var N={on:function(r,c,v){if(typeof r=="object")for(var S in r)this._on(S,r[S],c);else{r=T(r);for(var U=0,me=r.length;U<me;U++)this._on(r[U],c,v)}return this},off:function(r,c,v){if(!arguments.length)delete this._events;else if(typeof r=="object")for(var S in r)this._off(S,r[S],c);else{r=T(r);for(var U=arguments.length===1,me=0,Ge=r.length;me<Ge;me++)U?this._off(r[me]):this._off(r[me],c,v)}return this},_on:function(r,c,v,S){if(typeof c!="function"){console.warn("wrong listener type: "+typeof c);return}if(this._listens(r,c,v)===!1){v===this&&(v=void 0);var U={fn:c,ctx:v};S&&(U.once=!0),this._events=this._events||{},this._events[r]=this._events[r]||[],this._events[r].push(U)}},_off:function(r,c,v){var S,U,me;if(this._events&&(S=this._events[r],!!S)){if(arguments.length===1){if(this._firingCount)for(U=0,me=S.length;U<me;U++)S[U].fn=x;delete this._events[r];return}if(typeof c!="function"){console.warn("wrong listener type: "+typeof c);return}var Ge=this._listens(r,c,v);if(Ge!==!1){var ft=S[Ge];this._firingCount&&(ft.fn=x,this._events[r]=S=S.slice()),S.splice(Ge,1)}}},fire:function(r,c,v){if(!this.listens(r,v))return this;var S=o({},c,{type:r,target:this,sourceTarget:c&&c.sourceTarget||this});if(this._events){var U=this._events[r];if(U){this._firingCount=this._firingCount+1||1;for(var me=0,Ge=U.length;me<Ge;me++){var ft=U[me],xt=ft.fn;ft.once&&this.off(r,xt,ft.ctx),xt.call(ft.ctx||this,S)}this._firingCount--}}return v&&this._propagateEvent(S),this},listens:function(r,c,v,S){typeof r!="string"&&console.warn('"string" type argument expected');var U=c;typeof c!="function"&&(S=!!c,U=void 0,v=void 0);var me=this._events&&this._events[r];if(me&&me.length&&this._listens(r,U,v)!==!1)return!0;if(S){for(var Ge in this._eventParents)if(this._eventParents[Ge].listens(r,c,v,S))return!0}return!1},_listens:function(r,c,v){if(!this._events)return!1;var S=this._events[r]||[];if(!c)return!!S.length;v===this&&(v=void 0);for(var U=0,me=S.length;U<me;U++)if(S[U].fn===c&&S[U].ctx===v)return U;return!1},once:function(r,c,v){if(typeof r=="object")for(var S in r)this._on(S,r[S],c,!0);else{r=T(r);for(var U=0,me=r.length;U<me;U++)this._on(r[U],c,v,!0)}return this},addEventParent:function(r){return this._eventParents=this._eventParents||{},this._eventParents[f(r)]=r,this},removeEventParent:function(r){return this._eventParents&&delete this._eventParents[f(r)],this},_propagateEvent:function(r){for(var c in this._eventParents)this._eventParents[c].fire(r.type,o({layer:r.target,propagatedFrom:r.target},r),!0)}};N.addEventListener=N.on,N.removeEventListener=N.clearAllEventListeners=N.off,N.addOneTimeEventListener=N.once,N.fireEvent=N.fire,N.hasEventListeners=N.listens;var K=Y.extend(N);function J(r,c,v){this.x=v?Math.round(r):r,this.y=v?Math.round(c):c}var Ee=Math.trunc||function(r){return r>0?Math.floor(r):Math.ceil(r)};J.prototype={clone:function(){return new J(this.x,this.y)},add:function(r){return this.clone()._add(ue(r))},_add:function(r){return this.x+=r.x,this.y+=r.y,this},subtract:function(r){return this.clone()._subtract(ue(r))},_subtract:function(r){return this.x-=r.x,this.y-=r.y,this},divideBy:function(r){return this.clone()._divideBy(r)},_divideBy:function(r){return this.x/=r,this.y/=r,this},multiplyBy:function(r){return this.clone()._multiplyBy(r)},_multiplyBy:function(r){return this.x*=r,this.y*=r,this},scaleBy:function(r){return new J(this.x*r.x,this.y*r.y)},unscaleBy:function(r){return new J(this.x/r.x,this.y/r.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=Ee(this.x),this.y=Ee(this.y),this},distanceTo:function(r){r=ue(r);var c=r.x-this.x,v=r.y-this.y;return Math.sqrt(c*c+v*v)},equals:function(r){return r=ue(r),r.x===this.x&&r.y===this.y},contains:function(r){return r=ue(r),Math.abs(r.x)<=Math.abs(this.x)&&Math.abs(r.y)<=Math.abs(this.y)},toString:function(){return"Point("+k(this.x)+", "+k(this.y)+")"}};function ue(r,c,v){return r instanceof J?r:se(r)?new J(r[0],r[1]):r==null?r:typeof r=="object"&&"x"in r&&"y"in r?new J(r.x,r.y):new J(r,c,v)}function ye(r,c){if(r)for(var v=c?[r,c]:r,S=0,U=v.length;S<U;S++)this.extend(v[S])}ye.prototype={extend:function(r){var c,v;if(!r)return this;if(r instanceof J||typeof r[0]=="number"||"x"in r)c=v=ue(r);else if(r=O(r),c=r.min,v=r.max,!c||!v)return this;return!this.min&&!this.max?(this.min=c.clone(),this.max=v.clone()):(this.min.x=Math.min(c.x,this.min.x),this.max.x=Math.max(v.x,this.max.x),this.min.y=Math.min(c.y,this.min.y),this.max.y=Math.max(v.y,this.max.y)),this},getCenter:function(r){return ue((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,r)},getBottomLeft:function(){return ue(this.min.x,this.max.y)},getTopRight:function(){return ue(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(r){var c,v;return typeof r[0]=="number"||r instanceof J?r=ue(r):r=O(r),r instanceof ye?(c=r.min,v=r.max):c=v=r,c.x>=this.min.x&&v.x<=this.max.x&&c.y>=this.min.y&&v.y<=this.max.y},intersects:function(r){r=O(r);var c=this.min,v=this.max,S=r.min,U=r.max,me=U.x>=c.x&&S.x<=v.x,Ge=U.y>=c.y&&S.y<=v.y;return me&&Ge},overlaps:function(r){r=O(r);var c=this.min,v=this.max,S=r.min,U=r.max,me=U.x>c.x&&S.x<v.x,Ge=U.y>c.y&&S.y<v.y;return me&&Ge},isValid:function(){return!!(this.min&&this.max)},pad:function(r){var c=this.min,v=this.max,S=Math.abs(c.x-v.x)*r,U=Math.abs(c.y-v.y)*r;return O(ue(c.x-S,c.y-U),ue(v.x+S,v.y+U))},equals:function(r){return r?(r=O(r),this.min.equals(r.getTopLeft())&&this.max.equals(r.getBottomRight())):!1}};function O(r,c){return!r||r instanceof ye?r:new ye(r,c)}function ie(r,c){if(r)for(var v=c?[r,c]:r,S=0,U=v.length;S<U;S++)this.extend(v[S])}ie.prototype={extend:function(r){var c=this._southWest,v=this._northEast,S,U;if(r instanceof fe)S=r,U=r;else if(r instanceof ie){if(S=r._southWest,U=r._northEast,!S||!U)return this}else return r?this.extend(_e(r)||le(r)):this;return!c&&!v?(this._southWest=new fe(S.lat,S.lng),this._northEast=new fe(U.lat,U.lng)):(c.lat=Math.min(S.lat,c.lat),c.lng=Math.min(S.lng,c.lng),v.lat=Math.max(U.lat,v.lat),v.lng=Math.max(U.lng,v.lng)),this},pad:function(r){var c=this._southWest,v=this._northEast,S=Math.abs(c.lat-v.lat)*r,U=Math.abs(c.lng-v.lng)*r;return new ie(new fe(c.lat-S,c.lng-U),new fe(v.lat+S,v.lng+U))},getCenter:function(){return new fe((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new fe(this.getNorth(),this.getWest())},getSouthEast:function(){return new fe(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(r){typeof r[0]=="number"||r instanceof fe||"lat"in r?r=_e(r):r=le(r);var c=this._southWest,v=this._northEast,S,U;return r instanceof ie?(S=r.getSouthWest(),U=r.getNorthEast()):S=U=r,S.lat>=c.lat&&U.lat<=v.lat&&S.lng>=c.lng&&U.lng<=v.lng},intersects:function(r){r=le(r);var c=this._southWest,v=this._northEast,S=r.getSouthWest(),U=r.getNorthEast(),me=U.lat>=c.lat&&S.lat<=v.lat,Ge=U.lng>=c.lng&&S.lng<=v.lng;return me&&Ge},overlaps:function(r){r=le(r);var c=this._southWest,v=this._northEast,S=r.getSouthWest(),U=r.getNorthEast(),me=U.lat>c.lat&&S.lat<v.lat,Ge=U.lng>c.lng&&S.lng<v.lng;return me&&Ge},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(r,c){return r?(r=le(r),this._southWest.equals(r.getSouthWest(),c)&&this._northEast.equals(r.getNorthEast(),c)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function le(r,c){return r instanceof ie?r:new ie(r,c)}function fe(r,c,v){if(isNaN(r)||isNaN(c))throw new Error("Invalid LatLng object: ("+r+", "+c+")");this.lat=+r,this.lng=+c,v!==void 0&&(this.alt=+v)}fe.prototype={equals:function(r,c){if(!r)return!1;r=_e(r);var v=Math.max(Math.abs(this.lat-r.lat),Math.abs(this.lng-r.lng));return v<=(c===void 0?1e-9:c)},toString:function(r){return"LatLng("+k(this.lat,r)+", "+k(this.lng,r)+")"},distanceTo:function(r){return G.distance(this,_e(r))},wrap:function(){return G.wrapLatLng(this)},toBounds:function(r){var c=180*r/40075017,v=c/Math.cos(Math.PI/180*this.lat);return le([this.lat-c,this.lng-v],[this.lat+c,this.lng+v])},clone:function(){return new fe(this.lat,this.lng,this.alt)}};function _e(r,c,v){return r instanceof fe?r:se(r)&&typeof r[0]!="object"?r.length===3?new fe(r[0],r[1],r[2]):r.length===2?new fe(r[0],r[1]):null:r==null?r:typeof r=="object"&&"lat"in r?new fe(r.lat,"lng"in r?r.lng:r.lon,r.alt):c===void 0?null:new fe(r,c,v)}var ee={latLngToPoint:function(r,c){var v=this.projection.project(r),S=this.scale(c);return this.transformation._transform(v,S)},pointToLatLng:function(r,c){var v=this.scale(c),S=this.transformation.untransform(r,v);return this.projection.unproject(S)},project:function(r){return this.projection.project(r)},unproject:function(r){return this.projection.unproject(r)},scale:function(r){return 256*Math.pow(2,r)},zoom:function(r){return Math.log(r/256)/Math.LN2},getProjectedBounds:function(r){if(this.infinite)return null;var c=this.projection.bounds,v=this.scale(r),S=this.transformation.transform(c.min,v),U=this.transformation.transform(c.max,v);return new ye(S,U)},infinite:!1,wrapLatLng:function(r){var c=this.wrapLng?y(r.lng,this.wrapLng,!0):r.lng,v=this.wrapLat?y(r.lat,this.wrapLat,!0):r.lat,S=r.alt;return new fe(v,c,S)},wrapLatLngBounds:function(r){var c=r.getCenter(),v=this.wrapLatLng(c),S=c.lat-v.lat,U=c.lng-v.lng;if(S===0&&U===0)return r;var me=r.getSouthWest(),Ge=r.getNorthEast(),ft=new fe(me.lat-S,me.lng-U),xt=new fe(Ge.lat-S,Ge.lng-U);return new ie(ft,xt)}},G=o({},ee,{wrapLng:[-180,180],R:6371e3,distance:function(r,c){var v=Math.PI/180,S=r.lat*v,U=c.lat*v,me=Math.sin((c.lat-r.lat)*v/2),Ge=Math.sin((c.lng-r.lng)*v/2),ft=me*me+Math.cos(S)*Math.cos(U)*Ge*Ge,xt=2*Math.atan2(Math.sqrt(ft),Math.sqrt(1-ft));return this.R*xt}}),q=6378137,de={R:q,MAX_LATITUDE:85.0511287798,project:function(r){var c=Math.PI/180,v=this.MAX_LATITUDE,S=Math.max(Math.min(v,r.lat),-v),U=Math.sin(S*c);return new J(this.R*r.lng*c,this.R*Math.log((1+U)/(1-U))/2)},unproject:function(r){var c=180/Math.PI;return new fe((2*Math.atan(Math.exp(r.y/this.R))-Math.PI/2)*c,r.x*c/this.R)},bounds:function(){var r=q*Math.PI;return new ye([-r,-r],[r,r])}()};function ce(r,c,v,S){if(se(r)){this._a=r[0],this._b=r[1],this._c=r[2],this._d=r[3];return}this._a=r,this._b=c,this._c=v,this._d=S}ce.prototype={transform:function(r,c){return this._transform(r.clone(),c)},_transform:function(r,c){return c=c||1,r.x=c*(this._a*r.x+this._b),r.y=c*(this._c*r.y+this._d),r},untransform:function(r,c){return c=c||1,new J((r.x/c-this._b)/this._a,(r.y/c-this._d)/this._c)}};function V(r,c,v,S){return new ce(r,c,v,S)}var Z=o({},G,{code:"EPSG:3857",projection:de,transformation:function(){var r=.5/(Math.PI*de.R);return V(r,.5,-r,.5)}()}),F=o({},Z,{code:"EPSG:900913"});function D(r){return document.createElementNS("http://www.w3.org/2000/svg",r)}function j(r,c){var v="",S,U,me,Ge,ft,xt;for(S=0,me=r.length;S<me;S++){for(ft=r[S],U=0,Ge=ft.length;U<Ge;U++)xt=ft[U],v+=(U?"L":"M")+xt.x+" "+xt.y;v+=c?bt.svg?"z":"x":""}return v||"M0 0"}var Fe=document.documentElement.style,qe="ActiveXObject"in window,De=qe&&!document.addEventListener,Je="msLaunchUri"in navigator&&!("documentMode"in document),Ze=In("webkit"),yt=In("android"),wt=In("android 2")||In("android 3"),Pt=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),Rt=yt&&In("Google")&&Pt<537&&!("AudioNode"in window),qt=!!window.opera,lt=!Je&&In("chrome"),Oe=In("gecko")&&!Ze&&!qt&&!qe,kt=!lt&&In("safari"),Et=In("phantom"),St="OTransition"in Fe,nt=navigator.platform.indexOf("Win")===0,st=qe&&"transition"in Fe,pn="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!wt,Gt="MozPerspective"in Fe,nn=!window.L_DISABLE_3D&&(st||pn||Gt)&&!St&&!Et,$n=typeof orientation<"u"||In("mobile"),an=$n&&Ze,Dn=$n&&pn,Pn=!window.PointerEvent&&window.MSPointerEvent,Ui=!!(window.PointerEvent||Pn),Oi="ontouchstart"in window||!!window.TouchEvent,qn=!window.L_NO_TOUCH&&(Oi||Ui),$t=$n&&qt,Bn=$n&&Oe,wi=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Yn=function(){var r=!1;try{var c=Object.defineProperty({},"passive",{get:function(){r=!0}});window.addEventListener("testPassiveEventSupport",x,c),window.removeEventListener("testPassiveEventSupport",x,c)}catch{}return r}(),xi=function(){return!!document.createElement("canvas").getContext}(),pi=!!(document.createElementNS&&D("svg").createSVGRect),sn=!!pi&&function(){var r=document.createElement("div");return r.innerHTML="<svg/>",(r.firstChild&&r.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),mn=!pi&&function(){try{var r=document.createElement("div");r.innerHTML='<v:shape adj="1"/>';var c=r.firstChild;return c.style.behavior="url(#default#VML)",c&&typeof c.adj=="object"}catch{return!1}}(),Yt=navigator.platform.indexOf("Mac")===0,gi=navigator.platform.indexOf("Linux")===0;function In(r){return navigator.userAgent.toLowerCase().indexOf(r)>=0}var bt={ie:qe,ielt9:De,edge:Je,webkit:Ze,android:yt,android23:wt,androidStock:Rt,opera:qt,chrome:lt,gecko:Oe,safari:kt,phantom:Et,opera12:St,win:nt,ie3d:st,webkit3d:pn,gecko3d:Gt,any3d:nn,mobile:$n,mobileWebkit:an,mobileWebkit3d:Dn,msPointer:Pn,pointer:Ui,touch:qn,touchNative:Oi,mobileOpera:$t,mobileGecko:Bn,retina:wi,passiveEvents:Yn,canvas:xi,svg:pi,vml:mn,inlineSvg:sn,mac:Yt,linux:gi},Xn=bt.msPointer?"MSPointerDown":"pointerdown",Ii=bt.msPointer?"MSPointerMove":"pointermove",ui=bt.msPointer?"MSPointerUp":"pointerup",yr=bt.msPointer?"MSPointerCancel":"pointercancel",lr={touchstart:Xn,touchmove:Ii,touchend:ui,touchcancel:yr},_r={touchstart:ua,touchmove:As,touchend:As,touchcancel:As},Yi={},ur=!1;function jr(r,c,v){return c==="touchstart"&&ds(),_r[c]?(v=_r[c].bind(this,v),r.addEventListener(lr[c],v,!1),v):(console.warn("wrong event specified:",c),x)}function Ss(r,c,v){if(!lr[c]){console.warn("wrong event specified:",c);return}r.removeEventListener(lr[c],v,!1)}function Zs(r){Yi[r.pointerId]=r}function Ks(r){Yi[r.pointerId]&&(Yi[r.pointerId]=r)}function Gr(r){delete Yi[r.pointerId]}function ds(){ur||(document.addEventListener(Xn,Zs,!0),document.addEventListener(Ii,Ks,!0),document.addEventListener(ui,Gr,!0),document.addEventListener(yr,Gr,!0),ur=!0)}function As(r,c){if(c.pointerType!==(c.MSPOINTER_TYPE_MOUSE||"mouse")){c.touches=[];for(var v in Yi)c.touches.push(Yi[v]);c.changedTouches=[c],r(c)}}function ua(r,c){c.MSPOINTER_TYPE_TOUCH&&c.pointerType===c.MSPOINTER_TYPE_TOUCH&&Bi(c),As(r,c)}function ca(r){var c={},v,S;for(S in r)v=r[S],c[S]=v&&v.bind?v.bind(r):v;return r=c,c.type="dblclick",c.detail=2,c.isTrusted=!1,c._simulated=!0,c}var Ys=200;function Io(r,c){r.addEventListener("dblclick",c);var v=0,S;function U(me){if(me.detail!==1){S=me.detail;return}if(!(me.pointerType==="mouse"||me.sourceCapabilities&&!me.sourceCapabilities.firesTouchEvents)){var Ge=eo(me);if(!(Ge.some(function(xt){return xt instanceof HTMLLabelElement&&xt.attributes.for})&&!Ge.some(function(xt){return xt instanceof HTMLInputElement||xt instanceof HTMLSelectElement}))){var ft=Date.now();ft-v<=Ys?(S++,S===2&&c(ca(me))):S=1,v=ft}}}return r.addEventListener("click",U),{dblclick:c,simDblclick:U}}function ha(r,c){r.removeEventListener("dblclick",c.dblclick),r.removeEventListener("click",c.simDblclick)}var Ms=ps(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Bs=ps(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),go=Bs==="webkitTransition"||Bs==="OTransition"?Bs+"End":"transitionend";function Fo(r){return typeof r=="string"?document.getElementById(r):r}function cr(r,c){var v=r.style[c]||r.currentStyle&&r.currentStyle[c];if((!v||v==="auto")&&document.defaultView){var S=document.defaultView.getComputedStyle(r,null);v=S?S[c]:null}return v==="auto"?null:v}function Fn(r,c,v){var S=document.createElement(r);return S.className=c||"",v&&v.appendChild(S),S}function _n(r){var c=r.parentNode;c&&c.removeChild(r)}function fs(r){for(;r.firstChild;)r.removeChild(r.firstChild)}function Hr(r){var c=r.parentNode;c&&c.lastChild!==r&&c.appendChild(r)}function zr(r){var c=r.parentNode;c&&c.firstChild!==r&&c.insertBefore(r,c.firstChild)}function Ts(r,c){if(r.classList!==void 0)return r.classList.contains(c);var v=Wn(r);return v.length>0&&new RegExp("(^|\\s)"+c+"(\\s|$)").test(v)}function xn(r,c){if(r.classList!==void 0)for(var v=T(c),S=0,U=v.length;S<U;S++)r.classList.add(v[S]);else if(!Ts(r,c)){var me=Wn(r);Ei(r,(me?me+" ":"")+c)}}function Hn(r,c){r.classList!==void 0?r.classList.remove(c):Ei(r,b((" "+Wn(r)+" ").replace(" "+c+" "," ")))}function Ei(r,c){r.className.baseVal===void 0?r.className=c:r.className.baseVal=c}function Wn(r){return r.correspondingElement&&(r=r.correspondingElement),r.className.baseVal===void 0?r.className:r.className.baseVal}function Qn(r,c){"opacity"in r.style?r.style.opacity=c:"filter"in r.style&&ci(r,c)}function ci(r,c){var v=!1,S="DXImageTransform.Microsoft.Alpha";try{v=r.filters.item(S)}catch{if(c===1)return}c=Math.round(c*100),v?(v.Enabled=c!==100,v.Opacity=c):r.style.filter+=" progid:"+S+"(opacity="+c+")"}function ps(r){for(var c=document.documentElement.style,v=0;v<r.length;v++)if(r[v]in c)return r[v];return!1}function Wr(r,c,v){var S=c||new J(0,0);r.style[Ms]=(bt.ie3d?"translate("+S.x+"px,"+S.y+"px)":"translate3d("+S.x+"px,"+S.y+"px,0)")+(v?" scale("+v+")":"")}function _i(r,c){r._leaflet_pos=c,bt.any3d?Wr(r,c):(r.style.left=c.x+"px",r.style.top=c.y+"px")}function Ns(r){return r._leaflet_pos||new J(0,0)}var jo,Js,Da;if("onselectstart"in document)jo=function(){An(window,"selectstart",Bi)},Js=function(){Vn(window,"selectstart",Bi)};else{var mo=ps(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);jo=function(){if(mo){var r=document.documentElement.style;Da=r[mo],r[mo]="none"}},Js=function(){mo&&(document.documentElement.style[mo]=Da,Da=void 0)}}function Ra(){An(window,"dragstart",Bi)}function gs(){Vn(window,"dragstart",Bi)}var Xs,vo;function da(r){for(;r.tabIndex===-1;)r=r.parentNode;r.style&&($i(),Xs=r,vo=r.style.outlineStyle,r.style.outlineStyle="none",An(window,"keydown",$i))}function $i(){Xs&&(Xs.style.outlineStyle=vo,Xs=void 0,vo=void 0,Vn(window,"keydown",$i))}function sl(r){do r=r.parentNode;while((!r.offsetWidth||!r.offsetHeight)&&r!==document.body);return r}function fa(r){var c=r.getBoundingClientRect();return{x:c.width/r.offsetWidth||1,y:c.height/r.offsetHeight||1,boundingClientRect:c}}var kn={__proto__:null,TRANSFORM:Ms,TRANSITION:Bs,TRANSITION_END:go,get:Fo,getStyle:cr,create:Fn,remove:_n,empty:fs,toFront:Hr,toBack:zr,hasClass:Ts,addClass:xn,removeClass:Hn,setClass:Ei,getClass:Wn,setOpacity:Qn,testProp:ps,setTransform:Wr,setPosition:_i,getPosition:Ns,get disableTextSelection(){return jo},get enableTextSelection(){return Js},disableImageDrag:Ra,enableImageDrag:gs,preventOutline:da,restoreOutline:$i,getSizedParentNode:sl,getScale:fa};function An(r,c,v,S){if(c&&typeof c=="object")for(var U in c)yo(r,U,c[U],v);else{c=T(c);for(var me=0,Ge=c.length;me<Ge;me++)yo(r,c[me],v,S)}return this}var Zr="_leaflet_events";function Vn(r,c,v,S){if(arguments.length===1)Oa(r),delete r[Zr];else if(c&&typeof c=="object")for(var U in c)Kr(r,U,c[U],v);else if(c=T(c),arguments.length===2)Oa(r,function(ft){return we(c,ft)!==-1});else for(var me=0,Ge=c.length;me<Ge;me++)Kr(r,c[me],v,S);return this}function Oa(r,c){for(var v in r[Zr]){var S=v.split(/\d/)[0];(!c||c(S))&&Kr(r,S,null,null,v)}}var pa={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function yo(r,c,v,S){var U=c+f(v)+(S?"_"+f(S):"");if(r[Zr]&&r[Zr][U])return this;var me=function(ft){return v.call(S||r,ft||window.event)},Ge=me;!bt.touchNative&&bt.pointer&&c.indexOf("touch")===0?me=jr(r,c,me):bt.touch&&c==="dblclick"?me=Io(r,me):"addEventListener"in r?c==="touchstart"||c==="touchmove"||c==="wheel"||c==="mousewheel"?r.addEventListener(pa[c]||c,me,bt.passiveEvents?{passive:!1}:!1):c==="mouseenter"||c==="mouseleave"?(me=function(ft){ft=ft||window.event,_o(r,ft)&&Ge(ft)},r.addEventListener(pa[c],me,!1)):r.addEventListener(c,Ge,!1):r.attachEvent("on"+c,me),r[Zr]=r[Zr]||{},r[Zr][U]=me}function Kr(r,c,v,S,U){U=U||c+f(v)+(S?"_"+f(S):"");var me=r[Zr]&&r[Zr][U];if(!me)return this;!bt.touchNative&&bt.pointer&&c.indexOf("touch")===0?Ss(r,c,me):bt.touch&&c==="dblclick"?ha(r,me):"removeEventListener"in r?r.removeEventListener(pa[c]||c,me,!1):r.detachEvent("on"+c,me),r[Zr][U]=null}function Qs(r){return r.stopPropagation?r.stopPropagation():r.originalEvent?r.originalEvent._stopped=!0:r.cancelBubble=!0,this}function Ia(r){return yo(r,"wheel",Qs),this}function zo(r){return An(r,"mousedown touchstart dblclick contextmenu",Qs),r._leaflet_disable_click=!0,this}function Bi(r){return r.preventDefault?r.preventDefault():r.returnValue=!1,this}function Ur(r){return Bi(r),Qs(r),this}function eo(r){if(r.composedPath)return r.composedPath();for(var c=[],v=r.target;v;)c.push(v),v=v.parentNode;return c}function ol(r,c){if(!c)return new J(r.clientX,r.clientY);var v=fa(c),S=v.boundingClientRect;return new J((r.clientX-S.left)/v.x-c.clientLeft,(r.clientY-S.top)/v.y-c.clientTop)}var Uo=bt.linux&&bt.chrome?window.devicePixelRatio:bt.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function ga(r){return bt.edge?r.wheelDeltaY/2:r.deltaY&&r.deltaMode===0?-r.deltaY/Uo:r.deltaY&&r.deltaMode===1?-r.deltaY*20:r.deltaY&&r.deltaMode===2?-r.deltaY*60:r.deltaX||r.deltaZ?0:r.wheelDelta?(r.wheelDeltaY||r.wheelDelta)/2:r.detail&&Math.abs(r.detail)<32765?-r.detail*20:r.detail?r.detail/-32765*60:0}function _o(r,c){var v=c.relatedTarget;if(!v)return!0;try{for(;v&&v!==r;)v=v.parentNode}catch{return!1}return v!==r}var $o={__proto__:null,on:An,off:Vn,stopPropagation:Qs,disableScrollPropagation:Ia,disableClickPropagation:zo,preventDefault:Bi,stop:Ur,getPropagationPath:eo,getMousePosition:ol,getWheelDelta:ga,isExternalTarget:_o,addListener:An,removeListener:Vn},Fa=K.extend({run:function(r,c,v,S){this.stop(),this._el=r,this._inProgress=!0,this._duration=v||.25,this._easeOutPower=1/Math.max(S||.5,.2),this._startPos=Ns(r),this._offset=c.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=ae(this._animate,this),this._step()},_step:function(r){var c=+new Date-this._startTime,v=this._duration*1e3;c<v?this._runFrame(this._easeOut(c/v),r):(this._runFrame(1),this._complete())},_runFrame:function(r,c){var v=this._startPos.add(this._offset.multiplyBy(r));c&&v._round(),_i(this._el,v),this.fire("step")},_complete:function(){re(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(r){return 1-Math.pow(1-r,this._easeOutPower)}}),jn=K.extend({options:{crs:Z,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(r,c){c=$(this,c),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(r),this._initLayout(),this._onResize=u(this._onResize,this),this._initEvents(),c.maxBounds&&this.setMaxBounds(c.maxBounds),c.zoom!==void 0&&(this._zoom=this._limitZoom(c.zoom)),c.center&&c.zoom!==void 0&&this.setView(_e(c.center),c.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Bs&&bt.any3d&&!bt.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),An(this._proxy,go,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(r,c,v){if(c=c===void 0?this._zoom:this._limitZoom(c),r=this._limitCenter(_e(r),c,this.options.maxBounds),v=v||{},this._stop(),this._loaded&&!v.reset&&v!==!0){v.animate!==void 0&&(v.zoom=o({animate:v.animate},v.zoom),v.pan=o({animate:v.animate,duration:v.duration},v.pan));var S=this._zoom!==c?this._tryAnimatedZoom&&this._tryAnimatedZoom(r,c,v.zoom):this._tryAnimatedPan(r,v.pan);if(S)return clearTimeout(this._sizeTimer),this}return this._resetView(r,c,v.pan&&v.pan.noMoveStart),this},setZoom:function(r,c){return this._loaded?this.setView(this.getCenter(),r,{zoom:c}):(this._zoom=r,this)},zoomIn:function(r,c){return r=r||(bt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+r,c)},zoomOut:function(r,c){return r=r||(bt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-r,c)},setZoomAround:function(r,c,v){var S=this.getZoomScale(c),U=this.getSize().divideBy(2),me=r instanceof J?r:this.latLngToContainerPoint(r),Ge=me.subtract(U).multiplyBy(1-1/S),ft=this.containerPointToLatLng(U.add(Ge));return this.setView(ft,c,{zoom:v})},_getBoundsCenterZoom:function(r,c){c=c||{},r=r.getBounds?r.getBounds():le(r);var v=ue(c.paddingTopLeft||c.padding||[0,0]),S=ue(c.paddingBottomRight||c.padding||[0,0]),U=this.getBoundsZoom(r,!1,v.add(S));if(U=typeof c.maxZoom=="number"?Math.min(c.maxZoom,U):U,U===1/0)return{center:r.getCenter(),zoom:U};var me=S.subtract(v).divideBy(2),Ge=this.project(r.getSouthWest(),U),ft=this.project(r.getNorthEast(),U),xt=this.unproject(Ge.add(ft).divideBy(2).add(me),U);return{center:xt,zoom:U}},fitBounds:function(r,c){if(r=le(r),!r.isValid())throw new Error("Bounds are not valid.");var v=this._getBoundsCenterZoom(r,c);return this.setView(v.center,v.zoom,c)},fitWorld:function(r){return this.fitBounds([[-90,-180],[90,180]],r)},panTo:function(r,c){return this.setView(r,this._zoom,{pan:c})},panBy:function(r,c){if(r=ue(r).round(),c=c||{},!r.x&&!r.y)return this.fire("moveend");if(c.animate!==!0&&!this.getSize().contains(r))return this._resetView(this.unproject(this.project(this.getCenter()).add(r)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Fa,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),c.noMoveStart||this.fire("movestart"),c.animate!==!1){xn(this._mapPane,"leaflet-pan-anim");var v=this._getMapPanePos().subtract(r).round();this._panAnim.run(this._mapPane,v,c.duration||.25,c.easeLinearity)}else this._rawPanBy(r),this.fire("move").fire("moveend");return this},flyTo:function(r,c,v){if(v=v||{},v.animate===!1||!bt.any3d)return this.setView(r,c,v);this._stop();var S=this.project(this.getCenter()),U=this.project(r),me=this.getSize(),Ge=this._zoom;r=_e(r),c=c===void 0?Ge:c;var ft=Math.max(me.x,me.y),xt=ft*this.getZoomScale(Ge,c),Ft=U.distanceTo(S)||1,Jt=1.42,hn=Jt*Jt;function Rn(si){var gr=si?-1:1,Wu=si?xt:ft,$s=xt*xt-ft*ft+gr*hn*hn*Ft*Ft,hu=2*Wu*hn*Ft,Ko=$s/hu,dl=Math.sqrt(Ko*Ko+1)-Ko,du=dl<1e-9?-18:Math.log(dl);return du}function Er(si){return(Math.exp(si)-Math.exp(-si))/2}function Wi(si){return(Math.exp(si)+Math.exp(-si))/2}function Dr(si){return Er(si)/Wi(si)}var Ai=Rn(0);function Us(si){return ft*(Wi(Ai)/Wi(Ai+Jt*si))}function jl(si){return ft*(Wi(Ai)*Dr(Ai+Jt*si)-Er(Ai))/hn}function _s(si){return 1-Math.pow(1-si,1.5)}var is=Date.now(),Vr=(Rn(1)-Ai)/Jt,Hu=v.duration?1e3*v.duration:1e3*Vr*.8;function zl(){var si=(Date.now()-is)/Hu,gr=_s(si)*Vr;si<=1?(this._flyToFrame=ae(zl,this),this._move(this.unproject(S.add(U.subtract(S).multiplyBy(jl(gr)/Ft)),Ge),this.getScaleZoom(ft/Us(gr),Ge),{flyTo:!0})):this._move(r,c)._moveEnd(!0)}return this._moveStart(!0,v.noMoveStart),zl.call(this),this},flyToBounds:function(r,c){var v=this._getBoundsCenterZoom(r,c);return this.flyTo(v.center,v.zoom,c)},setMaxBounds:function(r){return r=le(r),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),r.isValid()?(this.options.maxBounds=r,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(r){var c=this.options.minZoom;return this.options.minZoom=r,this._loaded&&c!==r&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(r):this},setMaxZoom:function(r){var c=this.options.maxZoom;return this.options.maxZoom=r,this._loaded&&c!==r&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(r):this},panInsideBounds:function(r,c){this._enforcingBounds=!0;var v=this.getCenter(),S=this._limitCenter(v,this._zoom,le(r));return v.equals(S)||this.panTo(S,c),this._enforcingBounds=!1,this},panInside:function(r,c){c=c||{};var v=ue(c.paddingTopLeft||c.padding||[0,0]),S=ue(c.paddingBottomRight||c.padding||[0,0]),U=this.project(this.getCenter()),me=this.project(r),Ge=this.getPixelBounds(),ft=O([Ge.min.add(v),Ge.max.subtract(S)]),xt=ft.getSize();if(!ft.contains(me)){this._enforcingBounds=!0;var Ft=me.subtract(ft.getCenter()),Jt=ft.extend(me).getSize().subtract(xt);U.x+=Ft.x<0?-Jt.x:Jt.x,U.y+=Ft.y<0?-Jt.y:Jt.y,this.panTo(this.unproject(U),c),this._enforcingBounds=!1}return this},invalidateSize:function(r){if(!this._loaded)return this;r=o({animate:!1,pan:!0},r===!0?{animate:!0}:r);var c=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var v=this.getSize(),S=c.divideBy(2).round(),U=v.divideBy(2).round(),me=S.subtract(U);return!me.x&&!me.y?this:(r.animate&&r.pan?this.panBy(me):(r.pan&&this._rawPanBy(me),this.fire("move"),r.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(u(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:c,newSize:v}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(r){if(r=this._locateOptions=o({timeout:1e4,watch:!1},r),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var c=u(this._handleGeolocationResponse,this),v=u(this._handleGeolocationError,this);return r.watch?this._locationWatchId=navigator.geolocation.watchPosition(c,v,r):navigator.geolocation.getCurrentPosition(c,v,r),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(r){if(this._container._leaflet_id){var c=r.code,v=r.message||(c===1?"permission denied":c===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:c,message:"Geolocation error: "+v+"."})}},_handleGeolocationResponse:function(r){if(this._container._leaflet_id){var c=r.coords.latitude,v=r.coords.longitude,S=new fe(c,v),U=S.toBounds(r.coords.accuracy*2),me=this._locateOptions;if(me.setView){var Ge=this.getBoundsZoom(U);this.setView(S,me.maxZoom?Math.min(Ge,me.maxZoom):Ge)}var ft={latlng:S,bounds:U,timestamp:r.timestamp};for(var xt in r.coords)typeof r.coords[xt]=="number"&&(ft[xt]=r.coords[xt]);this.fire("locationfound",ft)}},addHandler:function(r,c){if(!c)return this;var v=this[r]=new c(this);return this._handlers.push(v),this.options[r]&&v.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),_n(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(re(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var r;for(r in this._layers)this._layers[r].remove();for(r in this._panes)_n(this._panes[r]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(r,c){var v="leaflet-pane"+(r?" leaflet-"+r.replace("Pane","")+"-pane":""),S=Fn("div",v,c||this._mapPane);return r&&(this._panes[r]=S),S},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var r=this.getPixelBounds(),c=this.unproject(r.getBottomLeft()),v=this.unproject(r.getTopRight());return new ie(c,v)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(r,c,v){r=le(r),v=ue(v||[0,0]);var S=this.getZoom()||0,U=this.getMinZoom(),me=this.getMaxZoom(),Ge=r.getNorthWest(),ft=r.getSouthEast(),xt=this.getSize().subtract(v),Ft=O(this.project(ft,S),this.project(Ge,S)).getSize(),Jt=bt.any3d?this.options.zoomSnap:1,hn=xt.x/Ft.x,Rn=xt.y/Ft.y,Er=c?Math.max(hn,Rn):Math.min(hn,Rn);return S=this.getScaleZoom(Er,S),Jt&&(S=Math.round(S/(Jt/100))*(Jt/100),S=c?Math.ceil(S/Jt)*Jt:Math.floor(S/Jt)*Jt),Math.max(U,Math.min(me,S))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new J(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(r,c){var v=this._getTopLeftPoint(r,c);return new ye(v,v.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(r){return this.options.crs.getProjectedBounds(r===void 0?this.getZoom():r)},getPane:function(r){return typeof r=="string"?this._panes[r]:r},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(r,c){var v=this.options.crs;return c=c===void 0?this._zoom:c,v.scale(r)/v.scale(c)},getScaleZoom:function(r,c){var v=this.options.crs;c=c===void 0?this._zoom:c;var S=v.zoom(r*v.scale(c));return isNaN(S)?1/0:S},project:function(r,c){return c=c===void 0?this._zoom:c,this.options.crs.latLngToPoint(_e(r),c)},unproject:function(r,c){return c=c===void 0?this._zoom:c,this.options.crs.pointToLatLng(ue(r),c)},layerPointToLatLng:function(r){var c=ue(r).add(this.getPixelOrigin());return this.unproject(c)},latLngToLayerPoint:function(r){var c=this.project(_e(r))._round();return c._subtract(this.getPixelOrigin())},wrapLatLng:function(r){return this.options.crs.wrapLatLng(_e(r))},wrapLatLngBounds:function(r){return this.options.crs.wrapLatLngBounds(le(r))},distance:function(r,c){return this.options.crs.distance(_e(r),_e(c))},containerPointToLayerPoint:function(r){return ue(r).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(r){return ue(r).add(this._getMapPanePos())},containerPointToLatLng:function(r){var c=this.containerPointToLayerPoint(ue(r));return this.layerPointToLatLng(c)},latLngToContainerPoint:function(r){return this.layerPointToContainerPoint(this.latLngToLayerPoint(_e(r)))},mouseEventToContainerPoint:function(r){return ol(r,this._container)},mouseEventToLayerPoint:function(r){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(r))},mouseEventToLatLng:function(r){return this.layerPointToLatLng(this.mouseEventToLayerPoint(r))},_initContainer:function(r){var c=this._container=Fo(r);if(c){if(c._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");An(c,"scroll",this._onScroll,this),this._containerId=f(c)},_initLayout:function(){var r=this._container;this._fadeAnimated=this.options.fadeAnimation&&bt.any3d,xn(r,"leaflet-container"+(bt.touch?" leaflet-touch":"")+(bt.retina?" leaflet-retina":"")+(bt.ielt9?" leaflet-oldie":"")+(bt.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var c=cr(r,"position");c!=="absolute"&&c!=="relative"&&c!=="fixed"&&c!=="sticky"&&(r.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var r=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),_i(this._mapPane,new J(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(xn(r.markerPane,"leaflet-zoom-hide"),xn(r.shadowPane,"leaflet-zoom-hide"))},_resetView:function(r,c,v){_i(this._mapPane,new J(0,0));var S=!this._loaded;this._loaded=!0,c=this._limitZoom(c),this.fire("viewprereset");var U=this._zoom!==c;this._moveStart(U,v)._move(r,c)._moveEnd(U),this.fire("viewreset"),S&&this.fire("load")},_moveStart:function(r,c){return r&&this.fire("zoomstart"),c||this.fire("movestart"),this},_move:function(r,c,v,S){c===void 0&&(c=this._zoom);var U=this._zoom!==c;return this._zoom=c,this._lastCenter=r,this._pixelOrigin=this._getNewPixelOrigin(r),S?v&&v.pinch&&this.fire("zoom",v):((U||v&&v.pinch)&&this.fire("zoom",v),this.fire("move",v)),this},_moveEnd:function(r){return r&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return re(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(r){_i(this._mapPane,this._getMapPanePos().subtract(r))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(r){this._targets={},this._targets[f(this._container)]=this;var c=r?Vn:An;c(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&c(window,"resize",this._onResize,this),bt.any3d&&this.options.transform3DLimit&&(r?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){re(this._resizeRequest),this._resizeRequest=ae(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var r=this._getMapPanePos();Math.max(Math.abs(r.x),Math.abs(r.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(r,c){for(var v=[],S,U=c==="mouseout"||c==="mouseover",me=r.target||r.srcElement,Ge=!1;me;){if(S=this._targets[f(me)],S&&(c==="click"||c==="preclick")&&this._draggableMoved(S)){Ge=!0;break}if(S&&S.listens(c,!0)&&(U&&!_o(me,r)||(v.push(S),U))||me===this._container)break;me=me.parentNode}return!v.length&&!Ge&&!U&&this.listens(c,!0)&&(v=[this]),v},_isClickDisabled:function(r){for(;r&&r!==this._container;){if(r._leaflet_disable_click)return!0;r=r.parentNode}},_handleDOMEvent:function(r){var c=r.target||r.srcElement;if(!(!this._loaded||c._leaflet_disable_events||r.type==="click"&&this._isClickDisabled(c))){var v=r.type;v==="mousedown"&&da(c),this._fireDOMEvent(r,v)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(r,c,v){if(r.type==="click"){var S=o({},r);S.type="preclick",this._fireDOMEvent(S,S.type,v)}var U=this._findEventTargets(r,c);if(v){for(var me=[],Ge=0;Ge<v.length;Ge++)v[Ge].listens(c,!0)&&me.push(v[Ge]);U=me.concat(U)}if(U.length){c==="contextmenu"&&Bi(r);var ft=U[0],xt={originalEvent:r};if(r.type!=="keypress"&&r.type!=="keydown"&&r.type!=="keyup"){var Ft=ft.getLatLng&&(!ft._radius||ft._radius<=10);xt.containerPoint=Ft?this.latLngToContainerPoint(ft.getLatLng()):this.mouseEventToContainerPoint(r),xt.layerPoint=this.containerPointToLayerPoint(xt.containerPoint),xt.latlng=Ft?ft.getLatLng():this.layerPointToLatLng(xt.layerPoint)}for(Ge=0;Ge<U.length;Ge++)if(U[Ge].fire(c,xt,!0),xt.originalEvent._stopped||U[Ge].options.bubblingMouseEvents===!1&&we(this._mouseEvents,c)!==-1)return}},_draggableMoved:function(r){return r=r.dragging&&r.dragging.enabled()?r:this,r.dragging&&r.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var r=0,c=this._handlers.length;r<c;r++)this._handlers[r].disable()},whenReady:function(r,c){return this._loaded?r.call(c||this,{target:this}):this.on("load",r,c),this},_getMapPanePos:function(){return Ns(this._mapPane)||new J(0,0)},_moved:function(){var r=this._getMapPanePos();return r&&!r.equals([0,0])},_getTopLeftPoint:function(r,c){var v=r&&c!==void 0?this._getNewPixelOrigin(r,c):this.getPixelOrigin();return v.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(r,c){var v=this.getSize()._divideBy(2);return this.project(r,c)._subtract(v)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(r,c,v){var S=this._getNewPixelOrigin(v,c);return this.project(r,c)._subtract(S)},_latLngBoundsToNewLayerBounds:function(r,c,v){var S=this._getNewPixelOrigin(v,c);return O([this.project(r.getSouthWest(),c)._subtract(S),this.project(r.getNorthWest(),c)._subtract(S),this.project(r.getSouthEast(),c)._subtract(S),this.project(r.getNorthEast(),c)._subtract(S)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(r){return this.latLngToLayerPoint(r).subtract(this._getCenterLayerPoint())},_limitCenter:function(r,c,v){if(!v)return r;var S=this.project(r,c),U=this.getSize().divideBy(2),me=new ye(S.subtract(U),S.add(U)),Ge=this._getBoundsOffset(me,v,c);return Math.abs(Ge.x)<=1&&Math.abs(Ge.y)<=1?r:this.unproject(S.add(Ge),c)},_limitOffset:function(r,c){if(!c)return r;var v=this.getPixelBounds(),S=new ye(v.min.add(r),v.max.add(r));return r.add(this._getBoundsOffset(S,c))},_getBoundsOffset:function(r,c,v){var S=O(this.project(c.getNorthEast(),v),this.project(c.getSouthWest(),v)),U=S.min.subtract(r.min),me=S.max.subtract(r.max),Ge=this._rebound(U.x,-me.x),ft=this._rebound(U.y,-me.y);return new J(Ge,ft)},_rebound:function(r,c){return r+c>0?Math.round(r-c)/2:Math.max(0,Math.ceil(r))-Math.max(0,Math.floor(c))},_limitZoom:function(r){var c=this.getMinZoom(),v=this.getMaxZoom(),S=bt.any3d?this.options.zoomSnap:1;return S&&(r=Math.round(r/S)*S),Math.max(c,Math.min(v,r))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Hn(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(r,c){var v=this._getCenterOffset(r)._trunc();return(c&&c.animate)!==!0&&!this.getSize().contains(v)?!1:(this.panBy(v,c),!0)},_createAnimProxy:function(){var r=this._proxy=Fn("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(r),this.on("zoomanim",function(c){var v=Ms,S=this._proxy.style[v];Wr(this._proxy,this.project(c.center,c.zoom),this.getZoomScale(c.zoom,1)),S===this._proxy.style[v]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){_n(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var r=this.getCenter(),c=this.getZoom();Wr(this._proxy,this.project(r,c),this.getZoomScale(c,1))},_catchTransitionEnd:function(r){this._animatingZoom&&r.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(r,c,v){if(this._animatingZoom)return!0;if(v=v||{},!this._zoomAnimated||v.animate===!1||this._nothingToAnimate()||Math.abs(c-this._zoom)>this.options.zoomAnimationThreshold)return!1;var S=this.getZoomScale(c),U=this._getCenterOffset(r)._divideBy(1-1/S);return v.animate!==!0&&!this.getSize().contains(U)?!1:(ae(function(){this._moveStart(!0,v.noMoveStart||!1)._animateZoom(r,c,!0)},this),!0)},_animateZoom:function(r,c,v,S){this._mapPane&&(v&&(this._animatingZoom=!0,this._animateToCenter=r,this._animateToZoom=c,xn(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:r,zoom:c,noUpdate:S}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(u(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&Hn(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function ja(r,c){return new jn(r,c)}var dn=Y.extend({options:{position:"topright"},initialize:function(r){$(this,r)},getPosition:function(){return this.options.position},setPosition:function(r){var c=this._map;return c&&c.removeControl(this),this.options.position=r,c&&c.addControl(this),this},getContainer:function(){return this._container},addTo:function(r){this.remove(),this._map=r;var c=this._container=this.onAdd(r),v=this.getPosition(),S=r._controlCorners[v];return xn(c,"leaflet-control"),v.indexOf("bottom")!==-1?S.insertBefore(c,S.firstChild):S.appendChild(c),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(_n(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(r){this._map&&r&&r.screenX>0&&r.screenY>0&&this._map.getContainer().focus()}}),br=function(r){return new dn(r)};jn.include({addControl:function(r){return r.addTo(this),this},removeControl:function(r){return r.remove(),this},_initControlPos:function(){var r=this._controlCorners={},c="leaflet-",v=this._controlContainer=Fn("div",c+"control-container",this._container);function S(U,me){var Ge=c+U+" "+c+me;r[U+me]=Fn("div",Ge,v)}S("top","left"),S("top","right"),S("bottom","left"),S("bottom","right")},_clearControlPos:function(){for(var r in this._controlCorners)_n(this._controlCorners[r]);_n(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var qo=dn.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(r,c,v,S){return v<S?-1:S<v?1:0}},initialize:function(r,c,v){$(this,v),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var S in r)this._addLayer(r[S],S);for(S in c)this._addLayer(c[S],S,!0)},onAdd:function(r){this._initLayout(),this._update(),this._map=r,r.on("zoomend",this._checkDisabledLayers,this);for(var c=0;c<this._layers.length;c++)this._layers[c].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(r){return dn.prototype.addTo.call(this,r),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var r=0;r<this._layers.length;r++)this._layers[r].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(r,c){return this._addLayer(r,c),this._map?this._update():this},addOverlay:function(r,c){return this._addLayer(r,c,!0),this._map?this._update():this},removeLayer:function(r){r.off("add remove",this._onLayerChange,this);var c=this._getLayer(f(r));return c&&this._layers.splice(this._layers.indexOf(c),1),this._map?this._update():this},expand:function(){xn(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var r=this._map.getSize().y-(this._container.offsetTop+50);return r<this._section.clientHeight?(xn(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=r+"px"):Hn(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Hn(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var r="leaflet-control-layers",c=this._container=Fn("div",r),v=this.options.collapsed;c.setAttribute("aria-haspopup",!0),zo(c),Ia(c);var S=this._section=Fn("section",r+"-list");v&&(this._map.on("click",this.collapse,this),An(c,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var U=this._layersLink=Fn("a",r+"-toggle",c);U.href="#",U.title="Layers",U.setAttribute("role","button"),An(U,{keydown:function(me){me.keyCode===13&&this._expandSafely()},click:function(me){Bi(me),this._expandSafely()}},this),v||this.expand(),this._baseLayersList=Fn("div",r+"-base",S),this._separator=Fn("div",r+"-separator",S),this._overlaysList=Fn("div",r+"-overlays",S),c.appendChild(S)},_getLayer:function(r){for(var c=0;c<this._layers.length;c++)if(this._layers[c]&&f(this._layers[c].layer)===r)return this._layers[c]},_addLayer:function(r,c,v){this._map&&r.on("add remove",this._onLayerChange,this),this._layers.push({layer:r,name:c,overlay:v}),this.options.sortLayers&&this._layers.sort(u(function(S,U){return this.options.sortFunction(S.layer,U.layer,S.name,U.name)},this)),this.options.autoZIndex&&r.setZIndex&&(this._lastZIndex++,r.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;fs(this._baseLayersList),fs(this._overlaysList),this._layerControlInputs=[];var r,c,v,S,U=0;for(v=0;v<this._layers.length;v++)S=this._layers[v],this._addItem(S),c=c||S.overlay,r=r||!S.overlay,U+=S.overlay?0:1;return this.options.hideSingleBase&&(r=r&&U>1,this._baseLayersList.style.display=r?"":"none"),this._separator.style.display=c&&r?"":"none",this},_onLayerChange:function(r){this._handlingClick||this._update();var c=this._getLayer(f(r.target)),v=c.overlay?r.type==="add"?"overlayadd":"overlayremove":r.type==="add"?"baselayerchange":null;v&&this._map.fire(v,c)},_createRadioElement:function(r,c){var v='<input type="radio" class="leaflet-control-layers-selector" name="'+r+'"'+(c?' checked="checked"':"")+"/>",S=document.createElement("div");return S.innerHTML=v,S.firstChild},_addItem:function(r){var c=document.createElement("label"),v=this._map.hasLayer(r.layer),S;r.overlay?(S=document.createElement("input"),S.type="checkbox",S.className="leaflet-control-layers-selector",S.defaultChecked=v):S=this._createRadioElement("leaflet-base-layers_"+f(this),v),this._layerControlInputs.push(S),S.layerId=f(r.layer),An(S,"click",this._onInputClick,this);var U=document.createElement("span");U.innerHTML=" "+r.name;var me=document.createElement("span");c.appendChild(me),me.appendChild(S),me.appendChild(U);var Ge=r.overlay?this._overlaysList:this._baseLayersList;return Ge.appendChild(c),this._checkDisabledLayers(),c},_onInputClick:function(){if(!this._preventClick){var r=this._layerControlInputs,c,v,S=[],U=[];this._handlingClick=!0;for(var me=r.length-1;me>=0;me--)c=r[me],v=this._getLayer(c.layerId).layer,c.checked?S.push(v):c.checked||U.push(v);for(me=0;me<U.length;me++)this._map.hasLayer(U[me])&&this._map.removeLayer(U[me]);for(me=0;me<S.length;me++)this._map.hasLayer(S[me])||this._map.addLayer(S[me]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var r=this._layerControlInputs,c,v,S=this._map.getZoom(),U=r.length-1;U>=0;U--)c=r[U],v=this._getLayer(c.layerId).layer,c.disabled=v.options.minZoom!==void 0&&S<v.options.minZoom||v.options.maxZoom!==void 0&&S>v.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var r=this._section;this._preventClick=!0,An(r,"click",Bi),this.expand();var c=this;setTimeout(function(){Vn(r,"click",Bi),c._preventClick=!1})}}),bo=function(r,c,v){return new qo(r,c,v)},Sr=dn.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(r){var c="leaflet-control-zoom",v=Fn("div",c+" leaflet-bar"),S=this.options;return this._zoomInButton=this._createButton(S.zoomInText,S.zoomInTitle,c+"-in",v,this._zoomIn),this._zoomOutButton=this._createButton(S.zoomOutText,S.zoomOutTitle,c+"-out",v,this._zoomOut),this._updateDisabled(),r.on("zoomend zoomlevelschange",this._updateDisabled,this),v},onRemove:function(r){r.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(r){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(r.shiftKey?3:1))},_zoomOut:function(r){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(r.shiftKey?3:1))},_createButton:function(r,c,v,S,U){var me=Fn("a",v,S);return me.innerHTML=r,me.href="#",me.title=c,me.setAttribute("role","button"),me.setAttribute("aria-label",c),zo(me),An(me,"click",Ur),An(me,"click",U,this),An(me,"click",this._refocusOnMap,this),me},_updateDisabled:function(){var r=this._map,c="leaflet-disabled";Hn(this._zoomInButton,c),Hn(this._zoomOutButton,c),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||r._zoom===r.getMinZoom())&&(xn(this._zoomOutButton,c),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||r._zoom===r.getMaxZoom())&&(xn(this._zoomInButton,c),this._zoomInButton.setAttribute("aria-disabled","true"))}});jn.mergeOptions({zoomControl:!0}),jn.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new Sr,this.addControl(this.zoomControl))});var za=function(r){return new Sr(r)},Ds=dn.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(r){var c="leaflet-control-scale",v=Fn("div",c),S=this.options;return this._addScales(S,c+"-line",v),r.on(S.updateWhenIdle?"moveend":"move",this._update,this),r.whenReady(this._update,this),v},onRemove:function(r){r.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(r,c,v){r.metric&&(this._mScale=Fn("div",c,v)),r.imperial&&(this._iScale=Fn("div",c,v))},_update:function(){var r=this._map,c=r.getSize().y/2,v=r.distance(r.containerPointToLatLng([0,c]),r.containerPointToLatLng([this.options.maxWidth,c]));this._updateScales(v)},_updateScales:function(r){this.options.metric&&r&&this._updateMetric(r),this.options.imperial&&r&&this._updateImperial(r)},_updateMetric:function(r){var c=this._getRoundNum(r),v=c<1e3?c+" m":c/1e3+" km";this._updateScale(this._mScale,v,c/r)},_updateImperial:function(r){var c=r*3.2808399,v,S,U;c>5280?(v=c/5280,S=this._getRoundNum(v),this._updateScale(this._iScale,S+" mi",S/v)):(U=this._getRoundNum(c),this._updateScale(this._iScale,U+" ft",U/c))},_updateScale:function(r,c,v){r.style.width=Math.round(this.options.maxWidth*v)+"px",r.innerHTML=c},_getRoundNum:function(r){var c=Math.pow(10,(Math.floor(r)+"").length-1),v=r/c;return v=v>=10?10:v>=5?5:v>=3?3:v>=2?2:1,c*v}}),ma=function(r){return new Ds(r)},va='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Yr=dn.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(bt.inlineSvg?va+" ":"")+"Leaflet</a>"},initialize:function(r){$(this,r),this._attributions={}},onAdd:function(r){r.attributionControl=this,this._container=Fn("div","leaflet-control-attribution"),zo(this._container);for(var c in r._layers)r._layers[c].getAttribution&&this.addAttribution(r._layers[c].getAttribution());return this._update(),r.on("layeradd",this._addAttribution,this),this._container},onRemove:function(r){r.off("layeradd",this._addAttribution,this)},_addAttribution:function(r){r.layer.getAttribution&&(this.addAttribution(r.layer.getAttribution()),r.layer.once("remove",function(){this.removeAttribution(r.layer.getAttribution())},this))},setPrefix:function(r){return this.options.prefix=r,this._update(),this},addAttribution:function(r){return r?(this._attributions[r]||(this._attributions[r]=0),this._attributions[r]++,this._update(),this):this},removeAttribution:function(r){return r?(this._attributions[r]&&(this._attributions[r]--,this._update()),this):this},_update:function(){if(this._map){var r=[];for(var c in this._attributions)this._attributions[c]&&r.push(c);var v=[];this.options.prefix&&v.push(this.options.prefix),r.length&&v.push(r.join(", ")),this._container.innerHTML=v.join(' <span aria-hidden="true">|</span> ')}}});jn.mergeOptions({attributionControl:!0}),jn.addInitHook(function(){this.options.attributionControl&&new Yr().addTo(this)});var ya=function(r){return new Yr(r)};dn.Layers=qo,dn.Zoom=Sr,dn.Scale=Ds,dn.Attribution=Yr,br.layers=bo,br.zoom=za,br.scale=ma,br.attribution=ya;var qi=Y.extend({initialize:function(r){this._map=r},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});qi.addTo=function(r,c){return r.addHandler(c,this),this};var al={Events:N},Vo=bt.touch?"touchstart mousedown":"mousedown",Jr=K.extend({options:{clickTolerance:3},initialize:function(r,c,v,S){$(this,S),this._element=r,this._dragStartTarget=c||r,this._preventOutline=v},enable:function(){this._enabled||(An(this._dragStartTarget,Vo,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Jr._dragging===this&&this.finishDrag(!0),Vn(this._dragStartTarget,Vo,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(r){if(this._enabled&&(this._moved=!1,!Ts(this._element,"leaflet-zoom-anim"))){if(r.touches&&r.touches.length!==1){Jr._dragging===this&&this.finishDrag();return}if(!(Jr._dragging||r.shiftKey||r.which!==1&&r.button!==1&&!r.touches)&&(Jr._dragging=this,this._preventOutline&&da(this._element),Ra(),jo(),!this._moving)){this.fire("down");var c=r.touches?r.touches[0]:r,v=sl(this._element);this._startPoint=new J(c.clientX,c.clientY),this._startPos=Ns(this._element),this._parentScale=fa(v);var S=r.type==="mousedown";An(document,S?"mousemove":"touchmove",this._onMove,this),An(document,S?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(r){if(this._enabled){if(r.touches&&r.touches.length>1){this._moved=!0;return}var c=r.touches&&r.touches.length===1?r.touches[0]:r,v=new J(c.clientX,c.clientY)._subtract(this._startPoint);!v.x&&!v.y||Math.abs(v.x)+Math.abs(v.y)<this.options.clickTolerance||(v.x/=this._parentScale.x,v.y/=this._parentScale.y,Bi(r),this._moved||(this.fire("dragstart"),this._moved=!0,xn(document.body,"leaflet-dragging"),this._lastTarget=r.target||r.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),xn(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(v),this._moving=!0,this._lastEvent=r,this._updatePosition())}},_updatePosition:function(){var r={originalEvent:this._lastEvent};this.fire("predrag",r),_i(this._element,this._newPos),this.fire("drag",r)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(r){Hn(document.body,"leaflet-dragging"),this._lastTarget&&(Hn(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Vn(document,"mousemove touchmove",this._onMove,this),Vn(document,"mouseup touchend touchcancel",this._onUp,this),gs(),Js();var c=this._moved&&this._moving;this._moving=!1,Jr._dragging=!1,c&&this.fire("dragend",{noInertia:r,distance:this._newPos.distanceTo(this._startPos)})}});function _a(r,c,v){var S,U=[1,4,2,8],me,Ge,ft,xt,Ft,Jt,hn,Rn;for(me=0,Jt=r.length;me<Jt;me++)r[me]._code=Lt(r[me],c);for(ft=0;ft<4;ft++){for(hn=U[ft],S=[],me=0,Jt=r.length,Ge=Jt-1;me<Jt;Ge=me++)xt=r[me],Ft=r[Ge],xt._code&hn?Ft._code&hn||(Rn=ct(Ft,xt,hn,c,v),Rn._code=Lt(Rn,c),S.push(Rn)):(Ft._code&hn&&(Rn=ct(Ft,xt,hn,c,v),Rn._code=Lt(Rn,c),S.push(Rn)),S.push(xt));r=S}return r}function Ua(r,c){var v,S,U,me,Ge,ft,xt,Ft,Jt;if(!r||r.length===0)throw new Error("latlngs not passed");en(r)||(console.warn("latlngs are not flat! Only the first ring will be used"),r=r[0]);var hn=_e([0,0]),Rn=le(r),Er=Rn.getNorthWest().distanceTo(Rn.getSouthWest())*Rn.getNorthEast().distanceTo(Rn.getNorthWest());Er<1700&&(hn=$a(r));var Wi=r.length,Dr=[];for(v=0;v<Wi;v++){var Ai=_e(r[v]);Dr.push(c.project(_e([Ai.lat-hn.lat,Ai.lng-hn.lng])))}for(ft=xt=Ft=0,v=0,S=Wi-1;v<Wi;S=v++)U=Dr[v],me=Dr[S],Ge=U.y*me.x-me.y*U.x,xt+=(U.x+me.x)*Ge,Ft+=(U.y+me.y)*Ge,ft+=Ge*3;ft===0?Jt=Dr[0]:Jt=[xt/ft,Ft/ft];var Us=c.unproject(ue(Jt));return _e([Us.lat+hn.lat,Us.lng+hn.lng])}function $a(r){for(var c=0,v=0,S=0,U=0;U<r.length;U++){var me=_e(r[U]);c+=me.lat,v+=me.lng,S++}return _e([c/S,v/S])}var ba={__proto__:null,clipPolygon:_a,polygonCenter:Ua,centroid:$a};function wo(r,c){if(!c||!r.length)return r.slice();var v=c*c;return r=te(r,v),r=Ti(r,v),r}function Go(r,c,v){return Math.sqrt(Kt(r,c,v,!0))}function xo(r,c,v){return Kt(r,c,v)}function Ti(r,c){var v=r.length,S=typeof Uint8Array<"u"?Uint8Array:Array,U=new S(v);U[0]=U[v-1]=1,P(r,U,c,0,v-1);var me,Ge=[];for(me=0;me<v;me++)U[me]&&Ge.push(r[me]);return Ge}function P(r,c,v,S,U){var me=0,Ge,ft,xt;for(ft=S+1;ft<=U-1;ft++)xt=Kt(r[ft],r[S],r[U],!0),xt>me&&(Ge=ft,me=xt);me>v&&(c[Ge]=1,P(r,c,v,S,Ge),P(r,c,v,Ge,U))}function te(r,c){for(var v=[r[0]],S=1,U=0,me=r.length;S<me;S++)Ut(r[S],r[U])>c&&(v.push(r[S]),U=S);return U<me-1&&v.push(r[me-1]),v}var Ne;function Ke(r,c,v,S,U){var me=S?Ne:Lt(r,v),Ge=Lt(c,v),ft,xt,Ft;for(Ne=Ge;;){if(!(me|Ge))return[r,c];if(me&Ge)return!1;ft=me||Ge,xt=ct(r,c,ft,v,U),Ft=Lt(xt,v),ft===me?(r=xt,me=Ft):(c=xt,Ge=Ft)}}function ct(r,c,v,S,U){var me=c.x-r.x,Ge=c.y-r.y,ft=S.min,xt=S.max,Ft,Jt;return v&8?(Ft=r.x+me*(xt.y-r.y)/Ge,Jt=xt.y):v&4?(Ft=r.x+me*(ft.y-r.y)/Ge,Jt=ft.y):v&2?(Ft=xt.x,Jt=r.y+Ge*(xt.x-r.x)/me):v&1&&(Ft=ft.x,Jt=r.y+Ge*(ft.x-r.x)/me),new J(Ft,Jt,U)}function Lt(r,c){var v=0;return r.x<c.min.x?v|=1:r.x>c.max.x&&(v|=2),r.y<c.min.y?v|=4:r.y>c.max.y&&(v|=8),v}function Ut(r,c){var v=c.x-r.x,S=c.y-r.y;return v*v+S*S}function Kt(r,c,v,S){var U=c.x,me=c.y,Ge=v.x-U,ft=v.y-me,xt=Ge*Ge+ft*ft,Ft;return xt>0&&(Ft=((r.x-U)*Ge+(r.y-me)*ft)/xt,Ft>1?(U=v.x,me=v.y):Ft>0&&(U+=Ge*Ft,me+=ft*Ft)),Ge=r.x-U,ft=r.y-me,S?Ge*Ge+ft*ft:new J(U,me)}function en(r){return!se(r[0])||typeof r[0][0]!="object"&&typeof r[0][0]<"u"}function un(r){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),en(r)}function Ln(r,c){var v,S,U,me,Ge,ft,xt,Ft;if(!r||r.length===0)throw new Error("latlngs not passed");en(r)||(console.warn("latlngs are not flat! Only the first ring will be used"),r=r[0]);var Jt=_e([0,0]),hn=le(r),Rn=hn.getNorthWest().distanceTo(hn.getSouthWest())*hn.getNorthEast().distanceTo(hn.getNorthWest());Rn<1700&&(Jt=$a(r));var Er=r.length,Wi=[];for(v=0;v<Er;v++){var Dr=_e(r[v]);Wi.push(c.project(_e([Dr.lat-Jt.lat,Dr.lng-Jt.lng])))}for(v=0,S=0;v<Er-1;v++)S+=Wi[v].distanceTo(Wi[v+1])/2;if(S===0)Ft=Wi[0];else for(v=0,me=0;v<Er-1;v++)if(Ge=Wi[v],ft=Wi[v+1],U=Ge.distanceTo(ft),me+=U,me>S){xt=(me-S)/U,Ft=[ft.x-xt*(ft.x-Ge.x),ft.y-xt*(ft.y-Ge.y)];break}var Ai=c.unproject(ue(Ft));return _e([Ai.lat+Jt.lat,Ai.lng+Jt.lng])}var zn={__proto__:null,simplify:wo,pointToSegmentDistance:Go,closestPointOnSegment:xo,clipSegment:Ke,_getEdgeIntersection:ct,_getBitCode:Lt,_sqClosestPointOnSegment:Kt,isFlat:en,_flat:un,polylineCenter:Ln},mi={project:function(r){return new J(r.lng,r.lat)},unproject:function(r){return new fe(r.y,r.x)},bounds:new ye([-180,-90],[180,90])},Zn={R:6378137,R_MINOR:6356752314245179e-9,bounds:new ye([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(r){var c=Math.PI/180,v=this.R,S=r.lat*c,U=this.R_MINOR/v,me=Math.sqrt(1-U*U),Ge=me*Math.sin(S),ft=Math.tan(Math.PI/4-S/2)/Math.pow((1-Ge)/(1+Ge),me/2);return S=-v*Math.log(Math.max(ft,1e-10)),new J(r.lng*c*v,S)},unproject:function(r){for(var c=180/Math.PI,v=this.R,S=this.R_MINOR/v,U=Math.sqrt(1-S*S),me=Math.exp(-r.y/v),Ge=Math.PI/2-2*Math.atan(me),ft=0,xt=.1,Ft;ft<15&&Math.abs(xt)>1e-7;ft++)Ft=U*Math.sin(Ge),Ft=Math.pow((1-Ft)/(1+Ft),U/2),xt=Math.PI/2-2*Math.atan(me*Ft)-Ge,Ge+=xt;return new fe(Ge*c,r.x*c/v)}},ei={__proto__:null,LonLat:mi,Mercator:Zn,SphericalMercator:de},Vi=o({},G,{code:"EPSG:3395",projection:Zn,transformation:function(){var r=.5/(Math.PI*Zn.R);return V(r,.5,-r,.5)}()}),Fi=o({},G,{code:"EPSG:4326",projection:mi,transformation:V(1/180,1,-1/180,.5)}),$r=o({},ee,{projection:mi,transformation:V(1,0,-1,0),scale:function(r){return Math.pow(2,r)},zoom:function(r){return Math.log(r)/Math.LN2},distance:function(r,c){var v=c.lng-r.lng,S=c.lat-r.lat;return Math.sqrt(v*v+S*S)},infinite:!0});ee.Earth=G,ee.EPSG3395=Vi,ee.EPSG3857=Z,ee.EPSG900913=F,ee.EPSG4326=Fi,ee.Simple=$r;var oi=K.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(r){return r.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(r){return r&&r.removeLayer(this),this},getPane:function(r){return this._map.getPane(r?this.options[r]||r:this.options.pane)},addInteractiveTarget:function(r){return this._map._targets[f(r)]=this,this},removeInteractiveTarget:function(r){return delete this._map._targets[f(r)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(r){var c=r.target;if(c.hasLayer(this)){if(this._map=c,this._zoomAnimated=c._zoomAnimated,this.getEvents){var v=this.getEvents();c.on(v,this),this.once("remove",function(){c.off(v,this)},this)}this.onAdd(c),this.fire("add"),c.fire("layeradd",{layer:this})}}});jn.include({addLayer:function(r){if(!r._layerAdd)throw new Error("The provided object is not a Layer.");var c=f(r);return this._layers[c]?this:(this._layers[c]=r,r._mapToAdd=this,r.beforeAdd&&r.beforeAdd(this),this.whenReady(r._layerAdd,r),this)},removeLayer:function(r){var c=f(r);return this._layers[c]?(this._loaded&&r.onRemove(this),delete this._layers[c],this._loaded&&(this.fire("layerremove",{layer:r}),r.fire("remove")),r._map=r._mapToAdd=null,this):this},hasLayer:function(r){return f(r)in this._layers},eachLayer:function(r,c){for(var v in this._layers)r.call(c,this._layers[v]);return this},_addLayers:function(r){r=r?se(r)?r:[r]:[];for(var c=0,v=r.length;c<v;c++)this.addLayer(r[c])},_addZoomLimit:function(r){(!isNaN(r.options.maxZoom)||!isNaN(r.options.minZoom))&&(this._zoomBoundLayers[f(r)]=r,this._updateZoomLevels())},_removeZoomLimit:function(r){var c=f(r);this._zoomBoundLayers[c]&&(delete this._zoomBoundLayers[c],this._updateZoomLevels())},_updateZoomLevels:function(){var r=1/0,c=-1/0,v=this._getZoomSpan();for(var S in this._zoomBoundLayers){var U=this._zoomBoundLayers[S].options;r=U.minZoom===void 0?r:Math.min(r,U.minZoom),c=U.maxZoom===void 0?c:Math.max(c,U.maxZoom)}this._layersMaxZoom=c===-1/0?void 0:c,this._layersMinZoom=r===1/0?void 0:r,v!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var wr=oi.extend({initialize:function(r,c){$(this,c),this._layers={};var v,S;if(r)for(v=0,S=r.length;v<S;v++)this.addLayer(r[v])},addLayer:function(r){var c=this.getLayerId(r);return this._layers[c]=r,this._map&&this._map.addLayer(r),this},removeLayer:function(r){var c=r in this._layers?r:this.getLayerId(r);return this._map&&this._layers[c]&&this._map.removeLayer(this._layers[c]),delete this._layers[c],this},hasLayer:function(r){var c=typeof r=="number"?r:this.getLayerId(r);return c in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(r){var c=Array.prototype.slice.call(arguments,1),v,S;for(v in this._layers)S=this._layers[v],S[r]&&S[r].apply(S,c);return this},onAdd:function(r){this.eachLayer(r.addLayer,r)},onRemove:function(r){this.eachLayer(r.removeLayer,r)},eachLayer:function(r,c){for(var v in this._layers)r.call(c,this._layers[v]);return this},getLayer:function(r){return this._layers[r]},getLayers:function(){var r=[];return this.eachLayer(r.push,r),r},setZIndex:function(r){return this.invoke("setZIndex",r)},getLayerId:function(r){return f(r)}}),ll=function(r,c){return new wr(r,c)},xr=wr.extend({addLayer:function(r){return this.hasLayer(r)?this:(r.addEventParent(this),wr.prototype.addLayer.call(this,r),this.fire("layeradd",{layer:r}))},removeLayer:function(r){return this.hasLayer(r)?(r in this._layers&&(r=this._layers[r]),r.removeEventParent(this),wr.prototype.removeLayer.call(this,r),this.fire("layerremove",{layer:r})):this},setStyle:function(r){return this.invoke("setStyle",r)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var r=new ie;for(var c in this._layers){var v=this._layers[c];r.extend(v.getBounds?v.getBounds():v.getLatLng())}return r}}),qa=function(r,c){return new xr(r,c)},ms=Y.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(r){$(this,r)},createIcon:function(r){return this._createIcon("icon",r)},createShadow:function(r){return this._createIcon("shadow",r)},_createIcon:function(r,c){var v=this._getIconUrl(r);if(!v){if(r==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var S=this._createImg(v,c&&c.tagName==="IMG"?c:null);return this._setIconStyles(S,r),(this.options.crossOrigin||this.options.crossOrigin==="")&&(S.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),S},_setIconStyles:function(r,c){var v=this.options,S=v[c+"Size"];typeof S=="number"&&(S=[S,S]);var U=ue(S),me=ue(c==="shadow"&&v.shadowAnchor||v.iconAnchor||U&&U.divideBy(2,!0));r.className="leaflet-marker-"+c+" "+(v.className||""),me&&(r.style.marginLeft=-me.x+"px",r.style.marginTop=-me.y+"px"),U&&(r.style.width=U.x+"px",r.style.height=U.y+"px")},_createImg:function(r,c){return c=c||document.createElement("img"),c.src=r,c},_getIconUrl:function(r){return bt.retina&&this.options[r+"RetinaUrl"]||this.options[r+"Url"]}});function Va(r){return new ms(r)}var to=ms.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(r){return typeof to.imagePath!="string"&&(to.imagePath=this._detectIconPath()),(this.options.imagePath||to.imagePath)+ms.prototype._getIconUrl.call(this,r)},_stripUrl:function(r){var c=function(v,S,U){var me=S.exec(v);return me&&me[U]};return r=c(r,/^url\((['"])?(.+)\1\)$/,2),r&&c(r,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var r=Fn("div","leaflet-default-icon-path",document.body),c=cr(r,"background-image")||cr(r,"backgroundImage");if(document.body.removeChild(r),c=this._stripUrl(c),c)return c;var v=document.querySelector('link[href$="leaflet.css"]');return v?v.href.substring(0,v.href.length-11-1):""}}),no=qi.extend({initialize:function(r){this._marker=r},addHooks:function(){var r=this._marker._icon;this._draggable||(this._draggable=new Jr(r,r,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),xn(r,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Hn(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(r){var c=this._marker,v=c._map,S=this._marker.options.autoPanSpeed,U=this._marker.options.autoPanPadding,me=Ns(c._icon),Ge=v.getPixelBounds(),ft=v.getPixelOrigin(),xt=O(Ge.min._subtract(ft).add(U),Ge.max._subtract(ft).subtract(U));if(!xt.contains(me)){var Ft=ue((Math.max(xt.max.x,me.x)-xt.max.x)/(Ge.max.x-xt.max.x)-(Math.min(xt.min.x,me.x)-xt.min.x)/(Ge.min.x-xt.min.x),(Math.max(xt.max.y,me.y)-xt.max.y)/(Ge.max.y-xt.max.y)-(Math.min(xt.min.y,me.y)-xt.min.y)/(Ge.min.y-xt.min.y)).multiplyBy(S);v.panBy(Ft,{animate:!1}),this._draggable._newPos._add(Ft),this._draggable._startPos._add(Ft),_i(c._icon,this._draggable._newPos),this._onDrag(r),this._panRequest=ae(this._adjustPan.bind(this,r))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(r){this._marker.options.autoPan&&(re(this._panRequest),this._panRequest=ae(this._adjustPan.bind(this,r)))},_onDrag:function(r){var c=this._marker,v=c._shadow,S=Ns(c._icon),U=c._map.layerPointToLatLng(S);v&&_i(v,S),c._latlng=U,r.latlng=U,r.oldLatLng=this._oldLatLng,c.fire("move",r).fire("drag",r)},_onDragEnd:function(r){re(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",r)}}),ji=oi.extend({options:{icon:new to,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(r,c){$(this,c),this._latlng=_e(r)},onAdd:function(r){this._zoomAnimated=this._zoomAnimated&&r.options.markerZoomAnimation,this._zoomAnimated&&r.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(r){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&r.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(r){var c=this._latlng;return this._latlng=_e(r),this.update(),this.fire("move",{oldLatLng:c,latlng:this._latlng})},setZIndexOffset:function(r){return this.options.zIndexOffset=r,this.update()},getIcon:function(){return this.options.icon},setIcon:function(r){return this.options.icon=r,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var r=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(r)}return this},_initIcon:function(){var r=this.options,c="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),v=r.icon.createIcon(this._icon),S=!1;v!==this._icon&&(this._icon&&this._removeIcon(),S=!0,r.title&&(v.title=r.title),v.tagName==="IMG"&&(v.alt=r.alt||"")),xn(v,c),r.keyboard&&(v.tabIndex="0",v.setAttribute("role","button")),this._icon=v,r.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&An(v,"focus",this._panOnFocus,this);var U=r.icon.createShadow(this._shadow),me=!1;U!==this._shadow&&(this._removeShadow(),me=!0),U&&(xn(U,c),U.alt=""),this._shadow=U,r.opacity<1&&this._updateOpacity(),S&&this.getPane().appendChild(this._icon),this._initInteraction(),U&&me&&this.getPane(r.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Vn(this._icon,"focus",this._panOnFocus,this),_n(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&_n(this._shadow),this._shadow=null},_setPos:function(r){this._icon&&_i(this._icon,r),this._shadow&&_i(this._shadow,r),this._zIndex=r.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(r){this._icon&&(this._icon.style.zIndex=this._zIndex+r)},_animateZoom:function(r){var c=this._map._latLngToNewLayerPoint(this._latlng,r.zoom,r.center).round();this._setPos(c)},_initInteraction:function(){if(this.options.interactive&&(xn(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),no)){var r=this.options.draggable;this.dragging&&(r=this.dragging.enabled(),this.dragging.disable()),this.dragging=new no(this),r&&this.dragging.enable()}},setOpacity:function(r){return this.options.opacity=r,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var r=this.options.opacity;this._icon&&Qn(this._icon,r),this._shadow&&Qn(this._shadow,r)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var r=this._map;if(r){var c=this.options.icon.options,v=c.iconSize?ue(c.iconSize):ue(0,0),S=c.iconAnchor?ue(c.iconAnchor):ue(0,0);r.panInside(this._latlng,{paddingTopLeft:S,paddingBottomRight:v.subtract(S)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function wa(r,c){return new ji(r,c)}var Ar=oi.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(r){this._renderer=r.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(r){return $(this,r),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&r&&Object.prototype.hasOwnProperty.call(r,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Lr=Ar.extend({options:{fill:!0,radius:10},initialize:function(r,c){$(this,c),this._latlng=_e(r),this._radius=this.options.radius},setLatLng:function(r){var c=this._latlng;return this._latlng=_e(r),this.redraw(),this.fire("move",{oldLatLng:c,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(r){return this.options.radius=this._radius=r,this.redraw()},getRadius:function(){return this._radius},setStyle:function(r){var c=r&&r.radius||this._radius;return Ar.prototype.setStyle.call(this,r),this.setRadius(c),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var r=this._radius,c=this._radiusY||r,v=this._clickTolerance(),S=[r+v,c+v];this._pxBounds=new ye(this._point.subtract(S),this._point.add(S))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(r){return r.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function xa(r,c){return new Lr(r,c)}var hr=Lr.extend({initialize:function(r,c,v){if(typeof c=="number"&&(c=o({},v,{radius:c})),$(this,c),this._latlng=_e(r),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(r){return this._mRadius=r,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var r=[this._radius,this._radiusY||this._radius];return new ie(this._map.layerPointToLatLng(this._point.subtract(r)),this._map.layerPointToLatLng(this._point.add(r)))},setStyle:Ar.prototype.setStyle,_project:function(){var r=this._latlng.lng,c=this._latlng.lat,v=this._map,S=v.options.crs;if(S.distance===G.distance){var U=Math.PI/180,me=this._mRadius/G.R/U,Ge=v.project([c+me,r]),ft=v.project([c-me,r]),xt=Ge.add(ft).divideBy(2),Ft=v.unproject(xt).lat,Jt=Math.acos((Math.cos(me*U)-Math.sin(c*U)*Math.sin(Ft*U))/(Math.cos(c*U)*Math.cos(Ft*U)))/U;(isNaN(Jt)||Jt===0)&&(Jt=me/Math.cos(Math.PI/180*c)),this._point=xt.subtract(v.getPixelOrigin()),this._radius=isNaN(Jt)?0:xt.x-v.project([Ft,r-Jt]).x,this._radiusY=xt.y-Ge.y}else{var hn=S.unproject(S.project(this._latlng).subtract([this._mRadius,0]));this._point=v.latLngToLayerPoint(this._latlng),this._radius=this._point.x-v.latLngToLayerPoint(hn).x}this._updateBounds()}});function io(r,c,v){return new hr(r,c,v)}var qr=Ar.extend({options:{smoothFactor:1,noClip:!1},initialize:function(r,c){$(this,c),this._setLatLngs(r)},getLatLngs:function(){return this._latlngs},setLatLngs:function(r){return this._setLatLngs(r),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(r){for(var c=1/0,v=null,S=Kt,U,me,Ge=0,ft=this._parts.length;Ge<ft;Ge++)for(var xt=this._parts[Ge],Ft=1,Jt=xt.length;Ft<Jt;Ft++){U=xt[Ft-1],me=xt[Ft];var hn=S(r,U,me,!0);hn<c&&(c=hn,v=S(r,U,me))}return v&&(v.distance=Math.sqrt(c)),v},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Ln(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(r,c){return c=c||this._defaultShape(),r=_e(r),c.push(r),this._bounds.extend(r),this.redraw()},_setLatLngs:function(r){this._bounds=new ie,this._latlngs=this._convertLatLngs(r)},_defaultShape:function(){return en(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(r){for(var c=[],v=en(r),S=0,U=r.length;S<U;S++)v?(c[S]=_e(r[S]),this._bounds.extend(c[S])):c[S]=this._convertLatLngs(r[S]);return c},_project:function(){var r=new ye;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,r),this._bounds.isValid()&&r.isValid()&&(this._rawPxBounds=r,this._updateBounds())},_updateBounds:function(){var r=this._clickTolerance(),c=new J(r,r);this._rawPxBounds&&(this._pxBounds=new ye([this._rawPxBounds.min.subtract(c),this._rawPxBounds.max.add(c)]))},_projectLatlngs:function(r,c,v){var S=r[0]instanceof fe,U=r.length,me,Ge;if(S){for(Ge=[],me=0;me<U;me++)Ge[me]=this._map.latLngToLayerPoint(r[me]),v.extend(Ge[me]);c.push(Ge)}else for(me=0;me<U;me++)this._projectLatlngs(r[me],c,v)},_clipPoints:function(){var r=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(r))){if(this.options.noClip){this._parts=this._rings;return}var c=this._parts,v,S,U,me,Ge,ft,xt;for(v=0,U=0,me=this._rings.length;v<me;v++)for(xt=this._rings[v],S=0,Ge=xt.length;S<Ge-1;S++)ft=Ke(xt[S],xt[S+1],r,S,!0),ft&&(c[U]=c[U]||[],c[U].push(ft[0]),(ft[1]!==xt[S+1]||S===Ge-2)&&(c[U].push(ft[1]),U++))}},_simplifyPoints:function(){for(var r=this._parts,c=this.options.smoothFactor,v=0,S=r.length;v<S;v++)r[v]=wo(r[v],c)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(r,c){var v,S,U,me,Ge,ft,xt=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(r))return!1;for(v=0,me=this._parts.length;v<me;v++)for(ft=this._parts[v],S=0,Ge=ft.length,U=Ge-1;S<Ge;U=S++)if(!(!c&&S===0)&&Go(r,ft[U],ft[S])<=xt)return!0;return!1}});function ul(r,c){return new qr(r,c)}qr._flat=un;var Gi=qr.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Ua(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(r){var c=qr.prototype._convertLatLngs.call(this,r),v=c.length;return v>=2&&c[0]instanceof fe&&c[0].equals(c[v-1])&&c.pop(),c},_setLatLngs:function(r){qr.prototype._setLatLngs.call(this,r),en(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return en(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var r=this._renderer._bounds,c=this.options.weight,v=new J(c,c);if(r=new ye(r.min.subtract(v),r.max.add(v)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(r))){if(this.options.noClip){this._parts=this._rings;return}for(var S=0,U=this._rings.length,me;S<U;S++)me=_a(this._rings[S],r,!0),me.length&&this._parts.push(me)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(r){var c=!1,v,S,U,me,Ge,ft,xt,Ft;if(!this._pxBounds||!this._pxBounds.contains(r))return!1;for(me=0,xt=this._parts.length;me<xt;me++)for(v=this._parts[me],Ge=0,Ft=v.length,ft=Ft-1;Ge<Ft;ft=Ge++)S=v[Ge],U=v[ft],S.y>r.y!=U.y>r.y&&r.x<(U.x-S.x)*(r.y-S.y)/(U.y-S.y)+S.x&&(c=!c);return c||qr.prototype._containsPoint.call(this,r,!0)}});function Rs(r,c){return new Gi(r,c)}var Xr=xr.extend({initialize:function(r,c){$(this,c),this._layers={},r&&this.addData(r)},addData:function(r){var c=se(r)?r:r.features,v,S,U;if(c){for(v=0,S=c.length;v<S;v++)U=c[v],(U.geometries||U.geometry||U.features||U.coordinates)&&this.addData(U);return this}var me=this.options;if(me.filter&&!me.filter(r))return this;var Ge=Ho(r,me);return Ge?(Ge.feature=Qr(r),Ge.defaultOptions=Ge.options,this.resetStyle(Ge),me.onEachFeature&&me.onEachFeature(r,Ge),this.addLayer(Ge)):this},resetStyle:function(r){return r===void 0?this.eachLayer(this.resetStyle,this):(r.options=o({},r.defaultOptions),this._setLayerStyle(r,this.options.style),this)},setStyle:function(r){return this.eachLayer(function(c){this._setLayerStyle(c,r)},this)},_setLayerStyle:function(r,c){r.setStyle&&(typeof c=="function"&&(c=c(r.feature)),r.setStyle(c))}});function Ho(r,c){var v=r.type==="Feature"?r.geometry:r,S=v?v.coordinates:null,U=[],me=c&&c.pointToLayer,Ge=c&&c.coordsToLatLng||Os,ft,xt,Ft,Jt;if(!S&&!v)return null;switch(v.type){case"Point":return ft=Ge(S),ro(me,r,ft,c);case"MultiPoint":for(Ft=0,Jt=S.length;Ft<Jt;Ft++)ft=Ge(S[Ft]),U.push(ro(me,r,ft,c));return new xr(U);case"LineString":case"MultiLineString":return xt=er(S,v.type==="LineString"?0:1,Ge),new qr(xt,c);case"Polygon":case"MultiPolygon":return xt=er(S,v.type==="Polygon"?1:2,Ge),new Gi(xt,c);case"GeometryCollection":for(Ft=0,Jt=v.geometries.length;Ft<Jt;Ft++){var hn=Ho({geometry:v.geometries[Ft],type:"Feature",properties:r.properties},c);hn&&U.push(hn)}return new xr(U);case"FeatureCollection":for(Ft=0,Jt=v.features.length;Ft<Jt;Ft++){var Rn=Ho(v.features[Ft],c);Rn&&U.push(Rn)}return new xr(U);default:throw new Error("Invalid GeoJSON object.")}}function ro(r,c,v,S){return r?r(c,v):new ji(v,S&&S.markersInheritOptions&&S)}function Os(r){return new fe(r[1],r[0],r[2])}function er(r,c,v){for(var S=[],U=0,me=r.length,Ge;U<me;U++)Ge=c?er(r[U],c-1,v):(v||Os)(r[U]),S.push(Ge);return S}function Ji(r,c){return r=_e(r),r.alt!==void 0?[k(r.lng,c),k(r.lat,c),k(r.alt,c)]:[k(r.lng,c),k(r.lat,c)]}function vs(r,c,v,S){for(var U=[],me=0,Ge=r.length;me<Ge;me++)U.push(c?vs(r[me],en(r[me])?0:c-1,v,S):Ji(r[me],S));return!c&&v&&U.length>0&&U.push(U[0].slice()),U}function Mr(r,c){return r.feature?o({},r.feature,{geometry:c}):Qr(c)}function Qr(r){return r.type==="Feature"||r.type==="FeatureCollection"?r:{type:"Feature",properties:{},geometry:r}}var so={toGeoJSON:function(r){return Mr(this,{type:"Point",coordinates:Ji(this.getLatLng(),r)})}};ji.include(so),hr.include(so),Lr.include(so),qr.include({toGeoJSON:function(r){var c=!en(this._latlngs),v=vs(this._latlngs,c?1:0,!1,r);return Mr(this,{type:(c?"Multi":"")+"LineString",coordinates:v})}}),Gi.include({toGeoJSON:function(r){var c=!en(this._latlngs),v=c&&!en(this._latlngs[0]),S=vs(this._latlngs,v?2:c?1:0,!0,r);return c||(S=[S]),Mr(this,{type:(v?"Multi":"")+"Polygon",coordinates:S})}}),wr.include({toMultiPoint:function(r){var c=[];return this.eachLayer(function(v){c.push(v.toGeoJSON(r).geometry.coordinates)}),Mr(this,{type:"MultiPoint",coordinates:c})},toGeoJSON:function(r){var c=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(c==="MultiPoint")return this.toMultiPoint(r);var v=c==="GeometryCollection",S=[];return this.eachLayer(function(U){if(U.toGeoJSON){var me=U.toGeoJSON(r);if(v)S.push(me.geometry);else{var Ge=Qr(me);Ge.type==="FeatureCollection"?S.push.apply(S,Ge.features):S.push(Ge)}}}),v?Mr(this,{geometries:S,type:"GeometryCollection"}):{type:"FeatureCollection",features:S}}});function es(r,c){return new Xr(r,c)}var Si=es,Is=oi.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(r,c,v){this._url=r,this._bounds=le(c),$(this,v)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(xn(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){_n(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(r){return this.options.opacity=r,this._image&&this._updateOpacity(),this},setStyle:function(r){return r.opacity&&this.setOpacity(r.opacity),this},bringToFront:function(){return this._map&&Hr(this._image),this},bringToBack:function(){return this._map&&zr(this._image),this},setUrl:function(r){return this._url=r,this._image&&(this._image.src=r),this},setBounds:function(r){return this._bounds=le(r),this._map&&this._reset(),this},getEvents:function(){var r={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(r.zoomanim=this._animateZoom),r},setZIndex:function(r){return this.options.zIndex=r,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var r=this._url.tagName==="IMG",c=this._image=r?this._url:Fn("img");if(xn(c,"leaflet-image-layer"),this._zoomAnimated&&xn(c,"leaflet-zoom-animated"),this.options.className&&xn(c,this.options.className),c.onselectstart=x,c.onmousemove=x,c.onload=u(this.fire,this,"load"),c.onerror=u(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(c.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),r){this._url=c.src;return}c.src=this._url,c.alt=this.options.alt},_animateZoom:function(r){var c=this._map.getZoomScale(r.zoom),v=this._map._latLngBoundsToNewLayerBounds(this._bounds,r.zoom,r.center).min;Wr(this._image,v,c)},_reset:function(){var r=this._image,c=new ye(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),v=c.getSize();_i(r,c.min),r.style.width=v.x+"px",r.style.height=v.y+"px"},_updateOpacity:function(){Qn(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var r=this.options.errorOverlayUrl;r&&this._url!==r&&(this._url=r,this._image.src=r)},getCenter:function(){return this._bounds.getCenter()}}),Cr=function(r,c,v){return new Is(r,c,v)},dr=Is.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var r=this._url.tagName==="VIDEO",c=this._image=r?this._url:Fn("video");if(xn(c,"leaflet-image-layer"),this._zoomAnimated&&xn(c,"leaflet-zoom-animated"),this.options.className&&xn(c,this.options.className),c.onselectstart=x,c.onmousemove=x,c.onloadeddata=u(this.fire,this,"load"),r){for(var v=c.getElementsByTagName("source"),S=[],U=0;U<v.length;U++)S.push(v[U].src);this._url=v.length>0?S:[c.src];return}se(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(c.style,"objectFit")&&(c.style.objectFit="fill"),c.autoplay=!!this.options.autoplay,c.loop=!!this.options.loop,c.muted=!!this.options.muted,c.playsInline=!!this.options.playsInline;for(var me=0;me<this._url.length;me++){var Ge=Fn("source");Ge.src=this._url[me],c.appendChild(Ge)}}});function Wo(r,c,v){return new dr(r,c,v)}var Ga=Is.extend({_initImage:function(){var r=this._image=this._url;xn(r,"leaflet-image-layer"),this._zoomAnimated&&xn(r,"leaflet-zoom-animated"),this.options.className&&xn(r,this.options.className),r.onselectstart=x,r.onmousemove=x}});function Ha(r,c,v){return new Ga(r,c,v)}var fr=oi.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(r,c){r&&(r instanceof fe||se(r))?(this._latlng=_e(r),$(this,c)):($(this,r),this._source=c),this.options.content&&(this._content=this.options.content)},openOn:function(r){return r=arguments.length?r:this._source._map,r.hasLayer(this)||r.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(r){return this._map?this.close():(arguments.length?this._source=r:r=this._source,this._prepareOpen(),this.openOn(r._map)),this},onAdd:function(r){this._zoomAnimated=r._zoomAnimated,this._container||this._initLayout(),r._fadeAnimated&&Qn(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),r._fadeAnimated&&Qn(this._container,1),this.bringToFront(),this.options.interactive&&(xn(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(r){r._fadeAnimated?(Qn(this._container,0),this._removeTimeout=setTimeout(u(_n,void 0,this._container),200)):_n(this._container),this.options.interactive&&(Hn(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(r){return this._latlng=_e(r),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(r){return this._content=r,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var r={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(r.zoomanim=this._animateZoom),r},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Hr(this._container),this},bringToBack:function(){return this._map&&zr(this._container),this},_prepareOpen:function(r){var c=this._source;if(!c._map)return!1;if(c instanceof xr){c=null;var v=this._source._layers;for(var S in v)if(v[S]._map){c=v[S];break}if(!c)return!1;this._source=c}if(!r)if(c.getCenter)r=c.getCenter();else if(c.getLatLng)r=c.getLatLng();else if(c.getBounds)r=c.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(r),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var r=this._contentNode,c=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof c=="string")r.innerHTML=c;else{for(;r.hasChildNodes();)r.removeChild(r.firstChild);r.appendChild(c)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var r=this._map.latLngToLayerPoint(this._latlng),c=ue(this.options.offset),v=this._getAnchor();this._zoomAnimated?_i(this._container,r.add(v)):c=c.add(r).add(v);var S=this._containerBottom=-c.y,U=this._containerLeft=-Math.round(this._containerWidth/2)+c.x;this._container.style.bottom=S+"px",this._container.style.left=U+"px"}},_getAnchor:function(){return[0,0]}});jn.include({_initOverlay:function(r,c,v,S){var U=c;return U instanceof r||(U=new r(S).setContent(c)),v&&U.setLatLng(v),U}}),oi.include({_initOverlay:function(r,c,v,S){var U=v;return U instanceof r?($(U,S),U._source=this):(U=c&&!S?c:new r(S,this),U.setContent(v)),U}});var Br=fr.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(r){return r=arguments.length?r:this._source._map,!r.hasLayer(this)&&r._popup&&r._popup.options.autoClose&&r.removeLayer(r._popup),r._popup=this,fr.prototype.openOn.call(this,r)},onAdd:function(r){fr.prototype.onAdd.call(this,r),r.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Ar||this._source.on("preclick",Qs))},onRemove:function(r){fr.prototype.onRemove.call(this,r),r.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Ar||this._source.off("preclick",Qs))},getEvents:function(){var r=fr.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(r.preclick=this.close),this.options.keepInView&&(r.moveend=this._adjustPan),r},_initLayout:function(){var r="leaflet-popup",c=this._container=Fn("div",r+" "+(this.options.className||"")+" leaflet-zoom-animated"),v=this._wrapper=Fn("div",r+"-content-wrapper",c);if(this._contentNode=Fn("div",r+"-content",v),zo(c),Ia(this._contentNode),An(c,"contextmenu",Qs),this._tipContainer=Fn("div",r+"-tip-container",c),this._tip=Fn("div",r+"-tip",this._tipContainer),this.options.closeButton){var S=this._closeButton=Fn("a",r+"-close-button",c);S.setAttribute("role","button"),S.setAttribute("aria-label","Close popup"),S.href="#close",S.innerHTML='<span aria-hidden="true">&#215;</span>',An(S,"click",function(U){Bi(U),this.close()},this)}},_updateLayout:function(){var r=this._contentNode,c=r.style;c.width="",c.whiteSpace="nowrap";var v=r.offsetWidth;v=Math.min(v,this.options.maxWidth),v=Math.max(v,this.options.minWidth),c.width=v+1+"px",c.whiteSpace="",c.height="";var S=r.offsetHeight,U=this.options.maxHeight,me="leaflet-popup-scrolled";U&&S>U?(c.height=U+"px",xn(r,me)):Hn(r,me),this._containerWidth=this._container.offsetWidth},_animateZoom:function(r){var c=this._map._latLngToNewLayerPoint(this._latlng,r.zoom,r.center),v=this._getAnchor();_i(this._container,c.add(v))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var r=this._map,c=parseInt(cr(this._container,"marginBottom"),10)||0,v=this._container.offsetHeight+c,S=this._containerWidth,U=new J(this._containerLeft,-v-this._containerBottom);U._add(Ns(this._container));var me=r.layerPointToContainerPoint(U),Ge=ue(this.options.autoPanPadding),ft=ue(this.options.autoPanPaddingTopLeft||Ge),xt=ue(this.options.autoPanPaddingBottomRight||Ge),Ft=r.getSize(),Jt=0,hn=0;me.x+S+xt.x>Ft.x&&(Jt=me.x+S-Ft.x+xt.x),me.x-Jt-ft.x<0&&(Jt=me.x-ft.x),me.y+v+xt.y>Ft.y&&(hn=me.y+v-Ft.y+xt.y),me.y-hn-ft.y<0&&(hn=me.y-ft.y),(Jt||hn)&&(this.options.keepInView&&(this._autopanning=!0),r.fire("autopanstart").panBy([Jt,hn]))}},_getAnchor:function(){return ue(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Lo=function(r,c){return new Br(r,c)};jn.mergeOptions({closePopupOnClick:!0}),jn.include({openPopup:function(r,c,v){return this._initOverlay(Br,r,c,v).openOn(this),this},closePopup:function(r){return r=arguments.length?r:this._popup,r&&r.close(),this}}),oi.include({bindPopup:function(r,c){return this._popup=this._initOverlay(Br,this._popup,r,c),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(r){return this._popup&&(this instanceof xr||(this._popup._source=this),this._popup._prepareOpen(r||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(r){return this._popup&&this._popup.setContent(r),this},getPopup:function(){return this._popup},_openPopup:function(r){if(!(!this._popup||!this._map)){Ur(r);var c=r.layer||r.target;if(this._popup._source===c&&!(c instanceof Ar)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(r.latlng);return}this._popup._source=c,this.openPopup(r.latlng)}},_movePopup:function(r){this._popup.setLatLng(r.latlng)},_onKeyPress:function(r){r.originalEvent.keyCode===13&&this._openPopup(r)}});var Fs=fr.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(r){fr.prototype.onAdd.call(this,r),this.setOpacity(this.options.opacity),r.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(r){fr.prototype.onRemove.call(this,r),r.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var r=fr.prototype.getEvents.call(this);return this.options.permanent||(r.preclick=this.close),r},_initLayout:function(){var r="leaflet-tooltip",c=r+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Fn("div",c),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+f(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(r){var c,v,S=this._map,U=this._container,me=S.latLngToContainerPoint(S.getCenter()),Ge=S.layerPointToContainerPoint(r),ft=this.options.direction,xt=U.offsetWidth,Ft=U.offsetHeight,Jt=ue(this.options.offset),hn=this._getAnchor();ft==="top"?(c=xt/2,v=Ft):ft==="bottom"?(c=xt/2,v=0):ft==="center"?(c=xt/2,v=Ft/2):ft==="right"?(c=0,v=Ft/2):ft==="left"?(c=xt,v=Ft/2):Ge.x<me.x?(ft="right",c=0,v=Ft/2):(ft="left",c=xt+(Jt.x+hn.x)*2,v=Ft/2),r=r.subtract(ue(c,v,!0)).add(Jt).add(hn),Hn(U,"leaflet-tooltip-right"),Hn(U,"leaflet-tooltip-left"),Hn(U,"leaflet-tooltip-top"),Hn(U,"leaflet-tooltip-bottom"),xn(U,"leaflet-tooltip-"+ft),_i(U,r)},_updatePosition:function(){var r=this._map.latLngToLayerPoint(this._latlng);this._setPosition(r)},setOpacity:function(r){this.options.opacity=r,this._container&&Qn(this._container,r)},_animateZoom:function(r){var c=this._map._latLngToNewLayerPoint(this._latlng,r.zoom,r.center);this._setPosition(c)},_getAnchor:function(){return ue(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),La=function(r,c){return new Fs(r,c)};jn.include({openTooltip:function(r,c,v){return this._initOverlay(Fs,r,c,v).openOn(this),this},closeTooltip:function(r){return r.close(),this}}),oi.include({bindTooltip:function(r,c){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Fs,this._tooltip,r,c),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(r){if(!(!r&&this._tooltipHandlersAdded)){var c=r?"off":"on",v={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?v.add=this._openTooltip:(v.mouseover=this._openTooltip,v.mouseout=this.closeTooltip,v.click=this._openTooltip,this._map?this._addFocusListeners():v.add=this._addFocusListeners),this._tooltip.options.sticky&&(v.mousemove=this._moveTooltip),this[c](v),this._tooltipHandlersAdded=!r}},openTooltip:function(r){return this._tooltip&&(this instanceof xr||(this._tooltip._source=this),this._tooltip._prepareOpen(r)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(r){return this._tooltip&&this._tooltip.setContent(r),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(r){var c=typeof r.getElement=="function"&&r.getElement();c&&(An(c,"focus",function(){this._tooltip._source=r,this.openTooltip()},this),An(c,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(r){var c=typeof r.getElement=="function"&&r.getElement();c&&c.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(r){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var c=this;this._map.once("moveend",function(){c._openOnceFlag=!1,c._openTooltip(r)});return}this._tooltip._source=r.layer||r.target,this.openTooltip(this._tooltip.options.sticky?r.latlng:void 0)}},_moveTooltip:function(r){var c=r.latlng,v,S;this._tooltip.options.sticky&&r.originalEvent&&(v=this._map.mouseEventToContainerPoint(r.originalEvent),S=this._map.containerPointToLayerPoint(v),c=this._map.layerPointToLatLng(S)),this._tooltip.setLatLng(c)}});var Co=ms.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(r){var c=r&&r.tagName==="DIV"?r:document.createElement("div"),v=this.options;if(v.html instanceof Element?(fs(c),c.appendChild(v.html)):c.innerHTML=v.html!==!1?v.html:"",v.bgPos){var S=ue(v.bgPos);c.style.backgroundPosition=-S.x+"px "+-S.y+"px"}return this._setIconStyles(c,"icon"),c},createShadow:function(){return null}});function Po(r){return new Co(r)}ms.Default=to;var oo=oi.extend({options:{tileSize:256,opacity:1,updateWhenIdle:bt.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(r){$(this,r)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(r){r._addZoomLimit(this)},onRemove:function(r){this._removeAllTiles(),_n(this._container),r._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Hr(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(zr(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(r){return this.options.opacity=r,this._updateOpacity(),this},setZIndex:function(r){return this.options.zIndex=r,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var r=this._clampZoom(this._map.getZoom());r!==this._tileZoom&&(this._tileZoom=r,this._updateLevels()),this._update()}return this},getEvents:function(){var r={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=m(this._onMoveEnd,this.options.updateInterval,this)),r.move=this._onMove),this._zoomAnimated&&(r.zoomanim=this._animateZoom),r},createTile:function(){return document.createElement("div")},getTileSize:function(){var r=this.options.tileSize;return r instanceof J?r:new J(r,r)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(r){for(var c=this.getPane().children,v=-r(-1/0,1/0),S=0,U=c.length,me;S<U;S++)me=c[S].style.zIndex,c[S]!==this._container&&me&&(v=r(v,+me));isFinite(v)&&(this.options.zIndex=v+r(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!bt.ielt9){Qn(this._container,this.options.opacity);var r=+new Date,c=!1,v=!1;for(var S in this._tiles){var U=this._tiles[S];if(!(!U.current||!U.loaded)){var me=Math.min(1,(r-U.loaded)/200);Qn(U.el,me),me<1?c=!0:(U.active?v=!0:this._onOpaqueTile(U),U.active=!0)}}v&&!this._noPrune&&this._pruneTiles(),c&&(re(this._fadeFrame),this._fadeFrame=ae(this._updateOpacity,this))}},_onOpaqueTile:x,_initContainer:function(){this._container||(this._container=Fn("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var r=this._tileZoom,c=this.options.maxZoom;if(r!==void 0){for(var v in this._levels)v=Number(v),this._levels[v].el.children.length||v===r?(this._levels[v].el.style.zIndex=c-Math.abs(r-v),this._onUpdateLevel(v)):(_n(this._levels[v].el),this._removeTilesAtZoom(v),this._onRemoveLevel(v),delete this._levels[v]);var S=this._levels[r],U=this._map;return S||(S=this._levels[r]={},S.el=Fn("div","leaflet-tile-container leaflet-zoom-animated",this._container),S.el.style.zIndex=c,S.origin=U.project(U.unproject(U.getPixelOrigin()),r).round(),S.zoom=r,this._setZoomTransform(S,U.getCenter(),U.getZoom()),x(S.el.offsetWidth),this._onCreateLevel(S)),this._level=S,S}},_onUpdateLevel:x,_onRemoveLevel:x,_onCreateLevel:x,_pruneTiles:function(){if(this._map){var r,c,v=this._map.getZoom();if(v>this.options.maxZoom||v<this.options.minZoom){this._removeAllTiles();return}for(r in this._tiles)c=this._tiles[r],c.retain=c.current;for(r in this._tiles)if(c=this._tiles[r],c.current&&!c.active){var S=c.coords;this._retainParent(S.x,S.y,S.z,S.z-5)||this._retainChildren(S.x,S.y,S.z,S.z+2)}for(r in this._tiles)this._tiles[r].retain||this._removeTile(r)}},_removeTilesAtZoom:function(r){for(var c in this._tiles)this._tiles[c].coords.z===r&&this._removeTile(c)},_removeAllTiles:function(){for(var r in this._tiles)this._removeTile(r)},_invalidateAll:function(){for(var r in this._levels)_n(this._levels[r].el),this._onRemoveLevel(Number(r)),delete this._levels[r];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(r,c,v,S){var U=Math.floor(r/2),me=Math.floor(c/2),Ge=v-1,ft=new J(+U,+me);ft.z=+Ge;var xt=this._tileCoordsToKey(ft),Ft=this._tiles[xt];return Ft&&Ft.active?(Ft.retain=!0,!0):(Ft&&Ft.loaded&&(Ft.retain=!0),Ge>S?this._retainParent(U,me,Ge,S):!1)},_retainChildren:function(r,c,v,S){for(var U=2*r;U<2*r+2;U++)for(var me=2*c;me<2*c+2;me++){var Ge=new J(U,me);Ge.z=v+1;var ft=this._tileCoordsToKey(Ge),xt=this._tiles[ft];if(xt&&xt.active){xt.retain=!0;continue}else xt&&xt.loaded&&(xt.retain=!0);v+1<S&&this._retainChildren(U,me,v+1,S)}},_resetView:function(r){var c=r&&(r.pinch||r.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),c,c)},_animateZoom:function(r){this._setView(r.center,r.zoom,!0,r.noUpdate)},_clampZoom:function(r){var c=this.options;return c.minNativeZoom!==void 0&&r<c.minNativeZoom?c.minNativeZoom:c.maxNativeZoom!==void 0&&c.maxNativeZoom<r?c.maxNativeZoom:r},_setView:function(r,c,v,S){var U=Math.round(c);this.options.maxZoom!==void 0&&U>this.options.maxZoom||this.options.minZoom!==void 0&&U<this.options.minZoom?U=void 0:U=this._clampZoom(U);var me=this.options.updateWhenZooming&&U!==this._tileZoom;(!S||me)&&(this._tileZoom=U,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),U!==void 0&&this._update(r),v||this._pruneTiles(),this._noPrune=!!v),this._setZoomTransforms(r,c)},_setZoomTransforms:function(r,c){for(var v in this._levels)this._setZoomTransform(this._levels[v],r,c)},_setZoomTransform:function(r,c,v){var S=this._map.getZoomScale(v,r.zoom),U=r.origin.multiplyBy(S).subtract(this._map._getNewPixelOrigin(c,v)).round();bt.any3d?Wr(r.el,U,S):_i(r.el,U)},_resetGrid:function(){var r=this._map,c=r.options.crs,v=this._tileSize=this.getTileSize(),S=this._tileZoom,U=this._map.getPixelWorldBounds(this._tileZoom);U&&(this._globalTileRange=this._pxBoundsToTileRange(U)),this._wrapX=c.wrapLng&&!this.options.noWrap&&[Math.floor(r.project([0,c.wrapLng[0]],S).x/v.x),Math.ceil(r.project([0,c.wrapLng[1]],S).x/v.y)],this._wrapY=c.wrapLat&&!this.options.noWrap&&[Math.floor(r.project([c.wrapLat[0],0],S).y/v.x),Math.ceil(r.project([c.wrapLat[1],0],S).y/v.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(r){var c=this._map,v=c._animatingZoom?Math.max(c._animateToZoom,c.getZoom()):c.getZoom(),S=c.getZoomScale(v,this._tileZoom),U=c.project(r,this._tileZoom).floor(),me=c.getSize().divideBy(S*2);return new ye(U.subtract(me),U.add(me))},_update:function(r){var c=this._map;if(c){var v=this._clampZoom(c.getZoom());if(r===void 0&&(r=c.getCenter()),this._tileZoom!==void 0){var S=this._getTiledPixelBounds(r),U=this._pxBoundsToTileRange(S),me=U.getCenter(),Ge=[],ft=this.options.keepBuffer,xt=new ye(U.getBottomLeft().subtract([ft,-ft]),U.getTopRight().add([ft,-ft]));if(!(isFinite(U.min.x)&&isFinite(U.min.y)&&isFinite(U.max.x)&&isFinite(U.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var Ft in this._tiles){var Jt=this._tiles[Ft].coords;(Jt.z!==this._tileZoom||!xt.contains(new J(Jt.x,Jt.y)))&&(this._tiles[Ft].current=!1)}if(Math.abs(v-this._tileZoom)>1){this._setView(r,v);return}for(var hn=U.min.y;hn<=U.max.y;hn++)for(var Rn=U.min.x;Rn<=U.max.x;Rn++){var Er=new J(Rn,hn);if(Er.z=this._tileZoom,!!this._isValidTile(Er)){var Wi=this._tiles[this._tileCoordsToKey(Er)];Wi?Wi.current=!0:Ge.push(Er)}}if(Ge.sort(function(Ai,Us){return Ai.distanceTo(me)-Us.distanceTo(me)}),Ge.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Dr=document.createDocumentFragment();for(Rn=0;Rn<Ge.length;Rn++)this._addTile(Ge[Rn],Dr);this._level.el.appendChild(Dr)}}}},_isValidTile:function(r){var c=this._map.options.crs;if(!c.infinite){var v=this._globalTileRange;if(!c.wrapLng&&(r.x<v.min.x||r.x>v.max.x)||!c.wrapLat&&(r.y<v.min.y||r.y>v.max.y))return!1}if(!this.options.bounds)return!0;var S=this._tileCoordsToBounds(r);return le(this.options.bounds).overlaps(S)},_keyToBounds:function(r){return this._tileCoordsToBounds(this._keyToTileCoords(r))},_tileCoordsToNwSe:function(r){var c=this._map,v=this.getTileSize(),S=r.scaleBy(v),U=S.add(v),me=c.unproject(S,r.z),Ge=c.unproject(U,r.z);return[me,Ge]},_tileCoordsToBounds:function(r){var c=this._tileCoordsToNwSe(r),v=new ie(c[0],c[1]);return this.options.noWrap||(v=this._map.wrapLatLngBounds(v)),v},_tileCoordsToKey:function(r){return r.x+":"+r.y+":"+r.z},_keyToTileCoords:function(r){var c=r.split(":"),v=new J(+c[0],+c[1]);return v.z=+c[2],v},_removeTile:function(r){var c=this._tiles[r];c&&(_n(c.el),delete this._tiles[r],this.fire("tileunload",{tile:c.el,coords:this._keyToTileCoords(r)}))},_initTile:function(r){xn(r,"leaflet-tile");var c=this.getTileSize();r.style.width=c.x+"px",r.style.height=c.y+"px",r.onselectstart=x,r.onmousemove=x,bt.ielt9&&this.options.opacity<1&&Qn(r,this.options.opacity)},_addTile:function(r,c){var v=this._getTilePos(r),S=this._tileCoordsToKey(r),U=this.createTile(this._wrapCoords(r),u(this._tileReady,this,r));this._initTile(U),this.createTile.length<2&&ae(u(this._tileReady,this,r,null,U)),_i(U,v),this._tiles[S]={el:U,coords:r,current:!0},c.appendChild(U),this.fire("tileloadstart",{tile:U,coords:r})},_tileReady:function(r,c,v){c&&this.fire("tileerror",{error:c,tile:v,coords:r});var S=this._tileCoordsToKey(r);v=this._tiles[S],v&&(v.loaded=+new Date,this._map._fadeAnimated?(Qn(v.el,0),re(this._fadeFrame),this._fadeFrame=ae(this._updateOpacity,this)):(v.active=!0,this._pruneTiles()),c||(xn(v.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:v.el,coords:r})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),bt.ielt9||!this._map._fadeAnimated?ae(this._pruneTiles,this):setTimeout(u(this._pruneTiles,this),250)))},_getTilePos:function(r){return r.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(r){var c=new J(this._wrapX?y(r.x,this._wrapX):r.x,this._wrapY?y(r.y,this._wrapY):r.y);return c.z=r.z,c},_pxBoundsToTileRange:function(r){var c=this.getTileSize();return new ye(r.min.unscaleBy(c).floor(),r.max.unscaleBy(c).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var r in this._tiles)if(!this._tiles[r].loaded)return!1;return!0}});function ts(r){return new oo(r)}var tr=oo.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(r,c){this._url=r,c=$(this,c),c.detectRetina&&bt.retina&&c.maxZoom>0?(c.tileSize=Math.floor(c.tileSize/2),c.zoomReverse?(c.zoomOffset--,c.minZoom=Math.min(c.maxZoom,c.minZoom+1)):(c.zoomOffset++,c.maxZoom=Math.max(c.minZoom,c.maxZoom-1)),c.minZoom=Math.max(0,c.minZoom)):c.zoomReverse?c.minZoom=Math.min(c.maxZoom,c.minZoom):c.maxZoom=Math.max(c.minZoom,c.maxZoom),typeof c.subdomains=="string"&&(c.subdomains=c.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(r,c){return this._url===r&&c===void 0&&(c=!0),this._url=r,c||this.redraw(),this},createTile:function(r,c){var v=document.createElement("img");return An(v,"load",u(this._tileOnLoad,this,c,v)),An(v,"error",u(this._tileOnError,this,c,v)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(v.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(v.referrerPolicy=this.options.referrerPolicy),v.alt="",v.src=this.getTileUrl(r),v},getTileUrl:function(r){var c={r:bt.retina?"@2x":"",s:this._getSubdomain(r),x:r.x,y:r.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var v=this._globalTileRange.max.y-r.y;this.options.tms&&(c.y=v),c["-y"]=v}return Q(this._url,o(c,this.options))},_tileOnLoad:function(r,c){bt.ielt9?setTimeout(u(r,this,null,c),0):r(null,c)},_tileOnError:function(r,c,v){var S=this.options.errorTileUrl;S&&c.getAttribute("src")!==S&&(c.src=S),r(v,c)},_onTileRemove:function(r){r.tile.onload=null},_getZoomForUrl:function(){var r=this._tileZoom,c=this.options.maxZoom,v=this.options.zoomReverse,S=this.options.zoomOffset;return v&&(r=c-r),r+S},_getSubdomain:function(r){var c=Math.abs(r.x+r.y)%this.options.subdomains.length;return this.options.subdomains[c]},_abortLoading:function(){var r,c;for(r in this._tiles)if(this._tiles[r].coords.z!==this._tileZoom&&(c=this._tiles[r].el,c.onload=x,c.onerror=x,!c.complete)){c.src=Be;var v=this._tiles[r].coords;_n(c),delete this._tiles[r],this.fire("tileabort",{tile:c,coords:v})}},_removeTile:function(r){var c=this._tiles[r];if(c)return c.el.setAttribute("src",Be),oo.prototype._removeTile.call(this,r)},_tileReady:function(r,c,v){if(!(!this._map||v&&v.getAttribute("src")===Be))return oo.prototype._tileReady.call(this,r,c,v)}});function ri(r,c){return new tr(r,c)}var ti=tr.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(r,c){this._url=r;var v=o({},this.defaultWmsParams);for(var S in c)S in this.options||(v[S]=c[S]);c=$(this,c);var U=c.detectRetina&&bt.retina?2:1,me=this.getTileSize();v.width=me.x*U,v.height=me.y*U,this.wmsParams=v},onAdd:function(r){this._crs=this.options.crs||r.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var c=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[c]=this._crs.code,tr.prototype.onAdd.call(this,r)},getTileUrl:function(r){var c=this._tileCoordsToNwSe(r),v=this._crs,S=O(v.project(c[0]),v.project(c[1])),U=S.min,me=S.max,Ge=(this._wmsVersion>=1.3&&this._crs===Fi?[U.y,U.x,me.y,me.x]:[U.x,U.y,me.x,me.y]).join(","),ft=tr.prototype.getTileUrl.call(this,r);return ft+H(this.wmsParams,ft,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+Ge},setParams:function(r,c){return o(this.wmsParams,r),c||this.redraw(),this}});function Ni(r,c){return new ti(r,c)}tr.WMS=ti,ri.wms=Ni;var ai=oi.extend({options:{padding:.1},initialize:function(r){$(this,r),f(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),xn(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var r={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(r.zoomanim=this._onAnimZoom),r},_onAnimZoom:function(r){this._updateTransform(r.center,r.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(r,c){var v=this._map.getZoomScale(c,this._zoom),S=this._map.getSize().multiplyBy(.5+this.options.padding),U=this._map.project(this._center,c),me=S.multiplyBy(-v).add(U).subtract(this._map._getNewPixelOrigin(r,c));bt.any3d?Wr(this._container,me,v):_i(this._container,me)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var r in this._layers)this._layers[r]._reset()},_onZoomEnd:function(){for(var r in this._layers)this._layers[r]._project()},_updatePaths:function(){for(var r in this._layers)this._layers[r]._update()},_update:function(){var r=this.options.padding,c=this._map.getSize(),v=this._map.containerPointToLayerPoint(c.multiplyBy(-r)).round();this._bounds=new ye(v,v.add(c.multiplyBy(1+r*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),ys=ai.extend({options:{tolerance:0},getEvents:function(){var r=ai.prototype.getEvents.call(this);return r.viewprereset=this._onViewPreReset,r},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){ai.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var r=this._container=document.createElement("canvas");An(r,"mousemove",this._onMouseMove,this),An(r,"click dblclick mousedown mouseup contextmenu",this._onClick,this),An(r,"mouseout",this._handleMouseOut,this),r._leaflet_disable_events=!0,this._ctx=r.getContext("2d")},_destroyContainer:function(){re(this._redrawRequest),delete this._ctx,_n(this._container),Vn(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var r;this._redrawBounds=null;for(var c in this._layers)r=this._layers[c],r._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){ai.prototype._update.call(this);var r=this._bounds,c=this._container,v=r.getSize(),S=bt.retina?2:1;_i(c,r.min),c.width=S*v.x,c.height=S*v.y,c.style.width=v.x+"px",c.style.height=v.y+"px",bt.retina&&this._ctx.scale(2,2),this._ctx.translate(-r.min.x,-r.min.y),this.fire("update")}},_reset:function(){ai.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(r){this._updateDashArray(r),this._layers[f(r)]=r;var c=r._order={layer:r,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=c),this._drawLast=c,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(r){this._requestRedraw(r)},_removePath:function(r){var c=r._order,v=c.next,S=c.prev;v?v.prev=S:this._drawLast=S,S?S.next=v:this._drawFirst=v,delete r._order,delete this._layers[f(r)],this._requestRedraw(r)},_updatePath:function(r){this._extendRedrawBounds(r),r._project(),r._update(),this._requestRedraw(r)},_updateStyle:function(r){this._updateDashArray(r),this._requestRedraw(r)},_updateDashArray:function(r){if(typeof r.options.dashArray=="string"){var c=r.options.dashArray.split(/[, ]+/),v=[],S,U;for(U=0;U<c.length;U++){if(S=Number(c[U]),isNaN(S))return;v.push(S)}r.options._dashArray=v}else r.options._dashArray=r.options.dashArray},_requestRedraw:function(r){this._map&&(this._extendRedrawBounds(r),this._redrawRequest=this._redrawRequest||ae(this._redraw,this))},_extendRedrawBounds:function(r){if(r._pxBounds){var c=(r.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new ye,this._redrawBounds.extend(r._pxBounds.min.subtract([c,c])),this._redrawBounds.extend(r._pxBounds.max.add([c,c]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var r=this._redrawBounds;if(r){var c=r.getSize();this._ctx.clearRect(r.min.x,r.min.y,c.x,c.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var r,c=this._redrawBounds;if(this._ctx.save(),c){var v=c.getSize();this._ctx.beginPath(),this._ctx.rect(c.min.x,c.min.y,v.x,v.y),this._ctx.clip()}this._drawing=!0;for(var S=this._drawFirst;S;S=S.next)r=S.layer,(!c||r._pxBounds&&r._pxBounds.intersects(c))&&r._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(r,c){if(this._drawing){var v,S,U,me,Ge=r._parts,ft=Ge.length,xt=this._ctx;if(ft){for(xt.beginPath(),v=0;v<ft;v++){for(S=0,U=Ge[v].length;S<U;S++)me=Ge[v][S],xt[S?"lineTo":"moveTo"](me.x,me.y);c&&xt.closePath()}this._fillStroke(xt,r)}}},_updateCircle:function(r){if(!(!this._drawing||r._empty())){var c=r._point,v=this._ctx,S=Math.max(Math.round(r._radius),1),U=(Math.max(Math.round(r._radiusY),1)||S)/S;U!==1&&(v.save(),v.scale(1,U)),v.beginPath(),v.arc(c.x,c.y/U,S,0,Math.PI*2,!1),U!==1&&v.restore(),this._fillStroke(v,r)}},_fillStroke:function(r,c){var v=c.options;v.fill&&(r.globalAlpha=v.fillOpacity,r.fillStyle=v.fillColor||v.color,r.fill(v.fillRule||"evenodd")),v.stroke&&v.weight!==0&&(r.setLineDash&&r.setLineDash(c.options&&c.options._dashArray||[]),r.globalAlpha=v.opacity,r.lineWidth=v.weight,r.strokeStyle=v.color,r.lineCap=v.lineCap,r.lineJoin=v.lineJoin,r.stroke())},_onClick:function(r){for(var c=this._map.mouseEventToLayerPoint(r),v,S,U=this._drawFirst;U;U=U.next)v=U.layer,v.options.interactive&&v._containsPoint(c)&&(!(r.type==="click"||r.type==="preclick")||!this._map._draggableMoved(v))&&(S=v);this._fireEvent(S?[S]:!1,r)},_onMouseMove:function(r){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var c=this._map.mouseEventToLayerPoint(r);this._handleMouseHover(r,c)}},_handleMouseOut:function(r){var c=this._hoveredLayer;c&&(Hn(this._container,"leaflet-interactive"),this._fireEvent([c],r,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(r,c){if(!this._mouseHoverThrottled){for(var v,S,U=this._drawFirst;U;U=U.next)v=U.layer,v.options.interactive&&v._containsPoint(c)&&(S=v);S!==this._hoveredLayer&&(this._handleMouseOut(r),S&&(xn(this._container,"leaflet-interactive"),this._fireEvent([S],r,"mouseover"),this._hoveredLayer=S)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,r),this._mouseHoverThrottled=!0,setTimeout(u(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(r,c,v){this._map._fireDOMEvent(c,v||c.type,r)},_bringToFront:function(r){var c=r._order;if(c){var v=c.next,S=c.prev;if(v)v.prev=S;else return;S?S.next=v:v&&(this._drawFirst=v),c.prev=this._drawLast,this._drawLast.next=c,c.next=null,this._drawLast=c,this._requestRedraw(r)}},_bringToBack:function(r){var c=r._order;if(c){var v=c.next,S=c.prev;if(S)S.next=v;else return;v?v.prev=S:S&&(this._drawLast=S),c.prev=null,c.next=this._drawFirst,this._drawFirst.prev=c,this._drawFirst=c,this._requestRedraw(r)}}});function ko(r){return bt.canvas?new ys(r):null}var js=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(r){return document.createElement("<lvml:"+r+' class="lvml">')}}catch{}return function(r){return document.createElement("<"+r+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),cl={_initContainer:function(){this._container=Fn("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(ai.prototype._update.call(this),this.fire("update"))},_initPath:function(r){var c=r._container=js("shape");xn(c,"leaflet-vml-shape "+(this.options.className||"")),c.coordsize="1 1",r._path=js("path"),c.appendChild(r._path),this._updateStyle(r),this._layers[f(r)]=r},_addPath:function(r){var c=r._container;this._container.appendChild(c),r.options.interactive&&r.addInteractiveTarget(c)},_removePath:function(r){var c=r._container;_n(c),r.removeInteractiveTarget(c),delete this._layers[f(r)]},_updateStyle:function(r){var c=r._stroke,v=r._fill,S=r.options,U=r._container;U.stroked=!!S.stroke,U.filled=!!S.fill,S.stroke?(c||(c=r._stroke=js("stroke")),U.appendChild(c),c.weight=S.weight+"px",c.color=S.color,c.opacity=S.opacity,S.dashArray?c.dashStyle=se(S.dashArray)?S.dashArray.join(" "):S.dashArray.replace(/( *, *)/g," "):c.dashStyle="",c.endcap=S.lineCap.replace("butt","flat"),c.joinstyle=S.lineJoin):c&&(U.removeChild(c),r._stroke=null),S.fill?(v||(v=r._fill=js("fill")),U.appendChild(v),v.color=S.fillColor||S.color,v.opacity=S.fillOpacity):v&&(U.removeChild(v),r._fill=null)},_updateCircle:function(r){var c=r._point.round(),v=Math.round(r._radius),S=Math.round(r._radiusY||v);this._setPath(r,r._empty()?"M0 0":"AL "+c.x+","+c.y+" "+v+","+S+" 0,"+65535*360)},_setPath:function(r,c){r._path.v=c},_bringToFront:function(r){Hr(r._container)},_bringToBack:function(r){zr(r._container)}},Eo=bt.vml?js:D,Hi=ai.extend({_initContainer:function(){this._container=Eo("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Eo("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){_n(this._container),Vn(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){ai.prototype._update.call(this);var r=this._bounds,c=r.getSize(),v=this._container;(!this._svgSize||!this._svgSize.equals(c))&&(this._svgSize=c,v.setAttribute("width",c.x),v.setAttribute("height",c.y)),_i(v,r.min),v.setAttribute("viewBox",[r.min.x,r.min.y,c.x,c.y].join(" ")),this.fire("update")}},_initPath:function(r){var c=r._path=Eo("path");r.options.className&&xn(c,r.options.className),r.options.interactive&&xn(c,"leaflet-interactive"),this._updateStyle(r),this._layers[f(r)]=r},_addPath:function(r){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(r._path),r.addInteractiveTarget(r._path)},_removePath:function(r){_n(r._path),r.removeInteractiveTarget(r._path),delete this._layers[f(r)]},_updatePath:function(r){r._project(),r._update()},_updateStyle:function(r){var c=r._path,v=r.options;c&&(v.stroke?(c.setAttribute("stroke",v.color),c.setAttribute("stroke-opacity",v.opacity),c.setAttribute("stroke-width",v.weight),c.setAttribute("stroke-linecap",v.lineCap),c.setAttribute("stroke-linejoin",v.lineJoin),v.dashArray?c.setAttribute("stroke-dasharray",v.dashArray):c.removeAttribute("stroke-dasharray"),v.dashOffset?c.setAttribute("stroke-dashoffset",v.dashOffset):c.removeAttribute("stroke-dashoffset")):c.setAttribute("stroke","none"),v.fill?(c.setAttribute("fill",v.fillColor||v.color),c.setAttribute("fill-opacity",v.fillOpacity),c.setAttribute("fill-rule",v.fillRule||"evenodd")):c.setAttribute("fill","none"))},_updatePoly:function(r,c){this._setPath(r,j(r._parts,c))},_updateCircle:function(r){var c=r._point,v=Math.max(Math.round(r._radius),1),S=Math.max(Math.round(r._radiusY),1)||v,U="a"+v+","+S+" 0 1,0 ",me=r._empty()?"M0 0":"M"+(c.x-v)+","+c.y+U+v*2+",0 "+U+-v*2+",0 ";this._setPath(r,me)},_setPath:function(r,c){r._path.setAttribute("d",c)},_bringToFront:function(r){Hr(r._path)},_bringToBack:function(r){zr(r._path)}});bt.vml&&Hi.include(cl);function li(r){return bt.svg||bt.vml?new Hi(r):null}jn.include({getRenderer:function(r){var c=r.options.renderer||this._getPaneRenderer(r.options.pane)||this.options.renderer||this._renderer;return c||(c=this._renderer=this._createRenderer()),this.hasLayer(c)||this.addLayer(c),c},_getPaneRenderer:function(r){if(r==="overlayPane"||r===void 0)return!1;var c=this._paneRenderers[r];return c===void 0&&(c=this._createRenderer({pane:r}),this._paneRenderers[r]=c),c},_createRenderer:function(r){return this.options.preferCanvas&&ko(r)||li(r)}});var Tr=Gi.extend({initialize:function(r,c){Gi.prototype.initialize.call(this,this._boundsToLatLngs(r),c)},setBounds:function(r){return this.setLatLngs(this._boundsToLatLngs(r))},_boundsToLatLngs:function(r){return r=le(r),[r.getSouthWest(),r.getNorthWest(),r.getNorthEast(),r.getSouthEast()]}});function Nr(r,c){return new Tr(r,c)}Hi.create=Eo,Hi.pointsToPath=j,Xr.geometryToLayer=Ho,Xr.coordsToLatLng=Os,Xr.coordsToLatLngs=er,Xr.latLngToCoords=Ji,Xr.latLngsToCoords=vs,Xr.getFeature=Mr,Xr.asFeature=Qr,jn.mergeOptions({boxZoom:!0});var bn=qi.extend({initialize:function(r){this._map=r,this._container=r._container,this._pane=r._panes.overlayPane,this._resetStateTimeout=0,r.on("unload",this._destroy,this)},addHooks:function(){An(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Vn(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){_n(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(r){if(!r.shiftKey||r.which!==1&&r.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),jo(),Ra(),this._startPoint=this._map.mouseEventToContainerPoint(r),An(document,{contextmenu:Ur,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(r){this._moved||(this._moved=!0,this._box=Fn("div","leaflet-zoom-box",this._container),xn(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(r);var c=new ye(this._point,this._startPoint),v=c.getSize();_i(this._box,c.min),this._box.style.width=v.x+"px",this._box.style.height=v.y+"px"},_finish:function(){this._moved&&(_n(this._box),Hn(this._container,"leaflet-crosshair")),Js(),gs(),Vn(document,{contextmenu:Ur,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(r){if(!(r.which!==1&&r.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(u(this._resetState,this),0);var c=new ie(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(c).fire("boxzoomend",{boxZoomBounds:c})}},_onKeyDown:function(r){r.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});jn.addInitHook("addHandler","boxZoom",bn),jn.mergeOptions({doubleClickZoom:!0});var hl=qi.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(r){var c=this._map,v=c.getZoom(),S=c.options.zoomDelta,U=r.originalEvent.shiftKey?v-S:v+S;c.options.doubleClickZoom==="center"?c.setZoom(U):c.setZoomAround(r.containerPoint,U)}});jn.addInitHook("addHandler","doubleClickZoom",hl),jn.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Zo=qi.extend({addHooks:function(){if(!this._draggable){var r=this._map;this._draggable=new Jr(r._mapPane,r._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),r.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),r.on("zoomend",this._onZoomEnd,this),r.whenReady(this._onZoomEnd,this))}xn(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Hn(this._map._container,"leaflet-grab"),Hn(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var r=this._map;if(r._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var c=le(this._map.options.maxBounds);this._offsetLimit=O(this._map.latLngToContainerPoint(c.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(c.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;r.fire("movestart").fire("dragstart"),r.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(r){if(this._map.options.inertia){var c=this._lastTime=+new Date,v=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(v),this._times.push(c),this._prunePositions(c)}this._map.fire("move",r).fire("drag",r)},_prunePositions:function(r){for(;this._positions.length>1&&r-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var r=this._map.getSize().divideBy(2),c=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=c.subtract(r).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(r,c){return r-(r-c)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var r=this._draggable._newPos.subtract(this._draggable._startPos),c=this._offsetLimit;r.x<c.min.x&&(r.x=this._viscousLimit(r.x,c.min.x)),r.y<c.min.y&&(r.y=this._viscousLimit(r.y,c.min.y)),r.x>c.max.x&&(r.x=this._viscousLimit(r.x,c.max.x)),r.y>c.max.y&&(r.y=this._viscousLimit(r.y,c.max.y)),this._draggable._newPos=this._draggable._startPos.add(r)}},_onPreDragWrap:function(){var r=this._worldWidth,c=Math.round(r/2),v=this._initialWorldOffset,S=this._draggable._newPos.x,U=(S-c+v)%r+c-v,me=(S+c+v)%r-c-v,Ge=Math.abs(U+v)<Math.abs(me+v)?U:me;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=Ge},_onDragEnd:function(r){var c=this._map,v=c.options,S=!v.inertia||r.noInertia||this._times.length<2;if(c.fire("dragend",r),S)c.fire("moveend");else{this._prunePositions(+new Date);var U=this._lastPos.subtract(this._positions[0]),me=(this._lastTime-this._times[0])/1e3,Ge=v.easeLinearity,ft=U.multiplyBy(Ge/me),xt=ft.distanceTo([0,0]),Ft=Math.min(v.inertiaMaxSpeed,xt),Jt=ft.multiplyBy(Ft/xt),hn=Ft/(v.inertiaDeceleration*Ge),Rn=Jt.multiplyBy(-hn/2).round();!Rn.x&&!Rn.y?c.fire("moveend"):(Rn=c._limitOffset(Rn,c.options.maxBounds),ae(function(){c.panBy(Rn,{duration:hn,easeLinearity:Ge,noMoveStart:!0,animate:!0})}))}}});jn.addInitHook("addHandler","dragging",Zo),jn.mergeOptions({keyboard:!0,keyboardPanDelta:80});var ns=qi.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(r){this._map=r,this._setPanDelta(r.options.keyboardPanDelta),this._setZoomDelta(r.options.zoomDelta)},addHooks:function(){var r=this._map._container;r.tabIndex<=0&&(r.tabIndex="0"),An(r,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Vn(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var r=document.body,c=document.documentElement,v=r.scrollTop||c.scrollTop,S=r.scrollLeft||c.scrollLeft;this._map._container.focus(),window.scrollTo(S,v)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(r){var c=this._panKeys={},v=this.keyCodes,S,U;for(S=0,U=v.left.length;S<U;S++)c[v.left[S]]=[-1*r,0];for(S=0,U=v.right.length;S<U;S++)c[v.right[S]]=[r,0];for(S=0,U=v.down.length;S<U;S++)c[v.down[S]]=[0,r];for(S=0,U=v.up.length;S<U;S++)c[v.up[S]]=[0,-1*r]},_setZoomDelta:function(r){var c=this._zoomKeys={},v=this.keyCodes,S,U;for(S=0,U=v.zoomIn.length;S<U;S++)c[v.zoomIn[S]]=r;for(S=0,U=v.zoomOut.length;S<U;S++)c[v.zoomOut[S]]=-r},_addHooks:function(){An(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Vn(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(r){if(!(r.altKey||r.ctrlKey||r.metaKey)){var c=r.keyCode,v=this._map,S;if(c in this._panKeys){if(!v._panAnim||!v._panAnim._inProgress)if(S=this._panKeys[c],r.shiftKey&&(S=ue(S).multiplyBy(3)),v.options.maxBounds&&(S=v._limitOffset(ue(S),v.options.maxBounds)),v.options.worldCopyJump){var U=v.wrapLatLng(v.unproject(v.project(v.getCenter()).add(S)));v.panTo(U)}else v.panBy(S)}else if(c in this._zoomKeys)v.setZoom(v.getZoom()+(r.shiftKey?3:1)*this._zoomKeys[c]);else if(c===27&&v._popup&&v._popup.options.closeOnEscapeKey)v.closePopup();else return;Ur(r)}}});jn.addInitHook("addHandler","keyboard",ns),jn.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var pr=qi.extend({addHooks:function(){An(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Vn(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(r){var c=ga(r),v=this._map.options.wheelDebounceTime;this._delta+=c,this._lastMousePos=this._map.mouseEventToContainerPoint(r),this._startTime||(this._startTime=+new Date);var S=Math.max(v-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(u(this._performZoom,this),S),Ur(r)},_performZoom:function(){var r=this._map,c=r.getZoom(),v=this._map.options.zoomSnap||0;r._stop();var S=this._delta/(this._map.options.wheelPxPerZoomLevel*4),U=4*Math.log(2/(1+Math.exp(-Math.abs(S))))/Math.LN2,me=v?Math.ceil(U/v)*v:U,Ge=r._limitZoom(c+(this._delta>0?me:-me))-c;this._delta=0,this._startTime=null,Ge&&(r.options.scrollWheelZoom==="center"?r.setZoom(c+Ge):r.setZoomAround(this._lastMousePos,c+Ge))}});jn.addInitHook("addHandler","scrollWheelZoom",pr);var Fl=600;jn.mergeOptions({tapHold:bt.touchNative&&bt.safari&&bt.mobile,tapTolerance:15});var Pr=qi.extend({addHooks:function(){An(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Vn(this._map._container,"touchstart",this._onDown,this)},_onDown:function(r){if(clearTimeout(this._holdTimeout),r.touches.length===1){var c=r.touches[0];this._startPos=this._newPos=new J(c.clientX,c.clientY),this._holdTimeout=setTimeout(u(function(){this._cancel(),this._isTapValid()&&(An(document,"touchend",Bi),An(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",c))},this),Fl),An(document,"touchend touchcancel contextmenu",this._cancel,this),An(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function r(){Vn(document,"touchend",Bi),Vn(document,"touchend touchcancel",r)},_cancel:function(){clearTimeout(this._holdTimeout),Vn(document,"touchend touchcancel contextmenu",this._cancel,this),Vn(document,"touchmove",this._onMove,this)},_onMove:function(r){var c=r.touches[0];this._newPos=new J(c.clientX,c.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(r,c){var v=new MouseEvent(r,{bubbles:!0,cancelable:!0,view:window,screenX:c.screenX,screenY:c.screenY,clientX:c.clientX,clientY:c.clientY});v._simulated=!0,c.target.dispatchEvent(v)}});jn.addInitHook("addHandler","tapHold",Pr),jn.mergeOptions({touchZoom:bt.touch,bounceAtZoomLimits:!0});var kr=qi.extend({addHooks:function(){xn(this._map._container,"leaflet-touch-zoom"),An(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Hn(this._map._container,"leaflet-touch-zoom"),Vn(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(r){var c=this._map;if(!(!r.touches||r.touches.length!==2||c._animatingZoom||this._zooming)){var v=c.mouseEventToContainerPoint(r.touches[0]),S=c.mouseEventToContainerPoint(r.touches[1]);this._centerPoint=c.getSize()._divideBy(2),this._startLatLng=c.containerPointToLatLng(this._centerPoint),c.options.touchZoom!=="center"&&(this._pinchStartLatLng=c.containerPointToLatLng(v.add(S)._divideBy(2))),this._startDist=v.distanceTo(S),this._startZoom=c.getZoom(),this._moved=!1,this._zooming=!0,c._stop(),An(document,"touchmove",this._onTouchMove,this),An(document,"touchend touchcancel",this._onTouchEnd,this),Bi(r)}},_onTouchMove:function(r){if(!(!r.touches||r.touches.length!==2||!this._zooming)){var c=this._map,v=c.mouseEventToContainerPoint(r.touches[0]),S=c.mouseEventToContainerPoint(r.touches[1]),U=v.distanceTo(S)/this._startDist;if(this._zoom=c.getScaleZoom(U,this._startZoom),!c.options.bounceAtZoomLimits&&(this._zoom<c.getMinZoom()&&U<1||this._zoom>c.getMaxZoom()&&U>1)&&(this._zoom=c._limitZoom(this._zoom)),c.options.touchZoom==="center"){if(this._center=this._startLatLng,U===1)return}else{var me=v._add(S)._divideBy(2)._subtract(this._centerPoint);if(U===1&&me.x===0&&me.y===0)return;this._center=c.unproject(c.project(this._pinchStartLatLng,this._zoom).subtract(me),this._zoom)}this._moved||(c._moveStart(!0,!1),this._moved=!0),re(this._animRequest);var Ge=u(c._move,c,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=ae(Ge,this,!0),Bi(r)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,re(this._animRequest),Vn(document,"touchmove",this._onTouchMove,this),Vn(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});jn.addInitHook("addHandler","touchZoom",kr),jn.BoxZoom=bn,jn.DoubleClickZoom=hl,jn.Drag=Zo,jn.Keyboard=ns,jn.ScrollWheelZoom=pr,jn.TapHold=Pr,jn.TouchZoom=kr,n.Bounds=ye,n.Browser=bt,n.CRS=ee,n.Canvas=ys,n.Circle=hr,n.CircleMarker=Lr,n.Class=Y,n.Control=dn,n.DivIcon=Co,n.DivOverlay=fr,n.DomEvent=$o,n.DomUtil=kn,n.Draggable=Jr,n.Evented=K,n.FeatureGroup=xr,n.GeoJSON=Xr,n.GridLayer=oo,n.Handler=qi,n.Icon=ms,n.ImageOverlay=Is,n.LatLng=fe,n.LatLngBounds=ie,n.Layer=oi,n.LayerGroup=wr,n.LineUtil=zn,n.Map=jn,n.Marker=ji,n.Mixin=al,n.Path=Ar,n.Point=J,n.PolyUtil=ba,n.Polygon=Gi,n.Polyline=qr,n.Popup=Br,n.PosAnimation=Fa,n.Projection=ei,n.Rectangle=Tr,n.Renderer=ai,n.SVG=Hi,n.SVGOverlay=Ga,n.TileLayer=tr,n.Tooltip=Fs,n.Transformation=ce,n.Util=oe,n.VideoOverlay=dr,n.bind=u,n.bounds=O,n.canvas=ko,n.circle=io,n.circleMarker=xa,n.control=br,n.divIcon=Po,n.extend=o,n.featureGroup=qa,n.geoJSON=es,n.geoJson=Si,n.gridLayer=ts,n.icon=Va,n.imageOverlay=Cr,n.latLng=_e,n.latLngBounds=le,n.layerGroup=ll,n.map=ja,n.marker=wa,n.point=ue,n.polygon=Rs,n.polyline=ul,n.popup=Lo,n.rectangle=Nr,n.setOptions=$,n.stamp=f,n.svg=li,n.svgOverlay=Ha,n.tileLayer=ri,n.tooltip=La,n.transformation=V,n.version=i,n.videoOverlay=Wo;var zs=window.L;n.noConflict=function(){return window.L=zs,this},window.L=n})})(Pf,Pf.exports);var Zi=Pf.exports;const Xe=A1(Zi);var Y0={exports:{}};(function(e,t){(function(n,i){i(t)})(To,function(n){var i=typeof window<"u"?window:typeof To<"u"?To:typeof self<"u"?self:{};function o(m,y){return m(y={exports:{}},y.exports),y.exports}var a=o(function(m,y){(function(x){const k={escape:function(C){return C.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1")},parseExtension:b,mimeType:function(C){return C=b(C).toLowerCase(),function(){var N="application/font-woff",K="image/jpeg";return{woff:N,woff2:N,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:K,jpeg:K,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml"}}()[C]||""},dataAsUrl:function(C,N){return`data:${N};base64,`+C},isDataUrl:function(C){return C.search(/^(data:)/)!==-1},canvasToBlob:function(C){return C.toBlob?new Promise(function(K){C.toBlob(K)}):(N=C,new Promise(function(K){const J=Ue(N.toDataURL().split(",")[1]);var Ee=J.length;const ue=new Uint8Array(Ee);for(let ye=0;ye<Ee;ye++)ue[ye]=J.charCodeAt(ye);K(new Blob([ue],{type:"image/png"}))}));var N},resolveUrl:function(C,N){const K=document.implementation.createHTMLDocument(),J=K.createElement("base"),Ee=(K.head.appendChild(J),K.createElement("a"));return K.body.appendChild(Ee),J.href=N,Ee.href=C,Ee.href},getAndEncode:function(C){let N=Be.impl.urlCache.find(function(K){return K.url===C});return N||(N={url:C,promise:null},Be.impl.urlCache.push(N)),N.promise===null&&(Be.impl.options.cacheBust&&(C+=(/\?/.test(C)?"&":"?")+new Date().getTime()),N.promise=new Promise(function(K){const J=Be.impl.options.httpTimeout,Ee=new XMLHttpRequest;let ue;var ye;function O(ie){console.error(ie),K("")}Ee.onreadystatechange=function(){if(Ee.readyState===4)if(Ee.status!==200)ue?K(ue):O(`cannot fetch resource: ${C}, status: `+Ee.status);else{const ie=new FileReader;ie.onloadend=function(){var le=ie.result.split(/,/)[1];K(le)},ie.readAsDataURL(Ee.response)}},Ee.ontimeout=function(){ue?K(ue):O(`timeout of ${J}ms occured while fetching resource: `+C)},Ee.responseType="blob",Ee.timeout=J,Be.impl.options.useCredentials&&(Ee.withCredentials=!0),Ee.open("GET",C,!0),Ee.send(),Be.impl.options.imagePlaceholder&&(ye=Be.impl.options.imagePlaceholder.split(/,/))&&ye[1]&&(ue=ye[1])})),N.promise},uid:function(){let C=0;return function(){return"u"+("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4)+C++}}(),delay:function(C){return function(N){return new Promise(function(K){setTimeout(function(){K(N)},C)})}},asArray:function(C){const N=[],K=C.length;for(let J=0;J<K;J++)N.push(C[J]);return N},escapeXhtml:function(C){return C.replace(/%/g,"%25").replace(/#/g,"%23").replace(/\n/g,"%0A")},makeImage:function(C){return C!=="data:,"?new Promise(function(N,K){const J=new Image;Be.impl.options.useCredentials&&(J.crossOrigin="use-credentials"),J.onload=function(){N(J)},J.onerror=K,J.src=C}):Promise.resolve()},width:function(C){var N=T(C,"border-left-width"),K=T(C,"border-right-width");return C.scrollWidth+N+K},height:function(C){var N=T(C,"border-top-width"),K=T(C,"border-bottom-width");return C.scrollHeight+N+K}};function b(C){return(C=/\.([^\.\/]*?)(\?|$)/g.exec(C))?C[1]:""}function T(C,N){const K=$e(C).getPropertyValue(N);return parseFloat(K.replace("px",""))}const $=function(){const C=/url\(['"]?([^'"]+?)['"]?\)/g;return{inlineAll:function(Ee,ue,ye){return N(Ee)?Promise.resolve(Ee).then(K).then(function(O){let ie=Promise.resolve(Ee);return O.forEach(function(le){ie=ie.then(function(fe){return J(fe,le,ue,ye)})}),ie}):Promise.resolve(Ee)},shouldProcess:N,impl:{readUrls:K,inline:J}};function N(Ee){return Ee.search(C)!==-1}function K(Ee){const ue=[];for(var ye;(ye=C.exec(Ee))!==null;)ue.push(ye[1]);return ue.filter(function(O){return!k.isDataUrl(O)})}function J(Ee,ue,ye,O){return Promise.resolve(ue).then(function(ie){return ye?k.resolveUrl(ie,ye):ie}).then(O||k.getAndEncode).then(function(ie){return k.dataAsUrl(ie,k.mimeType(ue))}).then(function(ie){return Ee.replace((le=ue,new RegExp(`(url\\(['"]?)(${k.escape(le)})(['"]?\\))`,"g")),`$1${ie}$3`);var le})}}(),H={resolveAll:function(){return I().then(function(C){return Promise.all(C.map(function(N){return N.resolve()}))}).then(function(C){return C.join(`
`)})},impl:{readAll:I}};function I(){return Promise.resolve(k.asArray(document.styleSheets)).then(function(N){const K=[];return N.forEach(function(J){if(Object.getPrototypeOf(J).hasOwnProperty("cssRules"))try{k.asArray(J.cssRules||[]).forEach(K.push.bind(K))}catch(Ee){console.log("Error while reading CSS rules from "+J.href,Ee.toString())}}),K}).then(function(N){return N.filter(function(K){return K.type===CSSRule.FONT_FACE_RULE}).filter(function(K){return $.shouldProcess(K.style.getPropertyValue("src"))})}).then(function(N){return N.map(C)});function C(N){return{resolve:function(){var K=(N.parentStyleSheet||{}).href;return $.inlineAll(N.cssText,K)},src:function(){return N.style.getPropertyValue("src")}}}}const Q={inlineAll:function C(N){return N instanceof Element?function(K){const J=K.style.getPropertyValue("background");return J?$.inlineAll(J).then(function(Ee){K.style.setProperty("background",Ee,J)}).then(function(){return K}):Promise.resolve(K)}(N).then(function(){return N instanceof HTMLImageElement?se(N).inline():Promise.all(k.asArray(N.childNodes).map(function(K){return C(K)}))}):Promise.resolve(N)},impl:{newImage:se}};function se(C){return{inline:function(N){return k.isDataUrl(C.src)?Promise.resolve():Promise.resolve(C.src).then(N||k.getAndEncode).then(function(K){return k.dataAsUrl(K,k.mimeType(C.src))}).then(function(K){return new Promise(function(J){C.onload=J,C.onerror=J,C.src=K})})}}}const we={imagePlaceholder:void 0,cacheBust:!1,useCredentials:!1},Be={toSvg:Pe,toPng:function(C,N){return(N=N||{}).raster=!0,Te(C,N).then(function(K){return K.toDataURL()})},toJpeg:function(C,N){return(N=N||{}).raster=!0,Te(C,N).then(function(K){return K.toDataURL("image/jpeg",N.quality||1)})},toBlob:function(C,N){return(N=N||{}).raster=!0,Te(C,N).then(k.canvasToBlob)},toPixelData:function(C,N){return(N=N||{}).raster=!0,Te(C,N).then(function(K){return K.getContext("2d").getImageData(0,0,k.width(C),k.height(C)).data})},toCanvas:function(C,N){return(N=N||{}).raster=!0,Te(C,N||{})},impl:{fontFaces:H,images:Q,util:k,inliner:$,urlCache:[],options:{}}},$e=(m.exports=Be,x.getComputedStyle||window.getComputedStyle),Ue=x.atob||window.atob;function Pe(C,N){var K=N=N||{};return K.imagePlaceholder===void 0?Be.impl.options.imagePlaceholder=we.imagePlaceholder:Be.impl.options.imagePlaceholder=K.imagePlaceholder,K.cacheBust===void 0?Be.impl.options.cacheBust=we.cacheBust:Be.impl.options.cacheBust=K.cacheBust,K.useCredentials===void 0?Be.impl.options.useCredentials=we.useCredentials:Be.impl.options.useCredentials=K.useCredentials,Promise.resolve(C).then(function(J){return function Ee(ue,ye,O,ie,le=null){return O||!ye||ye(ue)?Promise.resolve(ue).then(function(fe){return fe instanceof HTMLCanvasElement?k.makeImage(fe.toDataURL()):fe.nodeName==="IFRAME"?html2canvas(fe.contentDocument.body).then(_e=>_e.toDataURL()).then(k.makeImage):fe.cloneNode(!1)}).then(function(fe){return function(_e,ee){const G=_e.childNodes;return G.length===0?Promise.resolve(ee):function(q,de){const ce=$e(_e);let V=Promise.resolve();return de.forEach(function(Z){V=V.then(function(){return Ee(Z,ye,!1,ie,ce)}).then(function(F){F&&q.appendChild(F)})}),V}(ee,k.asArray(G)).then(function(){return ee})}(ue,fe)}).then(function(fe){return function(_e,ee,G){return ee instanceof Element?Promise.resolve().then(function(){(function(q,de){const ce=$e(q);ce.cssText?(de.style.cssText=ce.cssText,function(V,Z){Z.font=V.font,Z.fontFamily=V.fontFamily,Z.fontFeatureSettings=V.fontFeatureSettings,Z.fontKerning=V.fontKerning,Z.fontSize=V.fontSize,Z.fontStretch=V.fontStretch,Z.fontStyle=V.fontStyle,Z.fontVariant=V.fontVariant,Z.fontVariantCaps=V.fontVariantCaps,Z.fontVariantEastAsian=V.fontVariantEastAsian,Z.fontVariantLigatures=V.fontVariantLigatures,Z.fontVariantNumeric=V.fontVariantNumeric,Z.fontVariationSettings=V.fontVariationSettings,Z.fontWeight=V.fontWeight}(ce,de.style)):(G?function(V,Z,F,D){const j=F.style,Fe=V.style;for(var qe of Z){var De=Z.getPropertyValue(qe),Je=Fe.getPropertyValue(qe),Ze=(Fe.setProperty(qe,D?"initial":"unset"),Z.getPropertyValue(qe));Ze!==De?j.setProperty(qe,De):j.removeProperty(qe),Fe.setProperty(qe,Je)}}(q,ce,de,O):function(V,Z,F){const D=function(Fe){if(Y[Fe])return Y[Fe];oe||((oe=document.createElement("iframe")).style.visibility="hidden",oe.style.position="fixed",document.body.appendChild(oe),oe.contentWindow.document.write('<!DOCTYPE html><meta charset="UTF-8"><title>sandbox</title><body>'));const qe=document.createElement(Fe),De=(oe.contentWindow.document.body.appendChild(qe),qe.textContent=".",oe.contentWindow.getComputedStyle(qe)),Je={};return k.asArray(De).forEach(function(Ze){Je[Ze]=Ze==="width"||Ze==="height"?"auto":De.getPropertyValue(Ze)}),oe.contentWindow.document.body.removeChild(qe),Y[Fe]=Je}(F.tagName),j=F.style;k.asArray(V).forEach(function(Fe){var qe=V.getPropertyValue(Fe);(qe!==D[Fe]||Z&&qe!==Z.getPropertyValue(Fe))&&j.setProperty(Fe,qe,V.getPropertyPriority(Fe))})}(ce,le,de),O&&(["inset-block","inset-block-start","inset-block-end"].forEach(V=>de.style.removeProperty(V)),["left","right","top","bottom"].forEach(V=>{de.style.getPropertyValue(V)&&de.style.setProperty(V,"0px")})))})(_e,ee)}).then(function(){[":before",":after"].forEach(function(q){(function(de){const ce=$e(_e,de),V=ce.getPropertyValue("content");if(V!==""&&V!=="none"){const Z=k.uid(),F=ee.getAttribute("class"),D=(F&&ee.setAttribute("class",F+" "+Z),document.createElement("style"));D.appendChild(function(){const j=`.${Z}:`+de,Fe=(ce.cssText?function(){return`${ce.cssText} content: ${ce.getPropertyValue("content")};`}:function(){return k.asArray(ce).map(function(qe){return qe+": "+ce.getPropertyValue(qe)+(ce.getPropertyPriority(qe)?" !important":"")}).join("; ")+";"})();return document.createTextNode(j+`{${Fe}}`)}()),ee.appendChild(D)}})(q)})}).then(function(){_e instanceof HTMLTextAreaElement&&(ee.innerHTML=_e.value),_e instanceof HTMLInputElement&&ee.setAttribute("value",_e.value)}).then(function(){ee instanceof SVGElement&&(ee.setAttribute("xmlns","http://www.w3.org/2000/svg"),ee instanceof SVGRectElement&&["width","height"].forEach(function(q){const de=ee.getAttribute(q);de&&ee.style.setProperty(q,de)}))}).then(function(){return ee}):ee}(ue,fe,ie)}):Promise.resolve()}(J,N.filter,!0,!N.raster)}).then(He).then(ae).then(function(J){N.bgcolor&&(J.style.backgroundColor=N.bgcolor),N.width&&(J.style.width=N.width+"px"),N.height&&(J.style.height=N.height+"px"),N.style&&Object.keys(N.style).forEach(function(ue){J.style[ue]=N.style[ue]});let Ee=null;return typeof N.onclone=="function"&&(Ee=N.onclone(J)),Promise.resolve(Ee).then(function(){return J})}).then(function(J){return J=J,Ee=N.width||k.width(C),ue=N.height||k.height(C),Promise.resolve(J).then(function(ye){return ye.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),new XMLSerializer().serializeToString(ye)}).then(k.escapeXhtml).then(function(ye){return`<foreignObject x="0" y="0" width="100%" height="100%">${ye}</foreignObject>`}).then(function(ye){return`<svg xmlns="http://www.w3.org/2000/svg" width="${Ee}" height="${ue}">${ye}</svg>`}).then(function(ye){return"data:image/svg+xml;charset=utf-8,"+ye});var Ee,ue}).then(function(J){return Be.impl.urlCache=[],J})}function Te(C,N){return Pe(C,N).then(k.makeImage).then(k.delay(0)).then(function(K){var J=typeof N.scale!="number"?1:N.scale;const Ee=function(ye,O){const ie=document.createElement("canvas");if(ie.width=(N.width||k.width(ye))*O,ie.height=(N.height||k.height(ye))*O,N.bgcolor){const le=ie.getContext("2d");le.fillStyle=N.bgcolor,le.fillRect(0,0,ie.width,ie.height)}return ie}(C,J),ue=Ee.getContext("2d");return ue.mozImageSmoothingEnabled=!1,ue.msImageSmoothingEnabled=!1,ue.imageSmoothingEnabled=!1,K&&(ue.scale(J,J),ue.drawImage(K,0,0)),oe&&(document.body.removeChild(oe),oe=null,re&&clearTimeout(re),re=setTimeout(()=>{re=null,Y={}},2e4)),Ee})}function He(C){return H.resolveAll().then(function(N){const K=document.createElement("style");return C.appendChild(K),K.appendChild(document.createTextNode(N)),C})}function ae(C){return Q.inlineAll(C).then(function(){return C})}let re=null,oe=null,Y={}})(i)}),u=o(function(m,y){(function(){function x(H,I,Q){var se=new XMLHttpRequest;se.open("GET",H),se.responseType="blob",se.onload=function(){$(se.response,I,Q)},se.onerror=function(){console.error("could not download file")},se.send()}function k(H){var I=new XMLHttpRequest;I.open("HEAD",H,!1);try{I.send()}catch{}return 200<=I.status&&299>=I.status}function b(H){try{H.dispatchEvent(new MouseEvent("click"))}catch{var I=document.createEvent("MouseEvents");I.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),H.dispatchEvent(I)}}var T=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof i=="object"&&i.global===i?i:void 0,$=T.saveAs||(typeof window!="object"||window!==T?function(){}:"download"in HTMLAnchorElement.prototype?function(H,I,Q){var se=T.URL||T.webkitURL,we=document.createElement("a");I=I||H.name||"download",we.download=I,we.rel="noopener",typeof H=="string"?(we.href=H,we.origin===location.origin?b(we):k(we.href)?x(H,I,Q):b(we,we.target="_blank")):(we.href=se.createObjectURL(H),setTimeout(function(){se.revokeObjectURL(we.href)},4e4),setTimeout(function(){b(we)},0))}:"msSaveOrOpenBlob"in navigator?function(H,I,Q){if(I=I||H.name||"download",typeof H!="string")navigator.msSaveOrOpenBlob(function(we,Be){return Be===void 0?Be={autoBom:!1}:typeof Be!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),Be={autoBom:!Be}),Be.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(we.type)?new Blob(["\uFEFF",we],{type:we.type}):we}(H,Q),I);else if(k(H))x(H,I,Q);else{var se=document.createElement("a");se.href=H,se.target="_blank",setTimeout(function(){b(se)})}}:function(H,I,Q,se){if((se=se||open("","_blank"))&&(se.document.title=se.document.body.innerText="downloading..."),typeof H=="string")return x(H,I,Q);var we=H.type==="application/octet-stream",Be=/constructor/i.test(T.HTMLElement)||T.safari,$e=/CriOS\/[\d]+/.test(navigator.userAgent);if(($e||we&&Be)&&typeof FileReader=="object"){var Ue=new FileReader;Ue.onloadend=function(){var He=Ue.result;He=$e?He:He.replace(/^data:[^;]*;/,"data:attachment/file;"),se?se.location.href=He:location=He,se=null},Ue.readAsDataURL(H)}else{var Pe=T.URL||T.webkitURL,Te=Pe.createObjectURL(H);se?se.location=Te:location.href=Te,se=null,setTimeout(function(){Pe.revokeObjectURL(Te)},4e4)}});T.saveAs=$.saveAs=$,m.exports=$})()}),d=L.Control.extend({options:{cropImageByInnerWH:!0,hidden:!1,domtoimageOptions:{},position:"topleft",screenName:"screen",iconUrl:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/PjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0iQ2FwYV8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB4PSIwcHgiIHk9IjBweCIgdmlld0JveD0iMCAwIDMyIDMyIiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCAzMiAzMjsiIHhtbDpzcGFjZT0icHJlc2VydmUiPjxnPjxnIGlkPSJjYW1lcmEiPjxwYXRoIHN0eWxlPSJmaWxsOiMwMTAwMDI7IiBkPSJNMTYsOS41MDFjLTQuNDE5LDAtOCwzLjU4MS04LDhjMCw0LjQxOCwzLjU4MSw4LDgsOGM0LjQxOCwwLDgtMy41ODIsOC04UzIwLjQxOCw5LjUwMSwxNiw5LjUwMXogTTIwLjU1NSwyMS40MDZjLTIuMTU2LDIuNTE2LTUuOTQzLDIuODA3LTguNDU5LDAuNjVjLTIuNTE3LTIuMTU2LTIuODA3LTUuOTQ0LTAuNjUtOC40NTljMi4xNTUtMi41MTcsNS45NDMtMi44MDcsOC40NTktMC42NUMyMi40MiwxNS4xMDIsMjIuNzExLDE4Ljg5MSwyMC41NTUsMjEuNDA2eiIvPjxwYXRoIHN0eWxlPSJmaWxsOiMwMTAwMDI7IiBkPSJNMTYsMTMuNTAxYy0yLjIwOSwwLTMuOTk5LDEuNzkxLTQsMy45OTl2MC4wMDJjMCwwLjI3NSwwLjIyNCwwLjUsMC41LDAuNXMwLjUtMC4yMjUsMC41LTAuNVYxNy41YzAuMDAxLTEuNjU2LDEuMzQzLTIuOTk5LDMtMi45OTljMC4yNzYsMCwwLjUtMC4yMjQsMC41LTAuNVMxNi4yNzYsMTMuNTAxLDE2LDEzLjUwMXoiLz48cGF0aCBzdHlsZT0iZmlsbDojMDEwMDAyOyIgZD0iTTI5LjQ5Miw4LjU0MmwtNC4zMzQtMC43MjNsLTEuMzczLTMuNDM0QzIzLjMyNiwzLjI0LDIyLjIzMiwyLjUsMjEsMi41SDExYy0xLjIzMiwwLTIuMzI2LDAuNzQtMi43ODYsMS44ODZMNi44NDIsNy44MTlMMi41MDksOC41NDJDMS4wNTUsOC43ODMsMCwxMC4wMjcsMCwxMS41djE1YzAsMS42NTQsMS4zNDYsMywzLDNoMjZjMS42NTQsMCwzLTEuMzQ2LDMtM3YtMTVDMzIsMTAuMDI3LDMwLjk0NSw4Ljc4MywyOS40OTIsOC41NDJ6IE0zMCwyNi41YzAsMC41NTMtMC40NDcsMS0xLDFIM2MtMC41NTMsMC0xLTAuNDQ3LTEtMXYtMTVjMC0wLjQ4OSwwLjM1NC0wLjkwNiwwLjgzNi0wLjk4Nkw4LjI4LDkuNjA3bDEuNzkxLTQuNDc4QzEwLjIyNCw0Ljc1LDEwLjU5MSw0LjUsMTEsNC41aDEwYzAuNDA4LDAsMC43NzUsMC4yNDksMC45MjgsMC42MjlsMS43OTEsNC40NzhsNS40NDUsMC45MDdDMjkuNjQ2LDEwLjU5NCwzMCwxMS4wMTEsMzAsMTEuNVYyNi41eiIvPjwvZz48L2c+PGc+PC9nPjxnPjwvZz48Zz48L2c+PGc+PC9nPjxnPjwvZz48Zz48L2c+PGc+PC9nPjxnPjwvZz48Zz48L2c+PGc+PC9nPjxnPjwvZz48Zz48L2c+PGc+PC9nPjxnPjwvZz48Zz48L2c+PC9zdmc+",hideElementsWithSelectors:[".leaflet-control-container"],onCropBorderSize:2,caption:null,captionFontSize:15,captionFont:"Arial",captionColor:"black",captionBgColor:"white",captionOffset:5,mimeType:"image/png",debugMode:!1,preventDownload:!1,onPixelDataFail:function(m){var y=m.node,x=m.error;return console.warn("Map node is very big "+y.scrollWidth+"x"+y.scrollHeight),console.warn(`Add function: SimpleMapScreenshoter({
              onPixelDataFail: function({ node, plugin, error, mapPane, domtoimageOptions }) {
                 // Solutions:
                 // decrease size of map
                 // or decrease zoom level
                 // or remove elements with big distanses
                 // and after that return image in Promise - plugin._getPixelDataOfNormalMap
                 return plugin._getPixelDataOfNormalMap(domtoimageOptions)
              }
            })`),Promise.reject(x)}},onAdd:function(){return this._container=L.DomUtil.create("div","leaflet-control-simpleMapScreenshoter"),this._link=null,this._screenState={status:1,promise:null},this.options.hidden===!1&&this._addScreenBtn(),this._onUserStartInteractWithMap=this._onUserStartInteractWithMap.bind(this),this._onUserEndInteractWithMap=this._onUserEndInteractWithMap.bind(this),this._map.on("zoomstart",this._onUserStartInteractWithMap),this._map.on("move",this._onUserStartInteractWithMap),this._map.on("zoomend",this._onUserEndInteractWithMap),this._map.on("moveend",this._onUserEndInteractWithMap),this._container},takeScreen:function(){var m=this,y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"blob",x=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},k={};for(var b in this.options)x.hasOwnProperty(b)?k[b]=x[b]:k[b]=this.options[b];return this._screenState.status===2?this._screenState.promise:(this._map.fire("simpleMapScreenshoter.takeScreen"),this._screenState.status=2,this._setElementsVisible(!1),this._screenState.promise=this._waitEndOfInteractions().then(function(){return m._getPixelData(k)}).then(function(T){return m._setElementsVisible(!0),m._toCanvas(T,k)}).then(function(T){return y==="image"?m._canvasToImage(T,k):y==="canvas"?T:m._canvasToBlob(T,k)}).then(function(T){return m._screenState.status=1,m._map.fire("simpleMapScreenshoter.done"),T}).catch(function(T){return m._setElementsVisible(!0),m._screenState.status=1,m._map.fire("simpleMapScreenshoter.error",{e:T}),Promise.reject(T)}),this._screenState.promise)},_setElementsVisible:function(){var m=this,y=arguments.length>0&&arguments[0]!==void 0&&arguments[0];this.options.hideElementsWithSelectors.forEach(function(x){var k=m._map._container.querySelectorAll(x),b=!0,T=!1,$=void 0;try{for(var H,I=k[Symbol.iterator]();!(b=(H=I.next()).done);b=!0)H.value.style.opacity=y===!1?0:1}catch(Q){T=!0,$=Q}finally{try{!b&&I.return&&I.return()}finally{if(T)throw $}}})},_canvasToImage:function(m,y){var x=y.mimeType,k=m.toDataURL(x);return k.indexOf("base64")===-1?Promise.reject(new Error("Base64 image generation error")):Promise.resolve(k)},_canvasToBlob:function(m,y){var x=y.mimeType;return new Promise(function(k,b){m.toBlob(function(T){k(T)},x)})},_toCanvas:function(m,y){var x=y.captionOffset,k=y.caption,b=y.captionFontSize,T=y.captionFont,$=y.captionColor,H=y.captionBgColor,I=this._node,Q=I.screenHeight,se=I.screenWidth,we=document.createElement("canvas");we.width=se,we.height=Q;for(var Be=we.getContext("2d"),$e=Be.createImageData(se,Q),Ue=0;Ue<m.length;++Ue)$e.data[Ue]=m[Ue];Be.putImageData($e,0,0),$e=null;var Pe=document.createElement("canvas"),Te=Pe.getContext("2d"),He=0,ae=0,re=Q,oe=se;if(this.options.cropImageByInnerWH===!0){for(var Y=[],C=0,N=0;N<Q;++N){C=0;for(var K=0;K<se;++K)m[4*N*se+4*K+4]===0&&C++;C===se&&Y.push(N)}var J=this._getMinAndMaxOnValuesBreak(Y);He=J.min;for(var Ee=se,ue=J.max,ye=[],O=0,ie=ae;ie<Ee;++ie){O=0;for(var le=0;le<Q;++le)m[4*le*se+4*ie+4]===0&&O++;O===Q&&ye.push(ie)}var fe=this._getMinAndMaxOnValuesBreak(ye);ae=fe.min,Ee=fe.max,(ae===0&&Ee===0||Ee===null)&&(Ee=se),(He===0&&ue===0||ue===null)&&(ue=Q),this.options.debugMode===!0&&(console.log("emptyYLine",Y),console.log("minMaxY",J),console.log("emptyXLine",ye),console.log("minMaxX",fe),console.log("debugX",{}),console.log("debugY",{})),He===0&&ue===Q&&ae===0&&Ee===se||(He+=this.options.onCropBorderSize,ue-=this.options.onCropBorderSize,ae+=this.options.onCropBorderSize,Ee-=this.options.onCropBorderSize),re=ue-He,oe=Ee-ae,Pe.width=oe,Pe.height=re}else Pe.width=oe,Pe.height=re;var _e=null;return k&&(_e=typeof k=="function"?k.call(this):k),_e!==null&&(Pe.height=Pe.height+(x+b+x),Te.beginPath(),Te.rect(0,0,Pe.width,Pe.height),Te.fillStyle=H,Te.fill(),Te.save()),Te.drawImage(we,ae,He,oe,re,0,0,oe,re),_e!==null&&(Te.font=b+"px "+T,Te.fillStyle=$,Te.fillText(_e,x,re+x+b)),Promise.resolve(Pe)},_getMinAndMaxOnValuesBreak:function(m){for(var y=0,x=0,k=!1,b=1;b<m.length;b++){if(m[b]-1!==m[b-1]){x=m[b],k=!0;break}y=m[b]}return k===!1&&m[0]>1?(y=0,x=m[0]):k===!1&&(y=m[m.length-1]||0,x=null),{min:y,max:x}},_getPixelData:function(m){var y=this,x=m.domtoimageOptions,k=x===void 0?{}:x;return this._getPixelDataOfNormalMap(k).catch(function(b){return console.warn("May be map size very big on that zoom level, we have error:",b.toString()),console.warn("You can manually hide map elements with large distances between them for fix that warn"),y._getPixelDataOfBigMap(k)})},_getPixelDataOfNormalMap:function(){var m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},y=this._map.getContainer();return this._node={node:y,screenHeight:y.scrollHeight,screenWidth:y.scrollWidth},a.toPixelData(y,m)},_getPixelDataOfBigMap:function(){var m=this,y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},x=this._map.getContainer(),k=this._map.getPane("mapPane");k.style.width=2*x.clientWidth+"px",k.style.height=2*x.clientHeight+"px",k.style.overflow="hidden";var b=function(){k.style.width="initial",k.style.height="initial",k.style.overflow="initial"};return this._node={node:x,screenHeight:x.scrollHeight,screenWidth:x.scrollWidth},a.toPixelData(x,y).then(function(T){return b(),T}).catch(function(T){return b(),x.scrollHeight>=4e3||x.scrollWidth>=4e3?m.options.onPixelDataFail({plugin:m,node:x,mapPane:k,error:T,domtoimageOptions:y}):Promise.reject(T)})},_addScreenBtn:function(){this._link=L.DomUtil.create("a","leaflet-control-simpleMapScreenshoter-btn",this._container),this._addCss(),L.DomEvent.addListener(this._link,"click",this._onScreenBtn,this),L.DomEvent.disableClickPropagation(this._link)},_addCss:function(){var m=`
    .leaflet-control-simpleMapScreenshoter{
       border: 2px solid rgba(0,0,0,0.2);
       background-clip: padding-box;
    }
    .leaflet-control-simpleMapScreenshoter a{
       background-color: #fff;
       border-bottom: 1px solid #ccc;
       width: 30px;
       height: 30px;
       line-height: 30px;
       display: block;
       text-align: center;
       text-decoration: none;
       color: black;
       overflow: hidden;
       border-radius: 2px;
       background-image: url('`+this.options.iconUrl+`');
       background-position: 46% 41%;
       background-repeat: no-repeat;
       background-size: 63%;
    }
    .leaflet-control-simpleMapScreenshoter a:hover{
       cursor: pointer;
    }
    `,y=document.head||document.getElementsByTagName("head")[0],x=document.createElement("style");x.appendChild(document.createTextNode(m)),y.appendChild(x)},_onScreenBtn:function(){var m=this;this._map.fire("simpleMapScreenshoter.click"),this.options.preventDownload||this.takeScreen().then(function(y){var x=typeof m.options.screenName=="function"?m.options.screenName.call(m):m.options.screenName;u.saveAs(y,x+".png")}).catch(function(y){m._map.fire("simpleMapScreenshoter.error",{e:y})})},_onUserStartInteractWithMap:function(){this._interaction=!0},_onUserEndInteractWithMap:function(){this._interaction=!1},_waitEndOfInteractions:function(){var m=this;return new Promise(function(y){var x=setInterval(function(){m._interaction||(y(),clearInterval(x))},100)})}}),f=(L.Control.SimpleMapScreenshoter=d,L.simpleMapScreenshoter=function(m){return new L.Control.SimpleMapScreenshoter(m)},d);n.default=f,n.SimpleMapScreenshoter=d,Object.defineProperty(n,"__esModule",{value:!0})})})(Y0,Y0.exports);const Bw={class:"h-full flex flex-col bg-white overflow-y-auto"},Tw={class:"p-3 border-b border-gray-200"},Nw={class:"grid grid-cols-4 gap-1"},Dw=["onClick","title"],Rw=["innerHTML"],Ow={key:0,class:"flex-1 overflow-y-auto"},Iw={class:"p-3 border-b border-gray-200"},Fw={class:"p-3"},jw={class:"grid grid-cols-6 gap-2 mb-4"},zw=["onClick","title"],Uw={key:0,class:"space-y-4"},$w={class:"flex items-center gap-4"},qw={class:"flex items-center gap-2"},Vw={class:"flex items-center gap-4"},Gw=["value"],Hw={key:0,class:"flex items-center gap-4"},Ww={class:"flex items-center gap-2"},Zw={key:1,class:"space-y-4"},Kw={class:"flex items-center gap-4"},Yw={class:"flex items-center gap-2"},Jw={class:"flex items-center gap-4"},Xw={class:"flex items-center gap-2"},Qw={class:"flex items-center gap-4"},ex={class:"flex items-center gap-2"},tx={class:"flex items-center gap-4"},nx={class:"flex items-center gap-2"},ix={class:"flex items-center gap-4"},rx={class:"flex items-center gap-2"},sx=["onClick","title"],ox=["innerHTML"],ax={key:1,class:"p-3 border-t border-gray-200"},lx={class:"mt-3"},ux={key:0},cx={class:"grid grid-cols-1 gap-4"},hx={class:"text-sm font-medium text-gray-500"},dx={class:"text-sm font-medium text-gray-500"},fx={class:"text-sm font-medium text-gray-500"},px={class:"text-sm font-medium text-gray-500"},gx={class:"text-sm font-medium text-gray-500"},mx={class:"text-sm font-medium text-gray-500"},vx={class:"text-sm font-medium text-gray-500"},yx={class:"text-sm font-medium text-gray-500"},_x={class:"text-sm font-medium text-gray-500"},bx={class:"text-sm font-medium text-gray-500"},wx={class:"text-sm font-medium text-gray-500"},xx={class:"flex flex-col space-y-2 w-full"},Lx={class:"flex justify-between items-center"},Cx={class:"text-sm font-medium text-gray-500 ml-2"},Px={class:"flex justify-between items-center"},kx={class:"text-sm font-medium text-gray-500 ml-2"},Ex={class:"flex justify-between items-center"},Sx={class:"text-sm font-medium text-gray-500 ml-2"},Ax={class:"flex justify-between items-center"},Mx={class:"text-sm font-medium text-gray-500 ml-2"},Bx={class:"flex justify-between items-center"},Tx={class:"text-sm font-medium text-gray-500 ml-2"},Nx={key:1,class:"text-center text-sm text-gray-500"},Dx={key:2,class:"p-3 border-t border-gray-200"},Rx={class:"mt-3"},Ox={class:"mb-4"},Ix={class:"grid grid-cols-2 gap-2"},Fx={class:"grid grid-cols-2 gap-2"},jx=Hs({__name:"DrawingTools",props:{currentTool:{},selectedShape:{}},emits:["tool-change","style-update","delete-shape"],setup(e,{emit:t}){const n=e,i=t,o=Nt(null),a=Nt("Double-cliquez pour éditer"),u=Nt("#3B82F6"),d=Nt(.2),f=Nt("#2563EB"),m=Nt(2),y=Nt("solid"),x=Nt("#000000"),k=Nt("Arial, sans-serif"),b=Nt("center"),T=Nt(!1),$=Nt(!1),H=Nt({style:!1,properties:!1,samplePoints:!0,elevationProfile:!1}),I=Nt({radius:4,color:"#FF4500",fillColor:"#FF4500",fillOpacity:.6,weight:2,opacity:.8}),Q=Nt({radius:6,weight:3,opacity:1,fillOpacity:1}),se=Un(()=>{var F,D;return!((F=n.selectedShape)!=null&&F.properties)||n.selectedShape.properties.type!=="TextRectangle"?"center":((D=n.selectedShape.properties.style)==null?void 0:D.textAlign)||"center"});Ki(()=>n.selectedShape,F=>{var D,j,Fe,qe,De,Je,Ze,yt,wt,Pt,Rt,qt;if(!F){o.value=null,b.value="center",T.value=!1,$.value=!1,a.value="Double-cliquez pour éditer",u.value="#3B82F6",d.value=.2,f.value="#2563EB",m.value=2,y.value="solid",x.value="#000000",k.value="Arial, sans-serif";return}if(console.log("[DrawingTools] Changement de forme sélectionnée",{newShape:F,properties:F==null?void 0:F.properties,type:(D=F==null?void 0:F.properties)==null?void 0:D.type,elevationData:(j=F==null?void 0:F.properties)==null?void 0:j.elevationData,length:(Fe=F==null?void 0:F.properties)==null?void 0:Fe.length,minElevation:(qe=F==null?void 0:F.properties)==null?void 0:qe.minElevation,maxElevation:(De=F==null?void 0:F.properties)==null?void 0:De.maxElevation,elevationGain:(Je=F==null?void 0:F.properties)==null?void 0:Je.elevationGain,elevationLoss:(Ze=F==null?void 0:F.properties)==null?void 0:Ze.elevationLoss,averageSlope:(yt=F==null?void 0:F.properties)==null?void 0:yt.averageSlope,maxSlope:(wt=F==null?void 0:F.properties)==null?void 0:wt.maxSlope}),F){o.value={...F.properties},o.value&&console.log("[DrawingTools] localProperties mis à jour",{type:o.value.type,elevationData:o.value.elevationData,length:o.value.length,minElevation:o.value.minElevation,maxElevation:o.value.maxElevation,elevationGain:o.value.elevationGain,elevationLoss:o.value.elevationLoss,averageSlope:o.value.averageSlope,maxSlope:o.value.maxSlope});const lt=((Pt=F.properties)==null?void 0:Pt.style)||{};if(u.value=lt.fillColor||"#3B82F6",d.value=lt.fillOpacity!==void 0?lt.fillOpacity:.2,f.value=lt.color||"#2563EB",m.value=lt.weight||2,y.value=lt.dashArray?"dashed":"solid",((Rt=F.properties)==null?void 0:Rt.type)==="TextRectangle"){const Oe=lt.textStyle||{};x.value=Oe.color||"#000000",k.value=Oe.fontFamily||"Arial, sans-serif",b.value=Oe.textAlign||"center",T.value=Oe.bold||!1,$.value=Oe.italic||!1,a.value=F.properties.text||"Double-cliquez pour éditer",console.log("[DrawingTools] Initialisation du TextRectangle",{text:a.value,style:lt})}((qt=F.properties)==null?void 0:qt.type)==="ElevationLine"&&(I.value={...F.properties.samplePointStyle},Q.value={...F.properties.minMaxPointStyle})}else o.value=null},{immediate:!0,deep:!0}),Ki(()=>{var F,D;return(D=(F=n.selectedShape)==null?void 0:F.properties)==null?void 0:D.text},F=>{var D,j;((j=(D=n.selectedShape)==null?void 0:D.properties)==null?void 0:j.type)==="TextRectangle"&&(console.log("[DrawingTools] Mise à jour du texte :",F),a.value=F||"Double-cliquez pour éditer")},{immediate:!0}),Ki(()=>{var F,D;return(D=(F=n.selectedShape)==null?void 0:F.properties)==null?void 0:D.style},F=>{var D;(D=n.selectedShape)!=null&&D.properties&&n.selectedShape.properties.type==="TextRectangle"&&F&&(x.value=F.textColor||"#000000",k.value=F.fontFamily||"Arial, sans-serif",T.value=F.bold||!1,$.value=F.italic||!1)},{deep:!0});const we=(F,D)=>{let j=null;return(...Fe)=>{j!==null&&clearTimeout(j),j=window.setTimeout(()=>{F(...Fe),j=null},D)}},Be=(F,D)=>{if(F===D)return!0;if(F===null||D===null)return!1;if(typeof F!="object"||typeof D!="object")return F===D;const j=Object.keys(F),Fe=Object.keys(D);if(j.length!==Fe.length)return!1;for(const qe of j)if(!Fe.includes(qe)||!Be(F[qe],D[qe]))return!1;return!0},$e=we((F,D)=>{console.log("[DrawingTools] Changement détecté dans localProperties",{newProperties:F,oldProperties:D,selectedShape:n.selectedShape})},300);Ki(()=>o.value,(F,D)=>{F&&D&&!Be(F,D)&&$e(F,D)},{deep:!0});const Ue=F=>({Circle:'<svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10" /></svg>',Semicircle:'<svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M2 12a10 10 0 0 1 20 0" /></svg>',Rectangle:'<svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2" ry="2" /></svg>',Polygon:'<svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 3l9 7-3 9H6l-3-9 9-7z" /></svg>',delete:'<svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="3 6 5 6 21 6" /><path d="M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2" /><line x1="10" y1="11" x2="10" y2="17" /><line x1="14" y1="11" x2="14" y2="17" /></svg>',Line:'<svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 19l18-14" /></svg>',TextRectangle:'<svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" /><path d="M9 8h6m-3 0v8" /></svg>',ElevationLine:'<svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 12h3l3-9 6 18 3-9h3" /></svg>'})[F]||"",Pe=[{type:"Circle",label:"Cercle"},{type:"Semicircle",label:"Demi-cercle"},{type:"Rectangle",label:"Rectangle"},{type:"Polygon",label:"Polygone"},{type:"Line",label:"Ligne"},{type:"ElevationLine",label:"Profil altimétrique"},{type:"TextRectangle",label:"Texte"},{type:"delete",label:"Supprimer"}],Te=["#2563EB","#DC2626","#059669","#D97706","#7C3AED","#DB2777"],He=[{value:"solid",label:"Continu"},{value:"dashed",label:"Tirets"},{value:"dotted",label:"Pointillé"},{value:"dashdot",label:"Tiret-point"}],ae=[{value:"left",label:"Aligné à gauche",icon:"&#8678;"},{value:"center",label:"Centré",icon:"&#8645;"},{value:"right",label:"Aligné à droite",icon:"&#8680;"}],re=Un(()=>{var D,j;const F=(j=(D=n.selectedShape)==null?void 0:D.properties)==null?void 0:j.type;return console.log("[DrawingTools] Calcul de showFillOptions",{shapeType:F,selectedShape:n.selectedShape}),F?["Circle","Rectangle","Polygon","Semicircle"].includes(F)&&F!=="ElevationLine":!1}),oe=F=>{H.value[F]=!H.value[F]},Y=F=>{switch(F){case"dashed":return"10,10";case"dotted":return"2,5";case"dashdot":return"10,5,2,5";default:return""}},C=F=>{var D,j;f.value=F,(re.value||((D=o.value)==null?void 0:D.type)==="TextRectangle")&&(u.value=F),N({strokeColor:F,fillColor:re.value||((j=o.value)==null?void 0:j.type)==="TextRectangle"?F:void 0})},N=F=>{const D={...F};F.strokeStyle&&(D.dashArray=Y(F.strokeStyle)),F.fillOpacity!==void 0&&(D.fillOpacity=parseFloat(F.fillOpacity)),F.strokeOpacity!==void 0&&(D.strokeOpacity=parseFloat(F.strokeOpacity)),F.strokeWidth!==void 0&&(D.weight=parseInt(F.strokeWidth)),F.strokeColor&&(D.color=F.strokeColor),i("style-update",D)},K=F=>{var j,Fe,qe,De,Je,Ze,yt;if(((Fe=(j=n.selectedShape)==null?void 0:j.properties)==null?void 0:Fe.type)!=="TextRectangle")return;const D={textColor:(qe=n.selectedShape.properties.style)==null?void 0:qe.textColor,fontFamily:(De=n.selectedShape.properties.style)==null?void 0:De.fontFamily,textAlign:(Je=n.selectedShape.properties.style)==null?void 0:Je.textAlign,bold:(Ze=n.selectedShape.properties.style)==null?void 0:Ze.bold,italic:(yt=n.selectedShape.properties.style)==null?void 0:yt.italic,...F};i("style-update",D)},J=()=>{T.value=!T.value,K({bold:T.value})},Ee=()=>{$.value=!$.value,K({italic:$.value})},ue=F=>F?F>=1e3?`${(F/1e3).toFixed(2)} km`:`${F.toFixed(2)} m`:"0 m",ye=F=>F?`${(F/1e4).toFixed(2)} ha`:"0 ha",O=F=>F?`${((F%360+360)%360).toFixed(1)}°`:"0°",ie=()=>{var F,D;if(((D=(F=n.selectedShape)==null?void 0:F.properties)==null?void 0:D.type)==="ElevationLine"){const j={...I.value,fillColor:I.value.color};n.selectedShape.layer.setSamplePointStyle(j)}},le=()=>{var F,D;((D=(F=n.selectedShape)==null?void 0:F.properties)==null?void 0:D.type)==="ElevationLine"&&n.selectedShape.layer.setMinMaxPointStyle(Q.value)},fe=Nt(null),_e=Nt(null),ee=F=>`${F.toFixed(1)}%`,G=()=>{var pn,Gt,nn,$n;if(!fe.value||!((Gt=(pn=n.selectedShape)==null?void 0:pn.properties)!=null&&Gt.elevationData)){console.log("[DrawingTools] Impossible de dessiner le profil : canvas ou données manquantes",{canvas:!!fe.value,data:!!(($n=(nn=n.selectedShape)==null?void 0:nn.properties)!=null&&$n.elevationData)});return}console.log("[DrawingTools] Dessin du profil avec les données:",{data:n.selectedShape.properties.elevationData,minElevation:n.selectedShape.properties.minElevation,maxElevation:n.selectedShape.properties.maxElevation});const F=fe.value.getContext("2d");if(!F)return;_e.value=F;const D=fe.value,j=n.selectedShape.properties.elevationData,Fe=window.devicePixelRatio||1,qe=D.getBoundingClientRect();D.width=qe.width*Fe,D.height=qe.height*Fe,D.style.width=`${qe.width}px`,D.style.height=`${qe.height}px`,F.scale(Fe,Fe),F.clearRect(0,0,qe.width,qe.height);const De=30,Je=qe.width-2*De,Ze=qe.height-2*De,yt=n.selectedShape.properties.minElevation,wt=n.selectedShape.properties.maxElevation,Rt=(wt-yt)*.05,qt=yt-Rt,lt=wt+Rt,Oe=an=>De+an/j[j.length-1].distance*Je,kt=an=>De+Ze-(an-qt)/(lt-qt)*Ze;F.fillStyle="#f8fafc",F.fillRect(De,De,Je,Ze),F.strokeStyle="#e2e8f0",F.lineWidth=1,F.beginPath(),F.moveTo(De,De),F.lineTo(De,Ze+De),F.lineTo(Je+De,Ze+De),F.strokeStyle="#94a3b8",F.stroke();const Et=5;for(let an=0;an<=Et;an++){const Dn=qt+an/Et*(lt-qt),Pn=kt(Dn);F.beginPath(),F.strokeStyle="#e2e8f0",F.moveTo(De,Pn),F.lineTo(Je+De,Pn),F.stroke(),F.beginPath(),F.strokeStyle="#94a3b8",F.moveTo(De-5,Pn),F.lineTo(De,Pn),F.stroke(),F.fillStyle="#64748b",F.font="10px sans-serif",F.textAlign="right",F.fillText(`${Math.round(Dn)}m`,De-8,Pn+4)}const St=5,nt=j[j.length-1].distance;for(let an=0;an<=St;an++){const Dn=an/St*nt,Pn=Oe(Dn);F.beginPath(),F.strokeStyle="#e2e8f0",F.moveTo(Pn,De),F.lineTo(Pn,Ze+De),F.stroke(),F.beginPath(),F.strokeStyle="#94a3b8",F.moveTo(Pn,Ze+De),F.lineTo(Pn,Ze+De+5),F.stroke(),F.fillStyle="#64748b",F.font="10px sans-serif",F.textAlign="center",F.fillText(`${Math.round(Dn)}m`,Pn,Ze+De+16)}const st=F.createLinearGradient(0,De,0,Ze+De);st.addColorStop(0,"rgba(255, 69, 0, 0.8)"),st.addColorStop(1,"rgba(255, 69, 0, 0.2)"),F.beginPath(),F.moveTo(Oe(j[0].distance),kt(j[0].elevation)),j.forEach((an,Dn)=>{Dn>0&&F.lineTo(Oe(an.distance),kt(an.elevation))}),F.strokeStyle="#FF4500",F.lineWidth=2,F.stroke(),F.lineTo(Oe(j[j.length-1].distance),kt(qt)),F.lineTo(Oe(j[0].distance),kt(qt)),F.closePath(),F.fillStyle=st,F.fill(),j.forEach(an=>{F.beginPath(),F.arc(Oe(an.distance),kt(an.elevation),3,0,Math.PI*2),F.fillStyle="#FF4500",F.fill(),F.strokeStyle="white",F.lineWidth=1,F.stroke()}),console.log("[DrawingTools] Profil dessiné avec succès")},q=F=>{var yt,wt;if(!fe.value||!((wt=(yt=n.selectedShape)==null?void 0:yt.properties)!=null&&wt.elevationData))return;const D=fe.value.getBoundingClientRect(),j=F.clientX-D.left,Fe=n.selectedShape.properties.elevationData,qe=30,De=D.width-2*qe,Je=Math.max(0,Math.min((j-qe)/De*Fe[Fe.length-1].distance,Fe[Fe.length-1].distance)),Ze=Fe.reduce((Pt,Rt)=>Math.abs(Rt.distance-Je)<Math.abs(Pt.distance-Je)?Rt:Pt);if(n.selectedShape&&n.selectedShape.layer&&typeof n.selectedShape.layer.showElevationAt=="function"&&n.selectedShape.layer.showElevationAt(Ze.distance),G(),_e.value){const Pt=_e.value,Rt=fe.value.getBoundingClientRect(),qt=Rt.width-2*qe,lt=Rt.height-2*qe,Oe=n.selectedShape.properties.minElevation,kt=n.selectedShape.properties.maxElevation,Et=(kt-Oe)*.05,St=Oe-Et,nt=kt+Et,st=Gt=>qe+Gt/Fe[Fe.length-1].distance*qt,pn=Gt=>qe+lt-(Gt-St)/(nt-St)*lt;Pt.beginPath(),Pt.setLineDash([5,5]),Pt.strokeStyle="rgba(0, 0, 0, 0.3)",Pt.lineWidth=1,Pt.moveTo(st(Ze.distance),qe),Pt.lineTo(st(Ze.distance),lt+qe),Pt.stroke(),Pt.setLineDash([]),Pt.beginPath(),Pt.arc(st(Ze.distance),pn(Ze.elevation),6,0,Math.PI*2),Pt.fillStyle="#FF4500",Pt.fill(),Pt.strokeStyle="white",Pt.lineWidth=2,Pt.stroke()}},de=()=>{G(),n.selectedShape&&n.selectedShape.layer&&typeof n.selectedShape.layer.hideElevationMarker=="function"&&n.selectedShape.layer.hideElevationMarker()},ce=new ResizeObserver(()=>{G()});ra(()=>{fe.value&&ce.observe(fe.value),window.addEventListener("resize",Z)}),Fc(()=>{fe.value&&ce.unobserve(fe.value),window.removeEventListener("resize",Z)}),Ki(()=>{var F,D;return(D=(F=n.selectedShape)==null?void 0:F.properties)==null?void 0:D.elevationData},()=>{bi(()=>{if(fe.value&&V.value){const F=V.value.getBoundingClientRect();fe.value.style.width=`${F.width}px`,fe.value.style.height=`${F.height}px`,G()}})},{deep:!0});const V=Nt(null),Z=we(()=>{if(fe.value&&V.value){const F=V.value.getBoundingClientRect();fe.value.style.width=`${F.width}px`,fe.value.style.height=`${F.height}px`,G()}},250);return(F,D)=>(je(),ze("div",Bw,[D[74]||(D[74]=A("div",{class:"p-3 bg-gray-50 border-b border-gray-200"},[A("h3",{class:"text-sm font-semibold text-gray-700"},"Outils de dessin")],-1)),A("div",Tw,[A("div",Nw,[(je(!0),ze(Qt,null,Mn(Pe.filter(j=>j.type!=="delete"),j=>(je(),ze("button",{key:j.type,class:zi(["flex items-center justify-center p-2 rounded border",{"bg-blue-50 border-blue-200 text-blue-700":F.currentTool===j.type}]),onClick:Fe=>F.$emit("tool-change",j.type),title:j.label},[A("span",{class:"icon",innerHTML:Ue(j.type)},null,8,Rw)],10,Dw))),128))]),F.selectedShape?(je(),ze("button",{key:0,class:zi(["w-full mt-2 p-2 rounded border border-red-200 bg-red-50 text-red-600 hover:bg-red-100",{"bg-red-100":F.currentTool==="delete"}]),onClick:D[0]||(D[0]=j=>F.$emit("delete-shape")),title:"Supprimer la forme"},D[33]||(D[33]=[A("svg",{class:"w-4 h-4 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)]),2)):Zt("",!0)]),F.selectedShape&&o.value?(je(),ze("div",Ow,[A("div",Iw,[A("button",{class:"flex items-center justify-between w-full text-sm font-semibold text-gray-700",onClick:D[1]||(D[1]=j=>oe("style"))},[D[35]||(D[35]=A("span",null,"Style",-1)),(je(),ze("svg",{class:zi(["w-4 h-4",{"rotate-180":!H.value.style}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},D[34]||(D[34]=[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)]),2))])]),cn(A("div",Fw,[A("div",jw,[(je(),ze(Qt,null,Mn(Te,j=>A("button",{key:j,class:"w-8 h-8 rounded-full",style:Oc({backgroundColor:j}),onClick:Fe=>C(j),title:j},null,12,zw)),64))]),o.value.type!=="TextRectangle"?(je(),ze("div",Uw,[A("div",$w,[D[36]||(D[36]=A("span",{class:"w-20 text-sm font-semibold text-gray-700"},"Contour",-1)),A("div",qw,[cn(A("input",{type:"color","onUpdate:modelValue":D[2]||(D[2]=j=>f.value=j),class:"w-16 h-8 rounded border",onChange:D[3]||(D[3]=j=>N({strokeColor:f.value})),title:"Couleur du contour"},null,544),[[Kn,f.value]]),cn(A("input",{type:"range","onUpdate:modelValue":D[4]||(D[4]=j=>m.value=j),min:"1",max:"10",class:"w-16 h-2 rounded-md",onChange:D[5]||(D[5]=j=>N({strokeWidth:m.value})),title:"Épaisseur du contour"},null,544),[[Kn,m.value]])])]),A("div",Vw,[D[37]||(D[37]=A("span",{class:"w-20 text-sm font-semibold text-gray-700"},"Style",-1)),cn(A("select",{"onUpdate:modelValue":D[6]||(D[6]=j=>y.value=j),class:"w-full rounded border",onChange:D[7]||(D[7]=j=>N({strokeStyle:y.value}))},[(je(),ze(Qt,null,Mn(He,j=>A("option",{key:j.value,value:j.value},Tt(j.label),9,Gw)),64))],544),[[vr,y.value]])]),re.value?(je(),ze("div",Hw,[D[38]||(D[38]=A("span",{class:"w-20 text-sm font-semibold text-gray-700"},"Remplir",-1)),A("div",Ww,[cn(A("input",{type:"color","onUpdate:modelValue":D[8]||(D[8]=j=>u.value=j),class:"w-16 h-8 rounded border",onChange:D[9]||(D[9]=j=>N({fillColor:u.value})),title:"Couleur de remplissage"},null,544),[[Kn,u.value]]),cn(A("input",{type:"range","onUpdate:modelValue":D[10]||(D[10]=j=>d.value=j),min:"0",max:"1",step:"0.1",class:"w-16 h-2 rounded-md",onChange:D[11]||(D[11]=j=>N({fillOpacity:d.value})),title:"Opacité du remplissage"},null,544),[[Kn,d.value]])])])):Zt("",!0)])):Zt("",!0),o.value.type==="TextRectangle"?(je(),ze("div",Zw,[A("div",Kw,[D[39]||(D[39]=A("span",{class:"w-20 text-sm font-semibold text-gray-700"},"Contour",-1)),A("div",Yw,[cn(A("input",{type:"color","onUpdate:modelValue":D[12]||(D[12]=j=>f.value=j),class:"w-16 h-8 rounded border",onChange:D[13]||(D[13]=j=>N({strokeColor:f.value})),title:"Couleur du contour"},null,544),[[Kn,f.value]]),cn(A("input",{type:"range","onUpdate:modelValue":D[14]||(D[14]=j=>m.value=j),min:"1",max:"10",class:"w-16 h-2 rounded-md",onChange:D[15]||(D[15]=j=>N({strokeWidth:m.value})),title:"Épaisseur du contour"},null,544),[[Kn,m.value]])])]),A("div",Jw,[D[40]||(D[40]=A("span",{class:"w-20 text-sm font-semibold text-gray-700"},"Remplir",-1)),A("div",Xw,[cn(A("input",{type:"color","onUpdate:modelValue":D[16]||(D[16]=j=>u.value=j),class:"w-16 h-8 rounded border",onChange:D[17]||(D[17]=j=>N({fillColor:u.value})),title:"Couleur de remplissage"},null,544),[[Kn,u.value]]),cn(A("input",{type:"range","onUpdate:modelValue":D[18]||(D[18]=j=>d.value=j),min:"0",max:"1",step:"0.1",class:"w-16 h-2 rounded-md",onChange:D[19]||(D[19]=j=>N({fillOpacity:d.value})),title:"Opacité du remplissage"},null,544),[[Kn,d.value]])])]),A("div",Qw,[D[41]||(D[41]=A("span",{class:"w-20 text-sm font-semibold text-gray-700"},"Texte",-1)),A("div",ex,[cn(A("input",{type:"color","onUpdate:modelValue":D[20]||(D[20]=j=>x.value=j),class:"w-16 h-8 rounded border",onChange:D[21]||(D[21]=j=>K({textColor:x.value})),title:"Couleur du texte"},null,544),[[Kn,x.value]])])]),A("div",tx,[D[43]||(D[43]=A("span",{class:"w-20 text-sm font-semibold text-gray-700"},"Police",-1)),A("div",nx,[cn(A("select",{"onUpdate:modelValue":D[22]||(D[22]=j=>k.value=j),class:"w-full rounded border",onChange:D[23]||(D[23]=j=>K({fontFamily:k.value}))},D[42]||(D[42]=[gc('<option value="Arial, sans-serif" data-v-0ad4c8d2>Arial</option><option value="&#39;Times New Roman&#39;, serif" data-v-0ad4c8d2>Times</option><option value="&#39;Courier New&#39;, monospace" data-v-0ad4c8d2>Courier</option><option value="Georgia, serif" data-v-0ad4c8d2>Georgia</option><option value="Verdana, sans-serif" data-v-0ad4c8d2>Verdana</option>',5)]),544),[[vr,k.value]])])]),A("div",ix,[D[44]||(D[44]=A("span",{class:"w-20 text-sm font-semibold text-gray-700"},"Align.",-1)),A("div",rx,[(je(),ze(Qt,null,Mn(ae,j=>A("button",{key:j.value,class:zi(["flex items-center justify-center p-2 rounded border",{"bg-blue-50 border-blue-200 text-blue-700":se.value===j.value}]),onClick:Fe=>K({textAlign:j.value}),title:j.label},[A("span",{innerHTML:j.icon},null,8,ox)],10,sx)),64)),A("button",{class:zi(["flex items-center justify-center p-2 rounded border",{"bg-blue-50 border-blue-200 text-blue-700":T.value}]),onClick:J,title:"Gras"}," B ",2),A("button",{class:zi(["flex items-center justify-center p-2 rounded border",{"bg-blue-50 border-blue-200 text-blue-700":$.value}]),onClick:Ee,title:"Italique"}," I ",2)])])])):Zt("",!0)],512),[[fh,!H.value.style]])])):Zt("",!0),F.selectedShape&&o.value&&o.value.type!=="TextRectangle"?(je(),ze("div",ax,[A("button",{class:"flex items-center justify-between w-full text-sm font-semibold text-gray-700",onClick:D[24]||(D[24]=j=>oe("properties"))},[D[46]||(D[46]=A("span",null,"Propriétés",-1)),(je(),ze("svg",{class:zi(["w-4 h-4",{"rotate-180":!H.value.properties}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},D[45]||(D[45]=[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)]),2))]),cn(A("div",lx,[o.value?(je(),ze("div",ux,[A("div",cx,[o.value.type==="Circle"?(je(),ze(Qt,{key:0},[D[47]||(D[47]=A("span",{class:"text-sm font-semibold text-gray-700"},"Rayon :",-1)),A("span",hx,Tt(ue(o.value.radius||0)),1),D[48]||(D[48]=A("span",{class:"text-sm font-semibold text-gray-700"},"Surface :",-1)),A("span",dx,Tt(ye(o.value.area||0)),1)],64)):o.value.type==="Rectangle"?(je(),ze(Qt,{key:1},[D[49]||(D[49]=A("span",{class:"text-sm font-semibold text-gray-700"},"Largeur :",-1)),A("span",fx,Tt(ue(o.value.width||0)),1),D[50]||(D[50]=A("span",{class:"text-sm font-semibold text-gray-700"},"Hauteur :",-1)),A("span",px,Tt(ue(o.value.height||0)),1),D[51]||(D[51]=A("span",{class:"text-sm font-semibold text-gray-700"},"Surface :",-1)),A("span",gx,Tt(ye(o.value.area||0)),1)],64)):o.value.type==="Semicircle"?(je(),ze(Qt,{key:2},[D[52]||(D[52]=A("span",{class:"text-sm font-semibold text-gray-700"},"Rayon :",-1)),A("span",mx,Tt(ue(o.value.radius||0)),1),D[53]||(D[53]=A("span",{class:"text-sm font-semibold text-gray-700"},"Surface :",-1)),A("span",vx,Tt(ye(o.value.area||0)),1),D[54]||(D[54]=A("span",{class:"text-sm font-semibold text-gray-700"},"Angle :",-1)),A("span",yx,Tt(O(o.value.openingAngle||0)),1)],64)):o.value.type==="Line"?(je(),ze(Qt,{key:3},[D[55]||(D[55]=A("span",{class:"text-sm font-semibold text-gray-700"},"Longueur :",-1)),A("span",_x,Tt(ue(o.value.length||0)),1)],64)):o.value.type==="Polygon"?(je(),ze(Qt,{key:4},[D[56]||(D[56]=A("span",{class:"text-sm font-semibold text-gray-700"},"Surface :",-1)),A("span",bx,Tt(ye(o.value.area||0)),1),D[57]||(D[57]=A("span",{class:"text-sm font-semibold text-gray-700"},"Périmètre :",-1)),A("span",wx,Tt(ue(o.value.perimeter||0)),1)],64)):o.value.type==="ElevationLine"?(je(),ze(Qt,{key:5},[A("div",xx,[A("div",Lx,[D[58]||(D[58]=A("span",{class:"text-sm font-semibold text-gray-700 whitespace-nowrap"},"Distance totale :",-1)),A("span",Cx,Tt(ue(o.value.length||0)),1)]),A("div",Px,[D[59]||(D[59]=A("span",{class:"text-sm font-semibold text-gray-700 whitespace-nowrap"},"Dénivelé + :",-1)),A("span",kx,Tt(ue(o.value.elevationGain||0)),1)]),A("div",Ex,[D[60]||(D[60]=A("span",{class:"text-sm font-semibold text-gray-700 whitespace-nowrap"},"Dénivelé - :",-1)),A("span",Sx,Tt(ue(o.value.elevationLoss||0)),1)]),A("div",Ax,[D[61]||(D[61]=A("span",{class:"text-sm font-semibold text-gray-700 whitespace-nowrap"},"Pente moy. :",-1)),A("span",Mx,Tt(ee(o.value.averageSlope||0)),1)]),A("div",Bx,[D[62]||(D[62]=A("span",{class:"text-sm font-semibold text-gray-700 whitespace-nowrap"},"Pente max :",-1)),A("span",Tx,Tt(ee(o.value.maxSlope||0)),1)])]),A("div",{ref_key:"elevationProfileContainer",ref:V,class:"elevation-profile-container w-full h-48 bg-gray-50 rounded border border-gray-200 relative mt-4",onMousemove:q,onMouseleave:de},[A("canvas",{ref_key:"elevationCanvas",ref:fe},null,512)],544)],64)):Zt("",!0)])])):(je(),ze("div",Nx," Aucune propriété disponible "))],512),[[fh,!H.value.properties]])])):Zt("",!0),F.selectedShape&&o.value&&o.value.type==="ElevationLine"?(je(),ze("div",Dx,[A("button",{class:"flex items-center justify-between w-full text-sm font-semibold text-gray-700",onClick:D[25]||(D[25]=j=>oe("samplePoints"))},[D[64]||(D[64]=A("span",null,"Points d'échantillonnage",-1)),(je(),ze("svg",{class:zi(["w-4 h-4",{"rotate-180":!H.value.samplePoints}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},D[63]||(D[63]=[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)]),2))]),cn(A("div",Rx,[A("div",Ox,[D[69]||(D[69]=A("h4",{class:"text-sm font-semibold mb-2"},"Points normaux",-1)),A("div",Ix,[A("div",null,[D[65]||(D[65]=A("label",{class:"text-xs text-gray-600"},"Taille",-1)),cn(A("input",{type:"number","onUpdate:modelValue":D[26]||(D[26]=j=>I.value.radius=j),min:"2",max:"10",step:"1",class:"w-full px-2 py-1 border rounded",onChange:ie},null,544),[[Kn,I.value.radius]])]),A("div",null,[D[66]||(D[66]=A("label",{class:"text-xs text-gray-600"},"Couleur",-1)),cn(A("input",{type:"color","onUpdate:modelValue":D[27]||(D[27]=j=>I.value.color=j),class:"w-full h-8 px-1 border rounded",onChange:ie},null,544),[[Kn,I.value.color]])]),A("div",null,[D[67]||(D[67]=A("label",{class:"text-xs text-gray-600"},"Opacité",-1)),cn(A("input",{type:"range","onUpdate:modelValue":D[28]||(D[28]=j=>I.value.fillOpacity=j),min:"0",max:"1",step:"0.1",class:"w-full",onChange:ie},null,544),[[Kn,I.value.fillOpacity]])]),A("div",null,[D[68]||(D[68]=A("label",{class:"text-xs text-gray-600"},"Bordure",-1)),cn(A("input",{type:"number","onUpdate:modelValue":D[29]||(D[29]=j=>I.value.weight=j),min:"1",max:"5",step:"1",class:"w-full px-2 py-1 border rounded",onChange:ie},null,544),[[Kn,I.value.weight]])])])]),A("div",null,[D[73]||(D[73]=A("h4",{class:"text-sm font-semibold mb-2"},"Points min/max",-1)),A("div",Fx,[A("div",null,[D[70]||(D[70]=A("label",{class:"text-xs text-gray-600"},"Taille",-1)),cn(A("input",{type:"number","onUpdate:modelValue":D[30]||(D[30]=j=>Q.value.radius=j),min:"4",max:"12",step:"1",class:"w-full px-2 py-1 border rounded",onChange:le},null,544),[[Kn,Q.value.radius]])]),A("div",null,[D[71]||(D[71]=A("label",{class:"text-xs text-gray-600"},"Bordure",-1)),cn(A("input",{type:"number","onUpdate:modelValue":D[31]||(D[31]=j=>Q.value.weight=j),min:"1",max:"5",step:"1",class:"w-full px-2 py-1 border rounded",onChange:le},null,544),[[Kn,Q.value.weight]])]),A("div",null,[D[72]||(D[72]=A("label",{class:"text-xs text-gray-600"},"Opacité",-1)),cn(A("input",{type:"range","onUpdate:modelValue":D[32]||(D[32]=j=>Q.value.fillOpacity=j),min:"0",max:"1",step:"0.1",class:"w-full",onChange:le},null,544),[[Kn,Q.value.fillOpacity]])])])])],512),[[fh,!H.value.samplePoints]])])):Zt("",!0)]))}}),D1=(e,t)=>{const n=e.__vccOpts||e;for(const[i,o]of t)n[i]=o;return n},zx=D1(jx,[["__scopeId","data-v-0ad4c8d2"]]),Ux={class:"map-toolbar w-full"},$x={class:"hidden md:flex items-center space-x-2"},qx={class:"dropdown"},Vx={class:"dropdown-menu"},Gx=["onClick"],Hx={key:0,class:"border-l pl-2 flex-1"},Wx={class:"flex items-center"},Zx={class:"plan-info"},Kx={class:"plan-name"},Yx={key:0,class:"plan-description"},Jx={class:"border-l pl-2 ml-auto"},Xx={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4 text-blue-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},Qx={key:1,class:"h-4 w-4 mr-2 text-primary-600",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},eL={key:"saving"},tL={key:"success",class:"save-success-text"},nL={key:"default"},iL={class:"md:hidden"},rL={class:"flex justify-between items-center"},sL={key:0,class:"truncate mx-2 text-sm font-medium"},oL={key:0,class:"mobile-menu mt-2 bg-white shadow-md rounded p-2 z-50"},aL={class:"flex flex-col space-y-2"},lL={key:0,class:"flex flex-col pb-2 border-b"},uL={class:"text-sm font-semibold text-gray-800"},cL={key:0,class:"text-xs text-gray-600 mt-1"},hL={class:"flex flex-col"},dL={class:"grid grid-cols-2 gap-1"},fL=["onClick"],pL={key:0,class:"animate-spin h-3 w-3 mr-1 text-blue-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},gL={key:1,class:"h-3 w-3 mr-1 text-primary-600",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},mL={key:"saving"},vL={key:"success",class:"save-success-text"},yL={key:"default"},_L=Hs({__name:"MapToolbar",props:{lastSave:{},planName:{},planDescription:{},saveStatus:{}},emits:["change-map-type","create-new-plan","load-plan","save-plan","adjust-view","generate-summary"],setup(e,{emit:t}){const n=t,i=e,o=Nt("Ville"),a=Nt(!1),u=H=>{const I=H.currentTarget,Q=I.nextElementSibling;if(Q&&Q.classList.contains("dropdown-menu")){const se=I.getBoundingClientRect();Q.style.top=`${se.bottom}px`,Q.style.left=`${se.left}px`}},d={Ville:"Ville",Satellite:"Satellite",Cadastre:"Cadastre"},f=Un(()=>i.lastSave?new Date(i.lastSave).toLocaleString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"Jamais"),m=H=>{o.value=H,n("change-map-type",H),$()},y=()=>{n("create-new-plan"),$()},x=()=>{n("load-plan"),$()},k=()=>{n("save-plan"),$()},b=()=>{n("adjust-view"),$()},T=()=>{n("generate-summary"),$()},$=()=>{a.value=!1};return(H,I)=>(je(),ze("div",Ux,[A("div",$x,[A("div",qx,[A("button",{class:"btn-toolbar dropdown-toggle",onMouseover:u},[I[1]||(I[1]=A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",viewBox:"0 0 20 20",fill:"currentColor"},[A("path",{"fill-rule":"evenodd",d:"M12 1.586l-4 4V17h8V5.586l-4-4zM2 17V9.276l4-3.638V17H2zM2 8.162V3h4.5L12 8.5V17H6V5.638L2 8.162z","clip-rule":"evenodd"})],-1)),A("span",null,Tt(d[o.value]),1)],32),A("div",Vx,[(je(),ze(Qt,null,Mn(d,(Q,se)=>A("button",{key:se,class:zi(["dropdown-item",{active:se===o.value}]),onClick:we=>m(se)},Tt(Q),11,Gx)),64))])]),H.planName?(je(),ze("div",Hx,[A("div",Wx,[A("div",Zx,[A("h2",Kx,Tt(H.planName),1),H.planDescription?(je(),ze("p",Yx,Tt(H.planDescription),1)):Zt("",!0)])])])):Zt("",!0),A("div",{class:"border-l pl-2"},[A("div",{class:"flex items-center space-x-1"},[A("button",{onClick:y,class:"btn-toolbar",title:"Nouveau plan"},I[2]||(I[2]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[A("path",{"fill-rule":"evenodd",d:"M6 2a2 2 0 00-2 2v12a2 2 0 002 2h8a2 2 0 002-2V7.414A2 2 0 0015.414 6L12 2.586A2 2 0 0010.586 2H6zm5 6a1 1 0 10-2 0v2H7a1 1 0 100 2h2v2a1 1 0 102 0v-2h2a1 1 0 100-2h-2V8z","clip-rule":"evenodd"})],-1),A("span",{class:"hidden lg:inline ml-1"},"Nouveau",-1)])),A("button",{onClick:x,class:"btn-toolbar",title:"Charger un plan"},I[3]||(I[3]=[gc('<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor" data-v-db17e599><path fill-rule="evenodd" d="M2 6a2 2 0 012-2h4a1 1 0 010 2H4v10h10v-4a1 1 0 112 0v4a2 2 0 01-2 2H4a2 2 0 01-2-2V6z" clip-rule="evenodd" data-v-db17e599></path><path d="M10 9a1 1 0 011-1h5a1 1 0 110 2h-5a1 1 0 01-1-1z" data-v-db17e599></path><path fill-rule="evenodd" d="M13 5a1 1 0 011 1v4a1 1 0 11-2 0V6a1 1 0 011-1z" clip-rule="evenodd" data-v-db17e599></path></svg><span class="hidden lg:inline ml-1" data-v-db17e599>Charger</span>',2)])),A("button",{onClick:k,class:"btn-toolbar",title:"Enregistrer le plan"},I[4]||(I[4]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[A("path",{d:"M7.707 10.293a1 1 0 10-1.414 1.414l3 3a1 1 0 001.414 0l3-3a1 1 0 00-1.414-1.414L11 11.586V6h5a2 2 0 012 2v7a2 2 0 01-2 2H4a2 2 0 01-2-2V8a2 2 0 012-2h5v5.586l-1.293-1.293zM9 4a1 1 0 012 0v2H9V4z"})],-1),A("span",{class:"hidden lg:inline ml-1"},"Enregistrer",-1)]))])]),A("div",{class:"border-l pl-2"},[A("div",{class:"flex items-center space-x-1"},[A("button",{onClick:b,class:"btn-toolbar",title:"Ajuster la vue"},I[5]||(I[5]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[A("path",{d:"M5 3a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2V5a2 2 0 00-2-2H5zM5 11a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2v-2a2 2 0 00-2-2H5zM11 5a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V5zM11 13a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})],-1),A("span",{class:"hidden lg:inline ml-1"},"Ajuster",-1)])),A("button",{onClick:T,class:"btn-toolbar",title:"Générer une synthèse"},I[6]||(I[6]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[A("path",{"fill-rule":"evenodd",d:"M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z","clip-rule":"evenodd"})],-1),A("span",{class:"hidden lg:inline ml-1"},"Synthèse",-1)]))])]),A("div",Jx,[A("div",{class:zi(["text-xs hidden lg:flex items-center",{"text-gray-500":!H.saveStatus,"text-primary-600 font-medium":H.saveStatus==="success","text-blue-600 font-medium":H.saveStatus==="saving"}])},[H.saveStatus==="saving"?(je(),ze("svg",Xx,I[7]||(I[7]=[A("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),A("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):Zt("",!0),H.saveStatus==="success"?(je(),ze("svg",Qx,I[8]||(I[8]=[A("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"},null,-1)]))):Zt("",!0),Pi(Dh,{name:"fade-slide",mode:"out-in"},{default:ea(()=>[H.saveStatus==="saving"?(je(),ze("span",eL," Sauvegarde en cours... ")):H.saveStatus==="success"?(je(),ze("span",tL," Sauvegarde réussie ! ")):(je(),ze("span",nL," Dernière modification : "+Tt(f.value),1))]),_:1})],2)])]),A("div",iL,[A("div",rL,[A("button",{onClick:I[0]||(I[0]=Q=>a.value=!a.value),class:"p-1 rounded border"},I[9]||(I[9]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-gray-600",viewBox:"0 0 20 20",fill:"currentColor"},[A("path",{"fill-rule":"evenodd",d:"M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z","clip-rule":"evenodd"})],-1)])),H.planName?(je(),ze("div",sL,Tt(H.planName),1)):Zt("",!0),A("div",{class:"flex space-x-1"},[A("button",{onClick:y,class:"p-1 rounded border bg-white"},I[10]||(I[10]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[A("path",{"fill-rule":"evenodd",d:"M6 2a2 2 0 00-2 2v12a2 2 0 002 2h8a2 2 0 002-2V7.414A2 2 0 0015.414 6L12 2.586A2 2 0 0010.586 2H6zm5 6a1 1 0 10-2 0v2H7a1 1 0 100 2h2v2a1 1 0 102 0v-2h2a1 1 0 100-2h-2V8z","clip-rule":"evenodd"})],-1)])),A("button",{onClick:k,class:"p-1 rounded border bg-white"},I[11]||(I[11]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[A("path",{d:"M7.707 10.293a1 1 0 10-1.414 1.414l3 3a1 1 0 001.414 0l3-3a1 1 0 00-1.414-1.414L11 11.586V6h5a2 2 0 012 2v7a2 2 0 01-2 2H4a2 2 0 01-2-2V8a2 2 0 012-2h5v5.586l-1.293-1.293zM9 4a1 1 0 012 0v2H9V4z"})],-1)])),A("button",{onClick:b,class:"p-1 rounded border bg-white"},I[12]||(I[12]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[A("path",{d:"M5 3a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2V5a2 2 0 00-2-2H5zM5 11a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2v-2a2 2 0 00-2-2H5zM11 5a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V5zM11 13a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})],-1)]))])]),a.value?(je(),ze("div",oL,[A("div",aL,[H.planName?(je(),ze("div",lL,[A("h3",uL,Tt(H.planName),1),H.planDescription?(je(),ze("p",cL,Tt(H.planDescription),1)):Zt("",!0)])):Zt("",!0),A("div",hL,[I[13]||(I[13]=A("span",{class:"text-xs font-medium text-gray-500 mb-1"},"Type de carte",-1)),A("div",dL,[(je(),ze(Qt,null,Mn(d,(Q,se)=>A("button",{key:se,class:zi(["px-2 py-1 text-xs rounded border",{"bg-blue-50 border-blue-200 text-blue-700":se===o.value}]),onClick:we=>m(se)},Tt(Q),11,fL)),64))])]),A("div",{class:"flex flex-col"},[I[16]||(I[16]=A("span",{class:"text-xs font-medium text-gray-500 mb-1"},"Outils de plan",-1)),A("div",{class:"grid grid-cols-2 gap-1"},[A("button",{onClick:x,class:"px-2 py-1 text-xs rounded border flex items-center justify-center"},I[14]||(I[14]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-3 w-3 mr-1",viewBox:"0 0 20 20",fill:"currentColor"},[A("path",{"fill-rule":"evenodd",d:"M2 6a2 2 0 012-2h4a1 1 0 010 2H4v10h10v-4a1 1 0 112 0v4a2 2 0 01-2 2H4a2 2 0 01-2-2V6z","clip-rule":"evenodd"}),A("path",{d:"M10 9a1 1 0 011-1h5a1 1 0 110 2h-5a1 1 0 01-1-1z"}),A("path",{"fill-rule":"evenodd",d:"M13 5a1 1 0 011 1v4a1 1 0 11-2 0V6a1 1 0 011-1z","clip-rule":"evenodd"})],-1),vi(" Charger ")])),A("button",{onClick:T,class:"px-2 py-1 text-xs rounded border flex items-center justify-center"},I[15]||(I[15]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-3 w-3 mr-1",viewBox:"0 0 20 20",fill:"currentColor"},[A("path",{"fill-rule":"evenodd",d:"M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z","clip-rule":"evenodd"})],-1),vi(" Synthèse ")]))])]),A("div",{class:zi(["text-xs text-center pt-1 border-t flex items-center justify-center space-x-1",{"text-gray-500":!H.saveStatus,"text-primary-600 font-medium":H.saveStatus==="success","text-blue-600 font-medium":H.saveStatus==="saving"}])},[H.saveStatus==="saving"?(je(),ze("svg",pL,I[17]||(I[17]=[A("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),A("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):Zt("",!0),H.saveStatus==="success"?(je(),ze("svg",gL,I[18]||(I[18]=[A("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"},null,-1)]))):Zt("",!0),Pi(Dh,{name:"fade-slide",mode:"out-in"},{default:ea(()=>[H.saveStatus==="saving"?(je(),ze("span",mL," Sauvegarde en cours... ")):H.saveStatus==="success"?(je(),ze("span",vL," Sauvegarde réussie ! ")):(je(),ze("span",yL," Dernière modification : "+Tt(f.value),1))]),_:1})],2)])])):Zt("",!0)])]))}}),bL=D1(_L,[["__scopeId","data-v-db17e599"]]);(()=>{var Wt,gn;var e=Object.create,t=Object.defineProperty,n=Object.getOwnPropertyDescriptor,i=Object.getOwnPropertyNames,o=Object.getPrototypeOf,a=Object.prototype.hasOwnProperty,u=(s,l)=>()=>(l||s((l={exports:{}}).exports,l),l.exports),d=(s,l,h,g)=>{if(l&&typeof l=="object"||typeof l=="function")for(let _ of i(l))!a.call(s,_)&&_!==h&&t(s,_,{get:()=>l[_],enumerable:!(g=n(l,_))||g.enumerable});return s},f=(s,l,h)=>(h=s!=null?e(o(s)):{},d(l||!s||!s.__esModule?t(h,"default",{value:s,enumerable:!0}):h,s)),m=u((s,l)=>{function h(){this.__data__=[],this.size=0}l.exports=h}),y=u((s,l)=>{function h(g,_){return g===_||g!==g&&_!==_}l.exports=h}),x=u((s,l)=>{var h=y();function g(_,E){for(var B=_.length;B--;)if(h(_[B][0],E))return B;return-1}l.exports=g}),k=u((s,l)=>{var h=x(),g=Array.prototype,_=g.splice;function E(B){var R=this.__data__,W=h(R,B);if(W<0)return!1;var he=R.length-1;return W==he?R.pop():_.call(R,W,1),--this.size,!0}l.exports=E}),b=u((s,l)=>{var h=x();function g(_){var E=this.__data__,B=h(E,_);return B<0?void 0:E[B][1]}l.exports=g}),T=u((s,l)=>{var h=x();function g(_){return h(this.__data__,_)>-1}l.exports=g}),$=u((s,l)=>{var h=x();function g(_,E){var B=this.__data__,R=h(B,_);return R<0?(++this.size,B.push([_,E])):B[R][1]=E,this}l.exports=g}),H=u((s,l)=>{var h=m(),g=k(),_=b(),E=T(),B=$();function R(W){var he=-1,Ie=W==null?0:W.length;for(this.clear();++he<Ie;){var Me=W[he];this.set(Me[0],Me[1])}}R.prototype.clear=h,R.prototype.delete=g,R.prototype.get=_,R.prototype.has=E,R.prototype.set=B,l.exports=R}),I=u((s,l)=>{var h=H();function g(){this.__data__=new h,this.size=0}l.exports=g}),Q=u((s,l)=>{function h(g){var _=this.__data__,E=_.delete(g);return this.size=_.size,E}l.exports=h}),se=u((s,l)=>{function h(g){return this.__data__.get(g)}l.exports=h}),we=u((s,l)=>{function h(g){return this.__data__.has(g)}l.exports=h}),Be=u((s,l)=>{var h=typeof To=="object"&&To&&To.Object===Object&&To;l.exports=h}),$e=u((s,l)=>{var h=Be(),g=typeof self=="object"&&self&&self.Object===Object&&self,_=h||g||Function("return this")();l.exports=_}),Ue=u((s,l)=>{var h=$e(),g=h.Symbol;l.exports=g}),Pe=u((s,l)=>{var h=Ue(),g=Object.prototype,_=g.hasOwnProperty,E=g.toString,B=h?h.toStringTag:void 0;function R(W){var he=_.call(W,B),Ie=W[B];try{W[B]=void 0;var Me=!0}catch{}var rt=E.call(W);return Me&&(he?W[B]=Ie:delete W[B]),rt}l.exports=R}),Te=u((s,l)=>{var h=Object.prototype,g=h.toString;function _(E){return g.call(E)}l.exports=_}),He=u((s,l)=>{var h=Ue(),g=Pe(),_=Te(),E="[object Null]",B="[object Undefined]",R=h?h.toStringTag:void 0;function W(he){return he==null?he===void 0?B:E:R&&R in Object(he)?g(he):_(he)}l.exports=W}),ae=u((s,l)=>{function h(g){var _=typeof g;return g!=null&&(_=="object"||_=="function")}l.exports=h}),re=u((s,l)=>{var h=He(),g=ae(),_="[object AsyncFunction]",E="[object Function]",B="[object GeneratorFunction]",R="[object Proxy]";function W(he){if(!g(he))return!1;var Ie=h(he);return Ie==E||Ie==B||Ie==_||Ie==R}l.exports=W}),oe=u((s,l)=>{var h=$e(),g=h["__core-js_shared__"];l.exports=g}),Y=u((s,l)=>{var h=oe(),g=function(){var E=/[^.]+$/.exec(h&&h.keys&&h.keys.IE_PROTO||"");return E?"Symbol(src)_1."+E:""}();function _(E){return!!g&&g in E}l.exports=_}),C=u((s,l)=>{var h=Function.prototype,g=h.toString;function _(E){if(E!=null){try{return g.call(E)}catch{}try{return E+""}catch{}}return""}l.exports=_}),N=u((s,l)=>{var h=re(),g=Y(),_=ae(),E=C(),B=/[\\^$.*+?()[\]{}|]/g,R=/^\[object .+?Constructor\]$/,W=Function.prototype,he=Object.prototype,Ie=W.toString,Me=he.hasOwnProperty,rt=RegExp("^"+Ie.call(Me).replace(B,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function pt(Dt){if(!_(Dt)||g(Dt))return!1;var Vt=h(Dt)?rt:R;return Vt.test(E(Dt))}l.exports=pt}),K=u((s,l)=>{function h(g,_){return g==null?void 0:g[_]}l.exports=h}),J=u((s,l)=>{var h=N(),g=K();function _(E,B){var R=g(E,B);return h(R)?R:void 0}l.exports=_}),Ee=u((s,l)=>{var h=J(),g=$e(),_=h(g,"Map");l.exports=_}),ue=u((s,l)=>{var h=J(),g=h(Object,"create");l.exports=g}),ye=u((s,l)=>{var h=ue();function g(){this.__data__=h?h(null):{},this.size=0}l.exports=g}),O=u((s,l)=>{function h(g){var _=this.has(g)&&delete this.__data__[g];return this.size-=_?1:0,_}l.exports=h}),ie=u((s,l)=>{var h=ue(),g="__lodash_hash_undefined__",_=Object.prototype,E=_.hasOwnProperty;function B(R){var W=this.__data__;if(h){var he=W[R];return he===g?void 0:he}return E.call(W,R)?W[R]:void 0}l.exports=B}),le=u((s,l)=>{var h=ue(),g=Object.prototype,_=g.hasOwnProperty;function E(B){var R=this.__data__;return h?R[B]!==void 0:_.call(R,B)}l.exports=E}),fe=u((s,l)=>{var h=ue(),g="__lodash_hash_undefined__";function _(E,B){var R=this.__data__;return this.size+=this.has(E)?0:1,R[E]=h&&B===void 0?g:B,this}l.exports=_}),_e=u((s,l)=>{var h=ye(),g=O(),_=ie(),E=le(),B=fe();function R(W){var he=-1,Ie=W==null?0:W.length;for(this.clear();++he<Ie;){var Me=W[he];this.set(Me[0],Me[1])}}R.prototype.clear=h,R.prototype.delete=g,R.prototype.get=_,R.prototype.has=E,R.prototype.set=B,l.exports=R}),ee=u((s,l)=>{var h=_e(),g=H(),_=Ee();function E(){this.size=0,this.__data__={hash:new h,map:new(_||g),string:new h}}l.exports=E}),G=u((s,l)=>{function h(g){var _=typeof g;return _=="string"||_=="number"||_=="symbol"||_=="boolean"?g!=="__proto__":g===null}l.exports=h}),q=u((s,l)=>{var h=G();function g(_,E){var B=_.__data__;return h(E)?B[typeof E=="string"?"string":"hash"]:B.map}l.exports=g}),de=u((s,l)=>{var h=q();function g(_){var E=h(this,_).delete(_);return this.size-=E?1:0,E}l.exports=g}),ce=u((s,l)=>{var h=q();function g(_){return h(this,_).get(_)}l.exports=g}),V=u((s,l)=>{var h=q();function g(_){return h(this,_).has(_)}l.exports=g}),Z=u((s,l)=>{var h=q();function g(_,E){var B=h(this,_),R=B.size;return B.set(_,E),this.size+=B.size==R?0:1,this}l.exports=g}),F=u((s,l)=>{var h=ee(),g=de(),_=ce(),E=V(),B=Z();function R(W){var he=-1,Ie=W==null?0:W.length;for(this.clear();++he<Ie;){var Me=W[he];this.set(Me[0],Me[1])}}R.prototype.clear=h,R.prototype.delete=g,R.prototype.get=_,R.prototype.has=E,R.prototype.set=B,l.exports=R}),D=u((s,l)=>{var h=H(),g=Ee(),_=F(),E=200;function B(R,W){var he=this.__data__;if(he instanceof h){var Ie=he.__data__;if(!g||Ie.length<E-1)return Ie.push([R,W]),this.size=++he.size,this;he=this.__data__=new _(Ie)}return he.set(R,W),this.size=he.size,this}l.exports=B}),j=u((s,l)=>{var h=H(),g=I(),_=Q(),E=se(),B=we(),R=D();function W(he){var Ie=this.__data__=new h(he);this.size=Ie.size}W.prototype.clear=g,W.prototype.delete=_,W.prototype.get=E,W.prototype.has=B,W.prototype.set=R,l.exports=W}),Fe=u((s,l)=>{var h=J(),g=function(){try{var _=h(Object,"defineProperty");return _({},"",{}),_}catch{}}();l.exports=g}),qe=u((s,l)=>{var h=Fe();function g(_,E,B){E=="__proto__"&&h?h(_,E,{configurable:!0,enumerable:!0,value:B,writable:!0}):_[E]=B}l.exports=g}),De=u((s,l)=>{var h=qe(),g=y();function _(E,B,R){(R!==void 0&&!g(E[B],R)||R===void 0&&!(B in E))&&h(E,B,R)}l.exports=_}),Je=u((s,l)=>{function h(g){return function(_,E,B){for(var R=-1,W=Object(_),he=B(_),Ie=he.length;Ie--;){var Me=he[g?Ie:++R];if(E(W[Me],Me,W)===!1)break}return _}}l.exports=h}),Ze=u((s,l)=>{var h=Je(),g=h();l.exports=g}),yt=u((s,l)=>{var h=$e(),g=typeof s=="object"&&s&&!s.nodeType&&s,_=g&&typeof l=="object"&&l&&!l.nodeType&&l,E=_&&_.exports===g,B=E?h.Buffer:void 0,R=B?B.allocUnsafe:void 0;function W(he,Ie){if(Ie)return he.slice();var Me=he.length,rt=R?R(Me):new he.constructor(Me);return he.copy(rt),rt}l.exports=W}),wt=u((s,l)=>{var h=$e(),g=h.Uint8Array;l.exports=g}),Pt=u((s,l)=>{var h=wt();function g(_){var E=new _.constructor(_.byteLength);return new h(E).set(new h(_)),E}l.exports=g}),Rt=u((s,l)=>{var h=Pt();function g(_,E){var B=E?h(_.buffer):_.buffer;return new _.constructor(B,_.byteOffset,_.length)}l.exports=g}),qt=u((s,l)=>{function h(g,_){var E=-1,B=g.length;for(_||(_=Array(B));++E<B;)_[E]=g[E];return _}l.exports=h}),lt=u((s,l)=>{var h=ae(),g=Object.create,_=function(){function E(){}return function(B){if(!h(B))return{};if(g)return g(B);E.prototype=B;var R=new E;return E.prototype=void 0,R}}();l.exports=_}),Oe=u((s,l)=>{function h(g,_){return function(E){return g(_(E))}}l.exports=h}),kt=u((s,l)=>{var h=Oe(),g=h(Object.getPrototypeOf,Object);l.exports=g}),Et=u((s,l)=>{var h=Object.prototype;function g(_){var E=_&&_.constructor,B=typeof E=="function"&&E.prototype||h;return _===B}l.exports=g}),St=u((s,l)=>{var h=lt(),g=kt(),_=Et();function E(B){return typeof B.constructor=="function"&&!_(B)?h(g(B)):{}}l.exports=E}),nt=u((s,l)=>{function h(g){return g!=null&&typeof g=="object"}l.exports=h}),st=u((s,l)=>{var h=He(),g=nt(),_="[object Arguments]";function E(B){return g(B)&&h(B)==_}l.exports=E}),pn=u((s,l)=>{var h=st(),g=nt(),_=Object.prototype,E=_.hasOwnProperty,B=_.propertyIsEnumerable,R=h(function(){return arguments}())?h:function(W){return g(W)&&E.call(W,"callee")&&!B.call(W,"callee")};l.exports=R}),Gt=u((s,l)=>{var h=Array.isArray;l.exports=h}),nn=u((s,l)=>{var h=9007199254740991;function g(_){return typeof _=="number"&&_>-1&&_%1==0&&_<=h}l.exports=g}),$n=u((s,l)=>{var h=re(),g=nn();function _(E){return E!=null&&g(E.length)&&!h(E)}l.exports=_}),an=u((s,l)=>{var h=$n(),g=nt();function _(E){return g(E)&&h(E)}l.exports=_}),Dn=u((s,l)=>{function h(){return!1}l.exports=h}),Pn=u((s,l)=>{var h=$e(),g=Dn(),_=typeof s=="object"&&s&&!s.nodeType&&s,E=_&&typeof l=="object"&&l&&!l.nodeType&&l,B=E&&E.exports===_,R=B?h.Buffer:void 0,W=R?R.isBuffer:void 0,he=W||g;l.exports=he}),Ui=u((s,l)=>{var h=He(),g=kt(),_=nt(),E="[object Object]",B=Function.prototype,R=Object.prototype,W=B.toString,he=R.hasOwnProperty,Ie=W.call(Object);function Me(rt){if(!_(rt)||h(rt)!=E)return!1;var pt=g(rt);if(pt===null)return!0;var Dt=he.call(pt,"constructor")&&pt.constructor;return typeof Dt=="function"&&Dt instanceof Dt&&W.call(Dt)==Ie}l.exports=Me}),Oi=u((s,l)=>{var h=He(),g=nn(),_=nt(),E="[object Arguments]",B="[object Array]",R="[object Boolean]",W="[object Date]",he="[object Error]",Ie="[object Function]",Me="[object Map]",rt="[object Number]",pt="[object Object]",Dt="[object RegExp]",Vt="[object Set]",Ht="[object String]",wn="[object WeakMap]",Re="[object ArrayBuffer]",Ve="[object DataView]",et="[object Float32Array]",_t="[object Float64Array]",at="[object Int8Array]",gt="[object Int16Array]",X="[object Int32Array]",pe="[object Uint8Array]",Ce="[object Uint8ClampedArray]",Le="[object Uint16Array]",ke="[object Uint32Array]",Se={};Se[et]=Se[_t]=Se[at]=Se[gt]=Se[X]=Se[pe]=Se[Ce]=Se[Le]=Se[ke]=!0,Se[E]=Se[B]=Se[Re]=Se[R]=Se[Ve]=Se[W]=Se[he]=Se[Ie]=Se[Me]=Se[rt]=Se[pt]=Se[Dt]=Se[Vt]=Se[Ht]=Se[wn]=!1;function Ye(We){return _(We)&&g(We.length)&&!!Se[h(We)]}l.exports=Ye}),qn=u((s,l)=>{function h(g){return function(_){return g(_)}}l.exports=h}),$t=u((s,l)=>{var h=Be(),g=typeof s=="object"&&s&&!s.nodeType&&s,_=g&&typeof l=="object"&&l&&!l.nodeType&&l,E=_&&_.exports===g,B=E&&h.process,R=function(){try{var W=_&&_.require&&_.require("util").types;return W||B&&B.binding&&B.binding("util")}catch{}}();l.exports=R}),Bn=u((s,l)=>{var h=Oi(),g=qn(),_=$t(),E=_&&_.isTypedArray,B=E?g(E):h;l.exports=B}),wi=u((s,l)=>{function h(g,_){if(!(_==="constructor"&&typeof g[_]=="function")&&_!="__proto__")return g[_]}l.exports=h}),Yn=u((s,l)=>{var h=qe(),g=y(),_=Object.prototype,E=_.hasOwnProperty;function B(R,W,he){var Ie=R[W];(!(E.call(R,W)&&g(Ie,he))||he===void 0&&!(W in R))&&h(R,W,he)}l.exports=B}),xi=u((s,l)=>{var h=Yn(),g=qe();function _(E,B,R,W){var he=!R;R||(R={});for(var Ie=-1,Me=B.length;++Ie<Me;){var rt=B[Ie],pt=W?W(R[rt],E[rt],rt,R,E):void 0;pt===void 0&&(pt=E[rt]),he?g(R,rt,pt):h(R,rt,pt)}return R}l.exports=_}),pi=u((s,l)=>{function h(g,_){for(var E=-1,B=Array(g);++E<g;)B[E]=_(E);return B}l.exports=h}),sn=u((s,l)=>{var h=9007199254740991,g=/^(?:0|[1-9]\d*)$/;function _(E,B){var R=typeof E;return B=B??h,!!B&&(R=="number"||R!="symbol"&&g.test(E))&&E>-1&&E%1==0&&E<B}l.exports=_}),mn=u((s,l)=>{var h=pi(),g=pn(),_=Gt(),E=Pn(),B=sn(),R=Bn(),W=Object.prototype,he=W.hasOwnProperty;function Ie(Me,rt){var pt=_(Me),Dt=!pt&&g(Me),Vt=!pt&&!Dt&&E(Me),Ht=!pt&&!Dt&&!Vt&&R(Me),wn=pt||Dt||Vt||Ht,Re=wn?h(Me.length,String):[],Ve=Re.length;for(var et in Me)(rt||he.call(Me,et))&&!(wn&&(et=="length"||Vt&&(et=="offset"||et=="parent")||Ht&&(et=="buffer"||et=="byteLength"||et=="byteOffset")||B(et,Ve)))&&Re.push(et);return Re}l.exports=Ie}),Yt=u((s,l)=>{function h(g){var _=[];if(g!=null)for(var E in Object(g))_.push(E);return _}l.exports=h}),gi=u((s,l)=>{var h=ae(),g=Et(),_=Yt(),E=Object.prototype,B=E.hasOwnProperty;function R(W){if(!h(W))return _(W);var he=g(W),Ie=[];for(var Me in W)Me=="constructor"&&(he||!B.call(W,Me))||Ie.push(Me);return Ie}l.exports=R}),In=u((s,l)=>{var h=mn(),g=gi(),_=$n();function E(B){return _(B)?h(B,!0):g(B)}l.exports=E}),bt=u((s,l)=>{var h=xi(),g=In();function _(E){return h(E,g(E))}l.exports=_}),Xn=u((s,l)=>{var h=De(),g=yt(),_=Rt(),E=qt(),B=St(),R=pn(),W=Gt(),he=an(),Ie=Pn(),Me=re(),rt=ae(),pt=Ui(),Dt=Bn(),Vt=wi(),Ht=bt();function wn(Re,Ve,et,_t,at,gt,X){var pe=Vt(Re,et),Ce=Vt(Ve,et),Le=X.get(Ce);if(Le){h(Re,et,Le);return}var ke=gt?gt(pe,Ce,et+"",Re,Ve,X):void 0,Se=ke===void 0;if(Se){var Ye=W(Ce),We=!Ye&&Ie(Ce),tt=!Ye&&!We&&Dt(Ce);ke=Ce,Ye||We||tt?W(pe)?ke=pe:he(pe)?ke=E(pe):We?(Se=!1,ke=g(Ce,!0)):tt?(Se=!1,ke=_(Ce,!0)):ke=[]:pt(Ce)||R(Ce)?(ke=pe,R(pe)?ke=Ht(pe):(!rt(pe)||Me(pe))&&(ke=B(Ce))):Se=!1}Se&&(X.set(Ce,ke),at(ke,Ce,_t,gt,X),X.delete(Ce)),h(Re,et,ke)}l.exports=wn}),Ii=u((s,l)=>{var h=j(),g=De(),_=Ze(),E=Xn(),B=ae(),R=In(),W=wi();function he(Ie,Me,rt,pt,Dt){Ie!==Me&&_(Me,function(Vt,Ht){if(Dt||(Dt=new h),B(Vt))E(Ie,Me,Ht,rt,he,pt,Dt);else{var wn=pt?pt(W(Ie,Ht),Vt,Ht+"",Ie,Me,Dt):void 0;wn===void 0&&(wn=Vt),g(Ie,Ht,wn)}},R)}l.exports=he}),ui=u((s,l)=>{function h(g){return g}l.exports=h}),yr=u((s,l)=>{function h(g,_,E){switch(E.length){case 0:return g.call(_);case 1:return g.call(_,E[0]);case 2:return g.call(_,E[0],E[1]);case 3:return g.call(_,E[0],E[1],E[2])}return g.apply(_,E)}l.exports=h}),lr=u((s,l)=>{var h=yr(),g=Math.max;function _(E,B,R){return B=g(B===void 0?E.length-1:B,0),function(){for(var W=arguments,he=-1,Ie=g(W.length-B,0),Me=Array(Ie);++he<Ie;)Me[he]=W[B+he];he=-1;for(var rt=Array(B+1);++he<B;)rt[he]=W[he];return rt[B]=R(Me),h(E,this,rt)}}l.exports=_}),_r=u((s,l)=>{function h(g){return function(){return g}}l.exports=h}),Yi=u((s,l)=>{var h=_r(),g=Fe(),_=ui(),E=g?function(B,R){return g(B,"toString",{configurable:!0,enumerable:!1,value:h(R),writable:!0})}:_;l.exports=E}),ur=u((s,l)=>{var h=800,g=16,_=Date.now;function E(B){var R=0,W=0;return function(){var he=_(),Ie=g-(he-W);if(W=he,Ie>0){if(++R>=h)return arguments[0]}else R=0;return B.apply(void 0,arguments)}}l.exports=E}),jr=u((s,l)=>{var h=Yi(),g=ur(),_=g(h);l.exports=_}),Ss=u((s,l)=>{var h=ui(),g=lr(),_=jr();function E(B,R){return _(g(B,R,h),B+"")}l.exports=E}),Zs=u((s,l)=>{var h=y(),g=$n(),_=sn(),E=ae();function B(R,W,he){if(!E(he))return!1;var Ie=typeof W;return(Ie=="number"?g(he)&&_(W,he.length):Ie=="string"&&W in he)?h(he[W],R):!1}l.exports=B}),Ks=u((s,l)=>{var h=Ss(),g=Zs();function _(E){return h(function(B,R){var W=-1,he=R.length,Ie=he>1?R[he-1]:void 0,Me=he>2?R[2]:void 0;for(Ie=E.length>3&&typeof Ie=="function"?(he--,Ie):void 0,Me&&g(R[0],R[1],Me)&&(Ie=he<3?void 0:Ie,he=1),B=Object(B);++W<he;){var rt=R[W];rt&&E(B,rt,W,Ie)}return B})}l.exports=_}),Gr=u((s,l)=>{var h=Ii(),g=Ks(),_=g(function(E,B,R){h(E,B,R)});l.exports=_}),ds=u((s,l)=>{var h=He(),g=nt(),_="[object Symbol]";function E(B){return typeof B=="symbol"||g(B)&&h(B)==_}l.exports=E}),As=u((s,l)=>{var h=Gt(),g=ds(),_=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,E=/^\w*$/;function B(R,W){if(h(R))return!1;var he=typeof R;return he=="number"||he=="symbol"||he=="boolean"||R==null||g(R)?!0:E.test(R)||!_.test(R)||W!=null&&R in Object(W)}l.exports=B}),ua=u((s,l)=>{var h=F(),g="Expected a function";function _(E,B){if(typeof E!="function"||B!=null&&typeof B!="function")throw new TypeError(g);var R=function(){var W=arguments,he=B?B.apply(this,W):W[0],Ie=R.cache;if(Ie.has(he))return Ie.get(he);var Me=E.apply(this,W);return R.cache=Ie.set(he,Me)||Ie,Me};return R.cache=new(_.Cache||h),R}_.Cache=h,l.exports=_}),ca=u((s,l)=>{var h=ua(),g=500;function _(E){var B=h(E,function(W){return R.size===g&&R.clear(),W}),R=B.cache;return B}l.exports=_}),Ys=u((s,l)=>{var h=ca(),g=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,_=/\\(\\)?/g,E=h(function(B){var R=[];return B.charCodeAt(0)===46&&R.push(""),B.replace(g,function(W,he,Ie,Me){R.push(Ie?Me.replace(_,"$1"):he||W)}),R});l.exports=E}),Io=u((s,l)=>{function h(g,_){for(var E=-1,B=g==null?0:g.length,R=Array(B);++E<B;)R[E]=_(g[E],E,g);return R}l.exports=h}),ha=u((s,l)=>{var h=Ue(),g=Io(),_=Gt(),E=ds(),B=h?h.prototype:void 0,R=B?B.toString:void 0;function W(he){if(typeof he=="string")return he;if(_(he))return g(he,W)+"";if(E(he))return R?R.call(he):"";var Ie=he+"";return Ie=="0"&&1/he==-1/0?"-0":Ie}l.exports=W}),Ms=u((s,l)=>{var h=ha();function g(_){return _==null?"":h(_)}l.exports=g}),Bs=u((s,l)=>{var h=Gt(),g=As(),_=Ys(),E=Ms();function B(R,W){return h(R)?R:g(R,W)?[R]:_(E(R))}l.exports=B}),go=u((s,l)=>{var h=ds();function g(_){if(typeof _=="string"||h(_))return _;var E=_+"";return E=="0"&&1/_==-1/0?"-0":E}l.exports=g}),Fo=u((s,l)=>{var h=Bs(),g=go();function _(E,B){B=h(B,E);for(var R=0,W=B.length;E!=null&&R<W;)E=E[g(B[R++])];return R&&R==W?E:void 0}l.exports=_}),cr=u((s,l)=>{var h=Fo();function g(_,E,B){var R=_==null?void 0:h(_,E);return R===void 0?B:R}l.exports=g}),Fn=u((s,l)=>{(function(h,g){typeof s=="object"&&typeof l<"u"?l.exports=g():(h=h||self).RBush=g()})(s,function(){function h(Re,Ve,et,_t,at){(function gt(X,pe,Ce,Le,ke){for(;Le>Ce;){if(Le-Ce>600){var Se=Le-Ce+1,Ye=pe-Ce+1,We=Math.log(Se),tt=.5*Math.exp(2*We/3),dt=.5*Math.sqrt(We*tt*(Se-tt)/Se)*(Ye-Se/2<0?-1:1),ht=Math.max(Ce,Math.floor(pe-Ye*tt/Se+dt)),It=Math.min(Le,Math.floor(pe+(Se-Ye)*tt/Se+dt));gt(X,pe,ht,It,ke)}var Xt=X[pe],rn=Ce,ln=Le;for(g(X,Ce,pe),ke(X[Le],Xt)>0&&g(X,Ce,Le);rn<ln;){for(g(X,rn,ln),rn++,ln--;ke(X[rn],Xt)<0;)rn++;for(;ke(X[ln],Xt)>0;)ln--}ke(X[Ce],Xt)===0?g(X,Ce,ln):g(X,++ln,Le),ln<=pe&&(Ce=ln+1),pe<=ln&&(Le=ln-1)}})(Re,Ve,et||0,_t||Re.length-1,at||_)}function g(Re,Ve,et){var _t=Re[Ve];Re[Ve]=Re[et],Re[et]=_t}function _(Re,Ve){return Re<Ve?-1:Re>Ve?1:0}var E=function(Re){Re===void 0&&(Re=9),this._maxEntries=Math.max(4,Re),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function B(Re,Ve,et){if(!et)return Ve.indexOf(Re);for(var _t=0;_t<Ve.length;_t++)if(et(Re,Ve[_t]))return _t;return-1}function R(Re,Ve){W(Re,0,Re.children.length,Ve,Re)}function W(Re,Ve,et,_t,at){at||(at=Ht(null)),at.minX=1/0,at.minY=1/0,at.maxX=-1/0,at.maxY=-1/0;for(var gt=Ve;gt<et;gt++){var X=Re.children[gt];he(at,Re.leaf?_t(X):X)}return at}function he(Re,Ve){return Re.minX=Math.min(Re.minX,Ve.minX),Re.minY=Math.min(Re.minY,Ve.minY),Re.maxX=Math.max(Re.maxX,Ve.maxX),Re.maxY=Math.max(Re.maxY,Ve.maxY),Re}function Ie(Re,Ve){return Re.minX-Ve.minX}function Me(Re,Ve){return Re.minY-Ve.minY}function rt(Re){return(Re.maxX-Re.minX)*(Re.maxY-Re.minY)}function pt(Re){return Re.maxX-Re.minX+(Re.maxY-Re.minY)}function Dt(Re,Ve){return Re.minX<=Ve.minX&&Re.minY<=Ve.minY&&Ve.maxX<=Re.maxX&&Ve.maxY<=Re.maxY}function Vt(Re,Ve){return Ve.minX<=Re.maxX&&Ve.minY<=Re.maxY&&Ve.maxX>=Re.minX&&Ve.maxY>=Re.minY}function Ht(Re){return{children:Re,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function wn(Re,Ve,et,_t,at){for(var gt=[Ve,et];gt.length;)if(!((et=gt.pop())-(Ve=gt.pop())<=_t)){var X=Ve+Math.ceil((et-Ve)/_t/2)*_t;h(Re,X,Ve,et,at),gt.push(Ve,X,X,et)}}return E.prototype.all=function(){return this._all(this.data,[])},E.prototype.search=function(Re){var Ve=this.data,et=[];if(!Vt(Re,Ve))return et;for(var _t=this.toBBox,at=[];Ve;){for(var gt=0;gt<Ve.children.length;gt++){var X=Ve.children[gt],pe=Ve.leaf?_t(X):X;Vt(Re,pe)&&(Ve.leaf?et.push(X):Dt(Re,pe)?this._all(X,et):at.push(X))}Ve=at.pop()}return et},E.prototype.collides=function(Re){var Ve=this.data;if(!Vt(Re,Ve))return!1;for(var et=[];Ve;){for(var _t=0;_t<Ve.children.length;_t++){var at=Ve.children[_t],gt=Ve.leaf?this.toBBox(at):at;if(Vt(Re,gt)){if(Ve.leaf||Dt(Re,gt))return!0;et.push(at)}}Ve=et.pop()}return!1},E.prototype.load=function(Re){if(!Re||!Re.length)return this;if(Re.length<this._minEntries){for(var Ve=0;Ve<Re.length;Ve++)this.insert(Re[Ve]);return this}var et=this._build(Re.slice(),0,Re.length-1,0);if(this.data.children.length)if(this.data.height===et.height)this._splitRoot(this.data,et);else{if(this.data.height<et.height){var _t=this.data;this.data=et,et=_t}this._insert(et,this.data.height-et.height-1,!0)}else this.data=et;return this},E.prototype.insert=function(Re){return Re&&this._insert(Re,this.data.height-1),this},E.prototype.clear=function(){return this.data=Ht([]),this},E.prototype.remove=function(Re,Ve){if(!Re)return this;for(var et,_t,at,gt=this.data,X=this.toBBox(Re),pe=[],Ce=[];gt||pe.length;){if(gt||(gt=pe.pop(),_t=pe[pe.length-1],et=Ce.pop(),at=!0),gt.leaf){var Le=B(Re,gt.children,Ve);if(Le!==-1)return gt.children.splice(Le,1),pe.push(gt),this._condense(pe),this}at||gt.leaf||!Dt(gt,X)?_t?(et++,gt=_t.children[et],at=!1):gt=null:(pe.push(gt),Ce.push(et),et=0,_t=gt,gt=gt.children[0])}return this},E.prototype.toBBox=function(Re){return Re},E.prototype.compareMinX=function(Re,Ve){return Re.minX-Ve.minX},E.prototype.compareMinY=function(Re,Ve){return Re.minY-Ve.minY},E.prototype.toJSON=function(){return this.data},E.prototype.fromJSON=function(Re){return this.data=Re,this},E.prototype._all=function(Re,Ve){for(var et=[];Re;)Re.leaf?Ve.push.apply(Ve,Re.children):et.push.apply(et,Re.children),Re=et.pop();return Ve},E.prototype._build=function(Re,Ve,et,_t){var at,gt=et-Ve+1,X=this._maxEntries;if(gt<=X)return R(at=Ht(Re.slice(Ve,et+1)),this.toBBox),at;_t||(_t=Math.ceil(Math.log(gt)/Math.log(X)),X=Math.ceil(gt/Math.pow(X,_t-1))),(at=Ht([])).leaf=!1,at.height=_t;var pe=Math.ceil(gt/X),Ce=pe*Math.ceil(Math.sqrt(X));wn(Re,Ve,et,Ce,this.compareMinX);for(var Le=Ve;Le<=et;Le+=Ce){var ke=Math.min(Le+Ce-1,et);wn(Re,Le,ke,pe,this.compareMinY);for(var Se=Le;Se<=ke;Se+=pe){var Ye=Math.min(Se+pe-1,ke);at.children.push(this._build(Re,Se,Ye,_t-1))}}return R(at,this.toBBox),at},E.prototype._chooseSubtree=function(Re,Ve,et,_t){for(;_t.push(Ve),!Ve.leaf&&_t.length-1!==et;){for(var at=1/0,gt=1/0,X=void 0,pe=0;pe<Ve.children.length;pe++){var Ce=Ve.children[pe],Le=rt(Ce),ke=(Se=Re,Ye=Ce,(Math.max(Ye.maxX,Se.maxX)-Math.min(Ye.minX,Se.minX))*(Math.max(Ye.maxY,Se.maxY)-Math.min(Ye.minY,Se.minY))-Le);ke<gt?(gt=ke,at=Le<at?Le:at,X=Ce):ke===gt&&Le<at&&(at=Le,X=Ce)}Ve=X||Ve.children[0]}var Se,Ye;return Ve},E.prototype._insert=function(Re,Ve,et){var _t=et?Re:this.toBBox(Re),at=[],gt=this._chooseSubtree(_t,this.data,Ve,at);for(gt.children.push(Re),he(gt,_t);Ve>=0&&at[Ve].children.length>this._maxEntries;)this._split(at,Ve),Ve--;this._adjustParentBBoxes(_t,at,Ve)},E.prototype._split=function(Re,Ve){var et=Re[Ve],_t=et.children.length,at=this._minEntries;this._chooseSplitAxis(et,at,_t);var gt=this._chooseSplitIndex(et,at,_t),X=Ht(et.children.splice(gt,et.children.length-gt));X.height=et.height,X.leaf=et.leaf,R(et,this.toBBox),R(X,this.toBBox),Ve?Re[Ve-1].children.push(X):this._splitRoot(et,X)},E.prototype._splitRoot=function(Re,Ve){this.data=Ht([Re,Ve]),this.data.height=Re.height+1,this.data.leaf=!1,R(this.data,this.toBBox)},E.prototype._chooseSplitIndex=function(Re,Ve,et){for(var _t,at,gt,X,pe,Ce,Le,ke=1/0,Se=1/0,Ye=Ve;Ye<=et-Ve;Ye++){var We=W(Re,0,Ye,this.toBBox),tt=W(Re,Ye,et,this.toBBox),dt=(at=We,gt=tt,X=void 0,pe=void 0,Ce=void 0,Le=void 0,X=Math.max(at.minX,gt.minX),pe=Math.max(at.minY,gt.minY),Ce=Math.min(at.maxX,gt.maxX),Le=Math.min(at.maxY,gt.maxY),Math.max(0,Ce-X)*Math.max(0,Le-pe)),ht=rt(We)+rt(tt);dt<ke?(ke=dt,_t=Ye,Se=ht<Se?ht:Se):dt===ke&&ht<Se&&(Se=ht,_t=Ye)}return _t||et-Ve},E.prototype._chooseSplitAxis=function(Re,Ve,et){var _t=Re.leaf?this.compareMinX:Ie,at=Re.leaf?this.compareMinY:Me;this._allDistMargin(Re,Ve,et,_t)<this._allDistMargin(Re,Ve,et,at)&&Re.children.sort(_t)},E.prototype._allDistMargin=function(Re,Ve,et,_t){Re.children.sort(_t);for(var at=this.toBBox,gt=W(Re,0,Ve,at),X=W(Re,et-Ve,et,at),pe=pt(gt)+pt(X),Ce=Ve;Ce<et-Ve;Ce++){var Le=Re.children[Ce];he(gt,Re.leaf?at(Le):Le),pe+=pt(gt)}for(var ke=et-Ve-1;ke>=Ve;ke--){var Se=Re.children[ke];he(X,Re.leaf?at(Se):Se),pe+=pt(X)}return pe},E.prototype._adjustParentBBoxes=function(Re,Ve,et){for(var _t=et;_t>=0;_t--)he(Ve[_t],Re)},E.prototype._condense=function(Re){for(var Ve=Re.length-1,et=void 0;Ve>=0;Ve--)Re[Ve].children.length===0?Ve>0?(et=Re[Ve-1].children).splice(et.indexOf(Re[Ve]),1):this.clear():R(Re[Ve],this.toBBox)},E})}),_n=u(s=>{Object.defineProperty(s,"__esModule",{value:!0}),s.earthRadius=63710088e-1,s.factors={centimeters:s.earthRadius*100,centimetres:s.earthRadius*100,degrees:s.earthRadius/111325,feet:s.earthRadius*3.28084,inches:s.earthRadius*39.37,kilometers:s.earthRadius/1e3,kilometres:s.earthRadius/1e3,meters:s.earthRadius,metres:s.earthRadius,miles:s.earthRadius/1609.344,millimeters:s.earthRadius*1e3,millimetres:s.earthRadius*1e3,nauticalmiles:s.earthRadius/1852,radians:1,yards:s.earthRadius*1.0936},s.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/s.earthRadius,yards:1.0936133},s.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function l(Le,ke,Se){Se===void 0&&(Se={});var Ye={type:"Feature"};return(Se.id===0||Se.id)&&(Ye.id=Se.id),Se.bbox&&(Ye.bbox=Se.bbox),Ye.properties=ke||{},Ye.geometry=Le,Ye}s.feature=l;function h(Le,ke,Se){switch(Le){case"Point":return g(ke).geometry;case"LineString":return R(ke).geometry;case"Polygon":return E(ke).geometry;case"MultiPoint":return Me(ke).geometry;case"MultiLineString":return Ie(ke).geometry;case"MultiPolygon":return rt(ke).geometry;default:throw new Error(Le+" is invalid")}}s.geometry=h;function g(Le,ke,Se){if(Se===void 0&&(Se={}),!Le)throw new Error("coordinates is required");if(!Array.isArray(Le))throw new Error("coordinates must be an Array");if(Le.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!gt(Le[0])||!gt(Le[1]))throw new Error("coordinates must contain numbers");var Ye={type:"Point",coordinates:Le};return l(Ye,ke,Se)}s.point=g;function _(Le,ke,Se){return Se===void 0&&(Se={}),he(Le.map(function(Ye){return g(Ye,ke)}),Se)}s.points=_;function E(Le,ke,Se){Se===void 0&&(Se={});for(var Ye=0,We=Le;Ye<We.length;Ye++){var tt=We[Ye];if(tt.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var dt=0;dt<tt[tt.length-1].length;dt++)if(tt[tt.length-1][dt]!==tt[0][dt])throw new Error("First and last Position are not equivalent.")}var ht={type:"Polygon",coordinates:Le};return l(ht,ke,Se)}s.polygon=E;function B(Le,ke,Se){return Se===void 0&&(Se={}),he(Le.map(function(Ye){return E(Ye,ke)}),Se)}s.polygons=B;function R(Le,ke,Se){if(Se===void 0&&(Se={}),Le.length<2)throw new Error("coordinates must be an array of two or more positions");var Ye={type:"LineString",coordinates:Le};return l(Ye,ke,Se)}s.lineString=R;function W(Le,ke,Se){return Se===void 0&&(Se={}),he(Le.map(function(Ye){return R(Ye,ke)}),Se)}s.lineStrings=W;function he(Le,ke){ke===void 0&&(ke={});var Se={type:"FeatureCollection"};return ke.id&&(Se.id=ke.id),ke.bbox&&(Se.bbox=ke.bbox),Se.features=Le,Se}s.featureCollection=he;function Ie(Le,ke,Se){Se===void 0&&(Se={});var Ye={type:"MultiLineString",coordinates:Le};return l(Ye,ke,Se)}s.multiLineString=Ie;function Me(Le,ke,Se){Se===void 0&&(Se={});var Ye={type:"MultiPoint",coordinates:Le};return l(Ye,ke,Se)}s.multiPoint=Me;function rt(Le,ke,Se){Se===void 0&&(Se={});var Ye={type:"MultiPolygon",coordinates:Le};return l(Ye,ke,Se)}s.multiPolygon=rt;function pt(Le,ke,Se){Se===void 0&&(Se={});var Ye={type:"GeometryCollection",geometries:Le};return l(Ye,ke,Se)}s.geometryCollection=pt;function Dt(Le,ke){if(ke===void 0&&(ke=0),ke&&!(ke>=0))throw new Error("precision must be a positive number");var Se=Math.pow(10,ke||0);return Math.round(Le*Se)/Se}s.round=Dt;function Vt(Le,ke){ke===void 0&&(ke="kilometers");var Se=s.factors[ke];if(!Se)throw new Error(ke+" units is invalid");return Le*Se}s.radiansToLength=Vt;function Ht(Le,ke){ke===void 0&&(ke="kilometers");var Se=s.factors[ke];if(!Se)throw new Error(ke+" units is invalid");return Le/Se}s.lengthToRadians=Ht;function wn(Le,ke){return Ve(Ht(Le,ke))}s.lengthToDegrees=wn;function Re(Le){var ke=Le%360;return ke<0&&(ke+=360),ke}s.bearingToAzimuth=Re;function Ve(Le){var ke=Le%(2*Math.PI);return ke*180/Math.PI}s.radiansToDegrees=Ve;function et(Le){var ke=Le%360;return ke*Math.PI/180}s.degreesToRadians=et;function _t(Le,ke,Se){if(ke===void 0&&(ke="kilometers"),Se===void 0&&(Se="kilometers"),!(Le>=0))throw new Error("length must be a positive number");return Vt(Ht(Le,ke),Se)}s.convertLength=_t;function at(Le,ke,Se){if(ke===void 0&&(ke="meters"),Se===void 0&&(Se="kilometers"),!(Le>=0))throw new Error("area must be a positive number");var Ye=s.areaFactors[ke];if(!Ye)throw new Error("invalid original units");var We=s.areaFactors[Se];if(!We)throw new Error("invalid final units");return Le/Ye*We}s.convertArea=at;function gt(Le){return!isNaN(Le)&&Le!==null&&!Array.isArray(Le)}s.isNumber=gt;function X(Le){return!!Le&&Le.constructor===Object}s.isObject=X;function pe(Le){if(!Le)throw new Error("bbox is required");if(!Array.isArray(Le))throw new Error("bbox must be an Array");if(Le.length!==4&&Le.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");Le.forEach(function(ke){if(!gt(ke))throw new Error("bbox must only contain numbers")})}s.validateBBox=pe;function Ce(Le){if(!Le)throw new Error("id is required");if(["string","number"].indexOf(typeof Le)===-1)throw new Error("id must be a number or a string")}s.validateId=Ce}),fs=u(s=>{Object.defineProperty(s,"__esModule",{value:!0});var l=_n();function h(Ve,et,_t){if(Ve!==null)for(var at,gt,X,pe,Ce,Le,ke,Se=0,Ye=0,We,tt=Ve.type,dt=tt==="FeatureCollection",ht=tt==="Feature",It=dt?Ve.features.length:1,Xt=0;Xt<It;Xt++){ke=dt?Ve.features[Xt].geometry:ht?Ve.geometry:Ve,We=ke?ke.type==="GeometryCollection":!1,Ce=We?ke.geometries.length:1;for(var rn=0;rn<Ce;rn++){var ln=0,Jn=0;if(pe=We?ke.geometries[rn]:ke,pe!==null){Le=pe.coordinates;var ni=pe.type;switch(Se=_t&&(ni==="Polygon"||ni==="MultiPolygon")?1:0,ni){case null:break;case"Point":if(et(Le,Ye,Xt,ln,Jn)===!1)return!1;Ye++,ln++;break;case"LineString":case"MultiPoint":for(at=0;at<Le.length;at++){if(et(Le[at],Ye,Xt,ln,Jn)===!1)return!1;Ye++,ni==="MultiPoint"&&ln++}ni==="LineString"&&ln++;break;case"Polygon":case"MultiLineString":for(at=0;at<Le.length;at++){for(gt=0;gt<Le[at].length-Se;gt++){if(et(Le[at][gt],Ye,Xt,ln,Jn)===!1)return!1;Ye++}ni==="MultiLineString"&&ln++,ni==="Polygon"&&Jn++}ni==="Polygon"&&ln++;break;case"MultiPolygon":for(at=0;at<Le.length;at++){for(Jn=0,gt=0;gt<Le[at].length;gt++){for(X=0;X<Le[at][gt].length-Se;X++){if(et(Le[at][gt][X],Ye,Xt,ln,Jn)===!1)return!1;Ye++}Jn++}ln++}break;case"GeometryCollection":for(at=0;at<pe.geometries.length;at++)if(h(pe.geometries[at],et,_t)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function g(Ve,et,_t,at){var gt=_t;return h(Ve,function(X,pe,Ce,Le,ke){pe===0&&_t===void 0?gt=X:gt=et(gt,X,pe,Ce,Le,ke)},at),gt}function _(Ve,et){var _t;switch(Ve.type){case"FeatureCollection":for(_t=0;_t<Ve.features.length&&et(Ve.features[_t].properties,_t)!==!1;_t++);break;case"Feature":et(Ve.properties,0);break}}function E(Ve,et,_t){var at=_t;return _(Ve,function(gt,X){X===0&&_t===void 0?at=gt:at=et(at,gt,X)}),at}function B(Ve,et){if(Ve.type==="Feature")et(Ve,0);else if(Ve.type==="FeatureCollection")for(var _t=0;_t<Ve.features.length&&et(Ve.features[_t],_t)!==!1;_t++);}function R(Ve,et,_t){var at=_t;return B(Ve,function(gt,X){X===0&&_t===void 0?at=gt:at=et(at,gt,X)}),at}function W(Ve){var et=[];return h(Ve,function(_t){et.push(_t)}),et}function he(Ve,et){var _t,at,gt,X,pe,Ce,Le,ke,Se,Ye,We=0,tt=Ve.type==="FeatureCollection",dt=Ve.type==="Feature",ht=tt?Ve.features.length:1;for(_t=0;_t<ht;_t++){for(Ce=tt?Ve.features[_t].geometry:dt?Ve.geometry:Ve,ke=tt?Ve.features[_t].properties:dt?Ve.properties:{},Se=tt?Ve.features[_t].bbox:dt?Ve.bbox:void 0,Ye=tt?Ve.features[_t].id:dt?Ve.id:void 0,Le=Ce?Ce.type==="GeometryCollection":!1,pe=Le?Ce.geometries.length:1,gt=0;gt<pe;gt++){if(X=Le?Ce.geometries[gt]:Ce,X===null){if(et(null,We,ke,Se,Ye)===!1)return!1;continue}switch(X.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(et(X,We,ke,Se,Ye)===!1)return!1;break}case"GeometryCollection":{for(at=0;at<X.geometries.length;at++)if(et(X.geometries[at],We,ke,Se,Ye)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}We++}}function Ie(Ve,et,_t){var at=_t;return he(Ve,function(gt,X,pe,Ce,Le){X===0&&_t===void 0?at=gt:at=et(at,gt,X,pe,Ce,Le)}),at}function Me(Ve,et){he(Ve,function(_t,at,gt,X,pe){var Ce=_t===null?null:_t.type;switch(Ce){case null:case"Point":case"LineString":case"Polygon":return et(l.feature(_t,gt,{bbox:X,id:pe}),at,0)===!1?!1:void 0}var Le;switch(Ce){case"MultiPoint":Le="Point";break;case"MultiLineString":Le="LineString";break;case"MultiPolygon":Le="Polygon";break}for(var ke=0;ke<_t.coordinates.length;ke++){var Se=_t.coordinates[ke],Ye={type:Le,coordinates:Se};if(et(l.feature(Ye,gt),at,ke)===!1)return!1}})}function rt(Ve,et,_t){var at=_t;return Me(Ve,function(gt,X,pe){X===0&&pe===0&&_t===void 0?at=gt:at=et(at,gt,X,pe)}),at}function pt(Ve,et){Me(Ve,function(_t,at,gt){var X=0;if(_t.geometry){var pe=_t.geometry.type;if(!(pe==="Point"||pe==="MultiPoint")){var Ce,Le=0,ke=0,Se=0;if(h(_t,function(Ye,We,tt,dt,ht){if(Ce===void 0||at>Le||dt>ke||ht>Se){Ce=Ye,Le=at,ke=dt,Se=ht,X=0;return}var It=l.lineString([Ce,Ye],_t.properties);if(et(It,at,gt,ht,X)===!1)return!1;X++,Ce=Ye})===!1)return!1}}})}function Dt(Ve,et,_t){var at=_t,gt=!1;return pt(Ve,function(X,pe,Ce,Le,ke){gt===!1&&_t===void 0?at=X:at=et(at,X,pe,Ce,Le,ke),gt=!0}),at}function Vt(Ve,et){if(!Ve)throw new Error("geojson is required");Me(Ve,function(_t,at,gt){if(_t.geometry!==null){var X=_t.geometry.type,pe=_t.geometry.coordinates;switch(X){case"LineString":if(et(_t,at,gt,0,0)===!1)return!1;break;case"Polygon":for(var Ce=0;Ce<pe.length;Ce++)if(et(l.lineString(pe[Ce],_t.properties),at,gt,Ce)===!1)return!1;break}}})}function Ht(Ve,et,_t){var at=_t;return Vt(Ve,function(gt,X,pe,Ce){X===0&&_t===void 0?at=gt:at=et(at,gt,X,pe,Ce)}),at}function wn(Ve,et){if(et=et||{},!l.isObject(et))throw new Error("options is invalid");var _t=et.featureIndex||0,at=et.multiFeatureIndex||0,gt=et.geometryIndex||0,X=et.segmentIndex||0,pe=et.properties,Ce;switch(Ve.type){case"FeatureCollection":_t<0&&(_t=Ve.features.length+_t),pe=pe||Ve.features[_t].properties,Ce=Ve.features[_t].geometry;break;case"Feature":pe=pe||Ve.properties,Ce=Ve.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":Ce=Ve;break;default:throw new Error("geojson is invalid")}if(Ce===null)return null;var Le=Ce.coordinates;switch(Ce.type){case"Point":case"MultiPoint":return null;case"LineString":return X<0&&(X=Le.length+X-1),l.lineString([Le[X],Le[X+1]],pe,et);case"Polygon":return gt<0&&(gt=Le.length+gt),X<0&&(X=Le[gt].length+X-1),l.lineString([Le[gt][X],Le[gt][X+1]],pe,et);case"MultiLineString":return at<0&&(at=Le.length+at),X<0&&(X=Le[at].length+X-1),l.lineString([Le[at][X],Le[at][X+1]],pe,et);case"MultiPolygon":return at<0&&(at=Le.length+at),gt<0&&(gt=Le[at].length+gt),X<0&&(X=Le[at][gt].length-X-1),l.lineString([Le[at][gt][X],Le[at][gt][X+1]],pe,et)}throw new Error("geojson is invalid")}function Re(Ve,et){if(et=et||{},!l.isObject(et))throw new Error("options is invalid");var _t=et.featureIndex||0,at=et.multiFeatureIndex||0,gt=et.geometryIndex||0,X=et.coordIndex||0,pe=et.properties,Ce;switch(Ve.type){case"FeatureCollection":_t<0&&(_t=Ve.features.length+_t),pe=pe||Ve.features[_t].properties,Ce=Ve.features[_t].geometry;break;case"Feature":pe=pe||Ve.properties,Ce=Ve.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":Ce=Ve;break;default:throw new Error("geojson is invalid")}if(Ce===null)return null;var Le=Ce.coordinates;switch(Ce.type){case"Point":return l.point(Le,pe,et);case"MultiPoint":return at<0&&(at=Le.length+at),l.point(Le[at],pe,et);case"LineString":return X<0&&(X=Le.length+X),l.point(Le[X],pe,et);case"Polygon":return gt<0&&(gt=Le.length+gt),X<0&&(X=Le[gt].length+X),l.point(Le[gt][X],pe,et);case"MultiLineString":return at<0&&(at=Le.length+at),X<0&&(X=Le[at].length+X),l.point(Le[at][X],pe,et);case"MultiPolygon":return at<0&&(at=Le.length+at),gt<0&&(gt=Le[at].length+gt),X<0&&(X=Le[at][gt].length-X),l.point(Le[at][gt][X],pe,et)}throw new Error("geojson is invalid")}s.coordAll=W,s.coordEach=h,s.coordReduce=g,s.featureEach=B,s.featureReduce=R,s.findPoint=Re,s.findSegment=wn,s.flattenEach=Me,s.flattenReduce=rt,s.geomEach=he,s.geomReduce=Ie,s.lineEach=Vt,s.lineReduce=Ht,s.propEach=_,s.propReduce=E,s.segmentEach=pt,s.segmentReduce=Dt}),Hr=u(s=>{Object.defineProperty(s,"__esModule",{value:!0});var l=fs();function h(g){var _=[1/0,1/0,-1/0,-1/0];return l.coordEach(g,function(E){_[0]>E[0]&&(_[0]=E[0]),_[1]>E[1]&&(_[1]=E[1]),_[2]<E[0]&&(_[2]=E[0]),_[3]<E[1]&&(_[3]=E[1])}),_}h.default=h,s.default=h}),zr=u((s,l)=>{var h=Fn(),g=_n(),_=fs(),E=Hr().default,B=_.featureEach;_.coordEach,g.polygon;var R=g.featureCollection;function W(he){var Ie=new h(he);return Ie.insert=function(Me){if(Me.type!=="Feature")throw new Error("invalid feature");return Me.bbox=Me.bbox?Me.bbox:E(Me),h.prototype.insert.call(this,Me)},Ie.load=function(Me){var rt=[];return Array.isArray(Me)?Me.forEach(function(pt){if(pt.type!=="Feature")throw new Error("invalid features");pt.bbox=pt.bbox?pt.bbox:E(pt),rt.push(pt)}):B(Me,function(pt){if(pt.type!=="Feature")throw new Error("invalid features");pt.bbox=pt.bbox?pt.bbox:E(pt),rt.push(pt)}),h.prototype.load.call(this,rt)},Ie.remove=function(Me,rt){if(Me.type!=="Feature")throw new Error("invalid feature");return Me.bbox=Me.bbox?Me.bbox:E(Me),h.prototype.remove.call(this,Me,rt)},Ie.clear=function(){return h.prototype.clear.call(this)},Ie.search=function(Me){var rt=h.prototype.search.call(this,this.toBBox(Me));return R(rt)},Ie.collides=function(Me){return h.prototype.collides.call(this,this.toBBox(Me))},Ie.all=function(){var Me=h.prototype.all.call(this);return R(Me)},Ie.toJSON=function(){return h.prototype.toJSON.call(this)},Ie.fromJSON=function(Me){return h.prototype.fromJSON.call(this,Me)},Ie.toBBox=function(Me){var rt;if(Me.bbox)rt=Me.bbox;else if(Array.isArray(Me)&&Me.length===4)rt=Me;else if(Array.isArray(Me)&&Me.length===6)rt=[Me[0],Me[1],Me[3],Me[4]];else if(Me.type==="Feature")rt=E(Me);else if(Me.type==="FeatureCollection")rt=E(Me);else throw new Error("invalid geojson");return{minX:rt[0],minY:rt[1],maxX:rt[2],maxY:rt[3]}},Ie}l.exports=W,l.exports.default=W});Array.prototype.findIndex=Array.prototype.findIndex||function(s){if(this===null)throw new TypeError("Array.prototype.findIndex called on null or undefined");if(typeof s!="function")throw new TypeError("callback must be a function");for(var l=Object(this),h=l.length>>>0,g=arguments[1],_=0;_<h;_++)if(s.call(g,l[_],_,l))return _;return-1},Array.prototype.find=Array.prototype.find||function(s){if(this===null)throw new TypeError("Array.prototype.find called on null or undefined");if(typeof s!="function")throw new TypeError("callback must be a function");for(var l=Object(this),h=l.length>>>0,g=arguments[1],_=0;_<h;_++){var E=l[_];if(s.call(g,E,_,l))return E}},typeof Object.assign!="function"&&(Object.assign=function(s){if(s==null)throw new TypeError("Cannot convert undefined or null to object");s=Object(s);for(var l=1;l<arguments.length;l++){var h=arguments[l];if(h!=null)for(var g in h)Object.prototype.hasOwnProperty.call(h,g)&&(s[g]=h[g])}return s}),function(s){s.forEach(function(l){l.hasOwnProperty("remove")||Object.defineProperty(l,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function(){this.parentNode.removeChild(this)}})})}([Element.prototype,CharacterData.prototype,DocumentType.prototype]),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(s,l){if(this==null)throw new TypeError('"this" is null or not defined');var h=Object(this),g=h.length>>>0;if(g===0)return!1;var _=l|0,E=Math.max(_>=0?_:g-Math.abs(_),0);function B(R,W){return R===W||typeof R=="number"&&typeof W=="number"&&isNaN(R)&&isNaN(W)}for(;E<g;){if(B(h[E],s))return!0;E++}return!1}});var Ts={version:"2.18.3"},xn=f(Gr()),Hn={tooltips:{placeMarker:"Click to place marker",firstVertex:"Click to place first vertex",continueLine:"Click to continue drawing",finishLine:"Click any existing marker to finish",finishPoly:"Click first marker to finish",finishRect:"Click to finish",startCircle:"Click to place circle center",finishCircle:"Click to finish circle",placeCircleMarker:"Click to place circle marker",placeText:"Click to place text",selectFirstLayerFor:"Select first layer for {action}",selectSecondLayerFor:"Select second layer for {action}"},actions:{finish:"Finish",cancel:"Cancel",removeLastVertex:"Remove Last Vertex"},buttonTitles:{drawMarkerButton:"Draw Marker",drawPolyButton:"Draw Polygons",drawLineButton:"Draw Polyline",drawCircleButton:"Draw Circle",drawRectButton:"Draw Rectangle",editButton:"Edit Layers",dragButton:"Drag Layers",cutButton:"Cut Layers",deleteButton:"Remove Layers",drawCircleMarkerButton:"Draw Circle Marker",snappingButton:"Snap dragged marker to other layers and vertices",pinningButton:"Pin shared vertices together",rotateButton:"Rotate Layers",drawTextButton:"Draw Text",scaleButton:"Scale Layers",autoTracingButton:"Auto trace Line",snapGuidesButton:"Show SnapGuides",unionButton:"Union layers",differenceButton:"Subtract layers"},measurements:{totalLength:"Length",segmentLength:"Segment length",area:"Area",radius:"Radius",perimeter:"Perimeter",height:"Height",width:"Width",coordinates:"Position",coordinatesMarker:"Position Marker"}},Ei={tooltips:{placeMarker:"Platziere den Marker mit Klick",firstVertex:"Platziere den ersten Marker mit Klick",continueLine:"Klicke, um weiter zu zeichnen",finishLine:"Beende mit Klick auf existierenden Marker",finishPoly:"Beende mit Klick auf ersten Marker",finishRect:"Beende mit Klick",startCircle:"Platziere das Kreiszentrum mit Klick",finishCircle:"Beende den Kreis mit Klick",placeCircleMarker:"Platziere den Kreismarker mit Klick",placeText:"Platziere den Text mit Klick"},actions:{finish:"Beenden",cancel:"Abbrechen",removeLastVertex:"Letzten Vertex löschen"},buttonTitles:{drawMarkerButton:"Marker zeichnen",drawPolyButton:"Polygon zeichnen",drawLineButton:"Polyline zeichnen",drawCircleButton:"Kreis zeichnen",drawRectButton:"Rechteck zeichnen",editButton:"Layer editieren",dragButton:"Layer bewegen",cutButton:"Layer schneiden",deleteButton:"Layer löschen",drawCircleMarkerButton:"Kreismarker zeichnen",snappingButton:"Bewegter Layer an andere Layer oder Vertexe einhacken",pinningButton:"Vertexe an der gleichen Position verknüpfen",rotateButton:"Layer drehen",drawTextButton:"Text zeichnen",scaleButton:"Layer skalieren",autoTracingButton:"Linie automatisch nachzeichen"},measurements:{totalLength:"Länge",segmentLength:"Segment Länge",area:"Fläche",radius:"Radius",perimeter:"Umfang",height:"Höhe",width:"Breite",coordinates:"Position",coordinatesMarker:"Position Marker"}},Wn={tooltips:{placeMarker:"Clicca per posizionare un Marker",firstVertex:"Clicca per posizionare il primo vertice",continueLine:"Clicca per continuare a disegnare",finishLine:"Clicca qualsiasi marker esistente per terminare",finishPoly:"Clicca il primo marker per terminare",finishRect:"Clicca per terminare",startCircle:"Clicca per posizionare il punto centrale del cerchio",finishCircle:"Clicca per terminare il cerchio",placeCircleMarker:"Clicca per posizionare un Marker del cherchio"},actions:{finish:"Termina",cancel:"Annulla",removeLastVertex:"Rimuovi l'ultimo vertice"},buttonTitles:{drawMarkerButton:"Disegna Marker",drawPolyButton:"Disegna Poligoni",drawLineButton:"Disegna Polilinea",drawCircleButton:"Disegna Cerchio",drawRectButton:"Disegna Rettangolo",editButton:"Modifica Livelli",dragButton:"Sposta Livelli",cutButton:"Ritaglia Livelli",deleteButton:"Elimina Livelli",drawCircleMarkerButton:"Disegna Marker del Cerchio",snappingButton:"Snap ha trascinato il pennarello su altri strati e vertici",pinningButton:"Pin condiviso vertici insieme",rotateButton:"Ruota livello"}},Qn={tooltips:{placeMarker:"Klik untuk menempatkan marker",firstVertex:"Klik untuk menempatkan vertex pertama",continueLine:"Klik untuk meneruskan digitasi",finishLine:"Klik pada sembarang marker yang ada untuk mengakhiri",finishPoly:"Klik marker pertama untuk mengakhiri",finishRect:"Klik untuk mengakhiri",startCircle:"Klik untuk menempatkan titik pusat lingkaran",finishCircle:"Klik untuk mengakhiri lingkaran",placeCircleMarker:"Klik untuk menempatkan penanda lingkarann"},actions:{finish:"Selesai",cancel:"Batal",removeLastVertex:"Hilangkan Vertex Terakhir"},buttonTitles:{drawMarkerButton:"Digitasi Marker",drawPolyButton:"Digitasi Polygon",drawLineButton:"Digitasi Polyline",drawCircleButton:"Digitasi Lingkaran",drawRectButton:"Digitasi Segi Empat",editButton:"Edit Layer",dragButton:"Geser Layer",cutButton:"Potong Layer",deleteButton:"Hilangkan Layer",drawCircleMarkerButton:"Digitasi Penanda Lingkaran",snappingButton:"Jepretkan penanda yang ditarik ke lapisan dan simpul lain",pinningButton:"Sematkan simpul bersama bersama",rotateButton:"Putar lapisan"}},ci={tooltips:{placeMarker:"Adaugă un punct",firstVertex:"Apasă aici pentru a adăuga primul Vertex",continueLine:"Apasă aici pentru a continua desenul",finishLine:"Apasă pe orice obiect pentru a finisa desenul",finishPoly:"Apasă pe primul obiect pentru a finisa",finishRect:"Apasă pentru a finisa",startCircle:"Apasă pentru a desena un cerc",finishCircle:"Apasă pentru a finisa un cerc",placeCircleMarker:"Adaugă un punct"},actions:{finish:"Termină",cancel:"Anulează",removeLastVertex:"Șterge ultimul Vertex"},buttonTitles:{drawMarkerButton:"Adaugă o bulină",drawPolyButton:"Desenează un poligon",drawLineButton:"Desenează o linie",drawCircleButton:"Desenează un cerc",drawRectButton:"Desenează un dreptunghi",editButton:"Editează straturile",dragButton:"Mută straturile",cutButton:"Taie straturile",deleteButton:"Șterge straturile",drawCircleMarkerButton:"Desenează marcatorul cercului",snappingButton:"Fixați marcatorul glisat pe alte straturi și vârfuri",pinningButton:"Fixați vârfurile partajate împreună",rotateButton:"Rotiți stratul"}},ps={tooltips:{placeMarker:"Нажмите, чтобы нанести маркер",firstVertex:"Нажмите, чтобы нанести первый объект",continueLine:"Нажмите, чтобы продолжить рисование",finishLine:"Нажмите любой существующий маркер для завершения",finishPoly:"Выберите первую точку, чтобы закончить",finishRect:"Нажмите, чтобы закончить",startCircle:"Нажмите, чтобы добавить центр круга",finishCircle:"Нажмите, чтобы задать радиус",placeCircleMarker:"Нажмите, чтобы нанести круговой маркер"},actions:{finish:"Завершить",cancel:"Отменить",removeLastVertex:"Отменить последнее действие"},buttonTitles:{drawMarkerButton:"Добавить маркер",drawPolyButton:"Рисовать полигон",drawLineButton:"Рисовать кривую",drawCircleButton:"Рисовать круг",drawRectButton:"Рисовать прямоугольник",editButton:"Редактировать слой",dragButton:"Перенести слой",cutButton:"Вырезать слой",deleteButton:"Удалить слой",drawCircleMarkerButton:"Добавить круговой маркер",snappingButton:"Привязать перетаскиваемый маркер к другим слоям и вершинам",pinningButton:"Связать общие точки вместе",rotateButton:"Поворот слоя"}},Wr={tooltips:{placeMarker:"Presiona para colocar un marcador",firstVertex:"Presiona para colocar el primer vértice",continueLine:"Presiona para continuar dibujando",finishLine:"Presiona cualquier marcador existente para finalizar",finishPoly:"Presiona el primer marcador para finalizar",finishRect:"Presiona para finalizar",startCircle:"Presiona para colocar el centro del círculo",finishCircle:"Presiona para finalizar el círculo",placeCircleMarker:"Presiona para colocar un marcador de círculo"},actions:{finish:"Finalizar",cancel:"Cancelar",removeLastVertex:"Eliminar último vértice"},buttonTitles:{drawMarkerButton:"Dibujar Marcador",drawPolyButton:"Dibujar Polígono",drawLineButton:"Dibujar Línea",drawCircleButton:"Dibujar Círculo",drawRectButton:"Dibujar Rectángulo",editButton:"Editar Capas",dragButton:"Arrastrar Capas",cutButton:"Cortar Capas",deleteButton:"Eliminar Capas",drawCircleMarkerButton:"Dibujar Marcador de Círculo",snappingButton:"El marcador de Snap arrastrado a otras capas y vértices",pinningButton:"Fijar juntos los vértices compartidos",rotateButton:"Rotar capa"}},_i={tooltips:{placeMarker:"Klik om een marker te plaatsen",firstVertex:"Klik om het eerste punt te plaatsen",continueLine:"Klik om te blijven tekenen",finishLine:"Klik op een bestaand punt om te beëindigen",finishPoly:"Klik op het eerst punt om te beëindigen",finishRect:"Klik om te beëindigen",startCircle:"Klik om het middelpunt te plaatsen",finishCircle:"Klik om de cirkel te beëindigen",placeCircleMarker:"Klik om een marker te plaatsen"},actions:{finish:"Bewaar",cancel:"Annuleer",removeLastVertex:"Verwijder laatste punt"},buttonTitles:{drawMarkerButton:"Plaats Marker",drawPolyButton:"Teken een vlak",drawLineButton:"Teken een lijn",drawCircleButton:"Teken een cirkel",drawRectButton:"Teken een vierkant",editButton:"Bewerk",dragButton:"Verplaats",cutButton:"Knip",deleteButton:"Verwijder",drawCircleMarkerButton:"Plaats Marker",snappingButton:"Snap gesleepte marker naar andere lagen en hoekpunten",pinningButton:"Speld gedeelde hoekpunten samen",rotateButton:"Laag roteren"}},Ns={tooltips:{placeMarker:"Cliquez pour placer un marqueur",firstVertex:"Cliquez pour placer le premier sommet",continueLine:"Cliquez pour continuer à dessiner",finishLine:"Cliquez sur n'importe quel marqueur pour terminer",finishPoly:"Cliquez sur le premier marqueur pour terminer",finishRect:"Cliquez pour terminer",startCircle:"Cliquez pour placer le centre du cercle",finishCircle:"Cliquez pour finir le cercle",placeCircleMarker:"Cliquez pour placer le marqueur circulaire"},actions:{finish:"Terminer",cancel:"Annuler",removeLastVertex:"Retirer le dernier sommet"},buttonTitles:{drawMarkerButton:"Placer des marqueurs",drawPolyButton:"Dessiner des polygones",drawLineButton:"Dessiner des polylignes",drawCircleButton:"Dessiner un cercle",drawRectButton:"Dessiner un rectangle",editButton:"Éditer des calques",dragButton:"Déplacer des calques",cutButton:"Couper des calques",deleteButton:"Supprimer des calques",drawCircleMarkerButton:"Dessiner un marqueur circulaire",snappingButton:"Glisser le marqueur vers d'autres couches et sommets",pinningButton:"Épingler ensemble les sommets partagés",rotateButton:"Tourner des calques"}},jo={tooltips:{placeMarker:"单击放置标记",firstVertex:"单击放置首个顶点",continueLine:"单击继续绘制",finishLine:"单击任何存在的标记以完成",finishPoly:"单击第一个标记以完成",finishRect:"单击完成",startCircle:"单击放置圆心",finishCircle:"单击完成圆形",placeCircleMarker:"点击放置圆形标记"},actions:{finish:"完成",cancel:"取消",removeLastVertex:"移除最后的顶点"},buttonTitles:{drawMarkerButton:"绘制标记",drawPolyButton:"绘制多边形",drawLineButton:"绘制线段",drawCircleButton:"绘制圆形",drawRectButton:"绘制长方形",editButton:"编辑图层",dragButton:"拖拽图层",cutButton:"剪切图层",deleteButton:"删除图层",drawCircleMarkerButton:"画圆圈标记",snappingButton:"将拖动的标记捕捉到其他图层和顶点",pinningButton:"将共享顶点固定在一起",rotateButton:"旋转图层"}},Js={tooltips:{placeMarker:"單擊放置標記",firstVertex:"單擊放置第一個頂點",continueLine:"單擊繼續繪製",finishLine:"單擊任何存在的標記以完成",finishPoly:"單擊第一個標記以完成",finishRect:"單擊完成",startCircle:"單擊放置圓心",finishCircle:"單擊完成圓形",placeCircleMarker:"點擊放置圓形標記"},actions:{finish:"完成",cancel:"取消",removeLastVertex:"移除最後一個頂點"},buttonTitles:{drawMarkerButton:"放置標記",drawPolyButton:"繪製多邊形",drawLineButton:"繪製線段",drawCircleButton:"繪製圓形",drawRectButton:"繪製方形",editButton:"編輯圖形",dragButton:"移動圖形",cutButton:"裁切圖形",deleteButton:"刪除圖形",drawCircleMarkerButton:"畫圓圈標記",snappingButton:"將拖動的標記對齊到其他圖層和頂點",pinningButton:"將共享頂點固定在一起",rotateButton:"旋轉圖形"}},Da={tooltips:{placeMarker:"Clique para posicionar o marcador",firstVertex:"Clique para posicionar o primeiro vértice",continueLine:"Clique para continuar desenhando",finishLine:"Clique em qualquer marcador existente para finalizar",finishPoly:"Clique no primeiro marcador para finalizar",finishRect:"Clique para finalizar",startCircle:"Clique para posicionar o centro do círculo",finishCircle:"Clique para finalizar o círculo",placeCircleMarker:"Clique para posicionar o marcador circular",placeText:"Clique para inserir texto"},actions:{finish:"Finalizar",cancel:"Cancelar",removeLastVertex:"Remover último vértice"},buttonTitles:{drawMarkerButton:"Desenhar Marcador",drawPolyButton:"Desenhar Polígonos",drawLineButton:"Desenhar Linha Poligonal",drawCircleButton:"Desenhar Círculo",drawRectButton:"Desenhar Retângulo",editButton:"Editar Camadas",dragButton:"Arrastar Camadas",cutButton:"Recortar Camadas",deleteButton:"Remover Camadas",drawCircleMarkerButton:"Desenhar Marcador de Círculo",snappingButton:"Ajustar marcador arrastado a outras camadas e vértices",pinningButton:"Unir vértices compartilhados",rotateButton:"Rotacionar Camadas",drawTextButton:"Desenhar Texto",scaleButton:"Redimensionar Camadas",autoTracingButton:"Traçado Automático de Linha"},measurements:{totalLength:"Comprimento",segmentLength:"Comprimento do Segmento",area:"Área",radius:"Raio",perimeter:"Perímetro",height:"Altura",width:"Largura",coordinates:"Posição",coordinatesMarker:"Marcador de Posição"}},mo={tooltips:{placeMarker:"Clique para colocar marcador",firstVertex:"Clique para colocar primeiro vértice",continueLine:"Clique para continuar a desenhar",finishLine:"Clique num marcador existente para terminar",finishPoly:"Clique no primeiro marcador para terminar",finishRect:"Clique para terminar",startCircle:"Clique para colocar o centro do círculo",finishCircle:"Clique para terminar o círculo",placeCircleMarker:"Clique para colocar marcador de círculo",placeText:"Clique para colocar texto"},actions:{finish:"Terminar",cancel:"Cancelar",removeLastVertex:"Remover Último Vértice"},buttonTitles:{drawMarkerButton:"Desenhar Marcador",drawPolyButton:"Desenhar Polígonos",drawLineButton:"Desenhar Polilinha",drawCircleButton:"Desenhar Círculo",drawRectButton:"Desenhar Retângulo",editButton:"Editar Camadas",dragButton:"Arrastar Camadas",cutButton:"Cortar Camadas",deleteButton:"Remover Camadas",drawCircleMarkerButton:"Desenhar Marcador de Círculo",snappingButton:"Ajustar marcador arrastado a outras camadas e vértices",pinningButton:"Unir vértices partilhados",rotateButton:"Rodar Camadas",drawTextButton:"Desenhar Texto",scaleButton:"Escalar Camadas",autoTracingButton:"Traçado Automático de Linha"},measurements:{totalLength:"Comprimento",segmentLength:"Comprimento do Segmento",area:"Área",radius:"Raio",perimeter:"Perímetro",height:"Altura",width:"Largura",coordinates:"Posição",coordinatesMarker:"Marcador de Posição"}},Ra={tooltips:{placeMarker:"Kliknij, aby umieścić znacznik",firstVertex:"Kliknij, aby umieścić pierwszy wierzchołek",continueLine:"Kliknij, aby kontynuować rysowanie",finishLine:"Kliknij dowolny istniejący znacznik, aby zakończyć",finishPoly:"Kliknij pierwszy znacznik, aby zakończyć",finishRect:"Kliknij, aby zakończyć",startCircle:"Kliknij, aby umieścić środek okręgu",finishCircle:"Kliknij, aby zakończyć okrąg",placeCircleMarker:"Kliknij, aby umieścić znacznik okręgu",placeText:"Kliknij, aby umieścić tekst"},actions:{finish:"Zakończ",cancel:"Anuluj",removeLastVertex:"Usuń ostatni wierzchołek"},buttonTitles:{drawMarkerButton:"Rysuj znacznik",drawPolyButton:"Rysuj wielokąt",drawLineButton:"Rysuj linię",drawCircleButton:"Rysuj okrąg",drawRectButton:"Rysuj prostokąt",editButton:"Edytuj warstwy",dragButton:"Przeciągnij warstwy",cutButton:"Wytnij warstwy",deleteButton:"Usuń warstwy",drawCircleMarkerButton:"Rysuj znacznik okrągły",snappingButton:"Przyciągnij przenoszony znacznik do innych warstw i wierzchołków",pinningButton:"Przypnij wspólne wierzchołki razem",rotateButton:"Obróć warstwy",drawTextButton:"Rysuj tekst",scaleButton:"Skaluj warstwy",autoTracingButton:"Automatyczne śledzenie linii"},measurements:{totalLength:"Długość",segmentLength:"Długość odcinka",area:"Obszar",radius:"Promień",perimeter:"Obwód",height:"Wysokość",width:"Szerokość",coordinates:"Pozycja",coordinatesMarker:"Znacznik pozycji"}},gs={tooltips:{placeMarker:"Klicka för att placera markör",firstVertex:"Klicka för att placera första hörnet",continueLine:"Klicka för att fortsätta rita",finishLine:"Klicka på en existerande punkt för att slutföra",finishPoly:"Klicka på den första punkten för att slutföra",finishRect:"Klicka för att slutföra",startCircle:"Klicka för att placera cirkelns centrum",finishCircle:"Klicka för att slutföra cirkeln",placeCircleMarker:"Klicka för att placera cirkelmarkör"},actions:{finish:"Slutför",cancel:"Avbryt",removeLastVertex:"Ta bort sista hörnet"},buttonTitles:{drawMarkerButton:"Rita Markör",drawPolyButton:"Rita Polygoner",drawLineButton:"Rita Linje",drawCircleButton:"Rita Cirkel",drawRectButton:"Rita Rektangel",editButton:"Redigera Lager",dragButton:"Dra Lager",cutButton:"Klipp i Lager",deleteButton:"Ta bort Lager",drawCircleMarkerButton:"Rita Cirkelmarkör",snappingButton:"Snäpp dra markören till andra lager och hörn",pinningButton:"Fäst delade hörn tillsammans",rotateButton:"Rotera lagret"}},Xs={tooltips:{placeMarker:"Κάντε κλικ για να τοποθετήσετε Δείκτη",firstVertex:"Κάντε κλικ για να τοποθετήσετε το πρώτο σημείο",continueLine:"Κάντε κλικ για να συνεχίσετε να σχεδιάζετε",finishLine:"Κάντε κλικ σε οποιονδήποτε υπάρχον σημείο για να ολοκληρωθεί",finishPoly:"Κάντε κλικ στο πρώτο σημείο για να τελειώσετε",finishRect:"Κάντε κλικ για να τελειώσετε",startCircle:"Κάντε κλικ για να τοποθετήσετε κέντρο Κύκλου",finishCircle:"Κάντε κλικ για να ολοκληρώσετε τον Κύκλο",placeCircleMarker:"Κάντε κλικ για να τοποθετήσετε Κυκλικό Δείκτη"},actions:{finish:"Τέλος",cancel:"Ακύρωση",removeLastVertex:"Κατάργηση τελευταίου σημείου"},buttonTitles:{drawMarkerButton:"Σχεδίαση Δείκτη",drawPolyButton:"Σχεδίαση Πολυγώνου",drawLineButton:"Σχεδίαση Γραμμής",drawCircleButton:"Σχεδίαση Κύκλου",drawRectButton:"Σχεδίαση Ορθογωνίου",editButton:"Επεξεργασία Επιπέδων",dragButton:"Μεταφορά Επιπέδων",cutButton:"Αποκοπή Επιπέδων",deleteButton:"Κατάργηση Επιπέδων",drawCircleMarkerButton:"Σχεδίαση Κυκλικού Δείκτη",snappingButton:"Προσκόλληση του Δείκτη μεταφοράς σε άλλα Επίπεδα και Κορυφές",pinningButton:"Περικοπή κοινών κορυφών μαζί",rotateButton:"Περιστρέψτε το στρώμα"}},vo={tooltips:{placeMarker:"Kattintson a jelölő elhelyezéséhez",firstVertex:"Kattintson az első pont elhelyezéséhez",continueLine:"Kattintson a következő pont elhelyezéséhez",finishLine:"A befejezéshez kattintson egy meglévő pontra",finishPoly:"A befejezéshez kattintson az első pontra",finishRect:"Kattintson a befejezéshez",startCircle:"Kattintson a kör középpontjának elhelyezéséhez",finishCircle:"Kattintson a kör befejezéséhez",placeCircleMarker:"Kattintson a körjelölő elhelyezéséhez"},actions:{finish:"Befejezés",cancel:"Mégse",removeLastVertex:"Utolsó pont eltávolítása"},buttonTitles:{drawMarkerButton:"Jelölő rajzolása",drawPolyButton:"Poligon rajzolása",drawLineButton:"Vonal rajzolása",drawCircleButton:"Kör rajzolása",drawRectButton:"Négyzet rajzolása",editButton:"Elemek szerkesztése",dragButton:"Elemek mozgatása",cutButton:"Elemek vágása",deleteButton:"Elemek törlése",drawCircleMarkerButton:"Kör jelölő rajzolása",snappingButton:"Kapcsolja a jelöltőt másik elemhez vagy ponthoz",pinningButton:"Közös pontok összekötése",rotateButton:"Fólia elforgatása"}},da={tooltips:{placeMarker:"Tryk for at placere en markør",firstVertex:"Tryk for at placere det første punkt",continueLine:"Tryk for at fortsætte linjen",finishLine:"Tryk på et eksisterende punkt for at afslutte",finishPoly:"Tryk på det første punkt for at afslutte",finishRect:"Tryk for at afslutte",startCircle:"Tryk for at placere cirklens center",finishCircle:"Tryk for at afslutte cirklen",placeCircleMarker:"Tryk for at placere en cirkelmarkør"},actions:{finish:"Afslut",cancel:"Afbryd",removeLastVertex:"Fjern sidste punkt"},buttonTitles:{drawMarkerButton:"Placer markør",drawPolyButton:"Tegn polygon",drawLineButton:"Tegn linje",drawCircleButton:"Tegn cirkel",drawRectButton:"Tegn firkant",editButton:"Rediger",dragButton:"Træk",cutButton:"Klip",deleteButton:"Fjern",drawCircleMarkerButton:"Tegn cirkelmarkør",snappingButton:"Fastgør trukket markør til andre elementer",pinningButton:"Sammenlæg delte elementer",rotateButton:"Roter laget"}},$i={tooltips:{placeMarker:"Klikk for å plassere punkt",firstVertex:"Klikk for å plassere første punkt",continueLine:"Klikk for å tegne videre",finishLine:"Klikk på et eksisterende punkt for å fullføre",finishPoly:"Klikk første punkt for å fullføre",finishRect:"Klikk for å fullføre",startCircle:"Klikk for å sette sirkel midtpunkt",finishCircle:"Klikk for å fullføre sirkel",placeCircleMarker:"Klikk for å plassere sirkel",placeText:"Klikk for å plassere tekst"},actions:{finish:"Fullfør",cancel:"Kanseller",removeLastVertex:"Fjern forrige punkt"},buttonTitles:{drawMarkerButton:"Tegn punkt",drawPolyButton:"Tegn flate",drawLineButton:"Tegn linje",drawCircleButton:"Tegn sirkel",drawRectButton:"Tegn rektangel",editButton:"Rediger objekter",dragButton:"Dra objekter",cutButton:"Kutt objekter",deleteButton:"Fjern objekter",drawCircleMarkerButton:"Tegn sirkel-punkt",snappingButton:"Fest dratt punkt til andre objekter og punkt",pinningButton:"Pin delte punkter sammen",rotateButton:"Rotér objekter",drawTextButton:"Tegn tekst",scaleButton:"Skalér objekter",autoTracingButton:"Automatisk sporing av linje"},measurements:{totalLength:"Lengde",segmentLength:"Segmentlengde",area:"Område",radius:"Radius",perimeter:"Omriss",height:"Høyde",width:"Bredde",coordinates:"Posisjon",coordinatesMarker:"Posisjonsmarkør"}},sl={tooltips:{placeMarker:"کلیک برای جانمایی نشان",firstVertex:"کلیک برای رسم اولین رأس",continueLine:"کلیک برای ادامه رسم",finishLine:"کلیک روی هر نشان موجود برای پایان",finishPoly:"کلیک روی اولین نشان برای پایان",finishRect:"کلیک برای پایان",startCircle:"کلیک برای رسم مرکز دایره",finishCircle:"کلیک برای پایان رسم دایره",placeCircleMarker:"کلیک برای رسم نشان دایره",placeText:"کلیک برای نوشتن متن"},actions:{finish:"پایان",cancel:"لفو",removeLastVertex:"حذف آخرین رأس"},buttonTitles:{drawMarkerButton:"درج نشان",drawPolyButton:"رسم چندضلعی",drawLineButton:"رسم خط",drawCircleButton:"رسم دایره",drawRectButton:"رسم چهارضلعی",editButton:"ویرایش لایه‌ها",dragButton:"جابجایی لایه‌ها",cutButton:"برش لایه‌ها",deleteButton:"حذف لایه‌ها",drawCircleMarkerButton:"رسم نشان دایره",snappingButton:"نشانگر را به لایه‌ها و رئوس دیگر بکشید",pinningButton:"رئوس مشترک را با هم پین کنید",rotateButton:"چرخش لایه",drawTextButton:"رسم متن",scaleButton:"مقیاس‌گذاری",autoTracingButton:"ردیاب خودکار"},measurements:{totalLength:"طول",segmentLength:"طول بخش",area:"ناحیه",radius:"شعاع",perimeter:"محیط",height:"ارتفاع",width:"عرض",coordinates:"موقعیت",coordinatesMarker:"موقعیت نشان"}},fa={tooltips:{placeMarker:"Натисніть, щоб нанести маркер",firstVertex:"Натисніть, щоб нанести першу вершину",continueLine:"Натисніть, щоб продовжити малювати",finishLine:"Натисніть будь-який існуючий маркер для завершення",finishPoly:"Виберіть перший маркер, щоб завершити",finishRect:"Натисніть, щоб завершити",startCircle:"Натисніть, щоб додати центр кола",finishCircle:"Натисніть, щоб завершити коло",placeCircleMarker:"Натисніть, щоб нанести круговий маркер"},actions:{finish:"Завершити",cancel:"Відмінити",removeLastVertex:"Видалити попередню вершину"},buttonTitles:{drawMarkerButton:"Малювати маркер",drawPolyButton:"Малювати полігон",drawLineButton:"Малювати криву",drawCircleButton:"Малювати коло",drawRectButton:"Малювати прямокутник",editButton:"Редагувати шари",dragButton:"Перенести шари",cutButton:"Вирізати шари",deleteButton:"Видалити шари",drawCircleMarkerButton:"Малювати круговий маркер",snappingButton:"Прив’язати перетягнутий маркер до інших шарів та вершин",pinningButton:"Зв'язати спільні вершини разом",rotateButton:"Повернути шар"}},kn={tooltips:{placeMarker:"İşaretçi yerleştirmek için tıklayın",firstVertex:"İlk tepe noktasını yerleştirmek için tıklayın",continueLine:"Çizime devam etmek için tıklayın",finishLine:"Bitirmek için mevcut herhangi bir işaretçiyi tıklayın",finishPoly:"Bitirmek için ilk işaretçiyi tıklayın",finishRect:"Bitirmek için tıklayın",startCircle:"Daire merkezine yerleştirmek için tıklayın",finishCircle:"Daireyi bitirmek için tıklayın",placeCircleMarker:"Daire işaretçisi yerleştirmek için tıklayın"},actions:{finish:"Bitir",cancel:"İptal",removeLastVertex:"Son köşeyi kaldır"},buttonTitles:{drawMarkerButton:"Çizim İşaretçisi",drawPolyButton:"Çokgenler çiz",drawLineButton:"Çoklu çizgi çiz",drawCircleButton:"Çember çiz",drawRectButton:"Dikdörtgen çiz",editButton:"Katmanları düzenle",dragButton:"Katmanları sürükle",cutButton:"Katmanları kes",deleteButton:"Katmanları kaldır",drawCircleMarkerButton:"Daire işaretçisi çiz",snappingButton:"Sürüklenen işaretçiyi diğer katmanlara ve köşelere yapıştır",pinningButton:"Paylaşılan köşeleri birbirine sabitle",rotateButton:"Katmanı döndür"}},An={tooltips:{placeMarker:"Kliknutím vytvoříte značku",firstVertex:"Kliknutím vytvoříte první objekt",continueLine:"Kliknutím pokračujte v kreslení",finishLine:"Kliknutí na libovolnou existující značku pro dokončení",finishPoly:"Vyberte první bod pro dokončení",finishRect:"Klikněte pro dokončení",startCircle:"Kliknutím přidejte střed kruhu",finishCircle:"Нажмите, чтобы задать радиус",placeCircleMarker:"Kliknutím nastavte poloměr"},actions:{finish:"Dokončit",cancel:"Zrušit",removeLastVertex:"Zrušit poslední akci"},buttonTitles:{drawMarkerButton:"Přidat značku",drawPolyButton:"Nakreslit polygon",drawLineButton:"Nakreslit křivku",drawCircleButton:"Nakreslit kruh",drawRectButton:"Nakreslit obdélník",editButton:"Upravit vrstvu",dragButton:"Přeneste vrstvu",cutButton:"Vyjmout vrstvu",deleteButton:"Smazat vrstvu",drawCircleMarkerButton:"Přidat kruhovou značku",snappingButton:"Navázat tažnou značku k dalším vrstvám a vrcholům",pinningButton:"Spojit společné body dohromady",rotateButton:"Otočte vrstvu"}},Zr={tooltips:{placeMarker:"クリックしてマーカーを配置",firstVertex:"クリックして最初の頂点を配置",continueLine:"クリックして描画を続ける",finishLine:"任意のマーカーをクリックして終了",finishPoly:"最初のマーカーをクリックして終了",finishRect:"クリックして終了",startCircle:"クリックして円の中心を配置",finishCircle:"クリックして円の描画を終了",placeCircleMarker:"クリックして円マーカーを配置",placeText:"クリックしてテキストを配置"},actions:{finish:"終了",cancel:"キャンセル",removeLastVertex:"最後の頂点を削除"},buttonTitles:{drawMarkerButton:"マーカーを描画",drawPolyButton:"ポリゴンを描画",drawLineButton:"折れ線を描画",drawCircleButton:"円を描画",drawRectButton:"矩形を描画",editButton:"レイヤーを編集",dragButton:"レイヤーをドラッグ",cutButton:"レイヤーを切り取り",deleteButton:"レイヤーを削除",drawCircleMarkerButton:"円マーカーを描画",snappingButton:"ドラッグしたマーカーを他のレイヤーや頂点にスナップする",pinningButton:"共有する頂点を同時に動かす",rotateButton:"レイヤーを回転",drawTextButton:"テキストを描画"}},Vn={tooltips:{placeMarker:"Klikkaa asettaaksesi merkin",firstVertex:"Klikkaa asettaakseni ensimmäisen osuuden",continueLine:"Klikkaa jatkaaksesi piirtämistä",finishLine:"Klikkaa olemassa olevaa merkkiä lopettaaksesi",finishPoly:"Klikkaa ensimmäistä merkkiä lopettaaksesi",finishRect:"Klikkaa lopettaaksesi",startCircle:"Klikkaa asettaaksesi ympyrän keskipisteen",finishCircle:"Klikkaa lopettaaksesi ympyrän",placeCircleMarker:"Klikkaa asettaaksesi ympyrämerkin",placeText:"Klikkaa asettaaksesi tekstin"},actions:{finish:"Valmis",cancel:"Peruuta",removeLastVertex:"Poista viimeinen osuus"},buttonTitles:{drawMarkerButton:"Piirrä merkkejä",drawPolyButton:"Piirrä monikulmioita",drawLineButton:"Piirrä viivoja",drawCircleButton:"Piirrä ympyrä",drawRectButton:"Piirrä neliskulmioita",editButton:"Muokkaa",dragButton:"Siirrä",cutButton:"Leikkaa",deleteButton:"Poista",drawCircleMarkerButton:"Piirrä ympyrämerkki",snappingButton:"Kiinnitä siirrettävä merkki toisiin muotoihin",pinningButton:"Kiinnitä jaetut muodot yhteen",rotateButton:"Käännä",drawTextButton:"Piirrä tekstiä"}},Oa={tooltips:{placeMarker:"마커 위치를 클릭하세요",firstVertex:"첫번째 꼭지점 위치을 클릭하세요",continueLine:"계속 그리려면 클릭하세요",finishLine:"끝내려면 기존 마커를 클릭하세요",finishPoly:"끝내려면 처음 마커를 클릭하세요",finishRect:"끝내려면 클릭하세요",startCircle:"원의 중심이 될 위치를 클릭하세요",finishCircle:"원을 끝내려면 클릭하세요",placeCircleMarker:"원 마커 위치를 클릭하세요",placeText:"텍스트 위치를 클릭하세요"},actions:{finish:"끝내기",cancel:"취소",removeLastVertex:"마지막 꼭지점 제거"},buttonTitles:{drawMarkerButton:"마커 그리기",drawPolyButton:"다각형 그리기",drawLineButton:"다각선 그리기",drawCircleButton:"원 그리기",drawRectButton:"직사각형 그리기",editButton:"레이어 편집하기",dragButton:"레이어 끌기",cutButton:"레이어 자르기",deleteButton:"레이어 제거하기",drawCircleMarkerButton:"원 마커 그리기",snappingButton:"잡아끈 마커를 다른 레이어 및 꼭지점에 들러붙게 하기",pinningButton:"공유 꼭지점을 함께 찍기",rotateButton:"레이어 회전하기",drawTextButton:"텍스트 그리기"}},pa={tooltips:{placeMarker:"Маркерди жайгаштыруу үчүн басыңыз",firstVertex:"Биринчи чокуну жайгаштырууну үчүн басыңыз",continueLine:"Сүрөт тартууну улантуу үчүн басыңыз",finishLine:"Аяктоо үчүн учурдагы маркерди басыңыз",finishPoly:"Бүтүрүү үчүн биринчи маркерди басыңыз",finishRect:"Бүтүрүү үчүн басыңыз",startCircle:"Айлананын борборун жайгаштырууну үчүн басыңыз",finishCircle:"Айлананы бүтүрүү үчүн басыңыз",placeCircleMarker:"Тегерек маркерди жайгаштыруу үчүн басыңыз",placeText:"Текстти жайгаштыруу үчүн басыңыз"},actions:{finish:"Аягы",cancel:"Жок кылуу",removeLastVertex:"Акыркы чокуну өчүрүү"},buttonTitles:{drawMarkerButton:"Маркерди чизуу",drawPolyButton:"Полигон чизуу",drawLineButton:"Полилиния чизуу",drawCircleButton:"Дайынды чизуу",drawRectButton:"Прямоугольник чизуу",editButton:"Слоопту түзөтүү",dragButton:"Слоопту карап сүйлөү",cutButton:"Слооптун башын кесүү",deleteButton:"Слооптун өчүрүү",drawCircleMarkerButton:"Дайынды маркерди чизуу",snappingButton:"Башка слооптордун жана вертекстердин арасына чекилдөө",pinningButton:"Бөлүшкөн вертекстерди бирге тутуштуруу",rotateButton:"Слооптун өзгөртүү",drawTextButton:"Текст чизуу",scaleButton:"Слооптун өлчөмүн өзгөртүү",autoTracingButton:"Автоматтык тизмеги чизуу"},measurements:{totalLength:"Узундук",segmentLength:"Сегмент узундугу",area:"Аймак",radius:"Радиус",perimeter:"Периметр",height:"Диаметр",width:"Кенчилик",coordinates:"Координаттар",coordinatesMarker:"Маркердин координаттары"}},yo=mo,Kr={en:Hn,de:Ei,it:Wn,id:Qn,ro:ci,ru:ps,es:Wr,nl:_i,fr:Ns,pt:yo,pt_br:Da,pt_pt:mo,zh:jo,zh_tw:Js,pl:Ra,sv:gs,el:Xs,hu:vo,da,no:$i,fa:sl,ua:fa,tr:kn,cz:An,ja:Zr,fi:Vn,ko:Oa,ky:pa},Qs={_globalEditModeEnabled:!1,enableGlobalEditMode(s){let l={...s};this._globalEditModeEnabled=!0,this.Toolbar.toggleButton("editMode",this.globalEditModeEnabled()),L.PM.Utils.findLayers(this.map).forEach(h=>{this._isRelevantForEdit(h)&&h.pm.enable(l)}),this.throttledReInitEdit||(this.throttledReInitEdit=L.Util.throttle(this.handleLayerAdditionInGlobalEditMode,100,this)),this._addedLayersEdit={},this.map.on("layeradd",this._layerAddedEdit,this),this.map.on("layeradd",this.throttledReInitEdit,this),this._fireGlobalEditModeToggled(!0)},disableGlobalEditMode(){this._globalEditModeEnabled=!1,L.PM.Utils.findLayers(this.map).forEach(s=>{s.pm.disable()}),this.map.off("layeradd",this._layerAddedEdit,this),this.map.off("layeradd",this.throttledReInitEdit,this),this.Toolbar.toggleButton("editMode",this.globalEditModeEnabled()),this._fireGlobalEditModeToggled(!1)},globalEditEnabled(){return this.globalEditModeEnabled()},globalEditModeEnabled(){return this._globalEditModeEnabled},toggleGlobalEditMode(s=this.globalOptions){this.globalEditModeEnabled()?this.disableGlobalEditMode():this.enableGlobalEditMode(s)},handleLayerAdditionInGlobalEditMode(){let s=this._addedLayersEdit;if(this._addedLayersEdit={},this.globalEditModeEnabled())for(let l in s){let h=s[l];this._isRelevantForEdit(h)&&h.pm.enable({...this.globalOptions})}},_layerAddedEdit({layer:s}){this._addedLayersEdit[L.stamp(s)]=s},_isRelevantForEdit(s){return s.pm&&!(s instanceof L.LayerGroup)&&(!L.PM.optIn&&!s.options.pmIgnore||L.PM.optIn&&s.options.pmIgnore===!1)&&!s._pmTempLayer&&s.pm.options.allowEditing}},Ia=Qs,zo={_globalDragModeEnabled:!1,enableGlobalDragMode(){let s=L.PM.Utils.findLayers(this.map);this._globalDragModeEnabled=!0,this._addedLayersDrag={},s.forEach(l=>{this._isRelevantForDrag(l)&&l.pm.enableLayerDrag()}),this.throttledReInitDrag||(this.throttledReInitDrag=L.Util.throttle(this.reinitGlobalDragMode,100,this)),this.map.on("layeradd",this._layerAddedDrag,this),this.map.on("layeradd",this.throttledReInitDrag,this),this.Toolbar.toggleButton("dragMode",this.globalDragModeEnabled()),this._fireGlobalDragModeToggled(!0)},disableGlobalDragMode(){let s=L.PM.Utils.findLayers(this.map);this._globalDragModeEnabled=!1,s.forEach(l=>{l.pm.disableLayerDrag()}),this.map.off("layeradd",this._layerAddedDrag,this),this.map.off("layeradd",this.throttledReInitDrag,this),this.Toolbar.toggleButton("dragMode",this.globalDragModeEnabled()),this._fireGlobalDragModeToggled(!1)},globalDragModeEnabled(){return!!this._globalDragModeEnabled},toggleGlobalDragMode(){this.globalDragModeEnabled()?this.disableGlobalDragMode():this.enableGlobalDragMode()},reinitGlobalDragMode(){let s=this._addedLayersDrag;if(this._addedLayersDrag={},this.globalDragModeEnabled())for(let l in s){let h=s[l];this._isRelevantForDrag(h)&&h.pm.enableLayerDrag()}},_layerAddedDrag({layer:s}){this._addedLayersDrag[L.stamp(s)]=s},_isRelevantForDrag(s){return s.pm&&!(s instanceof L.LayerGroup)&&(!L.PM.optIn&&!s.options.pmIgnore||L.PM.optIn&&s.options.pmIgnore===!1)&&!s._pmTempLayer&&s.pm.options.draggable}},Bi=zo,Ur={_globalRemovalModeEnabled:!1,enableGlobalRemovalMode(){this._globalRemovalModeEnabled=!0,this.map.eachLayer(s=>{this._isRelevantForRemoval(s)&&(s.pm.enabled()&&s.pm.disable(),s.on("click",this.removeLayer,this))}),this.throttledReInitRemoval||(this.throttledReInitRemoval=L.Util.throttle(this.handleLayerAdditionInGlobalRemovalMode,100,this)),this._addedLayersRemoval={},this.map.on("layeradd",this._layerAddedRemoval,this),this.map.on("layeradd",this.throttledReInitRemoval,this),this.Toolbar.toggleButton("removalMode",this.globalRemovalModeEnabled()),this._fireGlobalRemovalModeToggled(!0)},disableGlobalRemovalMode(){this._globalRemovalModeEnabled=!1,this.map.eachLayer(s=>{s.off("click",this.removeLayer,this)}),this.map.off("layeradd",this._layerAddedRemoval,this),this.map.off("layeradd",this.throttledReInitRemoval,this),this.Toolbar.toggleButton("removalMode",this.globalRemovalModeEnabled()),this._fireGlobalRemovalModeToggled(!1)},globalRemovalEnabled(){return this.globalRemovalModeEnabled()},globalRemovalModeEnabled(){return!!this._globalRemovalModeEnabled},toggleGlobalRemovalMode(){this.globalRemovalModeEnabled()?this.disableGlobalRemovalMode():this.enableGlobalRemovalMode()},removeLayer(s){let l=s.target;this._isRelevantForRemoval(l)&&!l.pm.dragging()&&(l.removeFrom(this.map.pm._getContainingLayer()),l.remove(),l instanceof L.LayerGroup?(this._fireRemoveLayerGroup(l),this._fireRemoveLayerGroup(this.map,l)):(l.pm._fireRemove(l),l.pm._fireRemove(this.map,l)))},_isRelevantForRemoval(s){return s.pm&&!(s instanceof L.LayerGroup)&&(!L.PM.optIn&&!s.options.pmIgnore||L.PM.optIn&&s.options.pmIgnore===!1)&&!s._pmTempLayer&&s.pm.options.allowRemoval},handleLayerAdditionInGlobalRemovalMode(){let s=this._addedLayersRemoval;if(this._addedLayersRemoval={},this.globalRemovalModeEnabled())for(let l in s){let h=s[l];this._isRelevantForRemoval(h)&&(h.pm.enabled()&&h.pm.disable(),h.on("click",this.removeLayer,this))}},_layerAddedRemoval({layer:s}){this._addedLayersRemoval[L.stamp(s)]=s}},eo=Ur,ol={_globalRotateModeEnabled:!1,enableGlobalRotateMode(){this._globalRotateModeEnabled=!0,L.PM.Utils.findLayers(this.map).filter(s=>s instanceof L.Polyline).forEach(s=>{this._isRelevantForRotate(s)&&s.pm.enableRotate()}),this.throttledReInitRotate||(this.throttledReInitRotate=L.Util.throttle(this.handleLayerAdditionInGlobalRotateMode,100,this)),this._addedLayersRotate={},this.map.on("layeradd",this._layerAddedRotate,this),this.map.on("layeradd",this.throttledReInitRotate,this),this.Toolbar.toggleButton("rotateMode",this.globalRotateModeEnabled()),this._fireGlobalRotateModeToggled()},disableGlobalRotateMode(){this._globalRotateModeEnabled=!1,L.PM.Utils.findLayers(this.map).filter(s=>s instanceof L.Polyline).forEach(s=>{s.pm.disableRotate()}),this.map.off("layeradd",this._layerAddedRotate,this),this.map.off("layeradd",this.throttledReInitRotate,this),this.Toolbar.toggleButton("rotateMode",this.globalRotateModeEnabled()),this._fireGlobalRotateModeToggled()},globalRotateModeEnabled(){return!!this._globalRotateModeEnabled},toggleGlobalRotateMode(){this.globalRotateModeEnabled()?this.disableGlobalRotateMode():this.enableGlobalRotateMode()},_isRelevantForRotate(s){return s.pm&&s instanceof L.Polyline&&!(s instanceof L.LayerGroup)&&(!L.PM.optIn&&!s.options.pmIgnore||L.PM.optIn&&s.options.pmIgnore===!1)&&!s._pmTempLayer&&s.pm.options.allowRotation},handleLayerAdditionInGlobalRotateMode(){let s=this._addedLayersRotate;if(this._addedLayersRotate={},this.globalRotateModeEnabled())for(let l in s){let h=s[l];this._isRelevantForRemoval(h)&&h.pm.enableRotate()}},_layerAddedRotate({layer:s}){this._addedLayersRotate[L.stamp(s)]=s}},Uo=ol,ga=f(Gr()),_o={_fireDrawStart(s="Draw",l={}){this.__fire(this._map,"pm:drawstart",{shape:this._shape,workingLayer:this._layer},s,l)},_fireDrawEnd(s="Draw",l={}){this.__fire(this._map,"pm:drawend",{shape:this._shape},s,l)},_fireCreate(s,l="Draw",h={}){this.__fire(this._map,"pm:create",{shape:this._shape,marker:s,layer:s},l,h)},_fireCenterPlaced(s="Draw",l={}){let h=s==="Draw"?this._layer:void 0,g=s!=="Draw"?this._layer:void 0;this.__fire(this._layer,"pm:centerplaced",{shape:this._shape,workingLayer:h,layer:g,latlng:this._layer.getLatLng()},s,l)},_fireCut(s,l,h,g="Draw",_={}){this.__fire(s,"pm:cut",{shape:this._shape,layer:l,originalLayer:h},g,_)},_fireEdit(s=this._layer,l="Edit",h={}){this.__fire(s,"pm:edit",{layer:this._layer,shape:this.getShape()},l,h)},_fireEnable(s="Edit",l={}){this.__fire(this._layer,"pm:enable",{layer:this._layer,shape:this.getShape()},s,l)},_fireDisable(s="Edit",l={}){this.__fire(this._layer,"pm:disable",{layer:this._layer,shape:this.getShape()},s,l)},_fireUpdate(s="Edit",l={}){this.__fire(this._layer,"pm:update",{layer:this._layer,shape:this.getShape()},s,l)},_fireMarkerDragStart(s,l=void 0,h="Edit",g={}){this.__fire(this._layer,"pm:markerdragstart",{layer:this._layer,markerEvent:s,shape:this.getShape(),indexPath:l},h,g)},_fireMarkerDrag(s,l=void 0,h="Edit",g={}){this.__fire(this._layer,"pm:markerdrag",{layer:this._layer,markerEvent:s,shape:this.getShape(),indexPath:l},h,g)},_fireMarkerDragEnd(s,l=void 0,h=void 0,g="Edit",_={}){this.__fire(this._layer,"pm:markerdragend",{layer:this._layer,markerEvent:s,shape:this.getShape(),indexPath:l,intersectionReset:h},g,_)},_fireDragStart(s="Edit",l={}){this.__fire(this._layer,"pm:dragstart",{layer:this._layer,shape:this.getShape()},s,l)},_fireDrag(s,l="Edit",h={}){this.__fire(this._layer,"pm:drag",{...s,shape:this.getShape()},l,h)},_fireDragEnd(s="Edit",l={}){this.__fire(this._layer,"pm:dragend",{layer:this._layer,shape:this.getShape()},s,l)},_fireDragEnable(s="Edit",l={}){this.__fire(this._layer,"pm:dragenable",{layer:this._layer,shape:this.getShape()},s,l)},_fireDragDisable(s="Edit",l={}){this.__fire(this._layer,"pm:dragdisable",{layer:this._layer,shape:this.getShape()},s,l)},_fireRemove(s,l=s,h="Edit",g={}){this.__fire(s,"pm:remove",{layer:l,shape:this.getShape()},h,g)},_fireVertexAdded(s,l,h,g="Edit",_={}){this.__fire(this._layer,"pm:vertexadded",{layer:this._layer,workingLayer:this._layer,marker:s,indexPath:l,latlng:h,shape:this.getShape()},g,_)},_fireVertexRemoved(s,l,h="Edit",g={}){this.__fire(this._layer,"pm:vertexremoved",{layer:this._layer,marker:s,indexPath:l,shape:this.getShape()},h,g)},_fireVertexClick(s,l,h="Edit",g={}){this.__fire(this._layer,"pm:vertexclick",{layer:this._layer,markerEvent:s,indexPath:l,shape:this.getShape()},h,g)},_fireIntersect(s,l=this._layer,h="Edit",g={}){this.__fire(l,"pm:intersect",{layer:this._layer,intersection:s,shape:this.getShape()},h,g)},_fireLayerReset(s,l,h="Edit",g={}){this.__fire(this._layer,"pm:layerreset",{layer:this._layer,markerEvent:s,indexPath:l,shape:this.getShape()},h,g)},_fireChange(s,l="Edit",h={}){this.__fire(this._layer,"pm:change",{layer:this._layer,latlngs:s,shape:this.getShape()},l,h)},_fireTextChange(s,l="Edit",h={}){this.__fire(this._layer,"pm:textchange",{layer:this._layer,text:s,shape:this.getShape()},l,h)},_fireTextFocus(s="Edit",l={}){this.__fire(this._layer,"pm:textfocus",{layer:this._layer,shape:this.getShape()},s,l)},_fireTextBlur(s="Edit",l={}){this.__fire(this._layer,"pm:textblur",{layer:this._layer,shape:this.getShape()},s,l)},_fireSnapDrag(s,l,h="Snapping",g={}){this.__fire(s,"pm:snapdrag",l,h,g)},_fireSnap(s,l,h="Snapping",g={}){this.__fire(s,"pm:snap",l,h,g)},_fireUnsnap(s,l,h="Snapping",g={}){this.__fire(s,"pm:unsnap",l,h,g)},_fireRotationEnable(s,l,h="Rotation",g={}){this.__fire(s,"pm:rotateenable",{layer:this._layer,helpLayer:this._rotatePoly,shape:this.getShape()},h,g)},_fireRotationDisable(s,l="Rotation",h={}){this.__fire(s,"pm:rotatedisable",{layer:this._layer,shape:this.getShape()},l,h)},_fireRotationStart(s,l,h="Rotation",g={}){this.__fire(s,"pm:rotatestart",{layer:this._rotationLayer,helpLayer:this._layer,startAngle:this._startAngle,originLatLngs:l},h,g)},_fireRotation(s,l,h,g=this._rotationLayer,_="Rotation",E={}){this.__fire(s,"pm:rotate",{layer:g,helpLayer:this._layer,startAngle:this._startAngle,angle:g.pm.getAngle(),angleDiff:l,oldLatLngs:h,newLatLngs:g.getLatLngs()},_,E)},_fireRotationEnd(s,l,h,g="Rotation",_={}){this.__fire(s,"pm:rotateend",{layer:this._rotationLayer,helpLayer:this._layer,startAngle:l,angle:this._rotationLayer.pm.getAngle(),originLatLngs:h,newLatLngs:this._rotationLayer.getLatLngs()},g,_)},_fireActionClick(s,l,h,g="Toolbar",_={}){this.__fire(this._map,"pm:actionclick",{text:s.text,action:s,btnName:l,button:h},g,_)},_fireButtonClick(s,l,h="Toolbar",g={}){this.__fire(this._map,"pm:buttonclick",{btnName:s,button:l},h,g)},_fireLangChange(s,l,h,g,_="Global",E={}){this.__fire(this.map,"pm:langchange",{oldLang:s,activeLang:l,fallback:h,translations:g},_,E)},_fireGlobalDragModeToggled(s,l="Global",h={}){this.__fire(this.map,"pm:globaldragmodetoggled",{enabled:s,map:this.map},l,h)},_fireGlobalEditModeToggled(s,l="Global",h={}){this.__fire(this.map,"pm:globaleditmodetoggled",{enabled:s,map:this.map},l,h)},_fireGlobalRemovalModeToggled(s,l="Global",h={}){this.__fire(this.map,"pm:globalremovalmodetoggled",{enabled:s,map:this.map},l,h)},_fireGlobalCutModeToggled(s="Global",l={}){this.__fire(this._map,"pm:globalcutmodetoggled",{enabled:!!this._enabled,map:this._map},s,l)},_fireGlobalDrawModeToggled(s="Global",l={}){this.__fire(this._map,"pm:globaldrawmodetoggled",{enabled:this._enabled,shape:this._shape,map:this._map},s,l)},_fireGlobalRotateModeToggled(s="Global",l={}){this.__fire(this.map,"pm:globalrotatemodetoggled",{enabled:this.globalRotateModeEnabled(),map:this.map},s,l)},_fireRemoveLayerGroup(s,l=s,h="Edit",g={}){this.__fire(s,"pm:remove",{layer:l,shape:void 0},h,g)},_fireKeyeventEvent(s,l,h,g="Global",_={}){this.__fire(this.map,"pm:keyevent",{event:s,eventType:l,focusOn:h},g,_)},__fire(s,l,h,g,_={}){h=(0,ga.default)(h,_,{source:g}),L.PM.Utils._fireEvent(s,l,h)}},$o=_o,Fa=()=>({_lastEvents:{keydown:void 0,keyup:void 0,current:void 0},_initKeyListener(s){this.map=s,L.DomEvent.on(document,"keydown keyup",this._onKeyListener,this),L.DomEvent.on(window,"blur",this._onBlur,this),s.once("unload",this._unbindKeyListenerEvents,this)},_unbindKeyListenerEvents(){L.DomEvent.off(document,"keydown keyup",this._onKeyListener,this),L.DomEvent.off(window,"blur",this._onBlur,this)},_onKeyListener(s){let l="document";this.map.getContainer().contains(s.target)&&(l="map");let h={event:s,eventType:s.type,focusOn:l};this._lastEvents[s.type]=h,this._lastEvents.current=h,this.map.pm._fireKeyeventEvent(s,s.type,l)},_onBlur(s){s.altKey=!1;let l={event:s,eventType:s.type,focusOn:"document"};this._lastEvents[s.type]=l,this._lastEvents.current=l},getLastKeyEvent(s="current"){return this._lastEvents[s]},isShiftKeyPressed(){var s;return(s=this._lastEvents.current)==null?void 0:s.event.shiftKey},isAltKeyPressed(){var s;return(s=this._lastEvents.current)==null?void 0:s.event.altKey},isCtrlKeyPressed(){var s;return(s=this._lastEvents.current)==null?void 0:s.event.ctrlKey},isMetaKeyPressed(){var s;return(s=this._lastEvents.current)==null?void 0:s.event.metaKey},getPressedKey(){var s;return(s=this._lastEvents.current)==null?void 0:s.event.key}}),jn=Fa,ja=f(cr());function dn(s){let l=L.PM.activeLang;return(0,ja.default)(Kr[l],s)||(0,ja.default)(Kr.en,s)||s}function br(s){for(let l=0;l<s.length;l+=1){let h=s[l];if(Array.isArray(h)){if(br(h))return!0}else if(h!=null&&h!=="")return!0}return!1}function qo(s){return s.reduce((l,h)=>{if(h.length!==0){let g=Array.isArray(h)?qo(h):h;Array.isArray(g)?g.length!==0&&l.push(g):l.push(g)}return l},[])}function bo(s,l,h){let g={a:L.CRS.Earth.R,b:63567523142e-4,f:.0033528106647474805},{a:_,b:E,f:B}=g,R=s.lng,W=s.lat,he=h,Ie=Math.PI,Me=l*Ie/180,rt=Math.sin(Me),pt=Math.cos(Me),Dt=(1-B)*Math.tan(W*Ie/180),Vt=1/Math.sqrt(1+Dt*Dt),Ht=Dt*Vt,wn=Math.atan2(Dt,pt),Re=Vt*rt,Ve=1-Re*Re,et=Ve*(_*_-E*E)/(E*E),_t=1+et/16384*(4096+et*(-768+et*(320-175*et))),at=et/1024*(256+et*(-128+et*(74-47*et))),gt=he/(E*_t),X=2*Math.PI,pe,Ce,Le;for(;Math.abs(gt-X)>1e-12;){pe=Math.cos(2*wn+gt),Ce=Math.sin(gt),Le=Math.cos(gt);let It=at*Ce*(pe+at/4*(Le*(-1+2*pe*pe)-at/6*pe*(-3+4*Ce*Ce)*(-3+4*pe*pe)));X=gt,gt=he/(E*_t)+It}let ke=Ht*Ce-Vt*Le*pt,Se=Math.atan2(Ht*Le+Vt*Ce*pt,(1-B)*Math.sqrt(Re*Re+ke*ke)),Ye=Math.atan2(Ce*rt,Vt*Le-Ht*Ce*pt),We=B/16*Ve*(4+B*(4-3*Ve)),tt=Ye-(1-We)*B*Re*(gt+We*Ce*(pe+We*Le*(-1+2*pe*pe))),dt=R+tt*180/Ie,ht=Se*180/Ie;return L.latLng(dt,ht)}function Sr(s,l,h,g,_=!0){let E,B,R,W=[];for(let he=0;he<h;he+=1){if(_)E=he*360/h+g,B=bo(s,E,l),R=L.latLng(B.lng,B.lat);else{let Ie=s.lat+Math.cos(2*he*Math.PI/h)*l,Me=s.lng+Math.sin(2*he*Math.PI/h)*l;R=L.latLng(Ie,Me)}W.push(R)}return W}function za(s,l,h){l=(l+360)%360;let g=Math.PI/180,_=180/Math.PI,{R:E}=L.CRS.Earth,B=s.lng*g,R=s.lat*g,W=l*g,he=Math.sin(R),Ie=Math.cos(R),Me=Math.cos(h/E),rt=Math.sin(h/E),pt=Math.asin(he*Me+Ie*rt*Math.cos(W)),Dt=B+Math.atan2(Math.sin(W)*rt*Ie,Me-he*Math.sin(pt));Dt*=_;let Vt=Dt-360,Ht=Dt<-180?Dt+360:Dt;return Dt=Dt>180?Vt:Ht,L.latLng([pt*_,Dt])}function Ds(s,l,h){let g=s.latLngToContainerPoint(l),_=s.latLngToContainerPoint(h),E=Math.atan2(_.y-g.y,_.x-g.x)*180/Math.PI+90;return E+=E<0?360:0,E}function ma(s,l,h,g){let _=Ds(s,l,h);return za(l,_,g)}function va(s,l,h="asc"){if(!l||Object.keys(l).length===0)return(W,he)=>W-he;let g=Object.keys(l),_,E=g.length-1,B={};for(;E>=0;)_=g[E],B[_.toLowerCase()]=l[_],E-=1;function R(W){if(W instanceof L.Marker)return"Marker";if(W instanceof L.Circle)return"Circle";if(W instanceof L.CircleMarker)return"CircleMarker";if(W instanceof L.Rectangle)return"Rectangle";if(W instanceof L.Polygon)return"Polygon";if(W instanceof L.Polyline)return"Line"}return(W,he)=>{let Ie,Me;if(Ie=R(W.layer).toLowerCase(),Me=R(he.layer).toLowerCase(),!Ie||!Me)return 0;let rt=Ie in B?B[Ie]:Number.MAX_SAFE_INTEGER,pt=Me in B?B[Me]:Number.MAX_SAFE_INTEGER,Dt=0;return rt<pt?Dt=-1:rt>pt&&(Dt=1),h==="desc"?Dt*-1:Dt}}function Yr(s,l=s.getLatLngs()){return s instanceof L.Polygon?L.polygon(l).getLatLngs():L.polyline(l).getLatLngs()}function ya(s,l){var h,g,_,E;if((g=(h=l.options.crs)==null?void 0:h.projection)!=null&&g.MAX_LATITUDE){let B=(E=(_=l.options.crs)==null?void 0:_.projection)==null?void 0:E.MAX_LATITUDE;s.lat=Math.max(Math.min(B,s.lat),-B)}return s}function qi(s){return s.options.renderer||s._map&&(s._map._getPaneRenderer(s.options.pane)||s._map.options.renderer||s._map._renderer)||s._renderer}var al=L.Class.extend({includes:[Ia,Bi,eo,Uo,$o],initialize(s){this.map=s,this.Draw=new L.PM.Draw(s),this.Toolbar=new L.PM.Toolbar(s),this.Keyboard=jn(),this.globalOptions={snappable:!0,layerGroup:void 0,snappingOrder:["Marker","CircleMarker","Circle","Line","Polygon","Rectangle"],panes:{vertexPane:"markerPane",layerPane:"overlayPane",markerPane:"markerPane"},draggable:!0},this.Keyboard._initKeyListener(s)},setLang(s="en",l,h="en"){if(s=s.trim().toLowerCase(),!/^[a-z]{2}$/.test(s)){let _=s.replace(/[-_\s]/g,"-").replace(/^(\w{2})$/,"$1-").match(/([a-z]{2})-?([a-z]{2})?/);if(_){let E=[`${_[1]}_${_[2]}`,`${_[1]}`];for(let B of E)if(Kr[B]){s=B;break}}}let g=L.PM.activeLang;l&&(Kr[s]=(0,xn.default)(Kr[h],l)),L.PM.activeLang=s,this.map.pm.Toolbar.reinit(),this._fireLangChange(g,s,h,Kr[s])},addControls(s){this.Toolbar.addControls(s)},removeControls(){this.Toolbar.removeControls()},toggleControls(){this.Toolbar.toggleControls()},controlsVisible(){return this.Toolbar.isVisible},enableDraw(s="Polygon",l){s==="Poly"&&(s="Polygon"),this.Draw.enable(s,l)},disableDraw(s="Polygon"){s==="Poly"&&(s="Polygon"),this.Draw.disable(s)},setPathOptions(s,l={}){let h=l.ignoreShapes||[],g=l.merge||!1;this.map.pm.Draw.shapes.forEach(_=>{h.indexOf(_)===-1&&this.map.pm.Draw[_].setPathOptions(s,g)})},getGlobalOptions(){return this.globalOptions},setGlobalOptions(s){let l=(0,xn.default)(this.globalOptions,s);l.editable&&(l.resizeableCircleMarker=l.editable,delete l.editable);let h=!1;this.map.pm.Draw.CircleMarker.enabled()&&!!this.map.pm.Draw.CircleMarker.options.resizeableCircleMarker!=!!l.resizeableCircleMarker&&(this.map.pm.Draw.CircleMarker.disable(),h=!0);let g=!1;this.map.pm.Draw.Circle.enabled()&&!!this.map.pm.Draw.Circle.options.resizeableCircle!=!!l.resizeableCircle&&(this.map.pm.Draw.Circle.disable(),g=!0),this.map.pm.Draw.shapes.forEach(_=>{this.map.pm.Draw[_].setOptions(l)}),h&&this.map.pm.Draw.CircleMarker.enable(),g&&this.map.pm.Draw.Circle.enable(),L.PM.Utils.findLayers(this.map).forEach(_=>{_.pm.setOptions(l)}),this.map.fire("pm:globaloptionschanged"),this.globalOptions=l,this.applyGlobalOptions()},applyGlobalOptions(){L.PM.Utils.findLayers(this.map).forEach(s=>{s.pm.enabled()&&s.pm.applyOptions()})},globalDrawModeEnabled(){return!!this.Draw.getActiveShape()},globalCutModeEnabled(){return!!this.Draw.Cut.enabled()},enableGlobalCutMode(s){return this.Draw.Cut.enable(s)},toggleGlobalCutMode(s){return this.Draw.Cut.toggle(s)},disableGlobalCutMode(){return this.Draw.Cut.disable()},getGeomanLayers(s=!1){let l=L.PM.Utils.findLayers(this.map);if(!s)return l;let h=L.featureGroup();return h._pmTempLayer=!0,l.forEach(g=>{h.addLayer(g)}),h},getGeomanDrawLayers(s=!1){let l=L.PM.Utils.findLayers(this.map).filter(g=>g._drawnByGeoman===!0);if(!s)return l;let h=L.featureGroup();return h._pmTempLayer=!0,l.forEach(g=>{h.addLayer(g)}),h},_getContainingLayer(){return this.globalOptions.layerGroup&&this.globalOptions.layerGroup instanceof L.LayerGroup?this.globalOptions.layerGroup:this.map},_isCRSSimple(){return this.map.options.crs===L.CRS.Simple},_touchEventCounter:0,_addTouchEvents(s){this._touchEventCounter===0&&(L.DomEvent.on(s,"touchmove",this._canvasTouchMove,this),L.DomEvent.on(s,"touchstart touchend touchcancel",this._canvasTouchClick,this)),this._touchEventCounter+=1},_removeTouchEvents(s){this._touchEventCounter===1&&(L.DomEvent.off(s,"touchmove",this._canvasTouchMove,this),L.DomEvent.off(s,"touchstart touchend touchcancel",this._canvasTouchClick,this)),this._touchEventCounter=this._touchEventCounter<=1?0:this._touchEventCounter-1},_canvasTouchMove(s){qi(this.map)._onMouseMove(this._createMouseEvent("mousemove",s))},_canvasTouchClick(s){let l="";s.type==="touchstart"||s.type==="pointerdown"?l="mousedown":(s.type==="touchend"||s.type==="pointerup"||s.type==="touchcancel"||s.type==="pointercancel")&&(l="mouseup"),l&&qi(this.map)._onClick(this._createMouseEvent(l,s))},_createMouseEvent(s,l){let h,g=l.touches[0]||l.changedTouches[0];try{h=new MouseEvent(s,{bubbles:l.bubbles,cancelable:l.cancelable,view:l.view,detail:g.detail,screenX:g.screenX,screenY:g.screenY,clientX:g.clientX,clientY:g.clientY,ctrlKey:l.ctrlKey,altKey:l.altKey,shiftKey:l.shiftKey,metaKey:l.metaKey,button:l.button,relatedTarget:l.relatedTarget})}catch{h=document.createEvent("MouseEvents"),h.initMouseEvent(s,l.bubbles,l.cancelable,l.view,g.detail,g.screenX,g.screenY,g.clientX,g.clientY,l.ctrlKey,l.altKey,l.shiftKey,l.metaKey,l.button,l.relatedTarget)}return h}}),Vo=al,Jr=L.Control.extend({includes:[$o],options:{position:"topleft",disableByOtherButtons:!0},initialize(s){this._button=L.Util.extend({},this.options,s)},onAdd(s){return this._map=s,this._map.pm.Toolbar.options.oneBlock?this._container=this._map.pm.Toolbar._createContainer(this.options.position):this._button.tool==="edit"?this._container=this._map.pm.Toolbar.editContainer:this._button.tool==="options"?this._container=this._map.pm.Toolbar.optionsContainer:this._button.tool==="custom"?this._container=this._map.pm.Toolbar.customContainer:this._container=this._map.pm.Toolbar.drawContainer,this._renderButton(),this._container},_renderButton(){let s=this.buttonsDomNode;this.buttonsDomNode=this._makeButton(this._button),s?s.replaceWith(this.buttonsDomNode):this._container.appendChild(this.buttonsDomNode)},onRemove(){return this.buttonsDomNode.remove(),this._container},getText(){return this._button.text},getIconUrl(){return this._button.iconUrl},destroy(){this._button={},this._update()},toggle(s){return typeof s=="boolean"?this._button.toggleStatus=s:this._button.toggleStatus=!this._button.toggleStatus,this._applyStyleClasses(),this._updateActiveAction(this._button),this._button.toggleStatus},toggled(){return this._button.toggleStatus},onCreate(){this.toggle(!1)},disable(){this.toggle(!1),this._button.disabled=!0,this._updateDisabled()},enable(){this._button.disabled=!1,this._updateDisabled(),this._updateActiveAction(this._button)},_triggerClick(s){s&&s.preventDefault(),!this._button.disabled&&(this._button.onClick(s,{button:this,event:s}),this._clicked(s),this._button.afterClick(s,{button:this,event:s}))},_makeButton(s){let l=this.options.position.indexOf("right")>-1?"pos-right":"",h=L.DomUtil.create("div",`button-container  ${l}`,this._container);s.title&&h.setAttribute("title",s.title);let g=L.DomUtil.create("a","leaflet-buttons-control-button",h);g.setAttribute("role","button"),g.setAttribute("tabindex","0"),g.href="#";let _=L.DomUtil.create("div",`leaflet-pm-actions-container ${l}`,h),E=s.actions,B={cancel:{text:dn("actions.cancel"),title:dn("actions.cancel"),onClick(){this._triggerClick()}},finishMode:{text:dn("actions.finish"),title:dn("actions.finish"),onClick(){this._triggerClick()}},removeLastVertex:{text:dn("actions.removeLastVertex"),title:dn("actions.removeLastVertex"),onClick(){this._map.pm.Draw[s.jsClass]._removeLastVertex()}},finish:{text:dn("actions.finish"),title:dn("actions.finish"),onClick(W){this._map.pm.Draw[s.jsClass]._finishShape(W)}}};s._preparedActions=E.map(W=>{let he=typeof W=="string"?W:W.name,Ie;if(B[he])Ie=B[he];else if(W.text)Ie=W;else return Ie;let Me=L.DomUtil.create("a",`leaflet-pm-action ${l} action-${he}`,_);if(Me.setAttribute("role","button"),Me.setAttribute("tabindex","0"),Me.href="#",Ie.title&&(Me.title=Ie.title),Me.innerHTML=Ie.text,L.DomEvent.disableClickPropagation(Me),L.DomEvent.on(Me,"click",L.DomEvent.stop),Ie._node=Me,!s.disabled&&Ie.onClick){let rt=pt=>{pt.preventDefault();let Dt="",{buttons:Vt}=this._map.pm.Toolbar;for(let Ht in Vt)if(Vt[Ht]._button===s){Dt=Ht;break}this._fireActionClick(Ie,Dt,s)};L.DomEvent.addListener(Me,"click",rt,this),L.DomEvent.addListener(Me,"click",Ie.onClick,this),L.DomEvent.addListener(Me,"click",()=>this._updateActiveAction(s))}return Ie}),this._updateActiveAction(s),s.toggleStatus&&L.DomUtil.addClass(h,"active");let R=L.DomUtil.create("div","control-icon",g);return s.iconUrl&&R.setAttribute("src",s.iconUrl),s.className&&L.DomUtil.addClass(R,s.className),L.DomEvent.disableClickPropagation(g),L.DomEvent.on(g,"click",L.DomEvent.stop),s.disabled||(L.DomEvent.addListener(g,"click",this._onBtnClick,this),L.DomEvent.addListener(g,"click",this._triggerClick,this)),s.disabled&&(L.DomUtil.addClass(g,"pm-disabled"),g.setAttribute("aria-disabled","true")),h},_applyStyleClasses(){this._container&&(!this._button.toggleStatus||this._button.cssToggle===!1?(L.DomUtil.removeClass(this.buttonsDomNode,"active"),L.DomUtil.removeClass(this._container,"activeChild")):(L.DomUtil.addClass(this.buttonsDomNode,"active"),L.DomUtil.addClass(this._container,"activeChild")))},_onBtnClick(){if(this._button.disabled)return;this._button.disableOtherButtons&&this._map.pm.Toolbar.triggerClickOnToggledButtons(this);let s="",{buttons:l}=this._map.pm.Toolbar;for(let h in l)if(l[h]._button===this._button){s=h;break}this._fireButtonClick(s,this._button)},_clicked(){this._button.doToggle&&this.toggle()},_updateDisabled(){if(!this._container)return;let s="pm-disabled",l=this.buttonsDomNode.children[0];this._button.disabled?(L.DomUtil.addClass(l,s),l.setAttribute("aria-disabled","true")):(L.DomUtil.removeClass(l,s),l.setAttribute("aria-disabled","false"))},_updateActiveAction(s){var l;(l=s._preparedActions)==null||l.forEach(h=>{h!=null&&h._node&&(h.isActive&&h.isActive.call(this)?L.DomUtil.addClass(h._node,"active-action"):L.DomUtil.removeClass(h._node,"active-action"))})}}),_a=Jr;L.Control.PMButton=_a;var Ua=L.Class.extend({options:{drawMarker:!0,drawRectangle:!0,drawPolyline:!0,drawPolygon:!0,drawCircle:!0,drawCircleMarker:!0,drawText:!0,editMode:!0,dragMode:!0,cutPolygon:!0,removalMode:!0,rotateMode:!0,snappingOption:!0,drawControls:!0,editControls:!0,optionsControls:!0,customControls:!0,oneBlock:!1,position:"topleft",positions:{draw:"",edit:"",options:"",custom:""}},customButtons:[],initialize(s){this.customButtons=[],this.options.positions={draw:"",edit:"",options:"",custom:""},this.init(s)},reinit(){let s=this.isVisible;this.removeControls(),this._defineButtons(),s&&this.addControls()},init(s){this.map=s,this.buttons={},this.isVisible=!1,this.drawContainer=L.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-draw leaflet-bar leaflet-control"),this.editContainer=L.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-edit leaflet-bar leaflet-control"),this.optionsContainer=L.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-options leaflet-bar leaflet-control"),this.customContainer=L.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-custom leaflet-bar leaflet-control"),this._defineButtons()},_createContainer(s){let l=`${s}Container`;return this[l]||(this[l]=L.DomUtil.create("div",`leaflet-pm-toolbar leaflet-pm-${s} leaflet-bar leaflet-control`)),this[l]},getButtons(){return this.buttons},addControls(s=this.options){typeof s.editPolygon<"u"&&(s.editMode=s.editPolygon),typeof s.deleteLayer<"u"&&(s.removalMode=s.deleteLayer),L.Util.setOptions(this,s),this.applyIconStyle(),this.isVisible=!0,this._showHideButtons()},applyIconStyle(){let s=this.getButtons(),l={geomanIcons:{drawMarker:"control-icon leaflet-pm-icon-marker",drawPolyline:"control-icon leaflet-pm-icon-polyline",drawRectangle:"control-icon leaflet-pm-icon-rectangle",drawPolygon:"control-icon leaflet-pm-icon-polygon",drawCircle:"control-icon leaflet-pm-icon-circle",drawCircleMarker:"control-icon leaflet-pm-icon-circle-marker",editMode:"control-icon leaflet-pm-icon-edit",dragMode:"control-icon leaflet-pm-icon-drag",cutPolygon:"control-icon leaflet-pm-icon-cut",removalMode:"control-icon leaflet-pm-icon-delete",drawText:"control-icon leaflet-pm-icon-text"}};for(let h in s){let g=s[h];L.Util.setOptions(g,{className:l.geomanIcons[h]})}},removeControls(){let s=this.getButtons();for(let l in s)s[l].remove();this.isVisible=!1},toggleControls(s=this.options){this.isVisible?this.removeControls():this.addControls(s)},_addButton(s,l){return this.buttons[s]=l,this.options[s]=!!this.options[s]||!1,this.buttons[s]},triggerClickOnToggledButtons(s){for(let l in this.buttons){let h=this.buttons[l];h._button.disableByOtherButtons&&h!==s&&h.toggled()&&h._triggerClick()}},toggleButton(s,l,h=!0){s==="editPolygon"&&(s="editMode"),s==="deleteLayer"&&(s="removalMode");let g=s;return h&&this.triggerClickOnToggledButtons(this.buttons[g]),this.buttons[g]?this.buttons[g].toggle(l):!1},_defineButtons(){let s={className:"control-icon leaflet-pm-icon-marker",title:dn("buttonTitles.drawMarkerButton"),jsClass:"Marker",onClick:()=>{},afterClick:(rt,pt)=>{this.map.pm.Draw[pt.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]},l={title:dn("buttonTitles.drawPolyButton"),className:"control-icon leaflet-pm-icon-polygon",jsClass:"Polygon",onClick:()=>{},afterClick:(rt,pt)=>{this.map.pm.Draw[pt.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["finish","removeLastVertex","cancel"]},h={className:"control-icon leaflet-pm-icon-polyline",title:dn("buttonTitles.drawLineButton"),jsClass:"Line",onClick:()=>{},afterClick:(rt,pt)=>{this.map.pm.Draw[pt.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["finish","removeLastVertex","cancel"]},g={title:dn("buttonTitles.drawCircleButton"),className:"control-icon leaflet-pm-icon-circle",jsClass:"Circle",onClick:()=>{},afterClick:(rt,pt)=>{this.map.pm.Draw[pt.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]},_={title:dn("buttonTitles.drawCircleMarkerButton"),className:"control-icon leaflet-pm-icon-circle-marker",jsClass:"CircleMarker",onClick:()=>{},afterClick:(rt,pt)=>{this.map.pm.Draw[pt.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]},E={title:dn("buttonTitles.drawRectButton"),className:"control-icon leaflet-pm-icon-rectangle",jsClass:"Rectangle",onClick:()=>{},afterClick:(rt,pt)=>{this.map.pm.Draw[pt.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]},B={title:dn("buttonTitles.editButton"),className:"control-icon leaflet-pm-icon-edit",onClick:()=>{},afterClick:()=>{this.map.pm.toggleGlobalEditMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finishMode"]},R={title:dn("buttonTitles.dragButton"),className:"control-icon leaflet-pm-icon-drag",onClick:()=>{},afterClick:()=>{this.map.pm.toggleGlobalDragMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finishMode"]},W={title:dn("buttonTitles.cutButton"),className:"control-icon leaflet-pm-icon-cut",jsClass:"Cut",onClick:()=>{},afterClick:(rt,pt)=>{this.map.pm.Draw[pt.button._button.jsClass].toggle({snappable:!0,cursorMarker:!0,allowSelfIntersection:!1})},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finish","removeLastVertex","cancel"]},he={title:dn("buttonTitles.deleteButton"),className:"control-icon leaflet-pm-icon-delete",onClick:()=>{},afterClick:()=>{this.map.pm.toggleGlobalRemovalMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finishMode"]},Ie={title:dn("buttonTitles.rotateButton"),className:"control-icon leaflet-pm-icon-rotate",onClick:()=>{},afterClick:()=>{this.map.pm.toggleGlobalRotateMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finishMode"]},Me={className:"control-icon leaflet-pm-icon-text",title:dn("buttonTitles.drawTextButton"),jsClass:"Text",onClick:()=>{},afterClick:(rt,pt)=>{this.map.pm.Draw[pt.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]};this._addButton("drawMarker",new L.Control.PMButton(s)),this._addButton("drawPolyline",new L.Control.PMButton(h)),this._addButton("drawRectangle",new L.Control.PMButton(E)),this._addButton("drawPolygon",new L.Control.PMButton(l)),this._addButton("drawCircle",new L.Control.PMButton(g)),this._addButton("drawCircleMarker",new L.Control.PMButton(_)),this._addButton("drawText",new L.Control.PMButton(Me)),this._addButton("editMode",new L.Control.PMButton(B)),this._addButton("dragMode",new L.Control.PMButton(R)),this._addButton("cutPolygon",new L.Control.PMButton(W)),this._addButton("removalMode",new L.Control.PMButton(he)),this._addButton("rotateMode",new L.Control.PMButton(Ie))},_showHideButtons(){if(!this.isVisible)return;this.removeControls(),this.isVisible=!0;let s=this.getButtons(),l=[];this.options.drawControls===!1&&(l=l.concat(Object.keys(s).filter(h=>!s[h]._button.tool))),this.options.editControls===!1&&(l=l.concat(Object.keys(s).filter(h=>s[h]._button.tool==="edit"))),this.options.optionsControls===!1&&(l=l.concat(Object.keys(s).filter(h=>s[h]._button.tool==="options"))),this.options.customControls===!1&&(l=l.concat(Object.keys(s).filter(h=>s[h]._button.tool==="custom")));for(let h in s)if(this.options[h]&&l.indexOf(h)===-1){let g=s[h]._button.tool;g||(g="draw"),s[h].setPosition(this._getBtnPosition(g)),s[h].addTo(this.map)}},_getBtnPosition(s){return this.options.positions&&this.options.positions[s]?this.options.positions[s]:this.options.position},setBlockPosition(s,l){this.options.positions[s]=l,this._showHideButtons(),this.changeControlOrder()},getBlockPositions(){return this.options.positions},copyDrawControl(s,l){if(l)typeof l!="object"&&(l={name:l});else throw new TypeError("Button has no name");let h=this._btnNameMapping(s);if(!l.name)throw new TypeError("Button has no name");if(this.buttons[l.name])throw new TypeError("Button with this name already exists");let g=this.map.pm.Draw.createNewDrawInstance(l.name,h);l={...this.buttons[h]._button,...l};let _=this.createCustomControl(l);return{drawInstance:g,control:_}},createCustomControl(s){if(!s.name)throw new TypeError("Button has no name");if(this.buttons[s.name])throw new TypeError("Button with this name already exists");s.onClick||(s.onClick=()=>{}),s.afterClick||(s.afterClick=()=>{}),s.toggle!==!1&&(s.toggle=!0),s.block&&(s.block=s.block.toLowerCase()),(!s.block||s.block==="draw")&&(s.block=""),s.className?s.className.indexOf("control-icon")===-1&&(s.className=`control-icon ${s.className}`):s.className="control-icon";let l={tool:s.block,className:s.className,title:s.title||"",jsClass:s.name,onClick:s.onClick,afterClick:s.afterClick,doToggle:s.toggle,toggleStatus:!1,disableOtherButtons:s.disableOtherButtons??!0,disableByOtherButtons:s.disableByOtherButtons??!0,cssToggle:s.toggle,position:this.options.position,actions:s.actions||[],disabled:!!s.disabled};this.options[s.name]!==!1&&(this.options[s.name]=!0);let h=this._addButton(s.name,new L.Control.PMButton(l));return this.changeControlOrder(),h},controlExists(s){return!!this.getButton(s)},getButton(s){return this.getButtons()[s]},getButtonsInBlock(s){let l={};if(s)for(let h in this.getButtons()){let g=this.getButtons()[h];(g._button.tool===s||s==="draw"&&!g._button.tool)&&(l[h]=g)}return l},changeControlOrder(s=[]){let l=this._shapeMapping(),h=[];s.forEach(E=>{l[E]?h.push(l[E]):h.push(E)});let g=this.getButtons(),_={};h.forEach(E=>{g[E]&&(_[E]=g[E])}),Object.keys(g).filter(E=>!g[E]._button.tool||g[E]._button.tool==="draw").forEach(E=>{h.indexOf(E)===-1&&(_[E]=g[E])}),Object.keys(g).filter(E=>g[E]._button.tool==="edit").forEach(E=>{h.indexOf(E)===-1&&(_[E]=g[E])}),Object.keys(g).filter(E=>g[E]._button.tool==="options").forEach(E=>{h.indexOf(E)===-1&&(_[E]=g[E])}),Object.keys(g).filter(E=>g[E]._button.tool==="custom").forEach(E=>{h.indexOf(E)===-1&&(_[E]=g[E])}),Object.keys(g).forEach(E=>{h.indexOf(E)===-1&&(_[E]=g[E])}),this.map.pm.Toolbar.buttons=_,this._showHideButtons()},getControlOrder(){let s=this.getButtons(),l=[];for(let h in s)l.push(h);return l},changeActionsOfControl(s,l){let h=this._btnNameMapping(s);if(!h)throw new TypeError("No name passed");if(!l)throw new TypeError("No actions passed");if(!this.buttons[h])throw new TypeError("Button with this name not exists");this.buttons[h]._button.actions=l,this.changeControlOrder()},setButtonDisabled(s,l){let h=this._btnNameMapping(s);l?this.buttons[h].disable():this.buttons[h].enable()},_shapeMapping(){return{Marker:"drawMarker",Circle:"drawCircle",Polygon:"drawPolygon",Rectangle:"drawRectangle",Polyline:"drawPolyline",Line:"drawPolyline",CircleMarker:"drawCircleMarker",Edit:"editMode",Drag:"dragMode",Cut:"cutPolygon",Removal:"removalMode",Rotate:"rotateMode",Text:"drawText"}},_btnNameMapping(s){let l=this._shapeMapping();return l[s]?l[s]:s}}),$a=Ua,ba=f(Gr()),wo={_initSnappableMarkers(){this.options.snapDistance=this.options.snapDistance||30,this.options.snapSegment=this.options.snapSegment===void 0?!0:this.options.snapSegment,this._assignEvents(this._markers),this._layer.off("pm:dragstart",this._unsnap,this),this._layer.on("pm:dragstart",this._unsnap,this)},_disableSnapping(){this._layer.off("pm:dragstart",this._unsnap,this)},_assignEvents(s){s.forEach(l=>{if(Array.isArray(l)){this._assignEvents(l);return}l.off("drag",this._handleSnapping,this),l.on("drag",this._handleSnapping,this),l.off("dragend",this._cleanupSnapping,this),l.on("dragend",this._cleanupSnapping,this)})},_cleanupSnapping(s){if(s){let l=s.target;l._snapped=!1}delete this._snapList,this.throttledList&&(this._map.off("layeradd",this.throttledList,this),this.throttledList=void 0),this._map.off("layerremove",this._handleSnapLayerRemoval,this),this.debugIndicatorLines&&this.debugIndicatorLines.forEach(l=>{l.remove()})},_handleThrottleSnapping(){this.throttledList&&this._createSnapList()},_handleSnapping(s){var R,W,he;let l=s.target;if(l._snapped=!1,this.throttledList||(this.throttledList=L.Util.throttle(this._handleThrottleSnapping,100,this)),((R=s==null?void 0:s.originalEvent)==null?void 0:R.altKey)||((he=(W=this._map)==null?void 0:W.pm)==null?void 0:he.Keyboard.isAltKeyPressed())||(this._snapList===void 0&&(this._createSnapList(),this._map.off("layeradd",this.throttledList,this),this._map.on("layeradd",this.throttledList,this)),this._snapList.length<=0))return!1;let h=this._calcClosestLayer(l.getLatLng(),this._snapList);if(Object.keys(h).length===0)return!1;let g=h.layer instanceof L.Marker||h.layer instanceof L.CircleMarker||!this.options.snapSegment,_;g?_=h.latlng:_=this._checkPrioritiySnapping(h);let E=this.options.snapDistance,B={marker:l,shape:this._shape,snapLatLng:_,segment:h.segment,layer:this._layer,workingLayer:this._layer,layerInteractedWith:h.layer,distance:h.distance};if(this._fireSnapDrag(B.marker,B),this._fireSnapDrag(this._layer,B),h.distance<E){l._orgLatLng=l.getLatLng(),l.setLatLng(_),l._snapped=!0,l._snapInfo=B;let Ie=()=>{this._snapLatLng=_,this._fireSnap(l,B),this._fireSnap(this._layer,B)},Me=this._snapLatLng||{},rt=_||{};(Me.lat!==rt.lat||Me.lng!==rt.lng)&&Ie()}else this._snapLatLng&&(this._unsnap(B),l._snapped=!1,l._snapInfo=void 0,this._fireUnsnap(B.marker,B),this._fireUnsnap(this._layer,B));return!0},_createSnapList(){let s=[],l=[],h=this._map;h.off("layerremove",this._handleSnapLayerRemoval,this),h.on("layerremove",this._handleSnapLayerRemoval,this),h.eachLayer(g=>{if((g instanceof L.Polyline||g instanceof L.Marker||g instanceof L.CircleMarker||g instanceof L.ImageOverlay)&&g.options.snapIgnore!==!0){if(g.options.snapIgnore===void 0&&(!L.PM.optIn&&g.options.pmIgnore===!0||L.PM.optIn&&g.options.pmIgnore!==!1))return;(g instanceof L.Circle||g instanceof L.CircleMarker)&&g.pm&&g.pm._hiddenPolyCircle?s.push(g.pm._hiddenPolyCircle):g instanceof L.ImageOverlay&&(g=L.rectangle(g.getBounds())),s.push(g);let _=L.polyline([],{color:"red",pmIgnore:!0});_._pmTempLayer=!0,l.push(_),(g instanceof L.Circle||g instanceof L.CircleMarker)&&l.push(_)}}),s=s.filter(g=>this._layer!==g),s=s.filter(g=>g._latlng||g._latlngs&&br(g._latlngs)),s=s.filter(g=>!g._pmTempLayer),this._otherSnapLayers?(this._otherSnapLayers.forEach(()=>{let g=L.polyline([],{color:"red",pmIgnore:!0});g._pmTempLayer=!0,l.push(g)}),this._snapList=s.concat(this._otherSnapLayers)):this._snapList=s,this.debugIndicatorLines=l},_handleSnapLayerRemoval({layer:s}){if(!s._leaflet_id)return;let l=this._snapList.findIndex(h=>h._leaflet_id===s._leaflet_id);l>-1&&this._snapList.splice(l,1)},_calcClosestLayer(s,l){return this._calcClosestLayers(s,l,1)[0]},_calcClosestLayers(s,l,h=1){let g=[],_={};l.forEach((B,R)=>{var he;if(B._parentCopy&&B._parentCopy===this._layer||((he=B.getLatLngs)==null?void 0:he.call(B).flat(5).length)<2)return;let W=this._calcLayerDistances(s,B);if(W.distance=Math.floor(W.distance),this.debugIndicatorLines){if(!this.debugIndicatorLines[R]){let Ie=L.polyline([],{color:"red",pmIgnore:!0});Ie._pmTempLayer=!0,this.debugIndicatorLines[R]=Ie}this.debugIndicatorLines[R].setLatLngs([s,W.latlng])}h===1&&(_.distance===void 0||W.distance-5<=_.distance)?(W.distance+5<_.distance&&(g=[]),_=W,_.layer=B,g.push(_)):h!==1&&(_={},_=W,_.layer=B,g.push(_))}),h!==1&&(g=g.sort((B,R)=>B.distance-R.distance)),h===-1&&(h=g.length);let E=this._getClosestLayerByPriority(g,h);return L.Util.isArray(E)?E:[E]},_calcLayerDistances(s,l){let h=this._map,g=l instanceof L.Marker||l instanceof L.CircleMarker,_=l instanceof L.Polygon,E=s;if(g){let B=l.getLatLng();return{latlng:{...B},distance:this._getDistance(h,B,E)}}return this._calcLatLngDistances(E,l.getLatLngs(),h,_)},_calcLatLngDistances(s,l,h,g=!1){let _,E,B,R=W=>{W.forEach((he,Ie)=>{if(Array.isArray(he)){R(he);return}if(this.options.snapSegment){let Me=he,rt;g?rt=Ie+1===W.length?0:Ie+1:rt=Ie+1===W.length?void 0:Ie+1;let pt=W[rt];if(pt){let Dt=this._getDistanceToSegment(h,s,Me,pt);(E===void 0||Dt<E)&&(E=Dt,B=[Me,pt])}}else{let Me=this._getDistance(h,s,he);(E===void 0||Me<E)&&(E=Me,_=he)}})};return R(l),this.options.snapSegment?{latlng:{...this._getClosestPointOnSegment(h,s,B[0],B[1])},segment:B,distance:E}:{latlng:_,distance:E}},_getClosestLayerByPriority(s,l=1){s=s.sort((B,R)=>B._leaflet_id-R._leaflet_id);let h=["Marker","CircleMarker","Circle","Line","Polygon","Rectangle"],g=this._map.pm.globalOptions.snappingOrder||[],_=0,E={};return g.concat(h).forEach(B=>{E[B]||(_+=1,E[B]=_)}),s.sort(va("instanceofShape",E)),l===1?s[0]||{}:s.slice(0,l)},_checkPrioritiySnapping(s){let l=this._map,h=s.segment[0],g=s.segment[1],_=s.latlng,E=_;if(this.options.snapVertex){let B=this._getDistance(l,h,_),R=this._getDistance(l,g,_),W=B<R?h:g,he=B<R?B:R;if(this.options.snapMiddle){let Me=L.PM.Utils.calcMiddleLatLng(l,h,g),rt=this._getDistance(l,Me,_);rt<B&&rt<R&&(W=Me,he=rt)}let Ie=this.options.snapDistance;he<Ie&&(E=W)}return{...E}},_unsnap(){delete this._snapLatLng},_getClosestPointOnSegment(s,l,h,g){let _=s.getMaxZoom();_===1/0&&(_=s.getZoom());let E=s.project(l,_),B=s.project(h,_),R=s.project(g,_),W=L.LineUtil.closestPointOnSegment(E,B,R);return s.unproject(W,_)},_getDistanceToSegment(s,l,h,g){let _=s.latLngToContainerPoint(l),E=s.latLngToContainerPoint(h),B=s.latLngToContainerPoint(g);return L.LineUtil.pointToSegmentDistance(_,E,B)},_getDistance(s,l,h){return s.latLngToContainerPoint(l).distanceTo(s.latLngToContainerPoint(h))}},Go=wo,xo=L.Class.extend({includes:[Go,$o],options:{snappable:!0,snapDistance:20,snapMiddle:!1,allowSelfIntersection:!0,tooltips:!0,templineStyle:{},hintlineStyle:{color:"#3388ff",dashArray:"5,5"},pathOptions:null,cursorMarker:!0,finishOn:null,markerStyle:{draggable:!0,icon:L.icon()},hideMiddleMarkers:!1,minRadiusCircle:null,maxRadiusCircle:null,minRadiusCircleMarker:null,maxRadiusCircleMarker:null,resizeableCircleMarker:!1,resizeableCircle:!0,markerEditable:!0,continueDrawing:!1,snapSegment:!0,requireSnapToFinish:!1,rectangleAngle:0,textOptions:{text:null,focusAfterDraw:null,removeIfEmpty:null,className:null},snapVertex:!0},setOptions(s){L.Util.setOptions(this,s),this.setStyle(this.options)},setStyle(){},getOptions(){return this.options},initialize(s){let l=new L.Icon.Default;l.options.tooltipAnchor=[0,0],this.options.markerStyle.icon=l,this._map=s,this.shapes=["Marker","CircleMarker","Line","Polygon","Rectangle","Circle","Cut","Text"],this.shapes.forEach(h=>{this[h]=new L.PM.Draw[h](this._map)}),this.Marker.setOptions({continueDrawing:!0}),this.CircleMarker.setOptions({continueDrawing:!0})},setPathOptions(s,l=!1){l?this.options.pathOptions=(0,ba.default)(this.options.pathOptions,s):this.options.pathOptions=s},getShapes(){return this.shapes},getShape(){return this._shape},enable(s,l){if(!s)throw new Error(`Error: Please pass a shape as a parameter. Possible shapes are: ${this.getShapes().join(",")}`);this.disable(),this[s].enable(l)},disable(){this.shapes.forEach(s=>{this[s].disable()})},addControls(){this.shapes.forEach(s=>{this[s].addButton()})},getActiveShape(){let s;return this.shapes.forEach(l=>{this[l]._enabled&&(s=l)}),s},_setGlobalDrawMode(){this._shape==="Cut"?this._fireGlobalCutModeToggled():this._fireGlobalDrawModeToggled();let s=[];this._map.eachLayer(l=>{(l instanceof L.Polyline||l instanceof L.Marker||l instanceof L.Circle||l instanceof L.CircleMarker||l instanceof L.ImageOverlay)&&(l._pmTempLayer||s.push(l))}),this._enabled?s.forEach(l=>{L.PM.Utils.disablePopup(l)}):s.forEach(l=>{L.PM.Utils.enablePopup(l)})},createNewDrawInstance(s,l){let h=this._getShapeFromBtnName(l);if(this[s])throw new TypeError("Draw Type already exists");if(!L.PM.Draw[h])throw new TypeError(`There is no class L.PM.Draw.${h}`);return this[s]=new L.PM.Draw[h](this._map),this[s].toolbarButtonName=s,this[s]._shape=s,this.shapes.push(s),this[l]&&this[s].setOptions(this[l].options),this[s].setOptions(this[s].options),this[s]},_getShapeFromBtnName(s){let l={drawMarker:"Marker",drawCircle:"Circle",drawPolygon:"Polygon",drawPolyline:"Line",drawRectangle:"Rectangle",drawCircleMarker:"CircleMarker",editMode:"Edit",dragMode:"Drag",cutPolygon:"Cut",removalMode:"Removal",rotateMode:"Rotate",drawText:"Text"};return l[s]?l[s]:this[s]?this[s]._shape:s},_finishLayer(s){s.pm&&(s.pm.setOptions(this.options),s.pm._shape=this._shape,s.pm._map=this._map),this._addDrawnLayerProp(s)},_addDrawnLayerProp(s){s._drawnByGeoman=!0},_setPane(s,l){l==="layerPane"?s.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.layerPane||"overlayPane":l==="vertexPane"?s.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.vertexPane||"markerPane":l==="markerPane"&&(s.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.markerPane||"markerPane")},_isFirstLayer(){return(this._map||this._layer._map).pm.getGeomanLayers().length===0}}),Ti=xo;Ti.Marker=Ti.extend({initialize(s){this._map=s,this._shape="Marker",this.toolbarButtonName="drawMarker"},enable(s){L.Util.setOptions(this,s),this._enabled=!0,this._map.getContainer().classList.add("geoman-draw-cursor"),this._map.on("click",this._createMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._hintMarker=L.marker(this._map.getCenter(),this.options.markerStyle),this._setPane(this._hintMarker,"markerPane"),this._hintMarker._pmTempLayer=!0,this._hintMarker.addTo(this._map),this.options.tooltips&&this._hintMarker.bindTooltip(dn("tooltips.placeMarker"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this._layer=this._hintMarker,this._map.on("mousemove",this._syncHintMarker,this),this.options.markerEditable&&this._map.eachLayer(l=>{this.isRelevantMarker(l)&&l.pm.enable()}),this._fireDrawStart(),this._setGlobalDrawMode()},disable(){this._enabled&&(this._enabled=!1,this._map.getContainer().classList.remove("geoman-draw-cursor"),this._map.off("click",this._createMarker,this),this._hintMarker.remove(),this._map.off("mousemove",this._syncHintMarker,this),this._map.eachLayer(s=>{this.isRelevantMarker(s)&&s.pm.disable()}),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},enabled(){return this._enabled},toggle(s){this.enabled()?this.disable():this.enable(s)},isRelevantMarker(s){return s instanceof L.Marker&&s.pm&&!s._pmTempLayer&&!s.pm._initTextMarker},_syncHintMarker(s){if(this._hintMarker.setLatLng(s.latlng),this.options.snappable){let l=s;l.target=this._hintMarker,this._handleSnapping(l)}this._fireChange(this._hintMarker.getLatLng(),"Draw")},_createMarker(s){if(!s.latlng||this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;this._hintMarker._snapped||this._hintMarker.setLatLng(s.latlng);let l=this._hintMarker.getLatLng(),h=new L.Marker(l,this.options.markerStyle);this._setPane(h,"markerPane"),this._finishLayer(h),h.pm||(h.options.draggable=!1),h.addTo(this._map.pm._getContainingLayer()),h.pm&&this.options.markerEditable?h.pm.enable():h.dragging&&h.dragging.disable(),this._fireCreate(h),this._cleanupSnapping(),this.options.continueDrawing||this.disable()},setStyle(){var s,l;(s=this.options.markerStyle)!=null&&s.icon&&((l=this._hintMarker)==null||l.setIcon(this.options.markerStyle.icon))}});var P=63710088e-1,te={centimeters:P*100,centimetres:P*100,degrees:P/111325,feet:P*3.28084,inches:P*39.37,kilometers:P/1e3,kilometres:P/1e3,meters:P,metres:P,miles:P/1609.344,millimeters:P*1e3,millimetres:P*1e3,nauticalmiles:P/1852,radians:1,yards:P*1.0936};function Ne(s,l,h){h===void 0&&(h={});var g={type:"Feature"};return(h.id===0||h.id)&&(g.id=h.id),h.bbox&&(g.bbox=h.bbox),g.properties=l||{},g.geometry=s,g}function Ke(s,l,h){if(h===void 0&&(h={}),!s)throw new Error("coordinates is required");if(!Array.isArray(s))throw new Error("coordinates must be an Array");if(s.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Ln(s[0])||!Ln(s[1]))throw new Error("coordinates must contain numbers");var g={type:"Point",coordinates:s};return Ne(g,l,h)}function ct(s,l,h){if(h===void 0&&(h={}),s.length<2)throw new Error("coordinates must be an array of two or more positions");var g={type:"LineString",coordinates:s};return Ne(g,l,h)}function Lt(s,l){l===void 0&&(l={});var h={type:"FeatureCollection"};return l.id&&(h.id=l.id),l.bbox&&(h.bbox=l.bbox),h.features=s,h}function Ut(s,l){l===void 0&&(l="kilometers");var h=te[l];if(!h)throw new Error(l+" units is invalid");return s*h}function Kt(s,l){l===void 0&&(l="kilometers");var h=te[l];if(!h)throw new Error(l+" units is invalid");return s/h}function en(s){var l=s%(2*Math.PI);return l*180/Math.PI}function un(s){var l=s%360;return l*Math.PI/180}function Ln(s){return!isNaN(s)&&s!==null&&!Array.isArray(s)}function zn(s){var l,h,g={type:"FeatureCollection",features:[]};if(s.type==="Feature"?h=s.geometry:h=s,h.type==="LineString")l=[h.coordinates];else if(h.type==="MultiLineString")l=h.coordinates;else if(h.type==="MultiPolygon")l=[].concat.apply([],h.coordinates);else if(h.type==="Polygon")l=h.coordinates;else throw new Error("Input must be a LineString, MultiLineString, Polygon, or MultiPolygon Feature or Geometry");return l.forEach(function(_){l.forEach(function(E){for(var B=0;B<_.length-1;B++)for(var R=B;R<E.length-1;R++)if(!(_===E&&(Math.abs(B-R)===1||B===0&&R===_.length-2&&_[B][0]===_[_.length-1][0]&&_[B][1]===_[_.length-1][1]))){var W=mi(_[B][0],_[B][1],_[B+1][0],_[B+1][1],E[R][0],E[R][1],E[R+1][0],E[R+1][1]);W&&g.features.push(Ke([W[0],W[1]]))}})}),g}function mi(s,l,h,g,_,E,B,R){var W,he,Ie,Me,rt,pt={x:null,y:null,onLine1:!1,onLine2:!1};return W=(R-E)*(h-s)-(B-_)*(g-l),W===0?pt.x!==null&&pt.y!==null?pt:!1:(he=l-E,Ie=s-_,Me=(B-_)*he-(R-E)*Ie,rt=(h-s)*he-(g-l)*Ie,he=Me/W,Ie=rt/W,pt.x=s+he*(h-s),pt.y=l+he*(g-l),he>=0&&he<=1&&(pt.onLine1=!0),Ie>=0&&Ie<=1&&(pt.onLine2=!0),pt.onLine1&&pt.onLine2?[pt.x,pt.y]:!1)}Ti.Line=Ti.extend({initialize(s){this._map=s,this._shape="Line",this.toolbarButtonName="drawPolyline",this._doesSelfIntersect=!1},enable(s){L.Util.setOptions(this,s),this._enabled=!0,this._markers=[],this._layerGroup=new L.FeatureGroup,this._layerGroup._pmTempLayer=!0,this._layerGroup.addTo(this._map),this._layer=L.polyline([],{...this.options.templineStyle,pmIgnore:!1}),this._setPane(this._layer,"layerPane"),this._layer._pmTempLayer=!0,this._layerGroup.addLayer(this._layer),this._hintline=L.polyline([],this.options.hintlineStyle),this._setPane(this._hintline,"layerPane"),this._hintline._pmTempLayer=!0,this._layerGroup.addLayer(this._hintline),this._hintMarker=L.marker(this._map.getCenter(),{interactive:!1,zIndexOffset:100,icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._setPane(this._hintMarker,"vertexPane"),this._hintMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._hintMarker),this.options.cursorMarker&&L.DomUtil.addClass(this._hintMarker._icon,"visible"),this.options.tooltips&&this._hintMarker.bindTooltip(dn("tooltips.firstVertex"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this._map.getContainer().classList.add("geoman-draw-cursor"),this._map.on("click",this._createVertex,this),this.options.finishOn&&this.options.finishOn!=="snap"&&this._map.on(this.options.finishOn,this._finishShape,this),this.options.finishOn==="dblclick"&&(this.tempMapDoubleClickZoomState=this._map.doubleClickZoom._enabled,this.tempMapDoubleClickZoomState&&this._map.doubleClickZoom.disable()),this._map.on("mousemove",this._syncHintMarker,this),this._hintMarker.on("move",this._syncHintLine,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._otherSnapLayers=[],this.isRed=!1,this._fireDrawStart(),this._setGlobalDrawMode()},disable(){this._enabled&&(this._enabled=!1,this._map.getContainer().classList.remove("geoman-draw-cursor"),this._map.off("click",this._createVertex,this),this._map.off("mousemove",this._syncHintMarker,this),this.options.finishOn&&this.options.finishOn!=="snap"&&this._map.off(this.options.finishOn,this._finishShape,this),this.tempMapDoubleClickZoomState&&this._map.doubleClickZoom.enable(),this._map.removeLayer(this._layerGroup),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},enabled(){return this._enabled},toggle(s){this.enabled()?this.disable():this.enable(s)},_syncHintLine(){let s=this._layer.getLatLngs();if(s.length>0){let l=s[s.length-1];this._hintline.setLatLngs([l,this._hintMarker.getLatLng()])}},_syncHintMarker(s){if(this._hintMarker.setLatLng(s.latlng),this.options.snappable){let h=s;h.target=this._hintMarker,this._handleSnapping(h)}this.options.allowSelfIntersection||this._handleSelfIntersection(!0,this._hintMarker.getLatLng());let l=this._layer._defaultShape().slice();l.push(this._hintMarker.getLatLng()),this._change(l)},hasSelfIntersection(){return zn(this._layer.toGeoJSON(15)).features.length>0},_handleSelfIntersection(s,l){let h=L.polyline(this._layer.getLatLngs());s&&(l||(l=this._hintMarker.getLatLng()),h.addLatLng(l));let g=zn(h.toGeoJSON(15));this._doesSelfIntersect=g.features.length>0,this._doesSelfIntersect?this.isRed||(this.isRed=!0,this._hintline.setStyle({color:"#f00000ff"}),this._fireIntersect(g,this._map,"Draw")):this._hintline.isEmpty()||(this.isRed=!1,this._hintline.setStyle(this.options.hintlineStyle))},_createVertex(s){if(!this.options.allowSelfIntersection&&(this._handleSelfIntersection(!0,s.latlng),this._doesSelfIntersect))return;this._hintMarker._snapped||this._hintMarker.setLatLng(s.latlng);let l=this._hintMarker.getLatLng(),h=this._layer.getLatLngs(),g=h[h.length-1];if(l.equals(h[0])||h.length>0&&l.equals(g)){this._finishShape();return}this._layer._latlngInfo=this._layer._latlngInfo||[],this._layer._latlngInfo.push({latlng:l,snapInfo:this._hintMarker._snapInfo}),this._layer.addLatLng(l);let _=this._createMarker(l);this._setTooltipText(),this._setHintLineAfterNewVertex(l),this._fireVertexAdded(_,void 0,l,"Draw"),this._change(this._layer.getLatLngs()),this.options.finishOn==="snap"&&this._hintMarker._snapped&&this._finishShape(s)},_setHintLineAfterNewVertex(s){this._hintline.setLatLngs([s,s])},_removeLastVertex(){let s=this._markers;if(s.length<=1){this.disable();return}let l=this._layer.getLatLngs(),h=s[s.length-1],{indexPath:g}=L.PM.Utils.findDeepMarkerIndex(s,h);s.pop(),this._layerGroup.removeLayer(h);let _=s[s.length-1],E=l.indexOf(_.getLatLng());l=l.slice(0,E+1),this._layer.setLatLngs(l),this._layer._latlngInfo.pop(),this._syncHintLine(),this._setTooltipText(),this._fireVertexRemoved(h,g,"Draw"),this._change(this._layer.getLatLngs())},_finishShape(){if(!this.options.allowSelfIntersection&&(this._handleSelfIntersection(!1),this._doesSelfIntersect)||this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;let s=this._layer.getLatLngs();if(s.length<=1)return;let l=L.polyline(s,this.options.pathOptions);this._setPane(l,"layerPane"),this._finishLayer(l),l.addTo(this._map.pm._getContainingLayer()),this._fireCreate(l),this.options.snappable&&this._cleanupSnapping();let h=this._hintMarker.getLatLng();this.disable(),this.options.continueDrawing&&(this.enable(),this._hintMarker.setLatLng(h))},_createMarker(s){let l=new L.Marker(s,{draggable:!1,icon:L.divIcon({className:"marker-icon"})});return this._setPane(l,"vertexPane"),l._pmTempLayer=!0,this._layerGroup.addLayer(l),this._markers.push(l),l.on("click",this._finishShape,this),l},_setTooltipText(){let{length:s}=this._layer.getLatLngs().flat(),l="";s<=1?l=dn("tooltips.continueLine"):l=dn("tooltips.finishLine"),this._hintMarker.setTooltipContent(l)},_change(s){this._fireChange(s,"Draw")},setStyle(){var s,l;(s=this._layer)==null||s.setStyle(this.options.templineStyle),(l=this._hintline)==null||l.setStyle(this.options.hintlineStyle)}}),Ti.Polygon=Ti.Line.extend({initialize(s){this._map=s,this._shape="Polygon",this.toolbarButtonName="drawPolygon"},enable(s){L.PM.Draw.Line.prototype.enable.call(this,s),this._layer.pm._shape="Polygon"},_createMarker(s){let l=new L.Marker(s,{draggable:!1,icon:L.divIcon({className:"marker-icon"})});return this._setPane(l,"vertexPane"),l._pmTempLayer=!0,this._layerGroup.addLayer(l),this._markers.push(l),this._layer.getLatLngs().flat().length===1?(l.on("click",this._finishShape,this),this._tempSnapLayerIndex=this._otherSnapLayers.push(l)-1,this.options.snappable&&this._cleanupSnapping()):l.on("click",()=>1),l},_setTooltipText(){let{length:s}=this._layer.getLatLngs().flat(),l="";s<=2?l=dn("tooltips.continueLine"):l=dn("tooltips.finishPoly"),this._hintMarker.setTooltipContent(l)},_finishShape(){if(!this.options.allowSelfIntersection&&(this._handleSelfIntersection(!0,this._layer.getLatLngs()[0]),this._doesSelfIntersect)||this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;let s=this._layer.getLatLngs();if(s.length<=2)return;let l=L.polygon(s,this.options.pathOptions);this._setPane(l,"layerPane"),this._finishLayer(l),l.addTo(this._map.pm._getContainingLayer()),this._fireCreate(l),this._cleanupSnapping(),this._otherSnapLayers.splice(this._tempSnapLayerIndex,1),delete this._tempSnapLayerIndex;let h=this._hintMarker.getLatLng();this.disable(),this.options.continueDrawing&&(this.enable(),this._hintMarker.setLatLng(h))}}),Ti.Rectangle=Ti.extend({initialize(s){this._map=s,this._shape="Rectangle",this.toolbarButtonName="drawRectangle"},enable(s){if(L.Util.setOptions(this,s),this._enabled=!0,this._layerGroup=new L.FeatureGroup,this._layerGroup._pmTempLayer=!0,this._layerGroup.addTo(this._map),this._layer=L.rectangle([[0,0],[0,0]],this.options.pathOptions),this._setPane(this._layer,"layerPane"),this._layer._pmTempLayer=!0,this._startMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"marker-icon rect-start-marker"}),draggable:!1,zIndexOffset:-100,opacity:this.options.cursorMarker?1:0}),this._setPane(this._startMarker,"vertexPane"),this._startMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._startMarker),this._hintMarker=L.marker(this._map.getCenter(),{zIndexOffset:150,icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._setPane(this._hintMarker,"vertexPane"),this._hintMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._hintMarker),this.options.cursorMarker&&L.DomUtil.addClass(this._hintMarker._icon,"visible"),this.options.tooltips&&this._hintMarker.bindTooltip(dn("tooltips.firstVertex"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this.options.cursorMarker){this._styleMarkers=[];for(let l=0;l<2;l+=1){let h=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"marker-icon rect-style-marker"}),draggable:!1,zIndexOffset:100});this._setPane(h,"vertexPane"),h._pmTempLayer=!0,this._layerGroup.addLayer(h),this._styleMarkers.push(h)}}this._map.getContainer().classList.add("geoman-draw-cursor"),this._map.on("click",this._placeStartingMarkers,this),this._map.on("mousemove",this._syncHintMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._otherSnapLayers=[],this._fireDrawStart(),this._setGlobalDrawMode()},disable(){this._enabled&&(this._enabled=!1,this._map.getContainer().classList.remove("geoman-draw-cursor"),this._map.off("click",this._finishShape,this),this._map.off("click",this._placeStartingMarkers,this),this._map.off("mousemove",this._syncHintMarker,this),this._map.removeLayer(this._layerGroup),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},enabled(){return this._enabled},toggle(s){this.enabled()?this.disable():this.enable(s)},_placeStartingMarkers(s){this._hintMarker._snapped||this._hintMarker.setLatLng(s.latlng);let l=this._hintMarker.getLatLng();L.DomUtil.addClass(this._startMarker._icon,"visible"),this._startMarker.setLatLng(l),this.options.cursorMarker&&this._styleMarkers&&this._styleMarkers.forEach(h=>{L.DomUtil.addClass(h._icon,"visible"),h.setLatLng(l)}),this._map.off("click",this._placeStartingMarkers,this),this._map.on("click",this._finishShape,this),this._hintMarker.setTooltipContent(dn("tooltips.finishRect")),this._setRectangleOrigin()},_setRectangleOrigin(){let s=this._startMarker.getLatLng();s&&(this._layerGroup.addLayer(this._layer),this._layer.setLatLngs([s,s]),this._hintMarker.on("move",this._syncRectangleSize,this))},_syncHintMarker(s){if(this._hintMarker.setLatLng(s.latlng),this.options.snappable){let h=s;h.target=this._hintMarker,this._handleSnapping(h)}let l=this._layerGroup&&this._layerGroup.hasLayer(this._layer)?this._layer.getLatLngs():[this._hintMarker.getLatLng()];this._fireChange(l,"Draw")},_syncRectangleSize(){let s=ya(this._startMarker.getLatLng(),this._map),l=ya(this._hintMarker.getLatLng(),this._map),h=L.PM.Utils._getRotatedRectangle(s,l,this.options.rectangleAngle||0,this._map);if(this._layer.setLatLngs(h),this.options.cursorMarker&&this._styleMarkers){let g=[];h.forEach(_=>{!_.equals(s,1e-8)&&!_.equals(l,1e-8)&&g.push(_)}),g.forEach((_,E)=>{try{this._styleMarkers[E].setLatLng(_)}catch{}})}},_findCorners(){let s=this._layer.getLatLngs()[0];return L.PM.Utils._getRotatedRectangle(s[0],s[2],this.options.rectangleAngle||0,this._map)},_finishShape(s){this._hintMarker._snapped||this._hintMarker.setLatLng(s.latlng);let l=this._hintMarker.getLatLng(),h=this._startMarker.getLatLng();if(this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer()||h.equals(l))return;let g=L.rectangle([h,l],this.options.pathOptions);if(this.options.rectangleAngle){let E=L.PM.Utils._getRotatedRectangle(h,l,this.options.rectangleAngle||0,this._map);g.setLatLngs(E),g.pm&&g.pm._setAngle(this.options.rectangleAngle||0)}this._setPane(g,"layerPane"),this._finishLayer(g),g.addTo(this._map.pm._getContainingLayer()),this._fireCreate(g);let _=this._hintMarker.getLatLng();this.disable(),this.options.continueDrawing&&(this.enable(),this._hintMarker.setLatLng(_))},setStyle(){var s;(s=this._layer)==null||s.setStyle(this.options.pathOptions)}}),Ti.CircleMarker=Ti.extend({initialize(s){this._map=s,this._shape="CircleMarker",this.toolbarButtonName="drawCircleMarker",this._layerIsDragging=!1,this._BaseCircleClass=L.CircleMarker,this._minRadiusOption="minRadiusCircleMarker",this._maxRadiusOption="maxRadiusCircleMarker",this._editableOption="resizeableCircleMarker",this._defaultRadius=10},enable(s){if(L.Util.setOptions(this,s),this.options.editable&&(this.options.resizeableCircleMarker=this.options.editable,delete this.options.editable),this._enabled=!0,this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._map.getContainer().classList.add("geoman-draw-cursor"),this.options[this._editableOption]){let l={};L.extend(l,this.options.templineStyle),l.radius=0,this._layerGroup=new L.FeatureGroup,this._layerGroup._pmTempLayer=!0,this._layerGroup.addTo(this._map),this._layer=new this._BaseCircleClass(this._map.getCenter(),l),this._setPane(this._layer,"layerPane"),this._layer._pmTempLayer=!0,this._centerMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"marker-icon"}),draggable:!1,zIndexOffset:100}),this._setPane(this._centerMarker,"vertexPane"),this._centerMarker._pmTempLayer=!0,this._hintMarker=L.marker(this._map.getCenter(),{zIndexOffset:110,icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._setPane(this._hintMarker,"vertexPane"),this._hintMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._hintMarker),this.options.cursorMarker&&L.DomUtil.addClass(this._hintMarker._icon,"visible"),this.options.tooltips&&this._hintMarker.bindTooltip(dn("tooltips.startCircle"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this._hintline=L.polyline([],this.options.hintlineStyle),this._setPane(this._hintline,"layerPane"),this._hintline._pmTempLayer=!0,this._layerGroup.addLayer(this._hintline),this._map.on("click",this._placeCenterMarker,this)}else this._map.on("click",this._createMarker,this),this._hintMarker=new this._BaseCircleClass(this._map.getCenter(),{radius:this._defaultRadius,...this.options.templineStyle}),this._setPane(this._hintMarker,"layerPane"),this._hintMarker._pmTempLayer=!0,this._hintMarker.addTo(this._map),this._layer=this._hintMarker,this.options.tooltips&&this._hintMarker.bindTooltip(dn("tooltips.placeCircleMarker"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip();this._map.on("mousemove",this._syncHintMarker,this),this._extendingEnable(),this._otherSnapLayers=[],this._fireDrawStart(),this._setGlobalDrawMode()},_extendingEnable(){!this.options[this._editableOption]&&this.options.markerEditable&&this._map.eachLayer(s=>{this.isRelevantMarker(s)&&s.pm.enable()}),this._layer.bringToBack()},disable(){this._enabled&&(this._enabled=!1,this._map.getContainer().classList.remove("geoman-draw-cursor"),this.options[this._editableOption]?(this._map.off("click",this._finishShape,this),this._map.off("click",this._placeCenterMarker,this),this._map.removeLayer(this._layerGroup)):(this._map.off("click",this._createMarker,this),this._extendingDisable(),this._hintMarker.remove()),this._map.off("mousemove",this._syncHintMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},_extendingDisable(){this._map.eachLayer(s=>{this.isRelevantMarker(s)&&s.pm.disable()})},enabled(){return this._enabled},toggle(s){this.enabled()?this.disable():this.enable(s)},_placeCenterMarker(s){this._hintMarker._snapped||this._hintMarker.setLatLng(s.latlng),this._layerGroup.addLayer(this._layer),this._layerGroup.addLayer(this._centerMarker);let l=this._hintMarker.getLatLng();this._centerMarker.setLatLng(l),this._map.off("click",this._placeCenterMarker,this),this._map.on("click",this._finishShape,this),this._placeCircleCenter()},_placeCircleCenter(){let s=this._centerMarker.getLatLng();s&&(this._layer.setLatLng(s),this._hintMarker.on("move",this._syncHintLine,this),this._hintMarker.on("move",this._syncCircleRadius,this),this._hintMarker.setTooltipContent(dn("tooltips.finishCircle")),this._fireCenterPlaced(),this._fireChange(this._layer.getLatLng(),"Draw"))},_syncHintLine(){let s=this._centerMarker.getLatLng(),l=this._getNewDestinationOfHintMarker();this._hintline.setLatLngs([s,l])},_syncCircleRadius(){let s=this._centerMarker.getLatLng(),l=this._hintMarker.getLatLng(),h=this._distanceCalculation(s,l);this.options[this._minRadiusOption]&&h<this.options[this._minRadiusOption]?this._layer.setRadius(this.options[this._minRadiusOption]):this.options[this._maxRadiusOption]&&h>this.options[this._maxRadiusOption]?this._layer.setRadius(this.options[this._maxRadiusOption]):this._layer.setRadius(h)},_syncHintMarker(s){if(this._hintMarker.setLatLng(s.latlng),this._hintMarker.setLatLng(this._getNewDestinationOfHintMarker()),this.options.snappable){let h=s;h.target=this._hintMarker,this._handleSnapping(h)}this._handleHintMarkerSnapping();let l=this._layerGroup&&this._layerGroup.hasLayer(this._centerMarker)?this._centerMarker.getLatLng():this._hintMarker.getLatLng();this._fireChange(l,"Draw")},isRelevantMarker(s){return s instanceof L.CircleMarker&&!(s instanceof L.Circle)&&s.pm&&!s._pmTempLayer},_createMarker(s){if(this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer()||!s.latlng||this._layerIsDragging)return;this._hintMarker._snapped||this._hintMarker.setLatLng(s.latlng);let l=this._hintMarker.getLatLng(),h=new this._BaseCircleClass(l,{radius:this._defaultRadius,...this.options.pathOptions});this._setPane(h,"layerPane"),this._finishLayer(h),h.addTo(this._map.pm._getContainingLayer()),this._extendingCreateMarker(h),this._fireCreate(h),this._cleanupSnapping(),this.options.continueDrawing||this.disable()},_extendingCreateMarker(s){s.pm&&this.options.markerEditable&&s.pm.enable()},_finishShape(s){if(this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;this._hintMarker._snapped||this._hintMarker.setLatLng(s.latlng);let l=this._centerMarker.getLatLng(),h=this._defaultRadius;if(this.options[this._editableOption]){let B=this._hintMarker.getLatLng();h=this._distanceCalculation(l,B),this.options[this._minRadiusOption]&&h<this.options[this._minRadiusOption]?h=this.options[this._minRadiusOption]:this.options[this._maxRadiusOption]&&h>this.options[this._maxRadiusOption]&&(h=this.options[this._maxRadiusOption])}let g={...this.options.pathOptions,radius:h},_=new this._BaseCircleClass(l,g);this._setPane(_,"layerPane"),this._finishLayer(_),_.addTo(this._map.pm._getContainingLayer()),_.pm&&_.pm._updateHiddenPolyCircle(),this._fireCreate(_);let E=this._hintMarker.getLatLng();this.disable(),this.options.continueDrawing&&(this.enable(),this._hintMarker.setLatLng(E))},_getNewDestinationOfHintMarker(){let s=this._hintMarker.getLatLng();if(this.options[this._editableOption]){if(!this._layerGroup.hasLayer(this._centerMarker))return s;let l=this._centerMarker.getLatLng(),h=this._distanceCalculation(l,s);this.options[this._minRadiusOption]&&h<this.options[this._minRadiusOption]?s=ma(this._map,l,s,this._getMinDistanceInMeter()):this.options[this._maxRadiusOption]&&h>this.options[this._maxRadiusOption]&&(s=ma(this._map,l,s,this._getMaxDistanceInMeter()))}return s},_getMinDistanceInMeter(){return L.PM.Utils.pxRadiusToMeterRadius(this.options[this._minRadiusOption],this._map,this._centerMarker.getLatLng())},_getMaxDistanceInMeter(){return L.PM.Utils.pxRadiusToMeterRadius(this.options[this._maxRadiusOption],this._map,this._centerMarker.getLatLng())},_handleHintMarkerSnapping(){if(this.options[this._editableOption]){if(this._hintMarker._snapped){let s=this._centerMarker.getLatLng(),l=this._hintMarker.getLatLng(),h=this._distanceCalculation(s,l);this._layerGroup.hasLayer(this._centerMarker)&&(this.options[this._minRadiusOption]&&h<this.options[this._minRadiusOption]?this._hintMarker.setLatLng(this._hintMarker._orgLatLng):this.options[this._maxRadiusOption]&&h>this.options[this._maxRadiusOption]&&this._hintMarker.setLatLng(this._hintMarker._orgLatLng))}this._hintMarker.setLatLng(this._getNewDestinationOfHintMarker())}},setStyle(){var l,h;let s={};L.extend(s,this.options.templineStyle),this.options[this._editableOption]&&(s.radius=0),(l=this._layer)==null||l.setStyle(s),(h=this._hintline)==null||h.setStyle(this.options.hintlineStyle)},_distanceCalculation(s,l){return this._map.project(s).distanceTo(this._map.project(l))}}),Ti.Circle=Ti.CircleMarker.extend({initialize(s){this._map=s,this._shape="Circle",this.toolbarButtonName="drawCircle",this._BaseCircleClass=L.Circle,this._minRadiusOption="minRadiusCircle",this._maxRadiusOption="maxRadiusCircle",this._editableOption="resizeableCircle",this._defaultRadius=100},_extendingEnable(){},_extendingDisable(){},_extendingCreateMarker(){},isRelevantMarker(){},_getMinDistanceInMeter(){return this.options[this._minRadiusOption]},_getMaxDistanceInMeter(){return this.options[this._maxRadiusOption]},_distanceCalculation(s,l){return this._map.distance(s,l)}});function Zn(s){if(!s)throw new Error("coord is required");if(!Array.isArray(s)){if(s.type==="Feature"&&s.geometry!==null&&s.geometry.type==="Point")return s.geometry.coordinates;if(s.type==="Point")return s.coordinates}if(Array.isArray(s)&&s.length>=2&&!Array.isArray(s[0])&&!Array.isArray(s[1]))return s;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function ei(s){if(Array.isArray(s))return s;if(s.type==="Feature"){if(s.geometry!==null)return s.geometry.coordinates}else if(s.coordinates)return s.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function Vi(s){return s.type==="Feature"?s.geometry:s}function Fi(s,l){return s.type==="FeatureCollection"?"FeatureCollection":s.type==="GeometryCollection"?"GeometryCollection":s.type==="Feature"&&s.geometry!==null?s.geometry.type:s.type}function $r(s,l,h){if(s!==null)for(var g,_,E,B,R,W,he,Ie=0,Me=0,rt,pt=s.type,Dt=pt==="FeatureCollection",Vt=pt==="Feature",Ht=Dt?s.features.length:1,wn=0;wn<Ht;wn++){he=Dt?s.features[wn].geometry:Vt?s.geometry:s,rt=he?he.type==="GeometryCollection":!1,R=rt?he.geometries.length:1;for(var Re=0;Re<R;Re++){var Ve=0,et=0;if(B=rt?he.geometries[Re]:he,B!==null){W=B.coordinates;var _t=B.type;switch(Ie=0,_t){case null:break;case"Point":if(l(W,Me,wn,Ve,et)===!1)return!1;Me++,Ve++;break;case"LineString":case"MultiPoint":for(g=0;g<W.length;g++){if(l(W[g],Me,wn,Ve,et)===!1)return!1;Me++,_t==="MultiPoint"&&Ve++}_t==="LineString"&&Ve++;break;case"Polygon":case"MultiLineString":for(g=0;g<W.length;g++){for(_=0;_<W[g].length-Ie;_++){if(l(W[g][_],Me,wn,Ve,et)===!1)return!1;Me++}_t==="MultiLineString"&&Ve++,_t==="Polygon"&&et++}_t==="Polygon"&&Ve++;break;case"MultiPolygon":for(g=0;g<W.length;g++){for(et=0,_=0;_<W[g].length;_++){for(E=0;E<W[g][_].length-Ie;E++){if(l(W[g][_][E],Me,wn,Ve,et)===!1)return!1;Me++}et++}Ve++}break;case"GeometryCollection":for(g=0;g<B.geometries.length;g++)if($r(B.geometries[g],l)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function oi(s,l){if(s.type==="Feature")l(s,0);else if(s.type==="FeatureCollection")for(var h=0;h<s.features.length&&l(s.features[h],h)!==!1;h++);}function wr(s,l,h){var g=h;return oi(s,function(_,E){E===0&&h===void 0?g=_:g=l(g,_,E)}),g}function ll(s,l){var h,g,_,E,B,R,W,he,Ie,Me,rt=0,pt=s.type==="FeatureCollection",Dt=s.type==="Feature",Vt=pt?s.features.length:1;for(h=0;h<Vt;h++){for(R=pt?s.features[h].geometry:Dt?s.geometry:s,he=pt?s.features[h].properties:Dt?s.properties:{},Ie=pt?s.features[h].bbox:Dt?s.bbox:void 0,Me=pt?s.features[h].id:Dt?s.id:void 0,W=R?R.type==="GeometryCollection":!1,B=W?R.geometries.length:1,_=0;_<B;_++){if(E=W?R.geometries[_]:R,E===null){if(l(null,rt,he,Ie,Me)===!1)return!1;continue}switch(E.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(l(E,rt,he,Ie,Me)===!1)return!1;break}case"GeometryCollection":{for(g=0;g<E.geometries.length;g++)if(l(E.geometries[g],rt,he,Ie,Me)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}rt++}}function xr(s,l){ll(s,function(h,g,_,E,B){var R=h===null?null:h.type;switch(R){case null:case"Point":case"LineString":case"Polygon":return l(Ne(h,_,{bbox:E,id:B}),g,0)===!1?!1:void 0}var W;switch(R){case"MultiPoint":W="Point";break;case"MultiLineString":W="LineString";break;case"MultiPolygon":W="Polygon";break}for(var he=0;he<h.coordinates.length;he++){var Ie=h.coordinates[he],Me={type:W,coordinates:Ie};if(l(Ne(Me,_),g,he)===!1)return!1}})}function qa(s){if(!s)throw new Error("geojson is required");var l=[];return xr(s,function(h){ms(h,l)}),Lt(l)}function ms(s,l){var h=[],g=s.geometry;if(g!==null){switch(g.type){case"Polygon":h=ei(g);break;case"LineString":h=[ei(g)]}h.forEach(function(_){var E=Va(_,s.properties);E.forEach(function(B){B.id=l.length,l.push(B)})})}}function Va(s,l){var h=[];return s.reduce(function(g,_){var E=ct([g,_],l);return E.bbox=to(g,_),h.push(E),_}),h}function to(s,l){var h=s[0],g=s[1],_=l[0],E=l[1],B=h<_?h:_,R=g<E?g:E,W=h>_?h:_,he=g>E?g:E;return[B,R,W,he]}var no=qa,ji=f(zr(),1);function wa(s,l){var h={},g=[];if(s.type==="LineString"&&(s=Ne(s)),l.type==="LineString"&&(l=Ne(l)),s.type==="Feature"&&l.type==="Feature"&&s.geometry!==null&&l.geometry!==null&&s.geometry.type==="LineString"&&l.geometry.type==="LineString"&&s.geometry.coordinates.length===2&&l.geometry.coordinates.length===2){var _=Ar(s,l);return _&&g.push(_),Lt(g)}var E=(0,ji.default)();return E.load(no(l)),oi(no(s),function(B){oi(E.search(B),function(R){var W=Ar(B,R);if(W){var he=ei(W).join(",");h[he]||(h[he]=!0,g.push(W))}})}),Lt(g)}function Ar(s,l){var h=ei(s),g=ei(l);if(h.length!==2)throw new Error("<intersects> line1 must only contain 2 coordinates");if(g.length!==2)throw new Error("<intersects> line2 must only contain 2 coordinates");var _=h[0][0],E=h[0][1],B=h[1][0],R=h[1][1],W=g[0][0],he=g[0][1],Ie=g[1][0],Me=g[1][1],rt=(Me-he)*(B-_)-(Ie-W)*(R-E),pt=(Ie-W)*(E-he)-(Me-he)*(_-W),Dt=(B-_)*(E-he)-(R-E)*(_-W);if(rt===0)return null;var Vt=pt/rt,Ht=Dt/rt;if(Vt>=0&&Vt<=1&&Ht>=0&&Ht<=1){var wn=_+Vt*(B-_),Re=E+Vt*(R-E);return Ke([wn,Re])}return null}var Lr=wa,xa=f(zr(),1);function hr(s,l,h){h===void 0&&(h={});var g=Zn(s),_=Zn(l),E=un(_[1]-g[1]),B=un(_[0]-g[0]),R=un(g[1]),W=un(_[1]),he=Math.pow(Math.sin(E/2),2)+Math.pow(Math.sin(B/2),2)*Math.cos(R)*Math.cos(W);return Ut(2*Math.atan2(Math.sqrt(he),Math.sqrt(1-he)),h.units)}var io=hr;function qr(s){var l=s[0],h=s[1],g=s[2],_=s[3],E=io(s.slice(0,2),[g,h]),B=io(s.slice(0,2),[l,_]);if(E>=B){var R=(h+_)/2;return[l,R-(g-l)/2,g,R+(g-l)/2]}else{var W=(l+g)/2;return[W-(_-h)/2,h,W+(_-h)/2,_]}}var ul=qr;function Gi(s){var l=[1/0,1/0,-1/0,-1/0];return $r(s,function(h){l[0]>h[0]&&(l[0]=h[0]),l[1]>h[1]&&(l[1]=h[1]),l[2]<h[0]&&(l[2]=h[0]),l[3]<h[1]&&(l[3]=h[1])}),l}Gi.default=Gi;var Rs=Gi;function Xr(s,l){l===void 0&&(l={});var h=l.precision,g=l.coordinates,_=l.mutate;if(h=h==null||isNaN(h)?6:h,g=g==null||isNaN(g)?3:g,!s)throw new Error("<geojson> is required");if(typeof h!="number")throw new Error("<precision> must be a number");if(typeof g!="number")throw new Error("<coordinates> must be a number");(_===!1||_===void 0)&&(s=JSON.parse(JSON.stringify(s)));var E=Math.pow(10,h);return $r(s,function(B){Ho(B,E,g)}),s}function Ho(s,l,h){s.length>h&&s.splice(h,s.length);for(var g=0;g<s.length;g++)s[g]=Math.round(s[g]*l)/l;return s}var ro=Xr;function Os(s,l,h){if(h===void 0&&(h={}),h.final===!0)return er(s,l);var g=Zn(s),_=Zn(l),E=un(g[0]),B=un(_[0]),R=un(g[1]),W=un(_[1]),he=Math.sin(B-E)*Math.cos(W),Ie=Math.cos(R)*Math.sin(W)-Math.sin(R)*Math.cos(W)*Math.cos(B-E);return en(Math.atan2(he,Ie))}function er(s,l){var h=Os(l,s);return h=(h+180)%360,h}function Ji(s,l,h,g){g===void 0&&(g={});var _=Zn(s),E=un(_[0]),B=un(_[1]),R=un(h),W=Kt(l,g.units),he=Math.asin(Math.sin(B)*Math.cos(W)+Math.cos(B)*Math.sin(W)*Math.cos(R)),Ie=E+Math.atan2(Math.sin(R)*Math.sin(W)*Math.cos(B),Math.cos(W)-Math.sin(B)*Math.sin(he)),Me=en(Ie),rt=en(he);return Ke([Me,rt],g.properties)}function vs(s,l,h){h===void 0&&(h={});var g=Ke([1/0,1/0],{dist:1/0}),_=0;return xr(s,function(E){for(var B=ei(E),R=0;R<B.length-1;R++){var W=Ke(B[R]);W.properties.dist=io(l,W,h);var he=Ke(B[R+1]);he.properties.dist=io(l,he,h);var Ie=io(W,he,h),Me=Math.max(W.properties.dist,he.properties.dist),rt=Os(W,he),pt=Ji(l,Me,rt+90,h),Dt=Ji(l,Me,rt-90,h),Vt=Lr(ct([pt.geometry.coordinates,Dt.geometry.coordinates]),ct([W.geometry.coordinates,he.geometry.coordinates])),Ht=null;Vt.features.length>0&&(Ht=Vt.features[0],Ht.properties.dist=io(l,Ht,h),Ht.properties.location=_+io(W,Ht,h)),W.properties.dist<g.properties.dist&&(g=W,g.properties.index=R,g.properties.location=_),he.properties.dist<g.properties.dist&&(g=he,g.properties.index=R+1,g.properties.location=_+Ie),Ht&&Ht.properties.dist<g.properties.dist&&(g=Ht,g.properties.index=R),_+=Ie}}),g}var Mr=vs;function Qr(s,l){if(!s)throw new Error("line is required");if(!l)throw new Error("splitter is required");var h=Fi(s),g=Fi(l);if(h!=="LineString")throw new Error("line must be LineString");if(g==="FeatureCollection")throw new Error("splitter cannot be a FeatureCollection");if(g==="GeometryCollection")throw new Error("splitter cannot be a GeometryCollection");var _=ro(l,{precision:7});switch(g){case"Point":return es(s,_);case"MultiPoint":return so(s,_);case"LineString":case"MultiLineString":case"Polygon":case"MultiPolygon":return so(s,Lr(s,_))}}function so(s,l){var h=[],g=(0,xa.default)();return xr(l,function(_){if(h.forEach(function(R,W){R.id=W}),!h.length)h=es(s,_).features,h.forEach(function(R){R.bbox||(R.bbox=ul(Rs(R)))}),g.load(Lt(h));else{var E=g.search(_);if(E.features.length){var B=Si(_,E);h=h.filter(function(R){return R.id!==B.id}),g.remove(B),oi(es(B,_),function(R){h.push(R),g.insert(R)})}}}),Lt(h)}function es(s,l){var h=[],g=ei(s)[0],_=ei(s)[s.geometry.coordinates.length-1];if(Is(g,Zn(l))||Is(_,Zn(l)))return Lt([s]);var E=(0,xa.default)(),B=no(s);E.load(B);var R=E.search(l);if(!R.features.length)return Lt([s]);var W=Si(l,R),he=[g],Ie=wr(B,function(Me,rt,pt){var Dt=ei(rt)[1],Vt=Zn(l);return pt===W.id?(Me.push(Vt),h.push(ct(Me)),Is(Vt,Dt)?[Vt]:[Vt,Dt]):(Me.push(Dt),Me)},he);return Ie.length>1&&h.push(ct(Ie)),Lt(h)}function Si(s,l){if(!l.features.length)throw new Error("lines must contain features");if(l.features.length===1)return l.features[0];var h,g=1/0;return oi(l,function(_){var E=Mr(_,s),B=E.properties.dist;B<g&&(h=_,g=B)}),h}function Is(s,l){return s[0]===l[0]&&s[1]===l[1]}var Cr=Qr;function dr(s,l,h){if(h===void 0&&(h={}),!s)throw new Error("point is required");if(!l)throw new Error("polygon is required");var g=Zn(s),_=Vi(l),E=_.type,B=l.bbox,R=_.coordinates;if(B&&Ga(g,B)===!1)return!1;E==="Polygon"&&(R=[R]);for(var W=!1,he=0;he<R.length&&!W;he++)if(Wo(g,R[he][0],h.ignoreBoundary)){for(var Ie=!1,Me=1;Me<R[he].length&&!Ie;)Wo(g,R[he][Me],!h.ignoreBoundary)&&(Ie=!0),Me++;Ie||(W=!0)}return W}function Wo(s,l,h){var g=!1;l[0][0]===l[l.length-1][0]&&l[0][1]===l[l.length-1][1]&&(l=l.slice(0,l.length-1));for(var _=0,E=l.length-1;_<l.length;E=_++){var B=l[_][0],R=l[_][1],W=l[E][0],he=l[E][1],Ie=s[1]*(B-W)+R*(W-s[0])+he*(s[0]-B)===0&&(B-s[0])*(W-s[0])<=0&&(R-s[1])*(he-s[1])<=0;if(Ie)return!h;var Me=R>s[1]!=he>s[1]&&s[0]<(W-B)*(s[1]-R)/(he-R)+B;Me&&(g=!g)}return g}function Ga(s,l){return l[0]<=s[0]&&l[1]<=s[1]&&l[2]>=s[0]&&l[3]>=s[1]}function Ha(s,l,h){h===void 0&&(h={});for(var g=Zn(s),_=ei(l),E=0;E<_.length-1;E++){var B=!1;if(h.ignoreEndVertices&&(E===0&&(B="start"),E===_.length-2&&(B="end"),E===0&&E+1===_.length-1&&(B="both")),fr(_[E],_[E+1],g,B,typeof h.epsilon>"u"?null:h.epsilon))return!0}return!1}function fr(s,l,h,g,_){var E=h[0],B=h[1],R=s[0],W=s[1],he=l[0],Ie=l[1],Me=h[0]-R,rt=h[1]-W,pt=he-R,Dt=Ie-W,Vt=Me*Dt-rt*pt;if(_!==null){if(Math.abs(Vt)>_)return!1}else if(Vt!==0)return!1;if(g){if(g==="start")return Math.abs(pt)>=Math.abs(Dt)?pt>0?R<E&&E<=he:he<=E&&E<R:Dt>0?W<B&&B<=Ie:Ie<=B&&B<W;if(g==="end")return Math.abs(pt)>=Math.abs(Dt)?pt>0?R<=E&&E<he:he<E&&E<=R:Dt>0?W<=B&&B<Ie:Ie<B&&B<=W;if(g==="both")return Math.abs(pt)>=Math.abs(Dt)?pt>0?R<E&&E<he:he<E&&E<R:Dt>0?W<B&&B<Ie:Ie<B&&B<W}else return Math.abs(pt)>=Math.abs(Dt)?pt>0?R<=E&&E<=he:he<=E&&E<=R:Dt>0?W<=B&&B<=Ie:Ie<=B&&B<=W;return!1}var Br=Ha;function Lo(s,l){var h=Vi(s),g=Vi(l),_=h.type,E=g.type,B=h.coordinates,R=g.coordinates;switch(_){case"Point":switch(E){case"Point":return ti(B,R);default:throw new Error("feature2 "+E+" geometry not supported")}case"MultiPoint":switch(E){case"Point":return Fs(h,g);case"MultiPoint":return La(h,g);default:throw new Error("feature2 "+E+" geometry not supported")}case"LineString":switch(E){case"Point":return Br(g,h,{ignoreEndVertices:!0});case"LineString":return oo(h,g);case"MultiPoint":return Co(h,g);default:throw new Error("feature2 "+E+" geometry not supported")}case"Polygon":switch(E){case"Point":return dr(g,h,{ignoreBoundary:!0});case"LineString":return ts(h,g);case"Polygon":return tr(h,g);case"MultiPoint":return Po(h,g);default:throw new Error("feature2 "+E+" geometry not supported")}default:throw new Error("feature1 "+_+" geometry not supported")}}function Fs(s,l){var h,g=!1;for(h=0;h<s.coordinates.length;h++)if(ti(s.coordinates[h],l.coordinates)){g=!0;break}return g}function La(s,l){for(var h=0,g=l.coordinates;h<g.length;h++){for(var _=g[h],E=!1,B=0,R=s.coordinates;B<R.length;B++){var W=R[B];if(ti(_,W)){E=!0;break}}if(!E)return!1}return!0}function Co(s,l){for(var h=!1,g=0,_=l.coordinates;g<_.length;g++){var E=_[g];if(Br(E,s,{ignoreEndVertices:!0})&&(h=!0),!Br(E,s))return!1}return!!h}function Po(s,l){for(var h=0,g=l.coordinates;h<g.length;h++){var _=g[h];if(!dr(_,s,{ignoreBoundary:!0}))return!1}return!0}function oo(s,l){for(var h=!1,g=0,_=l.coordinates;g<_.length;g++){var E=_[g];if(Br({type:"Point",coordinates:E},s,{ignoreEndVertices:!0})&&(h=!0),!Br({type:"Point",coordinates:E},s,{ignoreEndVertices:!1}))return!1}return h}function ts(s,l){var h=!1,g=0,_=Rs(s),E=Rs(l);if(!ri(_,E))return!1;for(g;g<l.coordinates.length-1;g++){var B=Ni(l.coordinates[g],l.coordinates[g+1]);if(dr({type:"Point",coordinates:B},s,{ignoreBoundary:!0})){h=!0;break}}return h}function tr(s,l){if(s.type==="Feature"&&s.geometry===null||l.type==="Feature"&&l.geometry===null)return!1;var h=Rs(s),g=Rs(l);if(!ri(h,g))return!1;for(var _=Vi(l).coordinates,E=0,B=_;E<B.length;E++)for(var R=B[E],W=0,he=R;W<he.length;W++){var Ie=he[W];if(!dr(Ie,s))return!1}return!0}function ri(s,l){return!(s[0]>l[0]||s[2]<l[2]||s[1]>l[1]||s[3]<l[3])}function ti(s,l){return s[0]===l[0]&&s[1]===l[1]}function Ni(s,l){return[(s[0]+l[0])/2,(s[1]+l[1])/2]}var ai=f(cr()),ys=s=>()=>s,ko=s=>{let l=s?(h,g)=>g.minus(h).abs().isLessThanOrEqualTo(s):ys(!1);return(h,g)=>l(h,g)?0:h.comparedTo(g)};function js(s){let l=s?(h,g,_,E,B)=>h.exponentiatedBy(2).isLessThanOrEqualTo(E.minus(g).exponentiatedBy(2).plus(B.minus(_).exponentiatedBy(2)).times(s)):ys(!1);return(h,g,_)=>{let E=h.x,B=h.y,R=_.x,W=_.y,he=B.minus(W).times(g.x.minus(R)).minus(E.minus(R).times(g.y.minus(W)));return l(he,E,B,R,W)?0:he.comparedTo(0)}}var cl=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,Eo=Math.ceil,Hi=Math.floor,li="[BigNumber Error] ",Tr=li+"Number primitive has more than 15 significant digits: ",Nr=1e14,bn=14,hl=9007199254740991,Zo=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],ns=1e7,pr=1e9;function Fl(s){var l,h,g,_=Re.prototype={constructor:Re,toString:null,valueOf:null},E=new Re(1),B=20,R=4,W=-7,he=21,Ie=-1e7,Me=1e7,rt=!1,pt=1,Dt=0,Vt={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},Ht="0123456789abcdefghijklmnopqrstuvwxyz",wn=!0;function Re(X,pe){var Ce,Le,ke,Se,Ye,We,tt,dt,ht=this;if(!(ht instanceof Re))return new Re(X,pe);if(pe==null){if(X&&X._isBigNumber===!0){ht.s=X.s,!X.c||X.e>Me?ht.c=ht.e=null:X.e<Ie?ht.c=[ht.e=0]:(ht.e=X.e,ht.c=X.c.slice());return}if((We=typeof X=="number")&&X*0==0){if(ht.s=1/X<0?(X=-X,-1):1,X===~~X){for(Se=0,Ye=X;Ye>=10;Ye/=10,Se++);Se>Me?ht.c=ht.e=null:(ht.e=Se,ht.c=[X]);return}dt=String(X)}else{if(!cl.test(dt=String(X)))return g(ht,dt,We);ht.s=dt.charCodeAt(0)==45?(dt=dt.slice(1),-1):1}(Se=dt.indexOf("."))>-1&&(dt=dt.replace(".","")),(Ye=dt.search(/e/i))>0?(Se<0&&(Se=Ye),Se+=+dt.slice(Ye+1),dt=dt.substring(0,Ye)):Se<0&&(Se=dt.length)}else{if(r(pe,2,Ht.length,"Base"),pe==10&&wn)return ht=new Re(X),at(ht,B+ht.e+1,R);if(dt=String(X),We=typeof X=="number"){if(X*0!=0)return g(ht,dt,We,pe);if(ht.s=1/X<0?(dt=dt.slice(1),-1):1,Re.DEBUG&&dt.replace(/^0\.0*|\./,"").length>15)throw Error(Tr+X)}else ht.s=dt.charCodeAt(0)===45?(dt=dt.slice(1),-1):1;for(Ce=Ht.slice(0,pe),Se=Ye=0,tt=dt.length;Ye<tt;Ye++)if(Ce.indexOf(Le=dt.charAt(Ye))<0){if(Le=="."){if(Ye>Se){Se=tt;continue}}else if(!ke&&(dt==dt.toUpperCase()&&(dt=dt.toLowerCase())||dt==dt.toLowerCase()&&(dt=dt.toUpperCase()))){ke=!0,Ye=-1,Se=0;continue}return g(ht,String(X),We,pe)}We=!1,dt=h(dt,pe,10,ht.s),(Se=dt.indexOf("."))>-1?dt=dt.replace(".",""):Se=dt.length}for(Ye=0;dt.charCodeAt(Ye)===48;Ye++);for(tt=dt.length;dt.charCodeAt(--tt)===48;);if(dt=dt.slice(Ye,++tt)){if(tt-=Ye,We&&Re.DEBUG&&tt>15&&(X>hl||X!==Hi(X)))throw Error(Tr+ht.s*X);if((Se=Se-Ye-1)>Me)ht.c=ht.e=null;else if(Se<Ie)ht.c=[ht.e=0];else{if(ht.e=Se,ht.c=[],Ye=(Se+1)%bn,Se<0&&(Ye+=bn),Ye<tt){for(Ye&&ht.c.push(+dt.slice(0,Ye)),tt-=bn;Ye<tt;)ht.c.push(+dt.slice(Ye,Ye+=bn));Ye=bn-(dt=dt.slice(Ye)).length}else Ye-=tt;for(;Ye--;dt+="0");ht.c.push(+dt)}}else ht.c=[ht.e=0]}Re.clone=Fl,Re.ROUND_UP=0,Re.ROUND_DOWN=1,Re.ROUND_CEIL=2,Re.ROUND_FLOOR=3,Re.ROUND_HALF_UP=4,Re.ROUND_HALF_DOWN=5,Re.ROUND_HALF_EVEN=6,Re.ROUND_HALF_CEIL=7,Re.ROUND_HALF_FLOOR=8,Re.EUCLID=9,Re.config=Re.set=function(X){var pe,Ce;if(X!=null)if(typeof X=="object"){if(X.hasOwnProperty(pe="DECIMAL_PLACES")&&(Ce=X[pe],r(Ce,0,pr,pe),B=Ce),X.hasOwnProperty(pe="ROUNDING_MODE")&&(Ce=X[pe],r(Ce,0,8,pe),R=Ce),X.hasOwnProperty(pe="EXPONENTIAL_AT")&&(Ce=X[pe],Ce&&Ce.pop?(r(Ce[0],-1e9,0,pe),r(Ce[1],0,pr,pe),W=Ce[0],he=Ce[1]):(r(Ce,-1e9,pr,pe),W=-(he=Ce<0?-Ce:Ce))),X.hasOwnProperty(pe="RANGE"))if(Ce=X[pe],Ce&&Ce.pop)r(Ce[0],-1e9,-1,pe),r(Ce[1],1,pr,pe),Ie=Ce[0],Me=Ce[1];else if(r(Ce,-1e9,pr,pe),Ce)Ie=-(Me=Ce<0?-Ce:Ce);else throw Error(li+pe+" cannot be zero: "+Ce);if(X.hasOwnProperty(pe="CRYPTO"))if(Ce=X[pe],Ce===!!Ce)if(Ce)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))rt=Ce;else throw rt=!Ce,Error(li+"crypto unavailable");else rt=Ce;else throw Error(li+pe+" not true or false: "+Ce);if(X.hasOwnProperty(pe="MODULO_MODE")&&(Ce=X[pe],r(Ce,0,9,pe),pt=Ce),X.hasOwnProperty(pe="POW_PRECISION")&&(Ce=X[pe],r(Ce,0,pr,pe),Dt=Ce),X.hasOwnProperty(pe="FORMAT"))if(Ce=X[pe],typeof Ce=="object")Vt=Ce;else throw Error(li+pe+" not an object: "+Ce);if(X.hasOwnProperty(pe="ALPHABET"))if(Ce=X[pe],typeof Ce=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(Ce))wn=Ce.slice(0,10)=="0123456789",Ht=Ce;else throw Error(li+pe+" invalid: "+Ce)}else throw Error(li+"Object expected: "+X);return{DECIMAL_PLACES:B,ROUNDING_MODE:R,EXPONENTIAL_AT:[W,he],RANGE:[Ie,Me],CRYPTO:rt,MODULO_MODE:pt,POW_PRECISION:Dt,FORMAT:Vt,ALPHABET:Ht}},Re.isBigNumber=function(X){if(!X||X._isBigNumber!==!0)return!1;if(!Re.DEBUG)return!0;var pe,Ce,Le=X.c,ke=X.e,Se=X.s;e:if({}.toString.call(Le)=="[object Array]"){if((Se===1||Se===-1)&&ke>=-1e9&&ke<=pr&&ke===Hi(ke)){if(Le[0]===0){if(ke===0&&Le.length===1)return!0;break e}if(pe=(ke+1)%bn,pe<1&&(pe+=bn),String(Le[0]).length==pe){for(pe=0;pe<Le.length;pe++)if(Ce=Le[pe],Ce<0||Ce>=Nr||Ce!==Hi(Ce))break e;if(Ce!==0)return!0}}}else if(Le===null&&ke===null&&(Se===null||Se===1||Se===-1))return!0;throw Error(li+"Invalid BigNumber: "+X)},Re.maximum=Re.max=function(){return et(arguments,-1)},Re.minimum=Re.min=function(){return et(arguments,1)},Re.random=function(){var X=9007199254740992,pe=Math.random()*X&2097151?function(){return Hi(Math.random()*X)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(Ce){var Le,ke,Se,Ye,We,tt=0,dt=[],ht=new Re(E);if(Ce==null?Ce=B:r(Ce,0,pr),Ye=Eo(Ce/bn),rt)if(crypto.getRandomValues){for(Le=crypto.getRandomValues(new Uint32Array(Ye*=2));tt<Ye;)We=Le[tt]*131072+(Le[tt+1]>>>11),We>=9e15?(ke=crypto.getRandomValues(new Uint32Array(2)),Le[tt]=ke[0],Le[tt+1]=ke[1]):(dt.push(We%1e14),tt+=2);tt=Ye/2}else if(crypto.randomBytes){for(Le=crypto.randomBytes(Ye*=7);tt<Ye;)We=(Le[tt]&31)*281474976710656+Le[tt+1]*1099511627776+Le[tt+2]*4294967296+Le[tt+3]*16777216+(Le[tt+4]<<16)+(Le[tt+5]<<8)+Le[tt+6],We>=9e15?crypto.randomBytes(7).copy(Le,tt):(dt.push(We%1e14),tt+=7);tt=Ye/7}else throw rt=!1,Error(li+"crypto unavailable");if(!rt)for(;tt<Ye;)We=pe(),We<9e15&&(dt[tt++]=We%1e14);for(Ye=dt[--tt],Ce%=bn,Ye&&Ce&&(We=Zo[bn-Ce],dt[tt]=Hi(Ye/We)*We);dt[tt]===0;dt.pop(),tt--);if(tt<0)dt=[Se=0];else{for(Se=-1;dt[0]===0;dt.splice(0,1),Se-=bn);for(tt=1,We=dt[0];We>=10;We/=10,tt++);tt<bn&&(Se-=bn-tt)}return ht.e=Se,ht.c=dt,ht}}(),Re.sum=function(){for(var X=1,pe=arguments,Ce=new Re(pe[0]);X<pe.length;)Ce=Ce.plus(pe[X++]);return Ce},h=function(){var X="0123456789";function pe(Ce,Le,ke,Se){for(var Ye,We=[0],tt,dt=0,ht=Ce.length;dt<ht;){for(tt=We.length;tt--;We[tt]*=Le);for(We[0]+=Se.indexOf(Ce.charAt(dt++)),Ye=0;Ye<We.length;Ye++)We[Ye]>ke-1&&(We[Ye+1]==null&&(We[Ye+1]=0),We[Ye+1]+=We[Ye]/ke|0,We[Ye]%=ke)}return We.reverse()}return function(Ce,Le,ke,Se,Ye){var We,tt,dt,ht,It,Xt,rn,ln,Jn=Ce.indexOf("."),ni=B,Gn=R;for(Jn>=0&&(ht=Dt,Dt=0,Ce=Ce.replace(".",""),ln=new Re(Le),Xt=ln.pow(Ce.length-Jn),Dt=ht,ln.c=pe(S(kr(Xt.c),Xt.e,"0"),10,ke,X),ln.e=ln.c.length),rn=pe(Ce,Le,ke,Ye?(We=Ht,X):(We=X,Ht)),dt=ht=rn.length;rn[--ht]==0;rn.pop());if(!rn[0])return We.charAt(0);if(Jn<0?--dt:(Xt.c=rn,Xt.e=dt,Xt.s=Se,Xt=l(Xt,ln,ni,Gn,ke),rn=Xt.c,It=Xt.r,dt=Xt.e),tt=dt+ni+1,Jn=rn[tt],ht=ke/2,It=It||tt<0||rn[tt+1]!=null,It=Gn<4?(Jn!=null||It)&&(Gn==0||Gn==(Xt.s<0?3:2)):Jn>ht||Jn==ht&&(Gn==4||It||Gn==6&&rn[tt-1]&1||Gn==(Xt.s<0?8:7)),tt<1||!rn[0])Ce=It?S(We.charAt(1),-ni,We.charAt(0)):We.charAt(0);else{if(rn.length=tt,It)for(--ke;++rn[--tt]>ke;)rn[tt]=0,tt||(++dt,rn=[1].concat(rn));for(ht=rn.length;!rn[--ht];);for(Jn=0,Ce="";Jn<=ht;Ce+=We.charAt(rn[Jn++]));Ce=S(Ce,dt,We.charAt(0))}return Ce}}(),l=function(){function X(Le,ke,Se){var Ye,We,tt,dt,ht=0,It=Le.length,Xt=ke%ns,rn=ke/ns|0;for(Le=Le.slice();It--;)tt=Le[It]%ns,dt=Le[It]/ns|0,Ye=rn*tt+dt*Xt,We=Xt*tt+Ye%ns*ns+ht,ht=(We/Se|0)+(Ye/ns|0)+rn*dt,Le[It]=We%Se;return ht&&(Le=[ht].concat(Le)),Le}function pe(Le,ke,Se,Ye){var We,tt;if(Se!=Ye)tt=Se>Ye?1:-1;else for(We=tt=0;We<Se;We++)if(Le[We]!=ke[We]){tt=Le[We]>ke[We]?1:-1;break}return tt}function Ce(Le,ke,Se,Ye){for(var We=0;Se--;)Le[Se]-=We,We=Le[Se]<ke[Se]?1:0,Le[Se]=We*Ye+Le[Se]-ke[Se];for(;!Le[0]&&Le.length>1;Le.splice(0,1));}return function(Le,ke,Se,Ye,We){var tt,dt,ht,It,Xt,rn,ln,Jn,ni,Gn,hi,Rr,pl,So,Ku,Ao,ql,bs=Le.s==ke.s?1:-1,mr=Le.c,Di=ke.c;if(!mr||!mr[0]||!Di||!Di[0])return new Re(!Le.s||!ke.s||(mr?Di&&mr[0]==Di[0]:!Di)?NaN:mr&&mr[0]==0||!Di?bs*0:bs/0);for(Jn=new Re(bs),ni=Jn.c=[],dt=Le.e-ke.e,bs=Se+dt+1,We||(We=Nr,dt=Pr(Le.e/bn)-Pr(ke.e/bn),bs=bs/bn|0),ht=0;Di[ht]==(mr[ht]||0);ht++);if(Di[ht]>(mr[ht]||0)&&dt--,bs<0)ni.push(1),It=!0;else{for(So=mr.length,Ao=Di.length,ht=0,bs+=2,Xt=Hi(We/(Di[0]+1)),Xt>1&&(Di=X(Di,Xt,We),mr=X(mr,Xt,We),Ao=Di.length,So=mr.length),pl=Ao,Gn=mr.slice(0,Ao),hi=Gn.length;hi<Ao;Gn[hi++]=0);ql=Di.slice(),ql=[0].concat(ql),Ku=Di[0],Di[1]>=We/2&&Ku++;do{if(Xt=0,tt=pe(Di,Gn,Ao,hi),tt<0){if(Rr=Gn[0],Ao!=hi&&(Rr=Rr*We+(Gn[1]||0)),Xt=Hi(Rr/Ku),Xt>1)for(Xt>=We&&(Xt=We-1),rn=X(Di,Xt,We),ln=rn.length,hi=Gn.length;pe(rn,Gn,ln,hi)==1;)Xt--,Ce(rn,Ao<ln?ql:Di,ln,We),ln=rn.length,tt=1;else Xt==0&&(tt=Xt=1),rn=Di.slice(),ln=rn.length;if(ln<hi&&(rn=[0].concat(rn)),Ce(Gn,rn,hi,We),hi=Gn.length,tt==-1)for(;pe(Di,Gn,Ao,hi)<1;)Xt++,Ce(Gn,Ao<hi?ql:Di,hi,We),hi=Gn.length}else tt===0&&(Xt++,Gn=[0]);ni[ht++]=Xt,Gn[0]?Gn[hi++]=mr[pl]||0:(Gn=[mr[pl]],hi=1)}while((pl++<So||Gn[0]!=null)&&bs--);It=Gn[0]!=null,ni[0]||ni.splice(0,1)}if(We==Nr){for(ht=1,bs=ni[0];bs>=10;bs/=10,ht++);at(Jn,Se+(Jn.e=ht+dt*bn-1)+1,Ye,It)}else Jn.e=dt,Jn.r=+It;return Jn}}();function Ve(X,pe,Ce,Le){var ke,Se,Ye,We,tt;if(Ce==null?Ce=R:r(Ce,0,8),!X.c)return X.toString();if(ke=X.c[0],Ye=X.e,pe==null)tt=kr(X.c),tt=Le==1||Le==2&&(Ye<=W||Ye>=he)?v(tt,Ye):S(tt,Ye,"0");else if(X=at(new Re(X),pe,Ce),Se=X.e,tt=kr(X.c),We=tt.length,Le==1||Le==2&&(pe<=Se||Se<=W)){for(;We<pe;tt+="0",We++);tt=v(tt,Se)}else if(pe-=Ye,tt=S(tt,Se,"0"),Se+1>We){if(--pe>0)for(tt+=".";pe--;tt+="0");}else if(pe+=Se-We,pe>0)for(Se+1==We&&(tt+=".");pe--;tt+="0");return X.s<0&&ke?"-"+tt:tt}function et(X,pe){for(var Ce,Le,ke=1,Se=new Re(X[0]);ke<X.length;ke++)Le=new Re(X[ke]),(!Le.s||(Ce=zs(Se,Le))===pe||Ce===0&&Se.s===pe)&&(Se=Le);return Se}function _t(X,pe,Ce){for(var Le=1,ke=pe.length;!pe[--ke];pe.pop());for(ke=pe[0];ke>=10;ke/=10,Le++);return(Ce=Le+Ce*bn-1)>Me?X.c=X.e=null:Ce<Ie?X.c=[X.e=0]:(X.e=Ce,X.c=pe),X}g=function(){var X=/^(-?)0([xbo])(?=\w[\w.]*$)/i,pe=/^([^.]+)\.$/,Ce=/^\.([^.]+)$/,Le=/^-?(Infinity|NaN)$/,ke=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(Se,Ye,We,tt){var dt,ht=We?Ye:Ye.replace(ke,"");if(Le.test(ht))Se.s=isNaN(ht)?null:ht<0?-1:1;else{if(!We&&(ht=ht.replace(X,function(It,Xt,rn){return dt=(rn=rn.toLowerCase())=="x"?16:rn=="b"?2:8,!tt||tt==dt?Xt:It}),tt&&(dt=tt,ht=ht.replace(pe,"$1").replace(Ce,"0.$1")),Ye!=ht))return new Re(ht,dt);if(Re.DEBUG)throw Error(li+"Not a"+(tt?" base "+tt:"")+" number: "+Ye);Se.s=null}Se.c=Se.e=null}}();function at(X,pe,Ce,Le){var ke,Se,Ye,We,tt,dt,ht,It=X.c,Xt=Zo;if(It){e:{for(ke=1,We=It[0];We>=10;We/=10,ke++);if(Se=pe-ke,Se<0)Se+=bn,Ye=pe,tt=It[dt=0],ht=Hi(tt/Xt[ke-Ye-1]%10);else if(dt=Eo((Se+1)/bn),dt>=It.length)if(Le){for(;It.length<=dt;It.push(0));tt=ht=0,ke=1,Se%=bn,Ye=Se-bn+1}else break e;else{for(tt=We=It[dt],ke=1;We>=10;We/=10,ke++);Se%=bn,Ye=Se-bn+ke,ht=Ye<0?0:Hi(tt/Xt[ke-Ye-1]%10)}if(Le=Le||pe<0||It[dt+1]!=null||(Ye<0?tt:tt%Xt[ke-Ye-1]),Le=Ce<4?(ht||Le)&&(Ce==0||Ce==(X.s<0?3:2)):ht>5||ht==5&&(Ce==4||Le||Ce==6&&(Se>0?Ye>0?tt/Xt[ke-Ye]:0:It[dt-1])%10&1||Ce==(X.s<0?8:7)),pe<1||!It[0])return It.length=0,Le?(pe-=X.e+1,It[0]=Xt[(bn-pe%bn)%bn],X.e=-pe||0):It[0]=X.e=0,X;if(Se==0?(It.length=dt,We=1,dt--):(It.length=dt+1,We=Xt[bn-Se],It[dt]=Ye>0?Hi(tt/Xt[ke-Ye]%Xt[Ye])*We:0),Le)for(;;)if(dt==0){for(Se=1,Ye=It[0];Ye>=10;Ye/=10,Se++);for(Ye=It[0]+=We,We=1;Ye>=10;Ye/=10,We++);Se!=We&&(X.e++,It[0]==Nr&&(It[0]=1));break}else{if(It[dt]+=We,It[dt]!=Nr)break;It[dt--]=0,We=1}for(Se=It.length;It[--Se]===0;It.pop());}X.e>Me?X.c=X.e=null:X.e<Ie&&(X.c=[X.e=0])}return X}function gt(X){var pe,Ce=X.e;return Ce===null?X.toString():(pe=kr(X.c),pe=Ce<=W||Ce>=he?v(pe,Ce):S(pe,Ce,"0"),X.s<0?"-"+pe:pe)}return _.absoluteValue=_.abs=function(){var X=new Re(this);return X.s<0&&(X.s=1),X},_.comparedTo=function(X,pe){return zs(this,new Re(X,pe))},_.decimalPlaces=_.dp=function(X,pe){var Ce,Le,ke,Se=this;if(X!=null)return r(X,0,pr),pe==null?pe=R:r(pe,0,8),at(new Re(Se),X+Se.e+1,pe);if(!(Ce=Se.c))return null;if(Le=((ke=Ce.length-1)-Pr(this.e/bn))*bn,ke=Ce[ke])for(;ke%10==0;ke/=10,Le--);return Le<0&&(Le=0),Le},_.dividedBy=_.div=function(X,pe){return l(this,new Re(X,pe),B,R)},_.dividedToIntegerBy=_.idiv=function(X,pe){return l(this,new Re(X,pe),0,1)},_.exponentiatedBy=_.pow=function(X,pe){var Ce,Le,ke,Se,Ye,We,tt,dt,ht,It=this;if(X=new Re(X),X.c&&!X.isInteger())throw Error(li+"Exponent not an integer: "+gt(X));if(pe!=null&&(pe=new Re(pe)),We=X.e>14,!It.c||!It.c[0]||It.c[0]==1&&!It.e&&It.c.length==1||!X.c||!X.c[0])return ht=new Re(Math.pow(+gt(It),We?X.s*(2-c(X)):+gt(X))),pe?ht.mod(pe):ht;if(tt=X.s<0,pe){if(pe.c?!pe.c[0]:!pe.s)return new Re(NaN);Le=!tt&&It.isInteger()&&pe.isInteger(),Le&&(It=It.mod(pe))}else{if(X.e>9&&(It.e>0||It.e<-1||(It.e==0?It.c[0]>1||We&&It.c[1]>=24e7:It.c[0]<8e13||We&&It.c[0]<=9999975e7)))return Se=It.s<0&&c(X)?-0:0,It.e>-1&&(Se=1/Se),new Re(tt?1/Se:Se);Dt&&(Se=Eo(Dt/bn+2))}for(We?(Ce=new Re(.5),tt&&(X.s=1),dt=c(X)):(ke=Math.abs(+gt(X)),dt=ke%2),ht=new Re(E);;){if(dt){if(ht=ht.times(It),!ht.c)break;Se?ht.c.length>Se&&(ht.c.length=Se):Le&&(ht=ht.mod(pe))}if(ke){if(ke=Hi(ke/2),ke===0)break;dt=ke%2}else if(X=X.times(Ce),at(X,X.e+1,1),X.e>14)dt=c(X);else{if(ke=+gt(X),ke===0)break;dt=ke%2}It=It.times(It),Se?It.c&&It.c.length>Se&&(It.c.length=Se):Le&&(It=It.mod(pe))}return Le?ht:(tt&&(ht=E.div(ht)),pe?ht.mod(pe):Se?at(ht,Dt,R,Ye):ht)},_.integerValue=function(X){var pe=new Re(this);return X==null?X=R:r(X,0,8),at(pe,pe.e+1,X)},_.isEqualTo=_.eq=function(X,pe){return zs(this,new Re(X,pe))===0},_.isFinite=function(){return!!this.c},_.isGreaterThan=_.gt=function(X,pe){return zs(this,new Re(X,pe))>0},_.isGreaterThanOrEqualTo=_.gte=function(X,pe){return(pe=zs(this,new Re(X,pe)))===1||pe===0},_.isInteger=function(){return!!this.c&&Pr(this.e/bn)>this.c.length-2},_.isLessThan=_.lt=function(X,pe){return zs(this,new Re(X,pe))<0},_.isLessThanOrEqualTo=_.lte=function(X,pe){return(pe=zs(this,new Re(X,pe)))===-1||pe===0},_.isNaN=function(){return!this.s},_.isNegative=function(){return this.s<0},_.isPositive=function(){return this.s>0},_.isZero=function(){return!!this.c&&this.c[0]==0},_.minus=function(X,pe){var Ce,Le,ke,Se,Ye=this,We=Ye.s;if(X=new Re(X,pe),pe=X.s,!We||!pe)return new Re(NaN);if(We!=pe)return X.s=-pe,Ye.plus(X);var tt=Ye.e/bn,dt=X.e/bn,ht=Ye.c,It=X.c;if(!tt||!dt){if(!ht||!It)return ht?(X.s=-pe,X):new Re(It?Ye:NaN);if(!ht[0]||!It[0])return It[0]?(X.s=-pe,X):new Re(ht[0]?Ye:R==3?-0:0)}if(tt=Pr(tt),dt=Pr(dt),ht=ht.slice(),We=tt-dt){for((Se=We<0)?(We=-We,ke=ht):(dt=tt,ke=It),ke.reverse(),pe=We;pe--;ke.push(0));ke.reverse()}else for(Le=(Se=(We=ht.length)<(pe=It.length))?We:pe,We=pe=0;pe<Le;pe++)if(ht[pe]!=It[pe]){Se=ht[pe]<It[pe];break}if(Se&&(ke=ht,ht=It,It=ke,X.s=-X.s),pe=(Le=It.length)-(Ce=ht.length),pe>0)for(;pe--;ht[Ce++]=0);for(pe=Nr-1;Le>We;){if(ht[--Le]<It[Le]){for(Ce=Le;Ce&&!ht[--Ce];ht[Ce]=pe);--ht[Ce],ht[Le]+=Nr}ht[Le]-=It[Le]}for(;ht[0]==0;ht.splice(0,1),--dt);return ht[0]?_t(X,ht,dt):(X.s=R==3?-1:1,X.c=[X.e=0],X)},_.modulo=_.mod=function(X,pe){var Ce,Le,ke=this;return X=new Re(X,pe),!ke.c||!X.s||X.c&&!X.c[0]?new Re(NaN):!X.c||ke.c&&!ke.c[0]?new Re(ke):(pt==9?(Le=X.s,X.s=1,Ce=l(ke,X,0,3),X.s=Le,Ce.s*=Le):Ce=l(ke,X,0,pt),X=ke.minus(Ce.times(X)),!X.c[0]&&pt==1&&(X.s=ke.s),X)},_.multipliedBy=_.times=function(X,pe){var Ce,Le,ke,Se,Ye,We,tt,dt,ht,It,Xt,rn,ln,Jn,ni,Gn=this,hi=Gn.c,Rr=(X=new Re(X,pe)).c;if(!hi||!Rr||!hi[0]||!Rr[0])return!Gn.s||!X.s||hi&&!hi[0]&&!Rr||Rr&&!Rr[0]&&!hi?X.c=X.e=X.s=null:(X.s*=Gn.s,!hi||!Rr?X.c=X.e=null:(X.c=[0],X.e=0)),X;for(Le=Pr(Gn.e/bn)+Pr(X.e/bn),X.s*=Gn.s,tt=hi.length,It=Rr.length,tt<It&&(ln=hi,hi=Rr,Rr=ln,ke=tt,tt=It,It=ke),ke=tt+It,ln=[];ke--;ln.push(0));for(Jn=Nr,ni=ns,ke=It;--ke>=0;){for(Ce=0,Xt=Rr[ke]%ni,rn=Rr[ke]/ni|0,Ye=tt,Se=ke+Ye;Se>ke;)dt=hi[--Ye]%ni,ht=hi[Ye]/ni|0,We=rn*dt+ht*Xt,dt=Xt*dt+We%ni*ni+ln[Se]+Ce,Ce=(dt/Jn|0)+(We/ni|0)+rn*ht,ln[Se--]=dt%Jn;ln[Se]=Ce}return Ce?++Le:ln.splice(0,1),_t(X,ln,Le)},_.negated=function(){var X=new Re(this);return X.s=-X.s||null,X},_.plus=function(X,pe){var Ce,Le=this,ke=Le.s;if(X=new Re(X,pe),pe=X.s,!ke||!pe)return new Re(NaN);if(ke!=pe)return X.s=-pe,Le.minus(X);var Se=Le.e/bn,Ye=X.e/bn,We=Le.c,tt=X.c;if(!Se||!Ye){if(!We||!tt)return new Re(ke/0);if(!We[0]||!tt[0])return tt[0]?X:new Re(We[0]?Le:ke*0)}if(Se=Pr(Se),Ye=Pr(Ye),We=We.slice(),ke=Se-Ye){for(ke>0?(Ye=Se,Ce=tt):(ke=-ke,Ce=We),Ce.reverse();ke--;Ce.push(0));Ce.reverse()}for(ke=We.length,pe=tt.length,ke-pe<0&&(Ce=tt,tt=We,We=Ce,pe=ke),ke=0;pe;)ke=(We[--pe]=We[pe]+tt[pe]+ke)/Nr|0,We[pe]=Nr===We[pe]?0:We[pe]%Nr;return ke&&(We=[ke].concat(We),++Ye),_t(X,We,Ye)},_.precision=_.sd=function(X,pe){var Ce,Le,ke,Se=this;if(X!=null&&X!==!!X)return r(X,1,pr),pe==null?pe=R:r(pe,0,8),at(new Re(Se),X,pe);if(!(Ce=Se.c))return null;if(ke=Ce.length-1,Le=ke*bn+1,ke=Ce[ke]){for(;ke%10==0;ke/=10,Le--);for(ke=Ce[0];ke>=10;ke/=10,Le++);}return X&&Se.e+1>Le&&(Le=Se.e+1),Le},_.shiftedBy=function(X){return r(X,-9007199254740991,hl),this.times("1e"+X)},_.squareRoot=_.sqrt=function(){var X,pe,Ce,Le,ke,Se=this,Ye=Se.c,We=Se.s,tt=Se.e,dt=B+4,ht=new Re("0.5");if(We!==1||!Ye||!Ye[0])return new Re(!We||We<0&&(!Ye||Ye[0])?NaN:Ye?Se:1/0);if(We=Math.sqrt(+gt(Se)),We==0||We==1/0?(pe=kr(Ye),(pe.length+tt)%2==0&&(pe+="0"),We=Math.sqrt(+pe),tt=Pr((tt+1)/2)-(tt<0||tt%2),We==1/0?pe="5e"+tt:(pe=We.toExponential(),pe=pe.slice(0,pe.indexOf("e")+1)+tt),Ce=new Re(pe)):Ce=new Re(We+""),Ce.c[0]){for(tt=Ce.e,We=tt+dt,We<3&&(We=0);;)if(ke=Ce,Ce=ht.times(ke.plus(l(Se,ke,dt,1))),kr(ke.c).slice(0,We)===(pe=kr(Ce.c)).slice(0,We))if(Ce.e<tt&&--We,pe=pe.slice(We-3,We+1),pe=="9999"||!Le&&pe=="4999"){if(!Le&&(at(ke,ke.e+B+2,0),ke.times(ke).eq(Se))){Ce=ke;break}dt+=4,We+=4,Le=1}else{(!+pe||!+pe.slice(1)&&pe.charAt(0)=="5")&&(at(Ce,Ce.e+B+2,1),X=!Ce.times(Ce).eq(Se));break}}return at(Ce,Ce.e+B+1,R,X)},_.toExponential=function(X,pe){return X!=null&&(r(X,0,pr),X++),Ve(this,X,pe,1)},_.toFixed=function(X,pe){return X!=null&&(r(X,0,pr),X=X+this.e+1),Ve(this,X,pe)},_.toFormat=function(X,pe,Ce){var Le,ke=this;if(Ce==null)X!=null&&pe&&typeof pe=="object"?(Ce=pe,pe=null):X&&typeof X=="object"?(Ce=X,X=pe=null):Ce=Vt;else if(typeof Ce!="object")throw Error(li+"Argument not an object: "+Ce);if(Le=ke.toFixed(X,pe),ke.c){var Se,Ye=Le.split("."),We=+Ce.groupSize,tt=+Ce.secondaryGroupSize,dt=Ce.groupSeparator||"",ht=Ye[0],It=Ye[1],Xt=ke.s<0,rn=Xt?ht.slice(1):ht,ln=rn.length;if(tt&&(Se=We,We=tt,tt=Se,ln-=Se),We>0&&ln>0){for(Se=ln%We||We,ht=rn.substr(0,Se);Se<ln;Se+=We)ht+=dt+rn.substr(Se,We);tt>0&&(ht+=dt+rn.slice(Se)),Xt&&(ht="-"+ht)}Le=It?ht+(Ce.decimalSeparator||"")+((tt=+Ce.fractionGroupSize)?It.replace(new RegExp("\\d{"+tt+"}\\B","g"),"$&"+(Ce.fractionGroupSeparator||"")):It):ht}return(Ce.prefix||"")+Le+(Ce.suffix||"")},_.toFraction=function(X){var pe,Ce,Le,ke,Se,Ye,We,tt,dt,ht,It,Xt,rn=this,ln=rn.c;if(X!=null&&(We=new Re(X),!We.isInteger()&&(We.c||We.s!==1)||We.lt(E)))throw Error(li+"Argument "+(We.isInteger()?"out of range: ":"not an integer: ")+gt(We));if(!ln)return new Re(rn);for(pe=new Re(E),dt=Ce=new Re(E),Le=tt=new Re(E),Xt=kr(ln),Se=pe.e=Xt.length-rn.e-1,pe.c[0]=Zo[(Ye=Se%bn)<0?bn+Ye:Ye],X=!X||We.comparedTo(pe)>0?Se>0?pe:dt:We,Ye=Me,Me=1/0,We=new Re(Xt),tt.c[0]=0;ht=l(We,pe,0,1),ke=Ce.plus(ht.times(Le)),ke.comparedTo(X)!=1;)Ce=Le,Le=ke,dt=tt.plus(ht.times(ke=dt)),tt=ke,pe=We.minus(ht.times(ke=pe)),We=ke;return ke=l(X.minus(Ce),Le,0,1),tt=tt.plus(ke.times(dt)),Ce=Ce.plus(ke.times(Le)),tt.s=dt.s=rn.s,Se=Se*2,It=l(dt,Le,Se,R).minus(rn).abs().comparedTo(l(tt,Ce,Se,R).minus(rn).abs())<1?[dt,Le]:[tt,Ce],Me=Ye,It},_.toNumber=function(){return+gt(this)},_.toPrecision=function(X,pe){return X!=null&&r(X,1,pr),Ve(this,X,pe,2)},_.toString=function(X){var pe,Ce=this,Le=Ce.s,ke=Ce.e;return ke===null?Le?(pe="Infinity",Le<0&&(pe="-"+pe)):pe="NaN":(X==null?pe=ke<=W||ke>=he?v(kr(Ce.c),ke):S(kr(Ce.c),ke,"0"):X===10&&wn?(Ce=at(new Re(Ce),B+ke+1,R),pe=S(kr(Ce.c),Ce.e,"0")):(r(X,2,Ht.length,"Base"),pe=h(S(kr(Ce.c),ke,"0"),10,X,Le,!0)),Le<0&&Ce.c[0]&&(pe="-"+pe)),pe},_.valueOf=_.toJSON=function(){return gt(this)},_._isBigNumber=!0,_[Symbol.toStringTag]="BigNumber",_[Symbol.for("nodejs.util.inspect.custom")]=_.valueOf,s!=null&&Re.set(s),Re}function Pr(s){var l=s|0;return s>0||s===l?l:l-1}function kr(s){for(var l,h,g=1,_=s.length,E=s[0]+"";g<_;){for(l=s[g++]+"",h=bn-l.length;h--;l="0"+l);E+=l}for(_=E.length;E.charCodeAt(--_)===48;);return E.slice(0,_+1||1)}function zs(s,l){var h,g,_=s.c,E=l.c,B=s.s,R=l.s,W=s.e,he=l.e;if(!B||!R)return null;if(h=_&&!_[0],g=E&&!E[0],h||g)return h?g?0:-R:B;if(B!=R)return B;if(h=B<0,g=W==he,!_||!E)return g?0:!_^h?1:-1;if(!g)return W>he^h?1:-1;for(R=(W=_.length)<(he=E.length)?W:he,B=0;B<R;B++)if(_[B]!=E[B])return _[B]>E[B]^h?1:-1;return W==he?0:W>he^h?1:-1}function r(s,l,h,g){if(s<l||s>h||s!==Hi(s))throw Error(li+(g||"Argument")+(typeof s=="number"?s<l||s>h?" out of range: ":" not an integer: ":" not a primitive number: ")+String(s))}function c(s){var l=s.c.length-1;return Pr(s.e/bn)==l&&s.c[l]%2!=0}function v(s,l){return(s.length>1?s.charAt(0)+"."+s.slice(1):s)+(l<0?"e":"e+")+l}function S(s,l,h){var g,_;if(l<0){for(_=h+".";++l;_+=h);s=_+s}else if(g=s.length,++l>g){for(_=h,l-=g;--l;_+=h);s+=_}else l<g&&(s=s.slice(0,l)+"."+s.slice(l));return s}var U=Fl(),me=U,Ge=class{constructor(s){jt(this,"key");jt(this,"left",null);jt(this,"right",null);this.key=s}},ft=class extends Ge{constructor(s){super(s)}},xt=class{constructor(){jt(this,"size",0);jt(this,"modificationCount",0);jt(this,"splayCount",0)}splay(s){let l=this.root;if(l==null)return this.compare(s,s),-1;let h=null,g=null,_=null,E=null,B=l,R=this.compare,W;for(;;)if(W=R(B.key,s),W>0){let he=B.left;if(he==null||(W=R(he.key,s),W>0&&(B.left=he.right,he.right=B,B=he,he=B.left,he==null)))break;h==null?g=B:h.left=B,h=B,B=he}else if(W<0){let he=B.right;if(he==null||(W=R(he.key,s),W<0&&(B.right=he.left,he.left=B,B=he,he=B.right,he==null)))break;_==null?E=B:_.right=B,_=B,B=he}else break;return _!=null&&(_.right=B.left,B.left=E),h!=null&&(h.left=B.right,B.right=g),this.root!==B&&(this.root=B,this.splayCount++),W}splayMin(s){let l=s,h=l.left;for(;h!=null;){let g=h;l.left=g.right,g.right=l,l=g,h=l.left}return l}splayMax(s){let l=s,h=l.right;for(;h!=null;){let g=h;l.right=g.left,g.left=l,l=g,h=l.right}return l}_delete(s){if(this.root==null||this.splay(s)!=0)return null;let l=this.root,h=l,g=l.left;if(this.size--,g==null)this.root=l.right;else{let _=l.right;l=this.splayMax(g),l.right=_,this.root=l}return this.modificationCount++,h}addNewRoot(s,l){this.size++,this.modificationCount++;let h=this.root;if(h==null){this.root=s;return}l<0?(s.left=h,s.right=h.right,h.right=null):(s.right=h,s.left=h.left,h.left=null),this.root=s}_first(){let s=this.root;return s==null?null:(this.root=this.splayMin(s),this.root)}_last(){let s=this.root;return s==null?null:(this.root=this.splayMax(s),this.root)}clear(){this.root=null,this.size=0,this.modificationCount++}has(s){return this.validKey(s)&&this.splay(s)==0}defaultCompare(){return(s,l)=>s<l?-1:s>l?1:0}wrap(){return{getRoot:()=>this.root,setRoot:s=>{this.root=s},getSize:()=>this.size,getModificationCount:()=>this.modificationCount,getSplayCount:()=>this.splayCount,setSplayCount:s=>{this.splayCount=s},splay:s=>this.splay(s),has:s=>this.has(s)}}},Ft=class lc extends xt{constructor(h,g){super();jt(this,"root",null);jt(this,"compare");jt(this,"validKey");jt(this,Wt,"[object Set]");this.compare=h??this.defaultCompare(),this.validKey=g??(_=>_!=null&&_!=null)}delete(h){return this.validKey(h)?this._delete(h)!=null:!1}deleteAll(h){for(let g of h)this.delete(g)}forEach(h){let g=this[Symbol.iterator](),_;for(;_=g.next(),!_.done;)h(_.value,_.value,this)}add(h){let g=this.splay(h);return g!=0&&this.addNewRoot(new ft(h),g),this}addAndReturn(h){let g=this.splay(h);return g!=0&&this.addNewRoot(new ft(h),g),this.root.key}addAll(h){for(let g of h)this.add(g)}isEmpty(){return this.root==null}isNotEmpty(){return this.root!=null}single(){if(this.size==0)throw"Bad state: No element";if(this.size>1)throw"Bad state: Too many element";return this.root.key}first(){if(this.size==0)throw"Bad state: No element";return this._first().key}last(){if(this.size==0)throw"Bad state: No element";return this._last().key}lastBefore(h){if(h==null)throw"Invalid arguments(s)";if(this.root==null)return null;if(this.splay(h)<0)return this.root.key;let g=this.root.left;if(g==null)return null;let _=g.right;for(;_!=null;)g=_,_=g.right;return g.key}firstAfter(h){if(h==null)throw"Invalid arguments(s)";if(this.root==null)return null;if(this.splay(h)>0)return this.root.key;let g=this.root.right;if(g==null)return null;let _=g.left;for(;_!=null;)g=_,_=g.left;return g.key}retainAll(h){let g=new lc(this.compare,this.validKey),_=this.modificationCount;for(let E of h){if(_!=this.modificationCount)throw"Concurrent modification during iteration.";this.validKey(E)&&this.splay(E)==0&&g.add(this.root.key)}g.size!=this.size&&(this.root=g.root,this.size=g.size,this.modificationCount++)}lookup(h){return!this.validKey(h)||this.splay(h)!=0?null:this.root.key}intersection(h){let g=new lc(this.compare,this.validKey);for(let _ of this)h.has(_)&&g.add(_);return g}difference(h){let g=new lc(this.compare,this.validKey);for(let _ of this)h.has(_)||g.add(_);return g}union(h){let g=this.clone();return g.addAll(h),g}clone(){let h=new lc(this.compare,this.validKey);return h.size=this.size,h.root=this.copyNode(this.root),h}copyNode(h){if(h==null)return null;function g(E,B){let R,W;do{if(R=E.left,W=E.right,R!=null){let he=new ft(R.key);B.left=he,g(R,he)}if(W!=null){let he=new ft(W.key);B.right=he,E=W,B=he}}while(W!=null)}let _=new ft(h.key);return g(h,_),_}toSet(){return this.clone()}entries(){return new Rn(this.wrap())}keys(){return this[Symbol.iterator]()}values(){return this[Symbol.iterator]()}[(gn=Symbol.iterator,Wt=Symbol.toStringTag,gn)](){return new hn(this.wrap())}},Jt=class{constructor(s){jt(this,"tree");jt(this,"path",new Array);jt(this,"modificationCount",null);jt(this,"splayCount");this.tree=s,this.splayCount=s.getSplayCount()}[Symbol.iterator](){return this}next(){return this.moveNext()?{done:!1,value:this.current()}:{done:!0,value:null}}current(){if(!this.path.length)return null;let s=this.path[this.path.length-1];return this.getValue(s)}rebuildPath(s){this.path.splice(0,this.path.length),this.tree.splay(s),this.path.push(this.tree.getRoot()),this.splayCount=this.tree.getSplayCount()}findLeftMostDescendent(s){for(;s!=null;)this.path.push(s),s=s.left}moveNext(){if(this.modificationCount!=this.tree.getModificationCount()){if(this.modificationCount==null){this.modificationCount=this.tree.getModificationCount();let h=this.tree.getRoot();for(;h!=null;)this.path.push(h),h=h.left;return this.path.length>0}throw"Concurrent modification during iteration."}if(!this.path.length)return!1;this.splayCount!=this.tree.getSplayCount()&&this.rebuildPath(this.path[this.path.length-1].key);let s=this.path[this.path.length-1],l=s.right;if(l!=null){for(;l!=null;)this.path.push(l),l=l.left;return!0}for(this.path.pop();this.path.length&&this.path[this.path.length-1].right===s;)s=this.path.pop();return this.path.length>0}},hn=class extends Jt{getValue(s){return s.key}},Rn=class extends Jt{getValue(s){return[s.key,s.key]}},Er=s=>s,Wi=s=>{if(s){let l=new Ft(ko(s)),h=new Ft(ko(s)),g=(E,B)=>B.addAndReturn(E),_=E=>({x:g(E.x,l),y:g(E.y,h)});return _({x:new me(0),y:new me(0)}),_}return Er},Dr=s=>({set:l=>{Ai=Dr(l)},reset:()=>Dr(s),compare:ko(s),snap:Wi(s),orient:js(s)}),Ai=Dr(),Us=(s,l)=>s.ll.x.isLessThanOrEqualTo(l.x)&&l.x.isLessThanOrEqualTo(s.ur.x)&&s.ll.y.isLessThanOrEqualTo(l.y)&&l.y.isLessThanOrEqualTo(s.ur.y),jl=(s,l)=>{if(l.ur.x.isLessThan(s.ll.x)||s.ur.x.isLessThan(l.ll.x)||l.ur.y.isLessThan(s.ll.y)||s.ur.y.isLessThan(l.ll.y))return null;let h=s.ll.x.isLessThan(l.ll.x)?l.ll.x:s.ll.x,g=s.ur.x.isLessThan(l.ur.x)?s.ur.x:l.ur.x,_=s.ll.y.isLessThan(l.ll.y)?l.ll.y:s.ll.y,E=s.ur.y.isLessThan(l.ur.y)?s.ur.y:l.ur.y;return{ll:{x:h,y:_},ur:{x:g,y:E}}},_s=(s,l)=>s.x.times(l.y).minus(s.y.times(l.x)),is=(s,l)=>s.x.times(l.x).plus(s.y.times(l.y)),Vr=s=>is(s,s).sqrt(),Hu=(s,l,h)=>{let g={x:l.x.minus(s.x),y:l.y.minus(s.y)},_={x:h.x.minus(s.x),y:h.y.minus(s.y)};return _s(_,g).div(Vr(_)).div(Vr(g))},zl=(s,l,h)=>{let g={x:l.x.minus(s.x),y:l.y.minus(s.y)},_={x:h.x.minus(s.x),y:h.y.minus(s.y)};return is(_,g).div(Vr(_)).div(Vr(g))},si=(s,l,h)=>l.y.isZero()?null:{x:s.x.plus(l.x.div(l.y).times(h.minus(s.y))),y:h},gr=(s,l,h)=>l.x.isZero()?null:{x:h,y:s.y.plus(l.y.div(l.x).times(h.minus(s.x)))},Wu=(s,l,h,g)=>{if(l.x.isZero())return gr(h,g,s.x);if(g.x.isZero())return gr(s,l,h.x);if(l.y.isZero())return si(h,g,s.y);if(g.y.isZero())return si(s,l,h.y);let _=_s(l,g);if(_.isZero())return null;let E={x:h.x.minus(s.x),y:h.y.minus(s.y)},B=_s(E,l).div(_),R=_s(E,g).div(_),W=s.x.plus(R.times(l.x)),he=h.x.plus(B.times(g.x)),Ie=s.y.plus(R.times(l.y)),Me=h.y.plus(B.times(g.y)),rt=W.plus(he).div(2),pt=Ie.plus(Me).div(2);return{x:rt,y:pt}},$s=class R1{constructor(l,h){jt(this,"point");jt(this,"isLeft");jt(this,"segment");jt(this,"otherSE");jt(this,"consumedBy");l.events===void 0?l.events=[this]:l.events.push(this),this.point=l,this.isLeft=h}static compare(l,h){let g=R1.comparePoints(l.point,h.point);return g!==0?g:(l.point!==h.point&&l.link(h),l.isLeft!==h.isLeft?l.isLeft?1:-1:Ko.compare(l.segment,h.segment))}static comparePoints(l,h){return l.x.isLessThan(h.x)?-1:l.x.isGreaterThan(h.x)?1:l.y.isLessThan(h.y)?-1:l.y.isGreaterThan(h.y)?1:0}link(l){if(l.point===this.point)throw new Error("Tried to link already linked events");let h=l.point.events;for(let g=0,_=h.length;g<_;g++){let E=h[g];this.point.events.push(E),E.point=this.point}this.checkForConsuming()}checkForConsuming(){let l=this.point.events.length;for(let h=0;h<l;h++){let g=this.point.events[h];if(g.segment.consumedBy===void 0)for(let _=h+1;_<l;_++){let E=this.point.events[_];E.consumedBy===void 0&&g.otherSE.point.events===E.otherSE.point.events&&g.segment.consume(E.segment)}}}getAvailableLinkedEvents(){let l=[];for(let h=0,g=this.point.events.length;h<g;h++){let _=this.point.events[h];_!==this&&!_.segment.ringOut&&_.segment.isInResult()&&l.push(_)}return l}getLeftmostComparator(l){let h=new Map,g=_=>{let E=_.otherSE;h.set(_,{sine:Hu(this.point,l.point,E.point),cosine:zl(this.point,l.point,E.point)})};return(_,E)=>{h.has(_)||g(_),h.has(E)||g(E);let{sine:B,cosine:R}=h.get(_),{sine:W,cosine:he}=h.get(E);return B.isGreaterThanOrEqualTo(0)&&W.isGreaterThanOrEqualTo(0)?R.isLessThan(he)?1:R.isGreaterThan(he)?-1:0:B.isLessThan(0)&&W.isLessThan(0)?R.isLessThan(he)?-1:R.isGreaterThan(he)?1:0:W.isLessThan(B)?-1:W.isGreaterThan(B)?1:0}}},hu=0,Ko=class _h{constructor(l,h,g,_){jt(this,"id");jt(this,"leftSE");jt(this,"rightSE");jt(this,"rings");jt(this,"windings");jt(this,"ringOut");jt(this,"consumedBy");jt(this,"prev");jt(this,"_prevInResult");jt(this,"_beforeState");jt(this,"_afterState");jt(this,"_isInResult");this.id=++hu,this.leftSE=l,l.segment=this,l.otherSE=h,this.rightSE=h,h.segment=this,h.otherSE=l,this.rings=g,this.windings=_}static compare(l,h){let g=l.leftSE.point.x,_=h.leftSE.point.x,E=l.rightSE.point.x,B=h.rightSE.point.x;if(B.isLessThan(g))return 1;if(E.isLessThan(_))return-1;let R=l.leftSE.point.y,W=h.leftSE.point.y,he=l.rightSE.point.y,Ie=h.rightSE.point.y;if(g.isLessThan(_)){if(W.isLessThan(R)&&W.isLessThan(he))return 1;if(W.isGreaterThan(R)&&W.isGreaterThan(he))return-1;let Me=l.comparePoint(h.leftSE.point);if(Me<0)return 1;if(Me>0)return-1;let rt=h.comparePoint(l.rightSE.point);return rt!==0?rt:-1}if(g.isGreaterThan(_)){if(R.isLessThan(W)&&R.isLessThan(Ie))return-1;if(R.isGreaterThan(W)&&R.isGreaterThan(Ie))return 1;let Me=h.comparePoint(l.leftSE.point);if(Me!==0)return Me;let rt=l.comparePoint(h.rightSE.point);return rt<0?1:rt>0?-1:1}if(R.isLessThan(W))return-1;if(R.isGreaterThan(W))return 1;if(E.isLessThan(B)){let Me=h.comparePoint(l.rightSE.point);if(Me!==0)return Me}if(E.isGreaterThan(B)){let Me=l.comparePoint(h.rightSE.point);if(Me<0)return 1;if(Me>0)return-1}if(!E.eq(B)){let Me=he.minus(R),rt=E.minus(g),pt=Ie.minus(W),Dt=B.minus(_);if(Me.isGreaterThan(rt)&&pt.isLessThan(Dt))return 1;if(Me.isLessThan(rt)&&pt.isGreaterThan(Dt))return-1}return E.isGreaterThan(B)?1:E.isLessThan(B)||he.isLessThan(Ie)?-1:he.isGreaterThan(Ie)?1:l.id<h.id?-1:l.id>h.id?1:0}static fromRing(l,h,g){let _,E,B,R=$s.comparePoints(l,h);if(R<0)_=l,E=h,B=1;else if(R>0)_=h,E=l,B=-1;else throw new Error(`Tried to create degenerate segment at [${l.x}, ${l.y}]`);let W=new $s(_,!0),he=new $s(E,!1);return new _h(W,he,[g],[B])}replaceRightSE(l){this.rightSE=l,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}bbox(){let l=this.leftSE.point.y,h=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:l.isLessThan(h)?l:h},ur:{x:this.rightSE.point.x,y:l.isGreaterThan(h)?l:h}}}vector(){return{x:this.rightSE.point.x.minus(this.leftSE.point.x),y:this.rightSE.point.y.minus(this.leftSE.point.y)}}isAnEndpoint(l){return l.x.eq(this.leftSE.point.x)&&l.y.eq(this.leftSE.point.y)||l.x.eq(this.rightSE.point.x)&&l.y.eq(this.rightSE.point.y)}comparePoint(l){return Ai.orient(this.leftSE.point,l,this.rightSE.point)}getIntersection(l){let h=this.bbox(),g=l.bbox(),_=jl(h,g);if(_===null)return null;let E=this.leftSE.point,B=this.rightSE.point,R=l.leftSE.point,W=l.rightSE.point,he=Us(h,R)&&this.comparePoint(R)===0,Ie=Us(g,E)&&l.comparePoint(E)===0,Me=Us(h,W)&&this.comparePoint(W)===0,rt=Us(g,B)&&l.comparePoint(B)===0;if(Ie&&he)return rt&&!Me?B:!rt&&Me?W:null;if(Ie)return Me&&E.x.eq(W.x)&&E.y.eq(W.y)?null:E;if(he)return rt&&B.x.eq(R.x)&&B.y.eq(R.y)?null:R;if(rt&&Me)return null;if(rt)return B;if(Me)return W;let pt=Wu(E,this.vector(),R,l.vector());return pt===null||!Us(_,pt)?null:Ai.snap(pt)}split(l){let h=[],g=l.events!==void 0,_=new $s(l,!0),E=new $s(l,!1),B=this.rightSE;this.replaceRightSE(E),h.push(E),h.push(_);let R=new _h(_,B,this.rings.slice(),this.windings.slice());return $s.comparePoints(R.leftSE.point,R.rightSE.point)>0&&R.swapEvents(),$s.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),g&&(_.checkForConsuming(),E.checkForConsuming()),h}swapEvents(){let l=this.rightSE;this.rightSE=this.leftSE,this.leftSE=l,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(let h=0,g=this.windings.length;h<g;h++)this.windings[h]*=-1}consume(l){let h=this,g=l;for(;h.consumedBy;)h=h.consumedBy;for(;g.consumedBy;)g=g.consumedBy;let _=_h.compare(h,g);if(_!==0){if(_>0){let E=h;h=g,g=E}if(h.prev===g){let E=h;h=g,g=E}for(let E=0,B=g.rings.length;E<B;E++){let R=g.rings[E],W=g.windings[E],he=h.rings.indexOf(R);he===-1?(h.rings.push(R),h.windings.push(W)):h.windings[he]+=W}g.rings=null,g.windings=null,g.consumedBy=h,g.leftSE.consumedBy=h.leftSE,g.rightSE.consumedBy=h.rightSE}}prevInResult(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}beforeState(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{let l=this.prev.consumedBy||this.prev;this._beforeState=l.afterState()}return this._beforeState}afterState(){if(this._afterState!==void 0)return this._afterState;let l=this.beforeState();this._afterState={rings:l.rings.slice(0),windings:l.windings.slice(0),multiPolys:[]};let h=this._afterState.rings,g=this._afterState.windings,_=this._afterState.multiPolys;for(let R=0,W=this.rings.length;R<W;R++){let he=this.rings[R],Ie=this.windings[R],Me=h.indexOf(he);Me===-1?(h.push(he),g.push(Ie)):g[Me]+=Ie}let E=[],B=[];for(let R=0,W=h.length;R<W;R++){if(g[R]===0)continue;let he=h[R],Ie=he.poly;if(B.indexOf(Ie)===-1)if(he.isExterior)E.push(Ie);else{B.indexOf(Ie)===-1&&B.push(Ie);let Me=E.indexOf(he.poly);Me!==-1&&E.splice(Me,1)}}for(let R=0,W=E.length;R<W;R++){let he=E[R].multiPoly;_.indexOf(he)===-1&&_.push(he)}return this._afterState}isInResult(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;let l=this.beforeState().multiPolys,h=this.afterState().multiPolys;switch(pu.type){case"union":{let g=l.length===0,_=h.length===0;this._isInResult=g!==_;break}case"intersection":{let g,_;l.length<h.length?(g=l.length,_=h.length):(g=h.length,_=l.length),this._isInResult=_===pu.numMultiPolys&&g<_;break}case"xor":{let g=Math.abs(l.length-h.length);this._isInResult=g%2===1;break}case"difference":{let g=_=>_.length===1&&_[0].isSubject;this._isInResult=g(l)!==g(h);break}}return this._isInResult}},dl=class{constructor(s,l,h){jt(this,"poly");jt(this,"isExterior");jt(this,"segments");jt(this,"bbox");if(!Array.isArray(s)||s.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=l,this.isExterior=h,this.segments=[],typeof s[0][0]!="number"||typeof s[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");let g=Ai.snap({x:new me(s[0][0]),y:new me(s[0][1])});this.bbox={ll:{x:g.x,y:g.y},ur:{x:g.x,y:g.y}};let _=g;for(let E=1,B=s.length;E<B;E++){if(typeof s[E][0]!="number"||typeof s[E][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");let R=Ai.snap({x:new me(s[E][0]),y:new me(s[E][1])});R.x.eq(_.x)&&R.y.eq(_.y)||(this.segments.push(Ko.fromRing(_,R,this)),R.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=R.x),R.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=R.y),R.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=R.x),R.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=R.y),_=R)}(!g.x.eq(_.x)||!g.y.eq(_.y))&&this.segments.push(Ko.fromRing(_,g,this))}getSweepEvents(){let s=[];for(let l=0,h=this.segments.length;l<h;l++){let g=this.segments[l];s.push(g.leftSE),s.push(g.rightSE)}return s}},du=class{constructor(s,l){jt(this,"multiPoly");jt(this,"exteriorRing");jt(this,"interiorRings");jt(this,"bbox");if(!Array.isArray(s))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new dl(s[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(let h=1,g=s.length;h<g;h++){let _=new dl(s[h],this,!1);_.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=_.bbox.ll.x),_.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=_.bbox.ll.y),_.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=_.bbox.ur.x),_.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=_.bbox.ur.y),this.interiorRings.push(_)}this.multiPoly=l}getSweepEvents(){let s=this.exteriorRing.getSweepEvents();for(let l=0,h=this.interiorRings.length;l<h;l++){let g=this.interiorRings[l].getSweepEvents();for(let _=0,E=g.length;_<E;_++)s.push(g[_])}return s}},$c=class{constructor(s,l){jt(this,"isSubject");jt(this,"polys");jt(this,"bbox");if(!Array.isArray(s))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof s[0][0][0]=="number"&&(s=[s])}catch{}this.polys=[],this.bbox={ll:{x:new me(Number.POSITIVE_INFINITY),y:new me(Number.POSITIVE_INFINITY)},ur:{x:new me(Number.NEGATIVE_INFINITY),y:new me(Number.NEGATIVE_INFINITY)}};for(let h=0,g=s.length;h<g;h++){let _=new du(s[h],this);_.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=_.bbox.ll.x),_.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=_.bbox.ll.y),_.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=_.bbox.ur.x),_.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=_.bbox.ur.y),this.polys.push(_)}this.isSubject=l}getSweepEvents(){let s=[];for(let l=0,h=this.polys.length;l<h;l++){let g=this.polys[l].getSweepEvents();for(let _=0,E=g.length;_<E;_++)s.push(g[_])}return s}},fu=class kf{constructor(l){jt(this,"events");jt(this,"poly");jt(this,"_isExteriorRing");jt(this,"_enclosingRing");this.events=l;for(let h=0,g=l.length;h<g;h++)l[h].segment.ringOut=this;this.poly=null}static factory(l){let h=[];for(let g=0,_=l.length;g<_;g++){let E=l[g];if(!E.isInResult()||E.ringOut)continue;let B=null,R=E.leftSE,W=E.rightSE,he=[R],Ie=R.point,Me=[];for(;B=R,R=W,he.push(R),R.point!==Ie;)for(;;){let rt=R.getAvailableLinkedEvents();if(rt.length===0){let Vt=he[0].point,Ht=he[he.length-1].point;throw new Error(`Unable to complete output ring starting at [${Vt.x}, ${Vt.y}]. Last matching segment found ends at [${Ht.x}, ${Ht.y}].`)}if(rt.length===1){W=rt[0].otherSE;break}let pt=null;for(let Vt=0,Ht=Me.length;Vt<Ht;Vt++)if(Me[Vt].point===R.point){pt=Vt;break}if(pt!==null){let Vt=Me.splice(pt)[0],Ht=he.splice(Vt.index);Ht.unshift(Ht[0].otherSE),h.push(new kf(Ht.reverse()));continue}Me.push({index:he.length,point:R.point});let Dt=R.getLeftmostComparator(B);W=rt.sort(Dt)[0].otherSE;break}h.push(new kf(he))}return h}getGeom(){let l=this.events[0].point,h=[l];for(let he=1,Ie=this.events.length-1;he<Ie;he++){let Me=this.events[he].point,rt=this.events[he+1].point;Ai.orient(Me,l,rt)!==0&&(h.push(Me),l=Me)}if(h.length===1)return null;let g=h[0],_=h[1];Ai.orient(g,l,_)===0&&h.shift(),h.push(h[0]);let E=this.isExteriorRing()?1:-1,B=this.isExteriorRing()?0:h.length-1,R=this.isExteriorRing()?h.length:-1,W=[];for(let he=B;he!=R;he+=E)W.push([h[he].x.toNumber(),h[he].y.toNumber()]);return W}isExteriorRing(){if(this._isExteriorRing===void 0){let l=this.enclosingRing();this._isExteriorRing=l?!l.isExteriorRing():!0}return this._isExteriorRing}enclosingRing(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}_calcEnclosingRing(){var _,E;let l=this.events[0];for(let B=1,R=this.events.length;B<R;B++){let W=this.events[B];$s.compare(l,W)>0&&(l=W)}let h=l.segment.prevInResult(),g=h?h.prevInResult():null;for(;;){if(!h)return null;if(!g)return h.ringOut;if(g.ringOut!==h.ringOut)return((_=g.ringOut)==null?void 0:_.enclosingRing())!==h.ringOut?h.ringOut:(E=h.ringOut)==null?void 0:E.enclosingRing();h=g.prevInResult(),g=h?h.prevInResult():null}}},Ul=class{constructor(s){jt(this,"exteriorRing");jt(this,"interiorRings");this.exteriorRing=s,s.poly=this,this.interiorRings=[]}addInterior(s){this.interiorRings.push(s),s.poly=this}getGeom(){let s=this.exteriorRing.getGeom();if(s===null)return null;let l=[s];for(let h=0,g=this.interiorRings.length;h<g;h++){let _=this.interiorRings[h].getGeom();_!==null&&l.push(_)}return l}},$l=class{constructor(s){jt(this,"rings");jt(this,"polys");this.rings=s,this.polys=this._composePolys(s)}getGeom(){let s=[];for(let l=0,h=this.polys.length;l<h;l++){let g=this.polys[l].getGeom();g!==null&&s.push(g)}return s}_composePolys(s){var h;let l=[];for(let g=0,_=s.length;g<_;g++){let E=s[g];if(!E.poly)if(E.isExteriorRing())l.push(new Ul(E));else{let B=E.enclosingRing();B!=null&&B.poly||l.push(new Ul(B)),(h=B==null?void 0:B.poly)==null||h.addInterior(E)}}return l}},Zu=class{constructor(s,l=Ko.compare){jt(this,"queue");jt(this,"tree");jt(this,"segments");this.queue=s,this.tree=new Ft(l),this.segments=[]}process(s){let l=s.segment,h=[];if(s.consumedBy)return s.isLeft?this.queue.delete(s.otherSE):this.tree.delete(l),h;s.isLeft&&this.tree.add(l);let g=l,_=l;do g=this.tree.lastBefore(g);while(g!=null&&g.consumedBy!=null);do _=this.tree.firstAfter(_);while(_!=null&&_.consumedBy!=null);if(s.isLeft){let E=null;if(g){let R=g.getIntersection(l);if(R!==null&&(l.isAnEndpoint(R)||(E=R),!g.isAnEndpoint(R))){let W=this._splitSafely(g,R);for(let he=0,Ie=W.length;he<Ie;he++)h.push(W[he])}}let B=null;if(_){let R=_.getIntersection(l);if(R!==null&&(l.isAnEndpoint(R)||(B=R),!_.isAnEndpoint(R))){let W=this._splitSafely(_,R);for(let he=0,Ie=W.length;he<Ie;he++)h.push(W[he])}}if(E!==null||B!==null){let R=null;E===null?R=B:B===null?R=E:R=$s.comparePoints(E,B)<=0?E:B,this.queue.delete(l.rightSE),h.push(l.rightSE);let W=l.split(R);for(let he=0,Ie=W.length;he<Ie;he++)h.push(W[he])}h.length>0?(this.tree.delete(l),h.push(s)):(this.segments.push(l),l.prev=g)}else{if(g&&_){let E=g.getIntersection(_);if(E!==null){if(!g.isAnEndpoint(E)){let B=this._splitSafely(g,E);for(let R=0,W=B.length;R<W;R++)h.push(B[R])}if(!_.isAnEndpoint(E)){let B=this._splitSafely(_,E);for(let R=0,W=B.length;R<W;R++)h.push(B[R])}}}this.tree.delete(l)}return h}_splitSafely(s,l){this.tree.delete(s);let h=s.rightSE;this.queue.delete(h);let g=s.split(l);return g.push(h),s.consumedBy===void 0&&this.tree.add(s),g}},md=class{constructor(){jt(this,"type");jt(this,"numMultiPolys")}run(s,l,h){fl.type=s;let g=[new $c(l,!0)];for(let W=0,he=h.length;W<he;W++)g.push(new $c(h[W],!1));if(fl.numMultiPolys=g.length,fl.type==="difference"){let W=g[0],he=1;for(;he<g.length;)jl(g[he].bbox,W.bbox)!==null?he++:g.splice(he,1)}if(fl.type==="intersection")for(let W=0,he=g.length;W<he;W++){let Ie=g[W];for(let Me=W+1,rt=g.length;Me<rt;Me++)if(jl(Ie.bbox,g[Me].bbox)===null)return[]}let _=new Ft($s.compare);for(let W=0,he=g.length;W<he;W++){let Ie=g[W].getSweepEvents();for(let Me=0,rt=Ie.length;Me<rt;Me++)_.add(Ie[Me])}let E=new Zu(_),B=null;for(_.size!=0&&(B=_.first(),_.delete(B));B;){let W=E.process(B);for(let he=0,Ie=W.length;he<Ie;he++){let Me=W[he];Me.consumedBy===void 0&&_.add(Me)}_.size!=0?(B=_.first(),_.delete(B)):B=null}Ai.reset();let R=fu.factory(E.segments);return new $l(R).getGeom()}},fl=new md,pu=fl,vd=(s,...l)=>pu.run("intersection",s,l),yd=(s,...l)=>pu.run("difference",s,l);Ai.set;function gu(s){let l={type:"Feature"};return l.geometry=s,l}function mu(s){return s.type==="Feature"?s.geometry:s}function qc(s){return s&&s.geometry&&s.geometry.coordinates?s.geometry.coordinates:s}function Vc(s){return gu({type:"LineString",coordinates:s})}function vu(s){return gu({type:"MultiLineString",coordinates:s})}function Gc(s){return gu({type:"Polygon",coordinates:s})}function Hc(s){return gu({type:"MultiPolygon",coordinates:s})}function Wc(s,l){let h=mu(s),g=mu(l),_=vd(h.coordinates,g.coordinates);return _.length===0?null:_.length===1?Gc(_[0]):Hc(_)}function p(s,l){let h=mu(s),g=mu(l),_=yd(h.coordinates,g.coordinates);return _.length===0?null:_.length===1?Gc(_[0]):Hc(_)}function w(s){return Array.isArray(s)?1+w(s[0]):-1}function M(s){s instanceof L.Polyline&&(s=s.toGeoJSON(15));let l=qc(s),h=w(l),g=[];return h>1?l.forEach(_=>{g.push(Vc(_))}):g.push(s),g}function z(s){let l=[];return s.eachLayer(h=>{l.push(qc(h.toGeoJSON(15)))}),vu(l)}Ti.Cut=Ti.Polygon.extend({initialize(s){this._map=s,this._shape="Cut",this.toolbarButtonName="cutPolygon"},_finishShape(){if(this._editedLayers=[],!this.options.allowSelfIntersection&&(this._handleSelfIntersection(!0,this._layer.getLatLngs()[0]),this._doesSelfIntersect)||this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;let s=this._layer.getLatLngs();if(s.length<=2)return;let l=L.polygon(s,this.options.pathOptions);l._latlngInfos=this._layer._latlngInfo,this.cut(l),this._cleanupSnapping(),this._otherSnapLayers.splice(this._tempSnapLayerIndex,1),delete this._tempSnapLayerIndex,this._editedLayers.forEach(({layer:g,originalLayer:_})=>{this._fireCut(_,g,_),this._fireCut(this._map,g,_),_.pm._fireEdit()}),this._editedLayers=[];let h=this._hintMarker.getLatLng();this.disable(),this.options.continueDrawing&&(this.enable(),this._hintMarker.setLatLng(h))},cut(s){let l=this._map._layers,h=s._latlngInfos||[];Object.keys(l).map(g=>l[g]).filter(g=>g.pm).filter(g=>!g._pmTempLayer).filter(g=>!L.PM.optIn&&!g.options.pmIgnore||L.PM.optIn&&g.options.pmIgnore===!1).filter(g=>g instanceof L.Polyline).filter(g=>g!==s).filter(g=>g.pm.options.allowCutting).filter(g=>this.options.layersToCut&&L.Util.isArray(this.options.layersToCut)&&this.options.layersToCut.length>0?this.options.layersToCut.indexOf(g)>-1:!0).filter(g=>!this._layerGroup.hasLayer(g)).filter(g=>{try{let _=!!Lr(s.toGeoJSON(15),g.toGeoJSON(15)).features.length>0;return _||g instanceof L.Polyline&&!(g instanceof L.Polygon)?_:!!Wc(s.toGeoJSON(15),g.toGeoJSON(15))}catch{return g instanceof L.Polygon&&console.error("You can't cut polygons with self-intersections"),!1}}).forEach(g=>{let _;if(g instanceof L.Polygon){_=L.polygon(g.getLatLngs());let W=_.getLatLngs();h.forEach(he=>{if(he&&he.snapInfo){let{latlng:Ie}=he,Me=this._calcClosestLayer(Ie,[_]);if(Me&&Me.segment&&Me.distance<this.options.snapDistance){let{segment:rt}=Me;if(rt&&rt.length===2){let{indexPath:pt,parentPath:Dt,newIndex:Vt}=L.PM.Utils._getIndexFromSegment(W,rt);(pt.length>1?(0,ai.default)(W,Dt):W).splice(Vt,0,Ie)}}}})}else _=g;let E=this._cutLayer(s,_),B=L.geoJSON(E,g.options);B.getLayers().length===1&&([B]=B.getLayers()),this._setPane(B,"layerPane");let R=B.addTo(this._map.pm._getContainingLayer());if(R.pm.enable(g.pm.options),R.pm.disable(),g._pmTempLayer=!0,s._pmTempLayer=!0,g.remove(),g.removeFrom(this._map.pm._getContainingLayer()),s.remove(),s.removeFrom(this._map.pm._getContainingLayer()),R.getLayers&&R.getLayers().length===0&&this._map.pm.removeLayer({target:R}),R instanceof L.LayerGroup?(R.eachLayer(W=>{this._addDrawnLayerProp(W)}),this._addDrawnLayerProp(R)):this._addDrawnLayerProp(R),this.options.layersToCut&&L.Util.isArray(this.options.layersToCut)&&this.options.layersToCut.length>0){let W=this.options.layersToCut.indexOf(g);W>-1&&this.options.layersToCut.splice(W,1)}this._editedLayers.push({layer:R,originalLayer:g})})},_cutLayer(s,l){let h=L.geoJSON(),g;if(l instanceof L.Polygon)g=p(l.toGeoJSON(15),s.toGeoJSON(15));else{let _=M(l);_.forEach(E=>{let B=Cr(E,s.toGeoJSON(15)),R;B&&B.features.length>0?R=L.geoJSON(B):R=L.geoJSON(E),R.getLayers().forEach(W=>{Lo(s.toGeoJSON(15),W.toGeoJSON(15))||W.addTo(h)})}),_.length>1?g=z(h):g=h.toGeoJSON(15)}return g},_change:L.Util.falseFn}),Ti.Text=Ti.extend({initialize(s){this._map=s,this._shape="Text",this.toolbarButtonName="drawText"},enable(s){L.Util.setOptions(this,s),this._enabled=!0,this._map.on("click",this._createMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._hintMarker=L.marker(this._map.getCenter(),{interactive:!1,zIndexOffset:100,icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._setPane(this._hintMarker,"vertexPane"),this._hintMarker._pmTempLayer=!0,this._hintMarker.addTo(this._map),this.options.cursorMarker&&L.DomUtil.addClass(this._hintMarker._icon,"visible"),this.options.tooltips&&this._hintMarker.bindTooltip(dn("tooltips.placeText"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this._layer=this._hintMarker,this._map.on("mousemove",this._syncHintMarker,this),this._map.getContainer().classList.add("geoman-draw-cursor"),this._fireDrawStart(),this._setGlobalDrawMode()},disable(){var s;this._enabled&&(this._enabled=!1,this._map.off("click",this._createMarker,this),(s=this._hintMarker)==null||s.remove(),this._map.getContainer().classList.remove("geoman-draw-cursor"),this._map.off("mousemove",this._syncHintMarker,this),this._map.off("mousemove",this._showHintMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},enabled(){return this._enabled},toggle(s){this.enabled()?this.disable():this.enable(s)},_syncHintMarker(s){if(this._hintMarker.setLatLng(s.latlng),this.options.snappable){let l=s;l.target=this._hintMarker,this._handleSnapping(l)}},_createMarker(s){var _,E,B,R;if(!s.latlng||this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;this._hintMarker._snapped||this._hintMarker.setLatLng(s.latlng);let l=this._hintMarker.getLatLng();if(this.textArea=this._createTextArea(),(_=this.options.textOptions)==null?void 0:_.className){let W=this.options.textOptions.className.split(" ");this.textArea.classList.add(...W)}let h=this._createTextIcon(this.textArea),g=new L.Marker(l,{textMarker:!0,_textMarkerOverPM:!0,icon:h});if(this._setPane(g,"markerPane"),this._finishLayer(g),g.pm||(g.options.draggable=!1),g.addTo(this._map.pm._getContainingLayer()),g.pm){g.pm.textArea=this.textArea,L.setOptions(g.pm,{removeIfEmpty:((E=this.options.textOptions)==null?void 0:E.removeIfEmpty)??!0});let W=((B=this.options.textOptions)==null?void 0:B.focusAfterDraw)??!0;g.pm._createTextMarker(W),(R=this.options.textOptions)!=null&&R.text&&g.pm.setText(this.options.textOptions.text)}this._fireCreate(g),this._cleanupSnapping(),this.disable(),this.options.continueDrawing&&this._map.once("mousemove",this._showHintMarkerAfterMoving,this)},_showHintMarkerAfterMoving(s){this.enable(),this._hintMarker.setLatLng(s.latlng)},_createTextArea(){let s=document.createElement("textarea");return s.readOnly=!0,s.classList.add("pm-textarea","pm-disabled"),s},_createTextIcon(s){return L.divIcon({className:"pm-text-marker",html:s})}});var ne={enableLayerDrag(){if(!this.options.draggable||!this._layer._map)return;this.disable(),this._layerDragEnabled=!0,this._map||(this._map=this._layer._map),(this._layer instanceof L.Marker||this._layer instanceof L.ImageOverlay)&&L.DomEvent.on(this._getDOMElem(),"dragstart",this._stopDOMImageDrag),this._layer.dragging&&this._layer.dragging.disable(),this._tempDragCoord=null,qi(this._layer)instanceof L.Canvas?(this._layer.on("mouseout",this.removeDraggingClass,this),this._layer.on("mouseover",this.addDraggingClass,this)):this.addDraggingClass(),this._originalMapDragState=this._layer._map.dragging._enabled,this._safeToCacheDragState=!0;let s=this._getDOMElem();s&&(qi(this._layer)instanceof L.Canvas?(this._layer.on("touchstart mousedown",this._dragMixinOnMouseDown,this),this._map.pm._addTouchEvents(s)):L.DomEvent.on(s,"touchstart mousedown",this._simulateMouseDownEvent,this)),this._fireDragEnable()},disableLayerDrag(){this._layerDragEnabled=!1,qi(this._layer)instanceof L.Canvas?(this._layer.off("mouseout",this.removeDraggingClass,this),this._layer.off("mouseover",this.addDraggingClass,this)):this.removeDraggingClass(),this._originalMapDragState&&this._dragging&&this._map.dragging.enable(),this._safeToCacheDragState=!1,this._layer.dragging&&this._layer.dragging.disable();let s=this._getDOMElem();s&&(qi(this._layer)instanceof L.Canvas?(this._layer.off("touchstart mousedown",this._dragMixinOnMouseDown,this),this._map.pm._removeTouchEvents(s)):L.DomEvent.off(s,"touchstart mousedown",this._simulateMouseDownEvent,this)),this._layerDragged&&this._fireUpdate(),this._layerDragged=!1,this._fireDragDisable()},dragging(){return this._dragging},layerDragEnabled(){return!!this._layerDragEnabled},_simulateMouseDownEvent(s){let l=s.touches?s.touches[0]:s,h={originalEvent:l,target:this._layer};return h.containerPoint=this._map.mouseEventToContainerPoint(l),h.latlng=this._map.containerPointToLatLng(h.containerPoint),this._dragMixinOnMouseDown(h),!1},_simulateMouseMoveEvent(s){let l=s.touches?s.touches[0]:s,h={originalEvent:l,target:this._layer};return h.containerPoint=this._map.mouseEventToContainerPoint(l),h.latlng=this._map.containerPointToLatLng(h.containerPoint),this._dragMixinOnMouseMove(h),!1},_simulateMouseUpEvent(s){let l={originalEvent:s.touches?s.touches[0]:s,target:this._layer};return s.type.indexOf("touch")===-1&&(l.containerPoint=this._map.mouseEventToContainerPoint(s),l.latlng=this._map.containerPointToLatLng(l.containerPoint)),this._dragMixinOnMouseUp(l),!1},_dragMixinOnMouseDown(s){if(s.originalEvent.button>0)return;this._overwriteEventIfItComesFromMarker(s);let l=s._fromLayerSync,h=this._syncLayers("_dragMixinOnMouseDown",s);if(this._layer instanceof L.Marker&&(this.options.snappable&&!l&&!h?this._initSnappableMarkers():this._disableSnapping()),this._layer instanceof L.CircleMarker){let g="resizeableCircleMarker";this._layer instanceof L.Circle&&(g="resizeableCircle"),this.options.snappable&&!l&&!h?this._layer.pm.options[g]||this._initSnappableMarkersDrag():this._layer.pm.options[g]?this._layer.pm._disableSnapping():this._layer.pm._disableSnappingDrag()}this._safeToCacheDragState&&(this._originalMapDragState=this._layer._map.dragging._enabled,this._safeToCacheDragState=!1),this._tempDragCoord=s.latlng,L.DomEvent.on(this._map.getContainer(),"touchend mouseup",this._simulateMouseUpEvent,this),L.DomEvent.on(this._map.getContainer(),"touchmove mousemove",this._simulateMouseMoveEvent,this)},_dragMixinOnMouseMove(s){this._overwriteEventIfItComesFromMarker(s);let l=this._getDOMElem();this._syncLayers("_dragMixinOnMouseMove",s),this._dragging||(this._dragging=!0,L.DomUtil.addClass(l,"leaflet-pm-dragging"),this._layer instanceof L.Marker||this._layer.bringToFront(),this._originalMapDragState&&this._map.dragging.disable(),this._fireDragStart()),this._tempDragCoord||(this._tempDragCoord=s.latlng),this._onLayerDrag(s),this._layer instanceof L.CircleMarker&&this._layer.pm._updateHiddenPolyCircle()},_dragMixinOnMouseUp(s){let l=this._getDOMElem();return this._syncLayers("_dragMixinOnMouseUp",s),this._originalMapDragState&&this._map.dragging.enable(),this._safeToCacheDragState=!0,L.DomEvent.off(this._map.getContainer(),"touchmove mousemove",this._simulateMouseMoveEvent,this),L.DomEvent.off(this._map.getContainer(),"touchend mouseup",this._simulateMouseUpEvent,this),this._dragging?(this._layer instanceof L.CircleMarker&&this._layer.pm._updateHiddenPolyCircle(),this._layerDragged=!0,window.setTimeout(()=>{this._dragging=!1,l&&L.DomUtil.removeClass(l,"leaflet-pm-dragging"),this._fireDragEnd(),this._fireEdit(),this._layerEdited=!0},10),!0):!1},_onLayerDrag(s){let{latlng:l}=s,h={lat:l.lat-this._tempDragCoord.lat,lng:l.lng-this._tempDragCoord.lng},g=_=>_.map(E=>{if(Array.isArray(E))return g(E);let B={lat:E.lat+h.lat,lng:E.lng+h.lng};return(E.alt||E.alt===0)&&(B.alt=E.alt),B});if(this._layer instanceof L.Circle&&this._layer.options.resizeableCircle||this._layer instanceof L.CircleMarker&&this._layer.options.resizeableCircleMarker){let _=g([this._layer.getLatLng()]);this._layer.setLatLng(_[0]),this._fireChange(this._layer.getLatLng(),"Edit")}else if(this._layer instanceof L.CircleMarker||this._layer instanceof L.Marker){let _=this._layer.getLatLng();this._layer._snapped&&(_=this._layer._orgLatLng);let E=g([_]);this._layer.setLatLng(E[0]),this._fireChange(this._layer.getLatLng(),"Edit")}else if(this._layer instanceof L.ImageOverlay){let _=g([this._layer.getBounds().getNorthWest(),this._layer.getBounds().getSouthEast()]);this._layer.setBounds(_),this._fireChange(this._layer.getBounds(),"Edit")}else{let _=g(this._layer.getLatLngs());this._layer.setLatLngs(_),this._fireChange(this._layer.getLatLngs(),"Edit")}this._tempDragCoord=l,s.layer=this._layer,this._fireDrag(s)},addDraggingClass(){let s=this._getDOMElem();s&&L.DomUtil.addClass(s,"leaflet-pm-draggable")},removeDraggingClass(){let s=this._getDOMElem();s&&L.DomUtil.removeClass(s,"leaflet-pm-draggable")},_getDOMElem(){let s=null;return this._layer._path?s=this._layer._path:this._layer._renderer&&this._layer._renderer._container?s=this._layer._renderer._container:this._layer._image?s=this._layer._image:this._layer._icon&&(s=this._layer._icon),s},_overwriteEventIfItComesFromMarker(s){s.target.getLatLng&&(!s.target._radius||s.target._radius<=10)&&(s.containerPoint=this._map.mouseEventToContainerPoint(s.originalEvent),s.latlng=this._map.containerPointToLatLng(s.containerPoint))},_syncLayers(s,l){if(this.enabled())return!1;if(!l._fromLayerSync&&this._layer===l.target&&this.options.syncLayersOnDrag){l._fromLayerSync=!0;let h=[];if(L.Util.isArray(this.options.syncLayersOnDrag))h=this.options.syncLayersOnDrag,this.options.syncLayersOnDrag.forEach(g=>{g instanceof L.LayerGroup&&(h=h.concat(g.pm.getLayers(!0)))});else if(this.options.syncLayersOnDrag===!0&&this._parentLayerGroup)for(let g in this._parentLayerGroup){let _=this._parentLayerGroup[g];_.pm&&(h=_.pm.getLayers(!0))}return L.Util.isArray(h)&&h.length>0&&(h=h.filter(g=>!!g.pm).filter(g=>!!g.pm.options.draggable),h.forEach(g=>{g!==this._layer&&g.pm[s]&&(g._snapped=!1,g.pm[s](l))})),h.length>0}return!1},_stopDOMImageDrag(s){return s.preventDefault(),!1}},ge=ne,ve=f(cr());function be(s,l,h,g){return h.unproject(l.transform(h.project(s,g)),g)}function xe(s,l,h){let g=h.getMaxZoom();if(g===1/0&&(g=h.getZoom()),L.Util.isArray(s)){let _=[];return s.forEach(E=>{_.push(xe(E,l,h))}),_}return s instanceof L.LatLng?be(s,l,h,g):null}function Ae(s,l){l instanceof L.Layer&&(l=l.getLatLng());let h=s.getMaxZoom();return h===1/0&&(h=s.getZoom()),s.project(l,h)}function Qe(s,l){let h=s.getMaxZoom();return h===1/0&&(h=s.getZoom()),s.unproject(l,h)}var mt={_onRotateStart(s){this._preventRenderingMarkers(!0),this._rotationOriginLatLng=this._getRotationCenter().clone(),this._rotationOriginPoint=Ae(this._map,this._rotationOriginLatLng),this._rotationStartPoint=Ae(this._map,s.target.getLatLng()),this._initialRotateLatLng=Yr(this._layer),this._startAngle=this.getAngle();let l=Yr(this._rotationLayer,this._rotationLayer.pm._rotateOrgLatLng);this._fireRotationStart(this._rotationLayer,l),this._fireRotationStart(this._map,l)},_onRotate(s){let l=Ae(this._map,s.target.getLatLng()),h=this._rotationStartPoint,g=this._rotationOriginPoint,_=Math.atan2(l.y-g.y,l.x-g.x)-Math.atan2(h.y-g.y,h.x-g.x);this._layer.setLatLngs(this._rotateLayer(_,this._initialRotateLatLng,this._rotationOriginLatLng,L.PM.Matrix.init(),this._map));let E=this;function B(Ie,Me=[],rt=-1){if(rt>-1&&Me.push(rt),L.Util.isArray(Ie[0]))Ie.forEach((pt,Dt)=>B(pt,Me.slice(),Dt));else{let pt=Me.length>0?(0,ve.default)(E._markers,Me):E._markers[0];Ie.forEach((Dt,Vt)=>{pt[Vt].setLatLng(Dt)})}}B(this._layer.getLatLngs());let R=Yr(this._rotationLayer);this._rotationLayer.setLatLngs(this._rotateLayer(_,this._rotationLayer.pm._rotateOrgLatLng,this._rotationOriginLatLng,L.PM.Matrix.init(),this._map));let W=_*180/Math.PI;W=W<0?W+360:W;let he=W+this._startAngle;this._setAngle(he),this._rotationLayer.pm._setAngle(he),this._fireRotation(this._rotationLayer,W,R),this._fireRotation(this._map,W,R),this._rotationLayer.pm._fireChange(this._rotationLayer.getLatLngs(),"Rotation")},_onRotateEnd(){let s=this._startAngle;delete this._rotationOriginLatLng,delete this._rotationOriginPoint,delete this._rotationStartPoint,delete this._initialRotateLatLng,delete this._startAngle;let l=Yr(this._rotationLayer,this._rotationLayer.pm._rotateOrgLatLng);this._rotationLayer.pm._rotateOrgLatLng=Yr(this._rotationLayer),this._fireRotationEnd(this._rotationLayer,s,l),this._fireRotationEnd(this._map,s,l),this._rotationLayer.pm._fireEdit(this._rotationLayer,"Rotation"),this._preventRenderingMarkers(!1),this._layerRotated=!0},_rotateLayer(s,l,h,g,_){let E=Ae(_,h);return this._matrix=g.clone().rotate(s,E).flip(),xe(l,this._matrix,_)},_setAngle(s){s=s<0?s+360:s,this._angle=s%360},_getRotationCenter(){if(this._rotationCenter)return this._rotationCenter;let s=L.polygon(this._layer.getLatLngs(),{stroke:!1,fill:!1,pmIgnore:!0}).addTo(this._layer._map),l=s.getCenter();return s.removeFrom(this._layer._map),l},enableRotate(){if(!this.options.allowRotation){this.disableRotate();return}this.rotateEnabled()&&this.disableRotate(),this._layer instanceof L.Rectangle&&this._angle===void 0&&this.setInitAngle(Ds(this._layer._map,this._layer.getLatLngs()[0][0],this._layer.getLatLngs()[0][1])||0);let s={fill:!1,stroke:!1,pmIgnore:!1,snapIgnore:!0};this._rotatePoly=L.polygon(this._layer.getLatLngs(),s),this._rotatePoly._pmTempLayer=!0,this._rotatePoly.addTo(this._layer._map),this._rotatePoly.pm._setAngle(this.getAngle()),this._rotatePoly.pm.setRotationCenter(this.getRotationCenter()),this._rotatePoly.pm.setOptions(this._layer._map.pm.getGlobalOptions()),this._rotatePoly.pm.setOptions({rotate:!0,snappable:!1,hideMiddleMarkers:!0}),this._rotatePoly.pm._rotationLayer=this._layer,this._rotatePoly.pm.enable(),this._rotateOrgLatLng=Yr(this._layer),this._rotateEnabled=!0,this._layer.on("remove",this.disableRotate,this),this._fireRotationEnable(this._layer),this._fireRotationEnable(this._layer._map)},disableRotate(){this.rotateEnabled()&&(this._rotatePoly.pm._layerRotated&&this._fireUpdate(),this._rotatePoly.pm._layerRotated=!1,this._rotatePoly.pm.disable(),this._rotatePoly.remove(),this._rotatePoly.pm.setOptions({rotate:!1}),this._rotatePoly=void 0,this._rotateOrgLatLng=void 0,this._layer.off("remove",this.disableRotate,this),this._rotateEnabled=!1,this._fireRotationDisable(this._layer),this._fireRotationDisable(this._layer._map))},rotateEnabled(){return!!this._rotateEnabled},rotateLayer(s){let l=this.getAngle(),h=this._layer.getLatLngs(),g=s*(Math.PI/180);this._layer.setLatLngs(this._rotateLayer(g,this._layer.getLatLngs(),this._getRotationCenter(),L.PM.Matrix.init(),this._layer._map)),this._rotateOrgLatLng=L.polygon(this._layer.getLatLngs()).getLatLngs(),this._setAngle(this.getAngle()+s),this.rotateEnabled()&&this._rotatePoly&&this._rotatePoly.pm.enabled()&&(this._rotatePoly.setLatLngs(this._rotateLayer(g,this._rotatePoly.getLatLngs(),this._getRotationCenter(),L.PM.Matrix.init(),this._rotatePoly._map)),this._rotatePoly.pm._initMarkers());let _=this.getAngle()-l;_=_<0?_+360:_,this._startAngle=l,this._fireRotation(this._layer,_,h,this._layer),this._fireRotation(this._map||this._layer._map,_,h,this._layer),delete this._startAngle,this._fireChange(this._layer.getLatLngs(),"Rotation")},rotateLayerToAngle(s){let l=s-this.getAngle();this.rotateLayer(l)},getAngle(){return this._angle||0},setInitAngle(s){this._setAngle(s)},getRotationCenter(){return this._getRotationCenter()},setRotationCenter(s){this._rotationCenter=s,this._rotatePoly&&this._rotatePoly.pm.setRotationCenter(s)}},vt=mt,ut=L.Class.extend({includes:[ge,Go,vt,$o],options:{snappable:!0,snapDistance:20,allowSelfIntersection:!0,allowSelfIntersectionEdit:!1,preventMarkerRemoval:!1,removeLayerBelowMinVertexCount:!0,limitMarkersToCount:-1,hideMiddleMarkers:!1,snapSegment:!0,syncLayersOnDrag:!1,draggable:!0,allowEditing:!0,allowRemoval:!0,allowCutting:!0,allowRotation:!0,addVertexOn:"click",removeVertexOn:"contextmenu",removeVertexValidation:void 0,addVertexValidation:void 0,moveVertexValidation:void 0,resizeableCircleMarker:!1,resizeableCircle:!0,snapMiddle:!1,snapVertex:!0},setOptions(s){L.Util.setOptions(this,s)},getOptions(){return this.options},applyOptions(){},isPolygon(){return this._layer instanceof L.Polygon},getShape(){return this._shape},_setPane(s,l){l==="layerPane"?s.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.layerPane||"overlayPane":l==="vertexPane"?s.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.vertexPane||"markerPane":l==="markerPane"&&(s.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.markerPane||"markerPane")},remove(){(this._map||this._layer._map).pm.removeLayer({target:this._layer})},_vertexValidation(s,l){let h=l.target,g={layer:this._layer,marker:h,event:l},_="";return s==="move"?_="moveVertexValidation":s==="add"?_="addVertexValidation":s==="remove"&&(_="removeVertexValidation"),this.options[_]&&typeof this.options[_]=="function"&&!this.options[_](g)?(s==="move"&&(h._cancelDragEventChain=h.getLatLng()),!1):(h._cancelDragEventChain=null,!0)},_vertexValidationDrag(s){return s._cancelDragEventChain?(s._latlng=s._cancelDragEventChain,s.update(),!1):!0},_vertexValidationDragEnd(s){return s._cancelDragEventChain?(s._cancelDragEventChain=null,!1):!0}}),Mt=ut;Mt.LayerGroup=L.Class.extend({initialize(s){this._layerGroup=s,this._layers=this.getLayers(),this._getMap(),this._layers.forEach(g=>this._initLayer(g));let l=g=>{if(g.layer._pmTempLayer)return;this._layers=this.getLayers();let _=this._layers.filter(E=>!E.pm._parentLayerGroup||!(this._layerGroup._leaflet_id in E.pm._parentLayerGroup));_.forEach(E=>{this._initLayer(E)}),_.length>0&&this._getMap()&&this._getMap().pm.globalEditModeEnabled()&&this.enabled()&&this.enable(this.getOptions())};this._layerGroup.on("layeradd",L.Util.throttle(l,100,this),this),this._layerGroup.on("layerremove",g=>{this._removeLayerFromGroup(g.target)},this);let h=g=>{g.target._pmTempLayer||(this._layers=this.getLayers())};this._layerGroup.on("layerremove",L.Util.throttle(h,100,this),this)},enable(s,l=[]){l.length===0&&(this._layers=this.getLayers()),this._options=s,this._layers.forEach(h=>{h instanceof L.LayerGroup?l.indexOf(h._leaflet_id)===-1&&(l.push(h._leaflet_id),h.pm.enable(s,l)):h.pm.enable(s)})},disable(s=[]){s.length===0&&(this._layers=this.getLayers()),this._layers.forEach(l=>{l instanceof L.LayerGroup?s.indexOf(l._leaflet_id)===-1&&(s.push(l._leaflet_id),l.pm.disable(s)):l.pm.disable()})},enabled(s=[]){return s.length===0&&(this._layers=this.getLayers()),!!this._layers.find(l=>l instanceof L.LayerGroup?s.indexOf(l._leaflet_id)===-1?(s.push(l._leaflet_id),l.pm.enabled(s)):!1:l.pm.enabled())},toggleEdit(s,l=[]){l.length===0&&(this._layers=this.getLayers()),this._options=s,this._layers.forEach(h=>{h instanceof L.LayerGroup?l.indexOf(h._leaflet_id)===-1&&(l.push(h._leaflet_id),h.pm.toggleEdit(s,l)):h.pm.toggleEdit(s)})},_initLayer(s){let l=L.Util.stamp(this._layerGroup);s.pm._parentLayerGroup||(s.pm._parentLayerGroup={}),s.pm._parentLayerGroup[l]=this._layerGroup},_removeLayerFromGroup(s){if(s.pm&&s.pm._layerGroup){let l=L.Util.stamp(this._layerGroup);delete s.pm._layerGroup[l]}},dragging(){return this._layers=this.getLayers(),this._layers?!!this._layers.find(s=>s.pm.dragging()):!1},getOptions(){return this.options},_getMap(){var s;return this._map||((s=this._layers.find(l=>!!l._map))==null?void 0:s._map)||null},getLayers(s=!1,l=!0,h=!0,g=[]){let _=[];return s?this._layerGroup.getLayers().forEach(E=>{_.push(E),E instanceof L.LayerGroup&&g.indexOf(E._leaflet_id)===-1&&(g.push(E._leaflet_id),_=_.concat(E.pm.getLayers(!0,!0,!0,g)))}):_=this._layerGroup.getLayers(),h&&(_=_.filter(E=>!(E instanceof L.LayerGroup))),l&&(_=_.filter(E=>!!E.pm),_=_.filter(E=>!E._pmTempLayer),_=_.filter(E=>!L.PM.optIn&&!E.options.pmIgnore||L.PM.optIn&&E.options.pmIgnore===!1)),_},setOptions(s,l=[]){l.length===0&&(this._layers=this.getLayers()),this.options=s,this._layers.forEach(h=>{h.pm&&(h instanceof L.LayerGroup?l.indexOf(h._leaflet_id)===-1&&(l.push(h._leaflet_id),h.pm.setOptions(s,l)):h.pm.setOptions(s))})}}),Mt.Marker=Mt.extend({_shape:"Marker",initialize(s){this._layer=s,this._enabled=!1,this._layer.on("dragend",this._onDragEnd,this)},enable(s={draggable:!0}){if(L.Util.setOptions(this,s),!this.options.allowEditing||!this._layer._map){this.disable();return}this._map=this._layer._map,this.enabled()&&this.disable(),this.applyOptions(),this._layer.on("remove",this.disable,this),this._enabled=!0,this._fireEnable()},disable(){this.enabled()&&(this.disableLayerDrag(),this._layer.off("remove",this.disable,this),this._layer.off("contextmenu",this._removeMarker,this),this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable(),this._enabled=!1)},enabled(){return this._enabled},toggleEdit(s){this.enabled()?this.disable():this.enable(s)},applyOptions(){this.options.snappable?this._initSnappableMarkers():this._disableSnapping(),this.options.draggable?this.enableLayerDrag():this.disableLayerDrag(),this.options.preventMarkerRemoval||this._layer.on("contextmenu",this._removeMarker,this)},_removeMarker(s){let l=s.target;l.remove(),this._fireRemove(l),this._fireRemove(this._map,l)},_onDragEnd(){this._fireEdit(),this._layerEdited=!0},_initSnappableMarkers(){let s=this._layer;this.options.snapDistance=this.options.snapDistance||30,this.options.snapSegment=this.options.snapSegment===void 0?!0:this.options.snapSegment,s.off("pm:drag",this._handleSnapping,this),s.on("pm:drag",this._handleSnapping,this),s.off("pm:dragend",this._cleanupSnapping,this),s.on("pm:dragend",this._cleanupSnapping,this),s.off("pm:dragstart",this._unsnap,this),s.on("pm:dragstart",this._unsnap,this)},_disableSnapping(){let s=this._layer;s.off("pm:drag",this._handleSnapping,this),s.off("pm:dragend",this._cleanupSnapping,this),s.off("pm:dragstart",this._unsnap,this)}});var Ct=f(cr()),it={filterMarkerGroup(){this.markerCache=[],this.createCache(),this._layer.on("pm:edit",this.createCache,this),this.applyLimitFilters({}),this.throttledApplyLimitFilters||(this.throttledApplyLimitFilters=L.Util.throttle(this.applyLimitFilters,100,this)),this._layer.on("pm:disable",this._removeMarkerLimitEvents,this),this._layer.on("remove",this._removeMarkerLimitEvents,this),this.options.limitMarkersToCount>-1&&(this._layer.on("pm:vertexremoved",this._initMarkers,this),this._map.on("mousemove",this.throttledApplyLimitFilters,this))},_removeMarkerLimitEvents(){this._map.off("mousemove",this.throttledApplyLimitFilters,this),this._layer.off("pm:edit",this.createCache,this),this._layer.off("pm:disable",this._removeMarkerLimitEvents,this),this._layer.off("pm:vertexremoved",this._initMarkers,this)},createCache(){let s=[...this._markerGroup.getLayers(),...this.markerCache];this.markerCache=s.filter((l,h,g)=>g.indexOf(l)===h)},_removeFromCache(s){let l=this.markerCache.indexOf(s);l>-1&&this.markerCache.splice(l,1)},renderLimits(s){this.markerCache.forEach(l=>{s.includes(l)?this._markerGroup.addLayer(l):this._markerGroup.removeLayer(l)})},applyLimitFilters({latlng:s={lat:0,lng:0}}){if(this._preventRenderMarkers)return;let l=[...this._filterClosestMarkers(s)];this.renderLimits(l)},_filterClosestMarkers(s){let l=[...this.markerCache],h=this.options.limitMarkersToCount;return h===-1?l:(l.sort((g,_)=>{let E=g._latlng.distanceTo(s),B=_._latlng.distanceTo(s);return E-B}),l.filter((g,_)=>h>-1?_<h:!0))},_preventRenderMarkers:!1,_preventRenderingMarkers(s){this._preventRenderMarkers=!!s}},ot=it;Mt.Line=Mt.extend({includes:[ot],_shape:"Line",initialize(s){this._layer=s,this._enabled=!1},enable(s){if(L.Util.setOptions(this,s),this._map=this._layer._map,!!this._map){if(!this.options.allowEditing){this.disable();return}this.enabled()&&this.disable(),this._enabled=!0,this._initMarkers(),this.applyOptions(),this._layer.on("remove",this.disable,this),this.options.allowSelfIntersection||this._layer.on("pm:vertexremoved",this._handleSelfIntersectionOnVertexRemoval,this),this.options.allowSelfIntersection?this.cachedColor=void 0:(this._layer.options.color!=="#f00000ff"?(this.cachedColor=this._layer.options.color,this.isRed=!1):this.isRed=!0,this._handleLayerStyle()),this._fireEnable()}},disable(){if(!this.enabled()||this._dragging)return;this._enabled=!1,this._markerGroup.clearLayers(),this._markerGroup.removeFrom(this._map),this._layer.off("remove",this.disable,this),this.options.allowSelfIntersection||this._layer.off("pm:vertexremoved",this._handleSelfIntersectionOnVertexRemoval,this);let s=this._layer._path?this._layer._path:this._layer._renderer._container;L.DomUtil.removeClass(s,"leaflet-pm-draggable"),this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable()},enabled(){return this._enabled},toggleEdit(s){return this.enabled()?this.disable():this.enable(s),this.enabled()},applyOptions(){this.options.snappable?this._initSnappableMarkers():this._disableSnapping()},_initMarkers(){let s=this._map,l=this._layer.getLatLngs();this._markerGroup&&(this._markerGroup.removeFrom(s),this._markerGroup.clearLayers()),this._markerGroup=new L.FeatureGroup,this._markerGroup._pmTempLayer=!0;let h=g=>{if(Array.isArray(g[0]))return g.map(h,this);let _=g.map(this._createMarker,this);return this.options.hideMiddleMarkers!==!0&&g.map((E,B)=>{let R=this.isPolygon()?(B+1)%g.length:B+1;return this._createMiddleMarker(_[B],_[R])}),_};this._markers=h(l),this.filterMarkerGroup(),s.addLayer(this._markerGroup)},_createMarker(s){let l=new L.Marker(s,{draggable:!0,icon:L.divIcon({className:"marker-icon"})});return this._setPane(l,"vertexPane"),l._pmTempLayer=!0,this.options.rotate?(l.on("dragstart",this._onRotateStart,this),l.on("drag",this._onRotate,this),l.on("dragend",this._onRotateEnd,this)):(l.on("click",this._onVertexClick,this),l.on("dragstart",this._onMarkerDragStart,this),l.on("move",this._onMarkerDrag,this),l.on("dragend",this._onMarkerDragEnd,this),this.options.preventMarkerRemoval||l.on(this.options.removeVertexOn,this._removeMarker,this)),this._markerGroup.addLayer(l),l},_createMiddleMarker(s,l){if(!s||!l)return!1;let h=L.PM.Utils.calcMiddleLatLng(this._map,s.getLatLng(),l.getLatLng()),g=this._createMarker(h),_=L.divIcon({className:"marker-icon marker-icon-middle"});return g.setIcon(_),g.leftM=s,g.rightM=l,s._middleMarkerNext=g,l._middleMarkerPrev=g,g.on(this.options.addVertexOn,this._onMiddleMarkerClick,this),g.on("movestart",this._onMiddleMarkerMoveStart,this),g},_onMiddleMarkerClick(s){let l=s.target;if(!this._vertexValidation("add",s))return;let h=L.divIcon({className:"marker-icon"});l.setIcon(h),this._addMarker(l,l.leftM,l.rightM)},_onMiddleMarkerMoveStart(s){let l=s.target;if(l.on("moveend",this._onMiddleMarkerMoveEnd,this),!this._vertexValidation("add",s)){l.on("move",this._onMiddleMarkerMovePrevent,this);return}l._dragging=!0,this._addMarker(l,l.leftM,l.rightM)},_onMiddleMarkerMovePrevent(s){let l=s.target;this._vertexValidationDrag(l)},_onMiddleMarkerMoveEnd(s){let l=s.target;if(l.off("move",this._onMiddleMarkerMovePrevent,this),l.off("moveend",this._onMiddleMarkerMoveEnd,this),!this._vertexValidationDragEnd(l))return;let h=L.divIcon({className:"marker-icon"});l.setIcon(h),setTimeout(()=>{delete l._dragging},100)},_addMarker(s,l,h){s.off("movestart",this._onMiddleMarkerMoveStart,this),s.off(this.options.addVertexOn,this._onMiddleMarkerClick,this);let g=s.getLatLng(),_=this._layer._latlngs;delete s.leftM,delete s.rightM;let{indexPath:E,index:B,parentPath:R}=L.PM.Utils.findDeepMarkerIndex(this._markers,l),W=E.length>1?(0,Ct.default)(_,R):_,he=E.length>1?(0,Ct.default)(this._markers,R):this._markers;W.splice(B+1,0,g),he.splice(B+1,0,s),this._layer.setLatLngs(_),this.options.hideMiddleMarkers!==!0&&(this._createMiddleMarker(l,s),this._createMiddleMarker(s,h)),this._fireEdit(),this._layerEdited=!0,this._fireChange(this._layer.getLatLngs(),"Edit"),this._fireVertexAdded(s,L.PM.Utils.findDeepMarkerIndex(this._markers,s).indexPath,g),this.options.snappable&&this._initSnappableMarkers()},hasSelfIntersection(){return zn(this._layer.toGeoJSON(15)).features.length>0},_handleSelfIntersectionOnVertexRemoval(){this._handleLayerStyle(!0)&&(this._layer.setLatLngs(this._coordsBeforeEdit),this._coordsBeforeEdit=null,this._initMarkers())},_handleLayerStyle(s){let l=this._layer,h,g;if(this.options.allowSelfIntersection?h=!1:(g=zn(this._layer.toGeoJSON(15)),h=g.features.length>0),h){if(!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this._updateDisabledMarkerStyle(this._markers,!0),this.isRed)return h;s?this._flashLayer():(l.setStyle({color:"#f00000ff"}),this.isRed=!0),this._fireIntersect(g)}else l.setStyle({color:this.cachedColor}),this.isRed=!1,!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this._updateDisabledMarkerStyle(this._markers,!1);return h},_flashLayer(){this.cachedColor||(this.cachedColor=this._layer.options.color),this._layer.setStyle({color:"#f00000ff"}),this.isRed=!0,window.setTimeout(()=>{this._layer.setStyle({color:this.cachedColor}),this.isRed=!1},200)},_updateDisabledMarkerStyle(s,l){s.forEach(h=>{Array.isArray(h)?this._updateDisabledMarkerStyle(h,l):h._icon&&(l&&!this._checkMarkerAllowedToDrag(h)?L.DomUtil.addClass(h._icon,"vertexmarker-disabled"):L.DomUtil.removeClass(h._icon,"vertexmarker-disabled"))})},_removeMarker(s){let l=s.target;if(!this._vertexValidation("remove",s))return;this.options.allowSelfIntersection||(this._coordsBeforeEdit=Yr(this._layer,this._layer.getLatLngs()));let h=this._layer.getLatLngs(),{indexPath:g,index:_,parentPath:E}=L.PM.Utils.findDeepMarkerIndex(this._markers,l);if(!g)return;let B=g.length>1?(0,Ct.default)(h,E):h,R=g.length>1?(0,Ct.default)(this._markers,E):this._markers,W=E[E.length-1]>0&&this._layer instanceof L.Polygon;if(!this.options.removeLayerBelowMinVertexCount&&!W&&(B.length<=2||this.isPolygon()&&B.length<=3)){this._flashLayer();return}B.splice(_,1),this._layer.setLatLngs(h),this.isPolygon()&&B.length<=2&&B.splice(0,B.length);let he=!1;if(B.length<=1&&(B.splice(0,B.length),E.length>1&&g.length>1&&(h=qo(h)),this._layer.setLatLngs(h),this._initMarkers(),he=!0),br(h)||this._layer.remove(),h=qo(h),this._layer.setLatLngs(h),this._markers=qo(this._markers),!he&&(R=g.length>1?(0,Ct.default)(this._markers,E):this._markers,l._middleMarkerPrev&&(this._markerGroup.removeLayer(l._middleMarkerPrev),this._removeFromCache(l._middleMarkerPrev)),l._middleMarkerNext&&(this._markerGroup.removeLayer(l._middleMarkerNext),this._removeFromCache(l._middleMarkerNext)),this._markerGroup.removeLayer(l),this._removeFromCache(l),R)){let Ie,Me;if(this.isPolygon()?(Ie=(_+1)%R.length,Me=(_+(R.length-1))%R.length):(Me=_-1<0?void 0:_-1,Ie=_+1>=R.length?void 0:_+1),Ie!==Me){let rt=R[Me],pt=R[Ie];this.options.hideMiddleMarkers!==!0&&this._createMiddleMarker(rt,pt)}R.splice(_,1)}this._fireEdit(),this._layerEdited=!0,this._fireVertexRemoved(l,g),this._fireChange(this._layer.getLatLngs(),"Edit")},updatePolygonCoordsFromMarkerDrag(s){let l=this._layer.getLatLngs(),h=s.getLatLng(),{indexPath:g,index:_,parentPath:E}=L.PM.Utils.findDeepMarkerIndex(this._markers,s);(g.length>1?(0,Ct.default)(l,E):l).splice(_,1,h),this._layer.setLatLngs(l)},_getNeighborMarkers(s){let{indexPath:l,index:h,parentPath:g}=L.PM.Utils.findDeepMarkerIndex(this._markers,s),_=l.length>1?(0,Ct.default)(this._markers,g):this._markers,E=(h+1)%_.length,B=(h+(_.length-1))%_.length,R=_[B],W=_[E];return{prevMarker:R,nextMarker:W}},_checkMarkerAllowedToDrag(s){let{prevMarker:l,nextMarker:h}=this._getNeighborMarkers(s),g=L.polyline([l.getLatLng(),s.getLatLng()]),_=L.polyline([s.getLatLng(),h.getLatLng()]),E=Lr(this._layer.toGeoJSON(15),g.toGeoJSON(15)).features.length,B=Lr(this._layer.toGeoJSON(15),_.toGeoJSON(15)).features.length;return s.getLatLng()===this._markers[0][0].getLatLng()?B+=1:s.getLatLng()===this._markers[0][this._markers[0].length-1].getLatLng()&&(E+=1),!(E<=2&&B<=2)},_onMarkerDragStart(s){let l=s.target;if(this.cachedColor||(this.cachedColor=this._layer.options.color),!this._vertexValidation("move",s))return;let{indexPath:h}=L.PM.Utils.findDeepMarkerIndex(this._markers,l);this._fireMarkerDragStart(s,h),this.options.allowSelfIntersection||(this._coordsBeforeEdit=Yr(this._layer,this._layer.getLatLngs())),!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this.hasSelfIntersection()?this._markerAllowedToDrag=this._checkMarkerAllowedToDrag(l):this._markerAllowedToDrag=null},_onMarkerDrag(s){let l=s.target;if(!this._vertexValidationDrag(l))return;let{indexPath:h,index:g,parentPath:_}=L.PM.Utils.findDeepMarkerIndex(this._markers,l);if(!h)return;if(!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this.hasSelfIntersection()&&this._markerAllowedToDrag===!1){this._layer.setLatLngs(this._coordsBeforeEdit),this._initMarkers(),this._handleLayerStyle();return}this.updatePolygonCoordsFromMarkerDrag(l);let E=h.length>1?(0,Ct.default)(this._markers,_):this._markers,B=(g+1)%E.length,R=(g+(E.length-1))%E.length,W=l.getLatLng(),he=E[R].getLatLng(),Ie=E[B].getLatLng();if(l._middleMarkerNext){let Me=L.PM.Utils.calcMiddleLatLng(this._map,W,Ie);l._middleMarkerNext.setLatLng(Me)}if(l._middleMarkerPrev){let Me=L.PM.Utils.calcMiddleLatLng(this._map,W,he);l._middleMarkerPrev.setLatLng(Me)}this.options.allowSelfIntersection||this._handleLayerStyle(),this._fireMarkerDrag(s,h),this._fireChange(this._layer.getLatLngs(),"Edit")},_onMarkerDragEnd(s){let l=s.target;if(!this._vertexValidationDragEnd(l))return;let{indexPath:h}=L.PM.Utils.findDeepMarkerIndex(this._markers,l),g=!this.options.allowSelfIntersection&&this.hasSelfIntersection();g&&this.options.allowSelfIntersectionEdit&&this._markerAllowedToDrag&&(g=!1);let _=!this.options.allowSelfIntersection&&g;if(this._fireMarkerDragEnd(s,h,_),_){this._layer.setLatLngs(this._coordsBeforeEdit),this._coordsBeforeEdit=null,this._initMarkers(),this.options.snappable&&this._initSnappableMarkers(),this._handleLayerStyle(),this._fireLayerReset(s,h);return}!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this._handleLayerStyle(),this._fireEdit(),this._layerEdited=!0,this._fireChange(this._layer.getLatLngs(),"Edit")},_onVertexClick(s){let l=s.target;if(l._dragging)return;let{indexPath:h}=L.PM.Utils.findDeepMarkerIndex(this._markers,l);this._fireVertexClick(s,h)}}),Mt.Polygon=Mt.Line.extend({_shape:"Polygon",_checkMarkerAllowedToDrag(s){let{prevMarker:l,nextMarker:h}=this._getNeighborMarkers(s),g=L.polyline([l.getLatLng(),s.getLatLng()]),_=L.polyline([s.getLatLng(),h.getLatLng()]),E=Lr(this._layer.toGeoJSON(15),g.toGeoJSON(15)).features.length,B=Lr(this._layer.toGeoJSON(15),_.toGeoJSON(15)).features.length;return!(E<=2&&B<=2)}}),Mt.Rectangle=Mt.Polygon.extend({_shape:"Rectangle",_initMarkers(){let s=this._map,l=this._findCorners();this._markerGroup&&this._markerGroup.clearLayers(),this._markerGroup=new L.FeatureGroup,this._markerGroup._pmTempLayer=!0,s.addLayer(this._markerGroup),this._markers=[],this._markers[0]=l.map(this._createMarker,this),[this._cornerMarkers]=this._markers,this._layer.getLatLngs()[0].forEach((h,g)=>{let _=this._cornerMarkers.find(E=>E._index===g);_&&_.setLatLng(h)})},applyOptions(){this.options.snappable?this._initSnappableMarkers():this._disableSnapping(),this._addMarkerEvents()},_createMarker(s,l){let h=new L.Marker(s,{draggable:!0,icon:L.divIcon({className:"marker-icon"})});return this._setPane(h,"vertexPane"),h._origLatLng=s,h._index=l,h._pmTempLayer=!0,h.on("click",this._onVertexClick,this),this._markerGroup.addLayer(h),h},_addMarkerEvents(){this._markers[0].forEach(s=>{s.on("dragstart",this._onMarkerDragStart,this),s.on("drag",this._onMarkerDrag,this),s.on("dragend",this._onMarkerDragEnd,this),this.options.preventMarkerRemoval||s.on("contextmenu",this._removeMarker,this)})},_removeMarker(){return null},_onMarkerDragStart(s){if(!this._vertexValidation("move",s))return;let l=s.target,h=this._cornerMarkers;l._oppositeCornerLatLng=h.find(_=>_._index===(l._index+2)%4).getLatLng(),l._snapped=!1;let{indexPath:g}=L.PM.Utils.findDeepMarkerIndex(this._markers,l);this._fireMarkerDragStart(s,g)},_onMarkerDrag(s){let l=s.target;if(!this._vertexValidationDrag(l)||l._index===void 0)return;this._adjustRectangleForMarkerMove(l);let{indexPath:h}=L.PM.Utils.findDeepMarkerIndex(this._markers,l);this._fireMarkerDrag(s,h),this._fireChange(this._layer.getLatLngs(),"Edit")},_onMarkerDragEnd(s){let l=s.target;if(!this._vertexValidationDragEnd(l))return;this._cornerMarkers.forEach(g=>{delete g._oppositeCornerLatLng});let{indexPath:h}=L.PM.Utils.findDeepMarkerIndex(this._markers,l);this._fireMarkerDragEnd(s,h),this._fireEdit(),this._layerEdited=!0,this._fireChange(this._layer.getLatLngs(),"Edit")},_adjustRectangleForMarkerMove(s){L.extend(s._origLatLng,s._latlng);let l=L.PM.Utils._getRotatedRectangle(s.getLatLng(),s._oppositeCornerLatLng,this.getAngle(),this._map);this._layer.setLatLngs(l),this._adjustAllMarkers(s),this._layer.redraw()},_adjustAllMarkers(s){let l=this._layer.getLatLngs()[0];if(l&&l.length!==4&&l.length>0)l.forEach((h,g)=>{this._cornerMarkers[g].setLatLng(h)}),this._cornerMarkers.slice(l.length).forEach(h=>{h.setLatLng(l[0])});else if(!l||!l.length)console.error("The layer has no LatLngs");else{let h=l.findIndex(g=>s.getLatLng().equals(g));h>-1?(this._cornerMarkers[(s._index+1)%4].setLatLng(l[(h+1)%4]),this._cornerMarkers[(s._index+2)%4].setLatLng(l[(h+2)%4]),this._cornerMarkers[(s._index+3)%4].setLatLng(l[(h+3)%4])):this._cornerMarkers.forEach(g=>{g.setLatLng(l[g._index])})}},_findCorners(){this._angle===void 0&&this.setInitAngle(Ds(this._map,this._layer.getLatLngs()[0][0],this._layer.getLatLngs()[0][1])||0);let s=this._layer.getLatLngs()[0];return L.PM.Utils._getRotatedRectangle(s[0],s[2],this.getAngle(),this._map||this)}}),Mt.CircleMarker=Mt.extend({_shape:"CircleMarker",initialize(s){this._layer=s,this._enabled=!1,this._minRadiusOption="minRadiusCircleMarker",this._maxRadiusOption="maxRadiusCircleMarker",this._editableOption="resizeableCircleMarker",this._updateHiddenPolyCircle()},enable(s={draggable:!0,snappable:!0}){if(L.Util.setOptions(this,s),this.options.editable&&(this.options.resizeableCircleMarker=this.options.editable,delete this.options.editable),!this.options.allowEditing||!this._layer._map){this.disable();return}this._map=this._layer._map,this.enabled()&&this.disable(),this.applyOptions(),this._layer.on("remove",this.disable,this),this._enabled=!0,this._extendingEnable(),this._updateHiddenPolyCircle(),this._fireEnable()},_extendingEnable(){this._layer.on("pm:dragstart",this._onDragStart,this),this._layer.on("pm:drag",this._onMarkerDrag,this),this._layer.on("pm:dragend",this._onMarkerDragEnd,this)},disable(){this.dragging()||(this._map||(this._map=this._layer._map),this._map&&this.enabled()&&(this.layerDragEnabled()&&this.disableLayerDrag(),this._helperLayers&&(this._helperLayers.clearLayers(),this._helperLayers.removeFrom(this._map)),this.options[this._editableOption]?(this._map.off("move",this._syncMarkers,this),this._outerMarker.off("drag",this._handleOuterMarkerSnapping,this)):this._map.off("move",this._updateHiddenPolyCircle,this),this._extendingDisable(),this._layer.off("remove",this.disable,this),this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable(),this._enabled=!1))},_extendingDisable(){this._layer.off("contextmenu",this._removeMarker,this)},enabled(){return this._enabled},toggleEdit(s){this.enabled()?this.disable():this.enable(s)},applyOptions(){this.options[this._editableOption]?(this._initMarkers(),this._map.on("move",this._syncMarkers,this),this.options.snappable?(this._initSnappableMarkers(),this._outerMarker.on("drag",this._handleOuterMarkerSnapping,this),this._outerMarker.on("move",this._syncHintLine,this),this._outerMarker.on("move",this._syncCircleRadius,this)):this._disableSnapping()):(this.options.draggable&&this.enableLayerDrag(),this._map.on("move",this._updateHiddenPolyCircle,this),this.options.snappable?this._initSnappableMarkersDrag():this._disableSnappingDrag()),this._extendingApplyOptions()},_extendingApplyOptions(){this.options.preventMarkerRemoval||this._layer.on("contextmenu",this._removeMarker,this)},_initMarkers(){let s=this._map;this._helperLayers&&(this._helperLayers.removeFrom(s),this._helperLayers.clearLayers()),this._helperLayers=new L.FeatureGroup,this._helperLayers._pmTempLayer=!0,this._helperLayers.addTo(s);let l=this._layer.getLatLng(),h=this._layer._radius,g=this._getLatLngOnCircle(l,h);this._centerMarker=this._createCenterMarker(l),this._outerMarker=this._createOuterMarker(g),this._markers=[this._centerMarker,this._outerMarker],this._createHintLine(this._centerMarker,this._outerMarker)},_getLatLngOnCircle(s,l){let h=this._map.project(s),g=L.point(h.x+l,h.y);return this._map.unproject(g)},_createHintLine(s,l){let h=s.getLatLng(),g=l.getLatLng();this._hintline=L.polyline([h,g],this.options.hintlineStyle),this._setPane(this._hintline,"layerPane"),this._hintline._pmTempLayer=!0,this._helperLayers.addLayer(this._hintline)},_createCenterMarker(s){let l=this._createMarker(s);return this.options.draggable?(L.DomUtil.addClass(l._icon,"leaflet-pm-draggable"),l.on("move",this._moveCircle,this)):l.dragging.disable(),l},_createOuterMarker(s){let l=this._createMarker(s);return l.on("drag",this._resizeCircle,this),l},_createMarker(s){let l=new L.Marker(s,{draggable:!0,icon:L.divIcon({className:"marker-icon"})});return this._setPane(l,"vertexPane"),l._origLatLng=s,l._pmTempLayer=!0,l.on("dragstart",this._onMarkerDragStart,this),l.on("drag",this._onMarkerDrag,this),l.on("dragend",this._onMarkerDragEnd,this),l.on("click",this._onVertexClick,this),this._helperLayers.addLayer(l),l},_moveCircle(s){if(s.target._cancelDragEventChain)return;let l=this._centerMarker.getLatLng();this._layer.setLatLng(l);let h=this._layer._radius,g=this._getLatLngOnCircle(l,h);this._outerMarker._latlng=g,this._outerMarker.update(),this._syncHintLine(),this._updateHiddenPolyCircle(),this._fireCenterPlaced("Edit"),this._fireChange(this._layer.getLatLng(),"Edit")},_syncMarkers(){let s=this._layer.getLatLng(),l=this._layer._radius,h=this._getLatLngOnCircle(s,l);this._outerMarker.setLatLng(h),this._centerMarker.setLatLng(s),this._syncHintLine(),this._updateHiddenPolyCircle()},_resizeCircle(){this._outerMarker.setLatLng(this._getNewDestinationOfOuterMarker()),this._syncHintLine(),this._syncCircleRadius()},_syncCircleRadius(){let s=this._centerMarker.getLatLng(),l=this._outerMarker.getLatLng(),h=this._distanceCalculation(s,l);this.options[this._minRadiusOption]&&h<this.options[this._minRadiusOption]?this._layer.setRadius(this.options[this._minRadiusOption]):this.options[this._maxRadiusOption]&&h>this.options[this._maxRadiusOption]?this._layer.setRadius(this.options[this._maxRadiusOption]):this._layer.setRadius(h),this._updateHiddenPolyCircle(),this._fireChange(this._layer.getLatLng(),"Edit")},_syncHintLine(){let s=this._centerMarker.getLatLng(),l=this._outerMarker.getLatLng();this._hintline.setLatLngs([s,l])},_removeMarker(){this.options[this._editableOption]&&this.disable(),this._layer.remove(),this._fireRemove(this._layer),this._fireRemove(this._map,this._layer)},_onDragStart(){this._map.pm.Draw.CircleMarker._layerIsDragging=!0},_onMarkerDragStart(s){this._vertexValidation("move",s)&&this._fireMarkerDragStart(s)},_onMarkerDrag(s){let l=s.target;l instanceof L.Marker&&!this._vertexValidationDrag(l)||this._fireMarkerDrag(s)},_onMarkerDragEnd(s){this._extedingMarkerDragEnd();let l=s.target;this._vertexValidationDragEnd(l)&&(this.options[this._editableOption]&&(this._fireEdit(),this._layerEdited=!0),this._fireMarkerDragEnd(s))},_extedingMarkerDragEnd(){this._map.pm.Draw.CircleMarker._layerIsDragging=!1},_initSnappableMarkersDrag(){let s=this._layer;this.options.snapDistance=this.options.snapDistance||30,this.options.snapSegment=this.options.snapSegment===void 0?!0:this.options.snapSegment,s.off("pm:drag",this._handleSnapping,this),s.on("pm:drag",this._handleSnapping,this),s.off("pm:dragend",this._cleanupSnapping,this),s.on("pm:dragend",this._cleanupSnapping,this),s.off("pm:dragstart",this._unsnap,this),s.on("pm:dragstart",this._unsnap,this)},_disableSnappingDrag(){let s=this._layer;s.off("pm:drag",this._handleSnapping,this),s.off("pm:dragend",this._cleanupSnapping,this),s.off("pm:dragstart",this._unsnap,this)},_updateHiddenPolyCircle(){let s=this._layer._map||this._map;if(s){let l=L.PM.Utils.pxRadiusToMeterRadius(this._layer.getRadius(),s,this._layer.getLatLng()),h=L.circle(this._layer.getLatLng(),this._layer.options);h.setRadius(l);let g=s&&s.pm._isCRSSimple();this._hiddenPolyCircle?this._hiddenPolyCircle.setLatLngs(L.PM.Utils.circleToPolygon(h,200,!g).getLatLngs()):this._hiddenPolyCircle=L.PM.Utils.circleToPolygon(h,200,!g),this._hiddenPolyCircle._parentCopy||(this._hiddenPolyCircle._parentCopy=this._layer)}},_getNewDestinationOfOuterMarker(){let s=this._centerMarker.getLatLng(),l=this._outerMarker.getLatLng(),h=this._distanceCalculation(s,l);return this.options[this._minRadiusOption]&&h<this.options[this._minRadiusOption]?l=ma(this._map,s,l,this._getMinDistanceInMeter(s)):this.options[this._maxRadiusOption]&&h>this.options[this._maxRadiusOption]&&(l=ma(this._map,s,l,this._getMaxDistanceInMeter(s))),l},_handleOuterMarkerSnapping(){if(this._outerMarker._snapped){let s=this._centerMarker.getLatLng(),l=this._outerMarker.getLatLng(),h=this._distanceCalculation(s,l);this.options[this._minRadiusOption]&&h<this.options[this._minRadiusOption]?this._outerMarker.setLatLng(this._outerMarker._orgLatLng):this.options[this._maxRadiusOption]&&h>this.options[this._maxRadiusOption]&&this._outerMarker.setLatLng(this._outerMarker._orgLatLng)}this._outerMarker.setLatLng(this._getNewDestinationOfOuterMarker())},_distanceCalculation(s,l){return this._map.project(s).distanceTo(this._map.project(l))},_getMinDistanceInMeter(s){return L.PM.Utils.pxRadiusToMeterRadius(this.options[this._minRadiusOption],this._map,s)},_getMaxDistanceInMeter(s){return L.PM.Utils.pxRadiusToMeterRadius(this.options[this._maxRadiusOption],this._map,s)},_onVertexClick(s){s.target._dragging||this._fireVertexClick(s,void 0)}}),Mt.Circle=Mt.CircleMarker.extend({_shape:"Circle",initialize(s){this._layer=s,this._enabled=!1,this._minRadiusOption="minRadiusCircle",this._maxRadiusOption="maxRadiusCircle",this._editableOption="resizeableCircle",this._updateHiddenPolyCircle()},enable(s){L.PM.Edit.CircleMarker.prototype.enable.call(this,s||{})},_extendingEnable(){},_extendingDisable(){this._layer.off("remove",this.disable,this);let s=this._layer._path?this._layer._path:this._layer._renderer._container;L.DomUtil.removeClass(s,"leaflet-pm-draggable")},_extendingApplyOptions(){},_syncMarkers(){},_removeMarker(){},_onDragStart(){},_extedingMarkerDragEnd(){},_updateHiddenPolyCircle(){let s=this._map&&this._map.pm._isCRSSimple();this._hiddenPolyCircle?this._hiddenPolyCircle.setLatLngs(L.PM.Utils.circleToPolygon(this._layer,200,!s).getLatLngs()):this._hiddenPolyCircle=L.PM.Utils.circleToPolygon(this._layer,200,!s),this._hiddenPolyCircle._parentCopy||(this._hiddenPolyCircle._parentCopy=this._layer)},_distanceCalculation(s,l){return this._map.distance(s,l)},_getMinDistanceInMeter(){return this.options[this._minRadiusOption]},_getMaxDistanceInMeter(){return this.options[this._maxRadiusOption]},_onVertexClick(s){s.target._dragging||this._fireVertexClick(s,void 0)}}),Mt.ImageOverlay=Mt.extend({_shape:"ImageOverlay",initialize(s){this._layer=s,this._enabled=!1},toggleEdit(s){this.enabled()?this.disable():this.enable(s)},enabled(){return this._enabled},enable(s={draggable:!0,snappable:!0}){if(L.Util.setOptions(this,s),this._map=this._layer._map,!!this._map){if(!this.options.allowEditing){this.disable();return}this.enabled()||this.disable(),this.enableLayerDrag(),this._layer.on("remove",this.disable,this),this._enabled=!0,this._otherSnapLayers=this._findCorners(),this._fireEnable()}},disable(){this._dragging||(this._map||(this._map=this._layer._map),this.disableLayerDrag(),this._layer.off("remove",this.disable,this),this.enabled()||(this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable()),this._enabled=!1)},_findCorners(){let s=this._layer.getBounds(),l=s.getNorthWest(),h=s.getNorthEast(),g=s.getSouthEast(),_=s.getSouthWest();return[l,h,g,_]}}),Mt.Text=Mt.extend({_shape:"Text",initialize(s){this._layer=s,this._enabled=!1},enable(s){if(L.Util.setOptions(this,s),!!this.textArea){if(!this.options.allowEditing||!this._layer._map){this.disable();return}this._map=this._layer._map,this.enabled()&&this.disable(),this.applyOptions(),this._safeToCacheDragState=!0,this._focusChange(),this.textArea.readOnly=!1,this.textArea.classList.remove("pm-disabled"),this._layer.on("remove",this.disable,this),L.DomEvent.on(this.textArea,"input",this._autoResize,this),L.DomEvent.on(this.textArea,"focus",this._focusChange,this),L.DomEvent.on(this.textArea,"blur",this._focusChange,this),this._layer.on("dblclick",L.DomEvent.stop),L.DomEvent.off(this.textArea,"mousedown",this._preventTextSelection),this._enabled=!0,this._fireEnable()}},disable(){if(!this.enabled())return;this._layer.off("remove",this.disable,this),L.DomEvent.off(this.textArea,"input",this._autoResize,this),L.DomEvent.off(this.textArea,"focus",this._focusChange,this),L.DomEvent.off(this.textArea,"blur",this._focusChange,this),L.DomEvent.off(document,"click",this._documentClick,this),this._focusChange(),this.textArea.readOnly=!0,this.textArea.classList.add("pm-disabled");let s=document.activeElement;this.textArea.focus(),this.textArea.selectionStart=0,this.textArea.selectionEnd=0,L.DomEvent.on(this.textArea,"mousedown",this._preventTextSelection),s.focus(),this._disableOnBlurActive=!1,this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable(),this._enabled=!1},enabled(){return this._enabled},toggleEdit(s){this.enabled()?this.disable():this.enable(s)},applyOptions(){this.options.snappable?this._initSnappableMarkers():this._disableSnapping()},_initSnappableMarkers(){let s=this._layer;this.options.snapDistance=this.options.snapDistance||30,this.options.snapSegment=this.options.snapSegment===void 0?!0:this.options.snapSegment,s.off("pm:drag",this._handleSnapping,this),s.on("pm:drag",this._handleSnapping,this),s.off("pm:dragend",this._cleanupSnapping,this),s.on("pm:dragend",this._cleanupSnapping,this),s.off("pm:dragstart",this._unsnap,this),s.on("pm:dragstart",this._unsnap,this)},_disableSnapping(){let s=this._layer;s.off("pm:drag",this._handleSnapping,this),s.off("pm:dragend",this._cleanupSnapping,this),s.off("pm:dragstart",this._unsnap,this)},_autoResize(){this.textArea.style.height="1px",this.textArea.style.width="1px";let s=this.textArea.scrollHeight>21?this.textArea.scrollHeight:21,l=this.textArea.scrollWidth>16?this.textArea.scrollWidth:16;this.textArea.style.height=`${s}px`,this.textArea.style.width=`${l}px`,this._layer.options.text=this.getText(),this._fireTextChange(this.getText())},_disableOnBlur(){this._disableOnBlurActive=!0,setTimeout(()=>{this.enabled()&&L.DomEvent.on(document,"click",this._documentClick,this)},100)},_documentClick(s){s.target!==this.textArea&&(this.disable(),!this.getText()&&this.options.removeIfEmpty&&this.remove())},_focusChange(s={}){let l=this._hasFocus;this._hasFocus=s.type==="focus",!l!=!this._hasFocus&&(this._hasFocus?(this._applyFocus(),this._focusText=this.getText(),this._fireTextFocus()):(this._removeFocus(),this._fireTextBlur(),this._focusText!==this.getText()&&(this._fireEdit(),this._layerEdited=!0)))},_applyFocus(){this.textArea.classList.add("pm-hasfocus"),this._map.dragging&&(this._safeToCacheDragState&&(this._originalMapDragState=this._map.dragging._enabled,this._safeToCacheDragState=!1),this._map.dragging.disable())},_removeFocus(){this._map.dragging&&(this._originalMapDragState&&this._map.dragging.enable(),this._safeToCacheDragState=!0),this.textArea.classList.remove("pm-hasfocus")},focus(){if(!this.enabled())throw new TypeError("Layer is not enabled");this.textArea.focus()},blur(){if(!this.enabled())throw new TypeError("Layer is not enabled");this.textArea.blur(),this._disableOnBlurActive&&this.disable()},hasFocus(){return this._hasFocus},getElement(){return this.textArea},setText(s){s&&(this.textArea.value=s),this._autoResize()},getText(){return this.textArea.value},_initTextMarker(){if(this.textArea=L.PM.Draw.Text.prototype._createTextArea.call(this),this.options.className){let l=this.options.className.split(" ");this.textArea.classList.add(...l)}let s=L.PM.Draw.Text.prototype._createTextIcon.call(this,this.textArea);this._layer.setIcon(s),this._layer.once("add",this._createTextMarker,this)},_createTextMarker(s=!1){this._layer.off("add",this._createTextMarker,this),this._layer.getElement().tabIndex=-1,this.textArea.wrap="off",this.textArea.style.overflow="hidden",this.textArea.style.height=L.DomUtil.getStyle(this.textArea,"font-size"),this.textArea.style.width="1px",this._layer.options.text&&this.setText(this._layer.options.text),this._autoResize(),s===!0&&(this.enable(),this.focus(),this._disableOnBlur())},_preventTextSelection(s){s.preventDefault()}});var Bt=function(s,l,h,g,_,E){this._matrix=[s,l,h,g,_,E]};Bt.init=()=>new L.PM.Matrix(1,0,0,1,0,0),Bt.prototype={transform(s){return this._transform(s.clone())},_transform(s){let l=this._matrix,{x:h,y:g}=s;return s.x=l[0]*h+l[1]*g+l[4],s.y=l[2]*h+l[3]*g+l[5],s},untransform(s){let l=this._matrix;return new L.Point((s.x/l[0]-l[4])/l[0],(s.y/l[2]-l[5])/l[2])},clone(){let s=this._matrix;return new L.PM.Matrix(s[0],s[1],s[2],s[3],s[4],s[5])},translate(s){if(s===void 0)return new L.Point(this._matrix[4],this._matrix[5]);let l,h;return typeof s=="number"?(l=s,h=s):(l=s.x,h=s.y),this._add(1,0,0,1,l,h)},scale(s,l){if(s===void 0)return new L.Point(this._matrix[0],this._matrix[3]);let h,g;return l=l||L.point(0,0),typeof s=="number"?(h=s,g=s):(h=s.x,g=s.y),this._add(h,0,0,g,l.x,l.y)._add(1,0,0,1,-l.x,-l.y)},rotate(s,l){let h=Math.cos(s),g=Math.sin(s);return l=l||new L.Point(0,0),this._add(h,g,-g,h,l.x,l.y)._add(1,0,0,1,-l.x,-l.y)},flip(){return this._matrix[1]*=-1,this._matrix[2]*=-1,this},_add(s,l,h,g,_,E){let B=[[],[],[]],R=this._matrix,W=[[R[0],R[2],R[4]],[R[1],R[3],R[5]],[0,0,1]],he=[[s,h,_],[l,g,E],[0,0,1]],Ie;s&&s instanceof L.PM.Matrix&&(R=s._matrix,he=[[R[0],R[2],R[4]],[R[1],R[3],R[5]],[0,0,1]]);for(let Me=0;Me<3;Me+=1)for(let rt=0;rt<3;rt+=1){Ie=0;for(let pt=0;pt<3;pt+=1)Ie+=W[Me][pt]*he[pt][rt];B[Me][rt]=Ie}return this._matrix=[B[0][0],B[1][0],B[0][1],B[1][1],B[0][2],B[1][2]],this}};var zt=Bt,Ot={calcMiddleLatLng(s,l,h){let g=s.project(l),_=s.project(h);return s.unproject(g._add(_)._divideBy(2))},findLayers(s){let l=[];return s.eachLayer(h=>{(h instanceof L.Polyline||h instanceof L.Marker||h instanceof L.Circle||h instanceof L.CircleMarker||h instanceof L.ImageOverlay)&&l.push(h)}),l=l.filter(h=>!!h.pm),l=l.filter(h=>!h._pmTempLayer),l=l.filter(h=>!L.PM.optIn&&!h.options.pmIgnore||L.PM.optIn&&h.options.pmIgnore===!1),l},circleToPolygon(s,l=60,h=!0){let g=s.getLatLng(),_=s.getRadius(),E=Sr(g,_,l,0,h),B=[];for(let R=0;R<E.length;R+=1){let W=[E[R].lat,E[R].lng];B.push(W)}return L.polygon(B,s.options)},disablePopup(s){s.getPopup()&&(s._tempPopupCopy=s.getPopup(),s.unbindPopup())},enablePopup(s){s._tempPopupCopy&&(s.bindPopup(s._tempPopupCopy),delete s._tempPopupCopy)},_fireEvent(s,l,h,g=!1){s.fire(l,h,g);let{groups:_}=this.getAllParentGroups(s);_.forEach(E=>{E.fire(l,h,g)})},getAllParentGroups(s){let l=[],h=[],g=_=>{for(let E in _._eventParents)if(l.indexOf(E)===-1){l.push(E);let B=_._eventParents[E];h.push(B),g(B)}};return!s._pmLastGroupFetch||!s._pmLastGroupFetch.time||new Date().getTime()-s._pmLastGroupFetch.time>1e3?(g(s),s._pmLastGroupFetch={time:new Date().getTime(),groups:h,groupIds:l},{groupIds:l,groups:h}):{groups:s._pmLastGroupFetch.groups,groupIds:s._pmLastGroupFetch.groupIds}},createGeodesicPolygon:Sr,getTranslation:dn,findDeepCoordIndex(s,l,h=!0){let g,_=B=>(R,W)=>{let he=B.concat(W);if(h){if(R.lat&&R.lat===l.lat&&R.lng===l.lng)return g=he,!0}else if(R.lat&&L.latLng(R).equals(l))return g=he,!0;return Array.isArray(R)&&R.some(_(he))};s.some(_([]));let E={};return g&&(E={indexPath:g,index:g[g.length-1],parentPath:g.slice(0,g.length-1)}),E},findDeepMarkerIndex(s,l){let h,g=E=>(B,R)=>{let W=E.concat(R);return B._leaflet_id===l._leaflet_id?(h=W,!0):Array.isArray(B)&&B.some(g(W))};s.some(g([]));let _={};return h&&(_={indexPath:h,index:h[h.length-1],parentPath:h.slice(0,h.length-1)}),_},_getIndexFromSegment(s,l){if(l&&l.length===2){let h=this.findDeepCoordIndex(s,l[0]),g=this.findDeepCoordIndex(s,l[1]),_=Math.max(h.index,g.index);return(h.index===0||g.index===0)&&_!==1&&(_+=1),{indexA:h,indexB:g,newIndex:_,indexPath:h.indexPath,parentPath:h.parentPath}}return null},_getRotatedRectangle(s,l,h,g){let _=Ae(g,s),E=Ae(g,l),B=h*Math.PI/180,R=Math.cos(B),W=Math.sin(B),he=(E.x-_.x)*R+(E.y-_.y)*W,Ie=(E.y-_.y)*R-(E.x-_.x)*W,Me=he*R+_.x,rt=he*W+_.y,pt=-Ie*W+_.x,Dt=Ie*R+_.y,Vt=Qe(g,_),Ht=Qe(g,{x:Me,y:rt}),wn=Qe(g,E),Re=Qe(g,{x:pt,y:Dt});return[Vt,Ht,wn,Re]},pxRadiusToMeterRadius(s,l,h){let g=l.project(h),_=L.point(g.x+s,g.y);return l.distance(l.unproject(_),h)}},tn=Ot;L.PM=L.PM||{version:Ts.version,Map:Vo,Toolbar:$a,Draw:Ti,Edit:Mt,Utils:tn,Matrix:zt,activeLang:"en",optIn:!1,initialize(s){this.addInitHooks(s)},setOptIn(s){this.optIn=!!s},addInitHooks(){function s(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Map(this)):this.options.pmIgnore||(this.pm=new L.PM.Map(this)),this.pm&&this.pm.setGlobalOptions({})}L.Map.addInitHook(s);function l(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.LayerGroup(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.LayerGroup(this))}L.LayerGroup.addInitHook(l);function h(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.options.textMarker?(this.pm=new L.PM.Edit.Text(this),this.options._textMarkerOverPM||this.pm._initTextMarker(),delete this.options._textMarkerOverPM):this.pm=new L.PM.Edit.Marker(this)):this.options.pmIgnore||(this.options.textMarker?(this.pm=new L.PM.Edit.Text(this),this.options._textMarkerOverPM||this.pm._initTextMarker(),delete this.options._textMarkerOverPM):this.pm=new L.PM.Edit.Marker(this))}L.Marker.addInitHook(h);function g(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.CircleMarker(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.CircleMarker(this))}L.CircleMarker.addInitHook(g);function _(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.Line(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.Line(this))}L.Polyline.addInitHook(_);function E(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.Polygon(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.Polygon(this))}L.Polygon.addInitHook(E);function B(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.Rectangle(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.Rectangle(this))}L.Rectangle.addInitHook(B);function R(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.Circle(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.Circle(this))}L.Circle.addInitHook(R);function W(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.ImageOverlay(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.ImageOverlay(this))}L.ImageOverlay.addInitHook(W)},reInitLayer(s){s instanceof L.LayerGroup&&s.eachLayer(l=>{this.reInitLayer(l)}),s.pm||L.PM.optIn&&s.options.pmIgnore!==!1||s.options.pmIgnore||(s instanceof L.Map?s.pm=new L.PM.Map(s):s instanceof L.Marker?s.options.textMarker?(s.pm=new L.PM.Edit.Text(s),s.pm._initTextMarker(),s.pm._createTextMarker(!1)):s.pm=new L.PM.Edit.Marker(s):s instanceof L.Circle?s.pm=new L.PM.Edit.Circle(s):s instanceof L.CircleMarker?s.pm=new L.PM.Edit.CircleMarker(s):s instanceof L.Rectangle?s.pm=new L.PM.Edit.Rectangle(s):s instanceof L.Polygon?s.pm=new L.PM.Edit.Polygon(s):s instanceof L.Polyline?s.pm=new L.PM.Edit.Line(s):s instanceof L.LayerGroup?s.pm=new L.PM.Edit.LayerGroup(s):s instanceof L.ImageOverlay&&(s.pm=new L.PM.Edit.ImageOverlay(s)))}},L.version==="1.7.1"&&L.Canvas.include({_onClick(s){let l=this._map.mouseEventToLayerPoint(s),h,g;for(let _=this._drawFirst;_;_=_.next)h=_.layer,h.options.interactive&&h._containsPoint(l)&&(!(s.type==="click"||s.type==="preclick")||!this._map._draggableMoved(h))&&(g=h);g&&(L.DomEvent.fakeStop(s),this._fireEvent([g],s))}}),L.PM.initialize()})();class nl extends Xe.Polygon{constructor(n,i,o=0,a=180,u={}){super([[]],{...u,pmIgnore:!1,interactive:!0,className:"leaflet-semicircle"});jt(this,"center");jt(this,"radius");jt(this,"startAngle");jt(this,"stopAngle");jt(this,"numPoints");jt(this,"properties");jt(this,"pm");jt(this,"getRadius",()=>this.radius);jt(this,"getStartAngle",()=>this.startAngle);jt(this,"getStopAngle",()=>this.stopAngle);this.center=n,this.radius=i,this.startAngle=this.normalizeAngle(o),this.stopAngle=this.normalizeAngle(a),this.numPoints=64,this.properties={type:"Semicircle",radius:this.radius,startAngle:this.startAngle,stopAngle:this.stopAngle,style:{...u,startAngle:this.startAngle,stopAngle:this.stopAngle}},this.on("pm:enable",()=>{var d;this.pm&&(this.pm._layers=[],this.pm._markers=[],(d=this.pm._markerGroup)==null||d.clearLayers())}),this.on("pm:vertexadded",()=>{var d;this.pm&&((d=this.pm._markerGroup)==null||d.clearLayers())}),this.on("add",()=>{this._map&&(this.updateGeometry(),this.pm&&this.pm.enable({allowSelfIntersection:!1,preventMarkerRemoval:!0}))}),this.updateProperties()}normalizeAngle(n){return(n%360+360)%360}calculateArcPoints(){if(!this._map)return[];const n=[],i=this.getOpeningAngle();n.push(this.center);for(let o=0;o<=this.numPoints;o++){const u=(this.startAngle+i*o/this.numPoints)*Math.PI/180,d=this.radius*Math.cos(u),m=this.radius*Math.sin(u)/111319.9,y=d/(111319.9*Math.cos(this.center.lat*Math.PI/180)),x=Xe.latLng(this.center.lat+m,this.center.lng+y);n.push(x)}return n.push(this.center),n}setRadius(n){return n<=0?this:(this.radius=n,this.properties.radius=n,this.updateGeometry(),this.updateProperties(),this)}setAngles(n,i){const o=this.normalizeAngle(n),a=this.normalizeAngle(i),u=this.getOpeningAngle();let d=(a-o+360)%360;const f=45;return Math.abs(d-u)>f&&(d>u?d=u+f:d=u-f),d=Math.max(5,Math.min(355,d)),this.startAngle===n?this.stopAngle=(this.startAngle+d)%360:(this.startAngle=o,this.stopAngle=(o+d)%360),this.properties.startAngle=this.startAngle,this.properties.stopAngle=this.stopAngle,this.properties.openingAngle=d,this.properties.style.startAngle=this.startAngle,this.properties.style.stopAngle=this.stopAngle,this.updateGeometry(),this}setOpeningAngle(n){return n<5||n>355?this:(this.stopAngle=(this.startAngle+n)%360,this.properties.openingAngle=n,this.updateGeometry(),this.updateProperties(),this)}setCenter(n){return!n.lat||!n.lng?this:(this.center=n,this.updateGeometry(),this.updateProperties(),this)}getCenter(){return this.center}getOpeningAngle(){return(this.stopAngle-this.startAngle+360)%360}calculatePointOnArc(n){const i=n*Math.PI/180,o=this.radius*Math.cos(i),u=this.radius*Math.sin(i)/111319.9,d=o/(111319.9*Math.cos(this.center.lat*Math.PI/180));return Xe.latLng(this.center.lat+u,this.center.lng+d)}calculateMidpointPosition(){const n=this.getOpeningAngle(),i=(this.startAngle+n/2)%360;return this.calculatePointOnArc(i)}calculateAngleToPoint(n){return Math.atan2(n.lat-this.center.lat,n.lng-this.center.lng)*180/Math.PI}createControlPoints(n,i){const o=[],a=this.calculatePointOnArc(this.startAngle),u=this.calculatePointOnArc(this.stopAngle),d=this.calculateMidpointPosition(),f=this.createControlPoint(n,this.center,"#059669"),m=this.createControlPoint(n,a,"#DC2626"),y=this.createControlPoint(n,u,"#DC2626"),x=this.createControlPoint(n,d,"#2563EB");o.push(f,m,y,x),i(o)}createControlPoint(n,i,o){return Xe.circleMarker(i,{radius:6,color:o,fillColor:o,fillOpacity:1,weight:2,className:"control-point",pmIgnore:!0}).addTo(n)}updateProperties(){const n=this.getOpeningAngle(),i=Math.PI*Math.pow(this.radius,2)*n/360,o=2*Math.PI*this.radius*n/360,a=o+2*this.radius;this.properties.area=i,this.properties.arcLength=o,this.properties.perimeter=a,this.properties.openingAngle=n,this.properties.surfaceInterieure=i,this.properties.surfaceExterieure=i,this.properties.diameter=this.radius*2,this.properties.center=this.center,this.fire("properties:updated",{shape:this,properties:this.properties})}updateGeometry(){if(!this._map)return;const n=this.calculateArcPoints();n.length>0&&(this.setLatLngs([n]),this.updateProperties())}toGeoJSON(){const n=super.toGeoJSON();return{...n,properties:{...n.properties,type:"Semicircle",radius:this.radius,startAngle:this.startAngle,stopAngle:this.stopAngle,openingAngle:this.getOpeningAngle()}}}}class rc extends Xe.Circle{constructor(n,i){const o=i.radius||10;super(n,o,i);jt(this,"properties");this.properties={type:"Circle",style:i||{}},this.updateProperties(),this.on("add",()=>{this.updateProperties()})}updateProperties(){var o;const n=this.getRadius(),i=this.getLatLng();this.properties={...this.properties,radius:n,diameter:n*2,area:Math.PI*Math.pow(n,2),perimeter:2*Math.PI*n,center:i,surfaceInterieure:Math.PI*Math.pow(n,2),surfaceExterieure:Math.PI*Math.pow(n,2),style:{...this.options,color:this.options.color||"#3388ff",weight:this.options.weight||3,opacity:this.options.opacity||1,fillColor:this.options.fillColor||"#3388ff",fillOpacity:this.options.fillOpacity||.2,dashArray:((o=this.options)==null?void 0:o.dashArray)||""}},this.fire("properties:updated",{shape:this,properties:this.properties})}setRadius(n){return super.setRadius(n),this.updateProperties(),this}setLatLng(n){return super.setLatLng(n),this.updateProperties(),this}calculatePointOnCircle(n){const i=this.getLatLng(),o=this.getRadius(),a=n*Math.PI/180;return Xe.latLng(i.lat+o/111319.9*Math.sin(a),i.lng+o/(111319.9*Math.cos(i.lat*Math.PI/180))*Math.cos(a))}getCardinalPoints(){return[0,45,90,135,180,225,270,315].map(n=>this.calculatePointOnCircle(n))}calculateAngleFromPoint(n){const i=this.getLatLng(),o=n.lng-i.lng,a=n.lat-i.lat;let u=Math.atan2(a,o)*180/Math.PI;return u<0&&(u+=360),u}resizeFromControlPoint(n){const o=this.getLatLng().distanceTo(n);o>0&&super.setRadius(o)}}var qs=63710088e-1,wL={centimeters:qs*100,centimetres:qs*100,degrees:qs/111325,feet:qs*3.28084,inches:qs*39.37,kilometers:qs/1e3,kilometres:qs/1e3,meters:qs,metres:qs,miles:qs/1609.344,millimeters:qs*1e3,millimetres:qs*1e3,nauticalmiles:qs/1852,radians:1,yards:qs*1.0936};function jh(e,t,n){n===void 0&&(n={});var i={type:"Feature"};return(n.id===0||n.id)&&(i.id=n.id),n.bbox&&(i.bbox=n.bbox),i.properties=t||{},i.geometry=e,i}function El(e,t,n){n===void 0&&(n={});for(var i=0,o=e;i<o.length;i++){var a=o[i];if(a.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var u=0;u<a[a.length-1].length;u++)if(a[a.length-1][u]!==a[0][u])throw new Error("First and last Position are not equivalent.")}var d={type:"Polygon",coordinates:e};return jh(d,t,n)}function lu(e,t,n){if(n===void 0&&(n={}),e.length<2)throw new Error("coordinates must be an array of two or more positions");var i={type:"LineString",coordinates:e};return jh(i,t,n)}function xL(e,t){t===void 0&&(t="kilometers");var n=wL[t];if(!n)throw new Error(t+" units is invalid");return e*n}function rh(e){var t=e%360;return t*Math.PI/180}function O1(e,t,n){if(e!==null)for(var i,o,a,u,d,f,m,y=0,x=0,k,b=e.type,T=b==="FeatureCollection",$=b==="Feature",H=T?e.features.length:1,I=0;I<H;I++){m=T?e.features[I].geometry:$?e.geometry:e,k=m?m.type==="GeometryCollection":!1,d=k?m.geometries.length:1;for(var Q=0;Q<d;Q++){var se=0,we=0;if(u=k?m.geometries[Q]:m,u!==null){f=u.coordinates;var Be=u.type;switch(y=0,Be){case null:break;case"Point":if(t(f,x,I,se,we)===!1)return!1;x++,se++;break;case"LineString":case"MultiPoint":for(i=0;i<f.length;i++){if(t(f[i],x,I,se,we)===!1)return!1;x++,Be==="MultiPoint"&&se++}Be==="LineString"&&se++;break;case"Polygon":case"MultiLineString":for(i=0;i<f.length;i++){for(o=0;o<f[i].length-y;o++){if(t(f[i][o],x,I,se,we)===!1)return!1;x++}Be==="MultiLineString"&&se++,Be==="Polygon"&&we++}Be==="Polygon"&&se++;break;case"MultiPolygon":for(i=0;i<f.length;i++){for(we=0,o=0;o<f[i].length;o++){for(a=0;a<f[i][o].length-y;a++){if(t(f[i][o][a],x,I,se,we)===!1)return!1;x++}we++}se++}break;case"GeometryCollection":for(i=0;i<u.geometries.length;i++)if(O1(u.geometries[i],t)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function I1(e,t){var n,i,o,a,u,d,f,m,y,x,k=0,b=e.type==="FeatureCollection",T=e.type==="Feature",$=b?e.features.length:1;for(n=0;n<$;n++){for(d=b?e.features[n].geometry:T?e.geometry:e,m=b?e.features[n].properties:T?e.properties:{},y=b?e.features[n].bbox:T?e.bbox:void 0,x=b?e.features[n].id:T?e.id:void 0,f=d?d.type==="GeometryCollection":!1,u=f?d.geometries.length:1,o=0;o<u;o++){if(a=f?d.geometries[o]:d,a===null){if(t(null,k,m,y,x)===!1)return!1;continue}switch(a.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(t(a,k,m,y,x)===!1)return!1;break}case"GeometryCollection":{for(i=0;i<a.geometries.length;i++)if(t(a.geometries[i],k,m,y,x)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}k++}}function LL(e,t,n){var i=n;return I1(e,function(o,a,u,d,f){i=t(i,o,a,u,d,f)}),i}function CL(e,t){I1(e,function(n,i,o,a,u){var d=n===null?null:n.type;switch(d){case null:case"Point":case"LineString":case"Polygon":return t(jh(n,o,{bbox:a,id:u}),i,0)===!1?!1:void 0}var f;switch(d){case"MultiPoint":f="Point";break;case"MultiLineString":f="LineString";break;case"MultiPolygon":f="Polygon";break}for(var m=0;m<n.coordinates.length;m++){var y=n.coordinates[m],x={type:f,coordinates:y};if(t(jh(x,o),i,m)===!1)return!1}})}function PL(e,t){CL(e,function(n,i,o){var a=0;if(n.geometry){var u=n.geometry.type;if(!(u==="Point"||u==="MultiPoint")){var d,f=0,m=0,y=0;if(O1(n,function(x,k,b,T,$){if(d===void 0||i>f||T>m||$>y){d=x,f=i,m=T,y=$,a=0;return}var H=lu([d,x],n.properties);if(t(H,i,o,$,a)===!1)return!1;a++,d=x})===!1)return!1}}})}function kL(e,t,n){var i=n,o=!1;return PL(e,function(a,u,d,f,m){o===!1&&n===void 0?i=a:i=t(i,a,u,d,f,m),o=!0}),i}function J0(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if(e.type==="Feature"&&e.geometry!==null&&e.geometry.type==="Point")return e.geometry.coordinates;if(e.type==="Point")return e.coordinates}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return e;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function Ru(e,t,n){n===void 0&&(n={});var i=J0(e),o=J0(t),a=rh(o[1]-i[1]),u=rh(o[0]-i[0]),d=rh(i[1]),f=rh(o[1]),m=Math.pow(Math.sin(a/2),2)+Math.pow(Math.sin(u/2),2)*Math.cos(d)*Math.cos(f);return xL(2*Math.atan2(Math.sqrt(m),Math.sqrt(1-m)),n.units)}var X0=6378137;function Eu(e){return LL(e,function(t,n){return t+EL(n)},0)}function EL(e){var t=0,n;switch(e.type){case"Polygon":return Q0(e.coordinates);case"MultiPolygon":for(n=0;n<e.coordinates.length;n++)t+=Q0(e.coordinates[n]);return t;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}function Q0(e){var t=0;if(e&&e.length>0){t+=Math.abs(eg(e[0]));for(var n=1;n<e.length;n++)t-=Math.abs(eg(e[n]))}return t}function eg(e){var t,n,i,o,a,u,d,f=0,m=e.length;if(m>2){for(d=0;d<m;d++)d===m-2?(o=m-2,a=m-1,u=0):d===m-1?(o=m-1,a=0,u=1):(o=d,a=d+1,u=d+2),t=e[o],n=e[a],i=e[u],f+=(Gd(i[0])-Gd(t[0]))*Math.sin(Gd(n[1]));f=f*X0*X0/2}return f}function Gd(e){return e*Math.PI/180}function Tc(e,t){return t===void 0&&(t={}),kL(e,function(n,i){var o=i.geometry.coordinates;return n+Ru(o[0],o[1],t)},0)}class Xo extends Xe.Polygon{constructor(n,i={}){super([],{...i,pmIgnore:!1,interactive:!0});jt(this,"_width");jt(this,"_height");jt(this,"_center");jt(this,"_rotation");jt(this,"_isMapReady",!1);jt(this,"properties");const o=Xe.latLngBounds(n);this._center=o.getCenter(),this._rotation=0;const a=o.getSouthWest(),u=o.getNorthEast();this._width=Ru([a.lng,a.lat],[u.lng,a.lat],{units:"meters"}),this._height=Ru([a.lng,a.lat],[a.lng,u.lat],{units:"meters"}),this.properties={type:"Rectangle",style:i||{},rotation:this._rotation},this.on("add",d=>{this._isMapReady=!0,this._updatePolygonCoordinates(),this.updateProperties()}),this.on("remove",()=>{this._isMapReady=!1})}_updatePolygonCoordinates(){if(!this._isMapReady||!this._map)return;const n=this._map.latLngToContainerPoint(this._center),i=this._getPixelsPerMeter(),o=this._width*i/2,a=this._height*i/2,u=[Xe.point(n.x-o,n.y+a),Xe.point(n.x+o,n.y+a),Xe.point(n.x+o,n.y-a),Xe.point(n.x-o,n.y-a)],d=-this._rotation*Math.PI/180,f=Math.cos(d),m=Math.sin(d),x=u.map(k=>{const b=k.x-n.x,T=k.y-n.y;return Xe.point(n.x+(b*f-T*m),n.y+(b*m+T*f))}).map(k=>this._map.containerPointToLatLng(k));this.setLatLngs(x)}_getPixelsPerMeter(){if(!this._isMapReady||!this._map)return 1;const n=this._map.latLngToContainerPoint(this._center),o=this._map.latLngToContainerPoint(Xe.latLng(this._center.lat,this._center.lng+1e-4)).x-n.x,a=Ru([this._center.lng,this._center.lat],[this._center.lng+1e-4,this._center.lat],{units:"meters"});return Math.abs(o/a)}getRotatedCorners(){return this.getLatLngs()[0]}getMidPoints(){const n=this.getRotatedCorners();return[this._getMidPoint(n[3],n[0]),this._getMidPoint(n[0],n[1]),this._getMidPoint(n[1],n[2]),this._getMidPoint(n[2],n[3])]}_getMidPoint(n,i){return Xe.latLng((n.lat+i.lat)/2,(n.lng+i.lng)/2)}getCenter(){return this._center}setCenter(n){this._center=n,this._updatePolygonCoordinates(),this.updateProperties()}getRotation(){return this._rotation}_calculateAngle(n,i){const o=n.lng-i.lng,a=n.lat-i.lat;let u=(Math.atan2(a,o)*180/Math.PI+90)%360;return u<0&&(u+=360),u}setRotation(n){this._rotation=(n%360+360)%360,this._updatePolygonCoordinates(),this.updateProperties()}getDimensions(){return{width:this._width,height:this._height}}setDimensions(n,i){this._width=n,this._height=i,this._updatePolygonCoordinates(),this.updateProperties()}resizeFromCorner(n,i){if(!this._isMapReady||!this._map)return;const o=this._map.latLngToContainerPoint(this._center),a=this._map.latLngToContainerPoint(i),u=a.x-o.x,d=a.y-o.y,f=-this._rotation*Math.PI/180,m=Math.cos(f),y=Math.sin(f),x=u*m-d*y,k=u*y+d*m,b=this._getPixelsPerMeter();this._width=Math.abs(x*2)/b,this._height=Math.abs(k*2)/b,this._updatePolygonCoordinates(),this.updateProperties()}resizeFromSide(n,i){if(!this._isMapReady||!this._map)return;const o=this._map.latLngToContainerPoint(this._center),a=this._map.latLngToContainerPoint(i),u=a.x-o.x,d=a.y-o.y,f=-this._rotation*Math.PI/180,m=Math.cos(f),y=Math.sin(f),x=u*m-d*y,k=u*y+d*m,b=this._getPixelsPerMeter();n%2===0?this._height=Math.abs(k*2)/b:this._width=Math.abs(x*2)/b,this._updatePolygonCoordinates(),this.updateProperties()}moveFromCenter(n){this._center=n,this._updatePolygonCoordinates(),this.updateProperties()}updateProperties(){var n;this.properties={...this.properties,width:this._width,height:this._height,area:this._width*this._height,perimeter:2*(this._width+this._height),center:this._center,corners:this.getRotatedCorners(),surfaceInterieure:this._width*this._height,surfaceExterieure:this._width*this._height,rotation:this._rotation,style:{...this.options,color:this.options.color||"#3388ff",weight:this.options.weight||3,opacity:this.options.opacity||1,fillColor:this.options.fillColor||"#3388ff",fillOpacity:this.options.fillOpacity||.2,dashArray:((n=this.options)==null?void 0:n.dashArray)||""}},this.fire("properties:updated",{shape:this,properties:this.properties})}}class Bo extends Xe.Rectangle{constructor(n,i="Double-cliquez pour éditer",o={}){var f,m,y,x,k,b,T,$;const a=n instanceof Xe.LatLngBounds?n:Xe.latLngBounds(n);if(!a.isValid()){console.warn("[TextRectangle] Limites invalides, utilisation de limites par défaut");const H=Xe.latLng(0,0);a.extend(Xe.latLng(H.lat+.001,H.lng+.001)),a.extend(Xe.latLng(H.lat-.001,H.lng-.001))}const u={...o.textStyle,color:o.textColor||((f=o.textStyle)==null?void 0:f.color)||"#000000",fontFamily:o.fontFamily||((m=o.textStyle)==null?void 0:m.fontFamily)||"Arial, sans-serif",textAlign:o.textAlign||((y=o.textStyle)==null?void 0:y.textAlign)||"center",backgroundColor:o.backgroundColor||((x=o.textStyle)==null?void 0:x.backgroundColor)||"#FFFFFF",backgroundOpacity:o.backgroundOpacity??((k=o.textStyle)==null?void 0:k.backgroundOpacity)??1,bold:o.bold||((b=o.textStyle)==null?void 0:b.bold)||!1,italic:o.italic||((T=o.textStyle)==null?void 0:T.italic)||!1,fontSize:(($=o.textStyle)==null?void 0:$.fontSize)||"14px"},d={pmIgnore:!1,interactive:!0,fill:!0,stroke:!0,className:"leaflet-text-rectangle",...o,textStyle:u};super(a,d);jt(this,"properties");jt(this,"_textNode",null);jt(this,"_isEditing",!1);jt(this,"_editableDiv",null);jt(this,"_text");jt(this,"_rotation",0);jt(this,"_textStyle",{color:"#000000",fontSize:"14px",fontFamily:"Arial, sans-serif",textAlign:"center",backgroundColor:"#FFFFFF",backgroundOpacity:1,bold:!1,italic:!1});jt(this,"_initialBounds",null);jt(this,"_isResizing",!1);jt(this,"_resizePreview",null);jt(this,"_minWidth",50);jt(this,"_minHeight",30);jt(this,"_maxWidth",2e3);jt(this,"_maxHeight",1e3);jt(this,"_onKeyDown",n=>{n.key==="Enter"&&n.ctrlKey?(n.preventDefault(),this._finishEditing()):n.key==="Escape"&&(n.preventDefault(),this._cancelEditing())});jt(this,"_finishEditing",()=>{if(this._editableDiv)try{const n=this._editableDiv.innerText.trim()||"Double-cliquez pour éditer";this._cleanupEditableDiv(),this.setText(n),this._textRedraw(),this.fire("edit:end"),this.map&&!this.map.dragging.enabled()&&this.map.dragging.enable()}catch(n){console.error("[TextRectangle] Erreur lors de la finalisation de l'édition :",n),this._cleanupEditableDiv()}});jt(this,"_cancelEditing",()=>{this._textRedraw(),this._cleanupEditableDiv(),this.map&&!this.map.dragging.enabled()&&this.map.dragging.enable()});jt(this,"_updateTextPosition",()=>{this.updateProperties(),this._textRedraw()});jt(this,"_onZoomEnd",()=>{this._textRedraw()});jt(this,"_onAdd",()=>{this._textRedraw(),this.map&&this.map.on("zoomend",this._onZoomEnd.bind(this))});jt(this,"_onRemove",()=>{this._removeTextNode(),this.map&&this.map.off("zoomend",this._onZoomEnd)});this._text=i,this._textStyle=u,this.properties={type:"TextRectangle",text:this._text,width:0,height:0,area:0,rotation:this._rotation,style:{...d,textStyle:this._textStyle}},this.on({add:this._onAdd,remove:this._onRemove,dblclick:this._onDoubleClick,dragend:this._updateTextPosition,"pm:edit":this._updateTextPosition,"pm:dragend":this._updateTextPosition,"pm:markerdragend":this._updateTextPosition,"pm:vertexadded":this._updateTextPosition,"pm:vertexremoved":this._updateTextPosition}),this.pm&&(this.pm.enableLayerDrag(),console.log("[TextRectangle] Geoman activé pour cette instance"))}get map(){return this._map}set map(n){this._map=n}setText(n,i){const o=this.properties.text;this._text=n,i&&(this._textStyle={...this._textStyle,...i}),this.properties.text=n||"Double-cliquez pour éditer",console.log("[TextRectangle] Mise à jour du texte",{oldText:o,newText:this.properties.text,hasTextNode:!!this._textNode}),this._textRedraw(),this.fire("text:updated",{text:this.properties.text,oldText:o,bounds:this.getBounds(),style:this.properties.style}),this.fire("properties:updated",{shape:this,properties:this.properties,source:"setText"})}setTextStyle(n){this._textStyle={...this._textStyle,...n},this.properties.style.textStyle=this._textStyle,this._textRedraw(),this.fire("properties:updated",{shape:this,properties:this.properties})}setRotation(n){this.properties.rotation=n%360,this._textRedraw(),this.fire("properties:updated",{shape:this,properties:this.properties})}getTextElement(){return this._textNode}updateProperties(){if(this.map)try{const n=this.getBounds(),i=n.getSouthWest(),o=Xe.latLng(n.getSouth(),n.getEast()),a=this.map.distance(i,o),u=this.map.distance(i,Xe.latLng(n.getNorth(),n.getWest()));this.properties.width=a,this.properties.height=u,this.properties.area=a*u,this.properties.center=n.getCenter(),this.fire("properties:updated",{shape:this,properties:this.properties,source:"updateProperties",dimensions:{width:a,height:u}}),console.log("[TextRectangle] Propriétés mises à jour",{width:a,height:u,area:a*u,center:n.getCenter()})}catch(n){console.error("[TextRectangle] Erreur lors de la mise à jour des propriétés :",n)}}setBounds(n){const i=n instanceof Xe.LatLngBounds?n:Xe.latLngBounds(n);return Xe.Rectangle.prototype.setBounds.call(this,i),this._textRedraw(),this.updateProperties(),this}startResize(){if(!this._isResizing&&(this._isResizing=!0,this._initialBounds=this.getBounds(),this.map&&!this._resizePreview))try{if(this._resizePreview=Xe.rectangle(this._initialBounds,{color:this.options.color||"#3388ff",weight:this.options.weight||2,opacity:.8,fillColor:this.options.fillColor||"#3388ff",fillOpacity:.2,dashArray:this.options.dashArray||"5,5",className:"resize-preview"}).addTo(this.map),this._rotation!==0){const n=this._resizePreview._path;n&&(n.style.transformOrigin="center",n.style.transform=`rotate(${this._rotation}deg)`)}this._textNode&&(this._textNode.style.opacity="0.5")}catch(n){console.error("[TextRectangle] Erreur lors de la création du rectangle fantôme:",n),this._cleanupResizePreview()}}updateResizePreview(n){if(!(!this._isResizing||!this._resizePreview||!this.map))try{const i=this.map.latLngToContainerPoint(n.getNorthWest()),o=this.map.latLngToContainerPoint(n.getSouthEast()),a=Math.abs(o.x-i.x),u=Math.abs(o.y-i.y);if(a<this._minWidth||u<this._minHeight||a>this._maxWidth||u>this._maxHeight)return;if(this._resizePreview.setBounds(n),this._rotation!==0){const d=this._resizePreview._path;d&&(d.style.transformOrigin="center",d.style.transform=`rotate(${this._rotation}deg)`)}if(this._textNode){const d=Math.min(a,u)*.1,f=Math.max(10,Math.min(48,d)),m=f*1.2,x=this.properties.text.split(`
`).length*m,k=i.y+(u-x)/2,b=this._calculateTextX(i.x,o.x,5);if(this._textNode.setAttribute("x",b.toString()),this._textNode.setAttribute("y",k.toString()),this._textNode.querySelectorAll("tspan").forEach((T,$)=>{T.setAttribute("x",b.toString()),T.setAttribute("dy",$===0?"0":`${m}px`),T.style.fontSize=`${f}px`}),this._rotation!==0){const T=this.map.latLngToLayerPoint(n.getCenter());this._textNode.setAttribute("transform",`rotate(${this._rotation}, ${T.x}, ${T.y})`)}}this.fire("resize:update",{bounds:n})}catch(i){console.error("[TextRectangle] Erreur lors de la mise à jour du rectangle fantôme:",i),this._cleanupResizePreview()}}endResize(n){if(this._isResizing)try{if(this._cleanupResizePreview(),this._textNode&&(this._textNode.style.opacity="1"),this.map){const i=this.map.latLngToContainerPoint(n.getNorthWest()),o=this.map.latLngToContainerPoint(n.getSouthEast()),a=Math.abs(o.x-i.x),u=Math.abs(o.y-i.y);if(a<this._minWidth||u<this._minHeight||a>this._maxWidth||u>this._maxHeight){this.cancelResize();return}}this.setBounds(n),this._textRedraw(),this.fire("resize:end",{bounds:n})}catch(i){console.error("[TextRectangle] Erreur lors de la fin du redimensionnement:",i),this.cancelResize()}finally{this._isResizing=!1}}cancelResize(){if(!(!this._isResizing||!this._initialBounds))try{this._cleanupResizePreview(),this._textNode&&(this._textNode.style.opacity="1"),this.setBounds(this._initialBounds)}catch(n){console.error("[TextRectangle] Erreur lors de l'annulation du redimensionnement:",n)}finally{this._isResizing=!1,this._initialBounds=null}}_cleanupResizePreview(){if(this._resizePreview&&this.map)try{this.map.removeLayer(this._resizePreview)}catch(n){console.error("[TextRectangle] Erreur lors du nettoyage du rectangle fantôme:",n)}finally{this._resizePreview=null}}_onDoubleClick(n){this._isEditing||this._isResizing||(Xe.DomEvent.stopPropagation(n),this.fire("edit:start"),this._isEditing=!0,this._removeTextNode(),this._createEditableDiv())}_createEditableDiv(){if(this.map)try{const n=this.getBounds(),i=this.map.latLngToContainerPoint(n.getNorthWest()),o=this.map.latLngToContainerPoint(n.getSouthEast()),a=o.x-i.x,u=o.y-i.y,d=document.createElement("div");d.className="leaflet-text-rectangle-editor",d.contentEditable="true",d.innerText=this.properties.text;const f=Math.min(a,u)*.1,m=Math.max(10,Math.min(48,f));if(Object.assign(d.style,{position:"absolute",left:`${i.x}px`,top:`${i.y}px`,width:`${a}px`,height:`${u}px`,backgroundColor:this.properties.style.fillColor||"#FFFFFF",opacity:`${this.properties.style.fillOpacity??1}`,color:this.properties.style.textColor||"#000000",fontSize:`${m}px`,fontFamily:this.properties.style.fontFamily||"Arial, sans-serif",fontWeight:this.properties.style.bold?"bold":"normal",fontStyle:this.properties.style.italic?"italic":"normal",textAlign:this.properties.style.textAlign||"center",border:`${this.properties.style.weight||2}px solid ${this.properties.style.color||"#3388ff"}`,borderRadius:"2px",padding:"4px",boxSizing:"border-box",zIndex:"1000",overflow:"auto",whiteSpace:"pre-wrap",wordBreak:"break-word",cursor:"text",userSelect:"text",outline:"none",display:"flex",alignItems:"center",justifyContent:this._getJustifyContent()}),this.properties.rotation!==0){const b=this.map.latLngToContainerPoint(n.getCenter());d.style.transformOrigin=`${b.x-i.x}px ${b.y-i.y}px`,d.style.transform=`rotate(${this.properties.rotation}deg)`}this.map.getContainer().appendChild(d),this._editableDiv=d,d.focus();const x=window.getSelection(),k=document.createRange();k.selectNodeContents(d),x==null||x.removeAllRanges(),x==null||x.addRange(k),d.addEventListener("keydown",this._onKeyDown.bind(this)),d.addEventListener("blur",this._finishEditing.bind(this)),d.addEventListener("paste",b=>{var $;b.preventDefault();const T=(($=b.clipboardData)==null?void 0:$.getData("text/plain"))||"";document.execCommand("insertText",!1,T)}),this.map.dragging.enabled()&&this.map.dragging.disable(),console.log("[TextRectangle] Div éditable créé",{position:{left:i.x,top:i.y},size:{width:a,height:u},fontSize:m,styles:this.properties.style})}catch(n){console.error("[TextRectangle] Erreur lors de la création de l'éditeur :",n),this._isEditing=!1}}_getJustifyContent(){switch(this.properties.style.textAlign||"center"){case"left":return"flex-start";case"right":return"flex-end";case"center":default:return"center"}}_cleanupEditableDiv(){this._editableDiv&&(this._editableDiv.removeEventListener("keydown",this._onKeyDown),this._editableDiv.removeEventListener("blur",this._finishEditing),this._editableDiv.parentNode&&this._editableDiv.parentNode.removeChild(this._editableDiv),this._editableDiv=null,this._isEditing=!1)}_textRedraw(){if(!Xe.Browser.svg||!this.map||this._isEditing||!this._path){console.log("[TextRectangle] _textRedraw ignoré",{reason:Xe.Browser.svg?this.map?this._isEditing?"En cours d'édition":"Chemin SVG non trouvé":"Carte non disponible":"SVG non supporté"});return}this._removeTextNode();const n=this.properties.text;if(n)try{const i=this._path;if(!i){console.warn("[TextRectangle] Chemin SVG non trouvé");return}const o=i.ownerSVGElement;if(!o){console.warn("[TextRectangle] Élément SVG parent non trouvé");return}const a=Xe.SVG.create("text");a.setAttribute("class","leaflet-text-rectangle-text"),Object.assign(a.style,{fill:this.properties.style.textColor||"#000000",fontFamily:this.properties.style.fontFamily||"Arial, sans-serif",fontWeight:this.properties.style.bold?"bold":"normal",fontStyle:this.properties.style.italic?"italic":"normal"});const u=this.getBounds(),d=this.map.latLngToLayerPoint(u.getNorthWest()),f=this.map.latLngToLayerPoint(u.getSouthEast()),m=f.x-d.x,y=f.y-d.y,x=Math.min(m,y)*.1,k=Math.max(10,Math.min(48,x)),b=n.split(`
`),T=k*1.2,$=b.length*T,H=d.y+(y-$)/2,I=this._getTextAnchor(),Q=this._calculateTextX(d.x,f.x,5);if(a.setAttribute("text-anchor",I),a.setAttribute("dominant-baseline","hanging"),b.forEach((se,we)=>{const Be=Xe.SVG.create("tspan");Be.textContent=se,Be.setAttribute("x",Q.toString()),Be.setAttribute("dy",we===0?"0":`${T}px`),Be.style.fontSize=`${k}px`,a.appendChild(Be)}),a.setAttribute("y",H.toString()),this.properties.rotation!==0){const se=this.map.latLngToLayerPoint(u.getCenter());a.setAttribute("transform",`rotate(${this.properties.rotation}, ${se.x}, ${se.y})`)}this._textNode=a,o.appendChild(a),this.fire("text:redrawn",{text:n,fontSize:k,position:{x:Q,y:H},dimensions:{width:m,height:y}}),console.log("[TextRectangle] Texte redessiné avec succès",{text:n,fontSize:k,position:{x:Q,y:H},dimensions:{width:m,height:y},lines:b.length,lineHeight:T,totalTextHeight:$})}catch(i){console.error("[TextRectangle] Erreur lors du rendu du texte :",i)}}_calculateTextX(n,i,o){const a=i-n;switch(this.properties.style.textAlign){case"left":return n+o;case"right":return i-o;case"center":default:return n+a/2}}_getTextAnchor(){switch(this.properties.style.textAlign){case"left":return"start";case"right":return"end";case"center":default:return"middle"}}_removeTextNode(){this._textNode&&this._textNode.parentNode&&(this._textNode.parentNode.removeChild(this._textNode),this._textNode=null)}getDimensions(){const n=this.getBounds();if(!this.map)return{width:0,height:0};const i=n.getSouthWest(),o=Xe.latLng(n.getSouth(),n.getEast()),a=this.map.distance(i,o),u=this.map.distance(i,Xe.latLng(n.getNorth(),n.getWest()));return{width:a,height:u}}getMidPoints(){const n=this.getBounds(),i=n.getNorthWest(),o=n.getNorthEast(),a=n.getSouthEast(),u=n.getSouthWest();return[Xe.latLng((i.lat+o.lat)/2,(i.lng+o.lng)/2),Xe.latLng((o.lat+a.lat)/2,(o.lng+a.lng)/2),Xe.latLng((u.lat+a.lat)/2,(u.lng+a.lng)/2),Xe.latLng((i.lat+u.lat)/2,(i.lng+u.lng)/2)]}}var ao=63710088e-1,F1={centimeters:ao*100,centimetres:ao*100,degrees:360/(2*Math.PI),feet:ao*3.28084,inches:ao*39.37,kilometers:ao/1e3,kilometres:ao/1e3,meters:ao,metres:ao,miles:ao/1609.344,millimeters:ao*1e3,millimetres:ao*1e3,nauticalmiles:ao/1852,radians:1,yards:ao*1.0936};function SL(e,t,n={}){const i={type:"Feature"};return(n.id===0||n.id)&&(i.id=n.id),n.bbox&&(i.bbox=n.bbox),i.properties=t||{},i.geometry=e,i}function Ef(e,t,n={}){if(!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!tg(e[0])||!tg(e[1]))throw new Error("coordinates must contain numbers");return SL({type:"Point",coordinates:e},t,n)}function AL(e,t="kilometers"){const n=F1[t];if(!n)throw new Error(t+" units is invalid");return e*n}function ML(e,t="kilometers"){const n=F1[t];if(!n)throw new Error(t+" units is invalid");return e/n}function Sf(e){return e%(2*Math.PI)*180/Math.PI}function ta(e){return e%360*Math.PI/180}function tg(e){return!isNaN(e)&&e!==null&&!Array.isArray(e)}function Nc(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if(e.type==="Feature"&&e.geometry!==null&&e.geometry.type==="Point")return[...e.geometry.coordinates];if(e.type==="Point")return[...e.coordinates]}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return[...e];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function BL(e){return e.type==="Feature"?e.geometry:e}function j1(e,t,n={}){if(n.final===!0)return TL(e,t);const i=Nc(e),o=Nc(t),a=ta(i[0]),u=ta(o[0]),d=ta(i[1]),f=ta(o[1]),m=Math.sin(u-a)*Math.cos(f),y=Math.cos(d)*Math.sin(f)-Math.sin(d)*Math.cos(f)*Math.cos(u-a);return Sf(Math.atan2(m,y))}function TL(e,t){let n=j1(t,e);return n=(n+180)%360,n}function NL(e,t,n,i={}){const o=Nc(e),a=ta(o[0]),u=ta(o[1]),d=ta(n),f=ML(t,i.units),m=Math.asin(Math.sin(u)*Math.cos(f)+Math.cos(u)*Math.sin(f)*Math.cos(d)),y=a+Math.atan2(Math.sin(d)*Math.sin(f)*Math.cos(u),Math.cos(f)-Math.sin(u)*Math.sin(m)),x=Sf(y),k=Sf(m);return Ef([x,k],i.properties)}function DL(e,t,n={}){var i=Nc(e),o=Nc(t),a=ta(o[1]-i[1]),u=ta(o[0]-i[0]),d=ta(i[1]),f=ta(o[1]),m=Math.pow(Math.sin(a/2),2)+Math.pow(Math.sin(u/2),2)*Math.cos(d)*Math.cos(f);return AL(2*Math.atan2(Math.sqrt(m),Math.sqrt(1-m)),n.units)}function RL(e,t,n={}){const o=BL(e).coordinates;let a=0;for(let u=0;u<o.length&&!(t>=a&&u===o.length-1);u++)if(a>=t){const d=t-a;if(d){const f=j1(o[u],o[u-1])-180;return NL(o[u],d,f,n)}else return Ef(o[u])}else a+=DL(o[u],o[u+1],n);return Ef(o[o.length-1])}var Af=RL;class Xi extends Xe.Polyline{constructor(n,i={}){super(n,{...i,pmIgnore:!1,interactive:!0});jt(this,"properties");jt(this,"cachedProperties",{});jt(this,"needsUpdate",!0);this.properties={type:"Line",style:i||{}},this.updateProperties(),this.on("add",()=>{this.updateProperties()})}updateProperties(){var o;const n=this.getLatLngs();if(!n||n.length<2){console.warn("Line has less than 2 points, cannot calculate properties");return}const i=n.map(a=>[a.lng,a.lat]);try{const a=lu(i),u=Tc(a,{units:"meters"});let d;if(n.length===2)d=Xe.latLng((n[0].lat+n[1].lat)/2,(n[0].lng+n[1].lng)/2);else{const m=Af(a,u/2,{units:"meters"});d=Xe.latLng(m.geometry.coordinates[1],m.geometry.coordinates[0])}const f=10;this.properties={...this.properties,length:u,center:d,vertices:n.length,surfaceInfluence:u*f,dimensions:{width:f},style:{...this.options,color:this.options.color||"#3388ff",weight:this.options.weight||3,opacity:this.options.opacity||1,dashArray:((o=this.options)==null?void 0:o.dashArray)||""}},this.cachedProperties.length=u,this.cachedProperties.center=d,this.cachedProperties.midPoints=void 0,this.cachedProperties.segmentLengths=void 0,this.needsUpdate=!1,this.fire("properties:updated",{shape:this,properties:this.properties})}catch(a){console.error("Failed to calculate line properties",a)}finally{}}invalidateCache(){this.needsUpdate=!0,this.cachedProperties={}}setLatLngs(n){return super.setLatLngs(n),this.invalidateCache(),this.updateProperties(),this}getMidPoints(){if(!this.needsUpdate&&this.cachedProperties.midPoints)return this.cachedProperties.midPoints;const n=this.getLatLngs(),i=[];if(n.length<2)return i;for(let o=0;o<n.length-1;o++){const a=n[o],u=n[o+1];if(!a||!u){console.warn("Points invalides détectés pour le segment",o);continue}i.push(Xe.latLng((a.lat+u.lat)/2,(a.lng+u.lng)/2))}return this.cachedProperties.midPoints=i,i}getMidPointAt(n){const i=this.getLatLngs();if(n<0||n>=i.length-1||i.length<2)return null;const o=i[n],a=i[n+1];return!o||!a?(console.warn("Points invalides pour calcul du midpoint au segment",n),null):Xe.latLng((o.lat+a.lat)/2,(o.lng+a.lng)/2)}moveVertex(n,i,o=!1){const a=this.getLatLngs();n>=0&&n<a.length&&(a[n]=i,Xe.Polyline.prototype.setLatLngs.call(this,a),this.needsUpdate=!0,this.cachedProperties.midPoints=void 0,this.cachedProperties.segmentLengths=void 0,this.cachedProperties.center=void 0,this.cachedProperties.length=void 0,o&&this.updateProperties())}addVertex(n,i,o=!1){const a=this.getLatLngs();n>=0&&n<a.length-1&&(a.splice(n+1,0,i),Xe.Polyline.prototype.setLatLngs.call(this,a),this.needsUpdate=!0,this.cachedProperties.midPoints=void 0,this.cachedProperties.segmentLengths=void 0,this.cachedProperties.center=void 0,this.cachedProperties.length=void 0,o&&this.updateProperties())}move(n,i=!0){const a=this.getLatLngs().map(u=>Xe.latLng(u.lat+n.lat,u.lng+n.lng));return Xe.Polyline.prototype.setLatLngs.call(this,a),this.fire("move"),this.needsUpdate=!0,this.cachedProperties.center=void 0,i&&this.updateProperties(),this}getCenter(){if(!this.needsUpdate&&this.cachedProperties.center)return this.cachedProperties.center;const n=this.getLatLngs();if(n.length<2)return n[0]||new Xe.LatLng(0,0);try{const i=n.map(f=>[f.lng,f.lat]),o=lu(i),a=Tc(o,{units:"meters"}),u=Af(o,a/2,{units:"meters"}),d=Xe.latLng(u.geometry.coordinates[1],u.geometry.coordinates[0]);return this.cachedProperties.center=d,d}catch(i){console.warn("Error calculating line center with turf.js, using simple method",i);const o=n.reduce((d,f)=>d+f.lat,0)/n.length,a=n.reduce((d,f)=>d+f.lng,0)/n.length,u=new Xe.LatLng(o,a);return this.cachedProperties.center=u,u}}getSegmentLengths(){if(!this.needsUpdate&&this.cachedProperties.segmentLengths)return this.cachedProperties.segmentLengths;const n=this.getLatLngs(),i=[];if(n.length<2)return i;for(let o=0;o<n.length-1;o++){const a=n[o],u=n[o+1];i.push(a.distanceTo(u))}return this.cachedProperties.segmentLengths=i,i}getSegmentLengthAt(n){const i=this.getLatLngs();if(n<0||n>=i.length-1||i.length<2)return 0;const o=i[n],a=i[n+1];return o.distanceTo(a)}getLengthToVertex(n){const i=this.getLatLngs();let o=0;if(n<=0||i.length<2)return 0;for(let a=0;a<Math.min(n,i.length-1);a++)o+=i[a].distanceTo(i[a+1]);return o}getLength(){if(!this.needsUpdate&&this.cachedProperties.length)return this.cachedProperties.length;const n=this.getLatLngs();let i=0;for(let o=0;o<n.length-1;o++)i+=n[o].distanceTo(n[o+1]);return this.cachedProperties.length=i,i}}function OL(e,t,n={}){const i={type:"Feature"};return(n.id===0||n.id)&&(i.id=n.id),n.bbox&&(i.bbox=n.bbox),i.properties=t||{},i.geometry=e,i}function IL(e,t,n={}){if(!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!ng(e[0])||!ng(e[1]))throw new Error("coordinates must contain numbers");return OL({type:"Point",coordinates:e},t,n)}function ng(e){return!isNaN(e)&&e!==null&&!Array.isArray(e)}function z1(e,t,n){if(e!==null)for(var i,o,a,u,d,f,m,y=0,x=0,k,b=e.type,T=b==="FeatureCollection",$=b==="Feature",H=T?e.features.length:1,I=0;I<H;I++){m=T?e.features[I].geometry:$?e.geometry:e,k=m?m.type==="GeometryCollection":!1,d=k?m.geometries.length:1;for(var Q=0;Q<d;Q++){var se=0,we=0;if(u=k?m.geometries[Q]:m,u!==null){f=u.coordinates;var Be=u.type;switch(y=Be==="Polygon"||Be==="MultiPolygon"?1:0,Be){case null:break;case"Point":if(t(f,x,I,se,we)===!1)return!1;x++,se++;break;case"LineString":case"MultiPoint":for(i=0;i<f.length;i++){if(t(f[i],x,I,se,we)===!1)return!1;x++,Be==="MultiPoint"&&se++}Be==="LineString"&&se++;break;case"Polygon":case"MultiLineString":for(i=0;i<f.length;i++){for(o=0;o<f[i].length-y;o++){if(t(f[i][o],x,I,se,we)===!1)return!1;x++}Be==="MultiLineString"&&se++,Be==="Polygon"&&we++}Be==="Polygon"&&se++;break;case"MultiPolygon":for(i=0;i<f.length;i++){for(we=0,o=0;o<f[i].length;o++){for(a=0;a<f[i][o].length-y;a++){if(t(f[i][o][a],x,I,se,we)===!1)return!1;x++}we++}se++}break;case"GeometryCollection":for(i=0;i<u.geometries.length;i++)if(z1(u.geometries[i],t)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function FL(e,t={}){let n=0,i=0,o=0;return z1(e,function(a){n+=a[0],i+=a[1],o++}),IL([n/o,i/o],t.properties)}var bc=FL;class Mu extends Xe.Polygon{constructor(n,i={}){super(n,{...i,pmIgnore:!1,interactive:!0});jt(this,"properties");this.properties={type:"Polygon",style:{color:i.color||"#3388ff",weight:i.weight||3,opacity:i.opacity||1,fillColor:i.fillColor||"#3388ff",fillOpacity:i.fillOpacity||.2,dashArray:i.dashArray||""}},this.updateProperties(),this.on({add:()=>this.updateProperties(),edit:()=>this.updateProperties(),drag:()=>this.updateProperties()})}updateProperties(){var n;try{const i=this.getLatLngs()[0];if(!i||i.length<3){console.warn("Polygon has less than 3 points, cannot calculate properties");return}const o=i.map(y=>[y.lng,y.lat]);o.push(o[0]);const a=El([o]),u=Eu(a),d=Tc(lu([...o]),{units:"meters"}),f=bc(a),m=Xe.latLng(f.geometry.coordinates[1],f.geometry.coordinates[0]);this.properties={...this.properties,area:u,perimeter:d,center:m,vertices:i.length,surfaceInterieure:u,surfaceExterieure:u,style:{...this.options,color:this.options.color||"#3388ff",weight:this.options.weight||3,opacity:this.options.opacity||1,fillColor:this.options.fillColor||"#3388ff",fillOpacity:this.options.fillOpacity||.2,dashArray:((n=this.options)==null?void 0:n.dashArray)||""}},this.fire("properties:updated",{shape:this,properties:this.properties})}catch(i){console.error("Failed to calculate polygon properties",i)}}setLatLngs(n){return super.setLatLngs(n),this.updateProperties(),this}getMidPoints(){const n=this.getLatLngs()[0],i=[];if(n.length<2)return i;for(let o=0;o<n.length;o++){const a=n[o],u=n[(o+1)%n.length];i.push(Xe.latLng((a.lat+u.lat)/2,(a.lng+u.lng)/2))}return i}moveVertex(n,i){const o=this.getLatLngs()[0];n>=0&&n<o.length&&(o[n]=i,Xe.Polygon.prototype.setLatLngs.call(this,[o]))}addVertex(n,i){const o=this.getLatLngs()[0];n>=0&&n<o.length&&(o.splice((n+1)%o.length,0,i),Xe.Polygon.prototype.setLatLngs.call(this,[o]))}move(n){const o=this.getLatLngs()[0].map(a=>Xe.latLng(a.lat+n.lat,a.lng+n.lng));return Xe.Polygon.prototype.setLatLngs.call(this,[o]),this}getCenter(){const n=this.getLatLngs()[0];if(!n||n.length===0)return new Xe.LatLng(0,0);try{const i=n.filter(m=>m&&typeof m.lat=="number"&&typeof m.lng=="number"&&!isNaN(m.lat)&&!isNaN(m.lng)&&Math.abs(m.lat)<=90&&Math.abs(m.lng)<=180);if(i.length===0)return console.warn("Aucun point valide dans le polygone pour calculer le centre"),new Xe.LatLng(0,0);const o=i.map(m=>[m.lng,m.lat]);o.push(o[0]);const a=El([o]),u=bc(a),d=u.geometry.coordinates[1],f=u.geometry.coordinates[0];if(typeof d!="number"||typeof f!="number"||isNaN(d)||isNaN(f)||Math.abs(d)>90||Math.abs(f)>180)throw new Error("Centroid calculé invalide");return Xe.latLng(d,f)}catch(i){console.warn("Erreur lors du calcul du centroïde avec turf.js, utilisation de la méthode simple",i);let o=0,a=0,u=0;for(const d of n)d&&typeof d.lat=="number"&&typeof d.lng=="number"&&!isNaN(d.lat)&&!isNaN(d.lng)&&Math.abs(d.lat)<=90&&Math.abs(d.lng)<=180&&(o+=d.lat,a+=d.lng,u++);return u===0?(console.error("Impossible de calculer un centre valide pour le polygone"),new Xe.LatLng(0,0)):new Xe.LatLng(o/u,a/u)}}getSegmentLengths(){const n=this.getLatLngs()[0],i=[];if(n.length<2)return i;for(let o=0;o<n.length;o++){const a=n[o],u=n[(o+1)%n.length];i.push(a.distanceTo(u))}return i}}const Ls=class Ls extends Xi{constructor(n,i={}){super(n,{...i,color:"#FF4500",weight:4,opacity:.8,interactive:!1,pmIgnore:!0});jt(this,"elevationData",[]);jt(this,"elevationProfile",null);jt(this,"elevationMarker",null);jt(this,"samplePoints",[]);jt(this,"sampleTooltips",[]);jt(this,"samplePointStyle",{radius:4,color:"#FF4500",fillColor:"#FF4500",fillOpacity:.6,weight:2,opacity:.8});jt(this,"minMaxPointStyle",{radius:6,weight:3,opacity:1,fillOpacity:1});this.properties={...this.properties,type:"ElevationLine",elevationProfile:null,maxElevation:0,minElevation:0,elevationGain:0,elevationLoss:0,dataSource:"pending",samplePointStyle:this.samplePointStyle,minMaxPointStyle:this.minMaxPointStyle},this.setupEventListeners()}setupEventListeners(){this.on("move",()=>this.updateElevationProfile())}calculateOptimalSampleCount(){const n=this.getLength(),i=Math.ceil(n/Ls.SAMPLE_DISTANCE);return Math.min(Math.max(i,Ls.MIN_SAMPLES),Ls.MAX_SAMPLES)}async fetchElevationData(n=0){if(this.getLatLngs().length===0)return;const o=this.getLength();let a="";const u=this.calculateOptimalSampleCount();console.log(`[ElevationLine] Using ${u} sample points for ${o.toFixed(0)}m line`);const d=[];for(let f=0;f<u;f++){const m=f/(u-1)*o,y=this.getPointAtDistance(m);y&&d.push(`${y.lat},${y.lng}`)}a=d.join("|");try{const f=await fetch(`${Ls.API_URL}?locations=${a}`);if(!f.ok)throw new Error(`HTTP error ${f.status}`);const m=await f.json();if(!m.results||!Array.isArray(m.results))throw new Error("Invalid API response format");this.elevationData=m.results.map((y,x)=>({distance:x/(u-1)*o,elevation:y.elevation})),this.properties.dataSource="api"}catch(f){if(console.warn(`[ElevationLine] API fetch attempt ${n+1}/${Ls.MAX_RETRIES} failed:`,f),n<Ls.MAX_RETRIES)return await new Promise(m=>setTimeout(m,Ls.RETRY_DELAY)),this.fetchElevationData(n+1);console.warn("[ElevationLine] All API attempts failed, falling back to simulation"),this.simulateElevationData(),this.properties.dataSource="simulation"}this.calculateElevationStatistics()}simulateElevationData(){const n=this.getLength(),i=this.calculateOptimalSampleCount();this.elevationData=Array.from({length:i},(o,a)=>{const u=a/(i-1)*n,d=100+Math.sin(u/n*Math.PI*2)*50;return{distance:u,elevation:d}})}calculateElevationStatistics(){if(!this.elevationData.length)return;const n=this.elevationData.map(y=>y.elevation),i=n.length?Math.max(...n):0,o=n.length?Math.min(...n):0;let a=0,u=0,d=0,f=0,m=0;console.log("[ElevationLine][calculateElevationStatistics] Données brutes:",{elevationsCount:n.length,maxElevation:i,minElevation:o});for(let y=1;y<this.elevationData.length;y++){const x=this.elevationData[y-1],k=this.elevationData[y],b=k.elevation-x.elevation;b>0?a+=b:u+=Math.abs(b);const T=k.distance-x.distance;if(T>0){const $=b/T*100;d=Math.max(d,Math.abs($)),f+=Math.abs($),m++}}console.log("[ElevationLine][calculateElevationStatistics] Calculs intermédiaires:",{gain:a,loss:u,maxSlope:d,averageSlope:m>0?f/m:0}),this.properties={...this.properties,type:"ElevationLine",maxElevation:i,minElevation:o,elevationGain:a,elevationLoss:u,maxSlope:d,averageSlope:m>0?f/m:0,elevationData:this.elevationData,dataSource:this.properties.dataSource,length:this.getLength()},console.log("[ElevationLine][calculateElevationStatistics] Propriétés mises à jour:",this.properties)}showSamplePoints(){if(this.clearSamplePoints(),!this.elevationData.length)return;const n=this.elevationData.map(a=>a.elevation),i=Math.max(...n),o=Math.min(...n);this.elevationData.forEach(a=>{const u=this.getPointAtDistance(a.distance);if(!u)return;const d=a.elevation===o,f=a.elevation===i;let m={...this.samplePointStyle};d?m={...m,...this.minMaxPointStyle,color:"#DC2626",fillColor:"#DC2626"}:f&&(m={...m,...this.minMaxPointStyle,color:"#059669",fillColor:"#059669"});const y=Xe.circleMarker(u,m),x=Xe.tooltip({permanent:!1,direction:"top",className:"elevation-tooltip",offset:[0,-10]});let k=`
        Distance: ${this.formatDistance(a.distance)}<br>
        Altitude: ${this.formatElevation(a.elevation)}
      `;d&&(k+="<br><strong>Point le plus bas</strong>"),f&&(k+="<br><strong>Point le plus haut</strong>"),x.setContent(k),y.on("mouseover",()=>{y.setStyle({...m,radius:m.radius+2,fillOpacity:1}),y.bindTooltip(x).openTooltip()}),y.on("mouseout",()=>{y.setStyle(m),y.closeTooltip()}),this._map&&(y.addTo(this._map),this.samplePoints.push(y),this.sampleTooltips.push(x))})}clearSamplePoints(){this.samplePoints.forEach(n=>n.remove()),this.samplePoints=[],this.sampleTooltips.forEach(n=>n.remove()),this.sampleTooltips=[]}formatDistance(n){return n>=1e3?`${(n/1e3).toFixed(2)} km`:`${n.toFixed(0)} m`}formatElevation(n){return`${n.toFixed(0)} m`}onAdd(n){return super.onAdd(n),this.showSamplePoints(),this}onRemove(n){return this.clearSamplePoints(),this.hideElevationMarker(),this.elevationProfile&&(this.elevationProfile.remove(),this.elevationProfile=null),super.onRemove(n)}async updateElevationProfile(){await this.fetchElevationData(),this.updateProperties(),this._map&&this.showSamplePoints(),this.fire("elevation:updated",{shape:this,elevationData:this.elevationData,properties:this.properties})}updateProperties(){if(super.updateProperties(),this.elevationData&&this.elevationData.length>0){const n=this.elevationData.map(d=>d.elevation),i=Math.max(...n),o=Math.min(...n);let a=0,u=0;for(let d=1;d<this.elevationData.length;d++){const f=this.elevationData[d].elevation-this.elevationData[d-1].elevation;f>0?a+=f:u+=Math.abs(f)}this.properties={...this.properties,type:"ElevationLine",elevationData:this.elevationData,maxElevation:i,minElevation:o,elevationGain:a,elevationLoss:u}}}getElevationData(){return this.elevationData}showElevationAt(n){if(!this.elevationData.length)return;const i=this.elevationData.reduce((a,u)=>Math.abs(u.distance-n)<Math.abs(a.distance-n)?u:a),o=this.getPointAtDistance(n);!this.elevationMarker&&o?(this.elevationMarker=Xe.circleMarker(o,{radius:6,color:"#FF4500",fillColor:"#FF4500",fillOpacity:1,weight:2,className:"elevation-marker"}),this.elevationMarker.bindTooltip(`Distance: ${this.formatDistance(i.distance)}<br>Altitude: ${this.formatElevation(i.elevation)}`,{permanent:!0,direction:"top",offset:[0,-10],className:"elevation-marker-tooltip"}),this.elevationMarker.addTo(this._map)):this.elevationMarker&&o&&(this.elevationMarker.setLatLng(o),this.elevationMarker.setTooltipContent(`Distance: ${this.formatDistance(i.distance)}<br>Altitude: ${this.formatElevation(i.elevation)}`)),this.fire("elevation:show",{distance:n,elevation:i.elevation,latLng:o})}hideElevationMarker(){this.elevationMarker&&(this.elevationMarker.remove(),this.elevationMarker=null)}getPointAtDistance(n){try{const o=this.getLatLngs().map(d=>[d.lng,d.lat]),a=lu(o),u=Af(a,n,{units:"meters"});return Xe.latLng(u.geometry.coordinates[1],u.geometry.coordinates[0])}catch(i){return console.error("Error calculating point at distance",i),null}}moveVertex(n,i,o=!1){super.moveVertex(n,i,!1),this.properties.type="ElevationLine",o&&this.updateElevationProfile()}addVertex(n,i,o=!1){console.warn("[ElevationLine] Tentative d'ajout de vertex ignorée - non autorisé pour un profil altimétrique")}setLatLngs(n){return super.setLatLngs(n),this.properties.type="ElevationLine",this.updateElevationProfile(),this}move(n,i=!0){return super.move(n,!1),this.properties.type="ElevationLine",i&&this.updateElevationProfile(),this}setSamplePointStyle(n){this.samplePointStyle={...this.samplePointStyle,...n},this.properties.samplePointStyle=this.samplePointStyle,this._map&&this.showSamplePoints()}setMinMaxPointStyle(n){this.minMaxPointStyle={...this.minMaxPointStyle,...n},this.properties.minMaxPointStyle=this.minMaxPointStyle,this._map&&this.showSamplePoints()}};jt(Ls,"API_URL","https://api.open-elevation.com/api/v1/lookup"),jt(Ls,"RETRY_DELAY",2e3),jt(Ls,"MAX_RETRIES",3),jt(Ls,"SAMPLE_DISTANCE",100),jt(Ls,"MIN_SAMPLES",10),jt(Ls,"MAX_SAMPLES",50);let eu=Ls;const zh=(e,t)=>{if(!e||typeof e!="string"||!e.startsWith("#"))return`rgba(0, 0, 0, ${t})`;const n=parseInt(e.slice(1,3),16),i=parseInt(e.slice(3,5),16),o=parseInt(e.slice(5,7),16);return`rgba(${n}, ${i}, ${o}, ${t})`},ig=(e,t)=>{e.style.fontSize=t.fontSize,e.style.color=t.color,e.style.backgroundColor=zh(t.backgroundColor,t.backgroundOpacity),t.hasBorder?e.style.border=`${t.borderWidth} solid ${zh(t.borderColor,t.borderOpacity)}`:e.style.border="none",e.style.padding=t.padding,e.style.borderRadius=t.borderRadius},ws=e=>{document.querySelectorAll(".drawing-help-message").forEach(i=>i.remove());const n=Xe.DomUtil.create("div","drawing-help-message");return n.innerHTML=e,n.style.cssText=`
    position: fixed;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    background-color: rgba(0, 0, 0, 0.8);
    color: white;
    padding: 8px 16px;
    border-radius: 4px;
    font-size: 14px;
    z-index: 2000;
    pointer-events: none;
    text-align: center;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
  `,document.body.appendChild(n),n};function rg(e,t,n){const i=156543.03392*Math.cos(t*Math.PI/180)/Math.pow(2,n);return e/i}const En=(e,t="m",n="")=>{let i,o;return t==="m²"?e>=1e4?(i=(e/1e4).toFixed(2),o="ha"):(i=e.toFixed(2),o="m²"):t==="m"?e>=1e3?(i=(e/1e3).toFixed(2),o="km"):(i=e.toFixed(2),o="m"):(i=e.toFixed(2),o=t),n?`${n}: ${i} ${o}`:`${i} ${o}`},jL=e=>({...e,clientX:e.clientX,clientY:e.clientY,button:e.button||0,buttons:e.buttons||0,altKey:e.altKey||!1}),zL=(e,t)=>{let n;return function(...i){window.clearTimeout(n),n=window.setTimeout(()=>e.apply(this,i),t)}},wu=(e,t)=>{let n=0;return function(...i){const o=Date.now();if(!(o-n<t))return n=o,e.apply(this,i)}};function UL(){const e=Nt(null),t=Nt(null),n=Nt(null),i=Nt(null),o=Nt(""),a=Nt(null),u=Nt(!1);window.addEventListener("clearControlPoints",()=>{a.value=null,n.value&&n.value.clearLayers(),i.value&&i.value.clearLayers(),document.querySelectorAll(".measure-tooltip").forEach(C=>C.remove()),document.querySelectorAll(".drawing-help-message").forEach(C=>C.remove())}),Fc(()=>{window.removeEventListener("clearControlPoints",()=>{}),e.value&&(e.value.remove(),e.value=null)});const d=(C,N="Double-cliquez pour éditer")=>{const K={fontSize:"14px",color:"#000000",backgroundColor:"#FFFFFF",backgroundOpacity:1,borderColor:"#000000",borderWidth:"1px",borderOpacity:1,padding:"5px 10px",borderRadius:"3px",hasBorder:!0,rotation:0,physicalSize:2},J=(q,de)=>{var F;const ce=((F=e.value)==null?void 0:F.getZoom())||14,V=C.lat,Z=rg(de.physicalSize,V,ce);return`<div class="text-container" style="width:${Z}px;height:${Z}px;transform:rotate(${de.rotation}deg)">
        <div class="text-annotation" style="font-size:${Z*.2}px;color:${de.color};background-color:${zh(de.backgroundColor,de.backgroundOpacity)};border:${de.hasBorder?de.borderWidth+" solid "+zh(de.borderColor,de.borderOpacity):"none"};padding:${de.padding};border-radius:${de.borderRadius}">${q}</div>
        <div class="text-controls"><div class="control-button rotate"></div><div class="control-button move"></div></div>
      </div>`},Ee=()=>{if(!e.value)return;const q=ye.getIcon(),de={html:J(ye.properties.text,ye.properties.style),className:q.options.className};ye.setIcon(Xe.divIcon(de))},ue=Xe.divIcon({html:J(N,K),className:"text-container",iconSize:[40,40],iconAnchor:[20,20]}),ye=Xe.marker(C,{icon:ue,draggable:!1,pmIgnore:!0});ye.properties={type:"text",text:N,style:{...K}},e.value&&(e.value.on("zoomend",Ee),ye.on("remove",()=>{var q;(q=e.value)==null||q.off("zoomend",Ee)})),Ee();let O=!1,ie=!1,le=0,fe=0;const _e=q=>{if(!e.value)return;const de=q.target;if(de.classList.contains("rotate")){O=!0;const ce=ye.getLatLng(),V=e.value.mouseEventToLatLng(q);le=Math.atan2(V.lat-ce.lat,V.lng-ce.lng)*180/Math.PI,fe=ye.properties.style.rotation||0}else de.classList.contains("move")&&(ie=!0);document.addEventListener("mousemove",ee),document.addEventListener("mouseup",G)},ee=q=>{if(!(!ie||!e.value)){if(O){const de=ye.getLatLng(),ce=e.value.mouseEventToLatLng(q),V=Math.atan2(ce.lat-de.lat,ce.lng-de.lng)*180/Math.PI,Z=(fe+(V-le))%360;ye.properties.style.rotation=Z;const F=ye.getIcon(),D={html:J(ye.properties.text,ye.properties.style),className:F.options.className};ye.setIcon(Xe.divIcon(D))}else if(ie){const de=jL(q),ce=e.value.mouseEventToLatLng(de);ye.setLatLng(ce)}}},G=()=>{O=!1,ie=!1,document.removeEventListener("mousemove",ee),document.removeEventListener("mouseup",G)};return ye.on("add",()=>{const q=ye.getElement();q&&q.querySelectorAll(".control-button").forEach(ce=>{ce.addEventListener("mousedown",_e)})}),ye.on("remove",()=>{const q=ye.getElement();q&&q.querySelectorAll(".control-button").forEach(ce=>{ce.removeEventListener("mousedown",_e)})}),ye.on("dblclick",q=>{var D;Xe.DomEvent.stopPropagation(q);const de=(D=ye.getElement())==null?void 0:D.querySelector(".text-annotation");if(!de)return;de.contentEditable="true",de.focus(),de.classList.add("editing");const ce=window.getSelection(),V=document.createRange();V.selectNodeContents(de),ce==null||ce.removeAllRanges(),ce==null||ce.addRange(V);const Z=()=>{de.contentEditable="false",de.classList.remove("editing");const j=de.innerText.trim();if(j){ye.properties.text=j;const Fe=ye.getIcon(),qe={html:J(j,ye.properties.style),className:Fe.options.className};ye.setIcon(Xe.divIcon(qe))}de.removeEventListener("blur",Z),de.removeEventListener("keydown",F)},F=j=>{j.key==="Enter"&&!j.shiftKey&&(j.preventDefault(),Z())};de.addEventListener("blur",Z),de.addEventListener("keydown",F)}),ye},f=(C,N)=>{const K=Xe.DomUtil.create("div","measure-tooltip");if(K.innerHTML=N,K.style.cssText=`
      position: fixed;
      background-color: rgba(0, 0, 0, 0.8);
      color: white;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 12px;
      z-index: 2000;
      pointer-events: none;
      white-space: pre-line;
    `,document.body.appendChild(K),e.value){const J=e.value.latLngToContainerPoint(C);K.style.left=`${J.x+10}px`,K.style.top=`${J.y-25}px`}return K},m=wu((C,N,K)=>{if(C&&(C.innerHTML=K,e.value)){const J=e.value.latLngToContainerPoint(N);C.style.left=`${J.x+10}px`,C.style.top=`${J.y-25}px`}},100),y=(C,N,K)=>{C.on("mouseover",()=>{const J=f(C.getLatLng(),K());C.measureDiv=J}),C.on("mousemove",J=>{C.measureDiv&&e.value&&m(C.measureDiv,J.latlng,K())}),C.on("mouseout",()=>{C.measureDiv&&(C.measureDiv.remove(),C.measureDiv=void 0)})};let x=[];const k=()=>{x.forEach(C=>{C&&C.remove&&("measureDiv"in C&&C.measureDiv&&(C.measureDiv.remove(),C.measureDiv=void 0),n.value&&n.value.removeLayer(C),C.remove())}),x=[],document.querySelectorAll(".measure-tooltip").forEach(C=>{C.remove()})},b=(C,N="#2563EB")=>{const K=Xe.circleMarker(C,{radius:6,color:N,fillColor:N,fillOpacity:1,weight:2,className:"control-point",pmIgnore:!0});return n.value&&n.value.addLayer(K),K},T=(C,N)=>{var J,Ee,ue,ye,O,ie;console.log("Input layer:",{type:N,instanceof:{Circle:C instanceof Xe.Circle,Rectangle:C instanceof Xe.Rectangle,Polygon:C instanceof Xe.Polygon,Polyline:C instanceof Xe.Polyline,CircleArc:C instanceof nl,TextRectangle:C instanceof Bo,ElevationLine:C instanceof eu,Line:C instanceof Xi},options:C.options});const K={type:N,style:C.options||{}};try{if(C instanceof Bo)return C.properties;if(C instanceof Xe.Circle){const le=C.getRadius(),fe=C.getLatLng();K.radius=le,K.diameter=le*2,K.area=Math.PI*Math.pow(le,2),K.perimeter=2*Math.PI*le,K.center=fe,K.surfaceInterieure=K.area,K.surfaceExterieure=K.area}else if(C instanceof nl){const le=C.getRadius(),fe=C.getCenter(),_e=C.getStartAngle(),ee=C.getStopAngle(),G=C.getOpeningAngle();K.radius=le,K.diameter=le*2,K.area=Math.PI*Math.pow(le,2)*G/360,K.arcLength=2*Math.PI*le*G/360,K.perimeter=K.arcLength+2*le,K.center=fe,K.startAngle=_e,K.stopAngle=ee,K.openingAngle=G,K.surfaceInterieure=K.area,K.surfaceExterieure=K.area}else if(C instanceof Xe.Rectangle){const le=C.getBounds(),fe=le.getNorthEast(),_e=le.getSouthWest(),ee=Ru([_e.lng,_e.lat],[fe.lng,_e.lat],{units:"meters"}),G=Ru([_e.lng,_e.lat],[_e.lng,fe.lat],{units:"meters"});K.width=ee,K.height=G,K.area=ee*G,K.perimeter=2*(ee+G),K.surfaceInterieure=K.area,K.surfaceExterieure=K.area,K.dimensions={width:ee,height:G}}else if(C instanceof Xe.Polygon){const fe=C.getLatLngs()[0].map(ee=>[ee.lng,ee.lat]);fe.push(fe[0]);const _e=El([fe]);K.area=Eu(_e),K.perimeter=Tc(lu([...fe]),{units:"meters"}),K.surfaceInterieure=K.area,K.surfaceExterieure=K.area}else if(C instanceof Xe.Polyline&&!(C instanceof Xe.Polygon))if(C instanceof eu)C.updateProperties(),Object.assign(K,{...C.properties,type:"ElevationLine"}),console.log("[calculateShapeProperties] ElevationLine properties:",K);else if(C instanceof Xi)C.updateProperties(),Object.assign(K,{...C.properties,type:"Line"});else{const fe=C.getLatLngs().map(G=>[G.lng,G.lat]),_e=lu(fe);K.length=Tc(_e,{units:"meters"});const ee=10;K.surfaceInfluence=K.length*ee,K.dimensions={width:ee},K.type="Line"}K.style={...K.style,color:((J=C.options)==null?void 0:J.color)||"#3388ff",weight:((Ee=C.options)==null?void 0:Ee.weight)||3,opacity:((ue=C.options)==null?void 0:ue.opacity)||1,fillColor:((ye=C.options)==null?void 0:ye.fillColor)||"#3388ff",fillOpacity:((O=C.options)==null?void 0:O.fillOpacity)||.2,dashArray:((ie=C.options)==null?void 0:ie.dashArray)||""}}catch(le){console.error("Error calculating shape properties:",le)}return K},$=(C,N=2)=>{var ye;if(!e.value){console.warn("Map is not available for text size update");return}const K=e.value.getZoom(),J=C.getLatLng().lat,Ee=rg(N,J,K),ue=(ye=C.getElement())==null?void 0:ye.querySelector(".text-annotation");ue&&(C.properties.style.fontSize=`${Ee}px`,C.properties.physicalWidth=N,C.properties.physicalHeight=N,ig(ue,C.properties.style))},H=(C,N,K)=>{const J=Xe.map(C).setView(N,K);e.value=J,Xe.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"© OpenStreetMap contributors"}).addTo(J);const Ee=new Xe.FeatureGroup;return Ee.addTo(J),t.value=Ee,n.value=Xe.featureGroup().addTo(J),i.value=Xe.featureGroup().addTo(J),J.pm.setGlobalOptions({snappable:!0,snapDistance:20,allowSelfIntersection:!1,preventMarkerRemoval:!0,syncLayersOnDrag:!0,layerGroup:Ee,snapLayers:[Ee,i.value],templineStyle:{color:"#3388ff",weight:2,opacity:.7,dashArray:"6,6",radius:6},hintlineStyle:{color:"#3388ff",weight:2,opacity:.7,dashArray:"6,6",radius:6}}),J.on("pm:drawstart",ue=>{u.value=!0,ue.shape==="Circle"&&o.value==="Semicircle"&&(J.getContainer().style.cursor="crosshair")}),J.on("pm:drawend",()=>{u.value=!1,J.getContainer().style.cursor="",a.value&&ws("Cliquez sur la forme pour afficher les points de contrôle")}),J.on("pm:create",async ue=>{var ie,le,fe,_e,ee,G,q,de,ce,V,Z;const ye=ue.layer;(ie=t.value)==null||ie.addLayer(ye);let O="unknown";if(ye instanceof Xe.Circle?O=o.value==="Semicircle"?"Semicircle":"Circle":ye instanceof Xe.Rectangle?O="Rectangle":ye instanceof Xe.Polygon?O="Polygon":ye instanceof Xe.Polyline&&!(ye instanceof Xe.Polygon)&&(O="Line"),ye.properties=T(ye,O),a.value=ye,window.dispatchEvent(new CustomEvent("shape:created",{detail:{shape:ye,type:O,properties:ye.properties}})),ye.on("mouseover",()=>{console.log("[mouseover] Survol de la forme",{type:O,isSelected:a.value===ye}),(!a.value||a.value!==ye)&&oe(ye)}),ye.on("mouseout",()=>{var F;console.log("[mouseout] Sortie de la forme",{type:O,isSelected:a.value===ye}),(!a.value||a.value!==ye)&&((F=i.value)==null||F.clearLayers())}),O==="Semicircle"){const F=ye.getLatLng(),D=ye.getRadius();(le=t.value)==null||le.removeLayer(ye);const j=new nl(F,D);j.properties=T(j,"Semicircle"),(fe=t.value)==null||fe.addLayer(j),a.value=j,re(j)}else if(O==="Circle"){(_e=t.value)==null||_e.removeLayer(ye);const F=new rc(ye.getLatLng(),{...ye.options,radius:ye.getRadius()});F.updateProperties(),(ee=t.value)==null||ee.addLayer(F),a.value=F,Pe(F)}else if(O==="Rectangle"){(G=t.value)==null||G.removeLayer(ye);const F=new Xo(ye.getBounds(),{...ye.options});F.updateProperties(),(q=t.value)==null||q.addLayer(F),a.value=F,Te(F)}else if(ye instanceof Xe.Polygon){const F=ye.getLatLngs()[0],D=new Mu([F],{...ye.options});D.updateProperties(),(de=t.value)==null||de.removeLayer(ye),(ce=t.value)==null||ce.addLayer(D),a.value=D,ae(D)}else if(ye instanceof Xi)He(ye);else if(ye instanceof Xe.Polyline&&!(ye instanceof Xe.Polygon)){const F=ye.getLatLngs(),D=new Xi(F,{...ye.options});D.updateProperties(),(V=t.value)==null||V.removeLayer(ye),(Z=t.value)==null||Z.addLayer(D),a.value=D,He(D)}ws("Cliquez sur la forme pour afficher les points de contrôle")}),Ee.on("click",ue=>{var O,ie,le,fe,_e,ee,G,q,de;Xe.DomEvent.stopPropagation(ue);const ye=ue.layer;if(console.log("[featureGroup click] Sélection de forme",{type:(O=ye.properties)==null?void 0:O.type,previouslySelected:a.value===ye}),(ie=i.value)==null||ie.clearLayers(),k(),(le=document.querySelector(".drawing-help-message"))==null||le.remove(),a.value=ye,ye instanceof Bo){console.log("[featureGroup click] TextRectangle sélectionné",{id:ye._leaflet_id,bounds:ye.getBounds(),hasTextContainer:!!ye.getTextElement(),properties:ye.properties}),(fe=e.value)!=null&&fe.pm.globalEditModeEnabled()&&e.value.pm.disableGlobalEditMode(),Y(ye),ws("Double-cliquez pour éditer le texte. Utilisez les points rouges pour redimensionner.");return}if(ye instanceof nl||((_e=ye.properties)==null?void 0:_e.type)==="Semicircle")re(ye);else if(ye instanceof rc)Pe(ye);else if(ye instanceof Xe.Circle){const ce=new rc(ye.getLatLng(),{...ye.options,radius:ye.getRadius()});ce.updateProperties(),(ee=t.value)==null||ee.removeLayer(ye),(G=t.value)==null||G.addLayer(ce),a.value=ce,Pe(ce)}else if(ye instanceof Xo)Te(ye);else if(ye instanceof Xe.Rectangle){const ce=new Xo(ye.getBounds(),{...ye.options});ce.updateProperties(),(q=t.value)==null||q.removeLayer(ye),(de=t.value)==null||de.addLayer(ce),a.value=ce,Te(ce)}else ye instanceof Xe.Polygon?ae(ye):(ye instanceof Xi||ye instanceof Xe.Polyline&&!(ye instanceof Xe.Polygon))&&He(ye)}),J.on("pm:edit",ue=>{var O,ie,le;console.log("[pm:edit] Début",{layer:ue.layer,currentProperties:ue.layer.properties});const ye=ue.layer;if(ye){const fe=((O=ye.properties)==null?void 0:O.type)||"unknown";if($e(ye,fe),console.log("[pm:edit] Après updateLayerProperties",{updatedProperties:ye.properties,selectedShape:a.value}),fe==="Semicircle")re(ye);else if(ye instanceof rc)Pe(ye);else if(ye instanceof Xo)Te(ye);else if(ye instanceof Xe.Rectangle){const _e=new Xo(ye.getBounds(),{...ye.options});_e.updateProperties(),(ie=t.value)==null||ie.removeLayer(ye),(le=t.value)==null||le.addLayer(_e),a.value=_e,Te(_e)}else ye instanceof Xe.Polygon?ae(ye):ye instanceof Xi?(ye.updateProperties(),$e(ye,"Line"),He(ye)):ye instanceof Xe.Polyline&&He(ye)}}),J.on("pm:dragstart",()=>{document.querySelectorAll(".drawing-help-message").forEach(ue=>ue.remove()),ws("Déplacez la forme à l'endroit souhaité")}),J.on("pm:dragend",ue=>{var O,ie,le;console.log("[pm:dragend] Début",{layer:ue.layer,currentProperties:ue.layer.properties});const ye=ue.layer;if(ye){const fe=((O=ye.properties)==null?void 0:O.type)||"unknown";if(ye instanceof Xe.Rectangle&&!(ye instanceof Xo)){const _e=new Xo(ye.getBounds(),{...ye.options});_e.updateProperties(),(ie=t.value)==null||ie.removeLayer(ye),(le=t.value)==null||le.addLayer(_e),a.value=_e,Te(_e)}else ye instanceof Xi?(ye.updateProperties(),$e(ye,"Line"),He(ye)):$e(ye,fe);console.log("[pm:dragend] Après updateLayerProperties",{updatedProperties:ye.properties,selectedShape:a.value})}setTimeout(()=>{ws("Cliquez sur la forme pour afficher les points de contrôle")},100)}),J.on("pm:remove",()=>{var ue;(ue=document.querySelector(".drawing-help-message"))==null||ue.remove()}),J.on("pm:select",ue=>{var O;const ye=ue.layer;document.querySelectorAll(".drawing-help-message").forEach(ie=>ie.remove()),ye instanceof nl||((O=ye.properties)==null?void 0:O.type)==="Semicircle"?ws(`Points de contrôle : <span style="color: #059669">●</span> Ajuster le rayon, <span style="color: #2563EB">●</span> et <span style="color: #DC2626">●</span> Modifier l'ouverture du demi-cercle`):ws("Utilisez les points de contrôle pour modifier la forme")}),J.on("pm:unselect",()=>{document.querySelectorAll(".drawing-help-message").forEach(ue=>ue.remove())}),J.on("zoomstart",()=>{a.value&&(k(),a.value=null,document.querySelectorAll(".drawing-help-message").forEach(ue=>ue.remove()))}),J},I=()=>{if(!e.value||!t.value)return;const C=t.value.getBounds();C.isValid()&&e.value.fitBounds(C,{padding:[50,50],maxZoom:19})},Q=C=>{var N;if(e.value){document.querySelectorAll(".drawing-help-message").forEach(K=>K.remove());try{const K=e.value.pm;K.globalEditModeEnabled()&&K.disableGlobalEditMode(),K.globalRemovalModeEnabled()&&K.disableGlobalRemovalMode(),K.disableDraw(),k(),(N=i.value)==null||N.clearLayers()}catch(K){console.error("Error disabling modes:",K)}if(o.value=C,!C){k();return}setTimeout(()=>{var K,J,Ee,ue,ye,O,ie,le,fe,_e,ee,G,q;try{switch(C){case"Circle":case"Semicircle":const de=(K=t.value)==null?void 0:K.getLayers().filter(ce=>ce instanceof Xo||ce instanceof Bo);de&&de.length>0&&de.forEach(ce=>{var Fe;if(!ce.getBounds)return;const V=ce.getBounds();[V.getNorthWest(),V.getNorthEast(),V.getSouthEast(),V.getSouthWest()].forEach(qe=>{var Je;const De=Xe.circleMarker(qe,{radius:4,color:"#DC2626",fillColor:"#DC2626",fillOpacity:.4,weight:2,className:"temp-corner-marker",pmIgnore:!0});(Je=i.value)==null||Je.addLayer(De)}),(ce instanceof Xo?ce.getMidPoints():[Xe.latLng((V.getNorth()+V.getSouth())/2,V.getWest()),Xe.latLng(V.getNorth(),(V.getEast()+V.getWest())/2),Xe.latLng((V.getNorth()+V.getSouth())/2,V.getEast()),Xe.latLng(V.getSouth(),(V.getEast()+V.getWest())/2)]).forEach(qe=>{var Je;const De=Xe.circleMarker(qe,{radius:5,color:"#2563EB",fillColor:"#2563EB",fillOpacity:.6,weight:2,className:"temp-midpoint-marker",pmIgnore:!0});(Je=i.value)==null||Je.addLayer(De)});const D=V.getCenter(),j=Xe.circleMarker(D,{radius:4,color:"#059669",fillColor:"#059669",fillOpacity:.4,weight:2,className:"temp-center-marker",pmIgnore:!0});(Fe=i.value)==null||Fe.addLayer(j)}),e.value.pm.setGlobalOptions({snapDistance:20,snapSegment:!0,snapLayers:[t.value,i.value]}),ws(C==="Circle"?"Positionnez le centre du cercle. Points bleus : milieu des côtés, Points rouges : sommets, Point vert : centre":"Positionnez le centre du demi-cercle. Points bleus : milieu des côtés, Points rouges : sommets, Point vert : centre"),e.value.pm.enableDraw("Circle",{finishOn:"mouseup",continueDrawing:!1});break;case"Rectangle":ws("Cliquez et maintenez pour dessiner un rectangle, relâchez pour terminer"),(J=e.value)==null||J.pm.enableDraw("Rectangle",{finishOn:"mouseup"});break;case"Polygon":ws("Cliquez pour ajouter des points, double-cliquez pour terminer le polygone"),(Ee=e.value)==null||Ee.pm.enableDraw("Polygon",{finishOn:"dblclick",continueDrawing:!1,snapMiddle:!0,snapDistance:20});break;case"Line":ws("Cliquez pour ajouter des points, double-cliquez pour terminer la ligne"),(ue=e.value)==null||ue.pm.enableDraw("Line",{finishOn:"dblclick",continueDrawing:!1,snapMiddle:!0,snapDistance:20});break;case"Text":if(ws("Cliquez pour ajouter du texte, double-cliquez pour éditer"),e.value){const ce=V=>{if(!e.value||!t.value)return;const Z=d(V.latlng);t.value.addLayer(Z),a.value=Z,e.value.off("click",ce),Q("")};e.value.on("click",ce)}break;case"delete":ws("Cliquez sur une forme pour la supprimer"),(ye=e.value)==null||ye.pm.enableGlobalRemovalMode();break;case"TextRectangle":ws("Cliquez et maintenez pour dessiner un rectangle avec texte, relâchez pour terminer"),(O=e.value)!=null&&O.pm.globalEditModeEnabled()&&e.value.pm.disableGlobalEditMode(),(ie=e.value)==null||ie.pm.enableDraw("Rectangle",{finishOn:"mouseup",continueDrawing:!1,templineStyle:{color:"#3B82F6",weight:2,dashArray:"5,5"}}),(le=e.value)==null||le.off("pm:create"),(fe=e.value)==null||fe.on("pm:create",ce=>{var V,Z,F;if(ce.shape==="Rectangle"&&ce.layer){const D=ce.layer.getBounds();let j=!1;if(t.value&&t.value.eachLayer(Fe=>{if(Fe instanceof Bo){const qe=Fe.getBounds(),De=1e-8;Math.abs(qe.getNorth()-D.getNorth())<De&&Math.abs(qe.getSouth()-D.getSouth())<De&&Math.abs(qe.getEast()-D.getEast())<De&&Math.abs(qe.getWest()-D.getWest())<De&&(j=!0,a.value=Fe,console.log("[TextRectangle] Rectangle existant trouvé, sélection au lieu de création"))}}),!j){(V=e.value)==null||V.removeLayer(ce.layer),(Z=t.value)!=null&&Z.hasLayer(ce.layer)&&t.value.removeLayer(ce.layer);const Fe=new Bo(D,"Double-cliquez pour éditer",{color:"#3B82F6",weight:2,fillColor:"#F9FAFB",fillOpacity:.8,textColor:"#000000",fontFamily:"Arial, sans-serif",textAlign:"center",bold:!1,italic:!1});t.value&&(t.value.addLayer(Fe),a.value=Fe,Fe.updateProperties(),Y(Fe),console.log("[TextRectangle] Nouveau rectangle créé avec succès",{bounds:Fe.getBounds(),properties:Fe.properties,style:Fe.properties.style}))}(F=e.value)==null||F.pm.disableDraw()}});break;case"ElevationLine":ws("Cliquez et maintenez pour tracer le profil altimétrique"),(_e=e.value)==null||_e.pm.enableDraw("Line",{finishOn:"mouseup",continueDrawing:!1,allowSelfIntersection:!1,templineStyle:{color:"#FF4500",weight:4,opacity:.8}}),(ee=e.value)==null||ee.pm.setGlobalOptions({continueDrawing:!1,finishOn:"mouseup",preventMarkerRemoval:!0,preventVertexEdit:!0,preventMarkerEdit:!0}),(G=e.value)==null||G.off("pm:create"),(q=e.value)==null||q.on("pm:create",async ce=>{var V,Z,F;if(ce.shape==="Line"&&ce.layer){const D=ce.layer.getLatLngs();(V=e.value)==null||V.removeLayer(ce.layer),(Z=t.value)!=null&&Z.hasLayer(ce.layer)&&t.value.removeLayer(ce.layer);const j=new eu(D,{color:"#FF4500",weight:4,opacity:.8,interactive:!1,pmIgnore:!0});if(t.value){t.value.addLayer(j),a.value=j,await j.updateElevationProfile();const Fe=T(j,"ElevationLine");Object.assign(j.properties,{...Fe,...j.properties,type:"ElevationLine",elevationData:j.getElevationData()}),a.value=null,bi(()=>{a.value=j})}(F=e.value)==null||F.pm.disableDraw(),o.value=""}});break}}catch(de){console.error("Error enabling tool:",de)}},100)}},se=C=>{var K;if(!a.value)return;const N=a.value;if(N.properties=N.properties||{},N.properties.style=N.properties.style||{},N.properties.style={...N.properties.style,...C},N.properties.type==="text"){const J=N.properties._textLayer,Ee=(K=J==null?void 0:J.getElement())==null?void 0:K.querySelector(".text-annotation");Ee&&ig(Ee,N.properties.style);const ue={color:C.borderColor||N.properties.style.borderColor,weight:parseInt(C.borderWidth||N.properties.style.borderWidth),opacity:C.borderOpacity??N.properties.style.borderOpacity};"setStyle"in N&&N.setStyle(ue)}else if(N.properties.type==="TextRectangle"){if(N instanceof Bo){const J={};C.textColor!==void 0&&(J.textColor=C.textColor),C.fontSize!==void 0&&(J.fontSize=C.fontSize),C.fontFamily!==void 0&&(J.fontFamily=C.fontFamily),C.backgroundColor!==void 0&&(J.backgroundColor=C.backgroundColor),C.backgroundOpacity!==void 0&&(J.backgroundOpacity=C.backgroundOpacity),C.textAlign!==void 0&&(J.textAlign=C.textAlign),C.bold!==void 0&&(J.bold=C.bold),C.italic!==void 0&&(J.italic=C.italic),C.fillColor&&(J.fillColor=C.fillColor),C.fillOpacity!==void 0&&(J.fillOpacity=C.fillOpacity),C.strokeColor&&(J.color=C.strokeColor),C.color&&(J.color=C.color),C.strokeOpacity!==void 0&&(J.opacity=C.strokeOpacity),C.strokeWidth!==void 0&&(J.weight=C.strokeWidth),C.weight!==void 0&&(J.weight=C.weight),C.dashArray&&(J.dashArray=C.dashArray),N.setTextStyle(J)}}else{const J={};C.fillColor&&(J.fillColor=C.fillColor),C.fillOpacity!==void 0&&(J.fillOpacity=C.fillOpacity),C.strokeColor&&(J.color=C.strokeColor),C.strokeOpacity!==void 0&&(J.opacity=C.strokeOpacity),C.strokeWidth!==void 0&&(J.weight=C.strokeWidth),C.dashArray&&(J.dashArray=C.dashArray),"setStyle"in N&&N.setStyle(J)}},we=C=>{if(!a.value)return;const N=a.value;N.properties={...N.properties,...C},C.radius&&N instanceof Xe.Circle&&N.setRadius(C.radius)},Be=C=>{console.log("[forceShapeUpdate] Début",{currentProperties:C.properties,selectedShapeRef:a.value}),a.value=null,bi(()=>{a.value=C,console.log("[forceShapeUpdate] Après mise à jour",{selectedShape:a.value,properties:a.value.properties})})},$e=(C,N)=>{console.log("[updateLayerProperties] Début",{layer:C,shapeType:N,currentProperties:C.properties}),zL((J,Ee)=>{const ue=T(J,Ee);console.log("[updateLayerProperties] Nouvelles propriétés calculées",{newProperties:ue}),J.properties={...ue},Be(J),J.fire("properties:updated",{shape:J,properties:J.properties}),console.log("[updateLayerProperties] Fin",{finalProperties:J.properties,selectedShape:a.value})},100)(C,N)},Ue=(C,N)=>Xe.latLng((C.lat+N.lat)/2,(C.lng+N.lng)/2),Pe=C=>{if(!e.value||!t.value)return;k();const N=C.getLatLng(),K=C.getRadius(),J=b(N,"#059669");x.push(J),y(J,C,()=>[En(K,"m","Rayon"),En(K*2,"m","Diamètre"),En(Math.PI*Math.pow(K,2),"m²","Surface")].join("<br>"));const Ee=[],ue=[0,45,90,135,180,225,270,315];ue.forEach(ye=>{const O=C.calculatePointOnCircle(ye),ie=b(O,"#2563EB");Ee.push(ie),x.push(ie),y(ie,C,()=>En(K,"m","Rayon")),ie.on("mousedown",le=>{if(!e.value)return;Xe.DomEvent.stopPropagation(le),e.value.dragging.disable();let fe=!0;const _e=G=>{fe&&(C.resizeFromControlPoint(G.latlng),Ee.forEach((q,de)=>{const ce=C.calculatePointOnCircle(ue[de]);q.setLatLng(ce)}),J.setLatLng(C.getLatLng()),ie.measureDiv&&(ie.measureDiv.innerHTML=En(C.getRadius(),"m","Rayon")))},ee=()=>{fe=!1,e.value&&(e.value.off("mousemove",_e),document.removeEventListener("mouseup",ee),e.value.dragging.enable(),C.updateProperties(),a.value=null,bi(()=>{a.value=C}),$e(C,"Circle"))};e.value.on("mousemove",_e),document.addEventListener("mouseup",ee)})}),J.on("mousedown",ye=>{if(!e.value)return;Xe.DomEvent.stopPropagation(ye),e.value.dragging.disable();let O=!0;const ie=C.getLatLng(),le=ye.latlng,fe=ee=>{if(!O)return;const G=ee.latlng.lng-le.lng,q=ee.latlng.lat-le.lat,de=Xe.latLng(ie.lat+q,ie.lng+G);Xe.Circle.prototype.setLatLng.call(C,de),J.setLatLng(de),Ee.forEach((ce,V)=>{const Z=C.calculatePointOnCircle(ue[V]);ce.setLatLng(Z)}),J.measureDiv&&(J.measureDiv.innerHTML=[En(C.getRadius(),"m","Rayon"),En(C.getRadius()*2,"m","Diamètre"),En(Math.PI*Math.pow(C.getRadius(),2),"m²","Surface")].join("<br>"))},_e=()=>{O=!1,e.value&&(e.value.off("mousemove",fe),document.removeEventListener("mouseup",_e),e.value.dragging.enable(),C.updateProperties(),a.value=null,bi(()=>{a.value=C}),$e(C,"Circle"))};e.value.on("mousemove",fe),document.addEventListener("mouseup",_e)}),C.on("circle:resized",()=>{$e(C,"Circle")}),a.value=C},Te=C=>{var _e;if(!e.value||!t.value)return;if(!(C instanceof Xo)){console.warn("La couche n'est pas une instance de Rectangle");return}const N=C;k();const J=N.getBounds().getCenter(),Ee=N.getRotatedCorners(),ue=b(J,"#059669");x.push(ue),y(ue,N,()=>{const{width:ee,height:G}=N.getDimensions(),q=ee*G,de=N.getRotation();return[En(ee,"m","Largeur"),En(G,"m","Hauteur"),En(q,"m²","Surface"),`Rotation: ${de.toFixed(1)}°`].join("<br>")});const ye=b(Xe.latLng(J.lat+(Ee[0].lat-J.lat)*1.2,J.lng+(Ee[0].lng-J.lng)*1.2),"#F97316");x.push(ye);const O=Xe.polyline([J,ye.getLatLng()],{color:"#F97316",weight:1,opacity:.6,dashArray:"4",pmIgnore:!0});(_e=n.value)==null||_e.addLayer(O);const ie=[];Ee.forEach((ee,G)=>{const q=b(ee,"#DC2626");ie.push(q),x.push(q),y(q,N,()=>{const{width:de,height:ce}=N.getDimensions();return[En(de,"m","Largeur"),En(ce,"m","Hauteur")].join("<br>")}),q.on("mousedown",de=>{if(!e.value)return;Xe.DomEvent.stopPropagation(de),e.value.dragging.disable();const ce=Z=>{N.resizeFromCorner(G,Z.latlng);const F=N.getBounds(),D=[F.getNorthWest(),F.getNorthEast(),F.getSouthEast(),F.getSouthWest()];q.setLatLng(Z.latlng),ue.setLatLng(F.getCenter()),ie.forEach((Fe,qe)=>{qe!==G&&Fe.setLatLng(D[qe])});const j=N.getMidPoints();le.forEach((Fe,qe)=>{Fe.setLatLng(j[qe]);const{width:De,height:Je}=N.getDimensions(),Ze=qe%2===0?De:Je;Fe.measureDiv&&(Fe.measureDiv.innerHTML=[En(Ze,"m","Longueur du côté"),En(Ze/2,"m","Distance au coin")].join("<br>"))})},V=()=>{e.value&&(e.value.off("mousemove",ce),document.removeEventListener("mouseup",V),e.value.dragging.enable(),N.updateProperties(),a.value=null,bi(()=>{a.value=N}))};e.value.on("mousemove",ce),document.addEventListener("mouseup",V)})});const le=[];N.getMidPoints().forEach((ee,G)=>{const q=b(ee,"#2563EB");le.push(q),x.push(q),y(q,N,()=>{const{width:de,height:ce}=N.getDimensions(),V=G%2===0?de:ce;return[En(V,"m","Longueur du côté"),En(V/2,"m","Distance au coin")].join("<br>")}),q.on("mousedown",de=>{Xe.DomEvent.stopPropagation(de),e.value.dragging.disable();const ce=Z=>{const F=e.value.mouseEventToLatLng(Z.originalEvent),D=N.getBounds(),j=D.getNorthWest(),Fe=D.getSouthEast();let qe;if(G%2===0){const yt=(j.lng+Fe.lng)/2;qe=Xe.latLng(F.lat,yt)}else{const yt=(j.lat+Fe.lat)/2;qe=Xe.latLng(yt,F.lng)}N.resizeFromSide(G,qe);const De=N.getBounds(),Je=[De.getNorthWest(),De.getNorthEast(),De.getSouthEast(),De.getSouthWest()];ue.setLatLng(De.getCenter()),ie.forEach((yt,wt)=>{yt.setLatLng(Je[wt])});const Ze=N.getMidPoints();le.forEach((yt,wt)=>{yt.setLatLng(Ze[wt]);const{width:Pt,height:Rt}=N.getDimensions(),qt=wt%2===0?Pt:Rt;yt.measureDiv&&(yt.measureDiv.innerHTML=[En(qt,"m","Longueur du côté"),En(qt/2,"m","Distance au coin")].join("<br>"))})},V=()=>{e.value.dragging.enable(),e.value.off("mousemove",ce),document.removeEventListener("mouseup",V),N.updateProperties(),a.value=null,bi(()=>{a.value=N})};e.value.on("mousemove",ce),document.addEventListener("mouseup",V)})}),ue.on("mousedown",ee=>{if(!e.value)return;Xe.DomEvent.stopPropagation(ee),e.value.dragging.disable();let G=!0;const q=ce=>{if(!G)return;N.moveFromCenter(ce.latlng),ue.setLatLng(ce.latlng);const V=N.getBounds(),Z=[V.getNorthWest(),V.getNorthEast(),V.getSouthEast(),V.getSouthWest()];ie.forEach((D,j)=>{D.setLatLng(Z[j])});const F=N.getMidPoints();if(le.forEach((D,j)=>{D.setLatLng(F[j])}),ue.measureDiv){const{width:D,height:j}=N.getDimensions(),Fe=D*j;ue.measureDiv.innerHTML=[En(D,"m","Largeur"),En(j,"m","Hauteur"),En(Fe,"m²","Surface")].join("<br>")}},de=()=>{G=!1,e.value&&(e.value.off("mousemove",q),document.removeEventListener("mouseup",de),e.value.dragging.enable(),N.updateProperties(),a.value=null,bi(()=>{a.value=N}))};e.value.on("mousemove",q),document.addEventListener("mouseup",de)}),ye.on("mousedown",ee=>{if(!e.value)return;Xe.DomEvent.stopPropagation(ee),e.value.dragging.disable();const G=ee.latlng,q=N.getRotation(),de=N.getCenter(),ce=G.lng-de.lng,V=G.lat-de.lat,Z=Math.atan2(V,ce)*180/Math.PI,F=j=>{const Fe=j.latlng.lng-de.lng,qe=j.latlng.lat-de.lat;let Je=Math.atan2(qe,Fe)*180/Math.PI-Z,Ze=(q+Je)%360;Ze<0&&(Ze+=360),N.setRotation(Ze),ye.setLatLng(j.latlng),O.setLatLngs([de,j.latlng]);const yt=N.getRotatedCorners();ie.forEach((Pt,Rt)=>{Pt.setLatLng(yt[Rt])});const wt=N.getMidPoints();le.forEach((Pt,Rt)=>{Pt.setLatLng(wt[Rt])})},D=()=>{e.value&&(e.value.off("mousemove",F),document.removeEventListener("mouseup",D),e.value.dragging.enable(),N.updateProperties(),a.value=null,bi(()=>{a.value=N}))};e.value.on("mousemove",F),document.addEventListener("mouseup",D)})},He=C=>{if(!e.value||!t.value)return;k();const N=C.getLatLngs();let K=null;if(C instanceof Xi){const ue=C.getCenter();K=b(ue,"#059669"),x.push(K),y(K,C,()=>{const ye=C.getLength()||0;return En(ye,"m","Longueur totale")}),K.on("mousedown",ye=>{if(!e.value)return;Xe.DomEvent.stopPropagation(ye),e.value.dragging.disable();let O=!0;const ie=ye.latlng,le=[...C.getLatLngs()];x.forEach((ee,G)=>{G>0&&ee.setStyle({opacity:0,fillOpacity:0})});const fe=ee=>{if(!O)return;const G=ee.latlng.lng-ie.lng,q=ee.latlng.lat-ie.lat,de=le.map(ce=>Xe.latLng(ce.lat+q,ce.lng+G));Xe.Polyline.prototype.setLatLngs.call(C,de),K==null||K.setLatLng(ee.latlng)},_e=()=>{O=!1,e.value&&(e.value.off("mousemove",fe),document.removeEventListener("mouseup",_e),e.value.dragging.enable(),k(),He(C),C instanceof Xi&&(C.updateProperties(),$e(C,"Line")),a.value=C)};e.value.on("mousemove",fe),document.addEventListener("mouseup",_e)})}N.forEach((ue,ye)=>{const O=b(ue,"#DC2626");x.push(O),y(O,C,()=>{let ie=0,le=0;return C instanceof Xi?(ie=C.getLength()||0,le=C.getLengthToVertex(ye)):(ie=N.reduce((fe,_e,ee)=>ee===0?0:fe+_e.distanceTo(N[ee-1]),0),le=N.slice(0,ye+1).reduce((fe,_e,ee)=>ee===0?0:fe+_e.distanceTo(N[ee-1]),0)),[En(le,"m","Distance depuis le début"),En(ie,"m","Longueur totale")].join("<br>")}),O.on("mousedown",ie=>{if(!e.value)return;Xe.DomEvent.stopPropagation(ie),e.value.dragging.disable();let le=!0;K&&(K.setStyle({opacity:0,fillOpacity:0}),K.measureDiv&&(K.measureDiv.style.display="none"));const fe=[];ye>0&&fe.push(ye-1),ye<N.length-1&&fe.push(ye);const _e=fe.map(q=>N.length+q),ee=q=>{le&&(C instanceof Xi?C.moveVertex(ye,q.latlng,!1):(N[ye]=q.latlng,C.setLatLngs(N)),O.setLatLng(q.latlng),Ee(fe,_e))},G=()=>{if(le=!1,!!e.value){if(e.value.off("mousemove",ee),document.removeEventListener("mouseup",G),e.value.dragging.enable(),C instanceof Xi&&(C.updateProperties(),$e(C,"Line")),K&&C instanceof Xi){const q=C.getCenter();K.setLatLng(q),K.setStyle({opacity:1,fillOpacity:1}),K.measureDiv&&(K.measureDiv.style.display="")}a.value=null,bi(()=>{a.value=C})}};e.value.on("mousemove",ee),document.addEventListener("mouseup",G)})});const J=()=>{const ue=C.getLatLngs(),ye=C instanceof Xi?ue.length+1:ue.length;x.slice(ye).forEach(ie=>{var le;ie&&typeof ie.remove=="function"&&((le=n.value)==null||le.removeLayer(ie))}),x=x.slice(0,ye),(C instanceof Xi?C.getMidPoints():Array.from({length:ue.length-1},(ie,le)=>{const fe=ue[le],_e=ue[le+1];return Xe.latLng((fe.lat+_e.lat)/2,(fe.lng+_e.lng)/2)})).forEach((ie,le)=>{const fe=b(ie,"#2563EB");x.push(fe),y(fe,C,()=>{let _e=0,ee=0,G=0;if(C instanceof Xi)_e=C.getSegmentLengthAt(le),ee=C.getLength()||0,G=C.getLengthToVertex(le)+_e/2;else{const q=ue[le],de=ue[le+1];_e=q.distanceTo(de),ee=ue.reduce((ce,V,Z)=>Z===0?0:ce+V.distanceTo(ue[Z-1]),0),G=ue.slice(0,le+1).reduce((ce,V,Z)=>Z===0?0:ce+V.distanceTo(ue[Z-1]),0)+_e/2}return[En(_e,"m","Longueur du segment"),En(_e/2,"m","Demi-segment"),En(G,"m","Distance depuis le début"),En(ee,"m","Longueur totale")].join("<br>")}),fe.on("mousedown",_e=>{if(!e.value)return;Xe.DomEvent.stopPropagation(_e),e.value.dragging.disable();let ee=!0;const G=le,q=C.getLatLngs(),de=x.find(Z=>Z.options&&Z.options.color==="#059669");de&&(de.setStyle({opacity:0,fillOpacity:0}),de.measureDiv&&(de.measureDiv.style.display="none"));const ce=Z=>{if(ee){if(C instanceof Xi)C.addVertex(G,Z.latlng,!1);else{const F=q.slice();F.splice(G+1,0,Z.latlng),C.setLatLngs(F)}k(),He(C),V()}},V=()=>{ee=!1,e.value&&(e.value.off("mousemove",ce),document.removeEventListener("mouseup",V),e.value.dragging.enable(),C instanceof Xi&&(C.updateProperties(),$e(C,"Line")),a.value=null,bi(()=>{a.value=C}))};e.value.on("mousemove",ce),document.addEventListener("mouseup",V)})})},Ee=(ue,ye)=>{const O=C.getLatLngs();ue.forEach((ie,le)=>{if(ie<0||ie>=O.length-1)return;const fe=ye[le];if(fe>=0&&fe<x.length){let _e;if(C instanceof Xi){const G=C.getMidPointAt(ie);if(!G)return;_e=G}else{const G=O[ie],q=O[ie+1];_e=Xe.latLng((G.lat+q.lat)/2,(G.lng+q.lng)/2)}const ee=x[fe];if(ee&&ee.setLatLng){ee.setLatLng(_e);const G=ee;if(G.measureDiv){let q=0,de=0,ce=0;if(C instanceof Xi)q=C.getSegmentLengthAt(ie),de=C.getLength()||0,ce=C.getLengthToVertex(ie)+q/2;else{const V=O[ie],Z=O[ie+1];q=V.distanceTo(Z),de=0,ce=0;for(let F=0;F<O.length-1;F++){const D=O[F].distanceTo(O[F+1]);de+=D,F<ie?ce+=D:F===ie&&(ce+=D/2)}}G.measureDiv.innerHTML=[En(q,"m","Longueur du segment"),En(q/2,"m","Demi-segment"),En(ce,"m","Distance depuis le début"),En(de,"m","Longueur totale")].join("<br>")}}}})};if(J(),C instanceof eu){k(),C.updateElevationProfile().then(()=>{Object.assign(C.properties,{...C.properties,type:"ElevationLine"}),console.log("[useMapDrawing] ElevationLine properties avant calcul:",C.properties);const ue=T(C,"ElevationLine");Object.assign(C.properties,{...ue,...C.properties,type:"ElevationLine",elevationData:C.getElevationData(),maxElevation:C.properties.maxElevation,minElevation:C.properties.minElevation,elevationGain:C.properties.elevationGain,elevationLoss:C.properties.elevationLoss,maxSlope:C.properties.maxSlope,averageSlope:C.properties.averageSlope}),console.log("[useMapDrawing] ElevationLine properties après mise à jour:",C.properties),a.value=null,bi(()=>{a.value=C})}),e.value&&e.value.pm.setGlobalOptions({preventMarkerRemoval:!0,preventVertexEdit:!0,preventMarkerEdit:!0});return}},ae=C=>{if(!e.value||!t.value)return;k();const N=C.getLatLngs()[0],K=N.map(le=>[le.lng,le.lat]);K.push(K[0]);const J=El([K]),Ee=Eu(J),ue=N.reduce((le,fe,_e)=>{const ee=N[(_e+1)%N.length];return le+fe.distanceTo(ee)},0);let ye;if(typeof C.getCenter=="function")try{ye=C.getCenter()}catch(le){console.warn("Erreur lors de la récupération du centre du polygone via getCenter(), utilisation de la méthode alternative",le);const fe=bc(J);ye=Xe.latLng(fe.geometry.coordinates[1],fe.geometry.coordinates[0])}else{const le=bc(J);ye=Xe.latLng(le.geometry.coordinates[1],le.geometry.coordinates[0])}const O=b(ye,"#059669");x.push(O),y(O,C,()=>[En(ue,"m","Périmètre"),En(Ee,"m²","Surface")].join("<br>")),O.on("mousedown",le=>{if(!e.value)return;Xe.DomEvent.stopPropagation(le),e.value.dragging.disable();let fe=!0;const _e=le.latlng,ee=[...N];x.forEach((ce,V)=>{V>0&&ce.setStyle({opacity:0,fillOpacity:0})});const G=wu(ce=>{if(!fe)return;const V=ce.latlng.lng-_e.lng,Z=ce.latlng.lat-_e.lat,F=ee.map(D=>Xe.latLng(D.lat+Z,D.lng+V));Xe.Polygon.prototype.setLatLngs.call(C,[F]),O.setLatLng(ce.latlng)},16),q=ce=>{fe&&G(ce)},de=()=>{if(fe=!1,!!e.value){if(e.value.off("mousemove",q),document.removeEventListener("mouseup",de),e.value.dragging.enable(),C.properties){const ce=C.getLatLngs()[0],V=ce.map(F=>[F.lng,F.lat]);V.push(V[0]);const Z=El([V]);C.properties.area=Eu(Z),C.properties.perimeter=ce.reduce((F,D,j)=>{const Fe=ce[(j+1)%ce.length];return F+D.distanceTo(Fe)},0),C.properties.surfaceInterieure=C.properties.area,C.properties.surfaceExterieure=C.properties.area}k(),ae(C),a.value=null,bi(()=>{a.value=C})}};e.value.on("mousemove",q),document.addEventListener("mouseup",de)}),N.forEach((le,fe)=>{const _e=b(le,"#DC2626");x.push(_e),y(_e,C,()=>{const ee=N[(fe-1+N.length)%N.length],G=N[(fe+1)%N.length],q=le.distanceTo(ee),de=le.distanceTo(G);return[En(q,"m","Distance au point précédent"),En(de,"m","Distance au point suivant"),En(ue,"m","Périmètre total"),En(Ee,"m²","Surface")].join("<br>")}),_e.on("mousedown",ee=>{if(Xe.DomEvent.stopPropagation(ee),!e.value)return;e.value.dragging.disable();let G=!0;O&&(O.setStyle({opacity:0,fillOpacity:0}),O.measureDiv&&(O.measureDiv.style.display="none"));const q=wu(V=>{if(!G)return;N[fe]=V.latlng,Xe.Polygon.prototype.setLatLngs.call(C,[N]),_e.setLatLng(V.latlng);const Z=x.slice(N.length+1),F=(fe-1+N.length)%N.length,D=Z[F];if(D){const Fe=N[F],qe=N[fe],De=Xe.latLng((Fe.lat+qe.lat)/2,(Fe.lng+qe.lng)/2);D.setLatLng(De)}const j=Z[fe];if(j){const Fe=N[fe],qe=N[(fe+1)%N.length],De=Xe.latLng((Fe.lat+qe.lat)/2,(Fe.lng+qe.lng)/2);j.setLatLng(De)}},16),de=V=>{G&&q(V)},ce=()=>{if(G=!1,!!e.value){if(e.value.off("mousemove",de),document.removeEventListener("mouseup",ce),e.value.dragging.enable(),C.properties){const V=C.getLatLngs()[0].map(F=>[F.lng,F.lat]);V.push(V[0]);const Z=El([V]);C.properties.area=Eu(Z),C.properties.perimeter=N.reduce((F,D,j)=>{const Fe=N[(j+1)%N.length];return F+D.distanceTo(Fe)},0),C.properties.surfaceInterieure=C.properties.area,C.properties.surfaceExterieure=C.properties.area}k(),ae(C),a.value=null,bi(()=>{a.value=C})}};e.value.on("mousemove",de),document.addEventListener("mouseup",ce)})}),(()=>{const le=C.getLatLngs()[0];x.slice(le.length+1).forEach(_e=>{n.value&&n.value.removeLayer(_e)}),x=x.slice(0,le.length+1);const fe=new Array(le.length);for(let _e=0;_e<le.length;_e++){const ee=le[_e],G=le[(_e+1)%le.length];fe[_e]=Ue(ee,G)}fe.forEach((_e,ee)=>{const G=b(_e,"#2563EB");x.push(G),y(G,C,()=>{const q=le[ee],de=le[(ee+1)%le.length],ce=q.distanceTo(de);return[En(ce,"m","Longueur du segment"),En(ue,"m","Périmètre total"),En(Ee,"m²","Surface")].join("<br>")}),G.on("mousedown",q=>{if(!e.value)return;Xe.DomEvent.stopPropagation(q),e.value.dragging.disable();let de=!0;const ce=ee;O&&(O.setStyle({opacity:0,fillOpacity:0}),O.measureDiv&&(O.measureDiv.style.display="none"));const V=[...C.getLatLngs()[0]];V.splice((ce+1)%V.length,0,_e),C.setLatLngs([V]),k(),ae(C);const Z=ce+1,F=1+Z,D=Z<x.length-1?x[F]:null;if(D){const j=qe=>{if(!de)return;const De=C.getLatLngs()[0];De[Z]=qe.latlng,C.setLatLngs([De]),D.setLatLng(qe.latlng);const Je=x.slice(1+De.length),Ze=(Z-1+De.length)%De.length,yt=Z;if(Je[Ze]){const wt=De[Ze],Pt=De[Z],Rt=Xe.latLng((wt.lat+Pt.lat)/2,(wt.lng+Pt.lng)/2);Je[Ze].setLatLng(Rt)}if(Je[yt]){const wt=De[Z],Pt=De[(Z+1)%De.length],Rt=Xe.latLng((wt.lat+Pt.lat)/2,(wt.lng+Pt.lng)/2);Je[yt].setLatLng(Rt)}},Fe=()=>{if(de=!1,!!e.value){if(e.value.off("mousemove",j),document.removeEventListener("mouseup",Fe),e.value.dragging.enable(),C.properties){const qe=C.getLatLngs()[0].map(Je=>[Je.lng,Je.lat]);qe.push(qe[0]);const De=El([qe]);C.properties.area=Eu(De),C.properties.perimeter=C.getLatLngs()[0].reduce((Je,Ze,yt,wt)=>{const Pt=wt[(yt+1)%wt.length];return Je+Ze.distanceTo(Pt)},0)}k(),ae(C),a.value=null,bi(()=>{a.value=C})}};e.value.on("mousemove",j),document.addEventListener("mouseup",Fe)}else e.value.dragging.enable(),k(),ae(C)})})})()},re=C=>{if(!e.value||!t.value)return;k();const N=C.getCenter(),K=C.getStartAngle(),J=C.getStopAngle(),Ee=C.getOpeningAngle(),ue=C.calculatePointOnArc(K),ye=C.calculatePointOnArc(J),O=b(ue,"#DC2626"),ie=b(ye,"#DC2626");x.push(O,ie);const le=b(N,"#059669");x.push(le);let fe=null;if(Ee>5){const _e=C.calculateMidpointPosition();fe=b(_e,"#2563EB"),x.push(fe),fe.on("mousedown",ee=>{if(!e.value)return;Xe.DomEvent.stopPropagation(ee),e.value.dragging.disable();let G=!0;const q=ce=>{if(!G)return;const V=N.distanceTo(ce.latlng);C.setRadius(V);const Z=C.calculatePointOnArc(K),F=C.calculatePointOnArc(J),D=C.calculateMidpointPosition();O.setLatLng(Z),ie.setLatLng(F),fe==null||fe.setLatLng(D),C.updateProperties(),a.value=C},de=()=>{G=!1,e.value&&(e.value.off("mousemove",q),document.removeEventListener("mouseup",de),e.value.dragging.enable(),C.updateProperties(),a.value=null,bi(()=>{a.value=C}),$e(C,"Semicircle"))};e.value.on("mousemove",q),document.addEventListener("mouseup",de)})}[O,ie].forEach((_e,ee)=>{_e.on("mousedown",G=>{if(!e.value)return;Xe.DomEvent.stopPropagation(G),e.value.dragging.disable();let q=!0;const de=V=>{if(!q||!e.value)return;const Z=V.latlng.lng-N.lng,F=V.latlng.lat-N.lat;let D=(Math.atan2(F,Z)*180/Math.PI+360)%360;ee===0?C.setAngles(D,C.getStopAngle()):C.setAngles(C.getStartAngle(),D);const j=C.getStartAngle(),Fe=C.getStopAngle(),qe=C.getOpeningAngle(),De=C.calculatePointOnArc(j),Je=C.calculatePointOnArc(Fe);if(O.setLatLng(De),ie.setLatLng(Je),fe&&qe>5){const Ze=C.calculateMidpointPosition();fe.setLatLng(Ze),fe.setStyle({opacity:1,fillOpacity:1})}else fe&&fe.setStyle({opacity:0,fillOpacity:0});C.updateProperties(),a.value=C},ce=()=>{q=!1,e.value&&(e.value.off("mousemove",de),document.removeEventListener("mouseup",ce),e.value.dragging.enable(),C.updateProperties(),a.value=null,bi(()=>{a.value=C}),$e(C,"Semicircle"),re(C))};e.value.on("mousemove",de),document.addEventListener("mouseup",ce)})}),le.on("mousedown",_e=>{if(!e.value)return;Xe.DomEvent.stopPropagation(_e),e.value.dragging.disable();let ee=!0;const G=de=>{if(!ee)return;C.setCenter(de.latlng),le.setLatLng(de.latlng);const ce=C.getStartAngle(),V=C.getStopAngle(),Z=C.getOpeningAngle(),F=C.calculatePointOnArc(ce),D=C.calculatePointOnArc(V);if(O.setLatLng(F),ie.setLatLng(D),fe&&Z>5){const j=C.calculateMidpointPosition();fe.setLatLng(j),fe.setStyle({opacity:1,fillOpacity:1})}else fe&&fe.setStyle({opacity:0,fillOpacity:0});C.updateProperties(),a.value=C},q=()=>{ee=!1,e.value&&(e.value.off("mousemove",G),document.removeEventListener("mouseup",q),e.value.dragging.enable(),C.updateProperties(),a.value=null,bi(()=>{a.value=C}),$e(C,"Semicircle"))};e.value.on("mousemove",G),document.addEventListener("mouseup",q)})},oe=C=>{var N;if(!(!e.value||!i.value)){if(console.log("[generateTempControlPoints] Génération des points temporaires pour",{layerType:C.constructor.name,properties:C.properties,isPolygon:C instanceof Mu||C instanceof Xe.Polygon}),i.value.clearLayers(),C instanceof Bo){const K=(N=C.getBounds)==null?void 0:N.call(C).getCenter();if(K){const J=Xe.circleMarker(K,{radius:0,className:"text-hint-marker",pmIgnore:!0});i.value.addLayer(J)}return}try{if(C instanceof Mu||C instanceof Xe.Polygon){let K=[];try{if("getLatLngs"in C){const Ee=C.getLatLngs();if(Array.isArray(Ee)&&Ee.length>0){const ue=Ee[0];Array.isArray(ue)?K=ue:ue instanceof Xe.LatLng&&(K=Ee)}}}catch(Ee){console.error("[generateTempControlPoints] Erreur lors de la récupération des points du polygone:",Ee);return}let J=null;try{if(C instanceof Mu&&typeof C.getCenter=="function")J=C.getCenter();else{const Ee=K.map(O=>[O.lng,O.lat]);Ee.push(Ee[0]);const ue=El([Ee]),ye=bc(ue);J=Xe.latLng(ye.geometry.coordinates[1],ye.geometry.coordinates[0])}if(J&&J.lat!==void 0&&J.lng!==void 0){const Ee=b(J,"#059669");i.value.addLayer(Ee)}}catch(Ee){console.warn("[generateTempControlPoints] Erreur lors du calcul du centre du polygone:",Ee)}K.forEach(Ee=>{if(Ee&&Ee.lat!==void 0&&Ee.lng!==void 0){const ue=b(Ee,"#DC2626");i.value.addLayer(ue)}});for(let Ee=0;Ee<K.length;Ee++){const ue=K[Ee],ye=K[(Ee+1)%K.length];if(ue&&ye&&ue.lat!==void 0&&ue.lng!==void 0&&ye.lat!==void 0&&ye.lng!==void 0){const O=Xe.latLng((ue.lat+ye.lat)/2,(ue.lng+ye.lng)/2),ie=b(O,"#2563EB");i.value.addLayer(ie)}}}else C instanceof rc;console.log("[generateTempControlPoints] Points temporaires générés",{count:i.value.getLayers().length})}catch(K){console.error("[generateTempControlPoints] Erreur lors de la génération des points temporaires:",K)}}},Y=C=>{if(!e.value||!t.value||!C.getBounds)return;const N=C;k(),N.on("edit:start",()=>{k()}),N.on("edit:end",()=>{Y(N)});const K=N.getBounds(),J=K.getCenter(),Ee=N.properties.rotation||0,ue=ee=>{if(Ee===0)return ee;const G=Ee*Math.PI/180,q=Math.cos(G),de=Math.sin(G),ce=ee.lng-J.lng,V=ee.lat-J.lat,Z=ce*q-V*de,F=ce*de+V*q;return Xe.latLng(J.lat+F,J.lng+Z)},ye=[K.getNorthWest(),K.getNorthEast(),K.getSouthEast(),K.getSouthWest()].map(ee=>ue(ee)),O=N.getMidPoints().map(ee=>ue(ee)),ie=b(J,"#059669");ie.addTo(e.value),x.push(ie),y(ie,N,()=>{const{width:ee,height:G}=N.getDimensions(),q=ee*G;return[En(ee,"m","Largeur"),En(G,"m","Hauteur"),En(q,"m²","Surface"),`Rotation: ${Ee.toFixed(1)}°`].join("<br>")});const le=ye.map((ee,G)=>{const q=b(ee,"#DC2626");return q.addTo(e.value),x.push(q),y(q,N,()=>{const{width:de,height:ce}=N.getDimensions();return[En(de,"m","Largeur"),En(ce,"m","Hauteur")].join("<br>")}),q.on("mousedown",de=>{if(!e.value)return;Xe.DomEvent.stopPropagation(de),e.value.dragging.disable();const ce=(G+2)%4,V=ye[ce];N.startResize();const Z=wu(j=>{const Fe=Xe.latLngBounds(V,j.latlng);N.updateResizePreview(Fe)},16),F=j=>Z(j),D=()=>{if(!e.value)return;e.value.off("mousemove",F),document.removeEventListener("mouseup",D),e.value.dragging.enable();const j=Xe.latLngBounds(V,q.getLatLng());N.endResize(j),a.value=null,bi(()=>{a.value=N})};e.value.on("mousemove",F),document.addEventListener("mouseup",D)}),q}),fe=O.map((ee,G)=>{const q=b(ee,"#2563EB");return q.addTo(e.value),x.push(q),y(q,N,()=>{const{width:de,height:ce}=N.getDimensions(),V=G%2===0?de:ce;return[En(V,"m","Longueur du côté"),En(V/2,"m","Distance au coin"),`Rotation: ${Ee.toFixed(1)}°`].join("<br>")}),q.on("mousedown",de=>{if(!e.value)return;Xe.DomEvent.stopPropagation(de),e.value.dragging.disable(),N.startResize();const ce=wu(F=>{const D=N.getBounds();let j;switch(G){case 0:j=Xe.latLngBounds(Xe.latLng(F.latlng.lat,D.getWest()),Xe.latLng(D.getSouth(),D.getEast()));break;case 1:j=Xe.latLngBounds(Xe.latLng(D.getNorth(),D.getWest()),Xe.latLng(D.getSouth(),F.latlng.lng));break;case 2:j=Xe.latLngBounds(Xe.latLng(D.getNorth(),D.getWest()),Xe.latLng(F.latlng.lat,D.getEast()));break;case 3:j=Xe.latLngBounds(Xe.latLng(D.getNorth(),F.latlng.lng),Xe.latLng(D.getSouth(),D.getEast()));break;default:return}N.updateResizePreview(j)},16),V=F=>ce(F),Z=()=>{if(!e.value)return;e.value.off("mousemove",V),document.removeEventListener("mouseup",Z),e.value.dragging.enable();const F=N.getBounds();let D;switch(G){case 0:D=Xe.latLngBounds(Xe.latLng(q.getLatLng().lat,F.getWest()),Xe.latLng(F.getSouth(),F.getEast()));break;case 1:D=Xe.latLngBounds(Xe.latLng(F.getNorth(),F.getWest()),Xe.latLng(F.getSouth(),q.getLatLng().lng));break;case 2:D=Xe.latLngBounds(Xe.latLng(F.getNorth(),F.getWest()),Xe.latLng(q.getLatLng().lat,F.getEast()));break;case 3:D=Xe.latLngBounds(Xe.latLng(F.getNorth(),q.getLatLng().lng),Xe.latLng(F.getSouth(),F.getEast()));break;default:return}N.endResize(D),a.value=null,bi(()=>{a.value=N})};e.value.on("mousemove",V),document.addEventListener("mouseup",Z)}),q});ie.on("mousedown",ee=>{if(!e.value)return;Xe.DomEvent.stopPropagation(ee),e.value.dragging.disable();const G=N.getBounds().getCenter(),q=ee.latlng;N.startResize();const de=wu(Z=>{const F=Z.latlng.lng-q.lng,D=Z.latlng.lat-q.lat,j=Xe.latLng(G.lat+D,G.lng+F),Fe=N.getBounds(),qe=Fe.getEast()-Fe.getWest(),De=Fe.getNorth()-Fe.getSouth(),Je=Xe.latLngBounds(Xe.latLng(j.lat-De/2,j.lng-qe/2),Xe.latLng(j.lat+De/2,j.lng+qe/2));N.updateResizePreview(Je)},16),ce=Z=>de(Z),V=()=>{if(!e.value)return;e.value.off("mousemove",ce),document.removeEventListener("mouseup",V),e.value.dragging.enable();const Z=N.getBounds(),F=Z.getEast()-Z.getWest(),D=Z.getNorth()-Z.getSouth(),j=ie.getLatLng(),Fe=Xe.latLngBounds(Xe.latLng(j.lat-D/2,j.lng-F/2),Xe.latLng(j.lat+D/2,j.lng+F/2));N.endResize(Fe),a.value=null,bi(()=>{a.value=N})};e.value.on("mousemove",ce),document.addEventListener("mouseup",V)}),N.on("resize:update",ee=>{const G=ee.bounds,q=G.getCenter(),de=[G.getNorthWest(),G.getNorthEast(),G.getSouthEast(),G.getSouthWest()].map(V=>ue(V));le.forEach((V,Z)=>{V.setLatLng(de[Z])}),ie.setLatLng(q);const ce=[Xe.latLng((de[0].lat+de[1].lat)/2,(de[0].lng+de[1].lng)/2),Xe.latLng((de[1].lat+de[2].lat)/2,(de[1].lng+de[2].lng)/2),Xe.latLng((de[2].lat+de[3].lat)/2,(de[2].lng+de[3].lng)/2),Xe.latLng((de[3].lat+de[0].lat)/2,(de[3].lng+de[0].lng)/2)].map(V=>ue(V));fe.forEach((V,Z)=>{V.setLatLng(ce[Z])})});const _e=()=>{N.off("edit:start"),N.off("edit:end"),N.off("resize:update")};x.cleanup=_e};return{map:e,featureGroup:t,controlPointsGroup:n,tempControlPointsGroup:i,currentTool:o,selectedShape:a,isDrawing:u,initMap:H,setDrawingTool:Q,updateShapeStyle:se,updateShapeProperties:we,updateTextFixedSize:$,adjustView:I,clearActiveControlPoints:k}}function $L(){const e=Nt(null),t=Nt(""),n=Nt("Ville"),i=Nt(null),o={Ville:Zi.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"© OpenStreetMap contributors",maxZoom:19,updateWhenZooming:!1,updateWhenIdle:!0,noWrap:!0,keepBuffer:5}),Satellite:Zi.tileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",{attribution:"© Esri",maxZoom:19,updateWhenZooming:!1,updateWhenIdle:!0,noWrap:!0,keepBuffer:5}),Cadastre:Zi.tileLayer("https://data.geopf.fr/wmts?SERVICE=WMTS&REQUEST=GetTile&VERSION=1.0.0&LAYER=CADASTRALPARCELS.PARCELLAIRE_EXPRESS&STYLE=normal&FORMAT=image/png&TILEMATRIXSET=PM&TILEMATRIX={z}&TILEROW={y}&TILECOL={x}",{attribution:"Cadastre - Carte © IGN/Geoportail",maxZoom:19,updateWhenZooming:!1,updateWhenIdle:!0,noWrap:!0,keepBuffer:5})};return{map:e,searchQuery:t,currentBaseMap:n,baseMaps:o,initMap:f=>{e.value=f,f.options.zoomSnap=.5,f.options.wheelPxPerZoomLevel=120,f.options.zoomAnimation=!0,i.value=o[n.value],i.value.addTo(f),f.on("baselayerchange",m=>{n.value=m.name,i.value=m.layer})},searchLocation:async()=>{if(!(!e.value||!t.value))try{const m=await(await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(t.value)}`)).json();if(m&&m.length>0){const{lat:y,lon:x}=m[0];e.value.setView([y,x],13,{animate:n.value!=="Cadastre"})}}catch(f){console.error("Erreur lors de la recherche de localisation:",f)}},changeBaseMap:async f=>{if(!(!e.value||!o[f]))try{if(n.value===f)return;const m=e.value.options.zoomAnimation;e.value.options.zoomAnimation=!1;const y=e.value.getCenter(),x=e.value.getZoom();if(i.value&&e.value.hasLayer(i.value)&&e.value.removeLayer(i.value),await new Promise(k=>setTimeout(k,50)),!e.value)return;i.value=o[f],i.value.addTo(e.value),n.value=f,e.value.setView(y,x,{animate:!1}),e.value.invalidateSize({animate:!1,pan:!1}),setTimeout(()=>{e.value&&(e.value.options.zoomAnimation=m&&f!=="Cadastre")},100)}catch(m){console.error("Erreur lors du changement de carte de base:",m),e.value&&(e.value.options.zoomAnimation=!0,e.value.invalidateSize({animate:!1,pan:!1}))}}}}const cp=id("irrigation",{state:()=>({plans:[],currentPlan:null,loading:!1,error:null,autoSaveInterval:null,unsavedChanges:!1,planHistory:[]}),getters:{getPlanById:e=>t=>e.plans.find(n=>n.id===t),hasUnsavedChanges:e=>e.unsavedChanges,getCurrentPlanHistory:e=>e.planHistory},actions:{async fetchPlans(){var t,n;const e=Es();this.loading=!0;try{let i="/plans/";const o={};e.isConcessionnaire?o.concessionnaire=(t=e.user)==null?void 0:t.id:e.isAgriculteur&&(o.agriculteur=(n=e.user)==null?void 0:n.id);const a=await fn.get(i,{params:o});this.plans=a.data}catch(i){throw this.error="Erreur lors du chargement des plans",i}finally{this.loading=!1}},async fetchPlansWithDetails(){var t,n;const e=Es();this.loading=!0;try{let i="/plans/";const o={include_details:!0};e.isConcessionnaire?o.concessionnaire=(t=e.user)==null?void 0:t.id:e.isAgriculteur&&(o.agriculteur=(n=e.user)==null?void 0:n.id),console.log("[IrrigationStore] Fetching plans with params:",o);const a=await fn.get(i,{params:o});console.log("[IrrigationStore] Plans received (raw):",JSON.stringify(a.data,null,2)),a.data.forEach((d,f)=>{console.log(`
[IrrigationStore] Plan ${f+1} (ID: ${d.id||"N/A"}) types:`,{usine:typeof d.usine,concessionnaire:typeof d.concessionnaire,agriculteur:typeof d.agriculteur,usineValue:d.usine,concessionnaireValue:d.concessionnaire,agriculteurValue:d.agriculteur})});const u=a.data.map(d=>{const f={...d,usine:typeof d.usine=="object"?d.usine:null,concessionnaire:typeof d.concessionnaire=="object"?d.concessionnaire:null,agriculteur:typeof d.agriculteur=="object"?d.agriculteur:null};return console.log(`[IrrigationStore] Plan ${d.id} traité:`,{usine:f.usine,concessionnaire:f.concessionnaire,agriculteur:f.agriculteur}),f});return this.plans=u,{data:u}}catch(i){throw console.error("[IrrigationStore] Error fetching plans:",i),this.error="Erreur lors du chargement des plans",i}finally{this.loading=!1}},async fetchClientPlans(e){this.loading=!0;try{return(await ih.getAgriculteurPlans(e)).data}catch(t){throw this.error="Erreur lors du chargement des plans du client",t}finally{this.loading=!1}},async createPlan(e){var n;this.clearCurrentPlan(),this.loading=!0;const t=_c();try{const i=Es();((n=i.user)==null?void 0:n.user_type)==="agriculteur"&&(e={...e,agriculteur:i.user.id,concessionnaire:i.user.concessionnaire,usine:i.user.usine});const o={...e,usine:e.usine?typeof e.usine=="object"&&e.usine&&"id"in e.usine?e.usine.id:Number(e.usine):null,concessionnaire:e.concessionnaire?typeof e.concessionnaire=="object"&&e.concessionnaire&&"id"in e.concessionnaire?e.concessionnaire.id:Number(e.concessionnaire):null,agriculteur:e.agriculteur?typeof e.agriculteur=="object"&&e.agriculteur&&"id"in e.agriculteur?e.agriculteur.id:Number(e.agriculteur):null};console.log("[IrrigationStore] Données formatées pour création:",o);const a=await ih.createPlan(o);return this.plans.push(a.data),t.success(`Le plan "${a.data.nom}" a été créé avec succès`),a.data}catch(i){const o=i instanceof Error?i.message:String(i);throw console.error("Error creating plan:",o),this.error=o,t.error(`Erreur lors de la création du plan : ${o}`),i}finally{this.loading=!1}},async createPlanForClient(e,t){this.clearCurrentPlan(),this.loading=!0;try{const n={...e,agriculteur:t},i=await ih.createPlanForAgriculteur(n);return this.plans.push(i.data),i.data}catch(n){const i=n instanceof Error?n.message:String(n);throw console.error("Error creating plan for client:",i),this.error="Erreur lors de la création du plan pour le client",n}finally{this.loading=!1}},startAutoSave(){this.autoSaveInterval||(this.autoSaveInterval=setInterval(async()=>{this.unsavedChanges&&this.currentPlan&&await this.savePlan(this.currentPlan.id)},3e4))},stopAutoSave(){this.autoSaveInterval&&(clearInterval(this.autoSaveInterval),this.autoSaveInterval=null)},async savePlan(e){var t,n,i;if(!this.unsavedChanges){console.log("[IrrigationStore][savePlan] Aucun changement à sauvegarder");return}console.log("[IrrigationStore][savePlan] Début de la sauvegarde",{planId:e,currentPlan:(t=this.currentPlan)==null?void 0:t.id,hasUnsavedChanges:this.unsavedChanges}),this.loading=!0;try{const o=await fn.patch(`/plans/${e}/`,{...this.currentPlan,version:((n=this.currentPlan)==null?void 0:n.version)||1});console.log("[IrrigationStore][savePlan] Réponse reçue",{status:o.status,data:o.data});const a=this.plans.findIndex(u=>u.id===e);return a!==-1&&(console.log("[IrrigationStore][savePlan] Mise à jour du plan dans la liste",{index:a,oldPlan:this.plans[a],newPlan:o.data}),this.plans[a]=o.data),((i=this.currentPlan)==null?void 0:i.id)===e&&(console.log("[IrrigationStore][savePlan] Mise à jour du plan courant"),this.currentPlan=o.data),this.unsavedChanges=!1,o.data}catch(o){if(console.error("[IrrigationStore][savePlan] ERREUR:",o),console.error("[IrrigationStore][savePlan] Stack trace:",o instanceof Error?o.stack:"No stack trace"),o&&typeof o=="object"&&"response"in o){const a=o;console.error("[IrrigationStore][savePlan] Réponse d'erreur:",{status:a.response.status,statusText:a.response.statusText,data:a.response.data})}throw this.error="Erreur lors de la sauvegarde du plan",o}finally{this.loading=!1}},async updatePlanDetails(e,t){var d;console.log("Mise à jour du plan avec les données:",t);const{agriculteur_id:n,concessionnaire_id:i,usine_id:o,...a}=t,u=_c();try{const f=Es(),m={...a};if(((d=f.user)==null?void 0:d.user_type)==="usine"){if(!i&&!t.concessionnaire)throw new Error("La sélection d'un concessionnaire est obligatoire");if(!n&&!t.agriculteur)throw new Error("La sélection d'un agriculteur est obligatoire")}n!==void 0&&(m.agriculteur_id=n),i!==void 0&&(m.concessionnaire_id=i),o!==void 0&&(m.usine_id=o);const y=await fn.patch(`/plans/${e}/`,m);this.currentPlan&&this.currentPlan.id===e&&(this.currentPlan={...this.currentPlan,...y.data});const x=this.plans.findIndex(k=>k.id===e);return x!==-1&&(this.plans[x]={...this.plans[x],...y.data}),y.data}catch(f){throw console.error("Erreur lors de la mise à jour du plan:",f),u.error(`Erreur lors de la mise à jour du plan : ${f instanceof Error?f.message:String(f)}`),f}},async fetchPlanHistory(e){this.loading=!0;try{const t=await fn.get(`/plans/${e}/historique/`);return this.planHistory=t.data,t.data}catch(t){throw this.error="Erreur lors de la récupération de l'historique",t}finally{this.loading=!1}},async restorePlanVersion(e,t){var n;this.loading=!0;try{const i=await fn.post(`/plans/${e}/restaurer/`,{version_id:t});((n=this.currentPlan)==null?void 0:n.id)===e&&(this.currentPlan=i.data);const o=this.plans.findIndex(a=>a.id===e);return o!==-1&&(this.plans[o]=i.data),i.data}catch(i){throw this.error="Erreur lors de la restauration de la version",i}finally{this.loading=!1}},setCurrentPlan(e){this.currentPlan=e,this.startAutoSave()},clearCurrentPlan(){this.currentPlan=null,this.unsavedChanges=!1,this.autoSaveInterval&&(clearInterval(this.autoSaveInterval),this.autoSaveInterval=null)},markUnsavedChanges(){this.unsavedChanges=!0},async deletePlan(e){var n;this.loading=!0;const t=_c();try{const i=this.plans.find(o=>o.id===e);await ih.deletePlan(e),this.plans=this.plans.filter(o=>o.id!==e),((n=this.currentPlan)==null?void 0:n.id)===e&&this.clearCurrentPlan(),t.success(`Le plan "${(i==null?void 0:i.nom)||""}" a été supprimé avec succès`)}catch(i){throw this.error="Erreur lors de la suppression du plan",t.error(`Erreur lors de la suppression du plan : ${i instanceof Error?i.message:String(i)}`),i}finally{this.loading=!1}}}});function bh(e){return"content"in e&&"bounds"in e}function U1(e){return e&&Array.isArray(e.points)&&e.points.length>0&&Array.isArray(e.points[0])&&e.points[0].length===2}function qL(e){return e&&Array.isArray(e.points)&&e.points.length>0&&Array.isArray(e.points[0])&&e.points[0].length===2}function VL(e){return e&&Array.isArray(e.points)&&e.points.length>0&&Array.isArray(e.points[0])&&e.points[0].length===2}function sg(e){var i,o,a,u,d,f,m,y,x,k,b,T,$,H;console.log("[DrawingStore] Conversion de la forme en élément",{type:(i=e.properties)==null?void 0:i.type,properties:e.properties,bounds:(o=e.getBounds)==null?void 0:o.call(e),shape:e});let t,n;if(e instanceof Bo||((a=e.properties)==null?void 0:a.type)==="TextRectangle"){t="TEXTE";const I=e.getBounds();return n={bounds:{southWest:[I.getSouthWest().lng,I.getSouthWest().lat],northEast:[I.getNorthEast().lng,I.getNorthEast().lat]},content:e.properties.text||"",style:{...e.properties.style,textStyle:{color:((u=e.properties.style.textStyle)==null?void 0:u.color)||"#000000",fontSize:((d=e.properties.style.textStyle)==null?void 0:d.fontSize)||"14px",fontFamily:((f=e.properties.style.textStyle)==null?void 0:f.fontFamily)||"Arial, sans-serif",textAlign:((m=e.properties.style.textStyle)==null?void 0:m.textAlign)||"center",backgroundColor:((y=e.properties.style.textStyle)==null?void 0:y.backgroundColor)||"#FFFFFF",backgroundOpacity:((x=e.properties.style.textStyle)==null?void 0:x.backgroundOpacity)??1,bold:((k=e.properties.style.textStyle)==null?void 0:k.bold)||!1,italic:((b=e.properties.style.textStyle)==null?void 0:b.italic)||!1}},rotation:e.properties.rotation||0},console.log("[DrawingStore] TextRectangle converti",{type_forme:t,data:n,originalProperties:e.properties}),{type_forme:t,data:n}}switch((T=e.properties)==null?void 0:T.type){case"Polygon":t="POLYGON",n={points:e.getLatLngs()[0].map(Be=>[Be.lng,Be.lat]),style:{color:e.properties.style.color||"#3388ff",weight:e.properties.style.weight||3,opacity:e.properties.style.opacity||1,fillColor:e.properties.style.fillColor||"#3388ff",fillOpacity:e.properties.style.fillOpacity||.2,dashArray:e.properties.style.dashArray||""}};break;case"Semicircle":t="DEMI_CERCLE";const Q=e.getCenter?e.getCenter():e.getLatLng();n={center:[Q.lng,Q.lat],radius:e.getRadius(),startAngle:e.properties.startAngle||0,endAngle:e.properties.stopAngle||180,style:{color:e.properties.style.color||"#3388ff",weight:e.properties.style.weight||3,opacity:e.properties.style.opacity||1,fillColor:e.properties.style.fillColor||"#3388ff",fillOpacity:e.properties.style.fillOpacity||.2,dashArray:e.properties.style.dashArray||""}};break;case"ElevationLine":t="ELEVATIONLINE",n={points:e.getLatLngs().map(Be=>[Be.lng,Be.lat]),style:{color:e.properties.style.color||"#FF4500",weight:e.properties.style.weight||4,opacity:e.properties.style.opacity||.8},elevationData:e.getElevationData(),samplePointStyle:e.properties.samplePointStyle,minMaxPointStyle:e.properties.minMaxPointStyle};break;case"Rectangle":t="RECTANGLE",n={bounds:{southWest:[e.getBounds().getSouthWest().lng,e.getBounds().getSouthWest().lat],northEast:[e.getBounds().getNorthEast().lng,e.getBounds().getNorthEast().lat]},rotation:e.getRotation?e.getRotation():0,style:(($=e.properties)==null?void 0:$.style)||{}};break;case"Line":t="LIGNE",n={points:e.getLatLngs().map(Be=>[Be.lng,Be.lat]),style:e.properties.style||{}};break;default:console.warn("[DrawingStore] Type de forme non géré:",(H=e.properties)==null?void 0:H.type),t="UNKNOWN",n={}}return console.log("[DrawingStore] Élément converti",{type_forme:t,data:n}),{type_forme:t,data:n}}function GL(e){var t,n,i,o,a,u,d,f,m,y,x,k,b,T,$,H,I,Q,se,we,Be,$e,Ue,Pe,Te,He,ae,re;switch(console.log("[DrawingStore] Conversion de l'élément stocké en forme",{element:e}),e.type_forme){case"TEXTE":{if(!bh(e.data))return console.error("[DrawingStore] Données invalides pour TextRectangle"),null;const oe=e.data;if(!oe.bounds)return console.error("[DrawingStore] Données de bounds manquantes pour TextRectangle"),null;const Y=new Xe.LatLngBounds(Xe.latLng(oe.bounds.southWest[1],oe.bounds.southWest[0]),Xe.latLng(oe.bounds.northEast[1],oe.bounds.northEast[0])),C={color:((t=oe.style)==null?void 0:t.color)||"#3388ff",fillColor:((n=oe.style)==null?void 0:n.fillColor)||"#3388ff",fillOpacity:((i=oe.style)==null?void 0:i.fillOpacity)||.2,weight:((o=oe.style)==null?void 0:o.weight)||3,opacity:((a=oe.style)==null?void 0:a.opacity)||1,textStyle:{color:((u=oe.style.textStyle)==null?void 0:u.color)||"#000000",fontSize:((d=oe.style.textStyle)==null?void 0:d.fontSize)||"14px",fontFamily:((f=oe.style.textStyle)==null?void 0:f.fontFamily)||"Arial, sans-serif",textAlign:((m=oe.style.textStyle)==null?void 0:m.textAlign)||"center",backgroundColor:((y=oe.style.textStyle)==null?void 0:y.backgroundColor)||"#FFFFFF",backgroundOpacity:((x=oe.style.textStyle)==null?void 0:x.backgroundOpacity)??1,bold:((k=oe.style.textStyle)==null?void 0:k.bold)||!1,italic:((b=oe.style.textStyle)==null?void 0:b.italic)||!1}},N=new Bo(Y,oe.content||"Double-cliquez pour éditer",C);return oe.rotation&&N.setRotation(oe.rotation),N}case"POLYGON":{const oe=e.data;if(!U1(oe))return console.error("[DrawingStore] Données invalides pour Polygon"),null;const Y=oe.points.map(N=>Xe.latLng(N[1],N[0])),C=new Mu([Y],{color:((T=oe.style)==null?void 0:T.color)||"#3388ff",weight:(($=oe.style)==null?void 0:$.weight)||3,opacity:((H=oe.style)==null?void 0:H.opacity)||1,fillColor:((I=oe.style)==null?void 0:I.fillColor)||"#3388ff",fillOpacity:((Q=oe.style)==null?void 0:Q.fillOpacity)||.2,dashArray:((se=oe.style)==null?void 0:se.dashArray)||""});return C.updateProperties(),C}case"ELEVATIONLINE":{const oe=e.data;if(!qL(oe))return console.error("[DrawingStore] Données invalides pour ElevationLine"),null;const Y=oe.points.map(N=>Xe.latLng(N[1],N[0])),C=new eu(Y,{color:((we=oe.style)==null?void 0:we.color)||"#FF4500",weight:((Be=oe.style)==null?void 0:Be.weight)||4,opacity:(($e=oe.style)==null?void 0:$e.opacity)||.8});return oe.samplePointStyle&&C.setSamplePointStyle(oe.samplePointStyle),oe.minMaxPointStyle&&C.setMinMaxPointStyle(oe.minMaxPointStyle),C.updateElevationProfile(),C}case"LIGNE":{const oe=e.data;if(!VL(oe))return console.error("[DrawingStore] Données invalides pour Ligne"),null;const Y=oe.points.map(N=>Xe.latLng(N[1],N[0])),C=new Xi(Y,oe.style);return C.updateProperties(),C}case"DEMI_CERCLE":{const oe=e.data;if(!oe.center||!oe.radius)return console.error("[DrawingStore] Données invalides pour Semicircle"),null;const Y=new nl(Xe.latLng(oe.center[1],oe.center[0]),oe.radius,oe.startAngle,oe.endAngle,oe.style);Y.properties={type:"Semicircle",radius:oe.radius,startAngle:oe.startAngle,stopAngle:oe.endAngle,style:oe.style};const C=Math.PI*Math.pow(oe.radius,2)*((oe.endAngle-oe.startAngle)/360),N=2*oe.radius+Math.PI*oe.radius*((oe.endAngle-oe.startAngle)/180),K=Math.PI*oe.radius*((oe.endAngle-oe.startAngle)/180);return Y.properties.area=C,Y.properties.perimeter=N,Y.properties.arcLength=K,Y.properties.openingAngle=oe.endAngle-oe.startAngle,Y}case"RECTANGLE":{const oe=e.data;if(!oe.bounds)return console.error("[DrawingStore] Données de bounds manquantes pour Rectangle"),null;const Y=new Xe.LatLngBounds(Xe.latLng(oe.bounds.southWest[1],oe.bounds.southWest[0]),Xe.latLng(oe.bounds.northEast[1],oe.bounds.northEast[0])),C=new Xo(Y,{color:((Ue=oe.style)==null?void 0:Ue.color)||"#3388ff",weight:((Pe=oe.style)==null?void 0:Pe.weight)||3,opacity:((Te=oe.style)==null?void 0:Te.opacity)||1,fillColor:((He=oe.style)==null?void 0:He.fillColor)||"#3388ff",fillOpacity:((ae=oe.style)==null?void 0:ae.fillOpacity)||.2,dashArray:((re=oe.style)==null?void 0:re.dashArray)||""});return oe.rotation&&C.setRotation(oe.rotation),C}default:return console.warn("[DrawingStore] Type non géré pour la restauration:",e.type_forme),null}}const $1=id("drawing",{state:()=>({currentPlanId:null,elements:[],selectedElement:null,unsavedChanges:!1,loading:!1,error:null,currentTool:"",currentStyle:{strokeStyle:"solid",strokeWidth:2,strokeColor:"#2563EB",fillColor:"#3B82F6",fillOpacity:.2},lastUsedType:null}),getters:{hasUnsavedChanges:e=>e.unsavedChanges,getCurrentElements:e=>e.elements,getSelectedElement:e=>e.selectedElement,getCurrentTool:e=>e.currentTool,getCurrentStyle:e=>e.currentStyle,getLastUsedType:e=>e.lastUsedType},actions:{setCurrentPlan(e){window.dispatchEvent(new CustomEvent("clearControlPoints")),this.currentPlanId=e,e===null&&this.clearElements(),this.selectedElement=null,this.unsavedChanges=!1,this.currentTool="",this.lastUsedType=null,this.currentStyle={strokeStyle:"solid",strokeWidth:2,strokeColor:"#2563EB",fillColor:"#3B82F6",fillOpacity:.2}},clearCurrentPlan(){this.currentPlanId=null,this.elements=[],this.selectedElement=null,this.unsavedChanges=!1,this.loading=!1,this.error=null},clearElements(){this.elements=[],this.selectedElement=null,this.unsavedChanges=!1,this.error=null},addElement(e){var t;if(console.log("[DrawingStore] Ajout d'un élément",{element:e,isLeafletLayer:e instanceof Xe.Layer,hasProperties:!!e.properties,properties:e.properties,type:(t=e.properties)==null?void 0:t.type}),e instanceof Xe.Layer&&e.properties){const n=sg(e);console.log("[DrawingStore] Élément converti avant ajout",{original:e,converted:n,type:n.type_forme,data:n.data}),this.elements.push(n)}else!e.type_forme&&this.lastUsedType&&(e.type_forme=this.lastUsedType),this.elements.push(e);this.unsavedChanges=!0,console.log("[DrawingStore] État après ajout",{elements:this.elements,unsavedChanges:this.unsavedChanges})},updateElement(e){const t=this.elements.findIndex(n=>n.id===e.id);if(t!==-1){const n=this.elements[t].type_forme;this.elements[t]={...e,type_forme:n},this.unsavedChanges=!0}},removeElement(e){const t=this.elements.findIndex(n=>n.id===e);t!==-1&&(this.elements.splice(t,1),this.unsavedChanges=!0)},selectElement(e){this.selectedElement=e},setCurrentTool(e){this.currentTool=e,["CERCLE","RECTANGLE","DEMI_CERCLE","LIGNE","TEXTE"].includes(e)&&(this.lastUsedType=e)},setCurrentStyle(e){if(!e||Object.keys(e).length===0){this.currentStyle={strokeStyle:"solid",strokeWidth:2,strokeColor:"#2563EB",fillColor:"#3B82F6",fillOpacity:.2};return}this.currentStyle={...this.currentStyle,...e}},async loadPlanElements(e){this.loading=!0;try{console.log("[DrawingStore] Début du chargement du plan",{planId:e});const n=(await fn.get(`/plans/${e}/`)).data;return console.log("[DrawingStore] Données du plan reçues",{formes:n.formes,preferences:n.preferences}),this.elements=n.formes.map(i=>{if(console.log("[DrawingStore] Traitement de la forme stockée",{id:i.id,type_forme:i.type_forme,data:i.data,isTextRectangle:i.type_forme==="TEXTE"||i.data&&bh(i.data)}),i.type_forme)return console.log("[DrawingStore] Forme déjà au format élément",{type_forme:i.type_forme,data:i.data}),{id:i.id,type_forme:i.type_forme,data:i.data||{}};try{const o=GL(i);if(o)return console.log("[DrawingStore] Forme convertie avec succès",{originalType:i.type_forme,convertedType:o.type,properties:o.properties}),sg(o)}catch(o){console.error("[DrawingStore] Erreur lors de la conversion de la forme",{error:o,forme:i})}return console.warn("[DrawingStore] Utilisation de la forme sans conversion",{type_forme:i.type_forme,data:i.data}),i}),console.log(`[DrawingStore] Plan ${e} - Chargé ${this.elements.length} éléments`,{elements:this.elements.map(i=>({id:i.id,type_forme:i.type_forme,isTextRectangle:i.type_forme==="TEXTE"||bh(i.data)}))}),this.currentPlanId=e,this.unsavedChanges=!1,n.preferences&&(console.log("[DrawingStore] Chargement des préférences",n.preferences),n.preferences.currentTool&&this.setCurrentTool(n.preferences.currentTool),n.preferences.currentStyle&&(this.currentStyle={...this.currentStyle,...n.preferences.currentStyle}),n.preferences.lastUsedType&&(this.lastUsedType=n.preferences.lastUsedType)),this.elements}catch(t){throw console.error("[DrawingStore] Erreur lors du chargement des éléments:",t),this.error="Erreur lors du chargement des éléments du plan",t}finally{this.loading=!1}},async saveToPlan(e,t){var n;this.loading=!0;try{const i=e||this.currentPlanId;if(console.log("[DrawingStore][saveToPlan] Début de la sauvegarde",{targetPlanId:i,currentPlanId:this.currentPlanId,elementsCount:this.elements.length,elementsToDelete:t==null?void 0:t.elementsToDelete}),!i)throw new Error("Aucun plan sélectionné pour la sauvegarde");console.log("[DrawingStore][saveToPlan] État des éléments avant sauvegarde:",{elements:this.elements.map(f=>({id:f.id,type_forme:f.type_forme,data:{hasPoints:"points"in f.data,points:"points"in f.data?f.data.points:null,hasBounds:"bounds"in f.data,bounds:"bounds"in f.data?f.data.bounds:null,hasContent:"content"in f.data,content:"content"in f.data?f.data.content:null,style:f.data.style}}))});const o=this.elements.map(f=>(console.log("[DrawingStore][saveToPlan] Préparation élément pour sauvegarde",{id:f.id,type_forme:f.type_forme,isTextRectangle:f.type_forme==="TEXTE"||f.type_forme==="POLYGON"||bh(f.data)||U1(f.data),dataType:f.data?Object.keys(f.data):null,dataContent:f.data}),{...f,type_forme:f.type_forme||this.lastUsedType})),a=(t==null?void 0:t.elementsToDelete)||[],u=`/plans/${i}/save_with_elements/`;console.log("[DrawingStore][saveToPlan] Préparation requête API",{url:u,method:"POST",formesCount:o.length,elementsToDeleteCount:a.length});const d=await fn.post(u,{formes:o,connexions:[],annotations:[],elementsToDelete:a,preferences:{currentTool:this.currentTool,currentStyle:this.currentStyle,lastUsedType:this.lastUsedType}});return console.log("[DrawingStore][saveToPlan] Réponse reçue",{status:d.status,formesCount:(n=d.data.formes)==null?void 0:n.length,data:d.data}),this.elements=d.data.formes.map(f=>(console.log("[DrawingStore][saveToPlan] Mise à jour élément après sauvegarde",{forme:f,type_forme:f.type_forme}),{...f,type_forme:f.type_forme})),this.unsavedChanges=!1,d.data}catch(i){throw console.error("[DrawingStore][saveToPlan] ERREUR:",i),console.error("[DrawingStore][saveToPlan] Stack trace:",i instanceof Error?i.stack:"No stack trace"),this.error="Erreur lors de la sauvegarde du plan",i}finally{this.loading=!1}}}}),HL={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[4000]"},WL={class:"bg-white rounded-lg p-6 max-w-2xl w-full mx-4"},ZL={key:0,class:"mb-4"},KL={key:0,class:"animate-pulse"},YL=["value"],JL={key:1,class:"mb-4"},XL={key:0,class:"animate-pulse"},QL=["disabled"],eC={value:null},tC=["value"],nC={key:2,class:"mb-4"},iC={key:0,class:"animate-pulse"},rC=["disabled"],sC={value:null},oC=["value"],aC={class:"mb-4"},lC={class:"mb-6"},uC={class:"flex justify-end space-x-3"},cC=["disabled"],hC={key:0},dC={key:1},q1=Hs({__name:"NewPlanModal",props:{modelValue:{type:Boolean}},emits:["update:modelValue","created","concessionnaireSelected","clientSelected"],setup(e,{expose:t,emit:n}){function i(oe){return oe?typeof oe=="object"?oe.id:oe:null}function o(oe){if(oe===null)throw new Error("Invalid ID");return oe}const a=e,u=n,d=Es(),f=cp(),m=$1(),y=Nt(!1),x=Nt(null),k=Nt([]),b=Nt([]),T=Nt([]),$=Nt(null),H=Nt(null),I=Nt(!1),Q=Nt(!1),se=Nt(!1),we=Nt({nom:"",description:"",usine:null,concessionnaire:null,client:null}),Be=Un(()=>{var oe,Y,C;return((oe=d.user)==null?void 0:oe.user_type)==="admin"?we.value.nom.trim()&&we.value.usine&&we.value.concessionnaire&&we.value.client:((Y=d.user)==null?void 0:Y.user_type)==="usine"?we.value.nom.trim()&&we.value.concessionnaire&&we.value.client:((C=d.user)==null?void 0:C.user_type)==="concessionnaire"?we.value.nom.trim()&&we.value.client:we.value.nom.trim()});Ki(()=>we.value.usine,async oe=>{if(!a.modelValue)return;we.value.concessionnaire=null,we.value.client=null,b.value=[];const Y=i(oe);Y?await $e(Y):k.value=[]}),Ki(()=>we.value.concessionnaire,async oe=>{if(!a.modelValue)return;we.value.client=null;const Y=i(oe);Y?await Ue(Y):b.value=[]}),Ki(()=>a.modelValue,oe=>{var Y,C,N;oe?((Y=d.user)==null?void 0:Y.user_type)==="admin"?ae():((C=d.user)==null?void 0:C.user_type)==="usine"?$e(d.user.id):((N=d.user)==null?void 0:N.user_type)==="concessionnaire"&&Ue(d.user.id):(we.value={nom:"",description:"",usine:null,concessionnaire:null,client:null},$.value=null,H.value=null,b.value=[],k.value=[],T.value=[],x.value=null)});async function $e(oe){I.value=!0;try{if(oe)k.value=await d.fetchUsineConcessionnaires(oe);else{const Y=await uo.getConcessionnaires();k.value=Y.data}}catch(Y){console.error("[NewPlanModal] Error loading concessionnaires:",Y),k.value=[]}finally{I.value=!1}}async function Ue(oe){Q.value=!0;try{b.value=await d.fetchConcessionnaireAgriculteurs(oe)}catch(Y){console.error("[NewPlanModal] Error loading clients:",Y),b.value=[]}finally{Q.value=!1}}async function Pe(oe){a.modelValue&&($.value=oe,we.value.concessionnaire=oe.id,await Ue(oe.id),u("concessionnaireSelected",oe))}function Te(oe){a.modelValue&&(H.value=oe,we.value.client=oe.id,u("clientSelected",oe))}function He(){u("update:modelValue",!1),we.value={nom:"",description:"",usine:null,concessionnaire:null,client:null},$.value=null,H.value=null,b.value=[],x.value=null}async function ae(){se.value=!0;try{T.value=await d.fetchUsines()}catch(oe){console.error("[NewPlanModal] Error loading usines:",oe),T.value=[]}finally{se.value=!1}}async function re(){var oe,Y;x.value=null,y.value=!0;try{const C={nom:we.value.nom.trim(),description:we.value.description.trim()},N=d.user;if(!N)throw new Error("User not found");if(N.user_type==="admin"){if(!we.value.usine||!we.value.concessionnaire||!we.value.client)throw new Error("Missing required fields");C.usine=o(i(we.value.usine)),C.concessionnaire=o(i(we.value.concessionnaire)),C.agriculteur=we.value.client}else if(N.user_type==="usine"){if(!we.value.concessionnaire||!we.value.client)throw new Error("Missing required fields");C.usine=N.id,C.concessionnaire=o(i(we.value.concessionnaire)),C.agriculteur=we.value.client}else if(N.user_type==="concessionnaire"){if(!N.usine||!we.value.client)throw new Error("Missing required fields");C.usine=o(i(N.usine)),C.concessionnaire=N.id,C.agriculteur=we.value.client}else if(N.user_type==="agriculteur"){if(!N.usine||!N.concessionnaire)throw new Error("Missing required fields");C.usine=o(i(N.usine)),C.concessionnaire=o(i(N.concessionnaire)),C.agriculteur=N.id}console.log("Données du plan à créer:",C),f.clearCurrentPlan(),m.setCurrentPlan(null);const K=await f.createPlan(C);u("created",K.id),He()}catch(C){console.error("[NewPlanModal] Error creating plan:",C),console.error("Response data:",(oe=C.response)==null?void 0:oe.data);let N="Une erreur est survenue lors de la création du plan";(Y=C.response)!=null&&Y.data&&(typeof C.response.data=="object"?N=Object.entries(C.response.data).map(([K,J])=>Array.isArray(J)?`${K}: ${J.join(", ")}`:`${K}: ${J}`).join(`
`):typeof C.response.data=="string"&&(N=C.response.data)),x.value=N}finally{y.value=!1}}return t({concessionnaires:k,concessionnaireClients:b,selectedConcessionnaire:$,selectedClient:H,loadConcessionnaires:$e,loadConcessionnaireClients:Ue,selectConcessionnaire:Pe,selectClient:Te}),(oe,Y)=>{var C,N,K,J;return oe.modelValue?(je(),ze("div",HL,[A("div",WL,[A("div",{class:"flex justify-between items-center mb-4"},[Y[6]||(Y[6]=A("h2",{class:"text-xl font-semibold text-gray-900"},"Créer un nouveau plan",-1)),A("button",{onClick:He,class:"text-gray-400 hover:text-gray-500"},Y[5]||(Y[5]=[A("svg",{class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),vn(d).isAdmin?(je(),ze("div",ZL,[Y[9]||(Y[9]=A("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Usine",-1)),se.value?(je(),ze("div",KL,Y[7]||(Y[7]=[A("div",{class:"h-10 bg-gray-200 rounded"},null,-1)]))):cn((je(),ze("select",{key:1,"onUpdate:modelValue":Y[0]||(Y[0]=Ee=>we.value.usine=Ee),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500"},[Y[8]||(Y[8]=A("option",{value:null},"Sélectionnez une usine",-1)),(je(!0),ze(Qt,null,Mn(T.value,Ee=>(je(),ze("option",{key:Ee.id,value:Ee.id},Tt(vn(co)(Ee)),9,YL))),128))],512)),[[vr,we.value.usine]])])):Zt("",!0),((C=vn(d).user)==null?void 0:C.user_type)==="admin"||((N=vn(d).user)==null?void 0:N.user_type)==="usine"?(je(),ze("div",JL,[Y[11]||(Y[11]=A("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Concessionnaire",-1)),I.value?(je(),ze("div",XL,Y[10]||(Y[10]=[A("div",{class:"h-10 bg-gray-200 rounded"},null,-1)]))):cn((je(),ze("select",{key:1,id:"edit-concessionnaire","onUpdate:modelValue":Y[1]||(Y[1]=Ee=>we.value.concessionnaire=Ee),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",disabled:!k.value.length||vn(d).isAdmin&&!we.value.usine},[A("option",eC,Tt(k.value.length?"Sélectionnez un concessionnaire":"Aucun concessionnaire disponible"),1),(je(!0),ze(Qt,null,Mn(k.value,Ee=>(je(),ze("option",{key:Ee.id,value:Ee.id},Tt(vn(co)(Ee)),9,tC))),128))],8,QL)),[[vr,we.value.concessionnaire]])])):Zt("",!0),((K=vn(d).user)==null?void 0:K.user_type)!=="agriculteur"?(je(),ze("div",nC,[Y[13]||(Y[13]=A("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Agriculteur",-1)),Q.value?(je(),ze("div",iC,Y[12]||(Y[12]=[A("div",{class:"h-10 bg-gray-200 rounded"},null,-1)]))):cn((je(),ze("select",{key:1,id:"edit-agriculteur","onUpdate:modelValue":Y[2]||(Y[2]=Ee=>we.value.client=Ee),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",disabled:!b.value.length||((J=vn(d).user)==null?void 0:J.user_type)!=="concessionnaire"&&!we.value.concessionnaire},[A("option",sC,Tt(b.value.length?"Sélectionnez un agriculteur":"Aucun agriculteur disponible"),1),(je(!0),ze(Qt,null,Mn(b.value,Ee=>(je(),ze("option",{key:Ee.id,value:Ee.id},Tt(vn(co)(Ee)),9,oC))),128))],8,rC)),[[vr,we.value.client]])])):Zt("",!0),A("div",aC,[Y[14]||(Y[14]=A("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Nom du plan",-1)),cn(A("input",{id:"edit-nom","onUpdate:modelValue":Y[3]||(Y[3]=Ee=>we.value.nom=Ee),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"Entrez le nom du plan"},null,512),[[Kn,we.value.nom]])]),A("div",lC,[Y[15]||(Y[15]=A("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Description",-1)),cn(A("textarea",{id:"edit-description","onUpdate:modelValue":Y[4]||(Y[4]=Ee=>we.value.description=Ee),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",rows:"3",placeholder:"Entrez une description (optionnel)"},null,512),[[Kn,we.value.description]])]),A("div",uC,[A("button",{onClick:He,class:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-primary-500"}," Annuler "),A("button",{onClick:re,class:"px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500",disabled:!Be.value||y.value},[y.value?(je(),ze("span",hC,"Création en cours...")):(je(),ze("span",dC,"Créer"))],8,cC)])])])):Zt("",!0)}}});function yi(e){"@babel/helpers - typeof";return yi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yi(e)}var hs=Uint8Array,fo=Uint16Array,hp=Int32Array,fd=new hs([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),pd=new hs([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Mf=new hs([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),V1=function(e,t){for(var n=new fo(31),i=0;i<31;++i)n[i]=t+=1<<e[i-1];for(var o=new hp(n[30]),i=1;i<30;++i)for(var a=n[i];a<n[i+1];++a)o[a]=a-n[i]<<5|i;return{b:n,r:o}},G1=V1(fd,2),H1=G1.b,Bf=G1.r;H1[28]=258,Bf[258]=28;var W1=V1(pd,0),fC=W1.b,og=W1.r,Tf=new fo(32768);for(var Ri=0;Ri<32768;++Ri){var bl=(Ri&43690)>>1|(Ri&21845)<<1;bl=(bl&52428)>>2|(bl&13107)<<2,bl=(bl&61680)>>4|(bl&3855)<<4,Tf[Ri]=((bl&65280)>>8|(bl&255)<<8)>>1}var Ba=function(e,t,n){for(var i=e.length,o=0,a=new fo(t);o<i;++o)e[o]&&++a[e[o]-1];var u=new fo(t);for(o=1;o<t;++o)u[o]=u[o-1]+a[o-1]<<1;var d;if(n){d=new fo(1<<t);var f=15-t;for(o=0;o<i;++o)if(e[o])for(var m=o<<4|e[o],y=t-e[o],x=u[e[o]-1]++<<y,k=x|(1<<y)-1;x<=k;++x)d[Tf[x]>>f]=m}else for(d=new fo(i),o=0;o<i;++o)e[o]&&(d[o]=Tf[u[e[o]-1]++]>>15-e[o]);return d},Dl=new hs(288);for(var Ri=0;Ri<144;++Ri)Dl[Ri]=8;for(var Ri=144;Ri<256;++Ri)Dl[Ri]=9;for(var Ri=256;Ri<280;++Ri)Dl[Ri]=7;for(var Ri=280;Ri<288;++Ri)Dl[Ri]=8;var Dc=new hs(32);for(var Ri=0;Ri<32;++Ri)Dc[Ri]=5;var pC=Ba(Dl,9,0),gC=Ba(Dl,9,1),mC=Ba(Dc,5,0),vC=Ba(Dc,5,1),Hd=function(e){for(var t=e[0],n=1;n<e.length;++n)e[n]>t&&(t=e[n]);return t},Yo=function(e,t,n){var i=t/8|0;return(e[i]|e[i+1]<<8)>>(t&7)&n},Wd=function(e,t){var n=t/8|0;return(e[n]|e[n+1]<<8|e[n+2]<<16)>>(t&7)},dp=function(e){return(e+7)/8|0},Z1=function(e,t,n){return(n==null||n>e.length)&&(n=e.length),new hs(e.subarray(t,n))},yC=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Qo=function(e,t,n){var i=new Error(t||yC[e]);if(i.code=e,Error.captureStackTrace&&Error.captureStackTrace(i,Qo),!n)throw i;return i},_C=function(e,t,n,i){var o=e.length,a=0;if(!o||t.f&&!t.l)return n||new hs(0);var u=!n,d=u||t.i!=2,f=t.i;u&&(n=new hs(o*3));var m=function(ce){var V=n.length;if(ce>V){var Z=new hs(Math.max(V*2,ce));Z.set(n),n=Z}},y=t.f||0,x=t.p||0,k=t.b||0,b=t.l,T=t.d,$=t.m,H=t.n,I=o*8;do{if(!b){y=Yo(e,x,1);var Q=Yo(e,x+1,3);if(x+=3,Q)if(Q==1)b=gC,T=vC,$=9,H=5;else if(Q==2){var $e=Yo(e,x,31)+257,Ue=Yo(e,x+10,15)+4,Pe=$e+Yo(e,x+5,31)+1;x+=14;for(var Te=new hs(Pe),He=new hs(19),ae=0;ae<Ue;++ae)He[Mf[ae]]=Yo(e,x+ae*3,7);x+=Ue*3;for(var re=Hd(He),oe=(1<<re)-1,Y=Ba(He,re,1),ae=0;ae<Pe;){var C=Y[Yo(e,x,oe)];x+=C&15;var se=C>>4;if(se<16)Te[ae++]=se;else{var N=0,K=0;for(se==16?(K=3+Yo(e,x,3),x+=2,N=Te[ae-1]):se==17?(K=3+Yo(e,x,7),x+=3):se==18&&(K=11+Yo(e,x,127),x+=7);K--;)Te[ae++]=N}}var J=Te.subarray(0,$e),Ee=Te.subarray($e);$=Hd(J),H=Hd(Ee),b=Ba(J,$,1),T=Ba(Ee,H,1)}else Qo(1);else{var se=dp(x)+4,we=e[se-4]|e[se-3]<<8,Be=se+we;if(Be>o){f&&Qo(0);break}d&&m(k+we),n.set(e.subarray(se,Be),k),t.b=k+=we,t.p=x=Be*8,t.f=y;continue}if(x>I){f&&Qo(0);break}}d&&m(k+131072);for(var ue=(1<<$)-1,ye=(1<<H)-1,O=x;;O=x){var N=b[Wd(e,x)&ue],ie=N>>4;if(x+=N&15,x>I){f&&Qo(0);break}if(N||Qo(2),ie<256)n[k++]=ie;else if(ie==256){O=x,b=null;break}else{var le=ie-254;if(ie>264){var ae=ie-257,fe=fd[ae];le=Yo(e,x,(1<<fe)-1)+H1[ae],x+=fe}var _e=T[Wd(e,x)&ye],ee=_e>>4;_e||Qo(3),x+=_e&15;var Ee=fC[ee];if(ee>3){var fe=pd[ee];Ee+=Wd(e,x)&(1<<fe)-1,x+=fe}if(x>I){f&&Qo(0);break}d&&m(k+131072);var G=k+le;if(k<Ee){var q=a-Ee,de=Math.min(Ee,G);for(q+k<0&&Qo(3);k<de;++k)n[k]=i[q+k]}for(;k<G;++k)n[k]=n[k-Ee]}}t.l=b,t.p=O,t.b=k,t.f=y,b&&(y=1,t.m=$,t.d=T,t.n=H)}while(!y);return k!=n.length&&u?Z1(n,0,k):n.subarray(0,k)},Ja=function(e,t,n){n<<=t&7;var i=t/8|0;e[i]|=n,e[i+1]|=n>>8},sc=function(e,t,n){n<<=t&7;var i=t/8|0;e[i]|=n,e[i+1]|=n>>8,e[i+2]|=n>>16},Zd=function(e,t){for(var n=[],i=0;i<e.length;++i)e[i]&&n.push({s:i,f:e[i]});var o=n.length,a=n.slice();if(!o)return{t:Y1,l:0};if(o==1){var u=new hs(n[0].s+1);return u[n[0].s]=1,{t:u,l:1}}n.sort(function(Be,$e){return Be.f-$e.f}),n.push({s:-1,f:25001});var d=n[0],f=n[1],m=0,y=1,x=2;for(n[0]={s:-1,f:d.f+f.f,l:d,r:f};y!=o-1;)d=n[n[m].f<n[x].f?m++:x++],f=n[m!=y&&n[m].f<n[x].f?m++:x++],n[y++]={s:-1,f:d.f+f.f,l:d,r:f};for(var k=a[0].s,i=1;i<o;++i)a[i].s>k&&(k=a[i].s);var b=new fo(k+1),T=Nf(n[y-1],b,0);if(T>t){var i=0,$=0,H=T-t,I=1<<H;for(a.sort(function($e,Ue){return b[Ue.s]-b[$e.s]||$e.f-Ue.f});i<o;++i){var Q=a[i].s;if(b[Q]>t)$+=I-(1<<T-b[Q]),b[Q]=t;else break}for($>>=H;$>0;){var se=a[i].s;b[se]<t?$-=1<<t-b[se]++-1:++i}for(;i>=0&&$;--i){var we=a[i].s;b[we]==t&&(--b[we],++$)}T=t}return{t:new hs(b),l:T}},Nf=function(e,t,n){return e.s==-1?Math.max(Nf(e.l,t,n+1),Nf(e.r,t,n+1)):t[e.s]=n},ag=function(e){for(var t=e.length;t&&!e[--t];);for(var n=new fo(++t),i=0,o=e[0],a=1,u=function(f){n[i++]=f},d=1;d<=t;++d)if(e[d]==o&&d!=t)++a;else{if(!o&&a>2){for(;a>138;a-=138)u(32754);a>2&&(u(a>10?a-11<<5|28690:a-3<<5|12305),a=0)}else if(a>3){for(u(o),--a;a>6;a-=6)u(8304);a>2&&(u(a-3<<5|8208),a=0)}for(;a--;)u(o);a=1,o=e[d]}return{c:n.subarray(0,i),n:t}},oc=function(e,t){for(var n=0,i=0;i<t.length;++i)n+=e[i]*t[i];return n},K1=function(e,t,n){var i=n.length,o=dp(t+2);e[o]=i&255,e[o+1]=i>>8,e[o+2]=e[o]^255,e[o+3]=e[o+1]^255;for(var a=0;a<i;++a)e[o+a+4]=n[a];return(o+4+i)*8},lg=function(e,t,n,i,o,a,u,d,f,m,y){Ja(t,y++,n),++o[256];for(var x=Zd(o,15),k=x.t,b=x.l,T=Zd(a,15),$=T.t,H=T.l,I=ag(k),Q=I.c,se=I.n,we=ag($),Be=we.c,$e=we.n,Ue=new fo(19),Pe=0;Pe<Q.length;++Pe)++Ue[Q[Pe]&31];for(var Pe=0;Pe<Be.length;++Pe)++Ue[Be[Pe]&31];for(var Te=Zd(Ue,7),He=Te.t,ae=Te.l,re=19;re>4&&!He[Mf[re-1]];--re);var oe=m+5<<3,Y=oc(o,Dl)+oc(a,Dc)+u,C=oc(o,k)+oc(a,$)+u+14+3*re+oc(Ue,He)+2*Ue[16]+3*Ue[17]+7*Ue[18];if(f>=0&&oe<=Y&&oe<=C)return K1(t,y,e.subarray(f,f+m));var N,K,J,Ee;if(Ja(t,y,1+(C<Y)),y+=2,C<Y){N=Ba(k,b,0),K=k,J=Ba($,H,0),Ee=$;var ue=Ba(He,ae,0);Ja(t,y,se-257),Ja(t,y+5,$e-1),Ja(t,y+10,re-4),y+=14;for(var Pe=0;Pe<re;++Pe)Ja(t,y+3*Pe,He[Mf[Pe]]);y+=3*re;for(var ye=[Q,Be],O=0;O<2;++O)for(var ie=ye[O],Pe=0;Pe<ie.length;++Pe){var le=ie[Pe]&31;Ja(t,y,ue[le]),y+=He[le],le>15&&(Ja(t,y,ie[Pe]>>5&127),y+=ie[Pe]>>12)}}else N=pC,K=Dl,J=mC,Ee=Dc;for(var Pe=0;Pe<d;++Pe){var fe=i[Pe];if(fe>255){var le=fe>>18&31;sc(t,y,N[le+257]),y+=K[le+257],le>7&&(Ja(t,y,fe>>23&31),y+=fd[le]);var _e=fe&31;sc(t,y,J[_e]),y+=Ee[_e],_e>3&&(sc(t,y,fe>>5&8191),y+=pd[_e])}else sc(t,y,N[fe]),y+=K[fe]}return sc(t,y,N[256]),y+K[256]},bC=new hp([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Y1=new hs(0),wC=function(e,t,n,i,o,a){var u=a.z||e.length,d=new hs(i+u+5*(1+Math.ceil(u/7e3))+o),f=d.subarray(i,d.length-o),m=a.l,y=(a.r||0)&7;if(t){y&&(f[0]=a.r>>3);for(var x=bC[t-1],k=x>>13,b=x&8191,T=(1<<n)-1,$=a.p||new fo(32768),H=a.h||new fo(T+1),I=Math.ceil(n/3),Q=2*I,se=function(F){return(e[F]^e[F+1]<<I^e[F+2]<<Q)&T},we=new hp(25e3),Be=new fo(288),$e=new fo(32),Ue=0,Pe=0,Te=a.i||0,He=0,ae=a.w||0,re=0;Te+2<u;++Te){var oe=se(Te),Y=Te&32767,C=H[oe];if($[Y]=C,H[oe]=Y,ae<=Te){var N=u-Te;if((Ue>7e3||He>24576)&&(N>423||!m)){y=lg(e,f,0,we,Be,$e,Pe,He,re,Te-re,y),He=Ue=Pe=0,re=Te;for(var K=0;K<286;++K)Be[K]=0;for(var K=0;K<30;++K)$e[K]=0}var J=2,Ee=0,ue=b,ye=Y-C&32767;if(N>2&&oe==se(Te-ye))for(var O=Math.min(k,N)-1,ie=Math.min(32767,Te),le=Math.min(258,N);ye<=ie&&--ue&&Y!=C;){if(e[Te+J]==e[Te+J-ye]){for(var fe=0;fe<le&&e[Te+fe]==e[Te+fe-ye];++fe);if(fe>J){if(J=fe,Ee=ye,fe>O)break;for(var _e=Math.min(ye,fe-2),ee=0,K=0;K<_e;++K){var G=Te-ye+K&32767,q=$[G],de=G-q&32767;de>ee&&(ee=de,C=G)}}}Y=C,C=$[Y],ye+=Y-C&32767}if(Ee){we[He++]=268435456|Bf[J]<<18|og[Ee];var ce=Bf[J]&31,V=og[Ee]&31;Pe+=fd[ce]+pd[V],++Be[257+ce],++$e[V],ae=Te+J,++Ue}else we[He++]=e[Te],++Be[e[Te]]}}for(Te=Math.max(Te,ae);Te<u;++Te)we[He++]=e[Te],++Be[e[Te]];y=lg(e,f,m,we,Be,$e,Pe,He,re,Te-re,y),m||(a.r=y&7|f[y/8|0]<<3,y-=7,a.h=H,a.p=$,a.i=Te,a.w=ae)}else{for(var Te=a.w||0;Te<u+m;Te+=65535){var Z=Te+65535;Z>=u&&(f[y/8|0]=m,Z=u),y=K1(f,y+1,e.subarray(Te,Z))}a.i=u}return Z1(d,0,i+dp(y)+o)},J1=function(){var e=1,t=0;return{p:function(n){for(var i=e,o=t,a=n.length|0,u=0;u!=a;){for(var d=Math.min(u+2655,a);u<d;++u)o+=i+=n[u];i=(i&65535)+15*(i>>16),o=(o&65535)+15*(o>>16)}e=i,t=o},d:function(){return e%=65521,t%=65521,(e&255)<<24|(e&65280)<<8|(t&255)<<8|t>>8}}},xC=function(e,t,n,i,o){if(!o&&(o={l:1},t.dictionary)){var a=t.dictionary.subarray(-32768),u=new hs(a.length+e.length);u.set(a),u.set(e,a.length),e=u,o.w=a.length}return wC(e,t.level==null?6:t.level,t.mem==null?o.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+t.mem,n,i,o)},X1=function(e,t,n){for(;n;++t)e[t]=n,n>>>=8},LC=function(e,t){var n=t.level,i=n==0?0:n<6?1:n==9?3:2;if(e[0]=120,e[1]=i<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var o=J1();o.p(t.dictionary),X1(e,2,o.d())}},CC=function(e,t){return((e[0]&15)!=8||e[0]>>4>7||(e[0]<<8|e[1])%31)&&Qo(6,"invalid zlib data"),(e[1]>>5&1)==1&&Qo(6,"invalid zlib data: "+(e[1]&32?"need":"unexpected")+" dictionary"),(e[1]>>3&4)+2};function Df(e,t){t||(t={});var n=J1();n.p(e);var i=xC(e,t,t.dictionary?6:2,4);return LC(i,t),X1(i,i.length-4,n.d()),i}function PC(e,t){return _C(e.subarray(CC(e),-4),{i:2},t,t)}var kC=typeof TextDecoder<"u"&&new TextDecoder,EC=0;try{kC.decode(Y1,{stream:!0}),EC=1}catch{}var Sn=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function Kd(){Sn.console&&typeof Sn.console.log=="function"&&Sn.console.log.apply(Sn.console,arguments)}var Li={log:Kd,warn:function(e){Sn.console&&(typeof Sn.console.warn=="function"?Sn.console.warn.apply(Sn.console,arguments):Kd.call(null,arguments))},error:function(e){Sn.console&&(typeof Sn.console.error=="function"?Sn.console.error.apply(Sn.console,arguments):Kd(e))}};function Yd(e,t,n){var i=new XMLHttpRequest;i.open("GET",e),i.responseType="blob",i.onload=function(){Kl(i.response,t,n)},i.onerror=function(){Li.error("could not download file")},i.send()}function ug(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function sh(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var wc,Rf,Kl=Sn.saveAs||((typeof window>"u"?"undefined":yi(window))!=="object"||window!==Sn?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(e,t,n){var i=Sn.URL||Sn.webkitURL,o=document.createElement("a");t=t||e.name||"download",o.download=t,o.rel="noopener",typeof e=="string"?(o.href=e,o.origin!==location.origin?ug(o.href)?Yd(e,t,n):sh(o,o.target="_blank"):sh(o)):(o.href=i.createObjectURL(e),setTimeout(function(){i.revokeObjectURL(o.href)},4e4),setTimeout(function(){sh(o)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,n){if(t=t||e.name||"download",typeof e=="string")if(ug(e))Yd(e,t,n);else{var i=document.createElement("a");i.href=e,i.target="_blank",setTimeout(function(){sh(i)})}else navigator.msSaveOrOpenBlob(function(o,a){return a===void 0?a={autoBom:!1}:yi(a)!=="object"&&(Li.warn("Deprecated: Expected third argument to be a object"),a={autoBom:!a}),a.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(o.type)?new Blob(["\uFEFF",o],{type:o.type}):o}(e,n),t)}:function(e,t,n,i){if((i=i||open("","_blank"))&&(i.document.title=i.document.body.innerText="downloading..."),typeof e=="string")return Yd(e,t,n);var o=e.type==="application/octet-stream",a=/constructor/i.test(Sn.HTMLElement)||Sn.safari,u=/CriOS\/[\d]+/.test(navigator.userAgent);if((u||o&&a)&&(typeof FileReader>"u"?"undefined":yi(FileReader))==="object"){var d=new FileReader;d.onloadend=function(){var y=d.result;y=u?y:y.replace(/^data:[^;]*;/,"data:attachment/file;"),i?i.location.href=y:location=y,i=null},d.readAsDataURL(e)}else{var f=Sn.URL||Sn.webkitURL,m=f.createObjectURL(e);i?i.location=m:location.href=m,i=null,setTimeout(function(){f.revokeObjectURL(m)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function Q1(e){var t;e=e||"",this.ok=!1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var n=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(d){return[parseInt(d[1]),parseInt(d[2]),parseInt(d[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(d){return[parseInt(d[1],16),parseInt(d[2],16),parseInt(d[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(d){return[parseInt(d[1]+d[1],16),parseInt(d[2]+d[2],16),parseInt(d[3]+d[3],16)]}}],i=0;i<n.length;i++){var o=n[i].re,a=n[i].process,u=o.exec(e);u&&(t=a(u),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var d=this.r.toString(16),f=this.g.toString(16),m=this.b.toString(16);return d.length==1&&(d="0"+d),f.length==1&&(f="0"+f),m.length==1&&(m="0"+m),"#"+d+f+m}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function Jd(e,t){var n=e[0],i=e[1],o=e[2],a=e[3];n=rs(n,i,o,a,t[0],7,-680876936),a=rs(a,n,i,o,t[1],12,-389564586),o=rs(o,a,n,i,t[2],17,606105819),i=rs(i,o,a,n,t[3],22,-1044525330),n=rs(n,i,o,a,t[4],7,-176418897),a=rs(a,n,i,o,t[5],12,1200080426),o=rs(o,a,n,i,t[6],17,-1473231341),i=rs(i,o,a,n,t[7],22,-45705983),n=rs(n,i,o,a,t[8],7,1770035416),a=rs(a,n,i,o,t[9],12,-1958414417),o=rs(o,a,n,i,t[10],17,-42063),i=rs(i,o,a,n,t[11],22,-1990404162),n=rs(n,i,o,a,t[12],7,1804603682),a=rs(a,n,i,o,t[13],12,-40341101),o=rs(o,a,n,i,t[14],17,-1502002290),n=ss(n,i=rs(i,o,a,n,t[15],22,1236535329),o,a,t[1],5,-165796510),a=ss(a,n,i,o,t[6],9,-1069501632),o=ss(o,a,n,i,t[11],14,643717713),i=ss(i,o,a,n,t[0],20,-373897302),n=ss(n,i,o,a,t[5],5,-701558691),a=ss(a,n,i,o,t[10],9,38016083),o=ss(o,a,n,i,t[15],14,-660478335),i=ss(i,o,a,n,t[4],20,-405537848),n=ss(n,i,o,a,t[9],5,568446438),a=ss(a,n,i,o,t[14],9,-1019803690),o=ss(o,a,n,i,t[3],14,-187363961),i=ss(i,o,a,n,t[8],20,1163531501),n=ss(n,i,o,a,t[13],5,-1444681467),a=ss(a,n,i,o,t[2],9,-51403784),o=ss(o,a,n,i,t[7],14,1735328473),n=os(n,i=ss(i,o,a,n,t[12],20,-1926607734),o,a,t[5],4,-378558),a=os(a,n,i,o,t[8],11,-2022574463),o=os(o,a,n,i,t[11],16,1839030562),i=os(i,o,a,n,t[14],23,-35309556),n=os(n,i,o,a,t[1],4,-1530992060),a=os(a,n,i,o,t[4],11,1272893353),o=os(o,a,n,i,t[7],16,-155497632),i=os(i,o,a,n,t[10],23,-1094730640),n=os(n,i,o,a,t[13],4,681279174),a=os(a,n,i,o,t[0],11,-358537222),o=os(o,a,n,i,t[3],16,-722521979),i=os(i,o,a,n,t[6],23,76029189),n=os(n,i,o,a,t[9],4,-640364487),a=os(a,n,i,o,t[12],11,-421815835),o=os(o,a,n,i,t[15],16,530742520),n=as(n,i=os(i,o,a,n,t[2],23,-995338651),o,a,t[0],6,-198630844),a=as(a,n,i,o,t[7],10,1126891415),o=as(o,a,n,i,t[14],15,-1416354905),i=as(i,o,a,n,t[5],21,-57434055),n=as(n,i,o,a,t[12],6,1700485571),a=as(a,n,i,o,t[3],10,-1894986606),o=as(o,a,n,i,t[10],15,-1051523),i=as(i,o,a,n,t[1],21,-2054922799),n=as(n,i,o,a,t[8],6,1873313359),a=as(a,n,i,o,t[15],10,-30611744),o=as(o,a,n,i,t[6],15,-1560198380),i=as(i,o,a,n,t[13],21,1309151649),n=as(n,i,o,a,t[4],6,-145523070),a=as(a,n,i,o,t[11],10,-1120210379),o=as(o,a,n,i,t[2],15,718787259),i=as(i,o,a,n,t[9],21,-343485551),e[0]=Al(n,e[0]),e[1]=Al(i,e[1]),e[2]=Al(o,e[2]),e[3]=Al(a,e[3])}function gd(e,t,n,i,o,a){return t=Al(Al(t,e),Al(i,a)),Al(t<<o|t>>>32-o,n)}function rs(e,t,n,i,o,a,u){return gd(t&n|~t&i,e,t,o,a,u)}function ss(e,t,n,i,o,a,u){return gd(t&i|n&~i,e,t,o,a,u)}function os(e,t,n,i,o,a,u){return gd(t^n^i,e,t,o,a,u)}function as(e,t,n,i,o,a,u){return gd(n^(t|~i),e,t,o,a,u)}function ev(e){var t,n=e.length,i=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)Jd(i,SC(e.substring(t-64,t)));e=e.substring(t-64);var o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)o[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(o[t>>2]|=128<<(t%4<<3),t>55)for(Jd(i,o),t=0;t<16;t++)o[t]=0;return o[14]=8*n,Jd(i,o),i}function SC(e){var t,n=[];for(t=0;t<64;t+=4)n[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return n}wc=Sn.atob.bind(Sn),Rf=Sn.btoa.bind(Sn);var cg="0123456789abcdef".split("");function AC(e){for(var t="",n=0;n<4;n++)t+=cg[e>>8*n+4&15]+cg[e>>8*n&15];return t}function MC(e){return String.fromCharCode((255&e)>>0,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function Of(e){return ev(e).map(MC).join("")}var BC=function(e){for(var t=0;t<e.length;t++)e[t]=AC(e[t]);return e.join("")}(ev("hello"))!="5d41402abc4b2a76b9719d911017c592";function Al(e,t){if(BC){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}return e+t&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function If(e,t){var n,i,o,a;if(e!==n){for(var u=(o=e,a=1+(256/e.length>>0),new Array(a+1).join(o)),d=[],f=0;f<256;f++)d[f]=f;var m=0;for(f=0;f<256;f++){var y=d[f];m=(m+y+u.charCodeAt(f))%256,d[f]=d[m],d[m]=y}n=e,i=d}else d=i;var x=t.length,k=0,b=0,T="";for(f=0;f<x;f++)b=(b+(y=d[k=(k+1)%256]))%256,d[k]=d[b],d[b]=y,u=d[(d[k]+d[b])%256],T+=String.fromCharCode(t.charCodeAt(f)^u);return T}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var hg={print:4,modify:8,copy:16,"annot-forms":32};function Su(e,t,n,i){this.v=1,this.r=2;var o=192;e.forEach(function(d){if(hg.perm!==void 0)throw new Error("Invalid permission: "+d);o+=hg[d]}),this.padding="(¿N^NuAd\0NVÿú\b..\0¶Ðh>/\f©þdSiz";var a=(t+this.padding).substr(0,32),u=(n+this.padding).substr(0,32);this.O=this.processOwnerPassword(a,u),this.P=-(1+(255^o)),this.encryptionKey=Of(a+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(i)).substr(0,5),this.U=If(this.encryptionKey,this.padding)}function Au(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var t="",n=e.length,i=0;i<n;i++){var o=e.charCodeAt(i);o<33||o===35||o===37||o===40||o===41||o===47||o===60||o===62||o===91||o===93||o===123||o===125||o>126?t+="#"+("0"+o.toString(16)).slice(-2):t+=e[i]}return t}function dg(e){if(yi(e)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(n,i,o){if(o=o||!1,typeof n!="string"||typeof i!="function"||typeof o!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(n)||(t[n]={});var a=Math.random().toString(35);return t[n][a]=[i,!!o],a},this.unsubscribe=function(n){for(var i in t)if(t[i][n])return delete t[i][n],Object.keys(t[i]).length===0&&delete t[i],!0;return!1},this.publish=function(n){if(t.hasOwnProperty(n)){var i=Array.prototype.slice.call(arguments,1),o=[];for(var a in t[n]){var u=t[n][a];try{u[0].apply(e,i)}catch(d){Sn.console&&Li.error("jsPDF PubSub Error",d.message,d)}u[1]&&o.push(a)}o.length&&o.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function Uh(e){if(!(this instanceof Uh))return new Uh(e);var t="opacity,stroke-opacity".split(",");for(var n in e)e.hasOwnProperty(n)&&t.indexOf(n)>=0&&(this[n]=e[n]);this.id="",this.objectNumber=-1}function tv(e,t){this.gState=e,this.matrix=t,this.id="",this.objectNumber=-1}function Jl(e,t,n,i,o){if(!(this instanceof Jl))return new Jl(e,t,n,i,o);this.type=e==="axial"?2:3,this.coords=t,this.colors=n,tv.call(this,i,o)}function Bu(e,t,n,i,o){if(!(this instanceof Bu))return new Bu(e,t,n,i,o);this.boundingBox=e,this.xStep=t,this.yStep=n,this.stream="",this.cloneIndex=0,tv.call(this,i,o)}function Cn(e){var t,n=typeof arguments[0]=="string"?arguments[0]:"p",i=arguments[1],o=arguments[2],a=arguments[3],u=[],d=1,f=16,m="S",y=null;yi(e=e||{})==="object"&&(n=e.orientation,i=e.unit||i,o=e.format||o,a=e.compress||e.compressPdf||a,(y=e.encryption||null)!==null&&(y.userPassword=y.userPassword||"",y.ownerPassword=y.ownerPassword||"",y.userPermissions=y.userPermissions||[]),d=typeof e.userUnit=="number"?Math.abs(e.userUnit):1,e.precision!==void 0&&(t=e.precision),e.floatPrecision!==void 0&&(f=e.floatPrecision),m=e.defaultPathOperation||"S"),u=e.filters||(a===!0?["FlateEncode"]:u),i=i||"mm",n=(""+(n||"P")).toLowerCase();var x=e.putOnlyUsedFonts||!1,k={},b={internal:{},__private__:{}};b.__private__.PubSub=dg;var T="1.3",$=b.__private__.getPdfVersion=function(){return T};b.__private__.setPdfVersion=function(P){T=P};var H={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};b.__private__.getPageFormats=function(){return H};var I=b.__private__.getPageFormat=function(P){return H[P]};o=o||"a4";var Q={COMPAT:"compat",ADVANCED:"advanced"},se=Q.COMPAT;function we(){this.saveGraphicsState(),j(new sn(St,0,0,-St,0,xo()*St).toString()+" cm"),this.setFontSize(this.getFontSize()/St),m="n",se=Q.ADVANCED}function Be(){this.restoreGraphicsState(),m="S",se=Q.COMPAT}var $e=b.__private__.combineFontStyleAndFontWeight=function(P,te){if(P=="bold"&&te=="normal"||P=="bold"&&te==400||P=="normal"&&te=="italic"||P=="bold"&&te=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return te&&(P=te==400||te==="normal"?P==="italic"?"italic":"normal":te!=700&&te!=="bold"||P!=="normal"?(te==700?"bold":te)+""+P:"bold"),P};b.advancedAPI=function(P){var te=se===Q.COMPAT;return te&&we.call(this),typeof P!="function"||(P(this),te&&Be.call(this)),this},b.compatAPI=function(P){var te=se===Q.ADVANCED;return te&&Be.call(this),typeof P!="function"||(P(this),te&&we.call(this)),this},b.isAdvancedAPI=function(){return se===Q.ADVANCED};var Ue,Pe=function(P){if(se!==Q.ADVANCED)throw new Error(P+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},Te=b.roundToPrecision=b.__private__.roundToPrecision=function(P,te){var Ne=t||te;if(isNaN(P)||isNaN(Ne))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return P.toFixed(Ne).replace(/0+$/,"")};Ue=b.hpf=b.__private__.hpf=typeof f=="number"?function(P){if(isNaN(P))throw new Error("Invalid argument passed to jsPDF.hpf");return Te(P,f)}:f==="smart"?function(P){if(isNaN(P))throw new Error("Invalid argument passed to jsPDF.hpf");return Te(P,P>-1&&P<1?16:5)}:function(P){if(isNaN(P))throw new Error("Invalid argument passed to jsPDF.hpf");return Te(P,16)};var He=b.f2=b.__private__.f2=function(P){if(isNaN(P))throw new Error("Invalid argument passed to jsPDF.f2");return Te(P,2)},ae=b.__private__.f3=function(P){if(isNaN(P))throw new Error("Invalid argument passed to jsPDF.f3");return Te(P,3)},re=b.scale=b.__private__.scale=function(P){if(isNaN(P))throw new Error("Invalid argument passed to jsPDF.scale");return se===Q.COMPAT?P*St:se===Q.ADVANCED?P:void 0},oe=function(P){return se===Q.COMPAT?xo()-P:se===Q.ADVANCED?P:void 0},Y=function(P){return re(oe(P))};b.__private__.setPrecision=b.setPrecision=function(P){typeof parseInt(P,10)=="number"&&(t=parseInt(P,10))};var C,N="00000000000000000000000000000000",K=b.__private__.getFileId=function(){return N},J=b.__private__.setFileId=function(P){return N=P!==void 0&&/^[a-fA-F0-9]{32}$/.test(P)?P.toUpperCase():N.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),y!==null&&($i=new Su(y.userPermissions,y.userPassword,y.ownerPassword,N)),N};b.setFileId=function(P){return J(P),this},b.getFileId=function(){return K()};var Ee=b.__private__.convertDateToPDFDate=function(P){var te=P.getTimezoneOffset(),Ne=te<0?"+":"-",Ke=Math.floor(Math.abs(te/60)),ct=Math.abs(te%60),Lt=[Ne,le(Ke),"'",le(ct),"'"].join("");return["D:",P.getFullYear(),le(P.getMonth()+1),le(P.getDate()),le(P.getHours()),le(P.getMinutes()),le(P.getSeconds()),Lt].join("")},ue=b.__private__.convertPDFDateToDate=function(P){var te=parseInt(P.substr(2,4),10),Ne=parseInt(P.substr(6,2),10)-1,Ke=parseInt(P.substr(8,2),10),ct=parseInt(P.substr(10,2),10),Lt=parseInt(P.substr(12,2),10),Ut=parseInt(P.substr(14,2),10);return new Date(te,Ne,Ke,ct,Lt,Ut,0)},ye=b.__private__.setCreationDate=function(P){var te;if(P===void 0&&(P=new Date),P instanceof Date)te=Ee(P);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(P))throw new Error("Invalid argument passed to jsPDF.setCreationDate");te=P}return C=te},O=b.__private__.getCreationDate=function(P){var te=C;return P==="jsDate"&&(te=ue(C)),te};b.setCreationDate=function(P){return ye(P),this},b.getCreationDate=function(P){return O(P)};var ie,le=b.__private__.padd2=function(P){return("0"+parseInt(P)).slice(-2)},fe=b.__private__.padd2Hex=function(P){return("00"+(P=P.toString())).substr(P.length)},_e=0,ee=[],G=[],q=0,de=[],ce=[],V=!1,Z=G,F=function(){_e=0,q=0,G=[],ee=[],de=[],ui=bt(),yr=bt()};b.__private__.setCustomOutputDestination=function(P){V=!0,Z=P};var D=function(P){V||(Z=P)};b.__private__.resetCustomOutputDestination=function(){V=!1,Z=G};var j=b.__private__.out=function(P){return P=P.toString(),q+=P.length+1,Z.push(P),Z},Fe=b.__private__.write=function(P){return j(arguments.length===1?P.toString():Array.prototype.join.call(arguments," "))},qe=b.__private__.getArrayBuffer=function(P){for(var te=P.length,Ne=new ArrayBuffer(te),Ke=new Uint8Array(Ne);te--;)Ke[te]=P.charCodeAt(te);return Ne},De=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];b.__private__.getStandardFonts=function(){return De};var Je=e.fontSize||16;b.__private__.setFontSize=b.setFontSize=function(P){return Je=se===Q.ADVANCED?P/St:P,this};var Ze,yt=b.__private__.getFontSize=b.getFontSize=function(){return se===Q.COMPAT?Je:Je*St},wt=e.R2L||!1;b.__private__.setR2L=b.setR2L=function(P){return wt=P,this},b.__private__.getR2L=b.getR2L=function(){return wt};var Pt,Rt=b.__private__.setZoomMode=function(P){var te=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(P))Ze=P;else if(isNaN(P)){if(te.indexOf(P)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+P+'" is not recognized.');Ze=P}else Ze=parseInt(P,10)};b.__private__.getZoomMode=function(){return Ze};var qt,lt=b.__private__.setPageMode=function(P){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(P)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+P+'" is not recognized.');Pt=P};b.__private__.getPageMode=function(){return Pt};var Oe=b.__private__.setLayoutMode=function(P){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(P)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+P+'" is not recognized.');qt=P};b.__private__.getLayoutMode=function(){return qt},b.__private__.setDisplayMode=b.setDisplayMode=function(P,te,Ne){return Rt(P),Oe(te),lt(Ne),this};var kt={title:"",subject:"",author:"",keywords:"",creator:""};b.__private__.getDocumentProperty=function(P){if(Object.keys(kt).indexOf(P)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return kt[P]},b.__private__.getDocumentProperties=function(){return kt},b.__private__.setDocumentProperties=b.setProperties=b.setDocumentProperties=function(P){for(var te in kt)kt.hasOwnProperty(te)&&P[te]&&(kt[te]=P[te]);return this},b.__private__.setDocumentProperty=function(P,te){if(Object.keys(kt).indexOf(P)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return kt[P]=te};var Et,St,nt,st,pn,Gt={},nn={},$n=[],an={},Dn={},Pn={},Ui={},Oi=null,qn=0,$t=[],Bn=new dg(b),wi=e.hotfixes||[],Yn={},xi={},pi=[],sn=function P(te,Ne,Ke,ct,Lt,Ut){if(!(this instanceof P))return new P(te,Ne,Ke,ct,Lt,Ut);isNaN(te)&&(te=1),isNaN(Ne)&&(Ne=0),isNaN(Ke)&&(Ke=0),isNaN(ct)&&(ct=1),isNaN(Lt)&&(Lt=0),isNaN(Ut)&&(Ut=0),this._matrix=[te,Ne,Ke,ct,Lt,Ut]};Object.defineProperty(sn.prototype,"sx",{get:function(){return this._matrix[0]},set:function(P){this._matrix[0]=P}}),Object.defineProperty(sn.prototype,"shy",{get:function(){return this._matrix[1]},set:function(P){this._matrix[1]=P}}),Object.defineProperty(sn.prototype,"shx",{get:function(){return this._matrix[2]},set:function(P){this._matrix[2]=P}}),Object.defineProperty(sn.prototype,"sy",{get:function(){return this._matrix[3]},set:function(P){this._matrix[3]=P}}),Object.defineProperty(sn.prototype,"tx",{get:function(){return this._matrix[4]},set:function(P){this._matrix[4]=P}}),Object.defineProperty(sn.prototype,"ty",{get:function(){return this._matrix[5]},set:function(P){this._matrix[5]=P}}),Object.defineProperty(sn.prototype,"a",{get:function(){return this._matrix[0]},set:function(P){this._matrix[0]=P}}),Object.defineProperty(sn.prototype,"b",{get:function(){return this._matrix[1]},set:function(P){this._matrix[1]=P}}),Object.defineProperty(sn.prototype,"c",{get:function(){return this._matrix[2]},set:function(P){this._matrix[2]=P}}),Object.defineProperty(sn.prototype,"d",{get:function(){return this._matrix[3]},set:function(P){this._matrix[3]=P}}),Object.defineProperty(sn.prototype,"e",{get:function(){return this._matrix[4]},set:function(P){this._matrix[4]=P}}),Object.defineProperty(sn.prototype,"f",{get:function(){return this._matrix[5]},set:function(P){this._matrix[5]=P}}),Object.defineProperty(sn.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(sn.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(sn.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(sn.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),sn.prototype.join=function(P){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(Ue).join(P)},sn.prototype.multiply=function(P){var te=P.sx*this.sx+P.shy*this.shx,Ne=P.sx*this.shy+P.shy*this.sy,Ke=P.shx*this.sx+P.sy*this.shx,ct=P.shx*this.shy+P.sy*this.sy,Lt=P.tx*this.sx+P.ty*this.shx+this.tx,Ut=P.tx*this.shy+P.ty*this.sy+this.ty;return new sn(te,Ne,Ke,ct,Lt,Ut)},sn.prototype.decompose=function(){var P=this.sx,te=this.shy,Ne=this.shx,Ke=this.sy,ct=this.tx,Lt=this.ty,Ut=Math.sqrt(P*P+te*te),Kt=(P/=Ut)*Ne+(te/=Ut)*Ke;Ne-=P*Kt,Ke-=te*Kt;var en=Math.sqrt(Ne*Ne+Ke*Ke);return Kt/=en,P*(Ke/=en)<te*(Ne/=en)&&(P=-P,te=-te,Kt=-Kt,Ut=-Ut),{scale:new sn(Ut,0,0,en,0,0),translate:new sn(1,0,0,1,ct,Lt),rotate:new sn(P,te,-te,P,0,0),skew:new sn(1,0,Kt,1,0,0)}},sn.prototype.toString=function(P){return this.join(" ")},sn.prototype.inversed=function(){var P=this.sx,te=this.shy,Ne=this.shx,Ke=this.sy,ct=this.tx,Lt=this.ty,Ut=1/(P*Ke-te*Ne),Kt=Ke*Ut,en=-te*Ut,un=-Ne*Ut,Ln=P*Ut;return new sn(Kt,en,un,Ln,-Kt*ct-un*Lt,-en*ct-Ln*Lt)},sn.prototype.applyToPoint=function(P){var te=P.x*this.sx+P.y*this.shx+this.tx,Ne=P.x*this.shy+P.y*this.sy+this.ty;return new Vo(te,Ne)},sn.prototype.applyToRectangle=function(P){var te=this.applyToPoint(P),Ne=this.applyToPoint(new Vo(P.x+P.w,P.y+P.h));return new Jr(te.x,te.y,Ne.x-te.x,Ne.y-te.y)},sn.prototype.clone=function(){var P=this.sx,te=this.shy,Ne=this.shx,Ke=this.sy,ct=this.tx,Lt=this.ty;return new sn(P,te,Ne,Ke,ct,Lt)},b.Matrix=sn;var mn=b.matrixMult=function(P,te){return te.multiply(P)},Yt=new sn(1,0,0,1,0,0);b.unitMatrix=b.identityMatrix=Yt;var gi=function(P,te){if(!Dn[P]){var Ne=(te instanceof Jl?"Sh":"P")+(Object.keys(an).length+1).toString(10);te.id=Ne,Dn[P]=Ne,an[Ne]=te,Bn.publish("addPattern",te)}};b.ShadingPattern=Jl,b.TilingPattern=Bu,b.addShadingPattern=function(P,te){return Pe("addShadingPattern()"),gi(P,te),this},b.beginTilingPattern=function(P){Pe("beginTilingPattern()"),Ua(P.boundingBox[0],P.boundingBox[1],P.boundingBox[2]-P.boundingBox[0],P.boundingBox[3]-P.boundingBox[1],P.matrix)},b.endTilingPattern=function(P,te){Pe("endTilingPattern()"),te.stream=ce[ie].join(`
`),gi(P,te),Bn.publish("endTilingPattern",te),pi.pop().restore()};var In=b.__private__.newObject=function(){var P=bt();return Xn(P,!0),P},bt=b.__private__.newObjectDeferred=function(){return _e++,ee[_e]=function(){return q},_e},Xn=function(P,te){return te=typeof te=="boolean"&&te,ee[P]=q,te&&j(P+" 0 obj"),P},Ii=b.__private__.newAdditionalObject=function(){var P={objId:bt(),content:""};return de.push(P),P},ui=bt(),yr=bt(),lr=b.__private__.decodeColorString=function(P){var te=P.split(" ");if(te.length!==2||te[1]!=="g"&&te[1]!=="G")te.length===5&&(te[4]==="k"||te[4]==="K")&&(te=[(1-te[0])*(1-te[3]),(1-te[1])*(1-te[3]),(1-te[2])*(1-te[3]),"r"]);else{var Ne=parseFloat(te[0]);te=[Ne,Ne,Ne,"r"]}for(var Ke="#",ct=0;ct<3;ct++)Ke+=("0"+Math.floor(255*parseFloat(te[ct])).toString(16)).slice(-2);return Ke},_r=b.__private__.encodeColorString=function(P){var te;typeof P=="string"&&(P={ch1:P});var Ne=P.ch1,Ke=P.ch2,ct=P.ch3,Lt=P.ch4,Ut=P.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof Ne=="string"&&Ne.charAt(0)!=="#"){var Kt=new Q1(Ne);if(Kt.ok)Ne=Kt.toHex();else if(!/^\d*\.?\d*$/.test(Ne))throw new Error('Invalid color "'+Ne+'" passed to jsPDF.encodeColorString.')}if(typeof Ne=="string"&&/^#[0-9A-Fa-f]{3}$/.test(Ne)&&(Ne="#"+Ne[1]+Ne[1]+Ne[2]+Ne[2]+Ne[3]+Ne[3]),typeof Ne=="string"&&/^#[0-9A-Fa-f]{6}$/.test(Ne)){var en=parseInt(Ne.substr(1),16);Ne=en>>16&255,Ke=en>>8&255,ct=255&en}if(Ke===void 0||Lt===void 0&&Ne===Ke&&Ke===ct)if(typeof Ne=="string")te=Ne+" "+Ut[0];else switch(P.precision){case 2:te=He(Ne/255)+" "+Ut[0];break;case 3:default:te=ae(Ne/255)+" "+Ut[0]}else if(Lt===void 0||yi(Lt)==="object"){if(Lt&&!isNaN(Lt.a)&&Lt.a===0)return te=["1.","1.","1.",Ut[1]].join(" ");if(typeof Ne=="string")te=[Ne,Ke,ct,Ut[1]].join(" ");else switch(P.precision){case 2:te=[He(Ne/255),He(Ke/255),He(ct/255),Ut[1]].join(" ");break;default:case 3:te=[ae(Ne/255),ae(Ke/255),ae(ct/255),Ut[1]].join(" ")}}else if(typeof Ne=="string")te=[Ne,Ke,ct,Lt,Ut[2]].join(" ");else switch(P.precision){case 2:te=[He(Ne),He(Ke),He(ct),He(Lt),Ut[2]].join(" ");break;case 3:default:te=[ae(Ne),ae(Ke),ae(ct),ae(Lt),Ut[2]].join(" ")}return te},Yi=b.__private__.getFilters=function(){return u},ur=b.__private__.putStream=function(P){var te=(P=P||{}).data||"",Ne=P.filters||Yi(),Ke=P.alreadyAppliedFilters||[],ct=P.addLength1||!1,Lt=te.length,Ut=P.objectId,Kt=function(Vi){return Vi};if(y!==null&&Ut===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");y!==null&&(Kt=$i.encryptor(Ut,0));var en={};Ne===!0&&(Ne=["FlateEncode"]);var un=P.additionalKeyValues||[],Ln=(en=Cn.API.processDataByFilters!==void 0?Cn.API.processDataByFilters(te,Ne):{data:te,reverseChain:[]}).reverseChain+(Array.isArray(Ke)?Ke.join(" "):Ke.toString());if(en.data.length!==0&&(un.push({key:"Length",value:en.data.length}),ct===!0&&un.push({key:"Length1",value:Lt})),Ln.length!=0)if(Ln.split("/").length-1==1)un.push({key:"Filter",value:Ln});else{un.push({key:"Filter",value:"["+Ln+"]"});for(var zn=0;zn<un.length;zn+=1)if(un[zn].key==="DecodeParms"){for(var mi=[],Zn=0;Zn<en.reverseChain.split("/").length-1;Zn+=1)mi.push("null");mi.push(un[zn].value),un[zn].value="["+mi.join(" ")+"]"}}j("<<");for(var ei=0;ei<un.length;ei++)j("/"+un[ei].key+" "+un[ei].value);j(">>"),en.data.length!==0&&(j("stream"),j(Kt(en.data)),j("endstream"))},jr=b.__private__.putPage=function(P){var te=P.number,Ne=P.data,Ke=P.objId,ct=P.contentsObjId;Xn(Ke,!0),j("<</Type /Page"),j("/Parent "+P.rootDictionaryObjId+" 0 R"),j("/Resources "+P.resourceDictionaryObjId+" 0 R"),j("/MediaBox ["+parseFloat(Ue(P.mediaBox.bottomLeftX))+" "+parseFloat(Ue(P.mediaBox.bottomLeftY))+" "+Ue(P.mediaBox.topRightX)+" "+Ue(P.mediaBox.topRightY)+"]"),P.cropBox!==null&&j("/CropBox ["+Ue(P.cropBox.bottomLeftX)+" "+Ue(P.cropBox.bottomLeftY)+" "+Ue(P.cropBox.topRightX)+" "+Ue(P.cropBox.topRightY)+"]"),P.bleedBox!==null&&j("/BleedBox ["+Ue(P.bleedBox.bottomLeftX)+" "+Ue(P.bleedBox.bottomLeftY)+" "+Ue(P.bleedBox.topRightX)+" "+Ue(P.bleedBox.topRightY)+"]"),P.trimBox!==null&&j("/TrimBox ["+Ue(P.trimBox.bottomLeftX)+" "+Ue(P.trimBox.bottomLeftY)+" "+Ue(P.trimBox.topRightX)+" "+Ue(P.trimBox.topRightY)+"]"),P.artBox!==null&&j("/ArtBox ["+Ue(P.artBox.bottomLeftX)+" "+Ue(P.artBox.bottomLeftY)+" "+Ue(P.artBox.topRightX)+" "+Ue(P.artBox.topRightY)+"]"),typeof P.userUnit=="number"&&P.userUnit!==1&&j("/UserUnit "+P.userUnit),Bn.publish("putPage",{objId:Ke,pageContext:$t[te],pageNumber:te,page:Ne}),j("/Contents "+ct+" 0 R"),j(">>"),j("endobj");var Lt=Ne.join(`
`);return se===Q.ADVANCED&&(Lt+=`
Q`),Xn(ct,!0),ur({data:Lt,filters:Yi(),objectId:ct}),j("endobj"),Ke},Ss=b.__private__.putPages=function(){var P,te,Ne=[];for(P=1;P<=qn;P++)$t[P].objId=bt(),$t[P].contentsObjId=bt();for(P=1;P<=qn;P++)Ne.push(jr({number:P,data:ce[P],objId:$t[P].objId,contentsObjId:$t[P].contentsObjId,mediaBox:$t[P].mediaBox,cropBox:$t[P].cropBox,bleedBox:$t[P].bleedBox,trimBox:$t[P].trimBox,artBox:$t[P].artBox,userUnit:$t[P].userUnit,rootDictionaryObjId:ui,resourceDictionaryObjId:yr}));Xn(ui,!0),j("<</Type /Pages");var Ke="/Kids [";for(te=0;te<qn;te++)Ke+=Ne[te]+" 0 R ";j(Ke+"]"),j("/Count "+qn),j(">>"),j("endobj"),Bn.publish("postPutPages")},Zs=function(P){Bn.publish("putFont",{font:P,out:j,newObject:In,putStream:ur}),P.isAlreadyPutted!==!0&&(P.objectNumber=In(),j("<<"),j("/Type /Font"),j("/BaseFont /"+Au(P.postScriptName)),j("/Subtype /Type1"),typeof P.encoding=="string"&&j("/Encoding /"+P.encoding),j("/FirstChar 32"),j("/LastChar 255"),j(">>"),j("endobj"))},Ks=function(){for(var P in Gt)Gt.hasOwnProperty(P)&&(x===!1||x===!0&&k.hasOwnProperty(P))&&Zs(Gt[P])},Gr=function(P){P.objectNumber=In();var te=[];te.push({key:"Type",value:"/XObject"}),te.push({key:"Subtype",value:"/Form"}),te.push({key:"BBox",value:"["+[Ue(P.x),Ue(P.y),Ue(P.x+P.width),Ue(P.y+P.height)].join(" ")+"]"}),te.push({key:"Matrix",value:"["+P.matrix.toString()+"]"});var Ne=P.pages[1].join(`
`);ur({data:Ne,additionalKeyValues:te,objectId:P.objectNumber}),j("endobj")},ds=function(){for(var P in Yn)Yn.hasOwnProperty(P)&&Gr(Yn[P])},As=function(P,te){var Ne,Ke=[],ct=1/(te-1);for(Ne=0;Ne<1;Ne+=ct)Ke.push(Ne);if(Ke.push(1),P[0].offset!=0){var Lt={offset:0,color:P[0].color};P.unshift(Lt)}if(P[P.length-1].offset!=1){var Ut={offset:1,color:P[P.length-1].color};P.push(Ut)}for(var Kt="",en=0,un=0;un<Ke.length;un++){for(Ne=Ke[un];Ne>P[en+1].offset;)en++;var Ln=P[en].offset,zn=(Ne-Ln)/(P[en+1].offset-Ln),mi=P[en].color,Zn=P[en+1].color;Kt+=fe(Math.round((1-zn)*mi[0]+zn*Zn[0]).toString(16))+fe(Math.round((1-zn)*mi[1]+zn*Zn[1]).toString(16))+fe(Math.round((1-zn)*mi[2]+zn*Zn[2]).toString(16))}return Kt.trim()},ua=function(P,te){te||(te=21);var Ne=In(),Ke=As(P.colors,te),ct=[];ct.push({key:"FunctionType",value:"0"}),ct.push({key:"Domain",value:"[0.0 1.0]"}),ct.push({key:"Size",value:"["+te+"]"}),ct.push({key:"BitsPerSample",value:"8"}),ct.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),ct.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),ur({data:Ke,additionalKeyValues:ct,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:Ne}),j("endobj"),P.objectNumber=In(),j("<< /ShadingType "+P.type),j("/ColorSpace /DeviceRGB");var Lt="/Coords ["+Ue(parseFloat(P.coords[0]))+" "+Ue(parseFloat(P.coords[1]))+" ";P.type===2?Lt+=Ue(parseFloat(P.coords[2]))+" "+Ue(parseFloat(P.coords[3])):Lt+=Ue(parseFloat(P.coords[2]))+" "+Ue(parseFloat(P.coords[3]))+" "+Ue(parseFloat(P.coords[4]))+" "+Ue(parseFloat(P.coords[5])),j(Lt+="]"),P.matrix&&j("/Matrix ["+P.matrix.toString()+"]"),j("/Function "+Ne+" 0 R"),j("/Extend [true true]"),j(">>"),j("endobj")},ca=function(P,te){var Ne=bt(),Ke=In();te.push({resourcesOid:Ne,objectOid:Ke}),P.objectNumber=Ke;var ct=[];ct.push({key:"Type",value:"/Pattern"}),ct.push({key:"PatternType",value:"1"}),ct.push({key:"PaintType",value:"1"}),ct.push({key:"TilingType",value:"1"}),ct.push({key:"BBox",value:"["+P.boundingBox.map(Ue).join(" ")+"]"}),ct.push({key:"XStep",value:Ue(P.xStep)}),ct.push({key:"YStep",value:Ue(P.yStep)}),ct.push({key:"Resources",value:Ne+" 0 R"}),P.matrix&&ct.push({key:"Matrix",value:"["+P.matrix.toString()+"]"}),ur({data:P.stream,additionalKeyValues:ct,objectId:P.objectNumber}),j("endobj")},Ys=function(P){var te;for(te in an)an.hasOwnProperty(te)&&(an[te]instanceof Jl?ua(an[te]):an[te]instanceof Bu&&ca(an[te],P))},Io=function(P){for(var te in P.objectNumber=In(),j("<<"),P)switch(te){case"opacity":j("/ca "+He(P[te]));break;case"stroke-opacity":j("/CA "+He(P[te]))}j(">>"),j("endobj")},ha=function(){var P;for(P in Pn)Pn.hasOwnProperty(P)&&Io(Pn[P])},Ms=function(){for(var P in j("/XObject <<"),Yn)Yn.hasOwnProperty(P)&&Yn[P].objectNumber>=0&&j("/"+P+" "+Yn[P].objectNumber+" 0 R");Bn.publish("putXobjectDict"),j(">>")},Bs=function(){$i.oid=In(),j("<<"),j("/Filter /Standard"),j("/V "+$i.v),j("/R "+$i.r),j("/U <"+$i.toHexString($i.U)+">"),j("/O <"+$i.toHexString($i.O)+">"),j("/P "+$i.P),j(">>"),j("endobj")},go=function(){for(var P in j("/Font <<"),Gt)Gt.hasOwnProperty(P)&&(x===!1||x===!0&&k.hasOwnProperty(P))&&j("/"+P+" "+Gt[P].objectNumber+" 0 R");j(">>")},Fo=function(){if(Object.keys(an).length>0){for(var P in j("/Shading <<"),an)an.hasOwnProperty(P)&&an[P]instanceof Jl&&an[P].objectNumber>=0&&j("/"+P+" "+an[P].objectNumber+" 0 R");Bn.publish("putShadingPatternDict"),j(">>")}},cr=function(P){if(Object.keys(an).length>0){for(var te in j("/Pattern <<"),an)an.hasOwnProperty(te)&&an[te]instanceof b.TilingPattern&&an[te].objectNumber>=0&&an[te].objectNumber<P&&j("/"+te+" "+an[te].objectNumber+" 0 R");Bn.publish("putTilingPatternDict"),j(">>")}},Fn=function(){if(Object.keys(Pn).length>0){var P;for(P in j("/ExtGState <<"),Pn)Pn.hasOwnProperty(P)&&Pn[P].objectNumber>=0&&j("/"+P+" "+Pn[P].objectNumber+" 0 R");Bn.publish("putGStateDict"),j(">>")}},_n=function(P){Xn(P.resourcesOid,!0),j("<<"),j("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),go(),Fo(),cr(P.objectOid),Fn(),Ms(),j(">>"),j("endobj")},fs=function(){var P=[];Ks(),ha(),ds(),Ys(P),Bn.publish("putResources"),P.forEach(_n),_n({resourcesOid:yr,objectOid:Number.MAX_SAFE_INTEGER}),Bn.publish("postPutResources")},Hr=function(){Bn.publish("putAdditionalObjects");for(var P=0;P<de.length;P++){var te=de[P];Xn(te.objId,!0),j(te.content),j("endobj")}Bn.publish("postPutAdditionalObjects")},zr=function(P){nn[P.fontName]=nn[P.fontName]||{},nn[P.fontName][P.fontStyle]=P.id},Ts=function(P,te,Ne,Ke,ct){var Lt={id:"F"+(Object.keys(Gt).length+1).toString(10),postScriptName:P,fontName:te,fontStyle:Ne,encoding:Ke,isStandardFont:ct||!1,metadata:{}};return Bn.publish("addFont",{font:Lt,instance:this}),Gt[Lt.id]=Lt,zr(Lt),Lt.id},xn=function(P){for(var te=0,Ne=De.length;te<Ne;te++){var Ke=Ts.call(this,P[te][0],P[te][1],P[te][2],De[te][3],!0);x===!1&&(k[Ke]=!0);var ct=P[te][0].split("-");zr({id:Ke,fontName:ct[0],fontStyle:ct[1]||""})}Bn.publish("addFonts",{fonts:Gt,dictionary:nn})},Hn=function(P){return P.foo=function(){try{return P.apply(this,arguments)}catch(Ke){var te=Ke.stack||"";~te.indexOf(" at ")&&(te=te.split(" at ")[1]);var Ne="Error in function "+te.split(`
`)[0].split("<")[0]+": "+Ke.message;if(!Sn.console)throw new Error(Ne);Sn.console.error(Ne,Ke),Sn.alert&&alert(Ne)}},P.foo.bar=P,P.foo},Ei=function(P,te){var Ne,Ke,ct,Lt,Ut,Kt,en,un,Ln;if(ct=(te=te||{}).sourceEncoding||"Unicode",Ut=te.outputEncoding,(te.autoencode||Ut)&&Gt[Et].metadata&&Gt[Et].metadata[ct]&&Gt[Et].metadata[ct].encoding&&(Lt=Gt[Et].metadata[ct].encoding,!Ut&&Gt[Et].encoding&&(Ut=Gt[Et].encoding),!Ut&&Lt.codePages&&(Ut=Lt.codePages[0]),typeof Ut=="string"&&(Ut=Lt[Ut]),Ut)){for(en=!1,Kt=[],Ne=0,Ke=P.length;Ne<Ke;Ne++)(un=Ut[P.charCodeAt(Ne)])?Kt.push(String.fromCharCode(un)):Kt.push(P[Ne]),Kt[Ne].charCodeAt(0)>>8&&(en=!0);P=Kt.join("")}for(Ne=P.length;en===void 0&&Ne!==0;)P.charCodeAt(Ne-1)>>8&&(en=!0),Ne--;if(!en)return P;for(Kt=te.noBOM?[]:[254,255],Ne=0,Ke=P.length;Ne<Ke;Ne++){if((Ln=(un=P.charCodeAt(Ne))>>8)>>8)throw new Error("Character at position "+Ne+" of string '"+P+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Kt.push(Ln),Kt.push(un-(Ln<<8))}return String.fromCharCode.apply(void 0,Kt)},Wn=b.__private__.pdfEscape=b.pdfEscape=function(P,te){return Ei(P,te).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Qn=b.__private__.beginPage=function(P){ce[++qn]=[],$t[qn]={objId:0,contentsObjId:0,userUnit:Number(d),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(P[0]),topRightY:Number(P[1])}},Wr(qn),D(ce[ie])},ci=function(P,te){var Ne,Ke,ct;switch(n=te||n,typeof P=="string"&&(Ne=I(P.toLowerCase()),Array.isArray(Ne)&&(Ke=Ne[0],ct=Ne[1])),Array.isArray(P)&&(Ke=P[0]*St,ct=P[1]*St),isNaN(Ke)&&(Ke=o[0],ct=o[1]),(Ke>14400||ct>14400)&&(Li.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),Ke=Math.min(14400,Ke),ct=Math.min(14400,ct)),o=[Ke,ct],n.substr(0,1)){case"l":ct>Ke&&(o=[ct,Ke]);break;case"p":Ke>ct&&(o=[ct,Ke])}Qn(o),$o(ga),j(Sr),ya!==0&&j(ya+" J"),qi!==0&&j(qi+" j"),Bn.publish("addPage",{pageNumber:qn})},ps=function(P){P>0&&P<=qn&&(ce.splice(P,1),$t.splice(P,1),qn--,ie>qn&&(ie=qn),this.setPage(ie))},Wr=function(P){P>0&&P<=qn&&(ie=P)},_i=b.__private__.getNumberOfPages=b.getNumberOfPages=function(){return ce.length-1},Ns=function(P,te,Ne){var Ke,ct=void 0;return Ne=Ne||{},P=P!==void 0?P:Gt[Et].fontName,te=te!==void 0?te:Gt[Et].fontStyle,Ke=P.toLowerCase(),nn[Ke]!==void 0&&nn[Ke][te]!==void 0?ct=nn[Ke][te]:nn[P]!==void 0&&nn[P][te]!==void 0?ct=nn[P][te]:Ne.disableWarning===!1&&Li.warn("Unable to look up font label for font '"+P+"', '"+te+"'. Refer to getFontList() for available fonts."),ct||Ne.noFallback||(ct=nn.times[te])==null&&(ct=nn.times.normal),ct},jo=b.__private__.putInfo=function(){var P=In(),te=function(Ke){return Ke};for(var Ne in y!==null&&(te=$i.encryptor(P,0)),j("<<"),j("/Producer ("+Wn(te("jsPDF "+Cn.version))+")"),kt)kt.hasOwnProperty(Ne)&&kt[Ne]&&j("/"+Ne.substr(0,1).toUpperCase()+Ne.substr(1)+" ("+Wn(te(kt[Ne]))+")");j("/CreationDate ("+Wn(te(C))+")"),j(">>"),j("endobj")},Js=b.__private__.putCatalog=function(P){var te=(P=P||{}).rootDictionaryObjId||ui;switch(In(),j("<<"),j("/Type /Catalog"),j("/Pages "+te+" 0 R"),Ze||(Ze="fullwidth"),Ze){case"fullwidth":j("/OpenAction [3 0 R /FitH null]");break;case"fullheight":j("/OpenAction [3 0 R /FitV null]");break;case"fullpage":j("/OpenAction [3 0 R /Fit]");break;case"original":j("/OpenAction [3 0 R /XYZ null null 1]");break;default:var Ne=""+Ze;Ne.substr(Ne.length-1)==="%"&&(Ze=parseInt(Ze)/100),typeof Ze=="number"&&j("/OpenAction [3 0 R /XYZ null null "+He(Ze)+"]")}switch(qt||(qt="continuous"),qt){case"continuous":j("/PageLayout /OneColumn");break;case"single":j("/PageLayout /SinglePage");break;case"two":case"twoleft":j("/PageLayout /TwoColumnLeft");break;case"tworight":j("/PageLayout /TwoColumnRight")}Pt&&j("/PageMode /"+Pt),Bn.publish("putCatalog"),j(">>"),j("endobj")},Da=b.__private__.putTrailer=function(){j("trailer"),j("<<"),j("/Size "+(_e+1)),j("/Root "+_e+" 0 R"),j("/Info "+(_e-1)+" 0 R"),y!==null&&j("/Encrypt "+$i.oid+" 0 R"),j("/ID [ <"+N+"> <"+N+"> ]"),j(">>")},mo=b.__private__.putHeader=function(){j("%PDF-"+T),j("%ºß¬à")},Ra=b.__private__.putXRef=function(){var P="0000000000";j("xref"),j("0 "+(_e+1)),j("0000000000 65535 f ");for(var te=1;te<=_e;te++)typeof ee[te]=="function"?j((P+ee[te]()).slice(-10)+" 00000 n "):ee[te]!==void 0?j((P+ee[te]).slice(-10)+" 00000 n "):j("0000000000 00000 n ")},gs=b.__private__.buildDocument=function(){F(),D(G),Bn.publish("buildDocument"),mo(),Ss(),Hr(),fs(),y!==null&&Bs(),jo(),Js();var P=q;return Ra(),Da(),j("startxref"),j(""+P),j("%%EOF"),D(ce[ie]),G.join(`
`)},Xs=b.__private__.getBlob=function(P){return new Blob([qe(P)],{type:"application/pdf"})},vo=b.output=b.__private__.output=Hn(function(P,te){switch(typeof(te=te||{})=="string"?te={filename:te}:te.filename=te.filename||"generated.pdf",P){case void 0:return gs();case"save":b.save(te.filename);break;case"arraybuffer":return qe(gs());case"blob":return Xs(gs());case"bloburi":case"bloburl":if(Sn.URL!==void 0&&typeof Sn.URL.createObjectURL=="function")return Sn.URL&&Sn.URL.createObjectURL(Xs(gs()))||void 0;Li.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var Ne="",Ke=gs();try{Ne=Rf(Ke)}catch{Ne=Rf(unescape(encodeURIComponent(Ke)))}return"data:application/pdf;filename="+te.filename+";base64,"+Ne;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Sn)==="[object Window]"){var ct="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Lt=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';te.pdfObjectUrl&&(ct=te.pdfObjectUrl,Lt="");var Ut='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+ct+'"'+Lt+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(te)+");<\/script></body></html>",Kt=Sn.open();return Kt!==null&&Kt.document.write(Ut),Kt}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Sn)==="[object Window]"){var en='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(te.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+te.filename+'" width="500px" height="400px" /></body></html>',un=Sn.open();if(un!==null){un.document.write(en);var Ln=this;un.document.documentElement.querySelector("#pdfViewer").onload=function(){un.document.title=te.filename,un.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Ln.output("bloburl"))}}return un}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Sn)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var zn='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",te)+'"></iframe></body></html>',mi=Sn.open();if(mi!==null&&(mi.document.write(zn),mi.document.title=te.filename),mi||typeof safari>"u")return mi;break;case"datauri":case"dataurl":return Sn.document.location.href=this.output("datauristring",te);default:return null}}),da=function(P){return Array.isArray(wi)===!0&&wi.indexOf(P)>-1};switch(i){case"pt":St=1;break;case"mm":St=72/25.4;break;case"cm":St=72/2.54;break;case"in":St=72;break;case"px":St=da("px_scaling")==1?.75:96/72;break;case"pc":case"em":St=12;break;case"ex":St=6;break;default:if(typeof i!="number")throw new Error("Invalid unit: "+i);St=i}var $i=null;ye(),J();var sl=function(P){return y!==null?$i.encryptor(P,0):function(te){return te}},fa=b.__private__.getPageInfo=b.getPageInfo=function(P){if(isNaN(P)||P%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:$t[P].objId,pageNumber:P,pageContext:$t[P]}},kn=b.__private__.getPageInfoByObjId=function(P){if(isNaN(P)||P%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var te in $t)if($t[te].objId===P)break;return fa(te)},An=b.__private__.getCurrentPageInfo=b.getCurrentPageInfo=function(){return{objId:$t[ie].objId,pageNumber:ie,pageContext:$t[ie]}};b.addPage=function(){return ci.apply(this,arguments),this},b.setPage=function(){return Wr.apply(this,arguments),D.call(this,ce[ie]),this},b.insertPage=function(P){return this.addPage(),this.movePage(ie,P),this},b.movePage=function(P,te){var Ne,Ke;if(P>te){Ne=ce[P],Ke=$t[P];for(var ct=P;ct>te;ct--)ce[ct]=ce[ct-1],$t[ct]=$t[ct-1];ce[te]=Ne,$t[te]=Ke,this.setPage(te)}else if(P<te){Ne=ce[P],Ke=$t[P];for(var Lt=P;Lt<te;Lt++)ce[Lt]=ce[Lt+1],$t[Lt]=$t[Lt+1];ce[te]=Ne,$t[te]=Ke,this.setPage(te)}return this},b.deletePage=function(){return ps.apply(this,arguments),this},b.__private__.text=b.text=function(P,te,Ne,Ke,ct){var Lt,Ut,Kt,en,un,Ln,zn,mi,Zn,ei=(Ke=Ke||{}).scope||this;if(typeof P=="number"&&typeof te=="number"&&(typeof Ne=="string"||Array.isArray(Ne))){var Vi=Ne;Ne=te,te=P,P=Vi}if(arguments[3]instanceof sn?(Pe("The transform parameter of text() with a Matrix value"),Zn=ct):(Kt=arguments[4],en=arguments[5],yi(zn=arguments[3])==="object"&&zn!==null||(typeof Kt=="string"&&(en=Kt,Kt=null),typeof zn=="string"&&(en=zn,zn=null),typeof zn=="number"&&(Kt=zn,zn=null),Ke={flags:zn,angle:Kt,align:en})),isNaN(te)||isNaN(Ne)||P==null)throw new Error("Invalid arguments passed to jsPDF.text");if(P.length===0)return ei;var Fi="",$r=!1,oi=typeof Ke.lineHeightFactor=="number"?Ke.lineHeightFactor:Uo,wr=ei.internal.scaleFactor;function ll(ri){return ri=ri.split("	").join(Array(Ke.TabLen||9).join(" ")),Wn(ri,zn)}function xr(ri){for(var ti,Ni=ri.concat(),ai=[],ys=Ni.length;ys--;)typeof(ti=Ni.shift())=="string"?ai.push(ti):Array.isArray(ri)&&(ti.length===1||ti[1]===void 0&&ti[2]===void 0)?ai.push(ti[0]):ai.push([ti[0],ti[1],ti[2]]);return ai}function qa(ri,ti){var Ni;if(typeof ri=="string")Ni=ti(ri)[0];else if(Array.isArray(ri)){for(var ai,ys,ko=ri.concat(),js=[],cl=ko.length;cl--;)typeof(ai=ko.shift())=="string"?js.push(ti(ai)[0]):Array.isArray(ai)&&typeof ai[0]=="string"&&(ys=ti(ai[0],ai[1],ai[2]),js.push([ys[0],ys[1],ys[2]]));Ni=js}return Ni}var ms=!1,Va=!0;if(typeof P=="string")ms=!0;else if(Array.isArray(P)){var to=P.concat();Ut=[];for(var no,ji=to.length;ji--;)(typeof(no=to.shift())!="string"||Array.isArray(no)&&typeof no[0]!="string")&&(Va=!1);ms=Va}if(ms===!1)throw new Error('Type of text must be string or Array. "'+P+'" is not recognized.');typeof P=="string"&&(P=P.match(/[\r?\n]/)?P.split(/\r\n|\r|\n/g):[P]);var wa=Je/ei.internal.scaleFactor,Ar=wa*(oi-1);switch(Ke.baseline){case"bottom":Ne-=Ar;break;case"top":Ne+=wa-Ar;break;case"hanging":Ne+=wa-2*Ar;break;case"middle":Ne+=wa/2-Ar}if((Ln=Ke.maxWidth||0)>0&&(typeof P=="string"?P=ei.splitTextToSize(P,Ln):Object.prototype.toString.call(P)==="[object Array]"&&(P=P.reduce(function(ri,ti){return ri.concat(ei.splitTextToSize(ti,Ln))},[]))),Lt={text:P,x:te,y:Ne,options:Ke,mutex:{pdfEscape:Wn,activeFontKey:Et,fonts:Gt,activeFontSize:Je}},Bn.publish("preProcessText",Lt),P=Lt.text,Kt=(Ke=Lt.options).angle,!(Zn instanceof sn)&&Kt&&typeof Kt=="number"){Kt*=Math.PI/180,Ke.rotationDirection===0&&(Kt=-Kt),se===Q.ADVANCED&&(Kt=-Kt);var Lr=Math.cos(Kt),xa=Math.sin(Kt);Zn=new sn(Lr,xa,-xa,Lr,0,0)}else Kt&&Kt instanceof sn&&(Zn=Kt);se!==Q.ADVANCED||Zn||(Zn=Yt),(un=Ke.charSpace||va)!==void 0&&(Fi+=Ue(re(un))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(mi=Ke.horizontalScale)!==void 0&&(Fi+=Ue(100*mi)+` Tz
`),Ke.lang;var hr=-1,io=Ke.renderingMode!==void 0?Ke.renderingMode:Ke.stroke,qr=ei.internal.getCurrentPageInfo().pageContext;switch(io){case 0:case!1:case"fill":hr=0;break;case 1:case!0:case"stroke":hr=1;break;case 2:case"fillThenStroke":hr=2;break;case 3:case"invisible":hr=3;break;case 4:case"fillAndAddForClipping":hr=4;break;case 5:case"strokeAndAddPathForClipping":hr=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":hr=6;break;case 7:case"addToPathForClipping":hr=7}var ul=qr.usedRenderingMode!==void 0?qr.usedRenderingMode:-1;hr!==-1?Fi+=hr+` Tr
`:ul!==-1&&(Fi+=`0 Tr
`),hr!==-1&&(qr.usedRenderingMode=hr),en=Ke.align||"left";var Gi,Rs=Je*oi,Xr=ei.internal.pageSize.getWidth(),Ho=Gt[Et];un=Ke.charSpace||va,Ln=Ke.maxWidth||0,zn=Object.assign({autoencode:!0,noBOM:!0},Ke.flags);var ro=[],Os=function(ri){return ei.getStringUnitWidth(ri,{font:Ho,charSpace:un,fontSize:Je,doKerning:!1})*Je/wr};if(Object.prototype.toString.call(P)==="[object Array]"){var er;Ut=xr(P),en!=="left"&&(Gi=Ut.map(Os));var Ji,vs=0;if(en==="right"){te-=Gi[0],P=[],ji=Ut.length;for(var Mr=0;Mr<ji;Mr++)Mr===0?(Ji=dn(te),er=br(Ne)):(Ji=re(vs-Gi[Mr]),er=-Rs),P.push([Ut[Mr],Ji,er]),vs=Gi[Mr]}else if(en==="center"){te-=Gi[0]/2,P=[],ji=Ut.length;for(var Qr=0;Qr<ji;Qr++)Qr===0?(Ji=dn(te),er=br(Ne)):(Ji=re((vs-Gi[Qr])/2),er=-Rs),P.push([Ut[Qr],Ji,er]),vs=Gi[Qr]}else if(en==="left"){P=[],ji=Ut.length;for(var so=0;so<ji;so++)P.push(Ut[so])}else if(en==="justify"&&Ho.encoding==="Identity-H"){P=[],ji=Ut.length,Ln=Ln!==0?Ln:Xr;for(var es=0,Si=0;Si<ji;Si++)if(er=Si===0?br(Ne):-Rs,Ji=Si===0?dn(te):es,Si<ji-1){var Is=re((Ln-Gi[Si])/(Ut[Si].split(" ").length-1)),Cr=Ut[Si].split(" ");P.push([Cr[0]+" ",Ji,er]),es=0;for(var dr=1;dr<Cr.length;dr++){var Wo=(Os(Cr[dr-1]+" "+Cr[dr])-Os(Cr[dr]))*wr+Is;dr==Cr.length-1?P.push([Cr[dr],Wo,0]):P.push([Cr[dr]+" ",Wo,0]),es-=Wo}}else P.push([Ut[Si],Ji,er]);P.push(["",es,0])}else{if(en!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(P=[],ji=Ut.length,Ln=Ln!==0?Ln:Xr,Si=0;Si<ji;Si++)er=Si===0?br(Ne):-Rs,Ji=Si===0?dn(te):0,Si<ji-1?ro.push(Ue(re((Ln-Gi[Si])/(Ut[Si].split(" ").length-1)))):ro.push(0),P.push([Ut[Si],Ji,er])}}var Ga=typeof Ke.R2L=="boolean"?Ke.R2L:wt;Ga===!0&&(P=qa(P,function(ri,ti,Ni){return[ri.split("").reverse().join(""),ti,Ni]})),Lt={text:P,x:te,y:Ne,options:Ke,mutex:{pdfEscape:Wn,activeFontKey:Et,fonts:Gt,activeFontSize:Je}},Bn.publish("postProcessText",Lt),P=Lt.text,$r=Lt.mutex.isHex||!1;var Ha=Gt[Et].encoding;Ha!=="WinAnsiEncoding"&&Ha!=="StandardEncoding"||(P=qa(P,function(ri,ti,Ni){return[ll(ri),ti,Ni]})),Ut=xr(P),P=[];for(var fr,Br,Lo,Fs=0,La=1,Co=Array.isArray(Ut[0])?La:Fs,Po="",oo=function(ri,ti,Ni){var ai="";return Ni instanceof sn?(Ni=typeof Ke.angle=="number"?mn(Ni,new sn(1,0,0,1,ri,ti)):mn(new sn(1,0,0,1,ri,ti),Ni),se===Q.ADVANCED&&(Ni=mn(new sn(1,0,0,-1,0,0),Ni)),ai=Ni.join(" ")+` Tm
`):ai=Ue(ri)+" "+Ue(ti)+` Td
`,ai},ts=0;ts<Ut.length;ts++){switch(Po="",Co){case La:Lo=($r?"<":"(")+Ut[ts][0]+($r?">":")"),fr=parseFloat(Ut[ts][1]),Br=parseFloat(Ut[ts][2]);break;case Fs:Lo=($r?"<":"(")+Ut[ts]+($r?">":")"),fr=dn(te),Br=br(Ne)}ro!==void 0&&ro[ts]!==void 0&&(Po=ro[ts]+` Tw
`),ts===0?P.push(Po+oo(fr,Br,Zn)+Lo):Co===Fs?P.push(Po+Lo):Co===La&&P.push(Po+oo(fr,Br,Zn)+Lo)}P=Co===Fs?P.join(` Tj
T* `):P.join(` Tj
`),P+=` Tj
`;var tr=`BT
/`;return tr+=Et+" "+Je+` Tf
`,tr+=Ue(Je*oi)+` TL
`,tr+=Ds+`
`,tr+=Fi,tr+=P,j(tr+="ET"),k[Et]=!0,ei};var Zr=b.__private__.clip=b.clip=function(P){return j(P==="evenodd"?"W*":"W"),this};b.clipEvenOdd=function(){return Zr("evenodd")},b.__private__.discardPath=b.discardPath=function(){return j("n"),this};var Vn=b.__private__.isValidStyle=function(P){var te=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(P)!==-1&&(te=!0),te};b.__private__.setDefaultPathOperation=b.setDefaultPathOperation=function(P){return Vn(P)&&(m=P),this};var Oa=b.__private__.getStyle=b.getStyle=function(P){var te=m;switch(P){case"D":case"S":te="S";break;case"F":te="f";break;case"FD":case"DF":te="B";break;case"f":case"f*":case"B":case"B*":te=P}return te},pa=b.close=function(){return j("h"),this};b.stroke=function(){return j("S"),this},b.fill=function(P){return yo("f",P),this},b.fillEvenOdd=function(P){return yo("f*",P),this},b.fillStroke=function(P){return yo("B",P),this},b.fillStrokeEvenOdd=function(P){return yo("B*",P),this};var yo=function(P,te){yi(te)==="object"?Ia(te,P):j(P)},Kr=function(P){P===null||se===Q.ADVANCED&&P===void 0||(P=Oa(P),j(P))};function Qs(P,te,Ne,Ke,ct){var Lt=new Bu(te||this.boundingBox,Ne||this.xStep,Ke||this.yStep,this.gState,ct||this.matrix);Lt.stream=this.stream;var Ut=P+"$$"+this.cloneIndex+++"$$";return gi(Ut,Lt),Lt}var Ia=function(P,te){var Ne=Dn[P.key],Ke=an[Ne];if(Ke instanceof Jl)j("q"),j(zo(te)),Ke.gState&&b.setGState(Ke.gState),j(P.matrix.toString()+" cm"),j("/"+Ne+" sh"),j("Q");else if(Ke instanceof Bu){var ct=new sn(1,0,0,-1,0,xo());P.matrix&&(ct=ct.multiply(P.matrix||Yt),Ne=Qs.call(Ke,P.key,P.boundingBox,P.xStep,P.yStep,ct).id),j("q"),j("/Pattern cs"),j("/"+Ne+" scn"),Ke.gState&&b.setGState(Ke.gState),j(te),j("Q")}},zo=function(P){switch(P){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},Bi=b.moveTo=function(P,te){return j(Ue(re(P))+" "+Ue(Y(te))+" m"),this},Ur=b.lineTo=function(P,te){return j(Ue(re(P))+" "+Ue(Y(te))+" l"),this},eo=b.curveTo=function(P,te,Ne,Ke,ct,Lt){return j([Ue(re(P)),Ue(Y(te)),Ue(re(Ne)),Ue(Y(Ke)),Ue(re(ct)),Ue(Y(Lt)),"c"].join(" ")),this};b.__private__.line=b.line=function(P,te,Ne,Ke,ct){if(isNaN(P)||isNaN(te)||isNaN(Ne)||isNaN(Ke)||!Vn(ct))throw new Error("Invalid arguments passed to jsPDF.line");return se===Q.COMPAT?this.lines([[Ne-P,Ke-te]],P,te,[1,1],ct||"S"):this.lines([[Ne-P,Ke-te]],P,te,[1,1]).stroke()},b.__private__.lines=b.lines=function(P,te,Ne,Ke,ct,Lt){var Ut,Kt,en,un,Ln,zn,mi,Zn,ei,Vi,Fi,$r;if(typeof P=="number"&&($r=Ne,Ne=te,te=P,P=$r),Ke=Ke||[1,1],Lt=Lt||!1,isNaN(te)||isNaN(Ne)||!Array.isArray(P)||!Array.isArray(Ke)||!Vn(ct)||typeof Lt!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Bi(te,Ne),Ut=Ke[0],Kt=Ke[1],un=P.length,Vi=te,Fi=Ne,en=0;en<un;en++)(Ln=P[en]).length===2?(Vi=Ln[0]*Ut+Vi,Fi=Ln[1]*Kt+Fi,Ur(Vi,Fi)):(zn=Ln[0]*Ut+Vi,mi=Ln[1]*Kt+Fi,Zn=Ln[2]*Ut+Vi,ei=Ln[3]*Kt+Fi,Vi=Ln[4]*Ut+Vi,Fi=Ln[5]*Kt+Fi,eo(zn,mi,Zn,ei,Vi,Fi));return Lt&&pa(),Kr(ct),this},b.path=function(P){for(var te=0;te<P.length;te++){var Ne=P[te],Ke=Ne.c;switch(Ne.op){case"m":Bi(Ke[0],Ke[1]);break;case"l":Ur(Ke[0],Ke[1]);break;case"c":eo.apply(this,Ke);break;case"h":pa()}}return this},b.__private__.rect=b.rect=function(P,te,Ne,Ke,ct){if(isNaN(P)||isNaN(te)||isNaN(Ne)||isNaN(Ke)||!Vn(ct))throw new Error("Invalid arguments passed to jsPDF.rect");return se===Q.COMPAT&&(Ke=-Ke),j([Ue(re(P)),Ue(Y(te)),Ue(re(Ne)),Ue(re(Ke)),"re"].join(" ")),Kr(ct),this},b.__private__.triangle=b.triangle=function(P,te,Ne,Ke,ct,Lt,Ut){if(isNaN(P)||isNaN(te)||isNaN(Ne)||isNaN(Ke)||isNaN(ct)||isNaN(Lt)||!Vn(Ut))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[Ne-P,Ke-te],[ct-Ne,Lt-Ke],[P-ct,te-Lt]],P,te,[1,1],Ut,!0),this},b.__private__.roundedRect=b.roundedRect=function(P,te,Ne,Ke,ct,Lt,Ut){if(isNaN(P)||isNaN(te)||isNaN(Ne)||isNaN(Ke)||isNaN(ct)||isNaN(Lt)||!Vn(Ut))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Kt=4/3*(Math.SQRT2-1);return ct=Math.min(ct,.5*Ne),Lt=Math.min(Lt,.5*Ke),this.lines([[Ne-2*ct,0],[ct*Kt,0,ct,Lt-Lt*Kt,ct,Lt],[0,Ke-2*Lt],[0,Lt*Kt,-ct*Kt,Lt,-ct,Lt],[2*ct-Ne,0],[-ct*Kt,0,-ct,-Lt*Kt,-ct,-Lt],[0,2*Lt-Ke],[0,-Lt*Kt,ct*Kt,-Lt,ct,-Lt]],P+ct,te,[1,1],Ut,!0),this},b.__private__.ellipse=b.ellipse=function(P,te,Ne,Ke,ct){if(isNaN(P)||isNaN(te)||isNaN(Ne)||isNaN(Ke)||!Vn(ct))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Lt=4/3*(Math.SQRT2-1)*Ne,Ut=4/3*(Math.SQRT2-1)*Ke;return Bi(P+Ne,te),eo(P+Ne,te-Ut,P+Lt,te-Ke,P,te-Ke),eo(P-Lt,te-Ke,P-Ne,te-Ut,P-Ne,te),eo(P-Ne,te+Ut,P-Lt,te+Ke,P,te+Ke),eo(P+Lt,te+Ke,P+Ne,te+Ut,P+Ne,te),Kr(ct),this},b.__private__.circle=b.circle=function(P,te,Ne,Ke){if(isNaN(P)||isNaN(te)||isNaN(Ne)||!Vn(Ke))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(P,te,Ne,Ne,Ke)},b.setFont=function(P,te,Ne){return Ne&&(te=$e(te,Ne)),Et=Ns(P,te,{disableWarning:!1}),this};var ol=b.__private__.getFont=b.getFont=function(){return Gt[Ns.apply(b,arguments)]};b.__private__.getFontList=b.getFontList=function(){var P,te,Ne={};for(P in nn)if(nn.hasOwnProperty(P))for(te in Ne[P]=[],nn[P])nn[P].hasOwnProperty(te)&&Ne[P].push(te);return Ne},b.addFont=function(P,te,Ne,Ke,ct){var Lt=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Lt.indexOf(arguments[3])!==-1?ct=arguments[3]:arguments[3]&&Lt.indexOf(arguments[3])==-1&&(Ne=$e(Ne,Ke)),ct=ct||"Identity-H",Ts.call(this,P,te,Ne,ct)};var Uo,ga=e.lineWidth||.200025,_o=b.__private__.getLineWidth=b.getLineWidth=function(){return ga},$o=b.__private__.setLineWidth=b.setLineWidth=function(P){return ga=P,j(Ue(re(P))+" w"),this};b.__private__.setLineDash=Cn.API.setLineDash=Cn.API.setLineDashPattern=function(P,te){if(P=P||[],te=te||0,isNaN(te)||!Array.isArray(P))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return P=P.map(function(Ne){return Ue(re(Ne))}).join(" "),te=Ue(re(te)),j("["+P+"] "+te+" d"),this};var Fa=b.__private__.getLineHeight=b.getLineHeight=function(){return Je*Uo};b.__private__.getLineHeight=b.getLineHeight=function(){return Je*Uo};var jn=b.__private__.setLineHeightFactor=b.setLineHeightFactor=function(P){return typeof(P=P||1.15)=="number"&&(Uo=P),this},ja=b.__private__.getLineHeightFactor=b.getLineHeightFactor=function(){return Uo};jn(e.lineHeight);var dn=b.__private__.getHorizontalCoordinate=function(P){return re(P)},br=b.__private__.getVerticalCoordinate=function(P){return se===Q.ADVANCED?P:$t[ie].mediaBox.topRightY-$t[ie].mediaBox.bottomLeftY-re(P)},qo=b.__private__.getHorizontalCoordinateString=b.getHorizontalCoordinateString=function(P){return Ue(dn(P))},bo=b.__private__.getVerticalCoordinateString=b.getVerticalCoordinateString=function(P){return Ue(br(P))},Sr=e.strokeColor||"0 G";b.__private__.getStrokeColor=b.getDrawColor=function(){return lr(Sr)},b.__private__.setStrokeColor=b.setDrawColor=function(P,te,Ne,Ke){return Sr=_r({ch1:P,ch2:te,ch3:Ne,ch4:Ke,pdfColorType:"draw",precision:2}),j(Sr),this};var za=e.fillColor||"0 g";b.__private__.getFillColor=b.getFillColor=function(){return lr(za)},b.__private__.setFillColor=b.setFillColor=function(P,te,Ne,Ke){return za=_r({ch1:P,ch2:te,ch3:Ne,ch4:Ke,pdfColorType:"fill",precision:2}),j(za),this};var Ds=e.textColor||"0 g",ma=b.__private__.getTextColor=b.getTextColor=function(){return lr(Ds)};b.__private__.setTextColor=b.setTextColor=function(P,te,Ne,Ke){return Ds=_r({ch1:P,ch2:te,ch3:Ne,ch4:Ke,pdfColorType:"text",precision:3}),this};var va=e.charSpace,Yr=b.__private__.getCharSpace=b.getCharSpace=function(){return parseFloat(va||0)};b.__private__.setCharSpace=b.setCharSpace=function(P){if(isNaN(P))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return va=P,this};var ya=0;b.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},b.__private__.setLineCap=b.setLineCap=function(P){var te=b.CapJoinStyles[P];if(te===void 0)throw new Error("Line cap style of '"+P+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return ya=te,j(te+" J"),this};var qi=0;b.__private__.setLineJoin=b.setLineJoin=function(P){var te=b.CapJoinStyles[P];if(te===void 0)throw new Error("Line join style of '"+P+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return qi=te,j(te+" j"),this},b.__private__.setLineMiterLimit=b.__private__.setMiterLimit=b.setLineMiterLimit=b.setMiterLimit=function(P){if(P=P||0,isNaN(P))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return j(Ue(re(P))+" M"),this},b.GState=Uh,b.setGState=function(P){(P=typeof P=="string"?Pn[Ui[P]]:al(null,P)).equals(Oi)||(j("/"+P.id+" gs"),Oi=P)};var al=function(P,te){if(!P||!Ui[P]){var Ne=!1;for(var Ke in Pn)if(Pn.hasOwnProperty(Ke)&&Pn[Ke].equals(te)){Ne=!0;break}if(Ne)te=Pn[Ke];else{var ct="GS"+(Object.keys(Pn).length+1).toString(10);Pn[ct]=te,te.id=ct}return P&&(Ui[P]=te.id),Bn.publish("addGState",te),te}};b.addGState=function(P,te){return al(P,te),this},b.saveGraphicsState=function(){return j("q"),$n.push({key:Et,size:Je,color:Ds}),this},b.restoreGraphicsState=function(){j("Q");var P=$n.pop();return Et=P.key,Je=P.size,Ds=P.color,Oi=null,this},b.setCurrentTransformationMatrix=function(P){return j(P.toString()+" cm"),this},b.comment=function(P){return j("#"+P),this};var Vo=function(P,te){var Ne=P||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return Ne},set:function(Lt){isNaN(Lt)||(Ne=parseFloat(Lt))}});var Ke=te||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return Ke},set:function(Lt){isNaN(Lt)||(Ke=parseFloat(Lt))}});var ct="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return ct},set:function(Lt){ct=Lt.toString()}}),this},Jr=function(P,te,Ne,Ke){Vo.call(this,P,te),this.type="rect";var ct=Ne||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return ct},set:function(Ut){isNaN(Ut)||(ct=parseFloat(Ut))}});var Lt=Ke||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Lt},set:function(Ut){isNaN(Ut)||(Lt=parseFloat(Ut))}}),this},_a=function(){this.page=qn,this.currentPage=ie,this.pages=ce.slice(0),this.pagesContext=$t.slice(0),this.x=nt,this.y=st,this.matrix=pn,this.width=wo(ie),this.height=xo(ie),this.outputDestination=Z,this.id="",this.objectNumber=-1};_a.prototype.restore=function(){qn=this.page,ie=this.currentPage,$t=this.pagesContext,ce=this.pages,nt=this.x,st=this.y,pn=this.matrix,Go(ie,this.width),Ti(ie,this.height),Z=this.outputDestination};var Ua=function(P,te,Ne,Ke,ct){pi.push(new _a),qn=ie=0,ce=[],nt=P,st=te,pn=ct,Qn([Ne,Ke])},$a=function(P){if(xi[P])pi.pop().restore();else{var te=new _a,Ne="Xo"+(Object.keys(Yn).length+1).toString(10);te.id=Ne,xi[P]=Ne,Yn[Ne]=te,Bn.publish("addFormObject",te),pi.pop().restore()}};for(var ba in b.beginFormObject=function(P,te,Ne,Ke,ct){return Ua(P,te,Ne,Ke,ct),this},b.endFormObject=function(P){return $a(P),this},b.doFormObject=function(P,te){var Ne=Yn[xi[P]];return j("q"),j(te.toString()+" cm"),j("/"+Ne.id+" Do"),j("Q"),this},b.getFormObject=function(P){var te=Yn[xi[P]];return{x:te.x,y:te.y,width:te.width,height:te.height,matrix:te.matrix}},b.save=function(P,te){return P=P||"generated.pdf",(te=te||{}).returnPromise=te.returnPromise||!1,te.returnPromise===!1?(Kl(Xs(gs()),P),typeof Kl.unload=="function"&&Sn.setTimeout&&setTimeout(Kl.unload,911),this):new Promise(function(Ne,Ke){try{var ct=Kl(Xs(gs()),P);typeof Kl.unload=="function"&&Sn.setTimeout&&setTimeout(Kl.unload,911),Ne(ct)}catch(Lt){Ke(Lt.message)}})},Cn.API)Cn.API.hasOwnProperty(ba)&&(ba==="events"&&Cn.API.events.length?function(P,te){var Ne,Ke,ct;for(ct=te.length-1;ct!==-1;ct--)Ne=te[ct][0],Ke=te[ct][1],P.subscribe.apply(P,[Ne].concat(typeof Ke=="function"?[Ke]:Ke))}(Bn,Cn.API.events):b[ba]=Cn.API[ba]);var wo=b.getPageWidth=function(P){return($t[P=P||ie].mediaBox.topRightX-$t[P].mediaBox.bottomLeftX)/St},Go=b.setPageWidth=function(P,te){$t[P].mediaBox.topRightX=te*St+$t[P].mediaBox.bottomLeftX},xo=b.getPageHeight=function(P){return($t[P=P||ie].mediaBox.topRightY-$t[P].mediaBox.bottomLeftY)/St},Ti=b.setPageHeight=function(P,te){$t[P].mediaBox.topRightY=te*St+$t[P].mediaBox.bottomLeftY};return b.internal={pdfEscape:Wn,getStyle:Oa,getFont:ol,getFontSize:yt,getCharSpace:Yr,getTextColor:ma,getLineHeight:Fa,getLineHeightFactor:ja,getLineWidth:_o,write:Fe,getHorizontalCoordinate:dn,getVerticalCoordinate:br,getCoordinateString:qo,getVerticalCoordinateString:bo,collections:{},newObject:In,newAdditionalObject:Ii,newObjectDeferred:bt,newObjectDeferredBegin:Xn,getFilters:Yi,putStream:ur,events:Bn,scaleFactor:St,pageSize:{getWidth:function(){return wo(ie)},setWidth:function(P){Go(ie,P)},getHeight:function(){return xo(ie)},setHeight:function(P){Ti(ie,P)}},encryptionOptions:y,encryption:$i,getEncryptor:sl,output:vo,getNumberOfPages:_i,pages:ce,out:j,f2:He,f3:ae,getPageInfo:fa,getPageInfoByObjId:kn,getCurrentPageInfo:An,getPDFVersion:$,Point:Vo,Rectangle:Jr,Matrix:sn,hasHotfix:da},Object.defineProperty(b.internal.pageSize,"width",{get:function(){return wo(ie)},set:function(P){Go(ie,P)},enumerable:!0,configurable:!0}),Object.defineProperty(b.internal.pageSize,"height",{get:function(){return xo(ie)},set:function(P){Ti(ie,P)},enumerable:!0,configurable:!0}),xn.call(b,De),Et="F1",ci(o,n),Bn.publish("initialized"),b}Su.prototype.lsbFirstWord=function(e){return String.fromCharCode(e>>0&255,e>>8&255,e>>16&255,e>>24&255)},Su.prototype.toHexString=function(e){return e.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Su.prototype.hexToBytes=function(e){for(var t=[],n=0;n<e.length;n+=2)t.push(String.fromCharCode(parseInt(e.substr(n,2),16)));return t.join("")},Su.prototype.processOwnerPassword=function(e,t){return If(Of(t).substr(0,5),e)},Su.prototype.encryptor=function(e,t){var n=Of(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&t,t>>8&255)).substr(0,10);return function(i){return If(n,i)}},Uh.prototype.equals=function(e){var t,n="id,objectNumber,equals";if(!e||yi(e)!==yi(this))return!1;var i=0;for(t in this)if(!(n.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!e.hasOwnProperty(t)||this[t]!==e[t])return!1;i++}for(t in e)e.hasOwnProperty(t)&&n.indexOf(t)<0&&i--;return i===0},Cn.API={events:[]},Cn.version="3.0.0";var Qi=Cn.API,fp=1,cu=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},xu=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Tn=function(e){return e.toFixed(2)},wl=function(e){return e.toFixed(5)};Qi.__acroform__={};var Ws=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},fg=function(e){return e*fp},ka=function(e){var t=new iv,n=on.internal.getHeight(e)||0,i=on.internal.getWidth(e)||0;return t.BBox=[0,0,Number(Tn(i)),Number(Tn(n))],t},TC=Qi.__acroform__.setBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|=1<<t},NC=Qi.__acroform__.clearBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&=~(1<<t)},DC=Qi.__acroform__.getBit=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return e&1<<t?1:0},nr=Qi.__acroform__.getBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return DC(e,t-1)},ir=Qi.__acroform__.setBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return TC(e,t-1)},rr=Qi.__acroform__.clearBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return NC(e,t-1)},RC=Qi.__acroform__.calculateCoordinates=function(e,t){var n=t.internal.getHorizontalCoordinate,i=t.internal.getVerticalCoordinate,o=e[0],a=e[1],u=e[2],d=e[3],f={};return f.lowerLeft_X=n(o)||0,f.lowerLeft_Y=i(a+d)||0,f.upperRight_X=n(o+u)||0,f.upperRight_Y=i(a)||0,[Number(Tn(f.lowerLeft_X)),Number(Tn(f.lowerLeft_Y)),Number(Tn(f.upperRight_X)),Number(Tn(f.upperRight_Y))]},OC=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var t=[],n=e._V||e.DV,i=Ff(e,n),o=e.scope.internal.getFont(e.fontName,e.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(e.scope.__private__.encodeColorString(e.color)),t.push("/"+o+" "+Tn(i.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(i.text),t.push("ET"),t.push("Q"),t.push("EMC");var a=ka(e);return a.scope=e.scope,a.stream=t.join(`
`),a}},Ff=function(e,t){var n=e.fontSize===0?e.maxFontSize:e.fontSize,i={text:"",fontSize:""},o=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");o=e.multiline?o.map(function(ae){return ae.split(`
`)}):o.map(function(ae){return[ae]});var a=n,u=on.internal.getHeight(e)||0;u=u<0?-u:u;var d=on.internal.getWidth(e)||0;d=d<0?-d:d;var f=function(ae,re,oe){if(ae+1<o.length){var Y=re+" "+o[ae+1][0];return oh(Y,e,oe).width<=d-4}return!1};a++;e:for(;a>0;){t="",a--;var m,y,x=oh("3",e,a).height,k=e.multiline?u-a:(u-x)/2,b=k+=2,T=0,$=0,H=0;if(a<=0){t=`(...) Tj
`,t+="% Width of Text: "+oh(t,e,a=12).width+", FieldWidth:"+d+`
`;break}for(var I="",Q=0,se=0;se<o.length;se++)if(o.hasOwnProperty(se)){var we=!1;if(o[se].length!==1&&H!==o[se].length-1){if((x+2)*(Q+2)+2>u)continue e;I+=o[se][H],we=!0,$=se,se--}else{I=(I+=o[se][H]+" ").substr(I.length-1)==" "?I.substr(0,I.length-1):I;var Be=parseInt(se),$e=f(Be,I,a),Ue=se>=o.length-1;if($e&&!Ue){I+=" ",H=0;continue}if($e||Ue){if(Ue)$=Be;else if(e.multiline&&(x+2)*(Q+2)+2>u)continue e}else{if(!e.multiline||(x+2)*(Q+2)+2>u)continue e;$=Be}}for(var Pe="",Te=T;Te<=$;Te++){var He=o[Te];if(e.multiline){if(Te===$){Pe+=He[H]+" ",H=(H+1)%He.length;continue}if(Te===T){Pe+=He[He.length-1]+" ";continue}}Pe+=He[0]+" "}switch(Pe=Pe.substr(Pe.length-1)==" "?Pe.substr(0,Pe.length-1):Pe,y=oh(Pe,e,a).width,e.textAlign){case"right":m=d-y-2;break;case"center":m=(d-y)/2;break;case"left":default:m=2}t+=Tn(m)+" "+Tn(b)+` Td
`,t+="("+cu(Pe)+`) Tj
`,t+=-Tn(m)+` 0 Td
`,b=-(a+2),y=0,T=we?$:$+1,Q++,I=""}break}return i.text=t,i.fontSize=a,i},oh=function(e,t,n){var i=t.scope.internal.getFont(t.fontName,t.fontStyle),o=t.scope.getStringUnitWidth(e,{font:i,fontSize:parseFloat(n),charSpace:0})*parseFloat(n);return{height:t.scope.getStringUnitWidth("3",{font:i,fontSize:parseFloat(n),charSpace:0})*parseFloat(n)*1.5,width:o}},IC={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},FC=function(e,t){var n={type:"reference",object:e};t.internal.getPageInfo(e.page).pageContext.annotations.find(function(i){return i.type===n.type&&i.object===n.object})===void 0&&t.internal.getPageInfo(e.page).pageContext.annotations.push(n)},jC=function(e,t){for(var n in e)if(e.hasOwnProperty(n)){var i=n,o=e[n];t.internal.newObjectDeferredBegin(o.objId,!0),yi(o)==="object"&&typeof o.putStream=="function"&&o.putStream(),delete e[i]}},zC=function(e,t){if(t.scope=e,e.internal!==void 0&&(e.internal.acroformPlugin===void 0||e.internal.acroformPlugin.isInitialized===!1)){if(aa.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(IC)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");fp=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new rv,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){(function(n){n.internal.events.unsubscribe(n.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete n.internal.acroformPlugin.acroFormDictionaryRoot._eventID,n.internal.acroformPlugin.printedOut=!0})(e)}),e.internal.events.subscribe("buildDocument",function(){(function(n){n.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var i=n.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];a.objId=void 0,a.hasAnnotation&&FC(a,n)}})(e)}),e.internal.events.subscribe("putCatalog",function(){(function(n){if(n.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");n.internal.write("/AcroForm "+n.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(e)}),e.internal.events.subscribe("postPutPages",function(n){(function(i,o){var a=!i;for(var u in i||(o.internal.newObjectDeferredBegin(o.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),o.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),i=i||o.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(i.hasOwnProperty(u)){var d=i[u],f=[],m=d.Rect;if(d.Rect&&(d.Rect=RC(d.Rect,o)),o.internal.newObjectDeferredBegin(d.objId,!0),d.DA=on.createDefaultAppearanceStream(d),yi(d)==="object"&&typeof d.getKeyValueListForStream=="function"&&(f=d.getKeyValueListForStream()),d.Rect=m,d.hasAppearanceStream&&!d.appearanceStreamContent){var y=OC(d);f.push({key:"AP",value:"<</N "+y+">>"}),o.internal.acroformPlugin.xForms.push(y)}if(d.appearanceStreamContent){var x="";for(var k in d.appearanceStreamContent)if(d.appearanceStreamContent.hasOwnProperty(k)){var b=d.appearanceStreamContent[k];if(x+="/"+k+" ",x+="<<",Object.keys(b).length>=1||Array.isArray(b)){for(var u in b)if(b.hasOwnProperty(u)){var T=b[u];typeof T=="function"&&(T=T.call(o,d)),x+="/"+u+" "+T+" ",o.internal.acroformPlugin.xForms.indexOf(T)>=0||o.internal.acroformPlugin.xForms.push(T)}}else typeof(T=b)=="function"&&(T=T.call(o,d)),x+="/"+u+" "+T,o.internal.acroformPlugin.xForms.indexOf(T)>=0||o.internal.acroformPlugin.xForms.push(T);x+=">>"}f.push({key:"AP",value:`<<
`+x+">>"})}o.internal.putStream({additionalKeyValues:f,objectId:d.objId}),o.internal.out("endobj")}a&&jC(o.internal.acroformPlugin.xForms,o)})(n,e)}),e.internal.acroformPlugin.isInitialized=!0}},nv=Qi.__acroform__.arrayToPdfArray=function(e,t,n){var i=function(u){return u};if(Array.isArray(e)){for(var o="[",a=0;a<e.length;a++)switch(a!==0&&(o+=" "),yi(e[a])){case"boolean":case"number":case"object":o+=e[a].toString();break;case"string":e[a].substr(0,1)!=="/"?(t!==void 0&&n&&(i=n.internal.getEncryptor(t)),o+="("+cu(i(e[a].toString()))+")"):o+=e[a].toString()}return o+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},Xd=function(e,t,n){var i=function(o){return o};return t!==void 0&&n&&(i=n.internal.getEncryptor(t)),(e=e||"").toString(),e="("+cu(i(e))+")"},Aa=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Aa.prototype.toString=function(){return this.objId+" 0 R"},Aa.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},Aa.prototype.getKeyValueListForStream=function(){var e=[],t=Object.getOwnPropertyNames(this).filter(function(a){return a!="content"&&a!="appearanceStreamContent"&&a!="scope"&&a!="objId"&&a.substring(0,1)!="_"});for(var n in t)if(Object.getOwnPropertyDescriptor(this,t[n]).configurable===!1){var i=t[n],o=this[i];o&&(Array.isArray(o)?e.push({key:i,value:nv(o,this.objId,this.scope)}):o instanceof Aa?(o.scope=this.scope,e.push({key:i,value:o.objId+" 0 R"})):typeof o!="function"&&e.push({key:i,value:o}))}return e};var iv=function(){Aa.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(n){t=n}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(n){e=n.trim()},get:function(){return e||null}})};Ws(iv,Aa);var rv=function(){Aa.call(this);var e,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var n=function(i){return i};return this.scope&&(n=this.scope.internal.getEncryptor(this.objId)),"("+cu(n(e))+")"}},set:function(n){e=n}})};Ws(rv,Aa);var aa=function e(){Aa.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(I){if(isNaN(I))throw new Error('Invalid value "'+I+'" for attribute F supplied.');t=I}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!nr(t,3)},set:function(I){I?this.F=ir(t,3):this.F=rr(t,3)}});var n=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return n},set:function(I){if(isNaN(I))throw new Error('Invalid value "'+I+'" for attribute Ff supplied.');n=I}});var i=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(i.length!==0)return i},set:function(I){i=I!==void 0?I:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[0])?0:i[0]},set:function(I){i[0]=I}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[1])?0:i[1]},set:function(I){i[1]=I}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[2])?0:i[2]},set:function(I){i[2]=I}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[3])?0:i[3]},set:function(I){i[3]=I}});var o="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return o},set:function(I){switch(I){case"/Btn":case"/Tx":case"/Ch":case"/Sig":o=I;break;default:throw new Error('Invalid value "'+I+'" for attribute FT supplied.')}}});var a=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!a||a.length<1){if(this instanceof $h)return;a="FieldObject"+e.FieldNum++}var I=function(Q){return Q};return this.scope&&(I=this.scope.internal.getEncryptor(this.objId)),"("+cu(I(a))+")"},set:function(I){a=I.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return a},set:function(I){a=I}});var u="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return u},set:function(I){u=I}});var d="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return d},set:function(I){d=I}});var f=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return f},set:function(I){f=I}});var m=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return m===void 0?50/fp:m},set:function(I){m=I}});var y="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return y},set:function(I){y=I}});var x="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!x||this instanceof $h||this instanceof ru))return Xd(x,this.objId,this.scope)},set:function(I){I=I.toString(),x=I}});var k=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(k)return this instanceof Or?k:Xd(k,this.objId,this.scope)},set:function(I){I=I.toString(),k=this instanceof Or?I:I.substr(0,1)==="("?xu(I.substr(1,I.length-2)):xu(I)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Or?xu(k.substr(1,k.length-1)):k},set:function(I){I=I.toString(),k=this instanceof Or?"/"+I:I}});var b=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(b)return b},set:function(I){this.V=I}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(b)return this instanceof Or?b:Xd(b,this.objId,this.scope)},set:function(I){I=I.toString(),b=this instanceof Or?I:I.substr(0,1)==="("?xu(I.substr(1,I.length-2)):xu(I)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Or?xu(b.substr(1,b.length-1)):b},set:function(I){I=I.toString(),b=this instanceof Or?"/"+I:I}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var T,$=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return $},set:function(I){I=!!I,$=I}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(T)return T},set:function(I){T=I}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!nr(this.Ff,1)},set:function(I){I?this.Ff=ir(this.Ff,1):this.Ff=rr(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!nr(this.Ff,2)},set:function(I){I?this.Ff=ir(this.Ff,2):this.Ff=rr(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!nr(this.Ff,3)},set:function(I){I?this.Ff=ir(this.Ff,3):this.Ff=rr(this.Ff,3)}});var H=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(H!==null)return H},set:function(I){if([0,1,2].indexOf(I)===-1)throw new Error('Invalid value "'+I+'" for attribute Q supplied.');H=I}}),Object.defineProperty(this,"textAlign",{get:function(){var I;switch(H){case 0:default:I="left";break;case 1:I="center";break;case 2:I="right"}return I},configurable:!0,enumerable:!0,set:function(I){switch(I){case"right":case 2:H=2;break;case"center":case 1:H=1;break;case"left":case 0:default:H=0}}})};Ws(aa,Aa);var Ou=function(){aa.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(n){e=n}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(n){e=n}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return nv(t,this.objId,this.scope)},set:function(n){var i,o;o=[],typeof(i=n)=="string"&&(o=function(a,u,d){d||(d=1);for(var f,m=[];f=u.exec(a);)m.push(f[d]);return m}(i,/\((.*?)\)/g)),t=o}}),this.getOptions=function(){return t},this.setOptions=function(n){t=n,this.sort&&t.sort()},this.addOption=function(n){n=(n=n||"").toString(),t.push(n),this.sort&&t.sort()},this.removeOption=function(n,i){for(i=i||!1,n=(n=n||"").toString();t.indexOf(n)!==-1&&(t.splice(t.indexOf(n),1),i!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!nr(this.Ff,18)},set:function(n){n?this.Ff=ir(this.Ff,18):this.Ff=rr(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!nr(this.Ff,19)},set:function(n){this.combo===!0&&(n?this.Ff=ir(this.Ff,19):this.Ff=rr(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!nr(this.Ff,20)},set:function(n){n?(this.Ff=ir(this.Ff,20),t.sort()):this.Ff=rr(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!nr(this.Ff,22)},set:function(n){n?this.Ff=ir(this.Ff,22):this.Ff=rr(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!nr(this.Ff,23)},set:function(n){n?this.Ff=ir(this.Ff,23):this.Ff=rr(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!nr(this.Ff,27)},set:function(n){n?this.Ff=ir(this.Ff,27):this.Ff=rr(this.Ff,27)}}),this.hasAppearanceStream=!1};Ws(Ou,aa);var Iu=function(){Ou.call(this),this.fontName="helvetica",this.combo=!1};Ws(Iu,Ou);var Fu=function(){Iu.call(this),this.combo=!0};Ws(Fu,Iu);var wh=function(){Fu.call(this),this.edit=!0};Ws(wh,Fu);var Or=function(){aa.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!nr(this.Ff,15)},set:function(n){n?this.Ff=ir(this.Ff,15):this.Ff=rr(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!nr(this.Ff,16)},set:function(n){n?this.Ff=ir(this.Ff,16):this.Ff=rr(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!nr(this.Ff,17)},set:function(n){n?this.Ff=ir(this.Ff,17):this.Ff=rr(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!nr(this.Ff,26)},set:function(n){n?this.Ff=ir(this.Ff,26):this.Ff=rr(this.Ff,26)}});var e,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var n=function(a){return a};if(this.scope&&(n=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var i,o=[];for(i in o.push("<<"),t)o.push("/"+i+" ("+cu(n(t[i]))+")");return o.push(">>"),o.join(`
`)}},set:function(n){yi(n)==="object"&&(t=n)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(n){typeof n=="string"&&(t.CA=n)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(n){e=n}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(n){e="/"+n}})};Ws(Or,aa);var xh=function(){Or.call(this),this.pushButton=!0};Ws(xh,Or);var ju=function(){Or.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t!==void 0?t:[]}})};Ws(ju,Or);var $h=function(){var e,t;aa.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(o){e=o}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(o){t=o}});var n,i={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var o=function(d){return d};this.scope&&(o=this.scope.internal.getEncryptor(this.objId));var a,u=[];for(a in u.push("<<"),i)u.push("/"+a+" ("+cu(o(i[a]))+")");return u.push(">>"),u.join(`
`)},set:function(o){yi(o)==="object"&&(i=o)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return i.CA||""},set:function(o){typeof o=="string"&&(i.CA=o)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return n},set:function(o){n=o}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return n.substr(1,n.length-1)},set:function(o){n="/"+o}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=on.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Ws($h,aa),ju.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var n=this.Kids[t];n.appearanceStreamContent=e.createAppearanceStream(n.optionName),n.caption=e.getCA()}},ju.prototype.createOption=function(e){var t=new $h;return t.Parent=this,t.optionName=e,this.Kids.push(t),UC.call(this.scope,t),t};var Lh=function(){Or.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=on.CheckBox.createAppearanceStream()};Ws(Lh,Or);var ru=function(){aa.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!nr(this.Ff,13)},set:function(t){t?this.Ff=ir(this.Ff,13):this.Ff=rr(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!nr(this.Ff,21)},set:function(t){t?this.Ff=ir(this.Ff,21):this.Ff=rr(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!nr(this.Ff,23)},set:function(t){t?this.Ff=ir(this.Ff,23):this.Ff=rr(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!nr(this.Ff,24)},set:function(t){t?this.Ff=ir(this.Ff,24):this.Ff=rr(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!nr(this.Ff,25)},set:function(t){t?this.Ff=ir(this.Ff,25):this.Ff=rr(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!nr(this.Ff,26)},set:function(t){t?this.Ff=ir(this.Ff,26):this.Ff=rr(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){Number.isInteger(t)&&(e=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Ws(ru,aa);var Ch=function(){ru.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!nr(this.Ff,14)},set:function(e){e?this.Ff=ir(this.Ff,14):this.Ff=rr(this.Ff,14)}}),this.password=!0};Ws(Ch,ru);var on={CheckBox:{createAppearanceStream:function(){return{N:{On:on.CheckBox.YesNormal},D:{On:on.CheckBox.YesPushDown,Off:on.CheckBox.OffPushDown}}},YesPushDown:function(e){var t=ka(e);t.scope=e.scope;var n=[],i=e.scope.internal.getFont(e.fontName,e.fontStyle).id,o=e.scope.__private__.encodeColorString(e.color),a=Ff(e,e.caption);return n.push("0.749023 g"),n.push("0 0 "+Tn(on.internal.getWidth(e))+" "+Tn(on.internal.getHeight(e))+" re"),n.push("f"),n.push("BMC"),n.push("q"),n.push("0 0 1 rg"),n.push("/"+i+" "+Tn(a.fontSize)+" Tf "+o),n.push("BT"),n.push(a.text),n.push("ET"),n.push("Q"),n.push("EMC"),t.stream=n.join(`
`),t},YesNormal:function(e){var t=ka(e);t.scope=e.scope;var n=e.scope.internal.getFont(e.fontName,e.fontStyle).id,i=e.scope.__private__.encodeColorString(e.color),o=[],a=on.internal.getHeight(e),u=on.internal.getWidth(e),d=Ff(e,e.caption);return o.push("1 g"),o.push("0 0 "+Tn(u)+" "+Tn(a)+" re"),o.push("f"),o.push("q"),o.push("0 0 1 rg"),o.push("0 0 "+Tn(u-1)+" "+Tn(a-1)+" re"),o.push("W"),o.push("n"),o.push("0 g"),o.push("BT"),o.push("/"+n+" "+Tn(d.fontSize)+" Tf "+i),o.push(d.text),o.push("ET"),o.push("Q"),t.stream=o.join(`
`),t},OffPushDown:function(e){var t=ka(e);t.scope=e.scope;var n=[];return n.push("0.749023 g"),n.push("0 0 "+Tn(on.internal.getWidth(e))+" "+Tn(on.internal.getHeight(e))+" re"),n.push("f"),t.stream=n.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(e){var t={D:{Off:on.RadioButton.Circle.OffPushDown},N:{}};return t.N[e]=on.RadioButton.Circle.YesNormal,t.D[e]=on.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(e){var t=ka(e);t.scope=e.scope;var n=[],i=on.internal.getWidth(e)<=on.internal.getHeight(e)?on.internal.getWidth(e)/4:on.internal.getHeight(e)/4;i=Number((.9*i).toFixed(5));var o=on.internal.Bezier_C,a=Number((i*o).toFixed(5));return n.push("q"),n.push("1 0 0 1 "+wl(on.internal.getWidth(e)/2)+" "+wl(on.internal.getHeight(e)/2)+" cm"),n.push(i+" 0 m"),n.push(i+" "+a+" "+a+" "+i+" 0 "+i+" c"),n.push("-"+a+" "+i+" -"+i+" "+a+" -"+i+" 0 c"),n.push("-"+i+" -"+a+" -"+a+" -"+i+" 0 -"+i+" c"),n.push(a+" -"+i+" "+i+" -"+a+" "+i+" 0 c"),n.push("f"),n.push("Q"),t.stream=n.join(`
`),t},YesPushDown:function(e){var t=ka(e);t.scope=e.scope;var n=[],i=on.internal.getWidth(e)<=on.internal.getHeight(e)?on.internal.getWidth(e)/4:on.internal.getHeight(e)/4;i=Number((.9*i).toFixed(5));var o=Number((2*i).toFixed(5)),a=Number((o*on.internal.Bezier_C).toFixed(5)),u=Number((i*on.internal.Bezier_C).toFixed(5));return n.push("0.749023 g"),n.push("q"),n.push("1 0 0 1 "+wl(on.internal.getWidth(e)/2)+" "+wl(on.internal.getHeight(e)/2)+" cm"),n.push(o+" 0 m"),n.push(o+" "+a+" "+a+" "+o+" 0 "+o+" c"),n.push("-"+a+" "+o+" -"+o+" "+a+" -"+o+" 0 c"),n.push("-"+o+" -"+a+" -"+a+" -"+o+" 0 -"+o+" c"),n.push(a+" -"+o+" "+o+" -"+a+" "+o+" 0 c"),n.push("f"),n.push("Q"),n.push("0 g"),n.push("q"),n.push("1 0 0 1 "+wl(on.internal.getWidth(e)/2)+" "+wl(on.internal.getHeight(e)/2)+" cm"),n.push(i+" 0 m"),n.push(i+" "+u+" "+u+" "+i+" 0 "+i+" c"),n.push("-"+u+" "+i+" -"+i+" "+u+" -"+i+" 0 c"),n.push("-"+i+" -"+u+" -"+u+" -"+i+" 0 -"+i+" c"),n.push(u+" -"+i+" "+i+" -"+u+" "+i+" 0 c"),n.push("f"),n.push("Q"),t.stream=n.join(`
`),t},OffPushDown:function(e){var t=ka(e);t.scope=e.scope;var n=[],i=on.internal.getWidth(e)<=on.internal.getHeight(e)?on.internal.getWidth(e)/4:on.internal.getHeight(e)/4;i=Number((.9*i).toFixed(5));var o=Number((2*i).toFixed(5)),a=Number((o*on.internal.Bezier_C).toFixed(5));return n.push("0.749023 g"),n.push("q"),n.push("1 0 0 1 "+wl(on.internal.getWidth(e)/2)+" "+wl(on.internal.getHeight(e)/2)+" cm"),n.push(o+" 0 m"),n.push(o+" "+a+" "+a+" "+o+" 0 "+o+" c"),n.push("-"+a+" "+o+" -"+o+" "+a+" -"+o+" 0 c"),n.push("-"+o+" -"+a+" -"+a+" -"+o+" 0 -"+o+" c"),n.push(a+" -"+o+" "+o+" -"+a+" "+o+" 0 c"),n.push("f"),n.push("Q"),t.stream=n.join(`
`),t}},Cross:{createAppearanceStream:function(e){var t={D:{Off:on.RadioButton.Cross.OffPushDown},N:{}};return t.N[e]=on.RadioButton.Cross.YesNormal,t.D[e]=on.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(e){var t=ka(e);t.scope=e.scope;var n=[],i=on.internal.calculateCross(e);return n.push("q"),n.push("1 1 "+Tn(on.internal.getWidth(e)-2)+" "+Tn(on.internal.getHeight(e)-2)+" re"),n.push("W"),n.push("n"),n.push(Tn(i.x1.x)+" "+Tn(i.x1.y)+" m"),n.push(Tn(i.x2.x)+" "+Tn(i.x2.y)+" l"),n.push(Tn(i.x4.x)+" "+Tn(i.x4.y)+" m"),n.push(Tn(i.x3.x)+" "+Tn(i.x3.y)+" l"),n.push("s"),n.push("Q"),t.stream=n.join(`
`),t},YesPushDown:function(e){var t=ka(e);t.scope=e.scope;var n=on.internal.calculateCross(e),i=[];return i.push("0.749023 g"),i.push("0 0 "+Tn(on.internal.getWidth(e))+" "+Tn(on.internal.getHeight(e))+" re"),i.push("f"),i.push("q"),i.push("1 1 "+Tn(on.internal.getWidth(e)-2)+" "+Tn(on.internal.getHeight(e)-2)+" re"),i.push("W"),i.push("n"),i.push(Tn(n.x1.x)+" "+Tn(n.x1.y)+" m"),i.push(Tn(n.x2.x)+" "+Tn(n.x2.y)+" l"),i.push(Tn(n.x4.x)+" "+Tn(n.x4.y)+" m"),i.push(Tn(n.x3.x)+" "+Tn(n.x3.y)+" l"),i.push("s"),i.push("Q"),t.stream=i.join(`
`),t},OffPushDown:function(e){var t=ka(e);t.scope=e.scope;var n=[];return n.push("0.749023 g"),n.push("0 0 "+Tn(on.internal.getWidth(e))+" "+Tn(on.internal.getHeight(e))+" re"),n.push("f"),t.stream=n.join(`
`),t}}},createDefaultAppearanceStream:function(e){var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,n=e.scope.__private__.encodeColorString(e.color);return"/"+t+" "+e.fontSize+" Tf "+n}};on.internal={Bezier_C:.551915024494,calculateCross:function(e){var t=on.internal.getWidth(e),n=on.internal.getHeight(e),i=Math.min(t,n);return{x1:{x:(t-i)/2,y:(n-i)/2+i},x2:{x:(t-i)/2+i,y:(n-i)/2},x3:{x:(t-i)/2,y:(n-i)/2},x4:{x:(t-i)/2+i,y:(n-i)/2+i}}}},on.internal.getWidth=function(e){var t=0;return yi(e)==="object"&&(t=fg(e.Rect[2])),t},on.internal.getHeight=function(e){var t=0;return yi(e)==="object"&&(t=fg(e.Rect[3])),t};var UC=Qi.addField=function(e){if(zC(this,e),!(e instanceof aa))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=e).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};Qi.AcroFormChoiceField=Ou,Qi.AcroFormListBox=Iu,Qi.AcroFormComboBox=Fu,Qi.AcroFormEditBox=wh,Qi.AcroFormButton=Or,Qi.AcroFormPushButton=xh,Qi.AcroFormRadioButton=ju,Qi.AcroFormCheckBox=Lh,Qi.AcroFormTextField=ru,Qi.AcroFormPasswordField=Ch,Qi.AcroFormAppearance=on,Qi.AcroForm={ChoiceField:Ou,ListBox:Iu,ComboBox:Fu,EditBox:wh,Button:Or,PushButton:xh,RadioButton:ju,CheckBox:Lh,TextField:ru,PasswordField:Ch,Appearance:on},Cn.AcroForm={ChoiceField:Ou,ListBox:Iu,ComboBox:Fu,EditBox:wh,Button:Or,PushButton:xh,RadioButton:ju,CheckBox:Lh,TextField:ru,PasswordField:Ch,Appearance:on};Cn.AcroForm;function sv(e){return e.reduce(function(t,n,i){return t[n]=i,t},{})}(function(e){e.__addimage__={};var t="UNKNOWN",n={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},i=e.__addimage__.getImageFileTypeByImageData=function(ae,re){var oe,Y,C,N,K,J=t;if((re=re||t)==="RGBA"||ae.data!==void 0&&ae.data instanceof Uint8ClampedArray&&"height"in ae&&"width"in ae)return"RGBA";if($e(ae))for(K in n)for(C=n[K],oe=0;oe<C.length;oe+=1){for(N=!0,Y=0;Y<C[oe].length;Y+=1)if(C[oe][Y]!==void 0&&C[oe][Y]!==ae[Y]){N=!1;break}if(N===!0){J=K;break}}else for(K in n)for(C=n[K],oe=0;oe<C.length;oe+=1){for(N=!0,Y=0;Y<C[oe].length;Y+=1)if(C[oe][Y]!==void 0&&C[oe][Y]!==ae.charCodeAt(Y)){N=!1;break}if(N===!0){J=K;break}}return J===t&&re!==t&&(J=re),J},o=function ae(re){for(var oe=this.internal.write,Y=this.internal.putStream,C=(0,this.internal.getFilters)();C.indexOf("FlateEncode")!==-1;)C.splice(C.indexOf("FlateEncode"),1);re.objectId=this.internal.newObject();var N=[];if(N.push({key:"Type",value:"/XObject"}),N.push({key:"Subtype",value:"/Image"}),N.push({key:"Width",value:re.width}),N.push({key:"Height",value:re.height}),re.colorSpace===H.INDEXED?N.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(re.palette.length/3-1)+" "+("sMask"in re&&re.sMask!==void 0?re.objectId+2:re.objectId+1)+" 0 R]"}):(N.push({key:"ColorSpace",value:"/"+re.colorSpace}),re.colorSpace===H.DEVICE_CMYK&&N.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),N.push({key:"BitsPerComponent",value:re.bitsPerComponent}),"decodeParameters"in re&&re.decodeParameters!==void 0&&N.push({key:"DecodeParms",value:"<<"+re.decodeParameters+">>"}),"transparency"in re&&Array.isArray(re.transparency)){for(var K="",J=0,Ee=re.transparency.length;J<Ee;J++)K+=re.transparency[J]+" "+re.transparency[J]+" ";N.push({key:"Mask",value:"["+K+"]"})}re.sMask!==void 0&&N.push({key:"SMask",value:re.objectId+1+" 0 R"});var ue=re.filter!==void 0?["/"+re.filter]:void 0;if(Y({data:re.data,additionalKeyValues:N,alreadyAppliedFilters:ue,objectId:re.objectId}),oe("endobj"),"sMask"in re&&re.sMask!==void 0){var ye="/Predictor "+re.predictor+" /Colors 1 /BitsPerComponent "+re.bitsPerComponent+" /Columns "+re.width,O={width:re.width,height:re.height,colorSpace:"DeviceGray",bitsPerComponent:re.bitsPerComponent,decodeParameters:ye,data:re.sMask};"filter"in re&&(O.filter=re.filter),ae.call(this,O)}if(re.colorSpace===H.INDEXED){var ie=this.internal.newObject();Y({data:Pe(new Uint8Array(re.palette)),objectId:ie}),oe("endobj")}},a=function(){var ae=this.internal.collections.addImage_images;for(var re in ae)o.call(this,ae[re])},u=function(){var ae,re=this.internal.collections.addImage_images,oe=this.internal.write;for(var Y in re)oe("/I"+(ae=re[Y]).index,ae.objectId,"0","R")},d=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",a),this.internal.events.subscribe("putXobjectDict",u))},f=function(){var ae=this.internal.collections.addImage_images;return d.call(this),ae},m=function(){return Object.keys(this.internal.collections.addImage_images).length},y=function(ae){return typeof e["process"+ae.toUpperCase()]=="function"},x=function(ae){return yi(ae)==="object"&&ae.nodeType===1},k=function(ae,re){if(ae.nodeName==="IMG"&&ae.hasAttribute("src")){var oe=""+ae.getAttribute("src");if(oe.indexOf("data:image/")===0)return wc(unescape(oe).split("base64,").pop());var Y=e.loadFile(oe,!0);if(Y!==void 0)return Y}if(ae.nodeName==="CANVAS"){if(ae.width===0||ae.height===0)throw new Error("Given canvas must have data. Canvas width: "+ae.width+", height: "+ae.height);var C;switch(re){case"PNG":C="image/png";break;case"WEBP":C="image/webp";break;case"JPEG":case"JPG":default:C="image/jpeg"}return wc(ae.toDataURL(C,1).split("base64,").pop())}},b=function(ae){var re=this.internal.collections.addImage_images;if(re){for(var oe in re)if(ae===re[oe].alias)return re[oe]}},T=function(ae,re,oe){return ae||re||(ae=-96,re=-96),ae<0&&(ae=-1*oe.width*72/ae/this.internal.scaleFactor),re<0&&(re=-1*oe.height*72/re/this.internal.scaleFactor),ae===0&&(ae=re*oe.width/oe.height),re===0&&(re=ae*oe.height/oe.width),[ae,re]},$=function(ae,re,oe,Y,C,N){var K=T.call(this,oe,Y,C),J=this.internal.getCoordinateString,Ee=this.internal.getVerticalCoordinateString,ue=f.call(this);if(oe=K[0],Y=K[1],ue[C.index]=C,N){N*=Math.PI/180;var ye=Math.cos(N),O=Math.sin(N),ie=function(fe){return fe.toFixed(4)},le=[ie(ye),ie(O),ie(-1*O),ie(ye),0,0,"cm"]}this.internal.write("q"),N?(this.internal.write([1,"0","0",1,J(ae),Ee(re+Y),"cm"].join(" ")),this.internal.write(le.join(" ")),this.internal.write([J(oe),"0","0",J(Y),"0","0","cm"].join(" "))):this.internal.write([J(oe),"0","0",J(Y),J(ae),Ee(re+Y),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+C.index+" Do"),this.internal.write("Q")},H=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var I=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},Q=e.__addimage__.sHashCode=function(ae){var re,oe,Y=0;if(typeof ae=="string")for(oe=ae.length,re=0;re<oe;re++)Y=(Y<<5)-Y+ae.charCodeAt(re),Y|=0;else if($e(ae))for(oe=ae.byteLength/2,re=0;re<oe;re++)Y=(Y<<5)-Y+ae[re],Y|=0;return Y},se=e.__addimage__.validateStringAsBase64=function(ae){(ae=ae||"").toString().trim();var re=!0;return ae.length===0&&(re=!1),ae.length%4!=0&&(re=!1),/^[A-Za-z0-9+/]+$/.test(ae.substr(0,ae.length-2))===!1&&(re=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(ae.substr(-2))===!1&&(re=!1),re},we=e.__addimage__.extractImageFromDataUrl=function(ae){var re=(ae=ae||"").split("base64,"),oe=null;if(re.length===2){var Y=/^data:(\w*\/\w*);*(charset=(?!charset=)[\w=-]*)*;*$/.exec(re[0]);Array.isArray(Y)&&(oe={mimeType:Y[1],charset:Y[2],data:re[1]})}return oe},Be=e.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};e.__addimage__.isArrayBuffer=function(ae){return Be()&&ae instanceof ArrayBuffer};var $e=e.__addimage__.isArrayBufferView=function(ae){return Be()&&typeof Uint32Array<"u"&&(ae instanceof Int8Array||ae instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&ae instanceof Uint8ClampedArray||ae instanceof Int16Array||ae instanceof Uint16Array||ae instanceof Int32Array||ae instanceof Uint32Array||ae instanceof Float32Array||ae instanceof Float64Array)},Ue=e.__addimage__.binaryStringToUint8Array=function(ae){for(var re=ae.length,oe=new Uint8Array(re),Y=0;Y<re;Y++)oe[Y]=ae.charCodeAt(Y);return oe},Pe=e.__addimage__.arrayBufferToBinaryString=function(ae){for(var re="",oe=$e(ae)?ae:new Uint8Array(ae),Y=0;Y<oe.length;Y+=8192)re+=String.fromCharCode.apply(null,oe.subarray(Y,Y+8192));return re};e.addImage=function(){var ae,re,oe,Y,C,N,K,J,Ee;if(typeof arguments[1]=="number"?(re=t,oe=arguments[1],Y=arguments[2],C=arguments[3],N=arguments[4],K=arguments[5],J=arguments[6],Ee=arguments[7]):(re=arguments[1],oe=arguments[2],Y=arguments[3],C=arguments[4],N=arguments[5],K=arguments[6],J=arguments[7],Ee=arguments[8]),yi(ae=arguments[0])==="object"&&!x(ae)&&"imageData"in ae){var ue=ae;ae=ue.imageData,re=ue.format||re||t,oe=ue.x||oe||0,Y=ue.y||Y||0,C=ue.w||ue.width||C,N=ue.h||ue.height||N,K=ue.alias||K,J=ue.compression||J,Ee=ue.rotation||ue.angle||Ee}var ye=this.internal.getFilters();if(J===void 0&&ye.indexOf("FlateEncode")!==-1&&(J="SLOW"),isNaN(oe)||isNaN(Y))throw new Error("Invalid coordinates passed to jsPDF.addImage");d.call(this);var O=Te.call(this,ae,re,K,J);return $.call(this,oe,Y,C,N,O,Ee),this};var Te=function(ae,re,oe,Y){var C,N,K;if(typeof ae=="string"&&i(ae)===t){ae=unescape(ae);var J=He(ae,!1);(J!==""||(J=e.loadFile(ae,!0))!==void 0)&&(ae=J)}if(x(ae)&&(ae=k(ae,re)),re=i(ae,re),!y(re))throw new Error("addImage does not support files of type '"+re+"', please ensure that a plugin for '"+re+"' support is added.");if(((K=oe)==null||K.length===0)&&(oe=function(Ee){return typeof Ee=="string"||$e(Ee)?Q(Ee):$e(Ee.data)?Q(Ee.data):null}(ae)),(C=b.call(this,oe))||(Be()&&(ae instanceof Uint8Array||re==="RGBA"||(N=ae,ae=Ue(ae))),C=this["process"+re.toUpperCase()](ae,m.call(this),oe,function(Ee){return Ee&&typeof Ee=="string"&&(Ee=Ee.toUpperCase()),Ee in e.image_compression?Ee:I.NONE}(Y),N)),!C)throw new Error("An unknown error occurred whilst processing the image.");return C},He=e.__addimage__.convertBase64ToBinaryString=function(ae,re){var oe;re=typeof re!="boolean"||re;var Y,C="";if(typeof ae=="string"){Y=(oe=we(ae))!==null?oe.data:ae;try{C=wc(Y)}catch(N){if(re)throw se(Y)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+N.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return C};e.getImageProperties=function(ae){var re,oe,Y="";if(x(ae)&&(ae=k(ae)),typeof ae=="string"&&i(ae)===t&&((Y=He(ae,!1))===""&&(Y=e.loadFile(ae)||""),ae=Y),oe=i(ae),!y(oe))throw new Error("addImage does not support files of type '"+oe+"', please ensure that a plugin for '"+oe+"' support is added.");if(!Be()||ae instanceof Uint8Array||(ae=Ue(ae)),!(re=this["process"+oe.toUpperCase()](ae)))throw new Error("An unknown error occurred whilst processing the image");return re.fileType=oe,re}})(Cn.API),function(e){var t=function(n){if(n!==void 0&&n!="")return!0};Cn.API.events.push(["addPage",function(n){this.internal.getPageInfo(n.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(n){for(var i,o,a,u=this.internal.getCoordinateString,d=this.internal.getVerticalCoordinateString,f=this.internal.getPageInfoByObjId(n.objId),m=n.pageContext.annotations,y=!1,x=0;x<m.length&&!y;x++)switch((i=m[x]).type){case"link":(t(i.options.url)||t(i.options.pageNumber))&&(y=!0);break;case"reference":case"text":case"freetext":y=!0}if(y!=0){this.internal.write("/Annots [");for(var k=0;k<m.length;k++){i=m[k];var b=this.internal.pdfEscape,T=this.internal.getEncryptor(n.objId);switch(i.type){case"reference":this.internal.write(" "+i.object.objId+" 0 R ");break;case"text":var $=this.internal.newAdditionalObject(),H=this.internal.newAdditionalObject(),I=this.internal.getEncryptor($.objId),Q=i.title||"Note";a="<</Type /Annot /Subtype /Text "+(o="/Rect ["+u(i.bounds.x)+" "+d(i.bounds.y+i.bounds.h)+" "+u(i.bounds.x+i.bounds.w)+" "+d(i.bounds.y)+"] ")+"/Contents ("+b(I(i.contents))+")",a+=" /Popup "+H.objId+" 0 R",a+=" /P "+f.objId+" 0 R",a+=" /T ("+b(I(Q))+") >>",$.content=a;var se=$.objId+" 0 R";a="<</Type /Annot /Subtype /Popup "+(o="/Rect ["+u(i.bounds.x+30)+" "+d(i.bounds.y+i.bounds.h)+" "+u(i.bounds.x+i.bounds.w+30)+" "+d(i.bounds.y)+"] ")+" /Parent "+se,i.open&&(a+=" /Open true"),a+=" >>",H.content=a,this.internal.write($.objId,"0 R",H.objId,"0 R");break;case"freetext":o="/Rect ["+u(i.bounds.x)+" "+d(i.bounds.y)+" "+u(i.bounds.x+i.bounds.w)+" "+d(i.bounds.y+i.bounds.h)+"] ";var we=i.color||"#000000";a="<</Type /Annot /Subtype /FreeText "+o+"/Contents ("+b(T(i.contents))+")",a+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+we+")",a+=" /Border [0 0 0]",a+=" >>",this.internal.write(a);break;case"link":if(i.options.name){var Be=this.annotations._nameMap[i.options.name];i.options.pageNumber=Be.page,i.options.top=Be.y}else i.options.top||(i.options.top=0);if(o="/Rect ["+i.finalBounds.x+" "+i.finalBounds.y+" "+i.finalBounds.w+" "+i.finalBounds.h+"] ",a="",i.options.url)a="<</Type /Annot /Subtype /Link "+o+"/Border [0 0 0] /A <</S /URI /URI ("+b(T(i.options.url))+") >>";else if(i.options.pageNumber)switch(a="<</Type /Annot /Subtype /Link "+o+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(i.options.pageNumber).objId+" 0 R",i.options.magFactor=i.options.magFactor||"XYZ",i.options.magFactor){case"Fit":a+=" /Fit]";break;case"FitH":a+=" /FitH "+i.options.top+"]";break;case"FitV":i.options.left=i.options.left||0,a+=" /FitV "+i.options.left+"]";break;case"XYZ":default:var $e=d(i.options.top);i.options.left=i.options.left||0,i.options.zoom===void 0&&(i.options.zoom=0),a+=" /XYZ "+i.options.left+" "+$e+" "+i.options.zoom+"]"}a!=""&&(a+=" >>",this.internal.write(a))}}this.internal.write("]")}}]),e.createAnnotation=function(n){var i=this.internal.getCurrentPageInfo();switch(n.type){case"link":this.link(n.bounds.x,n.bounds.y,n.bounds.w,n.bounds.h,n);break;case"text":case"freetext":i.pageContext.annotations.push(n)}},e.link=function(n,i,o,a,u){var d=this.internal.getCurrentPageInfo(),f=this.internal.getCoordinateString,m=this.internal.getVerticalCoordinateString;d.pageContext.annotations.push({finalBounds:{x:f(n),y:m(i),w:f(n+o),h:m(i+a)},options:u,type:"link"})},e.textWithLink=function(n,i,o,a){var u,d,f=this.getTextWidth(n),m=this.internal.getLineHeight()/this.internal.scaleFactor;if(a.maxWidth!==void 0){d=a.maxWidth;var y=this.splitTextToSize(n,d).length;u=Math.ceil(m*y)}else d=f,u=m;return this.text(n,i,o,a),o+=.2*m,a.align==="center"&&(i-=f/2),a.align==="right"&&(i-=f),this.link(i,o-m,d,u,a),f},e.getTextWidth=function(n){var i=this.internal.getFontSize();return this.getStringUnitWidth(n)*i/this.internal.scaleFactor}}(Cn.API),function(e){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},n={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},i={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},o=[1570,1571,1573,1575];e.__arabicParser__={};var a=e.__arabicParser__.isInArabicSubstitutionA=function($){return t[$.charCodeAt(0)]!==void 0},u=e.__arabicParser__.isArabicLetter=function($){return typeof $=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test($)},d=e.__arabicParser__.isArabicEndLetter=function($){return u($)&&a($)&&t[$.charCodeAt(0)].length<=2},f=e.__arabicParser__.isArabicAlfLetter=function($){return u($)&&o.indexOf($.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function($){return u($)&&a($)&&t[$.charCodeAt(0)].length>=1};var m=e.__arabicParser__.arabicLetterHasFinalForm=function($){return u($)&&a($)&&t[$.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function($){return u($)&&a($)&&t[$.charCodeAt(0)].length>=3};var y=e.__arabicParser__.arabicLetterHasMedialForm=function($){return u($)&&a($)&&t[$.charCodeAt(0)].length==4},x=e.__arabicParser__.resolveLigatures=function($){var H=0,I=n,Q="",se=0;for(H=0;H<$.length;H+=1)I[$.charCodeAt(H)]!==void 0?(se++,typeof(I=I[$.charCodeAt(H)])=="number"&&(Q+=String.fromCharCode(I),I=n,se=0),H===$.length-1&&(I=n,Q+=$.charAt(H-(se-1)),H-=se-1,se=0)):(I=n,Q+=$.charAt(H-se),H-=se,se=0);return Q};e.__arabicParser__.isArabicDiacritic=function($){return $!==void 0&&i[$.charCodeAt(0)]!==void 0};var k=e.__arabicParser__.getCorrectForm=function($,H,I){return u($)?a($)===!1?-1:!m($)||!u(H)&&!u(I)||!u(I)&&d(H)||d($)&&!u(H)||d($)&&f(H)||d($)&&d(H)?0:y($)&&u(H)&&!d(H)&&u(I)&&m(I)?3:d($)||!u(I)?1:2:-1},b=function($){var H=0,I=0,Q=0,se="",we="",Be="",$e=($=$||"").split("\\s+"),Ue=[];for(H=0;H<$e.length;H+=1){for(Ue.push(""),I=0;I<$e[H].length;I+=1)se=$e[H][I],we=$e[H][I-1],Be=$e[H][I+1],u(se)?(Q=k(se,we,Be),Ue[H]+=Q!==-1?String.fromCharCode(t[se.charCodeAt(0)][Q]):se):Ue[H]+=se;Ue[H]=x(Ue[H])}return Ue.join(" ")},T=e.__arabicParser__.processArabic=e.processArabic=function(){var $,H=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,I=[];if(Array.isArray(H)){var Q=0;for(I=[],Q=0;Q<H.length;Q+=1)Array.isArray(H[Q])?I.push([b(H[Q][0]),H[Q][1],H[Q][2]]):I.push([b(H[Q])]);$=I}else $=b(H);return typeof arguments[0]=="string"?$:(arguments[0].text=$,arguments[0])};e.events.push(["preProcessText",T])}(Cn.API),Cn.API.autoPrint=function(e){var t;switch((e=e||{}).variant=e.variant||"non-conform",e.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})}return this},function(e){var t=function(){var n=void 0;Object.defineProperty(this,"pdf",{get:function(){return n},set:function(d){n=d}});var i=150;Object.defineProperty(this,"width",{get:function(){return i},set:function(d){i=isNaN(d)||Number.isInteger(d)===!1||d<0?150:d,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=i+1)}});var o=300;Object.defineProperty(this,"height",{get:function(){return o},set:function(d){o=isNaN(d)||Number.isInteger(d)===!1||d<0?300:d,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=o+1)}});var a=[];Object.defineProperty(this,"childNodes",{get:function(){return a},set:function(d){a=d}});var u={};Object.defineProperty(this,"style",{get:function(){return u},set:function(d){u=d}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(n,i){var o;if((n=n||"2d")!=="2d")return null;for(o in i)this.pdf.context2d.hasOwnProperty(o)&&(this.pdf.context2d[o]=i[o]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(Cn.API),function(e){var t={left:0,top:0,bottom:0,right:0},n=!1,i=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),o.call(this))},o=function(){this.internal.__cell__.lastCell=new a,this.internal.__cell__.pages=1},a=function(){var f=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return f},set:function($){f=$}});var m=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return m},set:function($){m=$}});var y=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return y},set:function($){y=$}});var x=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return x},set:function($){x=$}});var k=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return k},set:function($){k=$}});var b=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return b},set:function($){b=$}});var T=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return T},set:function($){T=$}}),this};a.prototype.clone=function(){return new a(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},a.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(f){return i.call(this),this.internal.__cell__.headerFunction=typeof f=="function"?f:void 0,this},e.getTextDimensions=function(f,m){i.call(this);var y=(m=m||{}).fontSize||this.getFontSize(),x=m.font||this.getFont(),k=m.scaleFactor||this.internal.scaleFactor,b=0,T=0,$=0,H=this;if(!Array.isArray(f)&&typeof f!="string"){if(typeof f!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");f=String(f)}var I=m.maxWidth;I>0?typeof f=="string"?f=this.splitTextToSize(f,I):Object.prototype.toString.call(f)==="[object Array]"&&(f=f.reduce(function(se,we){return se.concat(H.splitTextToSize(we,I))},[])):f=Array.isArray(f)?f:[f];for(var Q=0;Q<f.length;Q++)b<($=this.getStringUnitWidth(f[Q],{font:x})*y)&&(b=$);return b!==0&&(T=f.length),{w:b/=k,h:Math.max((T*y*this.getLineHeightFactor()-y*(this.getLineHeightFactor()-1))/k,0)}},e.cellAddPage=function(){i.call(this),this.addPage();var f=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new a(f.left,f.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var u=e.cell=function(){var f;f=arguments[0]instanceof a?arguments[0]:new a(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),i.call(this);var m=this.internal.__cell__.lastCell,y=this.internal.__cell__.padding,x=this.internal.__cell__.margins||t,k=this.internal.__cell__.tableHeaderRow,b=this.internal.__cell__.printHeaders;return m.lineNumber!==void 0&&(m.lineNumber===f.lineNumber?(f.x=(m.x||0)+(m.width||0),f.y=m.y||0):m.y+m.height+f.height+x.bottom>this.getPageHeight()?(this.cellAddPage(),f.y=x.top,b&&k&&(this.printHeaderRow(f.lineNumber,!0),f.y+=k[0].height)):f.y=m.y+m.height||f.y),f.text[0]!==void 0&&(this.rect(f.x,f.y,f.width,f.height,n===!0?"FD":void 0),f.align==="right"?this.text(f.text,f.x+f.width-y,f.y+y,{align:"right",baseline:"top"}):f.align==="center"?this.text(f.text,f.x+f.width/2,f.y+y,{align:"center",baseline:"top",maxWidth:f.width-y-y}):this.text(f.text,f.x+y,f.y+y,{align:"left",baseline:"top",maxWidth:f.width-y-y})),this.internal.__cell__.lastCell=f,this};e.table=function(f,m,y,x,k){if(i.call(this),!y)throw new Error("No data for PDF table.");var b,T,$,H,I=[],Q=[],se=[],we={},Be={},$e=[],Ue=[],Pe=(k=k||{}).autoSize||!1,Te=k.printHeaders!==!1,He=k.css&&k.css["font-size"]!==void 0?16*k.css["font-size"]:k.fontSize||12,ae=k.margins||Object.assign({width:this.getPageWidth()},t),re=typeof k.padding=="number"?k.padding:3,oe=k.headerBackgroundColor||"#c8c8c8",Y=k.headerTextColor||"#000";if(o.call(this),this.internal.__cell__.printHeaders=Te,this.internal.__cell__.margins=ae,this.internal.__cell__.table_font_size=He,this.internal.__cell__.padding=re,this.internal.__cell__.headerBackgroundColor=oe,this.internal.__cell__.headerTextColor=Y,this.setFontSize(He),x==null)Q=I=Object.keys(y[0]),se=I.map(function(){return"left"});else if(Array.isArray(x)&&yi(x[0])==="object")for(I=x.map(function(ue){return ue.name}),Q=x.map(function(ue){return ue.prompt||ue.name||""}),se=x.map(function(ue){return ue.align||"left"}),b=0;b<x.length;b+=1)Be[x[b].name]=x[b].width*(19.049976/25.4);else Array.isArray(x)&&typeof x[0]=="string"&&(Q=I=x,se=I.map(function(){return"left"}));if(Pe||Array.isArray(x)&&typeof x[0]=="string")for(b=0;b<I.length;b+=1){for(we[H=I[b]]=y.map(function(ue){return ue[H]}),this.setFont(void 0,"bold"),$e.push(this.getTextDimensions(Q[b],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),T=we[H],this.setFont(void 0,"normal"),$=0;$<T.length;$+=1)$e.push(this.getTextDimensions(T[$],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);Be[H]=Math.max.apply(null,$e)+re+re,$e=[]}if(Te){var C={};for(b=0;b<I.length;b+=1)C[I[b]]={},C[I[b]].text=Q[b],C[I[b]].align=se[b];var N=d.call(this,C,Be);Ue=I.map(function(ue){return new a(f,m,Be[ue],N,C[ue].text,void 0,C[ue].align)}),this.setTableHeaderRow(Ue),this.printHeaderRow(1,!1)}var K=x.reduce(function(ue,ye){return ue[ye.name]=ye.align,ue},{});for(b=0;b<y.length;b+=1){"rowStart"in k&&k.rowStart instanceof Function&&k.rowStart({row:b,data:y[b]},this);var J=d.call(this,y[b],Be);for($=0;$<I.length;$+=1){var Ee=y[b][I[$]];"cellStart"in k&&k.cellStart instanceof Function&&k.cellStart({row:b,col:$,data:Ee},this),u.call(this,new a(f,m,Be[I[$]],J,Ee,b+2,K[I[$]]))}}return this.internal.__cell__.table_x=f,this.internal.__cell__.table_y=m,this};var d=function(f,m){var y=this.internal.__cell__.padding,x=this.internal.__cell__.table_font_size,k=this.internal.scaleFactor;return Object.keys(f).map(function(b){var T=f[b];return this.splitTextToSize(T.hasOwnProperty("text")?T.text:T,m[b]-y-y)},this).map(function(b){return this.getLineHeightFactor()*b.length*x/k+y+y},this).reduce(function(b,T){return Math.max(b,T)},0)};e.setTableHeaderRow=function(f){i.call(this),this.internal.__cell__.tableHeaderRow=f},e.printHeaderRow=function(f,m){if(i.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var y;if(n=!0,typeof this.internal.__cell__.headerFunction=="function"){var x=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new a(x[0],x[1],x[2],x[3],void 0,-1)}this.setFont(void 0,"bold");for(var k=[],b=0;b<this.internal.__cell__.tableHeaderRow.length;b+=1){y=this.internal.__cell__.tableHeaderRow[b].clone(),m&&(y.y=this.internal.__cell__.margins.top||0,k.push(y)),y.lineNumber=f;var T=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),u.call(this,y),this.setTextColor(T)}k.length>0&&this.setTableHeaderRow(k),this.setFont(void 0,"normal"),n=!1}}(Cn.API);var ov={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},av=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],jf=sv(av),lv=[100,200,300,400,500,600,700,800,900],$C=sv(lv);function zf(e){var t=e.family.replace(/"|'/g,"").toLowerCase(),n=function(a){return ov[a=a||"normal"]?a:"normal"}(e.style),i=function(a){if(!a)return 400;if(typeof a=="number")return a>=100&&a<=900&&a%100==0?a:400;if(/^\d00$/.test(a))return parseInt(a);switch(a){case"bold":return 700;case"normal":default:return 400}}(e.weight),o=function(a){return typeof jf[a=a||"normal"]=="number"?a:"normal"}(e.stretch);return{family:t,style:n,weight:i,stretch:o,src:e.src||[],ref:e.ref||{name:t,style:[o,n,i].join(" ")}}}function pg(e,t,n,i){var o;for(o=n;o>=0&&o<t.length;o+=i)if(e[t[o]])return e[t[o]];for(o=n;o>=0&&o<t.length;o-=i)if(e[t[o]])return e[t[o]]}var qC={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},gg={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function mg(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function VC(e,t,n){for(var i=(n=n||{}).defaultFontFamily||"times",o=Object.assign({},qC,n.genericFontFamilies||{}),a=null,u=null,d=0;d<t.length;++d)if(o[(a=zf(t[d])).family]&&(a.family=o[a.family]),e.hasOwnProperty(a.family)){u=e[a.family];break}if(!(u=u||e[i]))throw new Error("Could not find a font-family for the rule '"+mg(a)+"' and default family '"+i+"'.");if(u=function(f,m){if(m[f])return m[f];var y=jf[f],x=y<=jf.normal?-1:1,k=pg(m,av,y,x);if(!k)throw new Error("Could not find a matching font-stretch value for "+f);return k}(a.stretch,u),u=function(f,m){if(m[f])return m[f];for(var y=ov[f],x=0;x<y.length;++x)if(m[y[x]])return m[y[x]];throw new Error("Could not find a matching font-style for "+f)}(a.style,u),!(u=function(f,m){if(m[f])return m[f];if(f===400&&m[500])return m[500];if(f===500&&m[400])return m[400];var y=$C[f],x=pg(m,lv,y,f<400?-1:1);if(!x)throw new Error("Could not find a matching font-weight for value "+f);return x}(a.weight,u)))throw new Error("Failed to resolve a font for the rule '"+mg(a)+"'.");return u}function vg(e){return e.trimLeft()}function GC(e,t){for(var n=0;n<e.length;){if(e.charAt(n)===t)return[e.substring(0,n),e.substring(n+1)];n+=1}return null}function HC(e){var t=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],e.substring(t[0].length)]}var ah,yg,_g,Qd=["times"];(function(e){var t,n,i,o,a,u,d,f,m,y=function(O){return O=O||{},this.isStrokeTransparent=O.isStrokeTransparent||!1,this.strokeOpacity=O.strokeOpacity||1,this.strokeStyle=O.strokeStyle||"#000000",this.fillStyle=O.fillStyle||"#000000",this.isFillTransparent=O.isFillTransparent||!1,this.fillOpacity=O.fillOpacity||1,this.font=O.font||"10px sans-serif",this.textBaseline=O.textBaseline||"alphabetic",this.textAlign=O.textAlign||"left",this.lineWidth=O.lineWidth||1,this.lineJoin=O.lineJoin||"miter",this.lineCap=O.lineCap||"butt",this.path=O.path||[],this.transform=O.transform!==void 0?O.transform.clone():new f,this.globalCompositeOperation=O.globalCompositeOperation||"normal",this.globalAlpha=O.globalAlpha||1,this.clip_path=O.clip_path||[],this.currentPoint=O.currentPoint||new u,this.miterLimit=O.miterLimit||10,this.lastPoint=O.lastPoint||new u,this.lineDashOffset=O.lineDashOffset||0,this.lineDash=O.lineDash||[],this.margin=O.margin||[0,0,0,0],this.prevPageLastElemOffset=O.prevPageLastElemOffset||0,this.ignoreClearRect=typeof O.ignoreClearRect!="boolean"||O.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new x(this),t=this.internal.f2,n=this.internal.getCoordinateString,i=this.internal.getVerticalCoordinateString,o=this.internal.getHorizontalCoordinate,a=this.internal.getVerticalCoordinate,u=this.internal.Point,d=this.internal.Rectangle,f=this.internal.Matrix,m=new y}]);var x=function(O){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var ie=O;Object.defineProperty(this,"pdf",{get:function(){return ie}});var le=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return le},set:function(D){le=!!D}});var fe=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return fe},set:function(D){fe=!!D}});var _e=0;Object.defineProperty(this,"posX",{get:function(){return _e},set:function(D){isNaN(D)||(_e=D)}});var ee=0;Object.defineProperty(this,"posY",{get:function(){return ee},set:function(D){isNaN(D)||(ee=D)}}),Object.defineProperty(this,"margin",{get:function(){return m.margin},set:function(D){var j;typeof D=="number"?j=[D,D,D,D]:((j=new Array(4))[0]=D[0],j[1]=D.length>=2?D[1]:j[0],j[2]=D.length>=3?D[2]:j[0],j[3]=D.length>=4?D[3]:j[1]),m.margin=j}});var G=!1;Object.defineProperty(this,"autoPaging",{get:function(){return G},set:function(D){G=D}});var q=0;Object.defineProperty(this,"lastBreak",{get:function(){return q},set:function(D){q=D}});var de=[];Object.defineProperty(this,"pageBreaks",{get:function(){return de},set:function(D){de=D}}),Object.defineProperty(this,"ctx",{get:function(){return m},set:function(D){D instanceof y&&(m=D)}}),Object.defineProperty(this,"path",{get:function(){return m.path},set:function(D){m.path=D}});var ce=[];Object.defineProperty(this,"ctxStack",{get:function(){return ce},set:function(D){ce=D}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(D){var j;j=k(D),this.ctx.fillStyle=j.style,this.ctx.isFillTransparent=j.a===0,this.ctx.fillOpacity=j.a,this.pdf.setFillColor(j.r,j.g,j.b,{a:j.a}),this.pdf.setTextColor(j.r,j.g,j.b,{a:j.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(D){var j=k(D);this.ctx.strokeStyle=j.style,this.ctx.isStrokeTransparent=j.a===0,this.ctx.strokeOpacity=j.a,j.a===0?this.pdf.setDrawColor(255,255,255):(j.a,this.pdf.setDrawColor(j.r,j.g,j.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(D){["butt","round","square"].indexOf(D)!==-1&&(this.ctx.lineCap=D,this.pdf.setLineCap(D))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(D){isNaN(D)||(this.ctx.lineWidth=D,this.pdf.setLineWidth(D))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(D){["bevel","round","miter"].indexOf(D)!==-1&&(this.ctx.lineJoin=D,this.pdf.setLineJoin(D))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(D){isNaN(D)||(this.ctx.miterLimit=D,this.pdf.setMiterLimit(D))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(D){this.ctx.textBaseline=D}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(D){["right","end","center","left","start"].indexOf(D)!==-1&&(this.ctx.textAlign=D)}});var V=null;function Z(D,j){if(V===null){var Fe=function(qe){var De=[];return Object.keys(qe).forEach(function(Je){qe[Je].forEach(function(Ze){var yt=null;switch(Ze){case"bold":yt={family:Je,weight:"bold"};break;case"italic":yt={family:Je,style:"italic"};break;case"bolditalic":yt={family:Je,weight:"bold",style:"italic"};break;case"":case"normal":yt={family:Je}}yt!==null&&(yt.ref={name:Je,style:Ze},De.push(yt))})}),De}(D.getFontList());V=function(qe){for(var De={},Je=0;Je<qe.length;++Je){var Ze=zf(qe[Je]),yt=Ze.family,wt=Ze.stretch,Pt=Ze.style,Rt=Ze.weight;De[yt]=De[yt]||{},De[yt][wt]=De[yt][wt]||{},De[yt][wt][Pt]=De[yt][wt][Pt]||{},De[yt][wt][Pt][Rt]=Ze}return De}(Fe.concat(j))}return V}var F=null;Object.defineProperty(this,"fontFaces",{get:function(){return F},set:function(D){V=null,F=D}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(D){var j;if(this.ctx.font=D,(j=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(D))!==null){var Fe=j[1],qe=(j[2],j[3]),De=j[4],Je=(j[5],j[6]),Ze=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(De)[2];De=Math.floor(Ze==="px"?parseFloat(De)*this.pdf.internal.scaleFactor:Ze==="em"?parseFloat(De)*this.pdf.getFontSize():parseFloat(De)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(De);var yt=function(kt){var Et,St,nt=[],st=kt.trim();if(st==="")return Qd;if(st in gg)return[gg[st]];for(;st!=="";){switch(St=null,Et=(st=vg(st)).charAt(0)){case'"':case"'":St=GC(st.substring(1),Et);break;default:St=HC(st)}if(St===null||(nt.push(St[0]),(st=vg(St[1]))!==""&&st.charAt(0)!==","))return Qd;st=st.replace(/^,/,"")}return nt}(Je);if(this.fontFaces){var wt=VC(Z(this.pdf,this.fontFaces),yt.map(function(kt){return{family:kt,stretch:"normal",weight:qe,style:Fe}}));this.pdf.setFont(wt.ref.name,wt.ref.style)}else{var Pt="";(qe==="bold"||parseInt(qe,10)>=700||Fe==="bold")&&(Pt="bold"),Fe==="italic"&&(Pt+="italic"),Pt.length===0&&(Pt="normal");for(var Rt="",qt={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},lt=0;lt<yt.length;lt++){if(this.pdf.internal.getFont(yt[lt],Pt,{noFallback:!0,disableWarning:!0})!==void 0){Rt=yt[lt];break}if(Pt==="bolditalic"&&this.pdf.internal.getFont(yt[lt],"bold",{noFallback:!0,disableWarning:!0})!==void 0)Rt=yt[lt],Pt="bold";else if(this.pdf.internal.getFont(yt[lt],"normal",{noFallback:!0,disableWarning:!0})!==void 0){Rt=yt[lt],Pt="normal";break}}if(Rt===""){for(var Oe=0;Oe<yt.length;Oe++)if(qt[yt[Oe]]){Rt=qt[yt[Oe]];break}}Rt=Rt===""?"Times":Rt,this.pdf.setFont(Rt,Pt)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(D){this.ctx.globalCompositeOperation=D}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(D){this.ctx.globalAlpha=D}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(D){this.ctx.lineDashOffset=D,ye.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(D){this.ctx.lineDash=D,ye.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(D){this.ctx.ignoreClearRect=!!D}})};x.prototype.setLineDash=function(O){this.lineDash=O},x.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},x.prototype.fill=function(){we.call(this,"fill",!1)},x.prototype.stroke=function(){we.call(this,"stroke",!1)},x.prototype.beginPath=function(){this.path=[{type:"begin"}]},x.prototype.moveTo=function(O,ie){if(isNaN(O)||isNaN(ie))throw Li.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var le=this.ctx.transform.applyToPoint(new u(O,ie));this.path.push({type:"mt",x:le.x,y:le.y}),this.ctx.lastPoint=new u(O,ie)},x.prototype.closePath=function(){var O=new u(0,0),ie=0;for(ie=this.path.length-1;ie!==-1;ie--)if(this.path[ie].type==="begin"&&yi(this.path[ie+1])==="object"&&typeof this.path[ie+1].x=="number"){O=new u(this.path[ie+1].x,this.path[ie+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new u(O.x,O.y)},x.prototype.lineTo=function(O,ie){if(isNaN(O)||isNaN(ie))throw Li.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var le=this.ctx.transform.applyToPoint(new u(O,ie));this.path.push({type:"lt",x:le.x,y:le.y}),this.ctx.lastPoint=new u(le.x,le.y)},x.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),we.call(this,null,!0)},x.prototype.quadraticCurveTo=function(O,ie,le,fe){if(isNaN(le)||isNaN(fe)||isNaN(O)||isNaN(ie))throw Li.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var _e=this.ctx.transform.applyToPoint(new u(le,fe)),ee=this.ctx.transform.applyToPoint(new u(O,ie));this.path.push({type:"qct",x1:ee.x,y1:ee.y,x:_e.x,y:_e.y}),this.ctx.lastPoint=new u(_e.x,_e.y)},x.prototype.bezierCurveTo=function(O,ie,le,fe,_e,ee){if(isNaN(_e)||isNaN(ee)||isNaN(O)||isNaN(ie)||isNaN(le)||isNaN(fe))throw Li.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var G=this.ctx.transform.applyToPoint(new u(_e,ee)),q=this.ctx.transform.applyToPoint(new u(O,ie)),de=this.ctx.transform.applyToPoint(new u(le,fe));this.path.push({type:"bct",x1:q.x,y1:q.y,x2:de.x,y2:de.y,x:G.x,y:G.y}),this.ctx.lastPoint=new u(G.x,G.y)},x.prototype.arc=function(O,ie,le,fe,_e,ee){if(isNaN(O)||isNaN(ie)||isNaN(le)||isNaN(fe)||isNaN(_e))throw Li.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(ee=!!ee,!this.ctx.transform.isIdentity){var G=this.ctx.transform.applyToPoint(new u(O,ie));O=G.x,ie=G.y;var q=this.ctx.transform.applyToPoint(new u(0,le)),de=this.ctx.transform.applyToPoint(new u(0,0));le=Math.sqrt(Math.pow(q.x-de.x,2)+Math.pow(q.y-de.y,2))}Math.abs(_e-fe)>=2*Math.PI&&(fe=0,_e=2*Math.PI),this.path.push({type:"arc",x:O,y:ie,radius:le,startAngle:fe,endAngle:_e,counterclockwise:ee})},x.prototype.arcTo=function(O,ie,le,fe,_e){throw new Error("arcTo not implemented.")},x.prototype.rect=function(O,ie,le,fe){if(isNaN(O)||isNaN(ie)||isNaN(le)||isNaN(fe))throw Li.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(O,ie),this.lineTo(O+le,ie),this.lineTo(O+le,ie+fe),this.lineTo(O,ie+fe),this.lineTo(O,ie),this.lineTo(O+le,ie),this.lineTo(O,ie)},x.prototype.fillRect=function(O,ie,le,fe){if(isNaN(O)||isNaN(ie)||isNaN(le)||isNaN(fe))throw Li.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!b.call(this)){var _e={};this.lineCap!=="butt"&&(_e.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(_e.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(O,ie,le,fe),this.fill(),_e.hasOwnProperty("lineCap")&&(this.lineCap=_e.lineCap),_e.hasOwnProperty("lineJoin")&&(this.lineJoin=_e.lineJoin)}},x.prototype.strokeRect=function(O,ie,le,fe){if(isNaN(O)||isNaN(ie)||isNaN(le)||isNaN(fe))throw Li.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");T.call(this)||(this.beginPath(),this.rect(O,ie,le,fe),this.stroke())},x.prototype.clearRect=function(O,ie,le,fe){if(isNaN(O)||isNaN(ie)||isNaN(le)||isNaN(fe))throw Li.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(O,ie,le,fe))},x.prototype.save=function(O){O=typeof O!="boolean"||O;for(var ie=this.pdf.internal.getCurrentPageInfo().pageNumber,le=0;le<this.pdf.internal.getNumberOfPages();le++)this.pdf.setPage(le+1),this.pdf.internal.out("q");if(this.pdf.setPage(ie),O){this.ctx.fontSize=this.pdf.internal.getFontSize();var fe=new y(this.ctx);this.ctxStack.push(this.ctx),this.ctx=fe}},x.prototype.restore=function(O){O=typeof O!="boolean"||O;for(var ie=this.pdf.internal.getCurrentPageInfo().pageNumber,le=0;le<this.pdf.internal.getNumberOfPages();le++)this.pdf.setPage(le+1),this.pdf.internal.out("Q");this.pdf.setPage(ie),O&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},x.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var k=function(O){var ie,le,fe,_e;if(O.isCanvasGradient===!0&&(O=O.getColor()),!O)return{r:0,g:0,b:0,a:0,style:O};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(O))ie=0,le=0,fe=0,_e=0;else{var ee=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(O);if(ee!==null)ie=parseInt(ee[1]),le=parseInt(ee[2]),fe=parseInt(ee[3]),_e=1;else if((ee=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(O))!==null)ie=parseInt(ee[1]),le=parseInt(ee[2]),fe=parseInt(ee[3]),_e=parseFloat(ee[4]);else{if(_e=1,typeof O=="string"&&O.charAt(0)!=="#"){var G=new Q1(O);O=G.ok?G.toHex():"#000000"}O.length===4?(ie=O.substring(1,2),ie+=ie,le=O.substring(2,3),le+=le,fe=O.substring(3,4),fe+=fe):(ie=O.substring(1,3),le=O.substring(3,5),fe=O.substring(5,7)),ie=parseInt(ie,16),le=parseInt(le,16),fe=parseInt(fe,16)}}return{r:ie,g:le,b:fe,a:_e,style:O}},b=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},T=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};x.prototype.fillText=function(O,ie,le,fe){if(isNaN(ie)||isNaN(le)||typeof O!="string")throw Li.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(fe=isNaN(fe)?void 0:fe,!b.call(this)){var _e=J(this.ctx.transform.rotation),ee=this.ctx.transform.scaleX;re.call(this,{text:O,x:ie,y:le,scale:ee,angle:_e,align:this.textAlign,maxWidth:fe})}},x.prototype.strokeText=function(O,ie,le,fe){if(isNaN(ie)||isNaN(le)||typeof O!="string")throw Li.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!T.call(this)){fe=isNaN(fe)?void 0:fe;var _e=J(this.ctx.transform.rotation),ee=this.ctx.transform.scaleX;re.call(this,{text:O,x:ie,y:le,scale:ee,renderingMode:"stroke",angle:_e,align:this.textAlign,maxWidth:fe})}},x.prototype.measureText=function(O){if(typeof O!="string")throw Li.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var ie=this.pdf,le=this.pdf.internal.scaleFactor,fe=ie.internal.getFontSize(),_e=ie.getStringUnitWidth(O)*fe/ie.internal.scaleFactor,ee=function(G){var q=(G=G||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return q}}),this};return new ee({width:_e*=Math.round(96*le/72*1e4)/1e4})},x.prototype.scale=function(O,ie){if(isNaN(O)||isNaN(ie))throw Li.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var le=new f(O,0,0,ie,0,0);this.ctx.transform=this.ctx.transform.multiply(le)},x.prototype.rotate=function(O){if(isNaN(O))throw Li.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var ie=new f(Math.cos(O),Math.sin(O),-Math.sin(O),Math.cos(O),0,0);this.ctx.transform=this.ctx.transform.multiply(ie)},x.prototype.translate=function(O,ie){if(isNaN(O)||isNaN(ie))throw Li.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var le=new f(1,0,0,1,O,ie);this.ctx.transform=this.ctx.transform.multiply(le)},x.prototype.transform=function(O,ie,le,fe,_e,ee){if(isNaN(O)||isNaN(ie)||isNaN(le)||isNaN(fe)||isNaN(_e)||isNaN(ee))throw Li.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var G=new f(O,ie,le,fe,_e,ee);this.ctx.transform=this.ctx.transform.multiply(G)},x.prototype.setTransform=function(O,ie,le,fe,_e,ee){O=isNaN(O)?1:O,ie=isNaN(ie)?0:ie,le=isNaN(le)?0:le,fe=isNaN(fe)?1:fe,_e=isNaN(_e)?0:_e,ee=isNaN(ee)?0:ee,this.ctx.transform=new f(O,ie,le,fe,_e,ee)};var $=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};x.prototype.drawImage=function(O,ie,le,fe,_e,ee,G,q,de){var ce=this.pdf.getImageProperties(O),V=1,Z=1,F=1,D=1;fe!==void 0&&q!==void 0&&(F=q/fe,D=de/_e,V=ce.width/fe*q/fe,Z=ce.height/_e*de/_e),ee===void 0&&(ee=ie,G=le,ie=0,le=0),fe!==void 0&&q===void 0&&(q=fe,de=_e),fe===void 0&&q===void 0&&(q=ce.width,de=ce.height);for(var j,Fe=this.ctx.transform.decompose(),qe=J(Fe.rotate.shx),De=new f,Je=(De=(De=(De=De.multiply(Fe.translate)).multiply(Fe.skew)).multiply(Fe.scale)).applyToRectangle(new d(ee-ie*F,G-le*D,fe*V,_e*Z)),Ze=H.call(this,Je),yt=[],wt=0;wt<Ze.length;wt+=1)yt.indexOf(Ze[wt])===-1&&yt.push(Ze[wt]);if(se(yt),this.autoPaging)for(var Pt=yt[0],Rt=yt[yt.length-1],qt=Pt;qt<Rt+1;qt++){this.pdf.setPage(qt);var lt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Oe=qt===1?this.posY+this.margin[0]:this.margin[0],kt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Et=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],St=qt===1?0:kt+(qt-2)*Et;if(this.ctx.clip_path.length!==0){var nt=this.path;j=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=Q(j,this.posX+this.margin[3],-St+Oe+this.ctx.prevPageLastElemOffset),Be.call(this,"fill",!0),this.path=nt}var st=JSON.parse(JSON.stringify(Je));st=Q([st],this.posX+this.margin[3],-St+Oe+this.ctx.prevPageLastElemOffset)[0];var pn=(qt>Pt||qt<Rt)&&$.call(this);pn&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],lt,Et,null).clip().discardPath()),this.pdf.addImage(O,"JPEG",st.x,st.y,st.w,st.h,null,null,qe),pn&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(O,"JPEG",Je.x,Je.y,Je.w,Je.h,null,null,qe)};var H=function(O,ie,le){var fe=[];ie=ie||this.pdf.internal.pageSize.width,le=le||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var _e=this.posY+this.ctx.prevPageLastElemOffset;switch(O.type){default:case"mt":case"lt":fe.push(Math.floor((O.y+_e)/le)+1);break;case"arc":fe.push(Math.floor((O.y+_e-O.radius)/le)+1),fe.push(Math.floor((O.y+_e+O.radius)/le)+1);break;case"qct":var ee=Ee(this.ctx.lastPoint.x,this.ctx.lastPoint.y,O.x1,O.y1,O.x,O.y);fe.push(Math.floor((ee.y+_e)/le)+1),fe.push(Math.floor((ee.y+ee.h+_e)/le)+1);break;case"bct":var G=ue(this.ctx.lastPoint.x,this.ctx.lastPoint.y,O.x1,O.y1,O.x2,O.y2,O.x,O.y);fe.push(Math.floor((G.y+_e)/le)+1),fe.push(Math.floor((G.y+G.h+_e)/le)+1);break;case"rect":fe.push(Math.floor((O.y+_e)/le)+1),fe.push(Math.floor((O.y+O.h+_e)/le)+1)}for(var q=0;q<fe.length;q+=1)for(;this.pdf.internal.getNumberOfPages()<fe[q];)I.call(this);return fe},I=function(){var O=this.fillStyle,ie=this.strokeStyle,le=this.font,fe=this.lineCap,_e=this.lineWidth,ee=this.lineJoin;this.pdf.addPage(),this.fillStyle=O,this.strokeStyle=ie,this.font=le,this.lineCap=fe,this.lineWidth=_e,this.lineJoin=ee},Q=function(O,ie,le){for(var fe=0;fe<O.length;fe++)switch(O[fe].type){case"bct":O[fe].x2+=ie,O[fe].y2+=le;case"qct":O[fe].x1+=ie,O[fe].y1+=le;case"mt":case"lt":case"arc":default:O[fe].x+=ie,O[fe].y+=le}return O},se=function(O){return O.sort(function(ie,le){return ie-le})},we=function(O,ie){for(var le,fe,_e=this.fillStyle,ee=this.strokeStyle,G=this.lineCap,q=this.lineWidth,de=Math.abs(q*this.ctx.transform.scaleX),ce=this.lineJoin,V=JSON.parse(JSON.stringify(this.path)),Z=JSON.parse(JSON.stringify(this.path)),F=[],D=0;D<Z.length;D++)if(Z[D].x!==void 0)for(var j=H.call(this,Z[D]),Fe=0;Fe<j.length;Fe+=1)F.indexOf(j[Fe])===-1&&F.push(j[Fe]);for(var qe=0;qe<F.length;qe++)for(;this.pdf.internal.getNumberOfPages()<F[qe];)I.call(this);if(se(F),this.autoPaging)for(var De=F[0],Je=F[F.length-1],Ze=De;Ze<Je+1;Ze++){this.pdf.setPage(Ze),this.fillStyle=_e,this.strokeStyle=ee,this.lineCap=G,this.lineWidth=de,this.lineJoin=ce;var yt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],wt=Ze===1?this.posY+this.margin[0]:this.margin[0],Pt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Rt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],qt=Ze===1?0:Pt+(Ze-2)*Rt;if(this.ctx.clip_path.length!==0){var lt=this.path;le=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=Q(le,this.posX+this.margin[3],-qt+wt+this.ctx.prevPageLastElemOffset),Be.call(this,O,!0),this.path=lt}if(fe=JSON.parse(JSON.stringify(V)),this.path=Q(fe,this.posX+this.margin[3],-qt+wt+this.ctx.prevPageLastElemOffset),ie===!1||Ze===0){var Oe=(Ze>De||Ze<Je)&&$.call(this);Oe&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],yt,Rt,null).clip().discardPath()),Be.call(this,O,ie),Oe&&this.pdf.restoreGraphicsState()}this.lineWidth=q}else this.lineWidth=de,Be.call(this,O,ie),this.lineWidth=q;this.path=V},Be=function(O,ie){if((O!=="stroke"||ie||!T.call(this))&&(O==="stroke"||ie||!b.call(this))){for(var le,fe,_e=[],ee=this.path,G=0;G<ee.length;G++){var q=ee[G];switch(q.type){case"begin":_e.push({begin:!0});break;case"close":_e.push({close:!0});break;case"mt":_e.push({start:q,deltas:[],abs:[]});break;case"lt":var de=_e.length;if(ee[G-1]&&!isNaN(ee[G-1].x)&&(le=[q.x-ee[G-1].x,q.y-ee[G-1].y],de>0)){for(;de>=0;de--)if(_e[de-1].close!==!0&&_e[de-1].begin!==!0){_e[de-1].deltas.push(le),_e[de-1].abs.push(q);break}}break;case"bct":le=[q.x1-ee[G-1].x,q.y1-ee[G-1].y,q.x2-ee[G-1].x,q.y2-ee[G-1].y,q.x-ee[G-1].x,q.y-ee[G-1].y],_e[_e.length-1].deltas.push(le);break;case"qct":var ce=ee[G-1].x+2/3*(q.x1-ee[G-1].x),V=ee[G-1].y+2/3*(q.y1-ee[G-1].y),Z=q.x+2/3*(q.x1-q.x),F=q.y+2/3*(q.y1-q.y),D=q.x,j=q.y;le=[ce-ee[G-1].x,V-ee[G-1].y,Z-ee[G-1].x,F-ee[G-1].y,D-ee[G-1].x,j-ee[G-1].y],_e[_e.length-1].deltas.push(le);break;case"arc":_e.push({deltas:[],abs:[],arc:!0}),Array.isArray(_e[_e.length-1].abs)&&_e[_e.length-1].abs.push(q)}}fe=ie?null:O==="stroke"?"stroke":"fill";for(var Fe=!1,qe=0;qe<_e.length;qe++)if(_e[qe].arc)for(var De=_e[qe].abs,Je=0;Je<De.length;Je++){var Ze=De[Je];Ze.type==="arc"?Pe.call(this,Ze.x,Ze.y,Ze.radius,Ze.startAngle,Ze.endAngle,Ze.counterclockwise,void 0,ie,!Fe):oe.call(this,Ze.x,Ze.y),Fe=!0}else if(_e[qe].close===!0)this.pdf.internal.out("h"),Fe=!1;else if(_e[qe].begin!==!0){var yt=_e[qe].start.x,wt=_e[qe].start.y;Y.call(this,_e[qe].deltas,yt,wt),Fe=!0}fe&&Te.call(this,fe),ie&&He.call(this)}},$e=function(O){var ie=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,le=ie*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return O-le;case"top":return O+ie-le;case"hanging":return O+ie-2*le;case"middle":return O+ie/2-le;case"ideographic":return O;case"alphabetic":default:return O}},Ue=function(O){return O+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};x.prototype.createLinearGradient=function(){var O=function(){};return O.colorStops=[],O.addColorStop=function(ie,le){this.colorStops.push([ie,le])},O.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},O.isCanvasGradient=!0,O},x.prototype.createPattern=function(){return this.createLinearGradient()},x.prototype.createRadialGradient=function(){return this.createLinearGradient()};var Pe=function(O,ie,le,fe,_e,ee,G,q,de){for(var ce=N.call(this,le,fe,_e,ee),V=0;V<ce.length;V++){var Z=ce[V];V===0&&(de?ae.call(this,Z.x1+O,Z.y1+ie):oe.call(this,Z.x1+O,Z.y1+ie)),C.call(this,O,ie,Z.x2,Z.y2,Z.x3,Z.y3,Z.x4,Z.y4)}q?He.call(this):Te.call(this,G)},Te=function(O){switch(O){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},He=function(){this.pdf.clip(),this.pdf.discardPath()},ae=function(O,ie){this.pdf.internal.out(n(O)+" "+i(ie)+" m")},re=function(O){var ie;switch(O.align){case"right":case"end":ie="right";break;case"center":ie="center";break;case"left":case"start":default:ie="left"}var le=this.pdf.getTextDimensions(O.text),fe=$e.call(this,O.y),_e=Ue.call(this,fe)-le.h,ee=this.ctx.transform.applyToPoint(new u(O.x,fe)),G=this.ctx.transform.decompose(),q=new f;q=(q=(q=q.multiply(G.translate)).multiply(G.skew)).multiply(G.scale);for(var de,ce,V,Z=this.ctx.transform.applyToRectangle(new d(O.x,fe,le.w,le.h)),F=q.applyToRectangle(new d(O.x,_e,le.w,le.h)),D=H.call(this,F),j=[],Fe=0;Fe<D.length;Fe+=1)j.indexOf(D[Fe])===-1&&j.push(D[Fe]);if(se(j),this.autoPaging)for(var qe=j[0],De=j[j.length-1],Je=qe;Je<De+1;Je++){this.pdf.setPage(Je);var Ze=Je===1?this.posY+this.margin[0]:this.margin[0],yt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],wt=this.pdf.internal.pageSize.height-this.margin[2],Pt=wt-this.margin[0],Rt=this.pdf.internal.pageSize.width-this.margin[1],qt=Rt-this.margin[3],lt=Je===1?0:yt+(Je-2)*Pt;if(this.ctx.clip_path.length!==0){var Oe=this.path;de=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=Q(de,this.posX+this.margin[3],-1*lt+Ze),Be.call(this,"fill",!0),this.path=Oe}var kt=Q([JSON.parse(JSON.stringify(F))],this.posX+this.margin[3],-lt+Ze+this.ctx.prevPageLastElemOffset)[0];O.scale>=.01&&(ce=this.pdf.internal.getFontSize(),this.pdf.setFontSize(ce*O.scale),V=this.lineWidth,this.lineWidth=V*O.scale);var Et=this.autoPaging!=="text";if(Et||kt.y+kt.h<=wt){if(Et||kt.y>=Ze&&kt.x<=Rt){var St=Et?O.text:this.pdf.splitTextToSize(O.text,O.maxWidth||Rt-kt.x)[0],nt=Q([JSON.parse(JSON.stringify(Z))],this.posX+this.margin[3],-lt+Ze+this.ctx.prevPageLastElemOffset)[0],st=Et&&(Je>qe||Je<De)&&$.call(this);st&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],qt,Pt,null).clip().discardPath()),this.pdf.text(St,nt.x,nt.y,{angle:O.angle,align:ie,renderingMode:O.renderingMode}),st&&this.pdf.restoreGraphicsState()}}else kt.y<wt&&(this.ctx.prevPageLastElemOffset+=wt-kt.y);O.scale>=.01&&(this.pdf.setFontSize(ce),this.lineWidth=V)}else O.scale>=.01&&(ce=this.pdf.internal.getFontSize(),this.pdf.setFontSize(ce*O.scale),V=this.lineWidth,this.lineWidth=V*O.scale),this.pdf.text(O.text,ee.x+this.posX,ee.y+this.posY,{angle:O.angle,align:ie,renderingMode:O.renderingMode,maxWidth:O.maxWidth}),O.scale>=.01&&(this.pdf.setFontSize(ce),this.lineWidth=V)},oe=function(O,ie,le,fe){le=le||0,fe=fe||0,this.pdf.internal.out(n(O+le)+" "+i(ie+fe)+" l")},Y=function(O,ie,le){return this.pdf.lines(O,ie,le,null,null)},C=function(O,ie,le,fe,_e,ee,G,q){this.pdf.internal.out([t(o(le+O)),t(a(fe+ie)),t(o(_e+O)),t(a(ee+ie)),t(o(G+O)),t(a(q+ie)),"c"].join(" "))},N=function(O,ie,le,fe){for(var _e=2*Math.PI,ee=Math.PI/2;ie>le;)ie-=_e;var G=Math.abs(le-ie);G<_e&&fe&&(G=_e-G);for(var q=[],de=fe?-1:1,ce=ie;G>1e-5;){var V=ce+de*Math.min(G,ee);q.push(K.call(this,O,ce,V)),G-=Math.abs(V-ce),ce=V}return q},K=function(O,ie,le){var fe=(le-ie)/2,_e=O*Math.cos(fe),ee=O*Math.sin(fe),G=_e,q=-ee,de=G*G+q*q,ce=de+G*_e+q*ee,V=4/3*(Math.sqrt(2*de*ce)-ce)/(G*ee-q*_e),Z=G-V*q,F=q+V*G,D=Z,j=-F,Fe=fe+ie,qe=Math.cos(Fe),De=Math.sin(Fe);return{x1:O*Math.cos(ie),y1:O*Math.sin(ie),x2:Z*qe-F*De,y2:Z*De+F*qe,x3:D*qe-j*De,y3:D*De+j*qe,x4:O*Math.cos(le),y4:O*Math.sin(le)}},J=function(O){return 180*O/Math.PI},Ee=function(O,ie,le,fe,_e,ee){var G=O+.5*(le-O),q=ie+.5*(fe-ie),de=_e+.5*(le-_e),ce=ee+.5*(fe-ee),V=Math.min(O,_e,G,de),Z=Math.max(O,_e,G,de),F=Math.min(ie,ee,q,ce),D=Math.max(ie,ee,q,ce);return new d(V,F,Z-V,D-F)},ue=function(O,ie,le,fe,_e,ee,G,q){var de,ce,V,Z,F,D,j,Fe,qe,De,Je,Ze,yt,wt,Pt=le-O,Rt=fe-ie,qt=_e-le,lt=ee-fe,Oe=G-_e,kt=q-ee;for(ce=0;ce<41;ce++)qe=(j=(V=O+(de=ce/40)*Pt)+de*((F=le+de*qt)-V))+de*(F+de*(_e+de*Oe-F)-j),De=(Fe=(Z=ie+de*Rt)+de*((D=fe+de*lt)-Z))+de*(D+de*(ee+de*kt-D)-Fe),ce==0?(Je=qe,Ze=De,yt=qe,wt=De):(Je=Math.min(Je,qe),Ze=Math.min(Ze,De),yt=Math.max(yt,qe),wt=Math.max(wt,De));return new d(Math.round(Je),Math.round(Ze),Math.round(yt-Je),Math.round(wt-Ze))},ye=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var O,ie,le=(O=this.ctx.lineDash,ie=this.ctx.lineDashOffset,JSON.stringify({lineDash:O,lineDashOffset:ie}));this.prevLineDash!==le&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=le)}}})(Cn.API),function(e){var t=function(a){var u,d,f,m,y,x,k,b,T,$;for(d=[],f=0,m=(a+=u="\0\0\0\0".slice(a.length%4||4)).length;m>f;f+=4)(y=(a.charCodeAt(f)<<24)+(a.charCodeAt(f+1)<<16)+(a.charCodeAt(f+2)<<8)+a.charCodeAt(f+3))!==0?(x=(y=((y=((y=((y=(y-($=y%85))/85)-(T=y%85))/85)-(b=y%85))/85)-(k=y%85))/85)%85,d.push(x+33,k+33,b+33,T+33,$+33)):d.push(122);return function(H,I){for(var Q=I;Q>0;Q--)H.pop()}(d,u.length),String.fromCharCode.apply(String,d)+"~>"},n=function(a){var u,d,f,m,y,x=String,k="length",b=255,T="charCodeAt",$="slice",H="replace";for(a[$](-2),a=a[$](0,-2)[H](/\s/g,"")[H]("z","!!!!!"),f=[],m=0,y=(a+=u="uuuuu"[$](a[k]%5||5))[k];y>m;m+=5)d=52200625*(a[T](m)-33)+614125*(a[T](m+1)-33)+7225*(a[T](m+2)-33)+85*(a[T](m+3)-33)+(a[T](m+4)-33),f.push(b&d>>24,b&d>>16,b&d>>8,b&d);return function(I,Q){for(var se=Q;se>0;se--)I.pop()}(f,u[k]),x.fromCharCode.apply(x,f)},i=function(a){var u=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((a=a.replace(/\s/g,"")).indexOf(">")!==-1&&(a=a.substr(0,a.indexOf(">"))),a.length%2&&(a+="0"),u.test(a)===!1)return"";for(var d="",f=0;f<a.length;f+=2)d+=String.fromCharCode("0x"+(a[f]+a[f+1]));return d},o=function(a){for(var u=new Uint8Array(a.length),d=a.length;d--;)u[d]=a.charCodeAt(d);return a=(u=Df(u)).reduce(function(f,m){return f+String.fromCharCode(m)},"")};e.processDataByFilters=function(a,u){var d=0,f=a||"",m=[];for(typeof(u=u||[])=="string"&&(u=[u]),d=0;d<u.length;d+=1)switch(u[d]){case"ASCII85Decode":case"/ASCII85Decode":f=n(f),m.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":f=t(f),m.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":f=i(f),m.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":f=f.split("").map(function(y){return("0"+y.charCodeAt().toString(16)).slice(-2)}).join("")+">",m.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":f=o(f),m.push("/FlateDecode");break;default:throw new Error('The filter: "'+u[d]+'" is not implemented')}return{data:f,reverseChain:m.reverse().join(" ")}}}(Cn.API),function(e){e.loadFile=function(t,n,i){return function(o,a,u){a=a!==!1,u=typeof u=="function"?u:function(){};var d=void 0;try{d=function(f,m,y){var x=new XMLHttpRequest,k=0,b=function(T){var $=T.length,H=[],I=String.fromCharCode;for(k=0;k<$;k+=1)H.push(I(255&T.charCodeAt(k)));return H.join("")};if(x.open("GET",f,!m),x.overrideMimeType("text/plain; charset=x-user-defined"),m===!1&&(x.onload=function(){x.status===200?y(b(this.responseText)):y(void 0)}),x.send(null),m&&x.status===200)return b(x.responseText)}(o,a,u)}catch{}return d}(t,n,i)},e.loadImageFile=e.loadFile}(Cn.API),function(e){function t(){return(Sn.html2canvas?Promise.resolve(Sn.html2canvas):Ql(()=>import("./html2canvas.esm.js"),[])).catch(function(u){return Promise.reject(new Error("Could not load html2canvas: "+u))}).then(function(u){return u.default?u.default:u})}function n(){return(Sn.DOMPurify?Promise.resolve(Sn.DOMPurify):Ql(()=>import("./purify.es.js"),[])).catch(function(u){return Promise.reject(new Error("Could not load dompurify: "+u))}).then(function(u){return u.default?u.default:u})}var i=function(u){var d=yi(u);return d==="undefined"?"undefined":d==="string"||u instanceof String?"string":d==="number"||u instanceof Number?"number":d==="function"||u instanceof Function?"function":u&&u.constructor===Array?"array":u&&u.nodeType===1?"element":d==="object"?"object":"unknown"},o=function(u,d){var f=document.createElement(u);for(var m in d.className&&(f.className=d.className),d.innerHTML&&d.dompurify&&(f.innerHTML=d.dompurify.sanitize(d.innerHTML)),d.style)f.style[m]=d.style[m];return f},a=function u(d){var f=Object.assign(u.convert(Promise.resolve()),JSON.parse(JSON.stringify(u.template))),m=u.convert(Promise.resolve(),f);return m=(m=m.setProgress(1,u,1,[u])).set(d)};(a.prototype=Object.create(Promise.prototype)).constructor=a,a.convert=function(u,d){return u.__proto__=d||a.prototype,u},a.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},a.prototype.from=function(u,d){return this.then(function(){switch(d=d||function(f){switch(i(f)){case"string":return"string";case"element":return f.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(u)){case"string":return this.then(n).then(function(f){return this.set({src:o("div",{innerHTML:u,dompurify:f})})});case"element":return this.set({src:u});case"canvas":return this.set({canvas:u});case"img":return this.set({img:u});default:return this.error("Unknown source type.")}})},a.prototype.to=function(u){switch(u){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},a.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var u={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},d=function f(m,y){for(var x=m.nodeType===3?document.createTextNode(m.nodeValue):m.cloneNode(!1),k=m.firstChild;k;k=k.nextSibling)y!==!0&&k.nodeType===1&&k.nodeName==="SCRIPT"||x.appendChild(f(k,y));return m.nodeType===1&&(m.nodeName==="CANVAS"?(x.width=m.width,x.height=m.height,x.getContext("2d").drawImage(m,0,0)):m.nodeName!=="TEXTAREA"&&m.nodeName!=="SELECT"||(x.value=m.value),x.addEventListener("load",function(){x.scrollTop=m.scrollTop,x.scrollLeft=m.scrollLeft},!0)),x}(this.prop.src,this.opt.html2canvas.javascriptEnabled);d.tagName==="BODY"&&(u.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=o("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=o("div",{className:"html2pdf__container",style:u}),this.prop.container.appendChild(d),this.prop.container.firstChild.appendChild(o("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},a.prototype.toCanvas=function(){var u=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(u).then(t).then(function(d){var f=Object.assign({},this.opt.html2canvas);return delete f.onrendered,d(this.prop.container,f)}).then(function(d){(this.opt.html2canvas.onrendered||function(){})(d),this.prop.canvas=d,document.body.removeChild(this.prop.overlay)})},a.prototype.toContext2d=function(){var u=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(u).then(t).then(function(d){var f=this.opt.jsPDF,m=this.opt.fontFaces,y=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,x=Object.assign({async:!0,allowTaint:!0,scale:y,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete x.onrendered,f.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,f.context2d.posX=this.opt.x,f.context2d.posY=this.opt.y,f.context2d.margin=this.opt.margin,f.context2d.fontFaces=m,m)for(var k=0;k<m.length;++k){var b=m[k],T=b.src.find(function($){return $.format==="truetype"});T&&f.addFont(T.url,b.ref.name,b.ref.style)}return x.windowHeight=x.windowHeight||0,x.windowHeight=x.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):x.windowHeight,f.context2d.save(!0),d(this.prop.container,x)}).then(function(d){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(d),this.prop.canvas=d,document.body.removeChild(this.prop.overlay)})},a.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var u=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=u})},a.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},a.prototype.output=function(u,d,f){return(f=f||"pdf").toLowerCase()==="img"||f.toLowerCase()==="image"?this.outputImg(u,d):this.outputPdf(u,d)},a.prototype.outputPdf=function(u,d){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(u,d)})},a.prototype.outputImg=function(u){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(u){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+u+'" is not supported.'}})},a.prototype.save=function(u){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(u?{filename:u}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},a.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},a.prototype.set=function(u){if(i(u)!=="object")return this;var d=Object.keys(u||{}).map(function(f){if(f in a.template.prop)return function(){this.prop[f]=u[f]};switch(f){case"margin":return this.setMargin.bind(this,u.margin);case"jsPDF":return function(){return this.opt.jsPDF=u.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,u.pageSize);default:return function(){this.opt[f]=u[f]}}},this);return this.then(function(){return this.thenList(d)})},a.prototype.get=function(u,d){return this.then(function(){var f=u in a.template.prop?this.prop[u]:this.opt[u];return d?d(f):f})},a.prototype.setMargin=function(u){return this.then(function(){switch(i(u)){case"number":u=[u,u,u,u];case"array":if(u.length===2&&(u=[u[0],u[1],u[0],u[1]]),u.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=u}).then(this.setPageSize)},a.prototype.setPageSize=function(u){function d(f,m){return Math.floor(f*m/72*96)}return this.then(function(){(u=u||Cn.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(u.inner={width:u.width-this.opt.margin[1]-this.opt.margin[3],height:u.height-this.opt.margin[0]-this.opt.margin[2]},u.inner.px={width:d(u.inner.width,u.k),height:d(u.inner.height,u.k)},u.inner.ratio=u.inner.height/u.inner.width),this.prop.pageSize=u})},a.prototype.setProgress=function(u,d,f,m){return u!=null&&(this.progress.val=u),d!=null&&(this.progress.state=d),f!=null&&(this.progress.n=f),m!=null&&(this.progress.stack=m),this.progress.ratio=this.progress.val/this.progress.state,this},a.prototype.updateProgress=function(u,d,f,m){return this.setProgress(u?this.progress.val+u:null,d||null,f?this.progress.n+f:null,m?this.progress.stack.concat(m):null)},a.prototype.then=function(u,d){var f=this;return this.thenCore(u,d,function(m,y){return f.updateProgress(null,null,1,[m]),Promise.prototype.then.call(this,function(x){return f.updateProgress(null,m),x}).then(m,y).then(function(x){return f.updateProgress(1),x})})},a.prototype.thenCore=function(u,d,f){f=f||Promise.prototype.then,u&&(u=u.bind(this)),d&&(d=d.bind(this));var m=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:a.convert(Object.assign({},this),Promise.prototype),y=f.call(m,u,d);return a.convert(y,this.__proto__)},a.prototype.thenExternal=function(u,d){return Promise.prototype.then.call(this,u,d)},a.prototype.thenList=function(u){var d=this;return u.forEach(function(f){d=d.thenCore(f)}),d},a.prototype.catch=function(u){u&&(u=u.bind(this));var d=Promise.prototype.catch.call(this,u);return a.convert(d,this)},a.prototype.catchExternal=function(u){return Promise.prototype.catch.call(this,u)},a.prototype.error=function(u){return this.then(function(){throw new Error(u)})},a.prototype.using=a.prototype.set,a.prototype.saveAs=a.prototype.save,a.prototype.export=a.prototype.output,a.prototype.run=a.prototype.then,Cn.getPageSize=function(u,d,f){if(yi(u)==="object"){var m=u;u=m.orientation,d=m.unit||d,f=m.format||f}d=d||"mm",f=f||"a4",u=(""+(u||"P")).toLowerCase();var y,x=(""+f).toLowerCase(),k={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(d){case"pt":y=1;break;case"mm":y=72/25.4;break;case"cm":y=72/2.54;break;case"in":y=72;break;case"px":y=.75;break;case"pc":case"em":y=12;break;case"ex":y=6;break;default:throw"Invalid unit: "+d}var b,T=0,$=0;if(k.hasOwnProperty(x))T=k[x][1]/y,$=k[x][0]/y;else try{T=f[1],$=f[0]}catch{throw new Error("Invalid format: "+f)}if(u==="p"||u==="portrait")u="p",$>T&&(b=$,$=T,T=b);else{if(u!=="l"&&u!=="landscape")throw"Invalid orientation: "+u;u="l",T>$&&(b=$,$=T,T=b)}return{width:$,height:T,unit:d,k:y,orientation:u}},e.html=function(u,d){(d=d||{}).callback=d.callback||function(){},d.html2canvas=d.html2canvas||{},d.html2canvas.canvas=d.html2canvas.canvas||this.canvas,d.jsPDF=d.jsPDF||this,d.fontFaces=d.fontFaces?d.fontFaces.map(zf):null;var f=new a(d);return d.worker?f:f.from(u).doCallback()}}(Cn.API),Cn.API.addJS=function(e){return _g=e,this.internal.events.subscribe("postPutResources",function(){ah=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(ah+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),yg=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+_g+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){ah!==void 0&&yg!==void 0&&this.internal.out("/Names <</JavaScript "+ah+" 0 R>>")}),this},function(e){var t;e.events.push(["postPutResources",function(){var n=this,i=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var o=n.outline.render().split(/\r\n/),a=0;a<o.length;a++){var u=o[a],d=i.exec(u);if(d!=null){var f=d[1];n.internal.newObjectDeferredBegin(f,!1)}n.internal.write(u)}if(this.outline.createNamedDestinations){var m=this.internal.pages.length,y=[];for(a=0;a<m;a++){var x=n.internal.newObject();y.push(x);var k=n.internal.getPageInfo(a+1);n.internal.write("<< /D["+k.objId+" 0 R /XYZ null null null]>> endobj")}var b=n.internal.newObject();for(n.internal.write("<< /Names [ "),a=0;a<y.length;a++)n.internal.write("(page_"+(a+1)+")"+y[a]+" 0 R");n.internal.write(" ] >>","endobj"),t=n.internal.newObject(),n.internal.write("<< /Dests "+b+" 0 R"),n.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+t+" 0 R"))}]),e.events.push(["initialized",function(){var n=this;n.outline={createNamedDestinations:!1,root:{children:[]}},n.outline.add=function(i,o,a){var u={title:o,options:a,children:[]};return i==null&&(i=this.root),i.children.push(u),u},n.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=n,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},n.outline.genIds_r=function(i){i.id=n.internal.newObjectDeferred();for(var o=0;o<i.children.length;o++)this.genIds_r(i.children[o])},n.outline.renderRoot=function(i){this.objStart(i),this.line("/Type /Outlines"),i.children.length>0&&(this.line("/First "+this.makeRef(i.children[0])),this.line("/Last "+this.makeRef(i.children[i.children.length-1]))),this.line("/Count "+this.count_r({count:0},i)),this.objEnd()},n.outline.renderItems=function(i){for(var o=this.ctx.pdf.internal.getVerticalCoordinateString,a=0;a<i.children.length;a++){var u=i.children[a];this.objStart(u),this.line("/Title "+this.makeString(u.title)),this.line("/Parent "+this.makeRef(i)),a>0&&this.line("/Prev "+this.makeRef(i.children[a-1])),a<i.children.length-1&&this.line("/Next "+this.makeRef(i.children[a+1])),u.children.length>0&&(this.line("/First "+this.makeRef(u.children[0])),this.line("/Last "+this.makeRef(u.children[u.children.length-1])));var d=this.count=this.count_r({count:0},u);if(d>0&&this.line("/Count "+d),u.options&&u.options.pageNumber){var f=n.internal.getPageInfo(u.options.pageNumber);this.line("/Dest ["+f.objId+" 0 R /XYZ 0 "+o(0)+" 0]")}this.objEnd()}for(var m=0;m<i.children.length;m++)this.renderItems(i.children[m])},n.outline.line=function(i){this.ctx.val+=i+`\r
`},n.outline.makeRef=function(i){return i.id+" 0 R"},n.outline.makeString=function(i){return"("+n.internal.pdfEscape(i)+")"},n.outline.objStart=function(i){this.ctx.val+=`\r
`+i.id+` 0 obj\r
<<\r
`},n.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},n.outline.count_r=function(i,o){for(var a=0;a<o.children.length;a++)i.count++,this.count_r(i,o.children[a]);return i.count}}])}(Cn.API),function(e){var t=[192,193,194,195,196,197,198,199];e.processJPEG=function(n,i,o,a,u,d){var f,m=this.decode.DCT_DECODE,y=null;if(typeof n=="string"||this.__addimage__.isArrayBuffer(n)||this.__addimage__.isArrayBufferView(n)){switch(n=u||n,n=this.__addimage__.isArrayBuffer(n)?new Uint8Array(n):n,(f=function(x){for(var k,b=256*x.charCodeAt(4)+x.charCodeAt(5),T=x.length,$={width:0,height:0,numcomponents:1},H=4;H<T;H+=2){if(H+=b,t.indexOf(x.charCodeAt(H+1))!==-1){k=256*x.charCodeAt(H+5)+x.charCodeAt(H+6),$={width:256*x.charCodeAt(H+7)+x.charCodeAt(H+8),height:k,numcomponents:x.charCodeAt(H+9)};break}b=256*x.charCodeAt(H+2)+x.charCodeAt(H+3)}return $}(n=this.__addimage__.isArrayBufferView(n)?this.__addimage__.arrayBufferToBinaryString(n):n)).numcomponents){case 1:d=this.color_spaces.DEVICE_GRAY;break;case 4:d=this.color_spaces.DEVICE_CMYK;break;case 3:d=this.color_spaces.DEVICE_RGB}y={data:n,width:f.width,height:f.height,colorSpace:d,bitsPerComponent:8,filter:m,index:i,alias:o}}return y}}(Cn.API);var Lu,lh,bg,wg,xg,WC=function(){var e,t,n;function i(a){var u,d,f,m,y,x,k,b,T,$,H,I,Q,se;for(this.data=a,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},x=null;;){switch(u=this.readUInt32(),T=(function(){var we,Be;for(Be=[],we=0;we<4;++we)Be.push(String.fromCharCode(this.data[this.pos++]));return Be}).call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(u);break;case"fcTL":x&&this.animation.frames.push(x),this.pos+=4,x={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},y=this.readUInt16(),m=this.readUInt16()||100,x.delay=1e3*y/m,x.disposeOp=this.data[this.pos++],x.blendOp=this.data[this.pos++],x.data=[];break;case"IDAT":case"fdAT":for(T==="fdAT"&&(this.pos+=4,u-=4),a=(x!=null?x.data:void 0)||this.imgData,I=0;0<=u?I<u:I>u;0<=u?++I:--I)a.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(f=this.palette.length/3,this.transparency.indexed=this.read(u),this.transparency.indexed.length>f)throw new Error("More transparent colors than palette size");if(($=f-this.transparency.indexed.length)>0)for(Q=0;0<=$?Q<$:Q>$;0<=$?++Q:--Q)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(u)[0];break;case 2:this.transparency.rgb=this.read(u)}break;case"tEXt":k=(H=this.read(u)).indexOf(0),b=String.fromCharCode.apply(String,H.slice(0,k)),this.text[b]=String.fromCharCode.apply(String,H.slice(k+1));break;case"IEND":return x&&this.animation.frames.push(x),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=(se=this.colorType)===4||se===6,d=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*d,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=u}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}i.prototype.read=function(a){var u,d;for(d=[],u=0;0<=a?u<a:u>a;0<=a?++u:--u)d.push(this.data[this.pos++]);return d},i.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},i.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},i.prototype.decodePixels=function(a){var u=this.pixelBitlength/8,d=new Uint8Array(this.width*this.height*u),f=0,m=this;if(a==null&&(a=this.imgData),a.length===0)return new Uint8Array(0);function y(x,k,b,T){var $,H,I,Q,se,we,Be,$e,Ue,Pe,Te,He,ae,re,oe,Y,C,N,K,J,Ee,ue=Math.ceil((m.width-x)/b),ye=Math.ceil((m.height-k)/T),O=m.width==ue&&m.height==ye;for(re=u*ue,He=O?d:new Uint8Array(re*ye),we=a.length,ae=0,H=0;ae<ye&&f<we;){switch(a[f++]){case 0:for(Q=C=0;C<re;Q=C+=1)He[H++]=a[f++];break;case 1:for(Q=N=0;N<re;Q=N+=1)$=a[f++],se=Q<u?0:He[H-u],He[H++]=($+se)%256;break;case 2:for(Q=K=0;K<re;Q=K+=1)$=a[f++],I=(Q-Q%u)/u,oe=ae&&He[(ae-1)*re+I*u+Q%u],He[H++]=(oe+$)%256;break;case 3:for(Q=J=0;J<re;Q=J+=1)$=a[f++],I=(Q-Q%u)/u,se=Q<u?0:He[H-u],oe=ae&&He[(ae-1)*re+I*u+Q%u],He[H++]=($+Math.floor((se+oe)/2))%256;break;case 4:for(Q=Ee=0;Ee<re;Q=Ee+=1)$=a[f++],I=(Q-Q%u)/u,se=Q<u?0:He[H-u],ae===0?oe=Y=0:(oe=He[(ae-1)*re+I*u+Q%u],Y=I&&He[(ae-1)*re+(I-1)*u+Q%u]),Be=se+oe-Y,$e=Math.abs(Be-se),Pe=Math.abs(Be-oe),Te=Math.abs(Be-Y),Ue=$e<=Pe&&$e<=Te?se:Pe<=Te?oe:Y,He[H++]=($+Ue)%256;break;default:throw new Error("Invalid filter algorithm: "+a[f-1])}if(!O){var ie=((k+ae*T)*m.width+x)*u,le=ae*re;for(Q=0;Q<ue;Q+=1){for(var fe=0;fe<u;fe+=1)d[ie++]=He[le++];ie+=(b-1)*u}}ae++}}return a=PC(a),m.interlaceMethod==1?(y(0,0,8,8),y(4,0,8,8),y(0,4,4,8),y(2,0,4,4),y(0,2,2,4),y(1,0,2,2),y(0,1,1,2)):y(0,0,1,1),d},i.prototype.decodePalette=function(){var a,u,d,f,m,y,x,k,b;for(d=this.palette,y=this.transparency.indexed||[],m=new Uint8Array((y.length||0)+d.length),f=0,a=0,u=x=0,k=d.length;x<k;u=x+=3)m[f++]=d[u],m[f++]=d[u+1],m[f++]=d[u+2],m[f++]=(b=y[a++])!=null?b:255;return m},i.prototype.copyToImageData=function(a,u){var d,f,m,y,x,k,b,T,$,H,I;if(f=this.colors,$=null,d=this.hasAlphaChannel,this.palette.length&&($=(I=this._decodedPalette)!=null?I:this._decodedPalette=this.decodePalette(),f=4,d=!0),T=(m=a.data||a).length,x=$||u,y=k=0,f===1)for(;y<T;)b=$?4*u[y/4]:k,H=x[b++],m[y++]=H,m[y++]=H,m[y++]=H,m[y++]=d?x[b++]:255,k=b;else for(;y<T;)b=$?4*u[y/4]:k,m[y++]=x[b++],m[y++]=x[b++],m[y++]=x[b++],m[y++]=d?x[b++]:255,k=b},i.prototype.decode=function(){var a;return a=new Uint8Array(this.width*this.height*4),this.copyToImageData(a,this.decodePixels()),a};var o=function(){if(Object.prototype.toString.call(Sn)==="[object Window]"){try{t=Sn.document.createElement("canvas"),n=t.getContext("2d")}catch{return!1}return!0}return!1};return o(),e=function(a){var u;if(o()===!0)return n.width=a.width,n.height=a.height,n.clearRect(0,0,a.width,a.height),n.putImageData(a,0,0),(u=new Image).src=t.toDataURL(),u;throw new Error("This method requires a Browser with Canvas-capability.")},i.prototype.decodeFrames=function(a){var u,d,f,m,y,x,k,b;if(this.animation){for(b=[],d=y=0,x=(k=this.animation.frames).length;y<x;d=++y)u=k[d],f=a.createImageData(u.width,u.height),m=this.decodePixels(new Uint8Array(u.data)),this.copyToImageData(f,m),u.imageData=f,b.push(u.image=e(f));return b}},i.prototype.renderFrame=function(a,u){var d,f,m;return d=(f=this.animation.frames)[u],m=f[u-1],u===0&&a.clearRect(0,0,this.width,this.height),(m!=null?m.disposeOp:void 0)===1?a.clearRect(m.xOffset,m.yOffset,m.width,m.height):(m!=null?m.disposeOp:void 0)===2&&a.putImageData(m.imageData,m.xOffset,m.yOffset),d.blendOp===0&&a.clearRect(d.xOffset,d.yOffset,d.width,d.height),a.drawImage(d.image,d.xOffset,d.yOffset)},i.prototype.animate=function(a){var u,d,f,m,y,x,k=this;return d=0,x=this.animation,m=x.numFrames,f=x.frames,y=x.numPlays,(u=function(){var b,T;if(b=d++%m,T=f[b],k.renderFrame(a,b),m>1&&d/m<y)return k.animation._timeout=setTimeout(u,T.delay)})()},i.prototype.stopAnimation=function(){var a;return clearTimeout((a=this.animation)!=null?a._timeout:void 0)},i.prototype.render=function(a){var u,d;return a._png&&a._png.stopAnimation(),a._png=this,a.width=this.width,a.height=this.height,u=a.getContext("2d"),this.animation?(this.decodeFrames(u),this.animate(u)):(d=u.createImageData(this.width,this.height),this.copyToImageData(d,this.decodePixels()),u.putImageData(d,0,0))},i}();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function ZC(e){var t=0;if(e[t++]!==71||e[t++]!==73||e[t++]!==70||e[t++]!==56||(e[t++]+1&253)!=56||e[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var n=e[t++]|e[t++]<<8,i=e[t++]|e[t++]<<8,o=e[t++],a=o>>7,u=1<<(7&o)+1;e[t++],e[t++];var d=null,f=null;a&&(d=t,f=u,t+=3*u);var m=!0,y=[],x=0,k=null,b=0,T=null;for(this.width=n,this.height=i;m&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(e[t]!==11||e[t+1]==78&&e[t+2]==69&&e[t+3]==84&&e[t+4]==83&&e[t+5]==67&&e[t+6]==65&&e[t+7]==80&&e[t+8]==69&&e[t+9]==50&&e[t+10]==46&&e[t+11]==48&&e[t+12]==3&&e[t+13]==1&&e[t+16]==0)t+=14,T=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!((ae=e[t++])>=0))throw Error("Invalid block size");if(ae===0)break;t+=ae}break;case 249:if(e[t++]!==4||e[t+4]!==0)throw new Error("Invalid graphics extension block.");var $=e[t++];x=e[t++]|e[t++]<<8,k=e[t++],!(1&$)&&(k=null),b=$>>2&7,t++;break;case 254:for(;;){if(!((ae=e[t++])>=0))throw Error("Invalid block size");if(ae===0)break;t+=ae}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var H=e[t++]|e[t++]<<8,I=e[t++]|e[t++]<<8,Q=e[t++]|e[t++]<<8,se=e[t++]|e[t++]<<8,we=e[t++],Be=we>>6&1,$e=1<<(7&we)+1,Ue=d,Pe=f,Te=!1;we>>7&&(Te=!0,Ue=t,Pe=$e,t+=3*$e);var He=t;for(t++;;){var ae;if(!((ae=e[t++])>=0))throw Error("Invalid block size");if(ae===0)break;t+=ae}y.push({x:H,y:I,width:Q,height:se,has_local_palette:Te,palette_offset:Ue,palette_size:Pe,data_offset:He,data_length:t-He,transparent_index:k,interlaced:!!Be,delay:x,disposal:b});break;case 59:m=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return y.length},this.loopCount=function(){return T},this.frameInfo=function(re){if(re<0||re>=y.length)throw new Error("Frame index out of range.");return y[re]},this.decodeAndBlitFrameBGRA=function(re,oe){var Y=this.frameInfo(re),C=Y.width*Y.height,N=new Uint8Array(C);Lg(e,Y.data_offset,N,C);var K=Y.palette_offset,J=Y.transparent_index;J===null&&(J=256);var Ee=Y.width,ue=n-Ee,ye=Ee,O=4*(Y.y*n+Y.x),ie=4*((Y.y+Y.height)*n+Y.x),le=O,fe=4*ue;Y.interlaced===!0&&(fe+=4*n*7);for(var _e=8,ee=0,G=N.length;ee<G;++ee){var q=N[ee];if(ye===0&&(ye=Ee,(le+=fe)>=ie&&(fe=4*ue+4*n*(_e-1),le=O+(Ee+ue)*(_e<<1),_e>>=1)),q===J)le+=4;else{var de=e[K+3*q],ce=e[K+3*q+1],V=e[K+3*q+2];oe[le++]=V,oe[le++]=ce,oe[le++]=de,oe[le++]=255}--ye}},this.decodeAndBlitFrameRGBA=function(re,oe){var Y=this.frameInfo(re),C=Y.width*Y.height,N=new Uint8Array(C);Lg(e,Y.data_offset,N,C);var K=Y.palette_offset,J=Y.transparent_index;J===null&&(J=256);var Ee=Y.width,ue=n-Ee,ye=Ee,O=4*(Y.y*n+Y.x),ie=4*((Y.y+Y.height)*n+Y.x),le=O,fe=4*ue;Y.interlaced===!0&&(fe+=4*n*7);for(var _e=8,ee=0,G=N.length;ee<G;++ee){var q=N[ee];if(ye===0&&(ye=Ee,(le+=fe)>=ie&&(fe=4*ue+4*n*(_e-1),le=O+(Ee+ue)*(_e<<1),_e>>=1)),q===J)le+=4;else{var de=e[K+3*q],ce=e[K+3*q+1],V=e[K+3*q+2];oe[le++]=de,oe[le++]=ce,oe[le++]=V,oe[le++]=255}--ye}}}function Lg(e,t,n,i){for(var o=e[t++],a=1<<o,u=a+1,d=u+1,f=o+1,m=(1<<f)-1,y=0,x=0,k=0,b=e[t++],T=new Int32Array(4096),$=null;;){for(;y<16&&b!==0;)x|=e[t++]<<y,y+=8,b===1?b=e[t++]:--b;if(y<f)break;var H=x&m;if(x>>=f,y-=f,H!==a){if(H===u)break;for(var I=H<d?H:$,Q=0,se=I;se>a;)se=T[se]>>8,++Q;var we=se;if(k+Q+(I!==H?1:0)>i)return void Li.log("Warning, gif stream longer than expected.");n[k++]=we;var Be=k+=Q;for(I!==H&&(n[k++]=we),se=I;Q--;)se=T[se],n[--Be]=255&se,se>>=8;$!==null&&d<4096&&(T[d++]=$<<8|we,d>=m+1&&f<12&&(++f,m=m<<1|1)),$=H}else d=u+1,m=(1<<(f=o+1))-1,$=null}return k!==i&&Li.log("Warning, gif stream shorter than expected."),n}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function ef(e){var t,n,i,o,a,u=Math.floor,d=new Array(64),f=new Array(64),m=new Array(64),y=new Array(64),x=new Array(65535),k=new Array(65535),b=new Array(64),T=new Array(64),$=[],H=0,I=7,Q=new Array(64),se=new Array(64),we=new Array(64),Be=new Array(256),$e=new Array(2048),Ue=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],Pe=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],Te=[0,1,2,3,4,5,6,7,8,9,10,11],He=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],ae=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],re=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],oe=[0,1,2,3,4,5,6,7,8,9,10,11],Y=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],C=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function N(O,ie){for(var le=0,fe=0,_e=new Array,ee=1;ee<=16;ee++){for(var G=1;G<=O[ee];G++)_e[ie[fe]]=[],_e[ie[fe]][0]=le,_e[ie[fe]][1]=ee,fe++,le++;le*=2}return _e}function K(O){for(var ie=O[0],le=O[1]-1;le>=0;)ie&1<<le&&(H|=1<<I),le--,--I<0&&(H==255?(J(255),J(0)):J(H),I=7,H=0)}function J(O){$.push(O)}function Ee(O){J(O>>8&255),J(255&O)}function ue(O,ie,le,fe,_e){for(var ee,G=_e[0],q=_e[240],de=function(De,Je){var Ze,yt,wt,Pt,Rt,qt,lt,Oe,kt,Et,St=0;for(kt=0;kt<8;++kt){Ze=De[St],yt=De[St+1],wt=De[St+2],Pt=De[St+3],Rt=De[St+4],qt=De[St+5],lt=De[St+6];var nt=Ze+(Oe=De[St+7]),st=Ze-Oe,pn=yt+lt,Gt=yt-lt,nn=wt+qt,$n=wt-qt,an=Pt+Rt,Dn=Pt-Rt,Pn=nt+an,Ui=nt-an,Oi=pn+nn,qn=pn-nn;De[St]=Pn+Oi,De[St+4]=Pn-Oi;var $t=.707106781*(qn+Ui);De[St+2]=Ui+$t,De[St+6]=Ui-$t;var Bn=.382683433*((Pn=Dn+$n)-(qn=Gt+st)),wi=.5411961*Pn+Bn,Yn=1.306562965*qn+Bn,xi=.707106781*(Oi=$n+Gt),pi=st+xi,sn=st-xi;De[St+5]=sn+wi,De[St+3]=sn-wi,De[St+1]=pi+Yn,De[St+7]=pi-Yn,St+=8}for(St=0,kt=0;kt<8;++kt){Ze=De[St],yt=De[St+8],wt=De[St+16],Pt=De[St+24],Rt=De[St+32],qt=De[St+40],lt=De[St+48];var mn=Ze+(Oe=De[St+56]),Yt=Ze-Oe,gi=yt+lt,In=yt-lt,bt=wt+qt,Xn=wt-qt,Ii=Pt+Rt,ui=Pt-Rt,yr=mn+Ii,lr=mn-Ii,_r=gi+bt,Yi=gi-bt;De[St]=yr+_r,De[St+32]=yr-_r;var ur=.707106781*(Yi+lr);De[St+16]=lr+ur,De[St+48]=lr-ur;var jr=.382683433*((yr=ui+Xn)-(Yi=In+Yt)),Ss=.5411961*yr+jr,Zs=1.306562965*Yi+jr,Ks=.707106781*(_r=Xn+In),Gr=Yt+Ks,ds=Yt-Ks;De[St+40]=ds+Ss,De[St+24]=ds-Ss,De[St+8]=Gr+Zs,De[St+56]=Gr-Zs,St++}for(kt=0;kt<64;++kt)Et=De[kt]*Je[kt],b[kt]=Et>0?Et+.5|0:Et-.5|0;return b}(O,ie),ce=0;ce<64;++ce)T[Ue[ce]]=de[ce];var V=T[0]-le;le=T[0],V==0?K(fe[0]):(K(fe[k[ee=32767+V]]),K(x[ee]));for(var Z=63;Z>0&&T[Z]==0;)Z--;if(Z==0)return K(G),le;for(var F,D=1;D<=Z;){for(var j=D;T[D]==0&&D<=Z;)++D;var Fe=D-j;if(Fe>=16){F=Fe>>4;for(var qe=1;qe<=F;++qe)K(q);Fe&=15}ee=32767+T[D],K(_e[(Fe<<4)+k[ee]]),K(x[ee]),D++}return Z!=63&&K(G),le}function ye(O){O=Math.min(Math.max(O,1),100),a!=O&&(function(ie){for(var le=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],fe=0;fe<64;fe++){var _e=u((le[fe]*ie+50)/100);_e=Math.min(Math.max(_e,1),255),d[Ue[fe]]=_e}for(var ee=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],G=0;G<64;G++){var q=u((ee[G]*ie+50)/100);q=Math.min(Math.max(q,1),255),f[Ue[G]]=q}for(var de=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],ce=0,V=0;V<8;V++)for(var Z=0;Z<8;Z++)m[ce]=1/(d[Ue[ce]]*de[V]*de[Z]*8),y[ce]=1/(f[Ue[ce]]*de[V]*de[Z]*8),ce++}(O<50?Math.floor(5e3/O):Math.floor(200-2*O)),a=O)}this.encode=function(O,ie){ie&&ye(ie),$=new Array,H=0,I=7,Ee(65496),Ee(65504),Ee(16),J(74),J(70),J(73),J(70),J(0),J(1),J(1),J(0),Ee(1),Ee(1),J(0),J(0),function(){Ee(65499),Ee(132),J(0);for(var yt=0;yt<64;yt++)J(d[yt]);J(1);for(var wt=0;wt<64;wt++)J(f[wt])}(),function(yt,wt){Ee(65472),Ee(17),J(8),Ee(wt),Ee(yt),J(3),J(1),J(17),J(0),J(2),J(17),J(1),J(3),J(17),J(1)}(O.width,O.height),function(){Ee(65476),Ee(418),J(0);for(var yt=0;yt<16;yt++)J(Pe[yt+1]);for(var wt=0;wt<=11;wt++)J(Te[wt]);J(16);for(var Pt=0;Pt<16;Pt++)J(He[Pt+1]);for(var Rt=0;Rt<=161;Rt++)J(ae[Rt]);J(1);for(var qt=0;qt<16;qt++)J(re[qt+1]);for(var lt=0;lt<=11;lt++)J(oe[lt]);J(17);for(var Oe=0;Oe<16;Oe++)J(Y[Oe+1]);for(var kt=0;kt<=161;kt++)J(C[kt])}(),Ee(65498),Ee(12),J(3),J(1),J(0),J(2),J(17),J(3),J(17),J(0),J(63),J(0);var le=0,fe=0,_e=0;H=0,I=7,this.encode.displayName="_encode_";for(var ee,G,q,de,ce,V,Z,F,D,j=O.data,Fe=O.width,qe=O.height,De=4*Fe,Je=0;Je<qe;){for(ee=0;ee<De;){for(ce=De*Je+ee,Z=-1,F=0,D=0;D<64;D++)V=ce+(F=D>>3)*De+(Z=4*(7&D)),Je+F>=qe&&(V-=De*(Je+1+F-qe)),ee+Z>=De&&(V-=ee+Z-De+4),G=j[V++],q=j[V++],de=j[V++],Q[D]=($e[G]+$e[q+256>>0]+$e[de+512>>0]>>16)-128,se[D]=($e[G+768>>0]+$e[q+1024>>0]+$e[de+1280>>0]>>16)-128,we[D]=($e[G+1280>>0]+$e[q+1536>>0]+$e[de+1792>>0]>>16)-128;le=ue(Q,m,le,t,i),fe=ue(se,y,fe,n,o),_e=ue(we,y,_e,n,o),ee+=32}Je+=8}if(I>=0){var Ze=[];Ze[1]=I+1,Ze[0]=(1<<I+1)-1,K(Ze)}return Ee(65497),new Uint8Array($)},e=e||50,function(){for(var O=String.fromCharCode,ie=0;ie<256;ie++)Be[ie]=O(ie)}(),t=N(Pe,Te),n=N(re,oe),i=N(He,ae),o=N(Y,C),function(){for(var O=1,ie=2,le=1;le<=15;le++){for(var fe=O;fe<ie;fe++)k[32767+fe]=le,x[32767+fe]=[],x[32767+fe][1]=le,x[32767+fe][0]=fe;for(var _e=-(ie-1);_e<=-O;_e++)k[32767+_e]=le,x[32767+_e]=[],x[32767+_e][1]=le,x[32767+_e][0]=ie-1+_e;O<<=1,ie<<=1}}(),function(){for(var O=0;O<256;O++)$e[O]=19595*O,$e[O+256>>0]=38470*O,$e[O+512>>0]=7471*O+32768,$e[O+768>>0]=-11059*O,$e[O+1024>>0]=-21709*O,$e[O+1280>>0]=32768*O+8421375,$e[O+1536>>0]=-27439*O,$e[O+1792>>0]=-5329*O}(),ye(e)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Jo(e,t){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function Cg(e){function t(Pe){if(!Pe)throw Error("assert :P")}function n(Pe,Te,He){for(var ae=0;4>ae;ae++)if(Pe[Te+ae]!=He.charCodeAt(ae))return!0;return!1}function i(Pe,Te,He,ae,re){for(var oe=0;oe<re;oe++)Pe[Te+oe]=He[ae+oe]}function o(Pe,Te,He,ae){for(var re=0;re<ae;re++)Pe[Te+re]=He}function a(Pe){return new Int32Array(Pe)}function u(Pe,Te){for(var He=[],ae=0;ae<Pe;ae++)He.push(new Te);return He}function d(Pe,Te){var He=[];return function ae(re,oe,Y){for(var C=Y[oe],N=0;N<C&&(re.push(Y.length>oe+1?[]:new Te),!(Y.length<oe+1));N++)ae(re[N],oe+1,Y)}(He,0,Pe),He}var f=function(){var Pe=this;function Te(p,w){for(var M=1<<w-1>>>0;p&M;)M>>>=1;return M?(p&M-1)+M:p}function He(p,w,M,z,ne){t(!(z%M));do p[w+(z-=M)]=ne;while(0<z)}function ae(p,w,M,z,ne){if(t(2328>=ne),512>=ne)var ge=a(512);else if((ge=a(ne))==null)return 0;return function(ve,be,xe,Ae,Qe,mt){var vt,ut,Mt=be,Ct=1<<xe,it=a(16),ot=a(16);for(t(Qe!=0),t(Ae!=null),t(ve!=null),t(0<xe),ut=0;ut<Qe;++ut){if(15<Ae[ut])return 0;++it[Ae[ut]]}if(it[0]==Qe)return 0;for(ot[1]=0,vt=1;15>vt;++vt){if(it[vt]>1<<vt)return 0;ot[vt+1]=ot[vt]+it[vt]}for(ut=0;ut<Qe;++ut)vt=Ae[ut],0<Ae[ut]&&(mt[ot[vt]++]=ut);if(ot[15]==1)return(Ae=new re).g=0,Ae.value=mt[0],He(ve,Mt,1,Ct,Ae),Ct;var Bt,zt=-1,Ot=Ct-1,tn=0,Wt=1,gn=1,s=1<<xe;for(ut=0,vt=1,Qe=2;vt<=xe;++vt,Qe<<=1){if(Wt+=gn<<=1,0>(gn-=it[vt]))return 0;for(;0<it[vt];--it[vt])(Ae=new re).g=vt,Ae.value=mt[ut++],He(ve,Mt+tn,Qe,s,Ae),tn=Te(tn,vt)}for(vt=xe+1,Qe=2;15>=vt;++vt,Qe<<=1){if(Wt+=gn<<=1,0>(gn-=it[vt]))return 0;for(;0<it[vt];--it[vt]){if(Ae=new re,(tn&Ot)!=zt){for(Mt+=s,Bt=1<<(zt=vt)-xe;15>zt&&!(0>=(Bt-=it[zt]));)++zt,Bt<<=1;Ct+=s=1<<(Bt=zt-xe),ve[be+(zt=tn&Ot)].g=Bt+xe,ve[be+zt].value=Mt-be-zt}Ae.g=vt-xe,Ae.value=mt[ut++],He(ve,Mt+(tn>>xe),Qe,s,Ae),tn=Te(tn,vt)}}return Wt!=2*ot[15]-1?0:Ct}(p,w,M,z,ne,ge)}function re(){this.value=this.g=0}function oe(){this.value=this.g=0}function Y(){this.G=u(5,re),this.H=a(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=u(ji,oe)}function C(p,w,M,z){t(p!=null),t(w!=null),t(2147483648>z),p.Ca=254,p.I=0,p.b=-8,p.Ka=0,p.oa=w,p.pa=M,p.Jd=w,p.Yc=M+z,p.Zc=4<=z?M+z-4+1:M,ee(p)}function N(p,w){for(var M=0;0<w--;)M|=q(p,128)<<w;return M}function K(p,w){var M=N(p,w);return G(p)?-M:M}function J(p,w,M,z){var ne,ge=0;for(t(p!=null),t(w!=null),t(4294967288>z),p.Sb=z,p.Ra=0,p.u=0,p.h=0,4<z&&(z=4),ne=0;ne<z;++ne)ge+=w[M+ne]<<8*ne;p.Ra=ge,p.bb=z,p.oa=w,p.pa=M}function Ee(p){for(;8<=p.u&&p.bb<p.Sb;)p.Ra>>>=8,p.Ra+=p.oa[p.pa+p.bb]<<Lr-8>>>0,++p.bb,p.u-=8;le(p)&&(p.h=1,p.u=0)}function ue(p,w){if(t(0<=w),!p.h&&w<=Ar){var M=ie(p)&wa[w];return p.u+=w,Ee(p),M}return p.h=1,p.u=0}function ye(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function O(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function ie(p){return p.Ra>>>(p.u&Lr-1)>>>0}function le(p){return t(p.bb<=p.Sb),p.h||p.bb==p.Sb&&p.u>Lr}function fe(p,w){p.u=w,p.h=le(p)}function _e(p){p.u>=xa&&(t(p.u>=xa),Ee(p))}function ee(p){t(p!=null&&p.oa!=null),p.pa<p.Zc?(p.I=(p.oa[p.pa++]|p.I<<8)>>>0,p.b+=8):(t(p!=null&&p.oa!=null),p.pa<p.Yc?(p.b+=8,p.I=p.oa[p.pa++]|p.I<<8):p.Ka?p.b=0:(p.I<<=8,p.b+=8,p.Ka=1))}function G(p){return N(p,1)}function q(p,w){var M=p.Ca;0>p.b&&ee(p);var z=p.b,ne=M*w>>>8,ge=(p.I>>>z>ne)+0;for(ge?(M-=ne,p.I-=ne+1<<z>>>0):M=ne+1,z=M,ne=0;256<=z;)ne+=8,z>>=8;return z=7^ne+hr[z],p.b-=z,p.Ca=(M<<z)-1,ge}function de(p,w,M){p[w+0]=M>>24&255,p[w+1]=M>>16&255,p[w+2]=M>>8&255,p[w+3]=M>>0&255}function ce(p,w){return p[w+0]<<0|p[w+1]<<8}function V(p,w){return ce(p,w)|p[w+2]<<16}function Z(p,w){return ce(p,w)|ce(p,w+2)<<16}function F(p,w){var M=1<<w;return t(p!=null),t(0<w),p.X=a(M),p.X==null?0:(p.Mb=32-w,p.Xa=w,1)}function D(p,w){t(p!=null),t(w!=null),t(p.Xa==w.Xa),i(w.X,0,p.X,0,1<<w.Xa)}function j(){this.X=[],this.Xa=this.Mb=0}function Fe(p,w,M,z){t(M!=null),t(z!=null);var ne=M[0],ge=z[0];return ne==0&&(ne=(p*ge+w/2)/w),ge==0&&(ge=(w*ne+p/2)/p),0>=ne||0>=ge?0:(M[0]=ne,z[0]=ge,1)}function qe(p,w){return p+(1<<w)-1>>>w}function De(p,w){return((4278255360&p)+(4278255360&w)>>>0&4278255360)+((16711935&p)+(16711935&w)>>>0&16711935)>>>0}function Je(p,w){Pe[w]=function(M,z,ne,ge,ve,be,xe){var Ae;for(Ae=0;Ae<ve;++Ae){var Qe=Pe[p](be[xe+Ae-1],ne,ge+Ae);be[xe+Ae]=De(M[z+Ae],Qe)}}}function Ze(){this.ud=this.hd=this.jd=0}function yt(p,w){return((4278124286&(p^w))>>>1)+(p&w)>>>0}function wt(p){return 0<=p&&256>p?p:0>p?0:255<p?255:void 0}function Pt(p,w){return wt(p+(p-w+.5>>1))}function Rt(p,w,M){return Math.abs(w-M)-Math.abs(p-M)}function qt(p,w,M,z,ne,ge,ve){for(z=ge[ve-1],M=0;M<ne;++M)ge[ve+M]=z=De(p[w+M],z)}function lt(p,w,M,z,ne){var ge;for(ge=0;ge<M;++ge){var ve=p[w+ge],be=ve>>8&255,xe=16711935&(xe=(xe=16711935&ve)+((be<<16)+be));z[ne+ge]=(4278255360&ve)+xe>>>0}}function Oe(p,w){w.jd=p>>0&255,w.hd=p>>8&255,w.ud=p>>16&255}function kt(p,w,M,z,ne,ge){var ve;for(ve=0;ve<z;++ve){var be=w[M+ve],xe=be>>>8,Ae=be,Qe=255&(Qe=(Qe=be>>>16)+((p.jd<<24>>24)*(xe<<24>>24)>>>5));Ae=255&(Ae=(Ae=Ae+((p.hd<<24>>24)*(xe<<24>>24)>>>5))+((p.ud<<24>>24)*(Qe<<24>>24)>>>5)),ne[ge+ve]=(4278255360&be)+(Qe<<16)+Ae}}function Et(p,w,M,z,ne){Pe[w]=function(ge,ve,be,xe,Ae,Qe,mt,vt,ut){for(xe=mt;xe<vt;++xe)for(mt=0;mt<ut;++mt)Ae[Qe++]=ne(be[z(ge[ve++])])},Pe[p]=function(ge,ve,be,xe,Ae,Qe,mt){var vt=8>>ge.b,ut=ge.Ea,Mt=ge.K[0],Ct=ge.w;if(8>vt)for(ge=(1<<ge.b)-1,Ct=(1<<vt)-1;ve<be;++ve){var it,ot=0;for(it=0;it<ut;++it)it&ge||(ot=z(xe[Ae++])),Qe[mt++]=ne(Mt[ot&Ct]),ot>>=vt}else Pe["VP8LMapColor"+M](xe,Ae,Mt,Ct,Qe,mt,ve,be,ut)}}function St(p,w,M,z,ne){for(M=w+M;w<M;){var ge=p[w++];z[ne++]=ge>>16&255,z[ne++]=ge>>8&255,z[ne++]=ge>>0&255}}function nt(p,w,M,z,ne){for(M=w+M;w<M;){var ge=p[w++];z[ne++]=ge>>16&255,z[ne++]=ge>>8&255,z[ne++]=ge>>0&255,z[ne++]=ge>>24&255}}function st(p,w,M,z,ne){for(M=w+M;w<M;){var ge=(ve=p[w++])>>16&240|ve>>12&15,ve=ve>>0&240|ve>>28&15;z[ne++]=ge,z[ne++]=ve}}function pn(p,w,M,z,ne){for(M=w+M;w<M;){var ge=(ve=p[w++])>>16&248|ve>>13&7,ve=ve>>5&224|ve>>3&31;z[ne++]=ge,z[ne++]=ve}}function Gt(p,w,M,z,ne){for(M=w+M;w<M;){var ge=p[w++];z[ne++]=ge>>0&255,z[ne++]=ge>>8&255,z[ne++]=ge>>16&255}}function nn(p,w,M,z,ne,ge){if(ge==0)for(M=w+M;w<M;)de(z,((ge=p[w++])[0]>>24|ge[1]>>8&65280|ge[2]<<8&16711680|ge[3]<<24)>>>0),ne+=32;else i(z,ne,p,w,M)}function $n(p,w){Pe[w][0]=Pe[p+"0"],Pe[w][1]=Pe[p+"1"],Pe[w][2]=Pe[p+"2"],Pe[w][3]=Pe[p+"3"],Pe[w][4]=Pe[p+"4"],Pe[w][5]=Pe[p+"5"],Pe[w][6]=Pe[p+"6"],Pe[w][7]=Pe[p+"7"],Pe[w][8]=Pe[p+"8"],Pe[w][9]=Pe[p+"9"],Pe[w][10]=Pe[p+"10"],Pe[w][11]=Pe[p+"11"],Pe[w][12]=Pe[p+"12"],Pe[w][13]=Pe[p+"13"],Pe[w][14]=Pe[p+"0"],Pe[w][15]=Pe[p+"0"]}function an(p){return p==Pr||p==kr||p==zs||p==r}function Dn(){this.eb=[],this.size=this.A=this.fb=0}function Pn(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Ui(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new Dn,this.f.kb=new Pn,this.sd=null}function Oi(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function qn(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function $t(p){return alert("todo:WebPSamplerProcessPlane"),p.T}function Bn(p,w){var M=p.T,z=w.ba.f.RGBA,ne=z.eb,ge=z.fb+p.ka*z.A,ve=gr[w.ba.S],be=p.y,xe=p.O,Ae=p.f,Qe=p.N,mt=p.ea,vt=p.W,ut=w.cc,Mt=w.dc,Ct=w.Mc,it=w.Nc,ot=p.ka,Bt=p.ka+p.T,zt=p.U,Ot=zt+1>>1;for(ot==0?ve(be,xe,null,null,Ae,Qe,mt,vt,Ae,Qe,mt,vt,ne,ge,null,null,zt):(ve(w.ec,w.fc,be,xe,ut,Mt,Ct,it,Ae,Qe,mt,vt,ne,ge-z.A,ne,ge,zt),++M);ot+2<Bt;ot+=2)ut=Ae,Mt=Qe,Ct=mt,it=vt,Qe+=p.Rc,vt+=p.Rc,ge+=2*z.A,ve(be,(xe+=2*p.fa)-p.fa,be,xe,ut,Mt,Ct,it,Ae,Qe,mt,vt,ne,ge-z.A,ne,ge,zt);return xe+=p.fa,p.j+Bt<p.o?(i(w.ec,w.fc,be,xe,zt),i(w.cc,w.dc,Ae,Qe,Ot),i(w.Mc,w.Nc,mt,vt,Ot),M--):1&Bt||ve(be,xe,null,null,Ae,Qe,mt,vt,Ae,Qe,mt,vt,ne,ge+z.A,null,null,zt),M}function wi(p,w,M){var z=p.F,ne=[p.J];if(z!=null){var ge=p.U,ve=w.ba.S,be=ve==ns||ve==zs;w=w.ba.f.RGBA;var xe=[0],Ae=p.ka;xe[0]=p.T,p.Kb&&(Ae==0?--xe[0]:(--Ae,ne[0]-=p.width),p.j+p.ka+p.T==p.o&&(xe[0]=p.o-p.j-Ae));var Qe=w.eb;Ae=w.fb+Ae*w.A,p=ti(z,ne[0],p.width,ge,xe,Qe,Ae+(be?0:3),w.A),t(M==xe),p&&an(ve)&&tr(Qe,Ae,be,ge,xe,w.A)}return 0}function Yn(p){var w=p.ma,M=w.ba.S,z=11>M,ne=M==bn||M==Zo||M==ns||M==pr||M==12||an(M);if(w.memory=null,w.Ib=null,w.Jb=null,w.Nd=null,!Va(w.Oa,p,ne?11:12))return 0;if(ne&&an(M)&&Ut(),p.da)alert("todo:use_scaling");else{if(z){if(w.Ib=$t,p.Kb){if(M=p.U+1>>1,w.memory=a(p.U+2*M),w.memory==null)return 0;w.ec=w.memory,w.fc=0,w.cc=w.ec,w.dc=w.fc+p.U,w.Mc=w.cc,w.Nc=w.dc+M,w.Ib=Bn,Ut()}}else alert("todo:EmitYUV");ne&&(w.Jb=wi,z&&ct())}if(z&&!fl){for(p=0;256>p;++p)pu[p]=89858*(p-128)+Ul>>fu,gu[p]=-22014*(p-128)+Ul,yd[p]=-45773*(p-128),vd[p]=113618*(p-128)+Ul>>fu;for(p=$l;p<Zu;++p)w=76283*(p-16)+Ul>>fu,mu[p-$l]=oi(w,255),qc[p-$l]=oi(w+8>>4,15);fl=1}return 1}function xi(p){var w=p.ma,M=p.U,z=p.T;return t(!(1&p.ka)),0>=M||0>=z?0:(M=w.Ib(p,w),w.Jb!=null&&w.Jb(p,w,M),w.Dc+=M,1)}function pi(p){p.ma.memory=null}function sn(p,w,M,z){return ue(p,8)!=47?0:(w[0]=ue(p,14)+1,M[0]=ue(p,14)+1,z[0]=ue(p,1),ue(p,3)!=0?0:!p.h)}function mn(p,w){if(4>p)return p+1;var M=p-2>>1;return(2+(1&p)<<M)+ue(w,M)+1}function Yt(p,w){return 120<w?w-120:1<=(M=((M=Ge[w-1])>>4)*p+(8-(15&M)))?M:1;var M}function gi(p,w,M){var z=ie(M),ne=p[w+=255&z].g-8;return 0<ne&&(fe(M,M.u+8),z=ie(M),w+=p[w].value,w+=z&(1<<ne)-1),fe(M,M.u+p[w].g),p[w].value}function In(p,w,M){return M.g+=p.g,M.value+=p.value<<w>>>0,t(8>=M.g),p.g}function bt(p,w,M){var z=p.xc;return t((w=z==0?0:p.vc[p.md*(M>>z)+(w>>z)])<p.Wb),p.Ya[w]}function Xn(p,w,M,z){var ne=p.ab,ge=p.c*w,ve=p.C;w=ve+w;var be=M,xe=z;for(z=p.Ta,M=p.Ua;0<ne--;){var Ae=p.gc[ne],Qe=ve,mt=w,vt=be,ut=xe,Mt=(xe=z,be=M,Ae.Ea);switch(t(Qe<mt),t(mt<=Ae.nc),Ae.hc){case 2:ul(vt,ut,(mt-Qe)*Mt,xe,be);break;case 0:var Ct=Qe,it=mt,ot=xe,Bt=be,zt=(s=Ae).Ea;Ct==0&&(io(vt,ut,null,null,1,ot,Bt),qt(vt,ut+1,0,0,zt-1,ot,Bt+1),ut+=zt,Bt+=zt,++Ct);for(var Ot=1<<s.b,tn=Ot-1,Wt=qe(zt,s.b),gn=s.K,s=s.w+(Ct>>s.b)*Wt;Ct<it;){var l=gn,h=s,g=1;for(qr(vt,ut,ot,Bt-zt,1,ot,Bt);g<zt;){var _=(g&~tn)+Ot;_>zt&&(_=zt),(0,ro[l[h++]>>8&15])(vt,ut+ +g,ot,Bt+g-zt,_-g,ot,Bt+g),g=_}ut+=zt,Bt+=zt,++Ct&tn||(s+=Wt)}mt!=Ae.nc&&i(xe,be-Mt,xe,be+(mt-Qe-1)*Mt,Mt);break;case 1:for(Mt=vt,it=ut,zt=(vt=Ae.Ea)-(Bt=vt&~(ot=(ut=1<<Ae.b)-1)),Ct=qe(vt,Ae.b),Ot=Ae.K,Ae=Ae.w+(Qe>>Ae.b)*Ct;Qe<mt;){for(tn=Ot,Wt=Ae,gn=new Ze,s=it+Bt,l=it+vt;it<s;)Oe(tn[Wt++],gn),Os(gn,Mt,it,ut,xe,be),it+=ut,be+=ut;it<l&&(Oe(tn[Wt++],gn),Os(gn,Mt,it,zt,xe,be),it+=zt,be+=zt),++Qe&ot||(Ae+=Ct)}break;case 3:if(vt==xe&&ut==be&&0<Ae.b){for(it=xe,vt=Mt=be+(mt-Qe)*Mt-(Bt=(mt-Qe)*qe(Ae.Ea,Ae.b)),ut=xe,ot=be,Ct=[],Bt=(zt=Bt)-1;0<=Bt;--Bt)Ct[Bt]=ut[ot+Bt];for(Bt=zt-1;0<=Bt;--Bt)it[vt+Bt]=Ct[Bt];Gi(Ae,Qe,mt,xe,Mt,xe,be)}else Gi(Ae,Qe,mt,vt,ut,xe,be)}be=z,xe=M}xe!=M&&i(z,M,be,xe,ge)}function Ii(p,w){var M=p.V,z=p.Ba+p.c*p.C,ne=w-p.C;if(t(w<=p.l.o),t(16>=ne),0<ne){var ge=p.l,ve=p.Ta,be=p.Ua,xe=ge.width;if(Xn(p,ne,M,z),ne=be=[be],t((M=p.C)<(z=w)),t(ge.v<ge.va),z>ge.o&&(z=ge.o),M<ge.j){var Ae=ge.j-M;M=ge.j,ne[0]+=Ae*xe}if(M>=z?M=0:(ne[0]+=4*ge.v,ge.ka=M-ge.j,ge.U=ge.va-ge.v,ge.T=z-M,M=1),M){if(be=be[0],11>(M=p.ca).S){var Qe=M.f.RGBA,mt=(z=M.S,ne=ge.U,ge=ge.T,Ae=Qe.eb,Qe.A),vt=ge;for(Qe=Qe.fb+p.Ma*Qe.A;0<vt--;){var ut=ve,Mt=be,Ct=ne,it=Ae,ot=Qe;switch(z){case Nr:er(ut,Mt,Ct,it,ot);break;case bn:Ji(ut,Mt,Ct,it,ot);break;case Pr:Ji(ut,Mt,Ct,it,ot),tr(it,ot,0,Ct,1,0);break;case hl:Qr(ut,Mt,Ct,it,ot);break;case Zo:nn(ut,Mt,Ct,it,ot,1);break;case kr:nn(ut,Mt,Ct,it,ot,1),tr(it,ot,0,Ct,1,0);break;case ns:nn(ut,Mt,Ct,it,ot,0);break;case zs:nn(ut,Mt,Ct,it,ot,0),tr(it,ot,1,Ct,1,0);break;case pr:vs(ut,Mt,Ct,it,ot);break;case r:vs(ut,Mt,Ct,it,ot),ri(it,ot,Ct,1,0);break;case Fl:Mr(ut,Mt,Ct,it,ot);break;default:t(0)}be+=xe,Qe+=mt}p.Ma+=ge}else alert("todo:EmitRescaledRowsYUVA");t(p.Ma<=M.height)}}p.C=w,t(p.C<=p.i)}function ui(p){var w;if(0<p.ua)return 0;for(w=0;w<p.Wb;++w){var M=p.Ya[w].G,z=p.Ya[w].H;if(0<M[1][z[1]+0].g||0<M[2][z[2]+0].g||0<M[3][z[3]+0].g)return 0}return 1}function yr(p,w,M,z,ne,ge){if(p.Z!=0){var ve=p.qd,be=p.rd;for(t(si[p.Z]!=null);w<M;++w)si[p.Z](ve,be,z,ne,z,ne,ge),ve=z,be=ne,ne+=ge;p.qd=ve,p.rd=be}}function lr(p,w){var M=p.l.ma,z=M.Z==0||M.Z==1?p.l.j:p.C;if(z=p.C<z?z:p.C,t(w<=p.l.o),w>z){var ne=p.l.width,ge=M.ca,ve=M.tb+ne*z,be=p.V,xe=p.Ba+p.c*z,Ae=p.gc;t(p.ab==1),t(Ae[0].hc==3),Xr(Ae[0],z,w,be,xe,ge,ve),yr(M,z,w,ge,ve,ne)}p.C=p.Ma=w}function _r(p,w,M,z,ne,ge,ve){var be=p.$/z,xe=p.$%z,Ae=p.m,Qe=p.s,mt=M+p.$,vt=mt;ne=M+z*ne;var ut=M+z*ge,Mt=280+Qe.ua,Ct=p.Pb?be:16777216,it=0<Qe.ua?Qe.Wa:null,ot=Qe.wc,Bt=mt<ut?bt(Qe,xe,be):null;t(p.C<ge),t(ut<=ne);var zt=!1;e:for(;;){for(;zt||mt<ut;){var Ot=0;if(be>=Ct){var tn=mt-M;t((Ct=p).Pb),Ct.wd=Ct.m,Ct.xd=tn,0<Ct.s.ua&&D(Ct.s.Wa,Ct.s.vb),Ct=be+xt}if(xe&ot||(Bt=bt(Qe,xe,be)),t(Bt!=null),Bt.Qb&&(w[mt]=Bt.qb,zt=!0),!zt)if(_e(Ae),Bt.jc){Ot=Ae,tn=w;var Wt=mt,gn=Bt.pd[ie(Ot)&ji-1];t(Bt.jc),256>gn.g?(fe(Ot,Ot.u+gn.g),tn[Wt]=gn.value,Ot=0):(fe(Ot,Ot.u+gn.g-256),t(256<=gn.value),Ot=gn.value),Ot==0&&(zt=!0)}else Ot=gi(Bt.G[0],Bt.H[0],Ae);if(Ae.h)break;if(zt||256>Ot){if(!zt)if(Bt.nd)w[mt]=(Bt.qb|Ot<<8)>>>0;else{if(_e(Ae),zt=gi(Bt.G[1],Bt.H[1],Ae),_e(Ae),tn=gi(Bt.G[2],Bt.H[2],Ae),Wt=gi(Bt.G[3],Bt.H[3],Ae),Ae.h)break;w[mt]=(Wt<<24|zt<<16|Ot<<8|tn)>>>0}if(zt=!1,++mt,++xe>=z&&(xe=0,++be,ve!=null&&be<=ge&&!(be%16)&&ve(p,be),it!=null))for(;vt<mt;)Ot=w[vt++],it.X[(506832829*Ot&4294967295)>>>it.Mb]=Ot}else if(280>Ot){if(Ot=mn(Ot-256,Ae),tn=gi(Bt.G[4],Bt.H[4],Ae),_e(Ae),tn=Yt(z,tn=mn(tn,Ae)),Ae.h)break;if(mt-M<tn||ne-mt<Ot)break e;for(Wt=0;Wt<Ot;++Wt)w[mt+Wt]=w[mt+Wt-tn];for(mt+=Ot,xe+=Ot;xe>=z;)xe-=z,++be,ve!=null&&be<=ge&&!(be%16)&&ve(p,be);if(t(mt<=ne),xe&ot&&(Bt=bt(Qe,xe,be)),it!=null)for(;vt<mt;)Ot=w[vt++],it.X[(506832829*Ot&4294967295)>>>it.Mb]=Ot}else{if(!(Ot<Mt))break e;for(zt=Ot-280,t(it!=null);vt<mt;)Ot=w[vt++],it.X[(506832829*Ot&4294967295)>>>it.Mb]=Ot;Ot=mt,t(!(zt>>>(tn=it).Xa)),w[Ot]=tn.X[zt],zt=!0}zt||t(Ae.h==le(Ae))}if(p.Pb&&Ae.h&&mt<ne)t(p.m.h),p.a=5,p.m=p.wd,p.$=p.xd,0<p.s.ua&&D(p.s.vb,p.s.Wa);else{if(Ae.h)break e;ve!=null&&ve(p,be>ge?ge:be),p.a=0,p.$=mt-M}return 1}return p.a=3,0}function Yi(p){t(p!=null),p.vc=null,p.yc=null,p.Ya=null;var w=p.Wa;w!=null&&(w.X=null),p.vb=null,t(p!=null)}function ur(){var p=new $a;return p==null?null:(p.a=0,p.xb=zl,$n("Predictor","VP8LPredictors"),$n("Predictor","VP8LPredictors_C"),$n("PredictorAdd","VP8LPredictorsAdd"),$n("PredictorAdd","VP8LPredictorsAdd_C"),ul=lt,Os=kt,er=St,Ji=nt,vs=st,Mr=pn,Qr=Gt,Pe.VP8LMapColor32b=Rs,Pe.VP8LMapColor8b=Ho,p)}function jr(p,w,M,z,ne){var ge=1,ve=[p],be=[w],xe=z.m,Ae=z.s,Qe=null,mt=0;e:for(;;){if(M)for(;ge&&ue(xe,1);){var vt=ve,ut=be,Mt=z,Ct=1,it=Mt.m,ot=Mt.gc[Mt.ab],Bt=ue(it,2);if(Mt.Oc&1<<Bt)ge=0;else{switch(Mt.Oc|=1<<Bt,ot.hc=Bt,ot.Ea=vt[0],ot.nc=ut[0],ot.K=[null],++Mt.ab,t(4>=Mt.ab),Bt){case 0:case 1:ot.b=ue(it,3)+2,Ct=jr(qe(ot.Ea,ot.b),qe(ot.nc,ot.b),0,Mt,ot.K),ot.K=ot.K[0];break;case 3:var zt,Ot=ue(it,8)+1,tn=16<Ot?0:4<Ot?1:2<Ot?2:3;if(vt[0]=qe(ot.Ea,tn),ot.b=tn,zt=Ct=jr(Ot,1,0,Mt,ot.K)){var Wt,gn=Ot,s=ot,l=1<<(8>>s.b),h=a(l);if(h==null)zt=0;else{var g=s.K[0],_=s.w;for(h[0]=s.K[0][0],Wt=1;Wt<1*gn;++Wt)h[Wt]=De(g[_+Wt],h[Wt-1]);for(;Wt<4*l;++Wt)h[Wt]=0;s.K[0]=null,s.K[0]=h,zt=1}}Ct=zt;break;case 2:break;default:t(0)}ge=Ct}}if(ve=ve[0],be=be[0],ge&&ue(xe,1)&&!(ge=1<=(mt=ue(xe,4))&&11>=mt)){z.a=3;break e}var E;if(E=ge)t:{var B,R,W,he=z,Ie=ve,Me=be,rt=mt,pt=M,Dt=he.m,Vt=he.s,Ht=[null],wn=1,Re=0,Ve=ft[rt];n:for(;;){if(pt&&ue(Dt,1)){var et=ue(Dt,3)+2,_t=qe(Ie,et),at=qe(Me,et),gt=_t*at;if(!jr(_t,at,0,he,Ht))break n;for(Ht=Ht[0],Vt.xc=et,B=0;B<gt;++B){var X=Ht[B]>>8&65535;Ht[B]=X,X>=wn&&(wn=X+1)}}if(Dt.h)break n;for(R=0;5>R;++R){var pe=S[R];!R&&0<rt&&(pe+=1<<rt),Re<pe&&(Re=pe)}var Ce=u(wn*Ve,re),Le=wn,ke=u(Le,Y);if(ke==null)var Se=null;else t(65536>=Le),Se=ke;var Ye=a(Re);if(Se==null||Ye==null||Ce==null){he.a=1;break n}var We=Ce;for(B=W=0;B<wn;++B){var tt=Se[B],dt=tt.G,ht=tt.H,It=0,Xt=1,rn=0;for(R=0;5>R;++R){pe=S[R],dt[R]=We,ht[R]=W,!R&&0<rt&&(pe+=1<<rt);r:{var ln,Jn=pe,ni=he,Gn=Ye,hi=We,Rr=W,pl=0,So=ni.m,Ku=ue(So,1);if(o(Gn,0,0,Jn),Ku){var Ao=ue(So,1)+1,ql=ue(So,1),bs=ue(So,ql==0?1:8);Gn[bs]=1,Ao==2&&(Gn[bs=ue(So,8)]=1);var mr=1}else{var Di=a(19),gp=ue(So,4)+4;if(19<gp){ni.a=3;var Zc=0;break r}for(ln=0;ln<gp;++ln)Di[me[ln]]=ue(So,3);var _d=void 0,Yu=void 0,mp=ni,pv=Di,Kc=Jn,vp=Gn,bd=0,gl=mp.m,yp=8,_p=u(128,re);i:for(;ae(_p,0,7,pv,19);){if(ue(gl,1)){var gv=2+2*ue(gl,3);if((_d=2+ue(gl,gv))>Kc)break i}else _d=Kc;for(Yu=0;Yu<Kc&&_d--;){_e(gl);var bp=_p[0+(127&ie(gl))];fe(gl,gl.u+bp.g);var yu=bp.value;if(16>yu)vp[Yu++]=yu,yu!=0&&(yp=yu);else{var mv=yu==16,wp=yu-16,vv=v[wp],xp=ue(gl,c[wp])+vv;if(Yu+xp>Kc)break i;for(var yv=mv?yp:0;0<xp--;)vp[Yu++]=yv}}bd=1;break i}bd||(mp.a=3),mr=bd}(mr=mr&&!So.h)&&(pl=ae(hi,Rr,8,Gn,Jn)),mr&&pl!=0?Zc=pl:(ni.a=3,Zc=0)}if(Zc==0)break n;if(Xt&&U[R]==1&&(Xt=We[W].g==0),It+=We[W].g,W+=Zc,3>=R){var Ju,wd=Ye[0];for(Ju=1;Ju<pe;++Ju)Ye[Ju]>wd&&(wd=Ye[Ju]);rn+=wd}}if(tt.nd=Xt,tt.Qb=0,Xt&&(tt.qb=(dt[3][ht[3]+0].value<<24|dt[1][ht[1]+0].value<<16|dt[2][ht[2]+0].value)>>>0,It==0&&256>dt[0][ht[0]+0].value&&(tt.Qb=1,tt.qb+=dt[0][ht[0]+0].value<<8)),tt.jc=!tt.Qb&&6>rn,tt.jc){var Yc,Wa=tt;for(Yc=0;Yc<ji;++Yc){var ml=Yc,vl=Wa.pd[ml],Jc=Wa.G[0][Wa.H[0]+ml];256<=Jc.value?(vl.g=Jc.g+256,vl.value=Jc.value):(vl.g=0,vl.value=0,ml>>=In(Jc,8,vl),ml>>=In(Wa.G[1][Wa.H[1]+ml],16,vl),ml>>=In(Wa.G[2][Wa.H[2]+ml],0,vl),In(Wa.G[3][Wa.H[3]+ml],24,vl))}}}Vt.vc=Ht,Vt.Wb=wn,Vt.Ya=Se,Vt.yc=Ce,E=1;break t}E=0}if(!(ge=E)){z.a=3;break e}if(0<mt){if(Ae.ua=1<<mt,!F(Ae.Wa,mt)){z.a=1,ge=0;break e}}else Ae.ua=0;var xd=z,Lp=ve,_v=be,Ld=xd.s,Cd=Ld.xc;if(xd.c=Lp,xd.i=_v,Ld.md=qe(Lp,Cd),Ld.wc=Cd==0?-1:(1<<Cd)-1,M){z.xb=Hu;break e}if((Qe=a(ve*be))==null){z.a=1,ge=0;break e}ge=(ge=_r(z,Qe,0,ve,be,be,null))&&!xe.h;break e}return ge?(ne!=null?ne[0]=Qe:(t(Qe==null),t(M)),z.$=0,M||Yi(Ae)):Yi(Ae),ge}function Ss(p,w){var M=p.c*p.i,z=M+w+16*w;return t(p.c<=w),p.V=a(z),p.V==null?(p.Ta=null,p.Ua=0,p.a=1,0):(p.Ta=p.V,p.Ua=p.Ba+M+w,1)}function Zs(p,w){var M=p.C,z=w-M,ne=p.V,ge=p.Ba+p.c*M;for(t(w<=p.l.o);0<z;){var ve=16<z?16:z,be=p.l.ma,xe=p.l.width,Ae=xe*ve,Qe=be.ca,mt=be.tb+xe*M,vt=p.Ta,ut=p.Ua;Xn(p,ve,ne,ge),Ni(vt,ut,Qe,mt,Ae),yr(be,M,M+ve,Qe,mt,xe),z-=ve,ne+=ve*p.c,M+=ve}t(M==w),p.C=p.Ma=w}function Ks(){this.ub=this.yd=this.td=this.Rb=0}function Gr(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function ds(){this.Fb=this.Bb=this.Cb=0,this.Zb=a(4),this.Lb=a(4)}function As(){this.Yb=function(){var p=[];return function w(M,z,ne){for(var ge=ne[z],ve=0;ve<ge&&(M.push(ne.length>z+1?[]:0),!(ne.length<z+1));ve++)w(M[ve],z+1,ne)}(p,0,[3,11]),p}()}function ua(){this.jb=a(3),this.Wc=d([4,8],As),this.Xc=d([4,17],As)}function ca(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new a(4),this.od=new a(4)}function Ys(){this.ld=this.La=this.dd=this.tc=0}function Io(){this.Na=this.la=0}function ha(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Ms(){this.ad=a(384),this.Za=0,this.Ob=a(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Bs(){this.uc=this.M=this.Nb=0,this.wa=Array(new Ys),this.Y=0,this.ya=Array(new Ms),this.aa=0,this.l=new cr}function go(){this.y=a(16),this.f=a(8),this.ea=a(8)}function Fo(){this.cb=this.a=0,this.sc="",this.m=new ye,this.Od=new Ks,this.Kc=new Gr,this.ed=new ca,this.Qa=new ds,this.Ic=this.$c=this.Aa=0,this.D=new Bs,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=u(8,ye),this.ia=0,this.pb=u(4,ha),this.Pa=new ua,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new go),this.Hd=0,this.rb=Array(new Io),this.sb=0,this.wa=Array(new Ys),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Ms),this.L=this.aa=0,this.gd=d([4,2],Ys),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function cr(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Fn(){var p=new Fo;return p!=null&&(p.a=0,p.sc="OK",p.cb=0,p.Xb=0,hn||(hn=zr)),p}function _n(p,w,M){return p.a==0&&(p.a=w,p.sc=M,p.cb=0),0}function fs(p,w,M){return 3<=M&&p[w+0]==157&&p[w+1]==1&&p[w+2]==42}function Hr(p,w){if(p==null)return 0;if(p.a=0,p.sc="OK",w==null)return _n(p,2,"null VP8Io passed to VP8GetHeaders()");var M=w.data,z=w.w,ne=w.ha;if(4>ne)return _n(p,7,"Truncated header.");var ge=M[z+0]|M[z+1]<<8|M[z+2]<<16,ve=p.Od;if(ve.Rb=!(1&ge),ve.td=ge>>1&7,ve.yd=ge>>4&1,ve.ub=ge>>5,3<ve.td)return _n(p,3,"Incorrect keyframe parameters.");if(!ve.yd)return _n(p,4,"Frame not displayable.");z+=3,ne-=3;var be=p.Kc;if(ve.Rb){if(7>ne)return _n(p,7,"cannot parse picture header");if(!fs(M,z,ne))return _n(p,3,"Bad code word");be.c=16383&(M[z+4]<<8|M[z+3]),be.Td=M[z+4]>>6,be.i=16383&(M[z+6]<<8|M[z+5]),be.Ud=M[z+6]>>6,z+=7,ne-=7,p.za=be.c+15>>4,p.Ub=be.i+15>>4,w.width=be.c,w.height=be.i,w.Da=0,w.j=0,w.v=0,w.va=w.width,w.o=w.height,w.da=0,w.ib=w.width,w.hb=w.height,w.U=w.width,w.T=w.height,o((ge=p.Pa).jb,0,255,ge.jb.length),t((ge=p.Qa)!=null),ge.Cb=0,ge.Bb=0,ge.Fb=1,o(ge.Zb,0,0,ge.Zb.length),o(ge.Lb,0,0,ge.Lb)}if(ve.ub>ne)return _n(p,7,"bad partition length");C(ge=p.m,M,z,ve.ub),z+=ve.ub,ne-=ve.ub,ve.Rb&&(be.Ld=G(ge),be.Kd=G(ge)),be=p.Qa;var xe,Ae=p.Pa;if(t(ge!=null),t(be!=null),be.Cb=G(ge),be.Cb){if(be.Bb=G(ge),G(ge)){for(be.Fb=G(ge),xe=0;4>xe;++xe)be.Zb[xe]=G(ge)?K(ge,7):0;for(xe=0;4>xe;++xe)be.Lb[xe]=G(ge)?K(ge,6):0}if(be.Bb)for(xe=0;3>xe;++xe)Ae.jb[xe]=G(ge)?N(ge,8):255}else be.Bb=0;if(ge.Ka)return _n(p,3,"cannot parse segment header");if((be=p.ed).zd=G(ge),be.Tb=N(ge,6),be.wb=N(ge,3),be.Pc=G(ge),be.Pc&&G(ge)){for(Ae=0;4>Ae;++Ae)G(ge)&&(be.vd[Ae]=K(ge,6));for(Ae=0;4>Ae;++Ae)G(ge)&&(be.od[Ae]=K(ge,6))}if(p.L=be.Tb==0?0:be.zd?1:2,ge.Ka)return _n(p,3,"cannot parse filter header");var Qe=ne;if(ne=xe=z,z=xe+Qe,be=Qe,p.Xb=(1<<N(p.m,2))-1,Qe<3*(Ae=p.Xb))M=7;else{for(xe+=3*Ae,be-=3*Ae,Qe=0;Qe<Ae;++Qe){var mt=M[ne+0]|M[ne+1]<<8|M[ne+2]<<16;mt>be&&(mt=be),C(p.Jc[+Qe],M,xe,mt),xe+=mt,be-=mt,ne+=3}C(p.Jc[+Ae],M,xe,be),M=xe<z?0:5}if(M!=0)return _n(p,M,"cannot parse partitions");for(M=N(xe=p.m,7),ne=G(xe)?K(xe,4):0,z=G(xe)?K(xe,4):0,be=G(xe)?K(xe,4):0,Ae=G(xe)?K(xe,4):0,xe=G(xe)?K(xe,4):0,Qe=p.Qa,mt=0;4>mt;++mt){if(Qe.Cb){var vt=Qe.Zb[mt];Qe.Fb||(vt+=M)}else{if(0<mt){p.pb[mt]=p.pb[0];continue}vt=M}var ut=p.pb[mt];ut.Sc[0]=Ft[oi(vt+ne,127)],ut.Sc[1]=Jt[oi(vt+0,127)],ut.Eb[0]=2*Ft[oi(vt+z,127)],ut.Eb[1]=101581*Jt[oi(vt+be,127)]>>16,8>ut.Eb[1]&&(ut.Eb[1]=8),ut.Qc[0]=Ft[oi(vt+Ae,117)],ut.Qc[1]=Jt[oi(vt+xe,127)],ut.lc=vt+xe}if(!ve.Rb)return _n(p,4,"Not a key frame.");for(G(ge),ve=p.Pa,M=0;4>M;++M){for(ne=0;8>ne;++ne)for(z=0;3>z;++z)for(be=0;11>be;++be)Ae=q(ge,Us[M][ne][z][be])?N(ge,8):Dr[M][ne][z][be],ve.Wc[M][ne].Yb[z][be]=Ae;for(ne=0;17>ne;++ne)ve.Xc[M][ne]=ve.Wc[M][jl[ne]]}return p.kc=G(ge),p.kc&&(p.Bd=N(ge,8)),p.cb=1}function zr(p,w,M,z,ne,ge,ve){var be=w[ne].Yb[M];for(M=0;16>ne;++ne){if(!q(p,be[M+0]))return ne;for(;!q(p,be[M+1]);)if(be=w[++ne].Yb[0],M=0,ne==16)return 16;var xe=w[ne+1].Yb;if(q(p,be[M+2])){var Ae=p,Qe=0;if(q(Ae,(vt=be)[(mt=M)+3]))if(q(Ae,vt[mt+6])){for(be=0,mt=2*(Qe=q(Ae,vt[mt+8]))+(vt=q(Ae,vt[mt+9+Qe])),Qe=0,vt=Rn[mt];vt[be];++be)Qe+=Qe+q(Ae,vt[be]);Qe+=3+(8<<mt)}else q(Ae,vt[mt+7])?(Qe=7+2*q(Ae,165),Qe+=q(Ae,145)):Qe=5+q(Ae,159);else Qe=q(Ae,vt[mt+4])?3+q(Ae,vt[mt+5]):2;be=xe[2]}else Qe=1,be=xe[1];xe=ve+Er[ne],0>(Ae=p).b&&ee(Ae);var mt,vt=Ae.b,ut=(mt=Ae.Ca>>1)-(Ae.I>>vt)>>31;--Ae.b,Ae.Ca+=ut,Ae.Ca|=1,Ae.I-=(mt+1&ut)<<vt,ge[xe]=((Qe^ut)-ut)*z[(0<ne)+0]}return 16}function Ts(p){var w=p.rb[p.sb-1];w.la=0,w.Na=0,o(p.zc,0,0,p.zc.length),p.ja=0}function xn(p,w){if(p==null)return 0;if(w==null)return _n(p,2,"NULL VP8Io parameter in VP8Decode().");if(!p.cb&&!Hr(p,w))return 0;if(t(p.cb),w.ac==null||w.ac(w)){w.ob&&(p.L=0);var M=vu[p.L];if(p.L==2?(p.yb=0,p.zb=0):(p.yb=w.v-M>>4,p.zb=w.j-M>>4,0>p.yb&&(p.yb=0),0>p.zb&&(p.zb=0)),p.Va=w.o+15+M>>4,p.Hb=w.va+15+M>>4,p.Hb>p.za&&(p.Hb=p.za),p.Va>p.Ub&&(p.Va=p.Ub),0<p.L){var z=p.ed;for(M=0;4>M;++M){var ne;if(p.Qa.Cb){var ge=p.Qa.Lb[M];p.Qa.Fb||(ge+=z.Tb)}else ge=z.Tb;for(ne=0;1>=ne;++ne){var ve=p.gd[M][ne],be=ge;if(z.Pc&&(be+=z.vd[0],ne&&(be+=z.od[0])),0<(be=0>be?0:63<be?63:be)){var xe=be;0<z.wb&&(xe=4<z.wb?xe>>2:xe>>1)>9-z.wb&&(xe=9-z.wb),1>xe&&(xe=1),ve.dd=xe,ve.tc=2*be+xe,ve.ld=40<=be?2:15<=be?1:0}else ve.tc=0;ve.La=ne}}}M=0}else _n(p,6,"Frame setup failed"),M=p.a;if(M=M==0){if(M){p.$c=0,0<p.Aa||(p.Ic=Hc);e:{M=p.Ic,z=4*(xe=p.za);var Ae=32*xe,Qe=xe+1,mt=0<p.L?xe*(0<p.Aa?2:1):0,vt=(p.Aa==2?2:1)*xe;if((ve=z+832+(ne=3*(16*M+vu[p.L])/2*Ae)+(ge=p.Fa!=null&&0<p.Fa.length?p.Kc.c*p.Kc.i:0))!=ve)M=0;else{if(ve>p.Vb){if(p.Vb=0,p.Ec=a(ve),p.Fc=0,p.Ec==null){M=_n(p,1,"no memory during frame initialization.");break e}p.Vb=ve}ve=p.Ec,be=p.Fc,p.Ac=ve,p.Bc=be,be+=z,p.Gd=u(Ae,go),p.Hd=0,p.rb=u(Qe+1,Io),p.sb=1,p.wa=mt?u(mt,Ys):null,p.Y=0,p.D.Nb=0,p.D.wa=p.wa,p.D.Y=p.Y,0<p.Aa&&(p.D.Y+=xe),t(!0),p.oc=ve,p.pc=be,be+=832,p.ya=u(vt,Ms),p.aa=0,p.D.ya=p.ya,p.D.aa=p.aa,p.Aa==2&&(p.D.aa+=xe),p.R=16*xe,p.B=8*xe,xe=(Ae=vu[p.L])*p.R,Ae=Ae/2*p.B,p.sa=ve,p.ta=be+xe,p.qa=p.sa,p.ra=p.ta+16*M*p.R+Ae,p.Ha=p.qa,p.Ia=p.ra+8*M*p.B+Ae,p.$c=0,be+=ne,p.mb=ge?ve:null,p.nb=ge?be:null,t(be+ge<=p.Fc+p.Vb),Ts(p),o(p.Ac,p.Bc,0,z),M=1}}if(M){if(w.ka=0,w.y=p.sa,w.O=p.ta,w.f=p.qa,w.N=p.ra,w.ea=p.Ha,w.Vd=p.Ia,w.fa=p.R,w.Rc=p.B,w.F=null,w.J=0,!cl){for(M=-255;255>=M;++M)ai[255+M]=0>M?-M:M;for(M=-1020;1020>=M;++M)ys[1020+M]=-128>M?-128:127<M?127:M;for(M=-112;112>=M;++M)ko[112+M]=-16>M?-16:15<M?15:M;for(M=-255;510>=M;++M)js[255+M]=0>M?0:255<M?255:M;cl=1}so=jo,es=ps,Is=Wr,Cr=_i,dr=Ns,Si=ci,Wo=za,Ga=Ds,Ha=Yr,fr=ya,Br=ma,Lo=va,Fs=qi,La=al,Co=ja,Po=dn,oo=br,ts=qo,is[0]=Vn,is[1]=Da,is[2]=An,is[3]=Zr,is[4]=Oa,is[5]=yo,is[6]=pa,is[7]=Kr,is[8]=Ia,is[9]=Qs,_s[0]=da,_s[1]=Ra,_s[2]=gs,_s[3]=Xs,_s[4]=$i,_s[5]=sl,_s[6]=fa,Vr[0]=eo,Vr[1]=mo,Vr[2]=zo,Vr[3]=Bi,Vr[4]=Uo,Vr[5]=ol,Vr[6]=ga,M=1}else M=0}M&&(M=function(ut,Mt){for(ut.M=0;ut.M<ut.Va;++ut.M){var Ct,it=ut.Jc[ut.M&ut.Xb],ot=ut.m,Bt=ut;for(Ct=0;Ct<Bt.za;++Ct){var zt=ot,Ot=Bt,tn=Ot.Ac,Wt=Ot.Bc+4*Ct,gn=Ot.zc,s=Ot.ya[Ot.aa+Ct];if(Ot.Qa.Bb?s.$b=q(zt,Ot.Pa.jb[0])?2+q(zt,Ot.Pa.jb[2]):q(zt,Ot.Pa.jb[1]):s.$b=0,Ot.kc&&(s.Ad=q(zt,Ot.Bd)),s.Za=!q(zt,145)+0,s.Za){var l=s.Ob,h=0;for(Ot=0;4>Ot;++Ot){var g,_=gn[0+Ot];for(g=0;4>g;++g){_=Ai[tn[Wt+g]][_];for(var E=Wi[q(zt,_[0])];0<E;)E=Wi[2*E+q(zt,_[E])];_=-E,tn[Wt+g]=_}i(l,h,tn,Wt,4),h+=4,gn[0+Ot]=_}}else _=q(zt,156)?q(zt,128)?1:3:q(zt,163)?2:0,s.Ob[0]=_,o(tn,Wt,_,4),o(gn,0,_,4);s.Dd=q(zt,142)?q(zt,114)?q(zt,183)?1:3:2:0}if(Bt.m.Ka)return _n(ut,7,"Premature end-of-partition0 encountered.");for(;ut.ja<ut.za;++ut.ja){if(Bt=it,zt=(ot=ut).rb[ot.sb-1],tn=ot.rb[ot.sb+ot.ja],Ct=ot.ya[ot.aa+ot.ja],Wt=ot.kc?Ct.Ad:0)zt.la=tn.la=0,Ct.Za||(zt.Na=tn.Na=0),Ct.Hc=0,Ct.Gc=0,Ct.ia=0;else{var B,R;if(zt=tn,tn=Bt,Wt=ot.Pa.Xc,gn=ot.ya[ot.aa+ot.ja],s=ot.pb[gn.$b],Ot=gn.ad,l=0,h=ot.rb[ot.sb-1],_=g=0,o(Ot,l,0,384),gn.Za)var W=0,he=Wt[3];else{E=a(16);var Ie=zt.Na+h.Na;if(Ie=hn(tn,Wt[1],Ie,s.Eb,0,E,0),zt.Na=h.Na=(0<Ie)+0,1<Ie)so(E,0,Ot,l);else{var Me=E[0]+3>>3;for(E=0;256>E;E+=16)Ot[l+E]=Me}W=1,he=Wt[0]}var rt=15&zt.la,pt=15&h.la;for(E=0;4>E;++E){var Dt=1&pt;for(Me=R=0;4>Me;++Me)rt=rt>>1|(Dt=(Ie=hn(tn,he,Ie=Dt+(1&rt),s.Sc,W,Ot,l))>W)<<7,R=R<<2|(3<Ie?3:1<Ie?2:Ot[l+0]!=0),l+=16;rt>>=4,pt=pt>>1|Dt<<7,g=(g<<8|R)>>>0}for(he=rt,W=pt>>4,B=0;4>B;B+=2){for(R=0,rt=zt.la>>4+B,pt=h.la>>4+B,E=0;2>E;++E){for(Dt=1&pt,Me=0;2>Me;++Me)Ie=Dt+(1&rt),rt=rt>>1|(Dt=0<(Ie=hn(tn,Wt[2],Ie,s.Qc,0,Ot,l)))<<3,R=R<<2|(3<Ie?3:1<Ie?2:Ot[l+0]!=0),l+=16;rt>>=2,pt=pt>>1|Dt<<5}_|=R<<4*B,he|=rt<<4<<B,W|=(240&pt)<<B}zt.la=he,h.la=W,gn.Hc=g,gn.Gc=_,gn.ia=43690&_?0:s.ia,Wt=!(g|_)}if(0<ot.L&&(ot.wa[ot.Y+ot.ja]=ot.gd[Ct.$b][Ct.Za],ot.wa[ot.Y+ot.ja].La|=!Wt),Bt.Ka)return _n(ut,7,"Premature end-of-file encountered.")}if(Ts(ut),ot=Mt,Bt=1,Ct=(it=ut).D,zt=0<it.L&&it.M>=it.zb&&it.M<=it.Va,it.Aa==0)e:{if(Ct.M=it.M,Ct.uc=zt,qa(it,Ct),Bt=1,Ct=(R=it.D).Nb,zt=(_=vu[it.L])*it.R,tn=_/2*it.B,E=16*Ct*it.R,Me=8*Ct*it.B,Wt=it.sa,gn=it.ta-zt+E,s=it.qa,Ot=it.ra-tn+Me,l=it.Ha,h=it.Ia-tn+Me,pt=(rt=R.M)==0,g=rt>=it.Va-1,it.Aa==2&&qa(it,R),R.uc)for(Dt=(Ie=it).D.M,t(Ie.D.uc),R=Ie.yb;R<Ie.Hb;++R){W=R,he=Dt;var Vt=(Ht=(pe=Ie).D).Nb;B=pe.R;var Ht=Ht.wa[Ht.Y+W],wn=pe.sa,Re=pe.ta+16*Vt*B+16*W,Ve=Ht.dd,et=Ht.tc;if(et!=0)if(t(3<=et),pe.L==1)0<W&&Po(wn,Re,B,et+4),Ht.La&&ts(wn,Re,B,et),0<he&&Co(wn,Re,B,et+4),Ht.La&&oo(wn,Re,B,et);else{var _t=pe.B,at=pe.qa,gt=pe.ra+8*Vt*_t+8*W,X=pe.Ha,pe=pe.Ia+8*Vt*_t+8*W;Vt=Ht.ld,0<W&&(Ga(wn,Re,B,et+4,Ve,Vt),fr(at,gt,X,pe,_t,et+4,Ve,Vt)),Ht.La&&(Lo(wn,Re,B,et,Ve,Vt),La(at,gt,X,pe,_t,et,Ve,Vt)),0<he&&(Wo(wn,Re,B,et+4,Ve,Vt),Ha(at,gt,X,pe,_t,et+4,Ve,Vt)),Ht.La&&(Br(wn,Re,B,et,Ve,Vt),Fs(at,gt,X,pe,_t,et,Ve,Vt))}}if(it.ia&&alert("todo:DitherRow"),ot.put!=null){if(R=16*rt,rt=16*(rt+1),pt?(ot.y=it.sa,ot.O=it.ta+E,ot.f=it.qa,ot.N=it.ra+Me,ot.ea=it.Ha,ot.W=it.Ia+Me):(R-=_,ot.y=Wt,ot.O=gn,ot.f=s,ot.N=Ot,ot.ea=l,ot.W=h),g||(rt-=_),rt>ot.o&&(rt=ot.o),ot.F=null,ot.J=null,it.Fa!=null&&0<it.Fa.length&&R<rt&&(ot.J=Ti(it,ot,R,rt-R),ot.F=it.mb,ot.F==null&&ot.F.length==0)){Bt=_n(it,3,"Could not decode alpha data.");break e}R<ot.j&&(_=ot.j-R,R=ot.j,t(!(1&_)),ot.O+=it.R*_,ot.N+=it.B*(_>>1),ot.W+=it.B*(_>>1),ot.F!=null&&(ot.J+=ot.width*_)),R<rt&&(ot.O+=ot.v,ot.N+=ot.v>>1,ot.W+=ot.v>>1,ot.F!=null&&(ot.J+=ot.v),ot.ka=R-ot.j,ot.U=ot.va-ot.v,ot.T=rt-R,Bt=ot.put(ot))}Ct+1!=it.Ic||g||(i(it.sa,it.ta-zt,Wt,gn+16*it.R,zt),i(it.qa,it.ra-tn,s,Ot+8*it.B,tn),i(it.Ha,it.Ia-tn,l,h+8*it.B,tn))}if(!Bt)return _n(ut,6,"Output aborted.")}return 1}(p,w)),w.bc!=null&&w.bc(w),M&=1}return M?(p.cb=0,M):0}function Hn(p,w,M,z,ne){ne=p[w+M+32*z]+(ne>>3),p[w+M+32*z]=-256&ne?0>ne?0:255:ne}function Ei(p,w,M,z,ne,ge){Hn(p,w,0,M,z+ne),Hn(p,w,1,M,z+ge),Hn(p,w,2,M,z-ge),Hn(p,w,3,M,z-ne)}function Wn(p){return(20091*p>>16)+p}function Qn(p,w,M,z){var ne,ge=0,ve=a(16);for(ne=0;4>ne;++ne){var be=p[w+0]+p[w+8],xe=p[w+0]-p[w+8],Ae=(35468*p[w+4]>>16)-Wn(p[w+12]),Qe=Wn(p[w+4])+(35468*p[w+12]>>16);ve[ge+0]=be+Qe,ve[ge+1]=xe+Ae,ve[ge+2]=xe-Ae,ve[ge+3]=be-Qe,ge+=4,w++}for(ne=ge=0;4>ne;++ne)be=(p=ve[ge+0]+4)+ve[ge+8],xe=p-ve[ge+8],Ae=(35468*ve[ge+4]>>16)-Wn(ve[ge+12]),Hn(M,z,0,0,be+(Qe=Wn(ve[ge+4])+(35468*ve[ge+12]>>16))),Hn(M,z,1,0,xe+Ae),Hn(M,z,2,0,xe-Ae),Hn(M,z,3,0,be-Qe),ge++,z+=32}function ci(p,w,M,z){var ne=p[w+0]+4,ge=35468*p[w+4]>>16,ve=Wn(p[w+4]),be=35468*p[w+1]>>16;Ei(M,z,0,ne+ve,p=Wn(p[w+1]),be),Ei(M,z,1,ne+ge,p,be),Ei(M,z,2,ne-ge,p,be),Ei(M,z,3,ne-ve,p,be)}function ps(p,w,M,z,ne){Qn(p,w,M,z),ne&&Qn(p,w+16,M,z+4)}function Wr(p,w,M,z){es(p,w+0,M,z,1),es(p,w+32,M,z+128,1)}function _i(p,w,M,z){var ne;for(p=p[w+0]+4,ne=0;4>ne;++ne)for(w=0;4>w;++w)Hn(M,z,w,ne,p)}function Ns(p,w,M,z){p[w+0]&&Cr(p,w+0,M,z),p[w+16]&&Cr(p,w+16,M,z+4),p[w+32]&&Cr(p,w+32,M,z+128),p[w+48]&&Cr(p,w+48,M,z+128+4)}function jo(p,w,M,z){var ne,ge=a(16);for(ne=0;4>ne;++ne){var ve=p[w+0+ne]+p[w+12+ne],be=p[w+4+ne]+p[w+8+ne],xe=p[w+4+ne]-p[w+8+ne],Ae=p[w+0+ne]-p[w+12+ne];ge[0+ne]=ve+be,ge[8+ne]=ve-be,ge[4+ne]=Ae+xe,ge[12+ne]=Ae-xe}for(ne=0;4>ne;++ne)ve=(p=ge[0+4*ne]+3)+ge[3+4*ne],be=ge[1+4*ne]+ge[2+4*ne],xe=ge[1+4*ne]-ge[2+4*ne],Ae=p-ge[3+4*ne],M[z+0]=ve+be>>3,M[z+16]=Ae+xe>>3,M[z+32]=ve-be>>3,M[z+48]=Ae-xe>>3,z+=64}function Js(p,w,M){var z,ne=w-32,ge=li,ve=255-p[ne-1];for(z=0;z<M;++z){var be,xe=ge,Ae=ve+p[w-1];for(be=0;be<M;++be)p[w+be]=xe[Ae+p[ne+be]];w+=32}}function Da(p,w){Js(p,w,4)}function mo(p,w){Js(p,w,8)}function Ra(p,w){Js(p,w,16)}function gs(p,w){var M;for(M=0;16>M;++M)i(p,w+32*M,p,w-32,16)}function Xs(p,w){var M;for(M=16;0<M;--M)o(p,w,p[w-1],16),w+=32}function vo(p,w,M){var z;for(z=0;16>z;++z)o(w,M+32*z,p,16)}function da(p,w){var M,z=16;for(M=0;16>M;++M)z+=p[w-1+32*M]+p[w+M-32];vo(z>>5,p,w)}function $i(p,w){var M,z=8;for(M=0;16>M;++M)z+=p[w-1+32*M];vo(z>>4,p,w)}function sl(p,w){var M,z=8;for(M=0;16>M;++M)z+=p[w+M-32];vo(z>>4,p,w)}function fa(p,w){vo(128,p,w)}function kn(p,w,M){return p+2*w+M+2>>2}function An(p,w){var M,z=w-32;for(z=new Uint8Array([kn(p[z-1],p[z+0],p[z+1]),kn(p[z+0],p[z+1],p[z+2]),kn(p[z+1],p[z+2],p[z+3]),kn(p[z+2],p[z+3],p[z+4])]),M=0;4>M;++M)i(p,w+32*M,z,0,z.length)}function Zr(p,w){var M=p[w-1],z=p[w-1+32],ne=p[w-1+64],ge=p[w-1+96];de(p,w+0,16843009*kn(p[w-1-32],M,z)),de(p,w+32,16843009*kn(M,z,ne)),de(p,w+64,16843009*kn(z,ne,ge)),de(p,w+96,16843009*kn(ne,ge,ge))}function Vn(p,w){var M,z=4;for(M=0;4>M;++M)z+=p[w+M-32]+p[w-1+32*M];for(z>>=3,M=0;4>M;++M)o(p,w+32*M,z,4)}function Oa(p,w){var M=p[w-1+0],z=p[w-1+32],ne=p[w-1+64],ge=p[w-1-32],ve=p[w+0-32],be=p[w+1-32],xe=p[w+2-32],Ae=p[w+3-32];p[w+0+96]=kn(z,ne,p[w-1+96]),p[w+1+96]=p[w+0+64]=kn(M,z,ne),p[w+2+96]=p[w+1+64]=p[w+0+32]=kn(ge,M,z),p[w+3+96]=p[w+2+64]=p[w+1+32]=p[w+0+0]=kn(ve,ge,M),p[w+3+64]=p[w+2+32]=p[w+1+0]=kn(be,ve,ge),p[w+3+32]=p[w+2+0]=kn(xe,be,ve),p[w+3+0]=kn(Ae,xe,be)}function pa(p,w){var M=p[w+1-32],z=p[w+2-32],ne=p[w+3-32],ge=p[w+4-32],ve=p[w+5-32],be=p[w+6-32],xe=p[w+7-32];p[w+0+0]=kn(p[w+0-32],M,z),p[w+1+0]=p[w+0+32]=kn(M,z,ne),p[w+2+0]=p[w+1+32]=p[w+0+64]=kn(z,ne,ge),p[w+3+0]=p[w+2+32]=p[w+1+64]=p[w+0+96]=kn(ne,ge,ve),p[w+3+32]=p[w+2+64]=p[w+1+96]=kn(ge,ve,be),p[w+3+64]=p[w+2+96]=kn(ve,be,xe),p[w+3+96]=kn(be,xe,xe)}function yo(p,w){var M=p[w-1+0],z=p[w-1+32],ne=p[w-1+64],ge=p[w-1-32],ve=p[w+0-32],be=p[w+1-32],xe=p[w+2-32],Ae=p[w+3-32];p[w+0+0]=p[w+1+64]=ge+ve+1>>1,p[w+1+0]=p[w+2+64]=ve+be+1>>1,p[w+2+0]=p[w+3+64]=be+xe+1>>1,p[w+3+0]=xe+Ae+1>>1,p[w+0+96]=kn(ne,z,M),p[w+0+64]=kn(z,M,ge),p[w+0+32]=p[w+1+96]=kn(M,ge,ve),p[w+1+32]=p[w+2+96]=kn(ge,ve,be),p[w+2+32]=p[w+3+96]=kn(ve,be,xe),p[w+3+32]=kn(be,xe,Ae)}function Kr(p,w){var M=p[w+0-32],z=p[w+1-32],ne=p[w+2-32],ge=p[w+3-32],ve=p[w+4-32],be=p[w+5-32],xe=p[w+6-32],Ae=p[w+7-32];p[w+0+0]=M+z+1>>1,p[w+1+0]=p[w+0+64]=z+ne+1>>1,p[w+2+0]=p[w+1+64]=ne+ge+1>>1,p[w+3+0]=p[w+2+64]=ge+ve+1>>1,p[w+0+32]=kn(M,z,ne),p[w+1+32]=p[w+0+96]=kn(z,ne,ge),p[w+2+32]=p[w+1+96]=kn(ne,ge,ve),p[w+3+32]=p[w+2+96]=kn(ge,ve,be),p[w+3+64]=kn(ve,be,xe),p[w+3+96]=kn(be,xe,Ae)}function Qs(p,w){var M=p[w-1+0],z=p[w-1+32],ne=p[w-1+64],ge=p[w-1+96];p[w+0+0]=M+z+1>>1,p[w+2+0]=p[w+0+32]=z+ne+1>>1,p[w+2+32]=p[w+0+64]=ne+ge+1>>1,p[w+1+0]=kn(M,z,ne),p[w+3+0]=p[w+1+32]=kn(z,ne,ge),p[w+3+32]=p[w+1+64]=kn(ne,ge,ge),p[w+3+64]=p[w+2+64]=p[w+0+96]=p[w+1+96]=p[w+2+96]=p[w+3+96]=ge}function Ia(p,w){var M=p[w-1+0],z=p[w-1+32],ne=p[w-1+64],ge=p[w-1+96],ve=p[w-1-32],be=p[w+0-32],xe=p[w+1-32],Ae=p[w+2-32];p[w+0+0]=p[w+2+32]=M+ve+1>>1,p[w+0+32]=p[w+2+64]=z+M+1>>1,p[w+0+64]=p[w+2+96]=ne+z+1>>1,p[w+0+96]=ge+ne+1>>1,p[w+3+0]=kn(be,xe,Ae),p[w+2+0]=kn(ve,be,xe),p[w+1+0]=p[w+3+32]=kn(M,ve,be),p[w+1+32]=p[w+3+64]=kn(z,M,ve),p[w+1+64]=p[w+3+96]=kn(ne,z,M),p[w+1+96]=kn(ge,ne,z)}function zo(p,w){var M;for(M=0;8>M;++M)i(p,w+32*M,p,w-32,8)}function Bi(p,w){var M;for(M=0;8>M;++M)o(p,w,p[w-1],8),w+=32}function Ur(p,w,M){var z;for(z=0;8>z;++z)o(w,M+32*z,p,8)}function eo(p,w){var M,z=8;for(M=0;8>M;++M)z+=p[w+M-32]+p[w-1+32*M];Ur(z>>4,p,w)}function ol(p,w){var M,z=4;for(M=0;8>M;++M)z+=p[w+M-32];Ur(z>>3,p,w)}function Uo(p,w){var M,z=4;for(M=0;8>M;++M)z+=p[w-1+32*M];Ur(z>>3,p,w)}function ga(p,w){Ur(128,p,w)}function _o(p,w,M){var z=p[w-M],ne=p[w+0],ge=3*(ne-z)+Eo[1020+p[w-2*M]-p[w+M]],ve=Hi[112+(ge+4>>3)];p[w-M]=li[255+z+Hi[112+(ge+3>>3)]],p[w+0]=li[255+ne-ve]}function $o(p,w,M,z){var ne=p[w+0],ge=p[w+M];return Tr[255+p[w-2*M]-p[w-M]]>z||Tr[255+ge-ne]>z}function Fa(p,w,M,z){return 4*Tr[255+p[w-M]-p[w+0]]+Tr[255+p[w-2*M]-p[w+M]]<=z}function jn(p,w,M,z,ne){var ge=p[w-3*M],ve=p[w-2*M],be=p[w-M],xe=p[w+0],Ae=p[w+M],Qe=p[w+2*M],mt=p[w+3*M];return 4*Tr[255+be-xe]+Tr[255+ve-Ae]>z?0:Tr[255+p[w-4*M]-ge]<=ne&&Tr[255+ge-ve]<=ne&&Tr[255+ve-be]<=ne&&Tr[255+mt-Qe]<=ne&&Tr[255+Qe-Ae]<=ne&&Tr[255+Ae-xe]<=ne}function ja(p,w,M,z){var ne=2*z+1;for(z=0;16>z;++z)Fa(p,w+z,M,ne)&&_o(p,w+z,M)}function dn(p,w,M,z){var ne=2*z+1;for(z=0;16>z;++z)Fa(p,w+z*M,1,ne)&&_o(p,w+z*M,1)}function br(p,w,M,z){var ne;for(ne=3;0<ne;--ne)ja(p,w+=4*M,M,z)}function qo(p,w,M,z){var ne;for(ne=3;0<ne;--ne)dn(p,w+=4,M,z)}function bo(p,w,M,z,ne,ge,ve,be){for(ge=2*ge+1;0<ne--;){if(jn(p,w,M,ge,ve))if($o(p,w,M,be))_o(p,w,M);else{var xe=p,Ae=w,Qe=M,mt=xe[Ae-2*Qe],vt=xe[Ae-Qe],ut=xe[Ae+0],Mt=xe[Ae+Qe],Ct=xe[Ae+2*Qe],it=27*(Bt=Eo[1020+3*(ut-vt)+Eo[1020+mt-Mt]])+63>>7,ot=18*Bt+63>>7,Bt=9*Bt+63>>7;xe[Ae-3*Qe]=li[255+xe[Ae-3*Qe]+Bt],xe[Ae-2*Qe]=li[255+mt+ot],xe[Ae-Qe]=li[255+vt+it],xe[Ae+0]=li[255+ut-it],xe[Ae+Qe]=li[255+Mt-ot],xe[Ae+2*Qe]=li[255+Ct-Bt]}w+=z}}function Sr(p,w,M,z,ne,ge,ve,be){for(ge=2*ge+1;0<ne--;){if(jn(p,w,M,ge,ve))if($o(p,w,M,be))_o(p,w,M);else{var xe=p,Ae=w,Qe=M,mt=xe[Ae-Qe],vt=xe[Ae+0],ut=xe[Ae+Qe],Mt=Hi[112+((Ct=3*(vt-mt))+4>>3)],Ct=Hi[112+(Ct+3>>3)],it=Mt+1>>1;xe[Ae-2*Qe]=li[255+xe[Ae-2*Qe]+it],xe[Ae-Qe]=li[255+mt+Ct],xe[Ae+0]=li[255+vt-Mt],xe[Ae+Qe]=li[255+ut-it]}w+=z}}function za(p,w,M,z,ne,ge){bo(p,w,M,1,16,z,ne,ge)}function Ds(p,w,M,z,ne,ge){bo(p,w,1,M,16,z,ne,ge)}function ma(p,w,M,z,ne,ge){var ve;for(ve=3;0<ve;--ve)Sr(p,w+=4*M,M,1,16,z,ne,ge)}function va(p,w,M,z,ne,ge){var ve;for(ve=3;0<ve;--ve)Sr(p,w+=4,1,M,16,z,ne,ge)}function Yr(p,w,M,z,ne,ge,ve,be){bo(p,w,ne,1,8,ge,ve,be),bo(M,z,ne,1,8,ge,ve,be)}function ya(p,w,M,z,ne,ge,ve,be){bo(p,w,1,ne,8,ge,ve,be),bo(M,z,1,ne,8,ge,ve,be)}function qi(p,w,M,z,ne,ge,ve,be){Sr(p,w+4*ne,ne,1,8,ge,ve,be),Sr(M,z+4*ne,ne,1,8,ge,ve,be)}function al(p,w,M,z,ne,ge,ve,be){Sr(p,w+4,1,ne,8,ge,ve,be),Sr(M,z+4,1,ne,8,ge,ve,be)}function Vo(){this.ba=new Ui,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new qn,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Jr(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function _a(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Ua(){this.ua=0,this.Wa=new j,this.vb=new j,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new Y,this.yc=new re}function $a(){this.xb=this.a=0,this.l=new cr,this.ca=new Ui,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new O,this.Pb=0,this.wd=new O,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Ua,this.ab=0,this.gc=u(4,_a),this.Oc=0}function ba(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new cr,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function wo(p,w,M,z,ne,ge,ve){for(p=p==null?0:p[w+0],w=0;w<ve;++w)ne[ge+w]=p+M[z+w]&255,p=ne[ge+w]}function Go(p,w,M,z,ne,ge,ve){var be;if(p==null)wo(null,null,M,z,ne,ge,ve);else for(be=0;be<ve;++be)ne[ge+be]=p[w+be]+M[z+be]&255}function xo(p,w,M,z,ne,ge,ve){if(p==null)wo(null,null,M,z,ne,ge,ve);else{var be,xe=p[w+0],Ae=xe,Qe=xe;for(be=0;be<ve;++be)Ae=Qe+(xe=p[w+be])-Ae,Qe=M[z+be]+(-256&Ae?0>Ae?0:255:Ae)&255,Ae=xe,ne[ge+be]=Qe}}function Ti(p,w,M,z){var ne=w.width,ge=w.o;if(t(p!=null&&w!=null),0>M||0>=z||M+z>ge)return null;if(!p.Cc){if(p.ga==null){var ve;if(p.ga=new ba,(ve=p.ga==null)||(ve=w.width*w.o,t(p.Gb.length==0),p.Gb=a(ve),p.Uc=0,p.Gb==null?ve=0:(p.mb=p.Gb,p.nb=p.Uc,p.rc=null,ve=1),ve=!ve),!ve){ve=p.ga;var be=p.Fa,xe=p.P,Ae=p.qc,Qe=p.mb,mt=p.nb,vt=xe+1,ut=Ae-1,Mt=ve.l;if(t(be!=null&&Qe!=null&&w!=null),si[0]=null,si[1]=wo,si[2]=Go,si[3]=xo,ve.ca=Qe,ve.tb=mt,ve.c=w.width,ve.i=w.height,t(0<ve.c&&0<ve.i),1>=Ae)w=0;else if(ve.$a=be[xe+0]>>0&3,ve.Z=be[xe+0]>>2&3,ve.Lc=be[xe+0]>>4&3,xe=be[xe+0]>>6&3,0>ve.$a||1<ve.$a||4<=ve.Z||1<ve.Lc||xe)w=0;else if(Mt.put=xi,Mt.ac=Yn,Mt.bc=pi,Mt.ma=ve,Mt.width=w.width,Mt.height=w.height,Mt.Da=w.Da,Mt.v=w.v,Mt.va=w.va,Mt.j=w.j,Mt.o=w.o,ve.$a)e:{t(ve.$a==1),w=ur();t:for(;;){if(w==null){w=0;break e}if(t(ve!=null),ve.mc=w,w.c=ve.c,w.i=ve.i,w.l=ve.l,w.l.ma=ve,w.l.width=ve.c,w.l.height=ve.i,w.a=0,J(w.m,be,vt,ut),!jr(ve.c,ve.i,1,w,null)||(w.ab==1&&w.gc[0].hc==3&&ui(w.s)?(ve.ic=1,be=w.c*w.i,w.Ta=null,w.Ua=0,w.V=a(be),w.Ba=0,w.V==null?(w.a=1,w=0):w=1):(ve.ic=0,w=Ss(w,ve.c)),!w))break t;w=1;break e}ve.mc=null,w=0}else w=ut>=ve.c*ve.i;ve=!w}if(ve)return null;p.ga.Lc!=1?p.Ga=0:z=ge-M}t(p.ga!=null),t(M+z<=ge);e:{if(w=(be=p.ga).c,ge=be.l.o,be.$a==0){if(vt=p.rc,ut=p.Vc,Mt=p.Fa,xe=p.P+1+M*w,Ae=p.mb,Qe=p.nb+M*w,t(xe<=p.P+p.qc),be.Z!=0)for(t(si[be.Z]!=null),ve=0;ve<z;++ve)si[be.Z](vt,ut,Mt,xe,Ae,Qe,w),vt=Ae,ut=Qe,Qe+=w,xe+=w;else for(ve=0;ve<z;++ve)i(Ae,Qe,Mt,xe,w),vt=Ae,ut=Qe,Qe+=w,xe+=w;p.rc=vt,p.Vc=ut}else{if(t(be.mc!=null),w=M+z,t((ve=be.mc)!=null),t(w<=ve.i),ve.C>=w)w=1;else if(be.ic||ct(),be.ic){be=ve.V,vt=ve.Ba,ut=ve.c;var Ct=ve.i,it=(Mt=1,xe=ve.$/ut,Ae=ve.$%ut,Qe=ve.m,mt=ve.s,ve.$),ot=ut*Ct,Bt=ut*w,zt=mt.wc,Ot=it<Bt?bt(mt,Ae,xe):null;t(it<=ot),t(w<=Ct),t(ui(mt));t:for(;;){for(;!Qe.h&&it<Bt;){if(Ae&zt||(Ot=bt(mt,Ae,xe)),t(Ot!=null),_e(Qe),256>(Ct=gi(Ot.G[0],Ot.H[0],Qe)))be[vt+it]=Ct,++it,++Ae>=ut&&(Ae=0,++xe<=w&&!(xe%16)&&lr(ve,xe));else{if(!(280>Ct)){Mt=0;break t}Ct=mn(Ct-256,Qe);var tn,Wt=gi(Ot.G[4],Ot.H[4],Qe);if(_e(Qe),!(it>=(Wt=Yt(ut,Wt=mn(Wt,Qe)))&&ot-it>=Ct)){Mt=0;break t}for(tn=0;tn<Ct;++tn)be[vt+it+tn]=be[vt+it+tn-Wt];for(it+=Ct,Ae+=Ct;Ae>=ut;)Ae-=ut,++xe<=w&&!(xe%16)&&lr(ve,xe);it<Bt&&Ae&zt&&(Ot=bt(mt,Ae,xe))}t(Qe.h==le(Qe))}lr(ve,xe>w?w:xe);break t}!Mt||Qe.h&&it<ot?(Mt=0,ve.a=Qe.h?5:3):ve.$=it,w=Mt}else w=_r(ve,ve.V,ve.Ba,ve.c,ve.i,w,Zs);if(!w){z=0;break e}}M+z>=ge&&(p.Cc=1),z=1}if(!z)return null;if(p.Cc&&((z=p.ga)!=null&&(z.mc=null),p.ga=null,0<p.Ga))return alert("todo:WebPDequantizeLevels"),null}return p.nb+M*ne}function P(p,w,M,z,ne,ge){for(;0<ne--;){var ve,be=p,xe=w+(M?1:0),Ae=p,Qe=w+(M?0:3);for(ve=0;ve<z;++ve){var mt=Ae[Qe+4*ve];mt!=255&&(mt*=32897,be[xe+4*ve+0]=be[xe+4*ve+0]*mt>>23,be[xe+4*ve+1]=be[xe+4*ve+1]*mt>>23,be[xe+4*ve+2]=be[xe+4*ve+2]*mt>>23)}w+=ge}}function te(p,w,M,z,ne){for(;0<z--;){var ge;for(ge=0;ge<M;++ge){var ve=p[w+2*ge+0],be=15&(Ae=p[w+2*ge+1]),xe=4369*be,Ae=(240&Ae|Ae>>4)*xe>>16;p[w+2*ge+0]=(240&ve|ve>>4)*xe>>16&240|(15&ve|ve<<4)*xe>>16>>4&15,p[w+2*ge+1]=240&Ae|be}w+=ne}}function Ne(p,w,M,z,ne,ge,ve,be){var xe,Ae,Qe=255;for(Ae=0;Ae<ne;++Ae){for(xe=0;xe<z;++xe){var mt=p[w+xe];ge[ve+4*xe]=mt,Qe&=mt}w+=M,ve+=be}return Qe!=255}function Ke(p,w,M,z,ne){var ge;for(ge=0;ge<ne;++ge)M[z+ge]=p[w+ge]>>8}function ct(){tr=P,ri=te,ti=Ne,Ni=Ke}function Lt(p,w,M){Pe[p]=function(z,ne,ge,ve,be,xe,Ae,Qe,mt,vt,ut,Mt,Ct,it,ot,Bt,zt){var Ot,tn=zt-1>>1,Wt=be[xe+0]|Ae[Qe+0]<<16,gn=mt[vt+0]|ut[Mt+0]<<16;t(z!=null);var s=3*Wt+gn+131074>>2;for(w(z[ne+0],255&s,s>>16,Ct,it),ge!=null&&(s=3*gn+Wt+131074>>2,w(ge[ve+0],255&s,s>>16,ot,Bt)),Ot=1;Ot<=tn;++Ot){var l=be[xe+Ot]|Ae[Qe+Ot]<<16,h=mt[vt+Ot]|ut[Mt+Ot]<<16,g=Wt+l+gn+h+524296,_=g+2*(l+gn)>>3;s=_+Wt>>1,Wt=(g=g+2*(Wt+h)>>3)+l>>1,w(z[ne+2*Ot-1],255&s,s>>16,Ct,it+(2*Ot-1)*M),w(z[ne+2*Ot-0],255&Wt,Wt>>16,Ct,it+(2*Ot-0)*M),ge!=null&&(s=g+gn>>1,Wt=_+h>>1,w(ge[ve+2*Ot-1],255&s,s>>16,ot,Bt+(2*Ot-1)*M),w(ge[ve+2*Ot+0],255&Wt,Wt>>16,ot,Bt+(2*Ot+0)*M)),Wt=l,gn=h}1&zt||(s=3*Wt+gn+131074>>2,w(z[ne+zt-1],255&s,s>>16,Ct,it+(zt-1)*M),ge!=null&&(s=3*gn+Wt+131074>>2,w(ge[ve+zt-1],255&s,s>>16,ot,Bt+(zt-1)*M)))}}function Ut(){gr[Nr]=Wu,gr[bn]=hu,gr[hl]=$s,gr[Zo]=Ko,gr[ns]=dl,gr[pr]=du,gr[Fl]=$c,gr[Pr]=hu,gr[kr]=Ko,gr[zs]=dl,gr[r]=du}function Kt(p){return p&-16384?0>p?0:255:p>>md}function en(p,w){return Kt((19077*p>>8)+(26149*w>>8)-14234)}function un(p,w,M){return Kt((19077*p>>8)-(6419*w>>8)-(13320*M>>8)+8708)}function Ln(p,w){return Kt((19077*p>>8)+(33050*w>>8)-17685)}function zn(p,w,M,z,ne){z[ne+0]=en(p,M),z[ne+1]=un(p,w,M),z[ne+2]=Ln(p,w)}function mi(p,w,M,z,ne){z[ne+0]=Ln(p,w),z[ne+1]=un(p,w,M),z[ne+2]=en(p,M)}function Zn(p,w,M,z,ne){var ge=un(p,w,M);w=ge<<3&224|Ln(p,w)>>3,z[ne+0]=248&en(p,M)|ge>>5,z[ne+1]=w}function ei(p,w,M,z,ne){var ge=240&Ln(p,w)|15;z[ne+0]=240&en(p,M)|un(p,w,M)>>4,z[ne+1]=ge}function Vi(p,w,M,z,ne){z[ne+0]=255,zn(p,w,M,z,ne+1)}function Fi(p,w,M,z,ne){mi(p,w,M,z,ne),z[ne+3]=255}function $r(p,w,M,z,ne){zn(p,w,M,z,ne),z[ne+3]=255}function oi(p,w){return 0>p?0:p>w?w:p}function wr(p,w,M){Pe[p]=function(z,ne,ge,ve,be,xe,Ae,Qe,mt){for(var vt=Qe+(-2&mt)*M;Qe!=vt;)w(z[ne+0],ge[ve+0],be[xe+0],Ae,Qe),w(z[ne+1],ge[ve+0],be[xe+0],Ae,Qe+M),ne+=2,++ve,++xe,Qe+=2*M;1&mt&&w(z[ne+0],ge[ve+0],be[xe+0],Ae,Qe)}}function ll(p,w,M){return M==0?p==0?w==0?6:5:w==0?4:0:M}function xr(p,w,M,z,ne){switch(p>>>30){case 3:es(w,M,z,ne,0);break;case 2:Si(w,M,z,ne);break;case 1:Cr(w,M,z,ne)}}function qa(p,w){var M,z,ne=w.M,ge=w.Nb,ve=p.oc,be=p.pc+40,xe=p.oc,Ae=p.pc+584,Qe=p.oc,mt=p.pc+600;for(M=0;16>M;++M)ve[be+32*M-1]=129;for(M=0;8>M;++M)xe[Ae+32*M-1]=129,Qe[mt+32*M-1]=129;for(0<ne?ve[be-1-32]=xe[Ae-1-32]=Qe[mt-1-32]=129:(o(ve,be-32-1,127,21),o(xe,Ae-32-1,127,9),o(Qe,mt-32-1,127,9)),z=0;z<p.za;++z){var vt=w.ya[w.aa+z];if(0<z){for(M=-1;16>M;++M)i(ve,be+32*M-4,ve,be+32*M+12,4);for(M=-1;8>M;++M)i(xe,Ae+32*M-4,xe,Ae+32*M+4,4),i(Qe,mt+32*M-4,Qe,mt+32*M+4,4)}var ut=p.Gd,Mt=p.Hd+z,Ct=vt.ad,it=vt.Hc;if(0<ne&&(i(ve,be-32,ut[Mt].y,0,16),i(xe,Ae-32,ut[Mt].f,0,8),i(Qe,mt-32,ut[Mt].ea,0,8)),vt.Za){var ot=ve,Bt=be-32+16;for(0<ne&&(z>=p.za-1?o(ot,Bt,ut[Mt].y[15],4):i(ot,Bt,ut[Mt+1].y,0,4)),M=0;4>M;M++)ot[Bt+128+M]=ot[Bt+256+M]=ot[Bt+384+M]=ot[Bt+0+M];for(M=0;16>M;++M,it<<=2)ot=ve,Bt=be+Vc[M],is[vt.Ob[M]](ot,Bt),xr(it,Ct,16*+M,ot,Bt)}else if(ot=ll(z,ne,vt.Ob[0]),_s[ot](ve,be),it!=0)for(M=0;16>M;++M,it<<=2)xr(it,Ct,16*+M,ve,be+Vc[M]);for(M=vt.Gc,ot=ll(z,ne,vt.Dd),Vr[ot](xe,Ae),Vr[ot](Qe,mt),it=Ct,ot=xe,Bt=Ae,255&(vt=M>>0)&&(170&vt?Is(it,256,ot,Bt):dr(it,256,ot,Bt)),vt=Qe,it=mt,255&(M>>=8)&&(170&M?Is(Ct,320,vt,it):dr(Ct,320,vt,it)),ne<p.Ub-1&&(i(ut[Mt].y,0,ve,be+480,16),i(ut[Mt].f,0,xe,Ae+224,8),i(ut[Mt].ea,0,Qe,mt+224,8)),M=8*ge*p.B,ut=p.sa,Mt=p.ta+16*z+16*ge*p.R,Ct=p.qa,vt=p.ra+8*z+M,it=p.Ha,ot=p.Ia+8*z+M,M=0;16>M;++M)i(ut,Mt+M*p.R,ve,be+32*M,16);for(M=0;8>M;++M)i(Ct,vt+M*p.B,xe,Ae+32*M,8),i(it,ot+M*p.B,Qe,mt+32*M,8)}}function ms(p,w,M,z,ne,ge,ve,be,xe){var Ae=[0],Qe=[0],mt=0,vt=xe!=null?xe.kd:0,ut=xe??new Jr;if(p==null||12>M)return 7;ut.data=p,ut.w=w,ut.ha=M,w=[w],M=[M],ut.gb=[ut.gb];e:{var Mt=w,Ct=M,it=ut.gb;if(t(p!=null),t(Ct!=null),t(it!=null),it[0]=0,12<=Ct[0]&&!n(p,Mt[0],"RIFF")){if(n(p,Mt[0]+8,"WEBP")){it=3;break e}var ot=Z(p,Mt[0]+4);if(12>ot||4294967286<ot){it=3;break e}if(vt&&ot>Ct[0]-8){it=7;break e}it[0]=ot,Mt[0]+=12,Ct[0]-=12}it=0}if(it!=0)return it;for(ot=0<ut.gb[0],M=M[0];;){e:{var Bt=p;Ct=w,it=M;var zt=Ae,Ot=Qe,tn=Mt=[0];if((s=mt=[mt])[0]=0,8>it[0])it=7;else{if(!n(Bt,Ct[0],"VP8X")){if(Z(Bt,Ct[0]+4)!=10){it=3;break e}if(18>it[0]){it=7;break e}var Wt=Z(Bt,Ct[0]+8),gn=1+V(Bt,Ct[0]+12);if(2147483648<=gn*(Bt=1+V(Bt,Ct[0]+15))){it=3;break e}tn!=null&&(tn[0]=Wt),zt!=null&&(zt[0]=gn),Ot!=null&&(Ot[0]=Bt),Ct[0]+=18,it[0]-=18,s[0]=1}it=0}}if(mt=mt[0],Mt=Mt[0],it!=0)return it;if(Ct=!!(2&Mt),!ot&&mt)return 3;if(ge!=null&&(ge[0]=!!(16&Mt)),ve!=null&&(ve[0]=Ct),be!=null&&(be[0]=0),ve=Ae[0],Mt=Qe[0],mt&&Ct&&xe==null){it=0;break}if(4>M){it=7;break}if(ot&&mt||!ot&&!mt&&!n(p,w[0],"ALPH")){M=[M],ut.na=[ut.na],ut.P=[ut.P],ut.Sa=[ut.Sa];e:{Wt=p,it=w,ot=M;var s=ut.gb;zt=ut.na,Ot=ut.P,tn=ut.Sa,gn=22,t(Wt!=null),t(ot!=null),Bt=it[0];var l=ot[0];for(t(zt!=null),t(tn!=null),zt[0]=null,Ot[0]=null,tn[0]=0;;){if(it[0]=Bt,ot[0]=l,8>l){it=7;break e}var h=Z(Wt,Bt+4);if(4294967286<h){it=3;break e}var g=8+h+1&-2;if(gn+=g,0<s&&gn>s){it=3;break e}if(!n(Wt,Bt,"VP8 ")||!n(Wt,Bt,"VP8L")){it=0;break e}if(l[0]<g){it=7;break e}n(Wt,Bt,"ALPH")||(zt[0]=Wt,Ot[0]=Bt+8,tn[0]=h),Bt+=g,l-=g}}if(M=M[0],ut.na=ut.na[0],ut.P=ut.P[0],ut.Sa=ut.Sa[0],it!=0)break}M=[M],ut.Ja=[ut.Ja],ut.xa=[ut.xa];e:if(s=p,it=w,ot=M,zt=ut.gb[0],Ot=ut.Ja,tn=ut.xa,Wt=it[0],Bt=!n(s,Wt,"VP8 "),gn=!n(s,Wt,"VP8L"),t(s!=null),t(ot!=null),t(Ot!=null),t(tn!=null),8>ot[0])it=7;else{if(Bt||gn){if(s=Z(s,Wt+4),12<=zt&&s>zt-12){it=3;break e}if(vt&&s>ot[0]-8){it=7;break e}Ot[0]=s,it[0]+=8,ot[0]-=8,tn[0]=gn}else tn[0]=5<=ot[0]&&s[Wt+0]==47&&!(s[Wt+4]>>5),Ot[0]=ot[0];it=0}if(M=M[0],ut.Ja=ut.Ja[0],ut.xa=ut.xa[0],w=w[0],it!=0)break;if(4294967286<ut.Ja)return 3;if(be==null||Ct||(be[0]=ut.xa?2:1),ve=[ve],Mt=[Mt],ut.xa){if(5>M){it=7;break}be=ve,vt=Mt,Ct=ge,p==null||5>M?p=0:5<=M&&p[w+0]==47&&!(p[w+4]>>5)?(ot=[0],s=[0],zt=[0],J(Ot=new O,p,w,M),sn(Ot,ot,s,zt)?(be!=null&&(be[0]=ot[0]),vt!=null&&(vt[0]=s[0]),Ct!=null&&(Ct[0]=zt[0]),p=1):p=0):p=0}else{if(10>M){it=7;break}be=Mt,p==null||10>M||!fs(p,w+3,M-3)?p=0:(vt=p[w+0]|p[w+1]<<8|p[w+2]<<16,Ct=16383&(p[w+7]<<8|p[w+6]),p=16383&(p[w+9]<<8|p[w+8]),1&vt||3<(vt>>1&7)||!(vt>>4&1)||vt>>5>=ut.Ja||!Ct||!p?p=0:(ve&&(ve[0]=Ct),be&&(be[0]=p),p=1))}if(!p||(ve=ve[0],Mt=Mt[0],mt&&(Ae[0]!=ve||Qe[0]!=Mt)))return 3;xe!=null&&(xe[0]=ut,xe.offset=w-xe.w,t(4294967286>w-xe.w),t(xe.offset==xe.ha-M));break}return it==0||it==7&&mt&&xe==null?(ge!=null&&(ge[0]|=ut.na!=null&&0<ut.na.length),z!=null&&(z[0]=ve),ne!=null&&(ne[0]=Mt),0):it}function Va(p,w,M){var z=w.width,ne=w.height,ge=0,ve=0,be=z,xe=ne;if(w.Da=p!=null&&0<p.Da,w.Da&&(be=p.cd,xe=p.bd,ge=p.v,ve=p.j,11>M||(ge&=-2,ve&=-2),0>ge||0>ve||0>=be||0>=xe||ge+be>z||ve+xe>ne))return 0;if(w.v=ge,w.j=ve,w.va=ge+be,w.o=ve+xe,w.U=be,w.T=xe,w.da=p!=null&&0<p.da,w.da){if(!Fe(be,xe,M=[p.ib],ge=[p.hb]))return 0;w.ib=M[0],w.hb=ge[0]}return w.ob=p!=null&&p.ob,w.Kb=p==null||!p.Sd,w.da&&(w.ob=w.ib<3*z/4&&w.hb<3*ne/4,w.Kb=0),1}function to(p){if(p==null)return 2;if(11>p.S){var w=p.f.RGBA;w.fb+=(p.height-1)*w.A,w.A=-w.A}else w=p.f.kb,p=p.height,w.O+=(p-1)*w.fa,w.fa=-w.fa,w.N+=(p-1>>1)*w.Ab,w.Ab=-w.Ab,w.W+=(p-1>>1)*w.Db,w.Db=-w.Db,w.F!=null&&(w.J+=(p-1)*w.lb,w.lb=-w.lb);return 0}function no(p,w,M,z){if(z==null||0>=p||0>=w)return 2;if(M!=null){if(M.Da){var ne=M.cd,ge=M.bd,ve=-2&M.v,be=-2&M.j;if(0>ve||0>be||0>=ne||0>=ge||ve+ne>p||be+ge>w)return 2;p=ne,w=ge}if(M.da){if(!Fe(p,w,ne=[M.ib],ge=[M.hb]))return 2;p=ne[0],w=ge[0]}}z.width=p,z.height=w;e:{var xe=z.width,Ae=z.height;if(p=z.S,0>=xe||0>=Ae||!(p>=Nr&&13>p))p=2;else{if(0>=z.Rd&&z.sd==null){ve=ge=ne=w=0;var Qe=(be=xe*Wc[p])*Ae;if(11>p||(ge=(Ae+1)/2*(w=(xe+1)/2),p==12&&(ve=(ne=xe)*Ae)),(Ae=a(Qe+2*ge+ve))==null){p=1;break e}z.sd=Ae,11>p?((xe=z.f.RGBA).eb=Ae,xe.fb=0,xe.A=be,xe.size=Qe):((xe=z.f.kb).y=Ae,xe.O=0,xe.fa=be,xe.Fd=Qe,xe.f=Ae,xe.N=0+Qe,xe.Ab=w,xe.Cd=ge,xe.ea=Ae,xe.W=0+Qe+ge,xe.Db=w,xe.Ed=ge,p==12&&(xe.F=Ae,xe.J=0+Qe+2*ge),xe.Tc=ve,xe.lb=ne)}if(w=1,ne=z.S,ge=z.width,ve=z.height,ne>=Nr&&13>ne)if(11>ne)p=z.f.RGBA,w&=(be=Math.abs(p.A))*(ve-1)+ge<=p.size,w&=be>=ge*Wc[ne],w&=p.eb!=null;else{p=z.f.kb,be=(ge+1)/2,Qe=(ve+1)/2,xe=Math.abs(p.fa),Ae=Math.abs(p.Ab);var mt=Math.abs(p.Db),vt=Math.abs(p.lb),ut=vt*(ve-1)+ge;w&=xe*(ve-1)+ge<=p.Fd,w&=Ae*(Qe-1)+be<=p.Cd,w=(w&=mt*(Qe-1)+be<=p.Ed)&xe>=ge&Ae>=be&mt>=be,w&=p.y!=null,w&=p.f!=null,w&=p.ea!=null,ne==12&&(w&=vt>=ge,w&=ut<=p.Tc,w&=p.F!=null)}else w=0;p=w?0:2}}return p!=0||M!=null&&M.fd&&(p=to(z)),p}var ji=64,wa=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Ar=24,Lr=32,xa=8,hr=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Je("Predictor0","PredictorAdd0"),Pe.Predictor0=function(){return 4278190080},Pe.Predictor1=function(p){return p},Pe.Predictor2=function(p,w,M){return w[M+0]},Pe.Predictor3=function(p,w,M){return w[M+1]},Pe.Predictor4=function(p,w,M){return w[M-1]},Pe.Predictor5=function(p,w,M){return yt(yt(p,w[M+1]),w[M+0])},Pe.Predictor6=function(p,w,M){return yt(p,w[M-1])},Pe.Predictor7=function(p,w,M){return yt(p,w[M+0])},Pe.Predictor8=function(p,w,M){return yt(w[M-1],w[M+0])},Pe.Predictor9=function(p,w,M){return yt(w[M+0],w[M+1])},Pe.Predictor10=function(p,w,M){return yt(yt(p,w[M-1]),yt(w[M+0],w[M+1]))},Pe.Predictor11=function(p,w,M){var z=w[M+0];return 0>=Rt(z>>24&255,p>>24&255,(w=w[M-1])>>24&255)+Rt(z>>16&255,p>>16&255,w>>16&255)+Rt(z>>8&255,p>>8&255,w>>8&255)+Rt(255&z,255&p,255&w)?z:p},Pe.Predictor12=function(p,w,M){var z=w[M+0];return(wt((p>>24&255)+(z>>24&255)-((w=w[M-1])>>24&255))<<24|wt((p>>16&255)+(z>>16&255)-(w>>16&255))<<16|wt((p>>8&255)+(z>>8&255)-(w>>8&255))<<8|wt((255&p)+(255&z)-(255&w)))>>>0},Pe.Predictor13=function(p,w,M){var z=w[M-1];return(Pt((p=yt(p,w[M+0]))>>24&255,z>>24&255)<<24|Pt(p>>16&255,z>>16&255)<<16|Pt(p>>8&255,z>>8&255)<<8|Pt(p>>0&255,z>>0&255))>>>0};var io=Pe.PredictorAdd0;Pe.PredictorAdd1=qt,Je("Predictor2","PredictorAdd2"),Je("Predictor3","PredictorAdd3"),Je("Predictor4","PredictorAdd4"),Je("Predictor5","PredictorAdd5"),Je("Predictor6","PredictorAdd6"),Je("Predictor7","PredictorAdd7"),Je("Predictor8","PredictorAdd8"),Je("Predictor9","PredictorAdd9"),Je("Predictor10","PredictorAdd10"),Je("Predictor11","PredictorAdd11"),Je("Predictor12","PredictorAdd12"),Je("Predictor13","PredictorAdd13");var qr=Pe.PredictorAdd2;Et("ColorIndexInverseTransform","MapARGB","32b",function(p){return p>>8&255},function(p){return p}),Et("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(p){return p},function(p){return p>>8&255});var ul,Gi=Pe.ColorIndexInverseTransform,Rs=Pe.MapARGB,Xr=Pe.VP8LColorIndexInverseTransformAlpha,Ho=Pe.MapAlpha,ro=Pe.VP8LPredictorsAdd=[];ro.length=16,(Pe.VP8LPredictors=[]).length=16,(Pe.VP8LPredictorsAdd_C=[]).length=16,(Pe.VP8LPredictors_C=[]).length=16;var Os,er,Ji,vs,Mr,Qr,so,es,Si,Is,Cr,dr,Wo,Ga,Ha,fr,Br,Lo,Fs,La,Co,Po,oo,ts,tr,ri,ti,Ni,ai=a(511),ys=a(2041),ko=a(225),js=a(767),cl=0,Eo=ys,Hi=ko,li=js,Tr=ai,Nr=0,bn=1,hl=2,Zo=3,ns=4,pr=5,Fl=6,Pr=7,kr=8,zs=9,r=10,c=[2,3,7],v=[3,3,11],S=[280,256,256,256,40],U=[0,1,1,1,0],me=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],Ge=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],ft=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],xt=8,Ft=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Jt=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],hn=null,Rn=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],Er=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],Wi=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],Dr=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],Ai=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],Us=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],jl=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],_s=[],is=[],Vr=[],Hu=1,zl=2,si=[],gr=[];Lt("UpsampleRgbLinePair",zn,3),Lt("UpsampleBgrLinePair",mi,3),Lt("UpsampleRgbaLinePair",$r,4),Lt("UpsampleBgraLinePair",Fi,4),Lt("UpsampleArgbLinePair",Vi,4),Lt("UpsampleRgba4444LinePair",ei,2),Lt("UpsampleRgb565LinePair",Zn,2);var Wu=Pe.UpsampleRgbLinePair,$s=Pe.UpsampleBgrLinePair,hu=Pe.UpsampleRgbaLinePair,Ko=Pe.UpsampleBgraLinePair,dl=Pe.UpsampleArgbLinePair,du=Pe.UpsampleRgba4444LinePair,$c=Pe.UpsampleRgb565LinePair,fu=16,Ul=1<<fu-1,$l=-227,Zu=482,md=6,fl=0,pu=a(256),vd=a(256),yd=a(256),gu=a(256),mu=a(Zu-$l),qc=a(Zu-$l);wr("YuvToRgbRow",zn,3),wr("YuvToBgrRow",mi,3),wr("YuvToRgbaRow",$r,4),wr("YuvToBgraRow",Fi,4),wr("YuvToArgbRow",Vi,4),wr("YuvToRgba4444Row",ei,2),wr("YuvToRgb565Row",Zn,2);var Vc=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],vu=[0,2,8],Gc=[8,7,6,4,4,2,2,2,1,1,1,1],Hc=1;this.WebPDecodeRGBA=function(p,w,M,z,ne){var ge=bn,ve=new Vo,be=new Ui;ve.ba=be,be.S=ge,be.width=[be.width],be.height=[be.height];var xe=be.width,Ae=be.height,Qe=new Oi;if(Qe==null||p==null)var mt=2;else t(Qe!=null),mt=ms(p,w,M,Qe.width,Qe.height,Qe.Pd,Qe.Qd,Qe.format,null);if(mt!=0?xe=0:(xe!=null&&(xe[0]=Qe.width[0]),Ae!=null&&(Ae[0]=Qe.height[0]),xe=1),xe){be.width=be.width[0],be.height=be.height[0],z!=null&&(z[0]=be.width),ne!=null&&(ne[0]=be.height);e:{if(z=new cr,(ne=new Jr).data=p,ne.w=w,ne.ha=M,ne.kd=1,w=[0],t(ne!=null),((p=ms(ne.data,ne.w,ne.ha,null,null,null,w,null,ne))==0||p==7)&&w[0]&&(p=4),(w=p)==0){if(t(ve!=null),z.data=ne.data,z.w=ne.w+ne.offset,z.ha=ne.ha-ne.offset,z.put=xi,z.ac=Yn,z.bc=pi,z.ma=ve,ne.xa){if((p=ur())==null){ve=1;break e}if(function(vt,ut){var Mt=[0],Ct=[0],it=[0];t:for(;;){if(vt==null)return 0;if(ut==null)return vt.a=2,0;if(vt.l=ut,vt.a=0,J(vt.m,ut.data,ut.w,ut.ha),!sn(vt.m,Mt,Ct,it)){vt.a=3;break t}if(vt.xb=zl,ut.width=Mt[0],ut.height=Ct[0],!jr(Mt[0],Ct[0],1,vt,null))break t;return 1}return t(vt.a!=0),0}(p,z)){if(z=(w=no(z.width,z.height,ve.Oa,ve.ba))==0){t:{z=p;n:for(;;){if(z==null){z=0;break t}if(t(z.s.yc!=null),t(z.s.Ya!=null),t(0<z.s.Wb),t((M=z.l)!=null),t((ne=M.ma)!=null),z.xb!=0){if(z.ca=ne.ba,z.tb=ne.tb,t(z.ca!=null),!Va(ne.Oa,M,Zo)){z.a=2;break n}if(!Ss(z,M.width)||M.da)break n;if((M.da||an(z.ca.S))&&ct(),11>z.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),z.ca.f.kb.F!=null&&ct()),z.Pb&&0<z.s.ua&&z.s.vb.X==null&&!F(z.s.vb,z.s.Wa.Xa)){z.a=1;break n}z.xb=0}if(!_r(z,z.V,z.Ba,z.c,z.i,M.o,Ii))break n;ne.Dc=z.Ma,z=1;break t}t(z.a!=0),z=0}z=!z}z&&(w=p.a)}else w=p.a}else{if((p=new Fn)==null){ve=1;break e}if(p.Fa=ne.na,p.P=ne.P,p.qc=ne.Sa,Hr(p,z)){if((w=no(z.width,z.height,ve.Oa,ve.ba))==0){if(p.Aa=0,M=ve.Oa,t((ne=p)!=null),M!=null){if(0<(xe=0>(xe=M.Md)?0:100<xe?255:255*xe/100)){for(Ae=Qe=0;4>Ae;++Ae)12>(mt=ne.pb[Ae]).lc&&(mt.ia=xe*Gc[0>mt.lc?0:mt.lc]>>3),Qe|=mt.ia;Qe&&(alert("todo:VP8InitRandom"),ne.ia=1)}ne.Ga=M.Id,100<ne.Ga?ne.Ga=100:0>ne.Ga&&(ne.Ga=0)}xn(p,z)||(w=p.a)}}else w=p.a}w==0&&ve.Oa!=null&&ve.Oa.fd&&(w=to(ve.ba))}ve=w}ge=ve!=0?null:11>ge?be.f.RGBA.eb:be.f.kb.y}else ge=null;return ge};var Wc=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function m(Pe,Te){for(var He="",ae=0;ae<4;ae++)He+=String.fromCharCode(Pe[Te++]);return He}function y(Pe,Te){return(Pe[Te+0]<<0|Pe[Te+1]<<8|Pe[Te+2]<<16)>>>0}function x(Pe,Te){return(Pe[Te+0]<<0|Pe[Te+1]<<8|Pe[Te+2]<<16|Pe[Te+3]<<24)>>>0}new f;var k=[0],b=[0],T=[],$=new f,H=e,I=function(Pe,Te){var He={},ae=0,re=!1,oe=0,Y=0;if(He.frames=[],!function(ie,le,fe,_e){for(var ee=0;ee<_e;ee++)if(ie[le+ee]!=fe.charCodeAt(ee))return!0;return!1}(Pe,Te,"RIFF",4)){var C,N;for(x(Pe,Te+=4),Te+=8;Te<Pe.length;){var K=m(Pe,Te),J=x(Pe,Te+=4);Te+=4;var Ee=J+(1&J);switch(K){case"VP8 ":case"VP8L":He.frames[ae]===void 0&&(He.frames[ae]={}),(O=He.frames[ae]).src_off=re?Y:Te-8,O.src_size=oe+J+8,ae++,re&&(re=!1,oe=0,Y=0);break;case"VP8X":(O=He.header={}).feature_flags=Pe[Te];var ue=Te+4;O.canvas_width=1+y(Pe,ue),ue+=3,O.canvas_height=1+y(Pe,ue),ue+=3;break;case"ALPH":re=!0,oe=Ee+8,Y=Te-8;break;case"ANIM":(O=He.header).bgcolor=x(Pe,Te),ue=Te+4,O.loop_count=(C=Pe)[(N=ue)+0]<<0|C[N+1]<<8,ue+=2;break;case"ANMF":var ye,O;(O=He.frames[ae]={}).offset_x=2*y(Pe,Te),Te+=3,O.offset_y=2*y(Pe,Te),Te+=3,O.width=1+y(Pe,Te),Te+=3,O.height=1+y(Pe,Te),Te+=3,O.duration=y(Pe,Te),Te+=3,ye=Pe[Te++],O.dispose=1&ye,O.blend=ye>>1&1}K!="ANMF"&&(Te+=Ee)}return He}}(H,0);I.response=H,I.rgbaoutput=!0,I.dataurl=!1;var Q=I.header?I.header:null,se=I.frames?I.frames:null;if(Q){Q.loop_counter=Q.loop_count,k=[Q.canvas_height],b=[Q.canvas_width];for(var we=0;we<se.length&&se[we].blend!=0;we++);}var Be=se[0],$e=$.WebPDecodeRGBA(H,Be.src_off,Be.src_size,b,k);Be.rgba=$e,Be.imgwidth=b[0],Be.imgheight=k[0];for(var Ue=0;Ue<b[0]*k[0]*4;Ue++)T[Ue]=$e[Ue];return this.width=b,this.height=k,this.data=T,this}(function(e){var t=function(){return typeof Df=="function"},n=function(k,b,T,$){var H=4,I=u;switch($){case e.image_compression.FAST:H=1,I=a;break;case e.image_compression.MEDIUM:H=6,I=d;break;case e.image_compression.SLOW:H=9,I=f}k=i(k,b,T,I);var Q=Df(k,{level:H});return e.__addimage__.arrayBufferToBinaryString(Q)},i=function(k,b,T,$){for(var H,I,Q,se=k.length/b,we=new Uint8Array(k.length+se),Be=y(),$e=0;$e<se;$e+=1){if(Q=$e*b,H=k.subarray(Q,Q+b),$)we.set($(H,T,I),Q+$e);else{for(var Ue,Pe=Be.length,Te=[];Ue<Pe;Ue+=1)Te[Ue]=Be[Ue](H,T,I);var He=x(Te.concat());we.set(Te[He],Q+$e)}I=H}return we},o=function(k){var b=Array.apply([],k);return b.unshift(0),b},a=function(k,b){var T,$=[],H=k.length;$[0]=1;for(var I=0;I<H;I+=1)T=k[I-b]||0,$[I+1]=k[I]-T+256&255;return $},u=function(k,b,T){var $,H=[],I=k.length;H[0]=2;for(var Q=0;Q<I;Q+=1)$=T&&T[Q]||0,H[Q+1]=k[Q]-$+256&255;return H},d=function(k,b,T){var $,H,I=[],Q=k.length;I[0]=3;for(var se=0;se<Q;se+=1)$=k[se-b]||0,H=T&&T[se]||0,I[se+1]=k[se]+256-($+H>>>1)&255;return I},f=function(k,b,T){var $,H,I,Q,se=[],we=k.length;se[0]=4;for(var Be=0;Be<we;Be+=1)$=k[Be-b]||0,H=T&&T[Be]||0,I=T&&T[Be-b]||0,Q=m($,H,I),se[Be+1]=k[Be]-Q+256&255;return se},m=function(k,b,T){if(k===b&&b===T)return k;var $=Math.abs(b-T),H=Math.abs(k-T),I=Math.abs(k+b-T-T);return $<=H&&$<=I?k:H<=I?b:T},y=function(){return[o,a,u,d,f]},x=function(k){var b=k.map(function(T){return T.reduce(function($,H){return $+Math.abs(H)},0)});return b.indexOf(Math.min.apply(null,b))};e.processPNG=function(k,b,T,$){var H,I,Q,se,we,Be,$e,Ue,Pe,Te,He,ae,re,oe,Y,C=this.decode.FLATE_DECODE,N="";if(this.__addimage__.isArrayBuffer(k)&&(k=new Uint8Array(k)),this.__addimage__.isArrayBufferView(k)){if(k=(Q=new WC(k)).imgData,I=Q.bits,H=Q.colorSpace,we=Q.colors,[4,6].indexOf(Q.colorType)!==-1){if(Q.bits===8){Pe=(Ue=Q.pixelBitlength==32?new Uint32Array(Q.decodePixels().buffer):Q.pixelBitlength==16?new Uint16Array(Q.decodePixels().buffer):new Uint8Array(Q.decodePixels().buffer)).length,He=new Uint8Array(Pe*Q.colors),Te=new Uint8Array(Pe);var K,J=Q.pixelBitlength-Q.bits;for(oe=0,Y=0;oe<Pe;oe++){for(re=Ue[oe],K=0;K<J;)He[Y++]=re>>>K&255,K+=Q.bits;Te[oe]=re>>>K&255}}if(Q.bits===16){Pe=(Ue=new Uint32Array(Q.decodePixels().buffer)).length,He=new Uint8Array(Pe*(32/Q.pixelBitlength)*Q.colors),Te=new Uint8Array(Pe*(32/Q.pixelBitlength)),ae=Q.colors>1,oe=0,Y=0;for(var Ee=0;oe<Pe;)re=Ue[oe++],He[Y++]=re>>>0&255,ae&&(He[Y++]=re>>>16&255,re=Ue[oe++],He[Y++]=re>>>0&255),Te[Ee++]=re>>>16&255;I=8}$!==e.image_compression.NONE&&t()?(k=n(He,Q.width*Q.colors,Q.colors,$),$e=n(Te,Q.width,1,$)):(k=He,$e=Te,C=void 0)}if(Q.colorType===3&&(H=this.color_spaces.INDEXED,Be=Q.palette,Q.transparency.indexed)){var ue=Q.transparency.indexed,ye=0;for(oe=0,Pe=ue.length;oe<Pe;++oe)ye+=ue[oe];if((ye/=255)===Pe-1&&ue.indexOf(0)!==-1)se=[ue.indexOf(0)];else if(ye!==Pe){for(Ue=Q.decodePixels(),Te=new Uint8Array(Ue.length),oe=0,Pe=Ue.length;oe<Pe;oe++)Te[oe]=ue[Ue[oe]];$e=n(Te,Q.width,1)}}var O=function(ie){var le;switch(ie){case e.image_compression.FAST:le=11;break;case e.image_compression.MEDIUM:le=13;break;case e.image_compression.SLOW:le=14;break;default:le=12}return le}($);return C===this.decode.FLATE_DECODE&&(N="/Predictor "+O+" "),N+="/Colors "+we+" /BitsPerComponent "+I+" /Columns "+Q.width,(this.__addimage__.isArrayBuffer(k)||this.__addimage__.isArrayBufferView(k))&&(k=this.__addimage__.arrayBufferToBinaryString(k)),($e&&this.__addimage__.isArrayBuffer($e)||this.__addimage__.isArrayBufferView($e))&&($e=this.__addimage__.arrayBufferToBinaryString($e)),{alias:T,data:k,index:b,filter:C,decodeParameters:N,transparency:se,palette:Be,sMask:$e,predictor:O,width:Q.width,height:Q.height,bitsPerComponent:I,colorSpace:H}}}})(Cn.API),function(e){e.processGIF89A=function(t,n,i,o){var a=new ZC(t),u=a.width,d=a.height,f=[];a.decodeAndBlitFrameRGBA(0,f);var m={data:f,width:u,height:d},y=new ef(100).encode(m,100);return e.processJPEG.call(this,y,n,i,o)},e.processGIF87A=e.processGIF89A}(Cn.API),Jo.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var t=0;t<e;t++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:o,green:i,blue:n,quad:a}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Jo.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[e]()}catch(n){Li.log("bit decode error:"+n)}},Jo.prototype.bit1=function(){var e,t=Math.ceil(this.width/8),n=t%4;for(e=this.height-1;e>=0;e--){for(var i=this.bottom_up?e:this.height-1-e,o=0;o<t;o++)for(var a=this.datav.getUint8(this.pos++,!0),u=i*this.width*4+8*o*4,d=0;d<8&&8*o+d<this.width;d++){var f=this.palette[a>>7-d&1];this.data[u+4*d]=f.blue,this.data[u+4*d+1]=f.green,this.data[u+4*d+2]=f.red,this.data[u+4*d+3]=255}n!==0&&(this.pos+=4-n)}},Jo.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),t=e%4,n=this.height-1;n>=0;n--){for(var i=this.bottom_up?n:this.height-1-n,o=0;o<e;o++){var a=this.datav.getUint8(this.pos++,!0),u=i*this.width*4+2*o*4,d=a>>4,f=15&a,m=this.palette[d];if(this.data[u]=m.blue,this.data[u+1]=m.green,this.data[u+2]=m.red,this.data[u+3]=255,2*o+1>=this.width)break;m=this.palette[f],this.data[u+4]=m.blue,this.data[u+4+1]=m.green,this.data[u+4+2]=m.red,this.data[u+4+3]=255}t!==0&&(this.pos+=4-t)}},Jo.prototype.bit8=function(){for(var e=this.width%4,t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,i=0;i<this.width;i++){var o=this.datav.getUint8(this.pos++,!0),a=n*this.width*4+4*i;if(o<this.palette.length){var u=this.palette[o];this.data[a]=u.red,this.data[a+1]=u.green,this.data[a+2]=u.blue,this.data[a+3]=255}else this.data[a]=255,this.data[a+1]=255,this.data[a+2]=255,this.data[a+3]=255}e!==0&&(this.pos+=4-e)}},Jo.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),n=this.height-1;n>=0;n--){for(var i=this.bottom_up?n:this.height-1-n,o=0;o<this.width;o++){var a=this.datav.getUint16(this.pos,!0);this.pos+=2;var u=(a&t)/t*255|0,d=(a>>5&t)/t*255|0,f=(a>>10&t)/t*255|0,m=a>>15?255:0,y=i*this.width*4+4*o;this.data[y]=f,this.data[y+1]=d,this.data[y+2]=u,this.data[y+3]=m}this.pos+=e}},Jo.prototype.bit16=function(){for(var e=this.width%3,t=parseInt("11111",2),n=parseInt("111111",2),i=this.height-1;i>=0;i--){for(var o=this.bottom_up?i:this.height-1-i,a=0;a<this.width;a++){var u=this.datav.getUint16(this.pos,!0);this.pos+=2;var d=(u&t)/t*255|0,f=(u>>5&n)/n*255|0,m=(u>>11)/t*255|0,y=o*this.width*4+4*a;this.data[y]=m,this.data[y+1]=f,this.data[y+2]=d,this.data[y+3]=255}this.pos+=e}},Jo.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var i=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),u=t*this.width*4+4*n;this.data[u]=a,this.data[u+1]=o,this.data[u+2]=i,this.data[u+3]=255}this.pos+=this.width%4}},Jo.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var i=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),u=this.datav.getUint8(this.pos++,!0),d=t*this.width*4+4*n;this.data[d]=a,this.data[d+1]=o,this.data[d+2]=i,this.data[d+3]=u}},Jo.prototype.getData=function(){return this.data},function(e){e.processBMP=function(t,n,i,o){var a=new Jo(t,!1),u=a.width,d=a.height,f={data:a.getData(),width:u,height:d},m=new ef(100).encode(f,100);return e.processJPEG.call(this,m,n,i,o)}}(Cn.API),Cg.prototype.getData=function(){return this.data},function(e){e.processWEBP=function(t,n,i,o){var a=new Cg(t),u=a.width,d=a.height,f={data:a.getData(),width:u,height:d},m=new ef(100).encode(f,100);return e.processJPEG.call(this,m,n,i,o)}}(Cn.API),Cn.API.processRGBA=function(e,t,n){for(var i=e.data,o=i.length,a=new Uint8Array(o/4*3),u=new Uint8Array(o/4),d=0,f=0,m=0;m<o;m+=4){var y=i[m],x=i[m+1],k=i[m+2],b=i[m+3];a[d++]=y,a[d++]=x,a[d++]=k,u[f++]=b}var T=this.__addimage__.arrayBufferToBinaryString(a);return{alpha:this.__addimage__.arrayBufferToBinaryString(u),data:T,index:t,alias:n,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},Cn.API.setLanguage=function(e){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]!==void 0&&(this.internal.languageSettings.languageCode=e,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Lu=Cn.API,lh=Lu.getCharWidthsArray=function(e,t){var n,i,o=(t=t||{}).font||this.internal.getFont(),a=t.fontSize||this.internal.getFontSize(),u=t.charSpace||this.internal.getCharSpace(),d=t.widths?t.widths:o.metadata.Unicode.widths,f=d.fof?d.fof:1,m=t.kerning?t.kerning:o.metadata.Unicode.kerning,y=m.fof?m.fof:1,x=t.doKerning!==!1,k=0,b=e.length,T=0,$=d[0]||f,H=[];for(n=0;n<b;n++)i=e.charCodeAt(n),typeof o.metadata.widthOfString=="function"?H.push((o.metadata.widthOfGlyph(o.metadata.characterToGlyph(i))+u*(1e3/a)||0)/1e3):(k=x&&yi(m[i])==="object"&&!isNaN(parseInt(m[i][T],10))?m[i][T]/y:0,H.push((d[i]||$)/f+k)),T=i;return H},bg=Lu.getStringUnitWidth=function(e,t){var n=(t=t||{}).fontSize||this.internal.getFontSize(),i=t.font||this.internal.getFont(),o=t.charSpace||this.internal.getCharSpace();return Lu.processArabic&&(e=Lu.processArabic(e)),typeof i.metadata.widthOfString=="function"?i.metadata.widthOfString(e,n,o)/n:lh.apply(this,arguments).reduce(function(a,u){return a+u},0)},wg=function(e,t,n,i){for(var o=[],a=0,u=e.length,d=0;a!==u&&d+t[a]<n;)d+=t[a],a++;o.push(e.slice(0,a));var f=a;for(d=0;a!==u;)d+t[a]>i&&(o.push(e.slice(f,a)),d=0,f=a),d+=t[a],a++;return f!==a&&o.push(e.slice(f,a)),o},xg=function(e,t,n){n||(n={});var i,o,a,u,d,f,m,y=[],x=[y],k=n.textIndent||0,b=0,T=0,$=e.split(" "),H=lh.apply(this,[" ",n])[0];if(f=n.lineIndent===-1?$[0].length+2:n.lineIndent||0){var I=Array(f).join(" "),Q=[];$.map(function(we){(we=we.split(/\s*\n/)).length>1?Q=Q.concat(we.map(function(Be,$e){return($e&&Be.length?`
`:"")+Be})):Q.push(we[0])}),$=Q,f=bg.apply(this,[I,n])}for(a=0,u=$.length;a<u;a++){var se=0;if(i=$[a],f&&i[0]==`
`&&(i=i.substr(1),se=1),k+b+(T=(o=lh.apply(this,[i,n])).reduce(function(we,Be){return we+Be},0))>t||se){if(T>t){for(d=wg.apply(this,[i,o,t-(k+b),t]),y.push(d.shift()),y=[d.pop()];d.length;)x.push([d.shift()]);T=o.slice(i.length-(y[0]?y[0].length:0)).reduce(function(we,Be){return we+Be},0)}else y=[i];x.push(y),k=T+f,b=H}else y.push(i),k+=b+T,b=H}return m=f?function(we,Be){return(Be?I:"")+we.join(" ")}:function(we){return we.join(" ")},x.map(m)},Lu.splitTextToSize=function(e,t,n){var i,o=(n=n||{}).fontSize||this.internal.getFontSize(),a=(function(y){if(y.widths&&y.kerning)return{widths:y.widths,kerning:y.kerning};var x=this.internal.getFont(y.fontName,y.fontStyle);return x.metadata.Unicode?{widths:x.metadata.Unicode.widths||{0:1},kerning:x.metadata.Unicode.kerning||{}}:{font:x.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,n);i=Array.isArray(e)?e:String(e).split(/\r?\n/);var u=1*this.internal.scaleFactor*t/o;a.textIndent=n.textIndent?1*n.textIndent*this.internal.scaleFactor/o:0,a.lineIndent=n.lineIndent;var d,f,m=[];for(d=0,f=i.length;d<f;d++)m=m.concat(xg.apply(this,[i[d],u,a]));return m},function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var t="klmnopqrstuvwxyz",n={},i={},o=0;o<t.length;o++)n[t[o]]="0123456789abcdef"[o],i["0123456789abcdef"[o]]=t[o];var a=function(x){return"0x"+parseInt(x,10).toString(16)},u=e.__fontmetrics__.compress=function(x){var k,b,T,$,H=["{"];for(var I in x){if(k=x[I],isNaN(parseInt(I,10))?b="'"+I+"'":(I=parseInt(I,10),b=(b=a(I).slice(2)).slice(0,-1)+i[b.slice(-1)]),typeof k=="number")k<0?(T=a(k).slice(3),$="-"):(T=a(k).slice(2),$=""),T=$+T.slice(0,-1)+i[T.slice(-1)];else{if(yi(k)!=="object")throw new Error("Don't know what to do with value type "+yi(k)+".");T=u(k)}H.push(b+T)}return H.push("}"),H.join("")},d=e.__fontmetrics__.uncompress=function(x){if(typeof x!="string")throw new Error("Invalid argument passed to uncompress.");for(var k,b,T,$,H={},I=1,Q=H,se=[],we="",Be="",$e=x.length-1,Ue=1;Ue<$e;Ue+=1)($=x[Ue])=="'"?k?(T=k.join(""),k=void 0):k=[]:k?k.push($):$=="{"?(se.push([Q,T]),Q={},T=void 0):$=="}"?((b=se.pop())[0][b[1]]=Q,T=void 0,Q=b[0]):$=="-"?I=-1:T===void 0?n.hasOwnProperty($)?(we+=n[$],T=parseInt(we,16)*I,I=1,we=""):we+=$:n.hasOwnProperty($)?(Be+=n[$],Q[T]=parseInt(Be,16)*I,I=1,T=void 0,Be=""):Be+=$;return H},f={codePages:["WinAnsiEncoding"],WinAnsiEncoding:d("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},m={Unicode:{Courier:f,"Courier-Bold":f,"Courier-BoldOblique":f,"Courier-Oblique":f,Helvetica:f,"Helvetica-Bold":f,"Helvetica-BoldOblique":f,"Helvetica-Oblique":f,"Times-Roman":f,"Times-Bold":f,"Times-BoldItalic":f,"Times-Italic":f}},y={Unicode:{"Courier-Oblique":d("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":d("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":d("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:d("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":d("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":d("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:d("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:d("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":d("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:d("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":d("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":d("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":d("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":d("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(x){var k=x.font,b=y.Unicode[k.postScriptName];b&&(k.metadata.Unicode={},k.metadata.Unicode.widths=b.widths,k.metadata.Unicode.kerning=b.kerning);var T=m.Unicode[k.postScriptName];T&&(k.metadata.Unicode.encoding=T,k.encoding=T.codePages[0])}])}(Cn.API),function(e){var t=function(n){for(var i=n.length,o=new Uint8Array(i),a=0;a<i;a++)o[a]=n.charCodeAt(a);return o};e.API.events.push(["addFont",function(n){var i=void 0,o=n.font,a=n.instance;if(!o.isStandardFont){if(a===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+o.postScriptName+"').");if(typeof(i=a.existsFileInVFS(o.postScriptName)===!1?a.loadFile(o.postScriptName):a.getFileFromVFS(o.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+o.postScriptName+"').");(function(u,d){d=/^\x00\x01\x00\x00/.test(d)?t(d):t(wc(d)),u.metadata=e.API.TTFFont.open(d),u.metadata.Unicode=u.metadata.Unicode||{encoding:{},kerning:{},widths:[]},u.metadata.glyIdsUsed=[0]})(o,i)}}])}(Cn),function(e){function t(){return(Sn.canvg?Promise.resolve(Sn.canvg):Ql(()=>import("./index.es.js"),[])).catch(function(n){return Promise.reject(new Error("Could not load canvg: "+n))}).then(function(n){return n.default?n.default:n})}Cn.API.addSvgAsImage=function(n,i,o,a,u,d,f,m){if(isNaN(i)||isNaN(o))throw Li.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(a)||isNaN(u))throw Li.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var y=document.createElement("canvas");y.width=a,y.height=u;var x=y.getContext("2d");x.fillStyle="#fff",x.fillRect(0,0,y.width,y.height);var k={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},b=this;return t().then(function(T){return T.fromString(x,n,k)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(T){return T.render(k)}).then(function(){b.addImage(y.toDataURL("image/jpeg",1),i,o,a,u,f,m)})}}(),Cn.API.putTotalPages=function(e){var t,n=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(e,"g"),n=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),n=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var i=1;i<=this.internal.getNumberOfPages();i++)for(var o=0;o<this.internal.pages[i].length;o++)this.internal.pages[i][o]=this.internal.pages[i][o].replace(t,n);return this},Cn.API.viewerPreferences=function(e,t){var n;e=e||{},t=t||!1;var i,o,a,u={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},d=Object.keys(u),f=[],m=0,y=0,x=0;function k(T,$){var H,I=!1;for(H=0;H<T.length;H+=1)T[H]===$&&(I=!0);return I}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(u)),this.internal.viewerpreferences.isSubscribed=!1),n=this.internal.viewerpreferences.configuration,e==="reset"||t===!0){var b=d.length;for(x=0;x<b;x+=1)n[d[x]].value=n[d[x]].defaultValue,n[d[x]].explicitSet=!1}if(yi(e)==="object"){for(o in e)if(a=e[o],k(d,o)&&a!==void 0){if(n[o].type==="boolean"&&typeof a=="boolean")n[o].value=a;else if(n[o].type==="name"&&k(n[o].valueSet,a))n[o].value=a;else if(n[o].type==="integer"&&Number.isInteger(a))n[o].value=a;else if(n[o].type==="array"){for(m=0;m<a.length;m+=1)if(i=!0,a[m].length===1&&typeof a[m][0]=="number")f.push(String(a[m]-1));else if(a[m].length>1){for(y=0;y<a[m].length;y+=1)typeof a[m][y]!="number"&&(i=!1);i===!0&&f.push([a[m][0]-1,a[m][1]-1].join(" "))}n[o].value="["+f.join(" ")+"]"}else n[o].value=n[o].defaultValue;n[o].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var T,$=[];for(T in n)n[T].explicitSet===!0&&(n[T].type==="name"?$.push("/"+T+" /"+n[T].value):$.push("/"+T+" "+n[T].value));$.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+$.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=n,this},function(e){var t=function(){var i='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',o=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),a=unescape(encodeURIComponent(i)),u=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),d=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),f=unescape(encodeURIComponent("</x:xmpmeta>")),m=a.length+u.length+d.length+o.length+f.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+m+" >>"),this.internal.write("stream"),this.internal.write(o+a+u+d+f),this.internal.write("endstream"),this.internal.write("endobj")},n=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};e.addMetadata=function(i,o){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:i,namespaceuri:o||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",n),this.internal.events.subscribe("postPutResources",t)),this}}(Cn.API),function(e){var t=e.API,n=t.pdfEscape16=function(a,u){for(var d,f=u.metadata.Unicode.widths,m=["","0","00","000","0000"],y=[""],x=0,k=a.length;x<k;++x){if(d=u.metadata.characterToGlyph(a.charCodeAt(x)),u.metadata.glyIdsUsed.push(d),u.metadata.toUnicode[d]=a.charCodeAt(x),f.indexOf(d)==-1&&(f.push(d),f.push([parseInt(u.metadata.widthOfGlyph(d),10)])),d=="0")return y.join("");d=d.toString(16),y.push(m[4-d.length],d)}return y.join("")},i=function(a){var u,d,f,m,y,x,k;for(y=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,f=[],x=0,k=(d=Object.keys(a).sort(function(b,T){return b-T})).length;x<k;x++)u=d[x],f.length>=100&&(y+=`
`+f.length+` beginbfchar
`+f.join(`
`)+`
endbfchar`,f=[]),a[u]!==void 0&&a[u]!==null&&typeof a[u].toString=="function"&&(m=("0000"+a[u].toString(16)).slice(-4),u=("0000"+(+u).toString(16)).slice(-4),f.push("<"+u+"><"+m+">"));return f.length&&(y+=`
`+f.length+` beginbfchar
`+f.join(`
`)+`
endbfchar
`),y+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(a){(function(u){var d=u.font,f=u.out,m=u.newObject,y=u.putStream;if(d.metadata instanceof e.API.TTFFont&&d.encoding==="Identity-H"){for(var x=d.metadata.Unicode.widths,k=d.metadata.subset.encode(d.metadata.glyIdsUsed,1),b="",T=0;T<k.length;T++)b+=String.fromCharCode(k[T]);var $=m();y({data:b,addLength1:!0,objectId:$}),f("endobj");var H=m();y({data:i(d.metadata.toUnicode),addLength1:!0,objectId:H}),f("endobj");var I=m();f("<<"),f("/Type /FontDescriptor"),f("/FontName /"+Au(d.fontName)),f("/FontFile2 "+$+" 0 R"),f("/FontBBox "+e.API.PDFObject.convert(d.metadata.bbox)),f("/Flags "+d.metadata.flags),f("/StemV "+d.metadata.stemV),f("/ItalicAngle "+d.metadata.italicAngle),f("/Ascent "+d.metadata.ascender),f("/Descent "+d.metadata.decender),f("/CapHeight "+d.metadata.capHeight),f(">>"),f("endobj");var Q=m();f("<<"),f("/Type /Font"),f("/BaseFont /"+Au(d.fontName)),f("/FontDescriptor "+I+" 0 R"),f("/W "+e.API.PDFObject.convert(x)),f("/CIDToGIDMap /Identity"),f("/DW 1000"),f("/Subtype /CIDFontType2"),f("/CIDSystemInfo"),f("<<"),f("/Supplement 0"),f("/Registry (Adobe)"),f("/Ordering ("+d.encoding+")"),f(">>"),f(">>"),f("endobj"),d.objectNumber=m(),f("<<"),f("/Type /Font"),f("/Subtype /Type0"),f("/ToUnicode "+H+" 0 R"),f("/BaseFont /"+Au(d.fontName)),f("/Encoding /"+d.encoding),f("/DescendantFonts ["+Q+" 0 R]"),f(">>"),f("endobj"),d.isAlreadyPutted=!0}})(a)}]),t.events.push(["putFont",function(a){(function(u){var d=u.font,f=u.out,m=u.newObject,y=u.putStream;if(d.metadata instanceof e.API.TTFFont&&d.encoding==="WinAnsiEncoding"){for(var x=d.metadata.rawData,k="",b=0;b<x.length;b++)k+=String.fromCharCode(x[b]);var T=m();y({data:k,addLength1:!0,objectId:T}),f("endobj");var $=m();y({data:i(d.metadata.toUnicode),addLength1:!0,objectId:$}),f("endobj");var H=m();f("<<"),f("/Descent "+d.metadata.decender),f("/CapHeight "+d.metadata.capHeight),f("/StemV "+d.metadata.stemV),f("/Type /FontDescriptor"),f("/FontFile2 "+T+" 0 R"),f("/Flags 96"),f("/FontBBox "+e.API.PDFObject.convert(d.metadata.bbox)),f("/FontName /"+Au(d.fontName)),f("/ItalicAngle "+d.metadata.italicAngle),f("/Ascent "+d.metadata.ascender),f(">>"),f("endobj"),d.objectNumber=m();for(var I=0;I<d.metadata.hmtx.widths.length;I++)d.metadata.hmtx.widths[I]=parseInt(d.metadata.hmtx.widths[I]*(1e3/d.metadata.head.unitsPerEm));f("<</Subtype/TrueType/Type/Font/ToUnicode "+$+" 0 R/BaseFont/"+Au(d.fontName)+"/FontDescriptor "+H+" 0 R/Encoding/"+d.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(d.metadata.hmtx.widths)+">>"),f("endobj"),d.isAlreadyPutted=!0}})(a)}]);var o=function(a){var u,d=a.text||"",f=a.x,m=a.y,y=a.options||{},x=a.mutex||{},k=x.pdfEscape,b=x.activeFontKey,T=x.fonts,$=b,H="",I=0,Q="",se=T[$].encoding;if(T[$].encoding!=="Identity-H")return{text:d,x:f,y:m,options:y,mutex:x};for(Q=d,$=b,Array.isArray(d)&&(Q=d[0]),I=0;I<Q.length;I+=1)T[$].metadata.hasOwnProperty("cmap")&&(u=T[$].metadata.cmap.unicode.codeMap[Q[I].charCodeAt(0)]),u||Q[I].charCodeAt(0)<256&&T[$].metadata.hasOwnProperty("Unicode")?H+=Q[I]:H+="";var we="";return parseInt($.slice(1))<14||se==="WinAnsiEncoding"?we=k(H,$).split("").map(function(Be){return Be.charCodeAt(0).toString(16)}).join(""):se==="Identity-H"&&(we=n(H,T[$])),x.isHex=!0,{text:we,x:f,y:m,options:y,mutex:x}};t.events.push(["postProcessText",function(a){var u=a.text||"",d=[],f={text:u,x:a.x,y:a.y,options:a.options,mutex:a.mutex};if(Array.isArray(u)){var m=0;for(m=0;m<u.length;m+=1)Array.isArray(u[m])&&u[m].length===3?d.push([o(Object.assign({},f,{text:u[m][0]})).text,u[m][1],u[m][2]]):d.push(o(Object.assign({},f,{text:u[m]})).text);a.text=d}else a.text=o(Object.assign({},f,{text:u})).text}])}(Cn),function(e){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(n){return t.call(this),this.internal.vFS[n]!==void 0},e.addFileToVFS=function(n,i){return t.call(this),this.internal.vFS[n]=i,this},e.getFileFromVFS=function(n){return t.call(this),this.internal.vFS[n]!==void 0?this.internal.vFS[n]:null}}(Cn.API),function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(i){var o,a,u,d,f,m,y,x=t,k=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],b=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],T={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},$={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},H=["(",")","(","<",">","<","[","]","[","{","}","{","«","»","«","‹","›","‹","⁅","⁆","⁅","⁽","⁾","⁽","₍","₎","₍","≤","≥","≤","〈","〉","〈","﹙","﹚","﹙","﹛","﹜","﹛","﹝","﹞","﹝","﹤","﹥","﹤"],I=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),Q=!1,se=0;this.__bidiEngine__={};var we=function(ae){var re=ae.charCodeAt(),oe=re>>8,Y=$[oe];return Y!==void 0?x[256*Y+(255&re)]:oe===252||oe===253?"AL":I.test(oe)?"L":oe===8?"R":"N"},Be=function(ae){for(var re,oe=0;oe<ae.length;oe++){if((re=we(ae.charAt(oe)))==="L")return!1;if(re==="R")return!0}return!1},$e=function(ae,re,oe,Y){var C,N,K,J,Ee=re[Y];switch(Ee){case"L":case"R":Q=!1;break;case"N":case"AN":break;case"EN":Q&&(Ee="AN");break;case"AL":Q=!0,Ee="R";break;case"WS":Ee="N";break;case"CS":Y<1||Y+1>=re.length||(C=oe[Y-1])!=="EN"&&C!=="AN"||(N=re[Y+1])!=="EN"&&N!=="AN"?Ee="N":Q&&(N="AN"),Ee=N===C?N:"N";break;case"ES":Ee=(C=Y>0?oe[Y-1]:"B")==="EN"&&Y+1<re.length&&re[Y+1]==="EN"?"EN":"N";break;case"ET":if(Y>0&&oe[Y-1]==="EN"){Ee="EN";break}if(Q){Ee="N";break}for(K=Y+1,J=re.length;K<J&&re[K]==="ET";)K++;Ee=K<J&&re[K]==="EN"?"EN":"N";break;case"NSM":if(u&&!d){for(J=re.length,K=Y+1;K<J&&re[K]==="NSM";)K++;if(K<J){var ue=ae[Y],ye=ue>=1425&&ue<=2303||ue===64286;if(C=re[K],ye&&(C==="R"||C==="AL")){Ee="R";break}}}Ee=Y<1||(C=re[Y-1])==="B"?"N":oe[Y-1];break;case"B":Q=!1,o=!0,Ee=se;break;case"S":a=!0,Ee="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":Q=!1;break;case"BN":Ee="N"}return Ee},Ue=function(ae,re,oe){var Y=ae.split("");return oe&&Pe(Y,oe,{hiLevel:se}),Y.reverse(),re&&re.reverse(),Y.join("")},Pe=function(ae,re,oe){var Y,C,N,K,J,Ee=-1,ue=ae.length,ye=0,O=[],ie=se?b:k,le=[];for(Q=!1,o=!1,a=!1,C=0;C<ue;C++)le[C]=we(ae[C]);for(N=0;N<ue;N++){if(J=ye,O[N]=$e(ae,le,O,N),Y=240&(ye=ie[J][T[O[N]]]),ye&=15,re[N]=K=ie[ye][5],Y>0)if(Y===16){for(C=Ee;C<N;C++)re[C]=1;Ee=-1}else Ee=-1;if(ie[ye][6])Ee===-1&&(Ee=N);else if(Ee>-1){for(C=Ee;C<N;C++)re[C]=K;Ee=-1}le[N]==="B"&&(re[N]=0),oe.hiLevel|=K}a&&function(fe,_e,ee){for(var G=0;G<ee;G++)if(fe[G]==="S"){_e[G]=se;for(var q=G-1;q>=0&&fe[q]==="WS";q--)_e[q]=se}}(le,re,ue)},Te=function(ae,re,oe,Y,C){if(!(C.hiLevel<ae)){if(ae===1&&se===1&&!o)return re.reverse(),void(oe&&oe.reverse());for(var N,K,J,Ee,ue=re.length,ye=0;ye<ue;){if(Y[ye]>=ae){for(J=ye+1;J<ue&&Y[J]>=ae;)J++;for(Ee=ye,K=J-1;Ee<K;Ee++,K--)N=re[Ee],re[Ee]=re[K],re[K]=N,oe&&(N=oe[Ee],oe[Ee]=oe[K],oe[K]=N);ye=J}ye++}}},He=function(ae,re,oe){var Y=ae.split(""),C={hiLevel:se};return oe||(oe=[]),Pe(Y,oe,C),function(N,K,J){if(J.hiLevel!==0&&y)for(var Ee,ue=0;ue<N.length;ue++)K[ue]===1&&(Ee=H.indexOf(N[ue]))>=0&&(N[ue]=H[Ee+1])}(Y,oe,C),Te(2,Y,re,oe,C),Te(1,Y,re,oe,C),Y.join("")};return this.__bidiEngine__.doBidiReorder=function(ae,re,oe){if(function(C,N){if(N)for(var K=0;K<C.length;K++)N[K]=K;d===void 0&&(d=Be(C)),m===void 0&&(m=Be(C))}(ae,re),u||!f||m)if(u&&f&&d^m)se=d?1:0,ae=Ue(ae,re,oe);else if(!u&&f&&m)se=d?1:0,ae=He(ae,re,oe),ae=Ue(ae,re);else if(!u||d||f||m){if(u&&!f&&d^m)ae=Ue(ae,re),d?(se=0,ae=He(ae,re,oe)):(se=1,ae=He(ae,re,oe),ae=Ue(ae,re));else if(u&&d&&!f&&m)se=1,ae=He(ae,re,oe),ae=Ue(ae,re);else if(!u&&!f&&d^m){var Y=y;d?(se=1,ae=He(ae,re,oe),se=0,y=!1,ae=He(ae,re,oe),y=Y):(se=0,ae=He(ae,re,oe),ae=Ue(ae,re),se=1,y=!1,ae=He(ae,re,oe),y=Y,ae=Ue(ae,re))}}else se=0,ae=He(ae,re,oe);else se=d?1:0,ae=He(ae,re,oe);return ae},this.__bidiEngine__.setOptions=function(ae){ae&&(u=ae.isInputVisual,f=ae.isOutputVisual,d=ae.isInputRtl,m=ae.isOutputRtl,y=ae.isSymmetricSwapping)},this.__bidiEngine__.setOptions(i),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],n=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(i){var o=i.text,a=(i.x,i.y,i.options||{}),u=(i.mutex,a.lang,[]);if(a.isInputVisual=typeof a.isInputVisual!="boolean"||a.isInputVisual,n.setOptions(a),Object.prototype.toString.call(o)==="[object Array]"){var d=0;for(u=[],d=0;d<o.length;d+=1)Object.prototype.toString.call(o[d])==="[object Array]"?u.push([n.doBidiReorder(o[d][0]),o[d][1],o[d][2]]):u.push([n.doBidiReorder(o[d])]);i.text=u}else i.text=n.doBidiReorder(o);n.setOptions({isInputVisual:!0})}])}(Cn),Cn.API.TTFFont=function(){function e(t){var n;if(this.rawData=t,n=this.contents=new Rl(t),this.contents.pos=4,n.readString(4)==="ttcf")throw new Error("TTCF not supported.");n.pos=0,this.parse(),this.subset=new uP(this),this.registerTTF()}return e.open=function(t){return new e(t)},e.prototype.parse=function(){return this.directory=new KC(this.contents),this.head=new JC(this),this.name=new nP(this),this.cmap=new uv(this),this.toUnicode={},this.hhea=new XC(this),this.maxp=new iP(this),this.hmtx=new rP(this),this.post=new eP(this),this.os2=new QC(this),this.loca=new lP(this),this.glyf=new sP(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var t,n,i,o,a;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var u,d,f,m;for(m=[],u=0,d=(f=this.bbox).length;u<d;u++)t=f[u],m.push(Math.round(t*this.scaleFactor));return m}).call(this),this.stemV=0,this.post.exists?(i=255&(o=this.post.italic_angle),32768&(n=o>>16)&&(n=-(1+(65535^n))),this.italicAngle=+(n+"."+i)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(a=this.familyClass)===1||a===2||a===3||a===4||a===5||a===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(t){var n;return((n=this.cmap.unicode)!=null?n.codeMap[t]:void 0)||0},e.prototype.widthOfGlyph=function(t){var n;return n=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*n},e.prototype.widthOfString=function(t,n,i){var o,a,u,d;for(u=0,a=0,d=(t=""+t).length;0<=d?a<d:a>d;a=0<=d?++a:--a)o=t.charCodeAt(a),u+=this.widthOfGlyph(this.characterToGlyph(o))+i*(1e3/n)||0;return u*(n/1e3)},e.prototype.lineHeight=function(t,n){var i;return n==null&&(n=!1),i=n?this.lineGap:0,(this.ascender+i-this.decender)/1e3*t},e}();var la,Rl=function(){function e(t){this.data=t??[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(t){return this.data[this.pos++]=t},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},e.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},e.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},e.prototype.readString=function(t){var n,i;for(i=[],n=0;0<=t?n<t:n>t;n=0<=t?++n:--n)i[n]=String.fromCharCode(this.readByte());return i.join("")},e.prototype.writeString=function(t){var n,i,o;for(o=[],n=0,i=t.length;0<=i?n<i:n>i;n=0<=i?++n:--n)o.push(this.writeByte(t.charCodeAt(n)));return o},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(t){return this.writeInt16(t)},e.prototype.readLongLong=function(){var t,n,i,o,a,u,d,f;return t=this.readByte(),n=this.readByte(),i=this.readByte(),o=this.readByte(),a=this.readByte(),u=this.readByte(),d=this.readByte(),f=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^n)+1099511627776*(255^i)+4294967296*(255^o)+16777216*(255^a)+65536*(255^u)+256*(255^d)+(255^f)+1):72057594037927940*t+281474976710656*n+1099511627776*i+4294967296*o+16777216*a+65536*u+256*d+f},e.prototype.writeLongLong=function(t){var n,i;return n=Math.floor(t/4294967296),i=4294967295&t,this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n),this.writeByte(i>>24&255),this.writeByte(i>>16&255),this.writeByte(i>>8&255),this.writeByte(255&i)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(t){return this.writeInt32(t)},e.prototype.read=function(t){var n,i;for(n=[],i=0;0<=t?i<t:i>t;i=0<=t?++i:--i)n.push(this.readByte());return n},e.prototype.write=function(t){var n,i,o,a;for(a=[],i=0,o=t.length;i<o;i++)n=t[i],a.push(this.writeByte(n));return a},e}(),KC=function(){var e;function t(n){var i,o,a;for(this.scalarType=n.readInt(),this.tableCount=n.readShort(),this.searchRange=n.readShort(),this.entrySelector=n.readShort(),this.rangeShift=n.readShort(),this.tables={},o=0,a=this.tableCount;0<=a?o<a:o>a;o=0<=a?++o:--o)i={tag:n.readString(4),checksum:n.readInt(),offset:n.readInt(),length:n.readInt()},this.tables[i.tag]=i}return t.prototype.encode=function(n){var i,o,a,u,d,f,m,y,x,k,b,T,$;for($ in b=Object.keys(n).length,f=Math.log(2),x=16*Math.floor(Math.log(b)/f),u=Math.floor(x/f),y=16*b-x,(o=new Rl).writeInt(this.scalarType),o.writeShort(b),o.writeShort(x),o.writeShort(u),o.writeShort(y),a=16*b,m=o.pos+a,d=null,T=[],n)for(k=n[$],o.writeString($),o.writeInt(e(k)),o.writeInt(m),o.writeInt(k.length),T=T.concat(k),$==="head"&&(d=m),m+=k.length;m%4;)T.push(0),m++;return o.write(T),i=2981146554-e(o.data),o.pos=d+8,o.writeUInt32(i),o.data},e=function(n){var i,o,a,u;for(n=cv.call(n);n.length%4;)n.push(0);for(a=new Rl(n),o=0,i=0,u=n.length;i<u;i=i+=4)o+=a.readUInt32();return 4294967295&o},t}(),YC={}.hasOwnProperty,Na=function(e,t){for(var n in t)YC.call(t,n)&&(e[n]=t[n]);function i(){this.constructor=e}return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};la=function(){function e(t){var n;this.file=t,n=this.file.directory.tables[this.tag],this.exists=!!n,n&&(this.offset=n.offset,this.length=n.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var JC=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Na(t,la),t.prototype.tag="head",t.prototype.parse=function(n){return n.pos=this.offset,this.version=n.readInt(),this.revision=n.readInt(),this.checkSumAdjustment=n.readInt(),this.magicNumber=n.readInt(),this.flags=n.readShort(),this.unitsPerEm=n.readShort(),this.created=n.readLongLong(),this.modified=n.readLongLong(),this.xMin=n.readShort(),this.yMin=n.readShort(),this.xMax=n.readShort(),this.yMax=n.readShort(),this.macStyle=n.readShort(),this.lowestRecPPEM=n.readShort(),this.fontDirectionHint=n.readShort(),this.indexToLocFormat=n.readShort(),this.glyphDataFormat=n.readShort()},t.prototype.encode=function(n){var i;return(i=new Rl).writeInt(this.version),i.writeInt(this.revision),i.writeInt(this.checkSumAdjustment),i.writeInt(this.magicNumber),i.writeShort(this.flags),i.writeShort(this.unitsPerEm),i.writeLongLong(this.created),i.writeLongLong(this.modified),i.writeShort(this.xMin),i.writeShort(this.yMin),i.writeShort(this.xMax),i.writeShort(this.yMax),i.writeShort(this.macStyle),i.writeShort(this.lowestRecPPEM),i.writeShort(this.fontDirectionHint),i.writeShort(n),i.writeShort(this.glyphDataFormat),i.data},t}(),Pg=function(){function e(t,n){var i,o,a,u,d,f,m,y,x,k,b,T,$,H,I,Q,se;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=n+t.readInt(),x=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(f=0;f<256;++f)this.codeMap[f]=t.readByte();break;case 4:for(b=t.readUInt16(),k=b/2,t.pos+=6,a=function(){var we,Be;for(Be=[],f=we=0;0<=k?we<k:we>k;f=0<=k?++we:--we)Be.push(t.readUInt16());return Be}(),t.pos+=2,$=function(){var we,Be;for(Be=[],f=we=0;0<=k?we<k:we>k;f=0<=k?++we:--we)Be.push(t.readUInt16());return Be}(),m=function(){var we,Be;for(Be=[],f=we=0;0<=k?we<k:we>k;f=0<=k?++we:--we)Be.push(t.readUInt16());return Be}(),y=function(){var we,Be;for(Be=[],f=we=0;0<=k?we<k:we>k;f=0<=k?++we:--we)Be.push(t.readUInt16());return Be}(),o=(this.length-t.pos+this.offset)/2,d=function(){var we,Be;for(Be=[],f=we=0;0<=o?we<o:we>o;f=0<=o?++we:--we)Be.push(t.readUInt16());return Be}(),f=I=0,se=a.length;I<se;f=++I)for(H=a[f],i=Q=T=$[f];T<=H?Q<=H:Q>=H;i=T<=H?++Q:--Q)y[f]===0?u=i+m[f]:(u=d[y[f]/2+(i-T)-(k-f)]||0)!==0&&(u+=m[f]),this.codeMap[i]=65535&u}t.pos=x}return e.encode=function(t,n){var i,o,a,u,d,f,m,y,x,k,b,T,$,H,I,Q,se,we,Be,$e,Ue,Pe,Te,He,ae,re,oe,Y,C,N,K,J,Ee,ue,ye,O,ie,le,fe,_e,ee,G,q,de,ce,V;switch(Y=new Rl,u=Object.keys(t).sort(function(Z,F){return Z-F}),n){case"macroman":for($=0,H=function(){var Z=[];for(T=0;T<256;++T)Z.push(0);return Z}(),Q={0:0},a={},C=0,Ee=u.length;C<Ee;C++)Q[q=t[o=u[C]]]==null&&(Q[q]=++$),a[o]={old:t[o],new:Q[t[o]]},H[o]=Q[t[o]];return Y.writeUInt16(1),Y.writeUInt16(0),Y.writeUInt32(12),Y.writeUInt16(0),Y.writeUInt16(262),Y.writeUInt16(0),Y.write(H),{charMap:a,subtable:Y.data,maxGlyphID:$+1};case"unicode":for(re=[],x=[],se=0,Q={},i={},I=m=null,N=0,ue=u.length;N<ue;N++)Q[Be=t[o=u[N]]]==null&&(Q[Be]=++se),i[o]={old:Be,new:Q[Be]},d=Q[Be]-o,I!=null&&d===m||(I&&x.push(I),re.push(o),m=d),I=o;for(I&&x.push(I),x.push(65535),re.push(65535),He=2*(Te=re.length),Pe=2*Math.pow(Math.log(Te)/Math.LN2,2),k=Math.log(Pe/2)/Math.LN2,Ue=2*Te-Pe,f=[],$e=[],b=[],T=K=0,ye=re.length;K<ye;T=++K){if(ae=re[T],y=x[T],ae===65535){f.push(0),$e.push(0);break}if(ae-(oe=i[ae].new)>=32768)for(f.push(0),$e.push(2*(b.length+Te-T)),o=J=ae;ae<=y?J<=y:J>=y;o=ae<=y?++J:--J)b.push(i[o].new);else f.push(oe-ae),$e.push(0)}for(Y.writeUInt16(3),Y.writeUInt16(1),Y.writeUInt32(12),Y.writeUInt16(4),Y.writeUInt16(16+8*Te+2*b.length),Y.writeUInt16(0),Y.writeUInt16(He),Y.writeUInt16(Pe),Y.writeUInt16(k),Y.writeUInt16(Ue),ee=0,O=x.length;ee<O;ee++)o=x[ee],Y.writeUInt16(o);for(Y.writeUInt16(0),G=0,ie=re.length;G<ie;G++)o=re[G],Y.writeUInt16(o);for(de=0,le=f.length;de<le;de++)d=f[de],Y.writeUInt16(d);for(ce=0,fe=$e.length;ce<fe;ce++)we=$e[ce],Y.writeUInt16(we);for(V=0,_e=b.length;V<_e;V++)$=b[V],Y.writeUInt16($);return{charMap:i,subtable:Y.data,maxGlyphID:se+1}}},e}(),uv=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Na(t,la),t.prototype.tag="cmap",t.prototype.parse=function(n){var i,o,a;for(n.pos=this.offset,this.version=n.readUInt16(),a=n.readUInt16(),this.tables=[],this.unicode=null,o=0;0<=a?o<a:o>a;o=0<=a?++o:--o)i=new Pg(n,this.offset),this.tables.push(i),i.isUnicode&&this.unicode==null&&(this.unicode=i);return!0},t.encode=function(n,i){var o,a;return i==null&&(i="macroman"),o=Pg.encode(n,i),(a=new Rl).writeUInt16(0),a.writeUInt16(1),o.table=a.data.concat(o.subtable),o},t}(),XC=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Na(t,la),t.prototype.tag="hhea",t.prototype.parse=function(n){return n.pos=this.offset,this.version=n.readInt(),this.ascender=n.readShort(),this.decender=n.readShort(),this.lineGap=n.readShort(),this.advanceWidthMax=n.readShort(),this.minLeftSideBearing=n.readShort(),this.minRightSideBearing=n.readShort(),this.xMaxExtent=n.readShort(),this.caretSlopeRise=n.readShort(),this.caretSlopeRun=n.readShort(),this.caretOffset=n.readShort(),n.pos+=8,this.metricDataFormat=n.readShort(),this.numberOfMetrics=n.readUInt16()},t}(),QC=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Na(t,la),t.prototype.tag="OS/2",t.prototype.parse=function(n){if(n.pos=this.offset,this.version=n.readUInt16(),this.averageCharWidth=n.readShort(),this.weightClass=n.readUInt16(),this.widthClass=n.readUInt16(),this.type=n.readShort(),this.ySubscriptXSize=n.readShort(),this.ySubscriptYSize=n.readShort(),this.ySubscriptXOffset=n.readShort(),this.ySubscriptYOffset=n.readShort(),this.ySuperscriptXSize=n.readShort(),this.ySuperscriptYSize=n.readShort(),this.ySuperscriptXOffset=n.readShort(),this.ySuperscriptYOffset=n.readShort(),this.yStrikeoutSize=n.readShort(),this.yStrikeoutPosition=n.readShort(),this.familyClass=n.readShort(),this.panose=function(){var i,o;for(o=[],i=0;i<10;++i)o.push(n.readByte());return o}(),this.charRange=function(){var i,o;for(o=[],i=0;i<4;++i)o.push(n.readInt());return o}(),this.vendorID=n.readString(4),this.selection=n.readShort(),this.firstCharIndex=n.readShort(),this.lastCharIndex=n.readShort(),this.version>0&&(this.ascent=n.readShort(),this.descent=n.readShort(),this.lineGap=n.readShort(),this.winAscent=n.readShort(),this.winDescent=n.readShort(),this.codePageRange=function(){var i,o;for(o=[],i=0;i<2;i=++i)o.push(n.readInt());return o}(),this.version>1))return this.xHeight=n.readShort(),this.capHeight=n.readShort(),this.defaultChar=n.readShort(),this.breakChar=n.readShort(),this.maxContext=n.readShort()},t}(),eP=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Na(t,la),t.prototype.tag="post",t.prototype.parse=function(n){var i,o,a;switch(n.pos=this.offset,this.format=n.readInt(),this.italicAngle=n.readInt(),this.underlinePosition=n.readShort(),this.underlineThickness=n.readShort(),this.isFixedPitch=n.readInt(),this.minMemType42=n.readInt(),this.maxMemType42=n.readInt(),this.minMemType1=n.readInt(),this.maxMemType1=n.readInt(),this.format){case 65536:break;case 131072:var u;for(o=n.readUInt16(),this.glyphNameIndex=[],u=0;0<=o?u<o:u>o;u=0<=o?++u:--u)this.glyphNameIndex.push(n.readUInt16());for(this.names=[],a=[];n.pos<this.offset+this.length;)i=n.readByte(),a.push(this.names.push(n.readString(i)));return a;case 151552:return o=n.readUInt16(),this.offsets=n.read(o);case 196608:break;case 262144:return this.map=(function(){var d,f,m;for(m=[],u=d=0,f=this.file.maxp.numGlyphs;0<=f?d<f:d>f;u=0<=f?++d:--d)m.push(n.readUInt32());return m}).call(this)}},t}(),tP=function(e,t){this.raw=e,this.length=e.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},nP=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Na(t,la),t.prototype.tag="name",t.prototype.parse=function(n){var i,o,a,u,d,f,m,y,x,k,b;for(n.pos=this.offset,n.readShort(),i=n.readShort(),f=n.readShort(),o=[],u=0;0<=i?u<i:u>i;u=0<=i?++u:--u)o.push({platformID:n.readShort(),encodingID:n.readShort(),languageID:n.readShort(),nameID:n.readShort(),length:n.readShort(),offset:this.offset+f+n.readShort()});for(m={},u=x=0,k=o.length;x<k;u=++x)a=o[u],n.pos=a.offset,y=n.readString(a.length),d=new tP(y,a),m[b=a.nameID]==null&&(m[b]=[]),m[a.nameID].push(d);this.strings=m,this.copyright=m[0],this.fontFamily=m[1],this.fontSubfamily=m[2],this.uniqueSubfamily=m[3],this.fontName=m[4],this.version=m[5];try{this.postscriptName=m[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=m[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=m[7],this.manufacturer=m[8],this.designer=m[9],this.description=m[10],this.vendorUrl=m[11],this.designerUrl=m[12],this.license=m[13],this.licenseUrl=m[14],this.preferredFamily=m[15],this.preferredSubfamily=m[17],this.compatibleFull=m[18],this.sampleText=m[19]},t}(),iP=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Na(t,la),t.prototype.tag="maxp",t.prototype.parse=function(n){return n.pos=this.offset,this.version=n.readInt(),this.numGlyphs=n.readUInt16(),this.maxPoints=n.readUInt16(),this.maxContours=n.readUInt16(),this.maxCompositePoints=n.readUInt16(),this.maxComponentContours=n.readUInt16(),this.maxZones=n.readUInt16(),this.maxTwilightPoints=n.readUInt16(),this.maxStorage=n.readUInt16(),this.maxFunctionDefs=n.readUInt16(),this.maxInstructionDefs=n.readUInt16(),this.maxStackElements=n.readUInt16(),this.maxSizeOfInstructions=n.readUInt16(),this.maxComponentElements=n.readUInt16(),this.maxComponentDepth=n.readUInt16()},t}(),rP=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Na(t,la),t.prototype.tag="hmtx",t.prototype.parse=function(n){var i,o,a,u,d,f,m;for(n.pos=this.offset,this.metrics=[],i=0,f=this.file.hhea.numberOfMetrics;0<=f?i<f:i>f;i=0<=f?++i:--i)this.metrics.push({advance:n.readUInt16(),lsb:n.readInt16()});for(a=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var y,x;for(x=[],i=y=0;0<=a?y<a:y>a;i=0<=a?++y:--y)x.push(n.readInt16());return x}(),this.widths=(function(){var y,x,k,b;for(b=[],y=0,x=(k=this.metrics).length;y<x;y++)u=k[y],b.push(u.advance);return b}).call(this),o=this.widths[this.widths.length-1],m=[],i=d=0;0<=a?d<a:d>a;i=0<=a?++d:--d)m.push(this.widths.push(o));return m},t.prototype.forGlyph=function(n){return n in this.metrics?this.metrics[n]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[n-this.metrics.length]}},t}(),cv=[].slice,sP=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Na(t,la),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(n){var i,o,a,u,d,f,m,y,x,k;return n in this.cache?this.cache[n]:(u=this.file.loca,i=this.file.contents,o=u.indexOf(n),(a=u.lengthOf(n))===0?this.cache[n]=null:(i.pos=this.offset+o,d=(f=new Rl(i.read(a))).readShort(),y=f.readShort(),k=f.readShort(),m=f.readShort(),x=f.readShort(),this.cache[n]=d===-1?new aP(f,y,k,m,x):new oP(f,d,y,k,m,x),this.cache[n]))},t.prototype.encode=function(n,i,o){var a,u,d,f,m;for(d=[],u=[],f=0,m=i.length;f<m;f++)a=n[i[f]],u.push(d.length),a&&(d=d.concat(a.encode(o)));return u.push(d.length),{table:d,offsets:u}},t}(),oP=function(){function e(t,n,i,o,a,u){this.raw=t,this.numberOfContours=n,this.xMin=i,this.yMin=o,this.xMax=a,this.yMax=u,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),aP=function(){function e(t,n,i,o,a){var u,d;for(this.raw=t,this.xMin=n,this.yMin=i,this.xMax=o,this.yMax=a,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],u=this.raw;d=u.readShort(),this.glyphOffsets.push(u.pos),this.glyphIDs.push(u.readUInt16()),32&d;)u.pos+=1&d?4:2,128&d?u.pos+=8:64&d?u.pos+=4:8&d&&(u.pos+=2)}return e.prototype.encode=function(){var t,n,i;for(n=new Rl(cv.call(this.raw.data)),t=0,i=this.glyphIDs.length;t<i;++t)n.pos=this.glyphOffsets[t];return n.data},e}(),lP=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Na(t,la),t.prototype.tag="loca",t.prototype.parse=function(n){var i,o;return n.pos=this.offset,i=this.file.head.indexToLocFormat,this.offsets=i===0?(function(){var a,u;for(u=[],o=0,a=this.length;o<a;o+=2)u.push(2*n.readUInt16());return u}).call(this):(function(){var a,u;for(u=[],o=0,a=this.length;o<a;o+=4)u.push(n.readUInt32());return u}).call(this)},t.prototype.indexOf=function(n){return this.offsets[n]},t.prototype.lengthOf=function(n){return this.offsets[n+1]-this.offsets[n]},t.prototype.encode=function(n,i){for(var o=new Uint32Array(this.offsets.length),a=0,u=0,d=0;d<o.length;++d)if(o[d]=a,u<i.length&&i[u]==d){++u,o[d]=a;var f=this.offsets[d],m=this.offsets[d+1]-f;m>0&&(a+=m)}for(var y=new Array(4*o.length),x=0;x<o.length;++x)y[4*x+3]=255&o[x],y[4*x+2]=(65280&o[x])>>8,y[4*x+1]=(16711680&o[x])>>16,y[4*x]=(4278190080&o[x])>>24;return y},t}(),uP=function(){function e(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var t,n,i,o,a;for(n in o=this.font.cmap.tables[0].codeMap,t={},a=this.subset)i=a[n],t[n]=o[i];return t},e.prototype.glyphsFor=function(t){var n,i,o,a,u,d,f;for(o={},u=0,d=t.length;u<d;u++)o[a=t[u]]=this.font.glyf.glyphFor(a);for(a in n=[],o)(i=o[a])!=null&&i.compound&&n.push.apply(n,i.glyphIDs);if(n.length>0)for(a in f=this.glyphsFor(n))i=f[a],o[a]=i;return o},e.prototype.encode=function(t,n){var i,o,a,u,d,f,m,y,x,k,b,T,$,H,I;for(o in i=uv.encode(this.generateCmap(),"unicode"),u=this.glyphsFor(t),b={0:0},I=i.charMap)b[(f=I[o]).old]=f.new;for(T in k=i.maxGlyphID,u)T in b||(b[T]=k++);return y=function(Q){var se,we;for(se in we={},Q)we[Q[se]]=se;return we}(b),x=Object.keys(y).sort(function(Q,se){return Q-se}),$=function(){var Q,se,we;for(we=[],Q=0,se=x.length;Q<se;Q++)d=x[Q],we.push(y[d]);return we}(),a=this.font.glyf.encode(u,$,b),m=this.font.loca.encode(a.offsets,$),H={cmap:this.font.cmap.raw(),glyf:a.table,loca:m,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(n)},this.font.os2.exists&&(H["OS/2"]=this.font.os2.raw()),this.font.directory.encode(H)},e}();Cn.API.PDFObject=function(){var e;function t(){}return e=function(n,i){return(Array(i+1).join("0")+n).slice(-i)},t.convert=function(n){var i,o,a,u;if(Array.isArray(n))return"["+function(){var d,f,m;for(m=[],d=0,f=n.length;d<f;d++)i=n[d],m.push(t.convert(i));return m}().join(" ")+"]";if(typeof n=="string")return"/"+n;if(n!=null&&n.isString)return"("+n+")";if(n instanceof Date)return"(D:"+e(n.getUTCFullYear(),4)+e(n.getUTCMonth(),2)+e(n.getUTCDate(),2)+e(n.getUTCHours(),2)+e(n.getUTCMinutes(),2)+e(n.getUTCSeconds(),2)+"Z)";if({}.toString.call(n)==="[object Object]"){for(o in a=["<<"],n)u=n[o],a.push("/"+o+" "+t.convert(u));return a.push(">>"),a.join(`
`)}return""+n},t}();const cP={class:"h-full flex"},hP={class:"flex-1 relative"},dP={key:0,class:"absolute inset-0 bg-black/30 backdrop-blur-sm z-[2000] flex items-center justify-center"},fP={key:1,class:"absolute inset-0 flex items-center justify-center bg-gray-50 z-[3000]"},pP={class:"text-center max-w-lg mx-auto p-8"},gP={class:"space-y-4"},mP={class:"map-parent"},vP={key:0,class:"z-[3000]"},yP={class:"map-content flex"},_P={class:"flex-1 relative"},bP={key:0,class:"w-64 bg-white border-l border-gray-200 flex-shrink-0 z-[2000]"},wP={key:1,class:"absolute inset-0 flex items-center justify-center bg-white bg-opacity-75 z-50"},xP={key:2,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[3000]"},LP={class:"bg-white rounded-lg p-6 max-w-2xl w-full mx-4"},CP={class:"flex justify-between items-center mb-4"},PP={key:0,class:"space-y-4"},kP={key:0,class:"space-y-2"},EP={class:"grid grid-cols-1 gap-2 max-h-96 overflow-y-auto"},SP=["onClick"],AP={class:"font-medium text-gray-900"},MP={key:1,class:"space-y-2"},BP={class:"flex items-center mb-4"},TP={class:"text-sm text-gray-600"},NP={class:"grid grid-cols-1 gap-2 max-h-96 overflow-y-auto"},DP=["onClick"],RP={class:"font-medium text-gray-900"},OP={key:2,class:"space-y-2"},IP={class:"flex items-center mb-4"},FP={class:"text-sm text-gray-600"},jP={class:"grid grid-cols-1 gap-2 max-h-96 overflow-y-auto"},zP={key:0,class:"text-center py-8"},UP=["onClick"],$P={class:"font-medium text-gray-900"},qP={key:3,class:"space-y-2"},VP={class:"flex items-center mb-4"},GP={class:"text-sm text-gray-600"},HP={class:"grid grid-cols-1 gap-2 max-h-96 overflow-y-auto"},WP=["onClick"],ZP={class:"font-medium text-gray-900"},KP={class:"text-sm text-gray-500"},YP={class:"text-xs text-gray-400 mt-1"},JP={key:1,class:"space-y-4"},XP={key:0,class:"space-y-2"},QP={class:"grid grid-cols-1 gap-2 max-h-96 overflow-y-auto"},ek={key:0,class:"text-center py-8"},tk=["onClick"],nk={class:"font-medium text-gray-900"},ik={key:1,class:"space-y-2"},rk={class:"flex items-center mb-4"},sk={class:"text-sm text-gray-600"},ok={class:"grid grid-cols-1 gap-2 max-h-96 overflow-y-auto"},ak=["onClick"],lk={class:"font-medium text-gray-900"},uk={class:"text-sm text-gray-500"},ck={class:"text-xs text-gray-400 mt-1"},hk={key:2,class:"space-y-4"},dk={key:0,class:"space-y-2"},fk={class:"grid grid-cols-1 gap-2 max-h-96 overflow-y-auto"},pk=["onClick"],gk={class:"font-medium text-gray-900"},mk={key:1,class:"space-y-2"},vk={class:"flex items-center mb-4"},yk={class:"text-sm text-gray-600"},_k={class:"grid grid-cols-1 gap-2 max-h-96 overflow-y-auto"},bk={key:0,class:"text-center py-8"},wk=["onClick"],xk={class:"font-medium text-gray-900"},Lk={key:2,class:"space-y-2"},Ck={class:"flex items-center mb-4"},Pk={class:"text-sm text-gray-600"},kk={class:"grid grid-cols-1 gap-2 max-h-96 overflow-y-auto"},Ek=["onClick"],Sk={class:"font-medium text-gray-900"},Ak={class:"text-sm text-gray-500"},Mk={class:"text-xs text-gray-400 mt-1"},Bk={key:3,class:"max-h-96 overflow-y-auto"},Tk={key:0,class:"text-center py-8"},Nk={key:1,class:"space-y-2"},Dk=["onClick"],Rk={class:"font-medium text-gray-900"},Ok={class:"text-sm text-gray-500"},Ik={class:"text-xs text-gray-400 mt-1"},kg=Hs({__name:"MapView",setup(e){const t=Nt(null),n=cp(),i=$1(),o=Nt([]),{currentTool:a,selectedShape:u,map:d,initMap:f,setDrawingTool:m,updateShapeStyle:y,updateShapeProperties:x,featureGroup:k,adjustView:b,clearActiveControlPoints:T}=UL(),{initMap:$,changeBaseMap:H}=$L(),I=Nt(!1),Q=Nt(!1),se=Nt(null),we=Nt(!1),Be=Nt(null),$e=Es(),Ue=Nt([]),Pe=Nt([]),Te=Nt([]),He=Nt(null),ae=Nt(null),re=Nt(!1),oe=Nt(!1),Y=Nt(!1),C=Nt(null),N=Un(()=>{var lt,Oe;return console.log("[MapView][filteredClients] Computing with:",{userType:(lt=$e.user)==null?void 0:lt.user_type,selectedConcessionnaire:He.value,concessionnaireAgriculteurs:Pe.value,agriculteurCount:((Oe=Pe.value)==null?void 0:Oe.length)||0}),$e.isConcessionnaire||He.value?Pe.value:[]}),K=Un(()=>{var lt;return u.value?{type:((lt=u.value.properties)==null?void 0:lt.type)||"unknown",properties:u.value.properties||{},layer:u.value}:null});function J(lt){const Oe=lt.getCenter(),kt=lt.getZoom(),Et={lat:Oe.lat,lng:Oe.lng,zoom:kt};document.cookie=`mapState=${JSON.stringify(Et)};max-age=2592000;path=/`}function Ee(){const Oe=document.cookie.split(";").find(kt=>kt.trim().startsWith("mapState="));if(Oe)try{return JSON.parse(Oe.split("=")[1])}catch(kt){return console.error("Erreur lors de la lecture du cookie de position:",kt),null}return null}ra(async()=>{var lt,Oe;try{if(await n.fetchPlans(),($e.isAdmin||$e.isUsine)&&await Je(),$e.isUsine){re.value=!0;try{const st=await fn.get("/users/",{params:{role:"CONCESSIONNAIRE",usine:(lt=$e.user)==null?void 0:lt.id}});Ue.value=st.data}catch(st){console.error("Error loading concessionnaires:",st),Ue.value=[]}finally{re.value=!1}}if($e.isConcessionnaire){oe.value=!0;try{const st=await $e.fetchConcessionnaireAgriculteurs(((Oe=$e.user)==null?void 0:Oe.id)||0);Pe.value=Array.isArray(st)?st:[st]}catch(st){console.error("Error loading clients:",st)}finally{oe.value=!1}}const kt=Ee(),Et=kt?[kt.lat,kt.lng]:[46.603354,1.888334],St=(kt==null?void 0:kt.zoom)??6;if(t.value&&!d.value){const st=f(t.value,Et,St);st.pm.setLang("fr"),st.pm.addControls({rotateMode:!1}),$(st),st.on("moveend",()=>{J(st)}),window.addEventListener("map-set-location",pn=>{if(st&&pn.detail){const{lat:Gt,lng:nn,zoom:$n}=pn.detail;st.flyTo([Gt,nn],$n,{duration:1.5,easeLinearity:.25})}})}const nt=localStorage.getItem("lastPlanId");if(nt)try{console.log("[MapView][onMounted] Tentative de chargement du dernier plan:",nt),await O(parseInt(nt))}catch(st){console.error("[MapView][onMounted] Erreur chargement dernier plan:",st),se.value=null,n.clearCurrentPlan(),i.clearCurrentPlan(),ue(),localStorage.removeItem("lastPlanId")}else console.log("[MapView][onMounted] Aucun dernier plan à charger"),se.value=null,n.clearCurrentPlan(),i.clearCurrentPlan(),ue();window.addEventListener("shape:created",st=>{const{shape:pn,type:Gt,properties:nn}=st.detail;console.log("[MapView] Nouvelle forme créée",{shape:pn,type:Gt,properties:nn}),i.addElement(pn)})}catch(kt){console.error("Error during component mount:",kt),se.value=null,n.clearCurrentPlan(),i.clearCurrentPlan(),ue(),localStorage.removeItem("lastPlanId")}}),Ki(()=>i.hasUnsavedChanges,lt=>{console.log("[MapView][watch drawingStore.hasUnsavedChanges]",lt),lt&&se.value&&n.markUnsavedChanges()}),Ki(d,async lt=>{console.log(`
[MapView][watch map] Nouvelle carte:`,!!lt),lt&&n.currentPlan&&(console.log("[MapView][watch map] Plan courant trouvé:",n.currentPlan.id),ue(),await i.loadPlanElements(n.currentPlan.id),await O(n.currentPlan.id))}),Ki(()=>n.currentPlan,async lt=>{var Oe,kt,Et;console.log(`
[MapView][watch currentPlan] ====== CHANGEMENT DE PLAN ======`),console.log("[MapView][watch currentPlan] Nouveau plan:",lt==null?void 0:lt.id);try{if(lt){console.log("[MapView][watch currentPlan] Mise à jour du plan courant..."),se.value=lt,n.setCurrentPlan(lt),i.setCurrentPlan(lt.id);const St=document.querySelector(".map-parent");St instanceof HTMLElement&&(St.style.display="block"),console.log("[MapView][watch currentPlan] Plan mis à jour avec succès")}else{console.log("[MapView][watch currentPlan] Nettoyage du plan courant..."),se.value=null,ue(),n.clearCurrentPlan(),i.clearCurrentPlan();const St=document.querySelector(".map-parent");St instanceof HTMLElement&&(St.style.display="none")}}catch(St){console.error("[MapView][watch currentPlan] ERREUR:",St),se.value=null,ue(),n.clearCurrentPlan(),i.clearCurrentPlan()}console.log("[MapView][watch currentPlan] État final:",{currentPlanId:(Oe=se.value)==null?void 0:Oe.id,storePlanId:(kt=n.currentPlan)==null?void 0:kt.id,mapVisible:d.value!==null,mapParentDisplay:(Et=document.querySelector(".map-parent"))==null?void 0:Et.getAttribute("style")}),console.log(`[MapView][watch currentPlan] ====== FIN CHANGEMENT ======
`)},{immediate:!0}),Jh(()=>{d.value&&d.value.off("moveend"),window.removeEventListener("shape:created",()=>{})});function ue(){k.value&&k.value.clearLayers(),o.value=[],T(),u.value=null,a.value=""}async function ye(lt){try{ue(),await i.loadPlanElements(lt);const Oe=n.getPlanById(lt);Oe?(se.value=Oe,n.setCurrentPlan(Oe),i.setCurrentPlan(Oe.id),localStorage.setItem("lastPlanId",Oe.id.toString()),d.value&&k.value&&(i.getCurrentElements.forEach(kt=>{var st,pn,Gt,nn,$n,an,Dn,Pn,Ui,Oi,qn,$t,Bn,wi,Yn,xi,pi,sn,mn,Yt,gi,In;if(!k.value||!kt.data)return;let Et=null;const{style:St={},...nt}=kt.data;switch(kt.type_forme){case"TEXTE":{const bt=kt.data;if(console.log("[refreshMapWithPlan] Création TextRectangle",{bounds:bt.bounds,content:bt.content,style:bt.style}),!bt.bounds){console.error("Bounds manquants pour TextRectangle");return}const Xn=Zi.latLngBounds(Zi.latLng(bt.bounds.southWest[1],bt.bounds.southWest[0]),Zi.latLng(bt.bounds.northEast[1],bt.bounds.northEast[0]));Et=new Bo(Xn,bt.content||"Double-cliquez pour éditer",{color:((st=bt.style)==null?void 0:st.color)||"#3388ff",weight:((pn=bt.style)==null?void 0:pn.weight)||3,opacity:((Gt=bt.style)==null?void 0:Gt.opacity)||1,fillColor:((nn=bt.style)==null?void 0:nn.fillColor)||"#3388ff",fillOpacity:(($n=bt.style)==null?void 0:$n.fillOpacity)||.2,textStyle:{color:((Dn=(an=bt.style)==null?void 0:an.textStyle)==null?void 0:Dn.color)||"#000000",fontSize:((Ui=(Pn=bt.style)==null?void 0:Pn.textStyle)==null?void 0:Ui.fontSize)||"14px",fontFamily:((qn=(Oi=bt.style)==null?void 0:Oi.textStyle)==null?void 0:qn.fontFamily)||"Arial, sans-serif",textAlign:((Bn=($t=bt.style)==null?void 0:$t.textStyle)==null?void 0:Bn.textAlign)||"center",backgroundColor:((Yn=(wi=bt.style)==null?void 0:wi.textStyle)==null?void 0:Yn.backgroundColor)||"#FFFFFF",backgroundOpacity:((pi=(xi=bt.style)==null?void 0:xi.textStyle)==null?void 0:pi.backgroundOpacity)??1,bold:((mn=(sn=bt.style)==null?void 0:sn.textStyle)==null?void 0:mn.bold)||!1,italic:((gi=(Yt=bt.style)==null?void 0:Yt.textStyle)==null?void 0:gi.italic)||!1}}),bt.rotation&&typeof Et.setRotation=="function"&&Et.setRotation(bt.rotation),Et.properties={type:"TextRectangle",text:bt.content||"Double-cliquez pour éditer",style:bt.style,rotation:bt.rotation||0};break}case"POLYGON":{const bt=kt.data;if(bt.points&&bt.points.length>0){const Xn=bt.points.map(Ii=>Zi.latLng(Ii[1],Ii[0]));Et=new Mu([Xn],{...bt.style,pmIgnore:!1}),Et.updateProperties(),console.log("[refreshMapWithPlan] Polygon restauré",{points:Xn.length,style:bt.style,properties:Et.properties})}break}case"CERCLE":{const bt=nt;bt.center&&bt.radius&&(Et=Zi.circle([bt.center[1],bt.center[0]],{...St,radius:bt.radius}));break}case"RECTANGLE":{const bt=nt;bt.bounds&&(Et=Zi.rectangle([[bt.bounds.southWest[1],bt.bounds.southWest[0]],[bt.bounds.northEast[1],bt.bounds.northEast[0]]],St));break}case"DEMI_CERCLE":{const bt=nt;if(bt.center&&bt.radius){Et=new nl(Zi.latLng(bt.center[1],bt.center[0]),bt.radius,bt.startAngle,bt.endAngle,St),Et.properties={type:"Semicircle",radius:bt.radius,startAngle:bt.startAngle,stopAngle:bt.endAngle,style:St};const Xn=Math.PI*Math.pow(bt.radius,2)*((bt.endAngle-bt.startAngle)/360),Ii=2*bt.radius+Math.PI*bt.radius*((bt.endAngle-bt.startAngle)/180),ui=Math.PI*bt.radius*((bt.endAngle-bt.startAngle)/180);Et.properties.area=Xn,Et.properties.perimeter=Ii,Et.properties.arcLength=ui,Et.properties.openingAngle=bt.endAngle-bt.startAngle,console.log("[loadPlan] Demi-cercle restauré avec propriétés:",Et.properties)}break}case"LIGNE":{const bt=nt;if(bt.points){const Xn=bt.points.map(ui=>Zi.latLng(ui[1],ui[0]));Et=Zi.polyline(Xn,St),Et.properties={type:"Line",style:St};let Ii=0;for(let ui=1;ui<Xn.length;ui++)Ii+=Xn[ui].distanceTo(Xn[ui-1]);if(Et.properties.length=Ii,bt.hasOwnProperty("dimensions")&&bt.dimensions&&(Et.properties.dimensions=bt.dimensions,bt.dimensions.width&&Ii)){const ui=Ii*bt.dimensions.width;Et.properties.surfaceInfluence=ui}console.log("[loadPlan] Ligne restaurée avec propriétés:",Et.properties)}break}}Et&&(Et._dbId=kt.id,(In=k.value)==null||In.addLayer(Et),o.value.push({id:kt.id,type:kt.type_forme,layer:Et,properties:Et.properties}))}),b()),console.log(`Plan ${lt} chargé avec succès avec ${i.getCurrentElements.length} formes`)):console.error(`Plan ${lt} introuvable après chargement`),Q.value=!1}catch(Oe){throw console.error("Erreur lors du rafraîchissement de la carte:",Oe),Oe}}async function O(lt){var Oe;console.log(`
[MapView][loadPlan] ====== DÉBUT CHARGEMENT PLAN ======`),console.log("[MapView][loadPlan] Tentative de chargement du plan:",lt);try{const kt=n.getPlanById(lt);if(console.log("[MapView][loadPlan] Plan trouvé dans le store:",!!kt),!kt){console.log("[MapView][loadPlan] Plan non trouvé dans le store, vérification API...");try{await fn.get(`/plans/${lt}/`)}catch(Et){throw((Oe=Et.response)==null?void 0:Oe.status)===404&&(console.warn("[MapView][loadPlan] Plan non trouvé - Nettoyage du localStorage"),localStorage.removeItem("lastPlanId"),se.value=null,n.clearCurrentPlan(),i.clearCurrentPlan(),ue()),Et}}console.log("[MapView][loadPlan] Rafraîchissement de la carte..."),await ye(lt),Q.value=!1,console.log("[MapView][loadPlan] Invalidation de la taille de la carte..."),F(),console.log("[MapView][loadPlan] Plan chargé avec succès:",{planId:lt,elementsCount:i.getCurrentElements.length})}catch(kt){throw console.error("Erreur lors du chargement du plan:",kt),se.value=null,n.clearCurrentPlan(),i.clearCurrentPlan(),ue(),localStorage.removeItem("lastPlanId"),kt}}async function ie(){var lt;if(!se.value||!k.value){console.warn("Aucun plan actif ou groupe de formes à sauvegarder");return}we.value=!0,Be.value="saving";try{const Oe=[],kt=new Set(i.getCurrentElements.filter(st=>st.id!==void 0).map(st=>st.id)),Et=new Set;console.log("[savePlan] Début de la sauvegarde",{featureGroupLayers:k.value.getLayers().length,existingIds:Array.from(kt),currentElements:i.getCurrentElements}),k.value.eachLayer(st=>{var pn,Gt,nn,$n,an,Dn,Pn,Ui,Oi,qn,$t,Bn,wi,Yn,xi,pi,sn,mn,Yt,gi,In,bt,Xn,Ii,ui,yr,lr,_r,Yi,ur,jr,Ss,Zs,Ks,Gr,ds,As,ua,ca,Ys,Io,ha,Ms,Bs,go,Fo,cr,Fn,_n,fs,Hr,zr,Ts,xn,Hn;if(console.log("[savePlan] Traitement de la couche",{type:(pn=st.properties)==null?void 0:pn.type,isPolygon:st instanceof Zi.Polygon,isCircleArc:st instanceof nl,properties:st.properties}),st instanceof Bo){const Ei=st.getBounds(),Wn=((Gt=st.properties)==null?void 0:Gt.text)||"",Qn={style:{color:((nn=st.options)==null?void 0:nn.color)||"#3388ff",fillColor:(($n=st.options)==null?void 0:$n.fillColor)||"#3388ff",fillOpacity:((an=st.options)==null?void 0:an.fillOpacity)||.2,weight:((Dn=st.options)==null?void 0:Dn.weight)||3,opacity:((Pn=st.options)==null?void 0:Pn.opacity)||1,textStyle:{color:((qn=(Oi=(Ui=st.properties)==null?void 0:Ui.style)==null?void 0:Oi.textStyle)==null?void 0:qn.color)||"#000000",fontSize:((wi=(Bn=($t=st.properties)==null?void 0:$t.style)==null?void 0:Bn.textStyle)==null?void 0:wi.fontSize)||"14px",fontFamily:((pi=(xi=(Yn=st.properties)==null?void 0:Yn.style)==null?void 0:xi.textStyle)==null?void 0:pi.fontFamily)||"Arial, sans-serif",textAlign:((Yt=(mn=(sn=st.properties)==null?void 0:sn.style)==null?void 0:mn.textStyle)==null?void 0:Yt.textAlign)||"center",backgroundColor:((bt=(In=(gi=st.properties)==null?void 0:gi.style)==null?void 0:In.textStyle)==null?void 0:bt.backgroundColor)||"#FFFFFF",backgroundOpacity:((ui=(Ii=(Xn=st.properties)==null?void 0:Xn.style)==null?void 0:Ii.textStyle)==null?void 0:ui.backgroundOpacity)??1,bold:((_r=(lr=(yr=st.properties)==null?void 0:yr.style)==null?void 0:lr.textStyle)==null?void 0:_r.bold)||!1,italic:((jr=(ur=(Yi=st.properties)==null?void 0:Yi.style)==null?void 0:ur.textStyle)==null?void 0:jr.italic)||!1}},bounds:{southWest:[Ei.getSouthWest().lng,Ei.getSouthWest().lat],northEast:[Ei.getNorthEast().lng,Ei.getNorthEast().lat]},content:Wn};Oe.push({id:st._dbId,type_forme:"TEXTE",data:Qn}),st._dbId&&Et.add(st._dbId);return}else if(st instanceof nl||((Ss=st.properties)==null?void 0:Ss.type)==="Semicircle"){const Ei=typeof st.getCenter=="function"?st.getCenter():st.getLatLng(),Wn={center:[Ei.lng,Ei.lat],radius:st.getRadius(),startAngle:((Zs=st.properties)==null?void 0:Zs.startAngle)||0,endAngle:((Ks=st.properties)==null?void 0:Ks.stopAngle)||180,style:{color:((Gr=st.options)==null?void 0:Gr.color)||"#3388ff",fillColor:((ds=st.options)==null?void 0:ds.fillColor)||"#3388ff",fillOpacity:((As=st.options)==null?void 0:As.fillOpacity)||.2,weight:((ua=st.options)==null?void 0:ua.weight)||3,opacity:((ca=st.options)==null?void 0:ca.opacity)||1}};Oe.push({id:st._dbId,type_forme:"DEMI_CERCLE",data:Wn}),st._dbId&&Et.add(st._dbId),console.log("[savePlan] Demi-cercle ajouté aux éléments",{id:st._dbId,center:Wn.center,radius:Wn.radius,angles:[Wn.startAngle,Wn.endAngle],style:Wn.style})}else if(st instanceof Zi.Polygon&&!(st instanceof Zi.Rectangle)){const Qn={points:st.getLatLngs()[0].map(ci=>[ci.lng,ci.lat]),style:{color:((Ys=st.options)==null?void 0:Ys.color)||"#3388ff",fillColor:((Io=st.options)==null?void 0:Io.fillColor)||"#3388ff",fillOpacity:((ha=st.options)==null?void 0:ha.fillOpacity)||.2,weight:((Ms=st.options)==null?void 0:Ms.weight)||3,opacity:((Bs=st.options)==null?void 0:Bs.opacity)||1}};Oe.push({id:st._dbId,type_forme:"POLYGON",data:Qn}),st._dbId&&Et.add(st._dbId),console.log("[savePlan] Polygone ajouté aux éléments",{id:st._dbId,points:Qn.points.length,style:Qn.style})}else{const Ei={style:{color:((go=st.options)==null?void 0:go.color)||"#3388ff",fillColor:((Fo=st.options)==null?void 0:Fo.fillColor)||"#3388ff",fillOpacity:((cr=st.options)==null?void 0:cr.fillOpacity)||.2,weight:((Fn=st.options)==null?void 0:Fn.weight)||3,opacity:((_n=st.options)==null?void 0:_n.opacity)||1}};let Wn,Qn;if(st instanceof Zi.Circle)Wn="CERCLE",Qn={...Ei,center:[st.getLatLng().lng,st.getLatLng().lat],radius:st.getRadius()};else if(st instanceof Zi.Rectangle){Wn="RECTANGLE";const ci=st.getBounds();Qn={...Ei,bounds:{southWest:[ci.getSouthWest().lng,ci.getSouthWest().lat],northEast:[ci.getNorthEast().lng,ci.getNorthEast().lat]}}}else if(((fs=st.properties)==null?void 0:fs.type)==="Semicircle"){Wn="DEMI_CERCLE";let ci;typeof st.getLatLng=="function"?ci=st.getLatLng():st.getCenter&&typeof st.getCenter=="function"?ci=st.getCenter():st._latlng?ci=st._latlng:ci={lat:0,lng:0};const ps=st.getRadius?st.getRadius():0,Wr=((zr=(Hr=st.properties)==null?void 0:Hr.style)==null?void 0:zr.startAngle)||0,_i=((xn=(Ts=st.properties)==null?void 0:Ts.style)==null?void 0:xn.stopAngle)||180;Qn={...Ei,center:[ci.lng,ci.lat],radius:ps,startAngle:Wr,endAngle:_i}}else if(st instanceof Zi.Polyline&&!(st instanceof Zi.Polygon)){Wn="LIGNE";const ci=st.getLatLngs();Qn={...Ei,points:ci.map(ps=>[ps.lng,ps.lat])}}if(Wn&&Qn){let ci=st._elementId;st._dbId&&(ci=st._dbId,typeof ci=="number"&&Et.add(ci)),Oe.push({id:ci,type_forme:Wn,data:{...Qn,rotation:((Hn=st.properties)==null?void 0:Hn.rotation)||0}})}}}),console.log("[savePlan] Éléments à sauvegarder",{totalElements:Oe.length,elements:Oe.map(st=>({type:st.type_forme,hasPoints:"points"in st.data,hasStyle:"style"in st.data}))});const St=Array.from(kt).filter(st=>!Et.has(st));i.elements=Oe;const nt=await i.saveToPlan(se.value.id,{elementsToDelete:St});if(nt&&((lt=se.value)!=null&&lt.id)){const st=se.value.id;se.value={...se.value,...nt},n.updatePlanDetails(st,nt)}Be.value="success",setTimeout(()=>{Be.value=null},3e3)}catch(Oe){console.error("Erreur lors de la sauvegarde du plan:",Oe),Be.value=null}finally{we.value=!1}}Fc(()=>{$e.user||q(),n.clearCurrentPlan(),i.clearCurrentPlan()});function le(lt){x(lt)}function fe(lt){try{const Oe=new Date(lt);return isNaN(Oe.getTime())?(console.error("Date invalide reçue:",lt),"Date invalide"):new Intl.DateTimeFormat("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",timeZone:"Europe/Paris"}).format(Oe)}catch(Oe){return console.error("Erreur lors du formatage de la date:",Oe),"Date invalide"}}const _e=()=>{k.value&&b()},ee=()=>{u.value&&k.value&&(m(""),k.value.removeLayer(u.value),u.value=null)};async function G(lt){console.log(`onPlanCreated - Tentative de chargement du plan ${lt}`),await n.fetchPlans();const Oe=n.getPlanById(lt);Oe?(console.log(`Plan ${lt} trouvé, chargement en cours...`),localStorage.setItem("lastPlanId",lt.toString()),se.value=Oe,n.setCurrentPlan(Oe),i.setCurrentPlan(Oe.id),I.value=!1,F(),console.log(`Plan ${lt} chargé avec succès`)):console.error(`Plan ${lt} introuvable après création! Vérifiez les permissions.`)}Ki(He,async lt=>{var Oe;if(lt&&((Oe=$e.user)==null?void 0:Oe.user_type)==="admin"){oe.value=!0;try{const kt=await $e.fetchConcessionnaireAgriculteurs(lt.id);Pe.value=Array.isArray(kt)?kt:[kt]}catch(kt){console.error("[MapView][watch selectedConcessionnaire] Error:",kt),Pe.value=[]}finally{oe.value=!1}}});function q(){localStorage.removeItem("lastPlanId")}function de(lt,Oe="m"){return Oe==="m²"?`${(lt/1e4).toFixed(2)} ha`:Oe==="m"?lt>=1e3?`${(lt/1e3).toFixed(2)} km`:`${lt.toFixed(2)} m`:`${lt.toFixed(2)} ${Oe}`}const ce=Nt(!1);function V(lt){return{Circle:"Cercle",Rectangle:"Rectangle",Semicircle:"Demi-cercle",Line:"Ligne",Polygon:"Polygone",TextRectangle:"Rectangle avec texte"}[lt]||lt}async function Z(){var lt,Oe,kt;if(!(!se.value||!d.value||!k.value))try{console.log("Sauvegarde automatique avant génération de la synthèse..."),await ie(),await new Promise(Dn=>setTimeout(Dn,1e3)),ce.value=!0;const Et=se.value.concessionnaire_details,St=se.value.client_details;u.value&&(T(),u.value=null);const nt=new Cn("l","mm","a4"),st=nt.internal.pageSize.getWidth(),pn=nt.internal.pageSize.getHeight(),Gt=new Image;Gt.src=K0,await new Promise(Dn=>{Gt.onload=()=>Dn(),Gt.onerror=()=>Dn()}),nt.addImage(Gt,"JPEG",(st-60)/2,20,60,60),nt.setFontSize(24),nt.setTextColor(0),nt.text(se.value.nom||"Sans titre",st/2,100,{align:"center"});let nn=120;if(nt.setFontSize(14),Et&&(nt.setFont("helvetica","bold"),nt.text("Concessionnaire:",20,nn),nt.setFont("helvetica","normal"),nt.text(`${Et.first_name} ${Et.last_name}${Et.company_name?` (${Et.company_name})`:""}`,20,nn+8),nn+=25),St&&(nt.setFont("helvetica","bold"),nt.text("Client:",20,nn),nt.setFont("helvetica","normal"),nt.text(`${St.first_name} ${St.last_name}${St.company_name?` (${St.company_name})`:""}`,20,nn+8),nn+=25),se.value.description){nt.setFont("helvetica","bold"),nt.text("Description:",20,nn),nt.setFont("helvetica","normal");const Dn=nt.splitTextToSize(se.value.description,150);nt.text(Dn,20,nn+8),nn+=10*Dn.length+15}nt.setFontSize(10),nt.setTextColor(100),nt.text(`Date de création: ${fe(se.value.date_creation)}`,20,pn-20),nt.text(`Dernière modification: ${fe(se.value.date_modification)}`,st-20,pn-20,{align:"right"});const $n=[];k.value.eachLayer(Dn=>$n.push(Dn));const an=Zi.simpleMapScreenshoter({hideElementsWithSelectors:[".leaflet-control-container",".leaflet-pm-toolbar",".leaflet-grid-layer",".leaflet-grid-label"],preventDownload:!0}).addTo(d.value);await new Promise(Dn=>setTimeout(Dn,3e3));for(let Dn=0;Dn<$n.length;Dn++){nt.addPage();const Pn=30;nt.addImage(Gt,"JPEG",st-Pn-10,10,Pn,30),nt.setFontSize(8),nt.setTextColor(100);let Oi=25;Et&&(nt.text(`Concessionnaire: ${Et.first_name} ${Et.last_name}${Et.company_name?` (${Et.company_name})`:""}`,20,Oi),Oi+=10),St&&nt.text(`Client: ${St.first_name} ${St.last_name}${St.company_name?` (${St.company_name})`:""}`,20,Oi),nt.setDrawColor(200,200,200),nt.setLineWidth(.5),nt.line(20,45,st-20,45);const qn=$n[Dn],$t=qn.properties;$t&&(nt.setTextColor(0),nt.setFontSize(16),nt.setFont("helvetica","bold"),nt.text(V($t.type),20,60));const Bn=((lt=qn.getBounds)==null?void 0:lt.call(qn))||((Oe=qn.getLatLng)==null?void 0:Oe.call(qn));Bn&&d.value.fitBounds(Bn instanceof Zi.LatLng?Zi.latLngBounds([Bn]):Bn,{padding:[50,50]}),await new Promise(wi=>setTimeout(wi,2e3)),d.value.invalidateSize(),await new Promise(wi=>{const Yn=()=>{var mn;const xi=(mn=d.value)==null?void 0:mn.getContainer();if(!xi){wi();return}const pi=xi.querySelectorAll(".leaflet-tile-loaded");xi.querySelectorAll(".leaflet-tile-loading").length===0&&pi.length>0?wi():setTimeout(Yn,100)};Yn()});try{const wi=await an.takeScreen("image"),Yn=await new Promise((mn,Yt)=>{const gi=new Image;gi.onload=()=>mn(gi),gi.onerror=In=>Yt(In),gi.src=wi}),xi=st*.6-30;let pi=Yn.height*xi/Yn.width;pi>pn*.9&&(pi=pn*.9);const sn=Math.max(80,(pn-pi)/2);if(nt.addImage(Yn,"PNG",20,sn,xi,pi),$t){const mn=st*.6+10;let Yt=70;nt.setFontSize(12),nt.setFont("helvetica","normal"),$t.type==="Circle"?(nt.text(`Rayon: ${de($t.radius)}`,mn,Yt),Yt+=10,nt.text(`Diamètre: ${de($t.radius*2)}`,mn,Yt),Yt+=10,nt.text(`Surface: ${de($t.area,"m²")}`,mn,Yt),Yt+=10,nt.text(`Périmètre: ${de($t.perimeter)}`,mn,Yt),Yt+=10,$t.surfaceInterieure&&(nt.text(`Surface intérieure: ${de($t.surfaceInterieure,"m²")}`,mn,Yt),Yt+=10),$t.surfaceExterieure&&(nt.text(`Surface extérieure: ${de($t.surfaceExterieure,"m²")}`,mn,Yt),Yt+=10)):$t.type==="Rectangle"?(nt.text(`Largeur: ${de($t.width)}`,mn,Yt),Yt+=10,nt.text(`Hauteur: ${de($t.height)}`,mn,Yt),Yt+=10,nt.text(`Surface: ${de($t.area,"m²")}`,mn,Yt),Yt+=10,nt.text(`Périmètre: ${de($t.perimeter)}`,mn,Yt),Yt+=10,$t.surfaceInterieure&&(nt.text(`Surface intérieure: ${de($t.surfaceInterieure,"m²")}`,mn,Yt),Yt+=10),$t.surfaceExterieure&&(nt.text(`Surface extérieure: ${de($t.surfaceExterieure,"m²")}`,mn,Yt),Yt+=10)):$t.type==="Line"?(nt.text(`Longueur: ${de($t.length)}`,mn,Yt),Yt+=10,(kt=$t.dimensions)!=null&&kt.width&&(nt.text(`Largeur d'influence: ${de($t.dimensions.width)}`,mn,Yt),Yt+=10),$t.surfaceInfluence&&(nt.text(`Surface d'influence: ${de($t.surfaceInfluence,"m²")}`,mn,Yt),Yt+=10)):$t.type==="Polygon"?(nt.text(`Surface: ${de($t.area,"m²")}`,mn,Yt),Yt+=10,nt.text(`Périmètre: ${de($t.perimeter)}`,mn,Yt),Yt+=10,$t.surfaceInterieure&&(nt.text(`Surface intérieure: ${de($t.surfaceInterieure,"m²")}`,mn,Yt),Yt+=10),$t.surfaceExterieure&&(nt.text(`Surface extérieure: ${de($t.surfaceExterieure,"m²")}`,mn,Yt),Yt+=10)):$t.type==="Semicircle"&&(nt.text(`Rayon: ${de($t.radius)}`,mn,Yt),Yt+=10,nt.text(`Diamètre: ${de($t.radius*2)}`,mn,Yt),Yt+=10,nt.text(`Surface: ${de($t.area,"m²")}`,mn,Yt),Yt+=10,nt.text(`Périmètre: ${de($t.perimeter)}`,mn,Yt),Yt+=10,nt.text(`Longueur d'arc: ${de($t.arcLength)}`,mn,Yt),Yt+=10,nt.text(`Angle d'ouverture: ${$t.openingAngle.toFixed(1)}°`,mn,Yt),Yt+=10,$t.surfaceInterieure&&(nt.text(`Surface intérieure: ${de($t.surfaceInterieure,"m²")}`,mn,Yt),Yt+=10),$t.surfaceExterieure&&(nt.text(`Surface extérieure: ${de($t.surfaceExterieure,"m²")}`,mn,Yt),Yt+=10))}}catch(wi){console.error(`[generateSynthesis] Erreur capture forme ${Dn+1}:`,wi)}}d.value.removeControl(an),nt.save(`synthese_${se.value.nom}.pdf`)}catch(Et){console.error("[generateSynthesis] Erreur:",Et),alert("Une erreur est survenue lors de la génération de la synthèse. Veuillez réessayer.")}finally{ce.value=!1}}function F(){d.value&&bi(()=>{var lt,Oe;(lt=d.value)==null||lt.invalidateSize(),(Oe=k.value)!=null&&Oe.getLayers().length&&b()})}Ki(se,lt=>{lt&&bi(()=>{F()})});const D=Nt(null),j=Nt(!1),Fe=Nt([]),qe=Un(()=>{if(console.log("[MapView][filteredConcessionnaires] Computing with:",{selectedUsine:D.value,concessionnaires:Ue.value,concessionnairesLength:Ue.value.length}),!D.value)return[];const lt=Ue.value.filter(Oe=>{var St,nt,st;const kt=Oe.usine,Et=typeof kt=="object"&&kt!==null?kt.id:kt;return console.log("[MapView][filteredConcessionnaires] Checking concessionnaire:",{concessionnaire:Oe,concessionnaireUsine:kt,concessionnaireUsineId:Et,selectedUsineId:(St=D.value)==null?void 0:St.id,matches:Et===((nt=D.value)==null?void 0:nt.id)}),Et===((st=D.value)==null?void 0:st.id)});return console.log("[MapView][filteredConcessionnaires] Filtered result:",lt),lt});function De(lt){if(!lt)return"";const Oe=lt.first_name||"",kt=lt.last_name?lt.last_name.toUpperCase():"",Et=lt.company_name||lt.role||"";return`${Oe} ${kt} (${Et})`}async function Je(){j.value=!0;try{const lt=await fn.get("/users/",{params:{role:"USINE"}});Fe.value=lt.data}catch(lt){console.error("[MapView] Error loading usines:",lt),Fe.value=[]}finally{j.value=!1}}async function Ze(lt){console.log("[MapView][selectUsine] Sélection de l'usine:",lt),D.value=lt,re.value=!0;try{console.log("[MapView][selectUsine] Envoi de la requête avec params:",{role:"CONCESSIONNAIRE",usine:lt.id});const Oe=await fn.get("/users/",{params:{role:"CONCESSIONNAIRE",usine:lt.id}});console.log("[MapView][selectUsine] Réponse reçue:",Oe.data),Ue.value=Oe.data,console.log("[MapView][selectUsine] Concessionnaires mis à jour:",Ue.value)}catch(Oe){console.error("[MapView] Error loading concessionnaires for usine:",Oe),Ue.value=[]}finally{re.value=!1}}function yt(){D.value=null,He.value=null,ae.value=null,Ue.value=[],Pe.value=[],Te.value=[]}function wt(){He.value=null,ae.value=null,Pe.value=[],Te.value=[]}function Pt(){ae.value=null,Te.value=[]}async function Rt(lt){var Oe,kt,Et,St,nt,st;console.log(`
[MapView][selectConcessionnaire] ====== DÉBUT SÉLECTION CONCESSIONNAIRE ======`),console.log("Informations du concessionnaire:",{id:lt.id,username:lt.username,company:lt.company_name,role:lt.role}),console.log("Contexte utilisateur:",{userType:(Oe=$e.user)==null?void 0:Oe.user_type,userId:(kt=$e.user)==null?void 0:kt.id,userRole:(Et=$e.user)==null?void 0:Et.role,selectedUsineId:(St=D.value)==null?void 0:St.id}),He.value=lt,oe.value=!0;try{const pn={role:"AGRICULTEUR",concessionnaire:lt.id};$e.isUsine?(console.log("Ajout de l'ID de l'usine connectée:",(nt=$e.user)==null?void 0:nt.id),pn.usine=(st=$e.user)==null?void 0:st.id):D.value&&(console.log("Ajout de l'ID de l'usine sélectionnée:",D.value.id),pn.usine=D.value.id),console.log("Paramètres de la requête:",pn);const Gt=await fn.get("/users/",{params:pn});console.log("Réponse reçue du serveur:",{status:Gt.status,dataLength:Array.isArray(Gt.data)?Gt.data.length:"non-array",data:Gt.data}),Array.isArray(Gt.data)?(Pe.value=Gt.data,console.log(`${Gt.data.length} agriculteurs chargés`),Gt.data.forEach((nn,$n)=>{console.log(`Agriculteur ${$n+1}:`,{id:nn.id,username:nn.username,company:nn.company_name,concessionnaire:nn.concessionnaire})})):(console.warn("Format de réponse inattendu:",Gt.data),Pe.value=[]),Pe.value.length===0&&console.warn("Aucun agriculteur trouvé pour ce concessionnaire")}catch(pn){if(console.error("ERREUR lors du chargement des agriculteurs:",pn),pn&&typeof pn=="object"&&"response"in pn){const Gt=pn;console.error("Détails de l'erreur:",{status:Gt.response.status,data:Gt.response.data})}Pe.value=[]}finally{oe.value=!1,console.log(`[MapView][selectConcessionnaire] ====== FIN SÉLECTION CONCESSIONNAIRE ======
`)}}async function qt(lt){var Oe;ae.value=lt,Y.value=!0;try{const kt={agriculteur:lt.id};$e.isUsine?kt.usine=(Oe=$e.user)==null?void 0:Oe.id:D.value&&(kt.usine=D.value.id),He.value&&(kt.concessionnaire=He.value.id);const Et=await fn.get("/plans/",{params:kt});Te.value=Et.data}catch(kt){console.error("[MapView] Error loading client plans:",kt),Te.value=[]}finally{Y.value=!1}}return(lt,Oe)=>{var kt,Et,St;return je(),ze("div",cP,[A("div",hP,[ce.value?(je(),ze("div",dP,Oe[8]||(Oe[8]=[gc('<div class="bg-white/90 rounded-2xl p-8 max-w-md shadow-2xl border border-gray-100"><div class="flex flex-col items-center"><div class="relative w-24 h-24 mb-6"><div class="absolute inset-0 border-4 border-primary-200 rounded-full"></div><div class="absolute inset-0 border-4 border-primary-600 border-t-transparent rounded-full animate-spin"></div><div class="absolute inset-2 border-2 border-primary-400/30 rounded-full animate-pulse"></div><div class="absolute inset-0 flex items-center justify-center"><svg class="w-8 h-8 text-primary-600 animate-bounce" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg></div></div><h3 class="text-xl font-semibold text-gray-900 mb-2"> Génération de la synthèse </h3><div class="space-y-2 text-center"><p class="text-primary-600 font-medium"> Capture des formes en cours... </p><p class="text-sm text-gray-500"> Nous optimisons la qualité de vos captures pour un rendu parfait </p></div></div></div>',1)]))):Zt("",!0),se.value?Zt("",!0):(je(),ze("div",fP,[A("div",pP,[Oe[11]||(Oe[11]=gc('<div class="relative w-48 h-48 mx-auto mb-12 rounded-full bg-gradient-to-br from-primary-100 to-primary-50 p-8 shadow-lg ring-4 ring-white"><img src="'+K0+'" alt="IrrigationDesign Logo" class="w-full h-full object-contain filter drop-shadow-md"><div class="absolute inset-0 rounded-full bg-gradient-to-t from-transparent to-white/10 pointer-events-none"></div></div><h1 class="text-3xl font-bold text-gray-900 mb-4">Bienvenue sur IrrigationDesign</h1><p class="text-gray-600 mb-8">Pour commencer à dessiner, vous devez d&#39;abord créer un nouveau plan ou charger un plan existant.</p>',3)),A("div",gP,[A("button",{onClick:Oe[0]||(Oe[0]=nt=>I.value=!0),class:"w-full flex items-center justify-center px-4 py-3 bg-primary-600 text-white rounded-lg hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 transition-colors duration-200"},Oe[9]||(Oe[9]=[A("svg",{class:"w-6 h-6 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),vi(" Créer un nouveau plan ")])),A("button",{onClick:Oe[1]||(Oe[1]=nt=>Q.value=!0),class:"w-full flex items-center justify-center px-4 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 transition-colors duration-200"},Oe[10]||(Oe[10]=[A("svg",{class:"w-6 h-6 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})],-1),vi(" Charger un plan existant ")]))])])])),cn(A("div",mP,[se.value&&!ce.value?(je(),ze("div",vP,[Pi(bL,{"last-save":(kt=se.value)!=null&&kt.date_modification?new Date(se.value.date_modification):void 0,"plan-name":(Et=se.value)==null?void 0:Et.nom,"plan-description":(St=se.value)==null?void 0:St.description,"save-status":Be.value,onChangeMapType:vn(H),onCreateNewPlan:Oe[2]||(Oe[2]=nt=>I.value=!0),onLoadPlan:Oe[3]||(Oe[3]=nt=>Q.value=!0),onSavePlan:ie,onAdjustView:_e,onGenerateSummary:Z},null,8,["last-save","plan-name","plan-description","save-status","onChangeMapType"])])):Zt("",!0),A("div",yP,[A("div",_P,[A("div",{ref_key:"mapContainer",ref:t,class:"absolute inset-0 z-[1000]"},null,512)]),se.value&&!ce.value?(je(),ze("div",bP,[Pi(zx,{"current-tool":vn(a),"selected-shape":K.value,onToolChange:vn(m),onStyleUpdate:vn(y),onPropertiesUpdate:le,onDeleteShape:ee},null,8,["current-tool","selected-shape","onToolChange","onStyleUpdate"])])):Zt("",!0)]),ce.value?(je(),ze("div",wP,Oe[12]||(Oe[12]=[gc('<div class="text-center"><div class="mb-4"><svg class="animate-spin h-10 w-10 mx-auto text-blue-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg></div><p class="text-lg font-medium text-gray-900">Génération de la synthèse en cours...</p><p class="text-sm text-gray-500 mt-2">Veuillez patienter pendant que nous analysons votre plan.</p></div>',1)]))):Zt("",!0)],512),[[fh,se.value]]),Pi(q1,{ref_key:"newPlanModalRef",ref:C,modelValue:I.value,"onUpdate:modelValue":Oe[4]||(Oe[4]=nt=>I.value=nt),onCreated:G,onConcessionnaireSelected:Oe[5]||(Oe[5]=nt=>He.value=nt),onClientSelected:Oe[6]||(Oe[6]=nt=>ae.value=nt)},null,8,["modelValue"]),Q.value?(je(),ze("div",xP,[A("div",LP,[A("div",CP,[Oe[14]||(Oe[14]=A("h2",{class:"text-xl font-semibold text-gray-900"},"Charger un plan existant",-1)),A("button",{onClick:Oe[7]||(Oe[7]=nt=>Q.value=!1),class:"text-gray-400 hover:text-gray-500 focus:outline-none"},Oe[13]||(Oe[13]=[A("svg",{class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),vn($e).isAdmin?(je(),ze("div",PP,[D.value?He.value?ae.value?(je(),ze("div",qP,[A("div",VP,[A("button",{onClick:Pt,class:"flex items-center text-sm text-gray-600 hover:text-gray-900"},Oe[29]||(Oe[29]=[A("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),vi(" Retour à la liste des clients ")])),Oe[30]||(Oe[30]=A("span",{class:"mx-2 text-gray-400"},"|",-1)),A("span",GP,Tt(De(ae.value)),1)]),Oe[32]||(Oe[32]=A("h3",{class:"font-medium text-gray-700"},"Plans disponibles",-1)),A("div",HP,[Y.value?(je(),ze(Qt,{key:0},Mn(3,nt=>A("div",{key:nt,class:"animate-pulse"},Oe[31]||(Oe[31]=[A("div",{class:"p-3 bg-white rounded-lg border border-gray-200"},[A("div",{class:"h-5 bg-gray-200 rounded w-3/4 mb-2"}),A("div",{class:"h-4 bg-gray-100 rounded w-2/3 mb-2"}),A("div",{class:"h-3 bg-gray-50 rounded w-1/3"})],-1)]))),64)):(je(!0),ze(Qt,{key:1},Mn(Te.value,nt=>(je(),ze("button",{key:nt.id,onClick:st=>O(nt.id),class:"w-full px-4 py-3 text-left bg-white hover:bg-gray-50 rounded-lg border border-gray-200 transition-colors duration-200"},[A("div",ZP,Tt(nt.nom),1),A("div",KP,Tt(nt.description),1),A("div",YP," Modifié le "+Tt(fe(nt.date_modification)),1)],8,WP))),128))])])):(je(),ze("div",OP,[A("div",IP,[A("button",{onClick:wt,class:"flex items-center text-sm text-gray-600 hover:text-gray-900"},Oe[23]||(Oe[23]=[A("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),vi(" Retour à la liste des concessionnaires ")])),Oe[24]||(Oe[24]=A("span",{class:"mx-2 text-gray-400"},"|",-1)),A("span",FP,Tt(De(He.value)),1)]),Oe[28]||(Oe[28]=A("h3",{class:"font-medium text-gray-700"},"Sélectionnez un agriculteur",-1)),A("div",jP,[oe.value?(je(),ze(Qt,{key:0},Mn(3,nt=>A("div",{key:nt,class:"animate-pulse"},Oe[25]||(Oe[25]=[A("div",{class:"p-3 bg-white rounded-lg border border-gray-200"},[A("div",{class:"h-5 bg-gray-200 rounded w-3/4 mb-2"}),A("div",{class:"h-4 bg-gray-100 rounded w-1/2"})],-1)]))),64)):(je(),ze(Qt,{key:1},[N.value.length===0?(je(),ze("div",zP,Oe[26]||(Oe[26]=[A("div",{class:"text-gray-500 mb-2"},"Aucun agriculteur trouvé pour ce concessionnaire",-1),A("div",{class:"text-sm text-gray-400"}," Veuillez vérifier que des agriculteurs ont été assignés à ce concessionnaire ",-1)]))):(je(!0),ze(Qt,{key:1},Mn(N.value,nt=>(je(),ze("button",{key:nt.id,onClick:st=>qt(nt),class:"flex items-center p-3 text-left bg-white hover:bg-gray-50 rounded-lg border border-gray-200 transition-colors duration-200"},[A("div",null,[A("div",$P,Tt(De(nt)),1)]),Oe[27]||(Oe[27]=A("svg",{class:"w-5 h-5 ml-auto text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1))],8,UP))),128))],64))])])):(je(),ze("div",MP,[A("div",BP,[A("button",{onClick:yt,class:"flex items-center text-sm text-gray-600 hover:text-gray-900"},Oe[18]||(Oe[18]=[A("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),vi(" Retour à la liste des usines ")])),Oe[19]||(Oe[19]=A("span",{class:"mx-2 text-gray-400"},"|",-1)),A("span",TP,Tt(De(D.value)),1)]),Oe[22]||(Oe[22]=A("h3",{class:"font-medium text-gray-700"},"Sélectionnez un concessionnaire",-1)),A("div",NP,[re.value?(je(),ze(Qt,{key:0},Mn(3,nt=>A("div",{key:nt,class:"animate-pulse"},Oe[20]||(Oe[20]=[A("div",{class:"p-3 bg-white rounded-lg border border-gray-200"},[A("div",{class:"h-5 bg-gray-200 rounded w-3/4 mb-2"}),A("div",{class:"h-4 bg-gray-100 rounded w-1/2"})],-1)]))),64)):(je(!0),ze(Qt,{key:1},Mn(qe.value,nt=>(je(),ze("button",{key:nt.id,onClick:st=>Rt(nt),class:"flex items-center p-3 text-left bg-white hover:bg-gray-50 rounded-lg border border-gray-200 transition-colors duration-200"},[A("div",null,[A("div",RP,Tt(De(nt)),1)]),Oe[21]||(Oe[21]=A("svg",{class:"w-5 h-5 ml-auto text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1))],8,DP))),128))])])):(je(),ze("div",kP,[Oe[17]||(Oe[17]=A("h3",{class:"font-medium text-gray-700"},"Sélectionnez une usine",-1)),A("div",EP,[j.value?(je(),ze(Qt,{key:0},Mn(3,nt=>A("div",{key:nt,class:"animate-pulse"},Oe[15]||(Oe[15]=[A("div",{class:"p-3 bg-white rounded-lg border border-gray-200"},[A("div",{class:"h-5 bg-gray-200 rounded w-3/4 mb-2"}),A("div",{class:"h-4 bg-gray-100 rounded w-1/2"})],-1)]))),64)):(je(!0),ze(Qt,{key:1},Mn(Fe.value,nt=>(je(),ze("button",{key:nt.id,onClick:st=>Ze(nt),class:"flex items-center p-3 text-left bg-white hover:bg-gray-50 rounded-lg border border-gray-200 transition-colors duration-200"},[A("div",null,[A("div",AP,Tt(De(nt)),1)]),Oe[16]||(Oe[16]=A("svg",{class:"w-5 h-5 ml-auto text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1))],8,SP))),128))])]))])):vn($e).isConcessionnaire?(je(),ze("div",JP,[ae.value?(je(),ze("div",ik,[A("div",rk,[A("button",{onClick:Pt,class:"flex items-center text-sm text-gray-600 hover:text-gray-900"},Oe[37]||(Oe[37]=[A("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),vi(" Retour à la liste des clients ")])),Oe[38]||(Oe[38]=A("span",{class:"mx-2 text-gray-400"},"|",-1)),A("span",sk,Tt(De(ae.value)),1)]),Oe[40]||(Oe[40]=A("h3",{class:"font-medium text-gray-700"},"Plans disponibles",-1)),A("div",ok,[Y.value?(je(),ze(Qt,{key:0},Mn(3,nt=>A("div",{key:nt,class:"animate-pulse"},Oe[39]||(Oe[39]=[A("div",{class:"p-3 bg-white rounded-lg border border-gray-200"},[A("div",{class:"h-5 bg-gray-200 rounded w-3/4 mb-2"}),A("div",{class:"h-4 bg-gray-100 rounded w-2/3 mb-2"}),A("div",{class:"h-3 bg-gray-50 rounded w-1/3"})],-1)]))),64)):(je(!0),ze(Qt,{key:1},Mn(Te.value,nt=>(je(),ze("button",{key:nt.id,onClick:st=>O(nt.id),class:"w-full px-4 py-3 text-left bg-white hover:bg-gray-50 rounded-lg border border-gray-200 transition-colors duration-200"},[A("div",lk,Tt(nt.nom),1),A("div",uk,Tt(nt.description),1),A("div",ck," Modifié le "+Tt(fe(nt.date_modification)),1)],8,ak))),128))])])):(je(),ze("div",XP,[Oe[36]||(Oe[36]=A("h3",{class:"font-medium text-gray-700"},"Sélectionnez un agriculteur",-1)),A("div",QP,[oe.value?(je(),ze(Qt,{key:0},Mn(3,nt=>A("div",{key:nt,class:"animate-pulse"},Oe[33]||(Oe[33]=[A("div",{class:"p-3 bg-white rounded-lg border border-gray-200"},[A("div",{class:"h-5 bg-gray-200 rounded w-3/4 mb-2"}),A("div",{class:"h-4 bg-gray-100 rounded w-1/2"})],-1)]))),64)):(je(),ze(Qt,{key:1},[N.value.length===0?(je(),ze("div",ek,Oe[34]||(Oe[34]=[A("div",{class:"text-gray-500 mb-2"},"Aucun agriculteur trouvé pour ce concessionnaire",-1),A("div",{class:"text-sm text-gray-400"}," Veuillez vérifier que des agriculteurs ont été assignés à ce concessionnaire ",-1)]))):(je(!0),ze(Qt,{key:1},Mn(N.value,nt=>(je(),ze("button",{key:nt.id,onClick:st=>qt(nt),class:"flex items-center p-3 text-left bg-white hover:bg-gray-50 rounded-lg border border-gray-200 transition-colors duration-200"},[A("div",null,[A("div",nk,Tt(De(nt)),1)]),Oe[35]||(Oe[35]=A("svg",{class:"w-5 h-5 ml-auto text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1))],8,tk))),128))],64))])]))])):vn($e).isUsine?(je(),ze("div",hk,[He.value?ae.value?(je(),ze("div",Lk,[A("div",Ck,[A("button",{onClick:Pt,class:"flex items-center text-sm text-gray-600 hover:text-gray-900"},Oe[50]||(Oe[50]=[A("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),vi(" Retour à la liste des clients ")])),Oe[51]||(Oe[51]=A("span",{class:"mx-2 text-gray-400"},"|",-1)),A("span",Pk,Tt(De(ae.value)),1)]),Oe[53]||(Oe[53]=A("h3",{class:"font-medium text-gray-700"},"Plans disponibles",-1)),A("div",kk,[Y.value?(je(),ze(Qt,{key:0},Mn(3,nt=>A("div",{key:nt,class:"animate-pulse"},Oe[52]||(Oe[52]=[A("div",{class:"p-3 bg-white rounded-lg border border-gray-200"},[A("div",{class:"h-5 bg-gray-200 rounded w-3/4 mb-2"}),A("div",{class:"h-4 bg-gray-100 rounded w-2/3 mb-2"}),A("div",{class:"h-3 bg-gray-50 rounded w-1/3"})],-1)]))),64)):(je(!0),ze(Qt,{key:1},Mn(Te.value,nt=>(je(),ze("button",{key:nt.id,onClick:st=>O(nt.id),class:"w-full px-4 py-3 text-left bg-white hover:bg-gray-50 rounded-lg border border-gray-200 transition-colors duration-200"},[A("div",Sk,Tt(nt.nom),1),A("div",Ak,Tt(nt.description),1),A("div",Mk," Modifié le "+Tt(fe(nt.date_modification)),1)],8,Ek))),128))])])):(je(),ze("div",mk,[A("div",vk,[A("button",{onClick:wt,class:"flex items-center text-sm text-gray-600 hover:text-gray-900"},Oe[44]||(Oe[44]=[A("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),vi(" Retour à la liste des concessionnaires ")])),Oe[45]||(Oe[45]=A("span",{class:"mx-2 text-gray-400"},"|",-1)),A("span",yk,Tt(De(He.value)),1)]),Oe[49]||(Oe[49]=A("h3",{class:"font-medium text-gray-700"},"Sélectionnez un agriculteur",-1)),A("div",_k,[oe.value?(je(),ze(Qt,{key:0},Mn(3,nt=>A("div",{key:nt,class:"animate-pulse"},Oe[46]||(Oe[46]=[A("div",{class:"p-3 bg-white rounded-lg border border-gray-200"},[A("div",{class:"h-5 bg-gray-200 rounded w-3/4 mb-2"}),A("div",{class:"h-4 bg-gray-100 rounded w-1/2"})],-1)]))),64)):(je(),ze(Qt,{key:1},[N.value.length===0?(je(),ze("div",bk,Oe[47]||(Oe[47]=[A("div",{class:"text-gray-500 mb-2"},"Aucun agriculteur trouvé pour ce concessionnaire",-1),A("div",{class:"text-sm text-gray-400"}," Veuillez vérifier que des agriculteurs ont été assignés à ce concessionnaire ",-1)]))):(je(!0),ze(Qt,{key:1},Mn(N.value,nt=>(je(),ze("button",{key:nt.id,onClick:st=>qt(nt),class:"flex items-center p-3 text-left bg-white hover:bg-gray-50 rounded-lg border border-gray-200 transition-colors duration-200"},[A("div",null,[A("div",xk,Tt(De(nt)),1)]),Oe[48]||(Oe[48]=A("svg",{class:"w-5 h-5 ml-auto text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1))],8,wk))),128))],64))])])):(je(),ze("div",dk,[Oe[43]||(Oe[43]=A("h3",{class:"font-medium text-gray-700"},"Sélectionnez un concessionnaire",-1)),A("div",fk,[re.value?(je(),ze(Qt,{key:0},Mn(3,nt=>A("div",{key:nt,class:"animate-pulse"},Oe[41]||(Oe[41]=[A("div",{class:"p-3 bg-white rounded-lg border border-gray-200"},[A("div",{class:"h-5 bg-gray-200 rounded w-3/4 mb-2"}),A("div",{class:"h-4 bg-gray-100 rounded w-1/2"})],-1)]))),64)):(je(!0),ze(Qt,{key:1},Mn(Ue.value,nt=>(je(),ze("button",{key:nt.id,onClick:st=>Rt(nt),class:"flex items-center p-3 text-left bg-white hover:bg-gray-50 rounded-lg border border-gray-200 transition-colors duration-200"},[A("div",null,[A("div",gk,Tt(De(nt)),1)]),Oe[42]||(Oe[42]=A("svg",{class:"w-5 h-5 ml-auto text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1))],8,pk))),128))])]))])):(je(),ze("div",Bk,[vn(n).plans.length===0?(je(),ze("div",Tk,Oe[54]||(Oe[54]=[A("p",{class:"text-gray-500"},"Aucun plan disponible",-1)]))):(je(),ze("div",Nk,[(je(!0),ze(Qt,null,Mn(vn(n).plans,nt=>(je(),ze("button",{key:nt.id,onClick:st=>O(nt.id),class:"w-full px-4 py-3 text-left bg-white hover:bg-gray-50 rounded-lg border border-gray-200 transition-colors duration-200"},[A("div",Rk,Tt(nt.nom),1),A("div",Ok,Tt(nt.description),1),A("div",Ik," Modifié le "+Tt(fe(nt.date_modification)),1)],8,Dk))),128))]))]))])])):Zt("",!0)])])}}}),Fk={class:"fixed inset-0 z-50 overflow-y-auto"},jk={class:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0"},zk={class:"inline-block align-bottom bg-white rounded-lg px-4 pt-5 pb-4 text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full sm:p-6",role:"dialog","aria-modal":"true","aria-labelledby":"modal-headline"},Uk={class:"mt-3 text-center sm:mt-0 sm:text-left"},$k={class:"text-lg leading-6 font-medium text-gray-900",id:"modal-headline"},qk={class:"mt-4"},Vk={key:0,class:"mb-4 rounded-md bg-red-50 p-4"},Gk={class:"flex"},Hk={class:"ml-3"},Wk={class:"text-sm font-medium text-red-800"},Zk={key:0},Kk={key:1},Yk=["value"],Jk={key:2},Xk={key:3},Qk=["value"],e6={class:"grid grid-cols-1 gap-y-6 gap-x-4 sm:grid-cols-2"},t6={key:0,class:"mt-2 text-sm text-red-600"},n6={key:0,class:"mt-2 text-sm text-red-600"},i6={key:4},r6={key:5},s6={key:0,class:"mt-2 text-sm text-red-600"},o6={class:"flex justify-end space-x-3"},a6=["disabled"],l6={key:0,class:"mr-2"},u6=Hs({__name:"UserFormModal",props:{user:{type:Object,default:()=>({})},concessionnaires:{type:Array,default:()=>[]},usines:{type:Array,default:()=>[]},isAdmin:{type:Boolean,default:!1},isUsine:{type:Boolean,default:!1},currentConcessionnaire:{type:String,default:void 0},currentUsine:{type:String,default:void 0},apiErrors:{type:Array,default:()=>[]},refreshKey:{type:Number,default:0}},emits:["close","save","refresh"],setup(e,{emit:t}){const n=e,i=t,o=Nt(!1),a=Nt(""),u=Nt(""),d=Nt(""),f=Nt(""),m=Nt(""),y=il({id:void 0,first_name:"",last_name:"",username:"",email:"",password:"",company_name:"",role:n.isUsine?"CONCESSIONNAIRE":n.isAdmin?"ADMIN":"AGRICULTEUR",concessionnaire:null,usine:null,is_active:!0});ra(()=>{var k;(k=n.user)!=null&&k.id?(y.id=n.user.id,y.first_name=n.user.first_name||"",y.last_name=n.user.last_name||"",y.username=n.user.username||"",y.email=n.user.email||"",y.company_name=n.user.company_name||"",y.role=n.user.role||"AGRICULTEUR",y.is_active=n.user.is_active??!0,n.user.concessionnaire?typeof n.user.concessionnaire=="object"?y.concessionnaire=n.user.concessionnaire.id:y.concessionnaire=n.user.concessionnaire:n.user.concessionnaire_id?y.concessionnaire=n.user.concessionnaire_id:n.currentConcessionnaire&&(y.concessionnaire=parseInt(n.currentConcessionnaire)),n.user.usine?typeof n.user.usine=="object"?y.usine=n.user.usine.id:y.usine=n.user.usine:n.user.usine_id?y.usine=n.user.usine_id:n.currentUsine&&(y.usine=parseInt(n.currentUsine))):(n.currentConcessionnaire&&(y.concessionnaire=parseInt(n.currentConcessionnaire)),n.currentUsine&&(y.usine=parseInt(n.currentUsine)),n.isUsine?y.role="CONCESSIONNAIRE":n.isAdmin||(y.role="AGRICULTEUR"))}),hf(()=>{y.role==="ADMIN"||y.role==="USINE"?(y.concessionnaire=null,y.usine=null):y.role==="CONCESSIONNAIRE"&&(y.concessionnaire=null,n.isUsine&&n.currentUsine&&(y.usine=parseInt(n.currentUsine)))}),hf(()=>{a.value="",u.value="",d.value="",f.value="",n.apiErrors&&n.apiErrors.length>0&&n.apiErrors.forEach(k=>{switch(k.field){case"email":a.value=k.message;break;case"username":u.value=k.message;break;case"password":d.value=k.message;break;case"non_field_error":default:f.value=k.message;break}})});async function x(){a.value="",u.value="",d.value="",f.value="";let k=!0;if(y.id||(y.password!==m.value?(d.value="Les mots de passe ne correspondent pas",k=!1):y.password.length<8&&(d.value="Le mot de passe doit contenir au moins 8 caractères",k=!1)),!!k){o.value=!0;try{const b={...y};y.id&&delete b.password,n.isUsine&&["CONCESSIONNAIRE","AGRICULTEUR"].includes(y.role)&&(b.usine_id=n.currentUsine?parseInt(n.currentUsine):void 0),b.concessionnaire&&(b.concessionnaire_id=b.concessionnaire,delete b.concessionnaire),n.currentConcessionnaire&&y.role==="AGRICULTEUR"&&(b.concessionnaire_id=parseInt(n.currentConcessionnaire)),await i("save",b),i("refresh")}catch(b){console.error("Erreur locale:",b)}finally{o.value=!1}}}return(k,b)=>(je(),ze("div",Fk,[A("div",jk,[b[29]||(b[29]=A("div",{class:"fixed inset-0 transition-opacity","aria-hidden":"true"},[A("div",{class:"absolute inset-0 bg-gray-500 opacity-75"})],-1)),b[30]||(b[30]=A("span",{class:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true"},"​",-1)),A("div",zk,[A("div",null,[A("div",Uk,[A("h3",$k,Tt(e.user?"Modifier l'utilisateur":"Nouvel utilisateur"),1),A("div",qk,[f.value?(je(),ze("div",Vk,[A("div",Gk,[b[12]||(b[12]=A("div",{class:"flex-shrink-0"},[A("svg",{class:"h-5 w-5 text-red-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},[A("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})])],-1)),A("div",Hk,[A("h3",Wk,Tt(f.value),1)])])])):Zt("",!0),A("form",{onSubmit:td(x,["prevent"]),class:"space-y-6"},[e.isAdmin?(je(),ze("div",Zk,[b[14]||(b[14]=A("label",{for:"role",class:"block text-sm font-medium text-gray-700"},"Type d'utilisateur",-1)),cn(A("select",{id:"role","onUpdate:modelValue":b[0]||(b[0]=T=>y.role=T),class:"mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm",required:""},b[13]||(b[13]=[A("option",{value:"ADMIN"},"Administrateur",-1),A("option",{value:"USINE"},"Usine",-1),A("option",{value:"CONCESSIONNAIRE"},"Concessionnaire",-1),A("option",{value:"AGRICULTEUR"},"Agriculteur",-1)]),512),[[vr,y.role]])])):Zt("",!0),e.isAdmin&&y.role==="CONCESSIONNAIRE"?(je(),ze("div",Kk,[b[16]||(b[16]=A("label",{for:"usine",class:"block text-sm font-medium text-gray-700"},"Usine",-1)),cn(A("select",{id:"usine","onUpdate:modelValue":b[1]||(b[1]=T=>y.usine=T),class:"mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm"},[b[15]||(b[15]=A("option",{value:null},"-- Sélectionner une usine --",-1)),(je(!0),ze(Qt,null,Mn(e.usines,T=>(je(),ze("option",{key:T.id,value:T.id},Tt(T.first_name)+" "+Tt(T.last_name)+" ("+Tt(T.company_name||"Usine")+") ",9,Yk))),128))],512),[[vr,y.usine]])])):Zt("",!0),e.isUsine&&!y.id?(je(),ze("div",Jk,[b[18]||(b[18]=A("label",{for:"role",class:"block text-sm font-medium text-gray-700"},"Type d'utilisateur",-1)),cn(A("select",{id:"role","onUpdate:modelValue":b[2]||(b[2]=T=>y.role=T),class:"mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm",required:""},b[17]||(b[17]=[A("option",{value:"CONCESSIONNAIRE"},"Concessionnaire",-1),A("option",{value:"AGRICULTEUR"},"Agriculteur",-1)]),512),[[vr,y.role]])])):Zt("",!0),(e.isAdmin||e.isUsine)&&y.role==="AGRICULTEUR"&&!e.currentConcessionnaire?(je(),ze("div",Xk,[b[20]||(b[20]=A("label",{for:"concessionnaire",class:"block text-sm font-medium text-gray-700"},"Concessionnaire",-1)),cn(A("select",{id:"concessionnaire","onUpdate:modelValue":b[3]||(b[3]=T=>y.concessionnaire=T),class:"mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm",required:""},[b[19]||(b[19]=A("option",{value:null},"-- Sélectionner un concessionnaire --",-1)),(je(!0),ze(Qt,null,Mn(e.concessionnaires,T=>(je(),ze("option",{key:T.id,value:T.id},Tt(T.first_name)+" "+Tt(T.last_name)+" ("+Tt(T.company_name||"Concessionnaire")+") ",9,Qk))),128))],512),[[vr,y.concessionnaire]])])):Zt("",!0),A("div",e6,[A("div",null,[b[21]||(b[21]=A("label",{for:"first_name",class:"block text-sm font-medium text-gray-700"},"Prénom",-1)),cn(A("input",{type:"text",id:"first_name","onUpdate:modelValue":b[4]||(b[4]=T=>y.first_name=T),class:"mt-1 focus:ring-primary-500 focus:border-primary-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"},null,512),[[Kn,y.first_name]])]),A("div",null,[b[22]||(b[22]=A("label",{for:"last_name",class:"block text-sm font-medium text-gray-700"},"Nom",-1)),cn(A("input",{type:"text",id:"last_name","onUpdate:modelValue":b[5]||(b[5]=T=>y.last_name=T),class:"mt-1 focus:ring-primary-500 focus:border-primary-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"},null,512),[[Kn,y.last_name]])])]),A("div",null,[b[23]||(b[23]=A("label",{for:"email",class:"block text-sm font-medium text-gray-700"},"Email",-1)),cn(A("input",{type:"email",id:"email","onUpdate:modelValue":b[6]||(b[6]=T=>y.email=T),required:"",class:"mt-1 focus:ring-primary-500 focus:border-primary-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"},null,512),[[Kn,y.email]]),a.value?(je(),ze("div",t6,Tt(a.value),1)):Zt("",!0)]),A("div",null,[b[24]||(b[24]=A("label",{for:"username",class:"block text-sm font-medium text-gray-700"},"Nom d'utilisateur",-1)),cn(A("input",{type:"text",id:"username","onUpdate:modelValue":b[7]||(b[7]=T=>y.username=T),required:"",class:"mt-1 focus:ring-primary-500 focus:border-primary-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"},null,512),[[Kn,y.username]]),u.value?(je(),ze("div",n6,Tt(u.value),1)):Zt("",!0)]),A("div",null,[b[25]||(b[25]=A("label",{for:"company_name",class:"block text-sm font-medium text-gray-700"},"Entreprise",-1)),cn(A("input",{type:"text",id:"company_name","onUpdate:modelValue":b[8]||(b[8]=T=>y.company_name=T),class:"mt-1 focus:ring-primary-500 focus:border-primary-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"},null,512),[[Kn,y.company_name]])]),y.id?Zt("",!0):(je(),ze("div",i6,[b[26]||(b[26]=A("label",{for:"password",class:"block text-sm font-medium text-gray-700"},"Mot de passe",-1)),cn(A("input",{type:"password",id:"password","onUpdate:modelValue":b[9]||(b[9]=T=>y.password=T),required:"",autocomplete:"new-password",class:"mt-1 focus:ring-primary-500 focus:border-primary-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"},null,512),[[Kn,y.password]])])),y.id?Zt("",!0):(je(),ze("div",r6,[b[27]||(b[27]=A("label",{for:"password_confirm",class:"block text-sm font-medium text-gray-700"},"Confirmer le mot de passe",-1)),cn(A("input",{type:"password",id:"password_confirm","onUpdate:modelValue":b[10]||(b[10]=T=>m.value=T),required:"",autocomplete:"new-password",class:"mt-1 focus:ring-primary-500 focus:border-primary-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"},null,512),[[Kn,m.value]]),d.value?(je(),ze("div",s6,Tt(d.value),1)):Zt("",!0)])),A("div",o6,[A("button",{type:"button",onClick:b[11]||(b[11]=T=>k.$emit("close")),class:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500"}," Annuler "),A("button",{type:"submit",disabled:o.value,class:"inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500"},[o.value?(je(),ze("span",l6,b[28]||(b[28]=[A("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[A("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),A("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)]))):Zt("",!0),vi(" "+Tt(y.id?"Enregistrer":"Créer"),1)],8,a6)])],32)])])])])])]))}}),c6={class:"fixed inset-0 z-50 overflow-y-auto"},h6={class:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0"},d6={class:"inline-block align-bottom bg-white rounded-lg px-4 pt-5 pb-4 text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full sm:p-6",role:"dialog","aria-modal":"true","aria-labelledby":"modal-headline"},f6={class:"sm:flex sm:items-start"},p6={class:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left"},g6={class:"text-lg leading-6 font-medium text-gray-900",id:"modal-headline"},m6={class:"mt-2"},v6={class:"text-sm text-gray-500"},y6={class:"mt-5 sm:mt-4 sm:flex sm:flex-row-reverse"},hv=Hs({__name:"ConfirmationModal",props:{title:{type:String,required:!0},message:{type:String,required:!0}},emits:["confirm","cancel"],setup(e){return(t,n)=>(je(),ze("div",c6,[A("div",h6,[n[3]||(n[3]=A("div",{class:"fixed inset-0 transition-opacity","aria-hidden":"true"},[A("div",{class:"absolute inset-0 bg-gray-500 opacity-75"})],-1)),n[4]||(n[4]=A("span",{class:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true"},"​",-1)),A("div",d6,[A("div",f6,[n[2]||(n[2]=A("div",{class:"mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-red-100 sm:mx-0 sm:h-10 sm:w-10"},[A("svg",{class:"h-6 w-6 text-red-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})])],-1)),A("div",p6,[A("h3",g6,Tt(e.title),1),A("div",m6,[A("p",v6,Tt(e.message),1)])])]),A("div",y6,[A("button",{type:"button",class:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-red-600 text-base font-medium text-white hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 sm:ml-3 sm:w-auto sm:text-sm",onClick:n[0]||(n[0]=i=>t.$emit("confirm"))}," Confirmer "),A("button",{type:"button",class:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 sm:mt-0 sm:w-auto sm:text-sm",onClick:n[1]||(n[1]=i=>t.$emit("cancel"))}," Annuler ")])])])]))}}),_6={class:"h-full bg-gray-50"},b6={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},w6={class:"flex justify-between items-center mb-8"},x6={class:"text-3xl font-extrabold text-gray-900"},L6={key:0},C6={key:1},P6={key:2},k6={key:0},E6={key:1},S6={key:2},A6={class:"bg-white shadow rounded-lg mb-6 p-4"},M6={class:"space-y-4"},B6={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},T6={key:0},N6={key:0,value:"ADMIN"},D6={key:1,value:"USINE"},R6={key:1},O6=["value"],I6={key:2},F6=["value"],j6={class:"w-full"},z6={class:"bg-white shadow rounded-lg"},U6={class:"overflow-x-auto"},$6={class:"min-w-full divide-y divide-gray-200"},q6={class:"bg-gray-50"},V6={key:0,scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},G6={key:1,scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},H6={class:"bg-white divide-y divide-gray-200"},W6={key:0,class:"animate-pulse"},Z6={key:1},K6={class:"px-6 py-4 whitespace-nowrap"},Y6={class:"flex items-center"},J6={class:"flex-shrink-0 h-10 w-10"},X6={class:"h-10 w-10 rounded-full bg-primary-100 flex items-center justify-center"},Q6={class:"text-primary-600 font-medium"},eE={class:"ml-4"},tE={class:"text-sm font-medium text-gray-900"},nE={class:"text-sm text-gray-500"},iE={class:"px-6 py-4 whitespace-nowrap"},rE={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},sE={key:0,class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},oE={key:1,class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},aE={class:"px-6 py-4 whitespace-nowrap"},lE={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},uE=["onClick"],cE=["onClick"],hE=Hs({__name:"UserListView",setup(e){const t=Es(),n=_c(),i=Nt([]),o=Nt([]),a=Nt([]),u=Nt(!1),d=Nt(!1),f=Nt(null),m=Nt(null),y=Nt(!0),x=Nt([]),k=il({role:"",search:"",concessionnaire:"",usine:""}),b=Un(()=>t.isAdmin),T=Un(()=>t.isUsine),$=Un(()=>t.isConcessionnaire),H=Un(()=>b.value?i.value.filter(Y=>Y.role==="CONCESSIONNAIRE"):T.value?i.value.filter(Y=>{var C,N;return Y.role==="CONCESSIONNAIRE"&&((C=Y.usine)==null?void 0:C.id)===((N=t.user)==null?void 0:N.id)}):[]),I=Un(()=>{let Y=i.value;if(T.value&&(Y=Y.filter(C=>{var N,K,J,Ee,ue;return C.role==="CONCESSIONNAIRE"?((N=C.usine)==null?void 0:N.id)===((K=t.user)==null?void 0:K.id):C.role==="AGRICULTEUR"?((Ee=(J=C.concessionnaire)==null?void 0:J.usine)==null?void 0:Ee.id)===((ue=t.user)==null?void 0:ue.id):!1})),$.value&&(Y=Y.filter(C=>{var N,K;return C.role==="AGRICULTEUR"&&(C.concessionnaire_id===((N=t.user)==null?void 0:N.id)||C.concessionnaire&&C.concessionnaire.id===((K=t.user)==null?void 0:K.id))})),(b.value||T.value)&&(k.role&&(Y=Y.filter(C=>C.role===k.role)),k.concessionnaire&&(Y=Y.filter(C=>{var K;const N=((K=C.concessionnaire)==null?void 0:K.id)||C.concessionnaire_id;return(N==null?void 0:N.toString())===k.concessionnaire.toString()})),k.usine&&b.value&&(Y=Y.filter(C=>{var N,K,J,Ee,ue;return C.role==="CONCESSIONNAIRE"?((K=(N=C.usine)==null?void 0:N.id)==null?void 0:K.toString())===k.usine.toString():C.role==="AGRICULTEUR"?((ue=(Ee=(J=C.concessionnaire)==null?void 0:J.usine)==null?void 0:Ee.id)==null?void 0:ue.toString())===k.usine.toString():!1}))),k.search){const C=k.search.toLowerCase();Y=Y.filter(N=>{var K,J,Ee,ue;return((K=N.username)==null?void 0:K.toLowerCase().includes(C))||((J=N.email)==null?void 0:J.toLowerCase().includes(C))||((Ee=N.first_name)==null?void 0:Ee.toLowerCase().includes(C))||((ue=N.last_name)==null?void 0:ue.toLowerCase().includes(C))||N.company_name&&N.company_name.toLowerCase().includes(C)})}return Y});ra(async()=>{await Q(),await se()});async function Q(){var Y,C,N;y.value=!0;try{if(b.value)i.value=await t.fetchUsers();else if(T.value){const[K,J]=await Promise.all([yh({role:"CONCESSIONNAIRE",usineId:(Y=t.user)==null?void 0:Y.id}),yh({role:"AGRICULTEUR",usineId:(C=t.user)==null?void 0:C.id})]);i.value=[...K,...J]}else $.value&&(i.value=await yh({role:"AGRICULTEUR",concessionnaireId:(N=t.user)==null?void 0:N.id,includeDetails:!0}),console.log("Agriculteurs récupérés:",i.value))}catch(K){console.error("Erreur lors de la récupération des utilisateurs:",K),n.error("Erreur lors de la récupération des utilisateurs")}finally{y.value=!1}}async function se(){try{b.value?await Promise.all([we(),$e()]):T.value&&await Be()}catch(Y){console.error("Erreur lors de la récupération des dépendances:",Y)}}async function we(){var Y;try{b.value?o.value=await t.fetchUsersByRole({role:"CONCESSIONNAIRE"}):T.value&&(o.value=await t.fetchUsineConcessionnaires((Y=t.user)==null?void 0:Y.id))}catch(C){console.error("Erreur lors de la récupération des concessionnaires:",C)}}async function Be(){var Y,C;if(!(!T.value||!((Y=t.user)!=null&&Y.id)))try{o.value=await t.fetchUsineConcessionnaires((C=t.user)==null?void 0:C.id)}catch(N){console.error("Erreur lors de la récupération des concessionnaires de l'usine:",N)}}async function $e(){try{a.value=await t.fetchUsines()}catch(Y){console.error("Erreur lors de la récupération des usines:",Y)}}function Ue(){f.value=null,u.value=!0}function Pe(Y){f.value={...Y},u.value=!0}function Te(){u.value=!1,f.value=null,x.value=[]}async function He(Y){var N,K,J,Ee,ue,ye;x.value=[];const C=!!Y.id;try{const O={...Y};b.value?(O.usine&&typeof O.usine=="object"?O.usine_id=O.usine.id:typeof O.usine=="number"&&(O.usine_id=O.usine),O.concessionnaire&&typeof O.concessionnaire=="object"?O.concessionnaire_id=O.concessionnaire.id:typeof O.concessionnaire=="number"&&(O.concessionnaire_id=O.concessionnaire)):T.value?(O.usine_id=(N=t.user)==null?void 0:N.id,O.role==="AGRICULTEUR"&&(O.concessionnaire&&typeof O.concessionnaire=="object"?O.concessionnaire_id=O.concessionnaire.id:typeof O.concessionnaire=="number"&&(O.concessionnaire_id=O.concessionnaire))):$.value&&(O.role="AGRICULTEUR",O.concessionnaire_id=(K=t.user)==null?void 0:K.id),O.role==="CONCESSIONNAIRE"?((J=O.usine)!=null&&J.id?(O.usine_id=O.usine.id,delete O.usine):typeof O.usine=="number"&&(O.usine_id=O.usine,delete O.usine),delete O.concessionnaire):O.role==="AGRICULTEUR"&&((Ee=O.concessionnaire)!=null&&Ee.id?(O.concessionnaire_id=O.concessionnaire.id,delete O.concessionnaire):typeof O.concessionnaire=="number"&&(O.concessionnaire_id=O.concessionnaire,delete O.concessionnaire),delete O.usine,delete O.usine_id),C?(await t.updateUser(Y.id,O),n.success("Utilisateur modifié avec succès")):(await t.createUser(O),n.success("Utilisateur créé avec succès")),await Promise.all([Q(),se()]),Te()}catch(O){console.error("Error saving user:",((ue=O.response)==null?void 0:ue.data)||O),x.value=F4(O),n.error("Erreur lors de la sauvegarde de l'utilisateur");const ie=((ye=O.response)==null?void 0:ye.data)||{};let le="";throw typeof ie=="object"&&(le=Object.entries(ie).map(([fe,_e])=>Array.isArray(_e)?`${fe}: ${_e[0]}`:`${fe}: ${_e}`).filter(fe=>fe).join(`
`)),le||(le="Une erreur est survenue lors de la sauvegarde"),new Error(le)}}function ae(Y){m.value=Y,d.value=!0}async function re(){if(m.value)try{await t.deleteUser(m.value.id),n.success("Utilisateur supprimé avec succès"),await Promise.all([Q(),se()]),d.value=!1,m.value=null}catch(Y){throw console.error("Erreur lors de la suppression de l'utilisateur:",Y),n.error("Erreur lors de la suppression de l'utilisateur"),Y}}function oe(Y){var C,N,K,J,Ee,ue,ye,O;return b.value?!0:T.value?Y.role==="CONCESSIONNAIRE"?((C=Y.usine)==null?void 0:C.id)===((N=t.user)==null?void 0:N.id):Y.role==="AGRICULTEUR"?((J=(K=Y.concessionnaire)==null?void 0:K.usine)==null?void 0:J.id)===((Ee=t.user)==null?void 0:Ee.id):!1:$.value?Y.role==="AGRICULTEUR"&&(Y.concessionnaire_id===((ue=t.user)==null?void 0:ue.id)||((ye=Y.concessionnaire)==null?void 0:ye.id)===((O=t.user)==null?void 0:O.id)):!1}return(Y,C)=>{var N,K,J,Ee;return je(),ze("div",_6,[A("div",b6,[A("div",w6,[A("h1",x6,[b.value?(je(),ze("span",L6,"Gestion des utilisateurs")):T.value?(je(),ze("span",C6,"Gestion des concessionnaires et agriculteurs")):$.value?(je(),ze("span",P6,"Gestion des agriculteurs")):Zt("",!0)]),A("button",{onClick:Ue,class:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500"},[C[5]||(C[5]=A("svg",{class:"-ml-1 mr-2 h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[A("path",{"fill-rule":"evenodd",d:"M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z","clip-rule":"evenodd"})],-1)),b.value?(je(),ze("span",k6,"Nouvel utilisateur")):T.value?(je(),ze("span",E6,"Nouveau concessionnaire/agriculteur")):$.value?(je(),ze("span",S6,"Nouvel agriculteur")):Zt("",!0)])]),A("div",A6,[A("div",M6,[A("div",B6,[b.value||T.value?(je(),ze("div",T6,[C[9]||(C[9]=A("label",{for:"role-filter",class:"block text-sm font-medium text-gray-700"},"Rôle",-1)),cn(A("select",{id:"role-filter","onUpdate:modelValue":C[0]||(C[0]=ue=>k.role=ue),class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md"},[C[6]||(C[6]=A("option",{value:""},"Tous les rôles",-1)),b.value?(je(),ze("option",N6,"Administrateur")):Zt("",!0),b.value?(je(),ze("option",D6,"Usine")):Zt("",!0),C[7]||(C[7]=A("option",{value:"CONCESSIONNAIRE"},"Concessionnaire",-1)),C[8]||(C[8]=A("option",{value:"AGRICULTEUR"},"Agriculteur",-1))],512),[[vr,k.role]])])):Zt("",!0),b.value?(je(),ze("div",R6,[C[11]||(C[11]=A("label",{for:"usine-filter",class:"block text-sm font-medium text-gray-700"},"Usine",-1)),cn(A("select",{id:"usine-filter","onUpdate:modelValue":C[1]||(C[1]=ue=>k.usine=ue),class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md"},[C[10]||(C[10]=A("option",{value:""},"Toutes les usines",-1)),(je(!0),ze(Qt,null,Mn(a.value,ue=>(je(),ze("option",{key:ue.id,value:ue.id},Tt(vn(co)(ue)),9,O6))),128))],512),[[vr,k.usine]])])):Zt("",!0),b.value||T.value?(je(),ze("div",I6,[C[13]||(C[13]=A("label",{for:"concessionnaire-filter",class:"block text-sm font-medium text-gray-700"},"Concessionnaire",-1)),cn(A("select",{id:"concessionnaire-filter","onUpdate:modelValue":C[2]||(C[2]=ue=>k.concessionnaire=ue),class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md"},[C[12]||(C[12]=A("option",{value:""},"Tous les concessionnaires",-1)),(je(!0),ze(Qt,null,Mn(H.value,ue=>(je(),ze("option",{key:ue.id,value:ue.id},Tt(vn(co)(ue)),9,F6))),128))],512),[[vr,k.concessionnaire]])])):Zt("",!0)]),A("div",j6,[C[14]||(C[14]=A("label",{for:"search",class:"block text-sm font-medium text-gray-700"},"Recherche",-1)),cn(A("input",{type:"text",id:"search","onUpdate:modelValue":C[3]||(C[3]=ue=>k.search=ue),placeholder:"Rechercher par nom, email, entreprise...",class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm"},null,512),[[Kn,k.search]])])])]),A("div",z6,[A("div",U6,[A("table",$6,[A("thead",q6,[A("tr",null,[C[15]||(C[15]=A("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Utilisateur ",-1)),C[16]||(C[16]=A("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Rôle ",-1)),C[17]||(C[17]=A("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Email ",-1)),b.value||T.value?(je(),ze("th",V6," Usine ")):Zt("",!0),b.value||T.value?(je(),ze("th",G6," Concessionnaire ")):Zt("",!0),C[18]||(C[18]=A("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Statut ",-1)),C[19]||(C[19]=A("th",{scope:"col",class:"relative px-6 py-3"},[A("span",{class:"sr-only"},"Actions")],-1))])]),A("tbody",H6,[y.value?(je(),ze("tr",W6,C[20]||(C[20]=[A("td",{colspan:"7",class:"py-4 px-6"},[A("div",{class:"h-4 bg-gray-200 rounded w-3/4"})],-1)]))):I.value.length===0?(je(),ze("tr",Z6,C[21]||(C[21]=[A("td",{colspan:"7",class:"py-4 px-6 text-center text-gray-500"}," Aucun utilisateur trouvé ",-1)]))):Zt("",!0),(je(!0),ze(Qt,null,Mn(I.value,ue=>{var ye;return je(),ze("tr",{key:ue.id},[A("td",K6,[A("div",Y6,[A("div",J6,[A("div",X6,[A("span",Q6,Tt(vn(z4)(ue.first_name,ue.last_name)),1)])]),A("div",eE,[A("div",tE,Tt(vn(co)(ue)),1),A("div",nE,Tt(ue.username),1)])])]),A("td",iE,[A("span",{class:zi(vn(q4)())},Tt(vn($4)(ue.role)),3)]),A("td",rE,Tt(ue.email),1),b.value||T.value?(je(),ze("td",sE,[ue.role==="USINE"?(je(),ze(Qt,{key:0},[vi(" - ")],64)):ue.role==="CONCESSIONNAIRE"?(je(),ze(Qt,{key:1},[vi(Tt(ue.usine?vn(co)(ue.usine):"Non assigné"),1)],64)):ue.role==="AGRICULTEUR"?(je(),ze(Qt,{key:2},[vi(Tt((ye=ue.concessionnaire)!=null&&ye.usine?vn(co)(ue.concessionnaire.usine):"Non assigné"),1)],64)):(je(),ze(Qt,{key:3},[vi(" - ")],64))])):Zt("",!0),b.value||T.value?(je(),ze("td",oE,[ue.role==="USINE"||ue.role==="ADMIN"?(je(),ze(Qt,{key:0},[vi(" - ")],64)):ue.role==="CONCESSIONNAIRE"?(je(),ze(Qt,{key:1},[vi(" - ")],64)):(je(),ze(Qt,{key:2},[vi(Tt(ue.concessionnaire?vn(co)(ue.concessionnaire):"Non assigné"),1)],64))])):Zt("",!0),A("td",aE,[A("span",{class:zi(vn(V4)(ue.is_active))},Tt(ue.is_active?"Actif":"Inactif"),3)]),A("td",lE,[A("button",{onClick:O=>Pe(ue),class:"text-primary-600 hover:text-primary-900 mr-4"}," Modifier ",8,uE),oe(ue)?(je(),ze("button",{key:0,onClick:O=>ae(ue),class:"text-red-600 hover:text-red-900"}," Supprimer ",8,cE)):Zt("",!0)])])}),128))])])])])]),u.value?(je(),Sl(u6,{key:0,user:f.value,concessionnaires:o.value,usines:a.value,"is-admin":b.value,"is-usine":T.value,"current-concessionnaire":$.value?(K=(N=vn(t).user)==null?void 0:N.id)==null?void 0:K.toString():void 0,"current-usine":T.value?(Ee=(J=vn(t).user)==null?void 0:J.id)==null?void 0:Ee.toString():void 0,"api-errors":x.value,onClose:Te,onSave:He},null,8,["user","concessionnaires","usines","is-admin","is-usine","current-concessionnaire","current-usine","api-errors"])):Zt("",!0),d.value?(je(),Sl(hv,{key:1,title:"Supprimer l'utilisateur",message:"Êtes-vous sûr de vouloir supprimer cet utilisateur ? Cette action est irréversible.",onConfirm:re,onCancel:C[4]||(C[4]=ue=>d.value=!1)})):Zt("",!0)])}}}),dE={class:"h-full bg-gray-50"},fE={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},pE={class:"sm:flex sm:items-center"},gE={class:"sm:flex-auto"},mE={class:"text-2xl font-semibold text-gray-900"},vE={class:"mt-2 text-sm text-gray-700"},yE={key:0,class:"mt-8"},_E={class:"mb-6"},bE=["value"],wE={class:"mb-6"},xE={value:null},LE=["value"],CE={key:0,class:"mb-6"},PE={value:null},kE=["value"],EE={key:1,class:"mt-8"},SE={class:"mb-6"},AE=["value"],ME={class:"mt-8"},BE={class:"overflow-hidden shadow-sm ring-1 ring-black ring-opacity-5 rounded-lg"},TE={class:"overflow-x-auto"},NE={class:"min-w-full divide-y divide-gray-300"},DE={class:"bg-gray-50"},RE={scope:"col",class:"py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-gray-900 sm:pl-6 lg:pl-8"},OE={class:"ml-2 flex-none rounded"},IE={scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900"},FE={class:"ml-2 flex-none rounded"},jE={class:"divide-y divide-gray-200 bg-white"},zE={key:0},UE={class:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-gray-900 sm:pl-6 lg:pl-8"},$E={class:"whitespace-nowrap px-3 py-4 text-sm text-gray-500"},qE={class:"px-3 py-4 text-sm text-gray-900"},VE={key:0,class:"flex items-center"},GE={class:"h-8 w-8 flex-shrink-0"},HE={class:"h-8 w-8 rounded-full bg-primary-100 flex items-center justify-center"},WE={class:"text-primary-700 font-medium text-sm"},ZE={class:"ml-3"},KE={class:"font-medium"},YE={key:1,class:"text-gray-500"},JE={class:"px-3 py-4 text-sm text-gray-900"},XE={key:0,class:"flex items-center"},QE={class:"h-8 w-8 flex-shrink-0"},eS={class:"h-8 w-8 rounded-full bg-primary-100 flex items-center justify-center"},tS={class:"text-primary-700 font-medium text-sm"},nS={class:"ml-3"},iS={class:"font-medium"},rS={key:1,class:"text-gray-500"},sS={class:"px-3 py-4 text-sm text-gray-900"},oS={key:0,class:"flex items-center"},aS={class:"h-8 w-8 flex-shrink-0"},lS={class:"h-8 w-8 rounded-full bg-primary-100 flex items-center justify-center"},uS={class:"text-primary-700 font-medium text-sm"},cS={class:"ml-3"},hS={class:"font-medium"},dS={key:1,class:"text-gray-500"},fS={class:"whitespace-nowrap px-3 py-4 text-sm text-gray-500"},pS={class:"relative whitespace-nowrap py-4 pl-3 pr-4 text-right text-sm font-medium sm:pr-6 lg:pr-8"},gS=["onClick"],mS=["onClick"],vS=["onClick"],yS={key:2,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[2000]"},_S={class:"bg-white rounded-lg p-6 max-w-md w-full"},bS={class:"flex justify-between items-center mb-4"},wS=["disabled"],xS=["disabled"],LS={key:0,class:"space-y-4"},CS={key:0},PS=["disabled"],kS=["value"],ES=["disabled"],SS=["value"],AS={key:0,class:"mt-1 text-sm text-gray-500"},MS=["disabled"],BS=["value"],TS={key:0,class:"mt-1 text-sm text-gray-500"},NS={key:1,class:"mt-4 bg-red-50 p-4 rounded-md"},DS={class:"flex"},RS={class:"ml-3"},OS={class:"text-sm font-medium text-red-800"},IS={class:"mt-5 sm:mt-6 sm:grid sm:grid-cols-2 sm:gap-3"},FS=["disabled"],jS={key:0,class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},zS=Hs({__name:"PlansView",setup(e){const t=dd(),n=cp(),i=Es(),o=Nt([]),a=Nt([]),u=Nt([]),d=Nt([]),f=Nt(!1),m=Nt(!1),y=Nt(!1),x=Nt(null),k=Nt({nom:"",description:"",client:null}),b=Nt({id:0,nom:"",description:"",usine:null,concessionnaire:null,agriculteur:null}),T=Nt(!1),$=Nt(null),H=Nt(null),I=Nt(null),Q=Nt("date_modification"),se=Nt("desc"),we=Nt(null),Be=Un(()=>H.value?d.value.filter(G=>typeof G.concessionnaire=="object"&&G.concessionnaire?G.concessionnaire.id===H.value:G.concessionnaire===H.value||G.concessionnaire_id===H.value):d.value),$e=Un(()=>{let G=o.value;console.log(`
[PlansView] Filtering plans:`,G.map(de=>({id:de.id,usine:de.usine,concessionnaire:de.concessionnaire,agriculteur:de.agriculteur}))),i.isAdmin?(we.value&&(G=G.filter(de=>{var ce;return typeof de.usine=="object"?((ce=de.usine)==null?void 0:ce.id)===we.value:de.usine===we.value})),H.value&&(G=G.filter(de=>{var ce;return typeof de.concessionnaire=="object"?((ce=de.concessionnaire)==null?void 0:ce.id)===H.value:de.concessionnaire===H.value}),I.value&&(G=G.filter(de=>{var ce;return typeof de.agriculteur=="object"?((ce=de.agriculteur)==null?void 0:ce.id)===I.value:de.agriculteur===I.value})))):i.isConcessionnaire&&(G=G.filter(de=>{var ce,V,Z;return typeof de.concessionnaire=="object"?((ce=de.concessionnaire)==null?void 0:ce.id)===((V=i.user)==null?void 0:V.id):de.concessionnaire===((Z=i.user)==null?void 0:Z.id)}),I.value&&(G=G.filter(de=>{var ce;return typeof de.agriculteur=="object"?((ce=de.agriculteur)==null?void 0:ce.id)===I.value:de.agriculteur===I.value})));const q=[...G].sort((de,ce)=>{if(Q.value==="nom")return se.value==="asc"?de.nom.localeCompare(ce.nom):ce.nom.localeCompare(de.nom);{const V=new Date(de[Q.value]).getTime(),Z=new Date(ce[Q.value]).getTime();return se.value==="asc"?V-Z:Z-V}});return console.log("[PlansView] Final filtered and sorted plans:",q.map(de=>({id:de.id,usine:de.usine,concessionnaire:de.concessionnaire,agriculteur:de.agriculteur}))),q}),Ue=Un(()=>i.isAdmin?{title:"Tous les plans",description:"Liste complète des plans",plans:o.value}:i.isConcessionnaire?{title:"Plans des agriculteurs",description:"Plans où vous êtes assigné comme concessionnaire",plans:o.value.filter(G=>{var q,de,ce;return typeof G.concessionnaire=="object"?((q=G.concessionnaire)==null?void 0:q.id)===((de=i.user)==null?void 0:de.id):G.concessionnaire===((ce=i.user)==null?void 0:ce.id)})}:{title:"Mes plans",description:"Plans qui vous sont assignés ou que vous avez créés",plans:o.value.filter(G=>{var ce,V,Z,F;const q=G.createur.id===((ce=i.user)==null?void 0:ce.id);let de=!1;return typeof G.agriculteur=="object"?de=((V=G.agriculteur)==null?void 0:V.id)===((Z=i.user)==null?void 0:Z.id):de=G.agriculteur===((F=i.user)==null?void 0:F.id),de||q})}),Pe=Un(()=>we.value?a.value.filter(G=>{var q;return typeof G.usine=="object"?((q=G.usine)==null?void 0:q.id)===we.value:G.usine_id===we.value}):a.value),Te=Un(()=>b.value.usine?a.value.filter(G=>{var q;return typeof G.usine=="object"?((q=G.usine)==null?void 0:q.id)===b.value.usine:G.usine_id===b.value.usine}):[]),He=Un(()=>!b.value.usine||!b.value.concessionnaire?[]:d.value.filter(G=>typeof G.concessionnaire=="object"&&G.concessionnaire?G.concessionnaire.id===b.value.concessionnaire:G.concessionnaire===b.value.concessionnaire||G.concessionnaire_id===b.value.concessionnaire));ra(async()=>{var G;await ae(),i.isAdmin?await re():i.isConcessionnaire&&await Y(((G=i.user)==null?void 0:G.id)||0)});async function ae(){try{const G=await n.fetchPlansWithDetails();o.value=G.data}catch(G){console.error("Erreur lors du chargement des plans:",G)}}async function re(){try{console.log("Chargement des usines..."),u.value=await i.fetchUsines(),console.log("Usines chargées:",u.value)}catch(G){console.error("Erreur lors du chargement des usines:",G)}}async function oe(G){try{if(console.log("Chargement des concessionnaires pour l'usine:",G),G===void 0){const q=await i.fetchUsersByRole({role:"CONCESSIONNAIRE"});a.value=q}else a.value=await i.fetchUsineConcessionnaires(G);console.log("Concessionnaires chargés:",a.value)}catch(q){console.error("Erreur lors du chargement des concessionnaires:",q)}}async function Y(G){try{console.log("Chargement des agriculteurs pour le concessionnaire:",G);const q=await yh({role:"AGRICULTEUR",concessionnaireId:G});d.value=q.map(de=>({...de,concessionnaire_id:G})),console.log("Agriculteurs chargés:",d.value)}catch(q){console.error("Erreur lors du chargement des agriculteurs:",q)}}function C(){f.value=!0,k.value={nom:"",description:"",client:null}}async function N(G){console.log(`
[PlansView][editPlan] ====== DÉBUT ÉDITION PLAN ======`),console.log("[PlansView][editPlan] Plan reçu:",{id:G.id,nom:G.nom,usine:G.usine,concessionnaire:G.concessionnaire,agriculteur:G.agriculteur});try{console.log("[PlansView][editPlan] Définition du plan courant dans le store..."),n.setCurrentPlan(G),console.log("[PlansView][editPlan] Sauvegarde de l'ID dans localStorage:",G.id),localStorage.setItem("lastPlanId",G.id.toString()),console.log("[PlansView][editPlan] Redirection vers la vue carte..."),await t.push("/"),console.log(`[PlansView][editPlan] ====== FIN ÉDITION PLAN ======
`)}catch(q){console.error("[PlansView][editPlan] ERREUR:",q),q instanceof Error&&console.error("[PlansView][editPlan] Stack trace:",q.stack),alert("Une erreur est survenue lors du chargement du plan")}}async function K(G){G!=null&&G.id&&(x.value=G,y.value=!0)}async function J(){var G,q;if((G=x.value)!=null&&G.id)try{await n.deletePlan(x.value.id),await ae(),((q=n.currentPlan)==null?void 0:q.id)===x.value.id&&n.clearCurrentPlan()}catch(de){console.error("Erreur lors de la suppression du plan:",de),alert("Une erreur est survenue lors de la suppression du plan")}finally{y.value=!1,x.value=null}}function Ee(){y.value=!1,x.value=null}function ue(G){return new Date(G).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}function ye(G){if(!G)return"";const q=G.first_name||"",de=G.last_name||"";return(q.charAt(0)+de.charAt(0)).toUpperCase()}async function O(G){T.value=!0,$.value=null;try{i.isAdmin&&!u.value.length&&await re();const q=typeof G.usine=="object"&&G.usine?G.usine.id:G.usine,de=typeof G.concessionnaire=="object"&&G.concessionnaire?G.concessionnaire.id:G.concessionnaire,ce=typeof G.agriculteur=="object"&&G.agriculteur?G.agriculteur.id:G.agriculteur;b.value={id:G.id,nom:G.nom,description:G.description,usine:q||null,concessionnaire:de||null,agriculteur:ce||null},q&&await oe(q),de&&await Y(de),m.value=!0}catch(q){console.error("Erreur lors de l'ouverture du modal:",q),$.value="Erreur lors du chargement des données"}finally{T.value=!1}}async function ie(){var G,q,de,ce,V;$.value=null,T.value=!0;try{if(!b.value.nom.trim())throw new Error("Le nom du plan est requis");if(b.value.agriculteur&&!b.value.concessionnaire)throw new Error("Un concessionnaire doit être sélectionné pour assigner un agriculteur");if(b.value.concessionnaire&&!b.value.usine)throw new Error("Une usine doit être sélectionnée pour assigner un concessionnaire");console.log("Données envoyées pour la mise à jour:",{id:b.value.id,nom:b.value.nom.trim(),description:b.value.description.trim(),usine_id:b.value.usine,concessionnaire_id:b.value.concessionnaire,agriculteur_id:b.value.agriculteur});const Z=await n.updatePlanDetails(b.value.id,{nom:b.value.nom.trim(),description:b.value.description.trim(),usine_id:b.value.usine,concessionnaire_id:b.value.concessionnaire,agriculteur_id:b.value.agriculteur});console.log("Réponse de la mise à jour:",Z),Z&&(m.value=!1,await ae())}catch(Z){if(console.error("Erreur lors de la mise à jour du plan:",Z),(q=(G=Z.response)==null?void 0:G.data)!=null&&q.detail)$.value=Z.response.data.detail;else if((ce=(de=Z.response)==null?void 0:de.data)!=null&&ce.non_field_errors)$.value=Z.response.data.non_field_errors[0];else if((V=Z.response)!=null&&V.data){const F=Object.entries(Z.response.data).map(([D,j])=>`${D}: ${Array.isArray(j)?j[0]:j}`);$.value=F.join(`
`)}else $.value=Z.message||"Une erreur est survenue lors de la mise à jour du plan"}finally{T.value=!1}}Ki(()=>we.value,async G=>{H.value=null,I.value=null,G?await oe(G):await oe()}),Ki(()=>H.value,async G=>{I.value=null,G&&await Y(G)}),Ki(()=>b.value.usine,async G=>{G===null?(b.value.concessionnaire=null,b.value.agriculteur=null):await oe(G)}),Ki(()=>b.value.concessionnaire,async G=>{b.value.agriculteur=null,G&&await Y(G)});function le(G){var V,Z,F;const q=i.user;if(!q)return!1;if(q.user_type==="admin")return!0;if(q.user_type==="usine")return typeof G.usine=="object"?((V=G.usine)==null?void 0:V.id)===q.id:G.usine===q.id;if(q.user_type==="concessionnaire")return typeof G.concessionnaire=="object"?((Z=G.concessionnaire)==null?void 0:Z.id)===q.id:G.concessionnaire===q.id;const de=G.createur.id===q.id;let ce=!1;return typeof G.agriculteur=="object"?ce=((F=G.agriculteur)==null?void 0:F.id)===q.id:ce=G.agriculteur===q.id,ce||de}async function fe(G){await ae(),localStorage.setItem("lastPlanId",G.toString()),console.log(`Plan ${G} créé et défini comme plan actif`),t.push("/")}function _e(G){Q.value===G?se.value=se.value==="asc"?"desc":"asc":(Q.value=G,se.value="desc")}function ee(G){return G?co(G):""}return(G,q)=>{var de;return je(),ze("div",dE,[A("div",fE,[A("div",pE,[A("div",gE,[A("h1",mE,Tt(Ue.value.title),1),A("p",vE,Tt(Ue.value.description),1)]),A("div",{class:"mt-4 sm:mt-0 sm:ml-16 sm:flex-none"},[A("button",{onClick:C,class:"inline-flex items-center justify-center rounded-md border border-transparent bg-primary-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 sm:w-auto"}," Nouveau plan ")])]),vn(i).isAdmin?(je(),ze("div",yE,[A("div",_E,[q[15]||(q[15]=A("label",{for:"usine-filter",class:"block text-sm font-medium text-gray-700"},"Filtrer par usine",-1)),cn(A("select",{id:"usine-filter","onUpdate:modelValue":q[0]||(q[0]=ce=>we.value=ce),class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md"},[q[14]||(q[14]=A("option",{value:null},"Toutes les usines",-1)),(je(!0),ze(Qt,null,Mn(u.value,ce=>(je(),ze("option",{key:ce.id,value:ce.id},Tt(ee(ce)),9,bE))),128))],512),[[vr,we.value]])]),A("div",wE,[q[16]||(q[16]=A("label",{for:"concessionnaire-filter",class:"block text-sm font-medium text-gray-700"},"Filtrer par concessionnaire",-1)),cn(A("select",{id:"concessionnaire-filter","onUpdate:modelValue":q[1]||(q[1]=ce=>H.value=ce),class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md"},[A("option",xE,Tt(Pe.value.length?"Tous les concessionnaires":"Aucun concessionnaire disponible"),1),(je(!0),ze(Qt,null,Mn(Pe.value,ce=>(je(),ze("option",{key:ce.id,value:ce.id},Tt(ee(ce)),9,LE))),128))],512),[[vr,H.value]])]),H.value?(je(),ze("div",CE,[q[17]||(q[17]=A("label",{for:"agriculteur-filter",class:"block text-sm font-medium text-gray-700"},"Filtrer par agriculteur",-1)),cn(A("select",{id:"agriculteur-filter","onUpdate:modelValue":q[2]||(q[2]=ce=>I.value=ce),class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md"},[A("option",PE,Tt(Be.value.length?"Tous les agriculteurs":"Aucun agriculteur disponible"),1),(je(!0),ze(Qt,null,Mn(Be.value,ce=>(je(),ze("option",{key:ce.id,value:ce.id},Tt(ee(ce)),9,kE))),128))],512),[[vr,I.value]])])):Zt("",!0)])):vn(i).isConcessionnaire?(je(),ze("div",EE,[A("div",SE,[q[19]||(q[19]=A("label",{for:"agriculteur-filter",class:"block text-sm font-medium text-gray-700"},"Filtrer par agriculteur",-1)),cn(A("select",{id:"agriculteur-filter","onUpdate:modelValue":q[3]||(q[3]=ce=>I.value=ce),class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md"},[q[18]||(q[18]=A("option",{value:null},"Tous les agriculteurs",-1)),(je(!0),ze(Qt,null,Mn(d.value,ce=>(je(),ze("option",{key:ce.id,value:ce.id},Tt(ee(ce)),9,AE))),128))],512),[[vr,I.value]])])])):Zt("",!0),A("div",ME,[A("div",BE,[A("div",TE,[A("table",NE,[A("thead",DE,[A("tr",null,[A("th",RE,[A("button",{onClick:q[4]||(q[4]=ce=>_e("nom")),class:"group inline-flex items-center"},[q[21]||(q[21]=vi(" Nom ")),A("span",OE,[(je(),ze("svg",{class:zi(["h-5 w-5",{"text-gray-900":Q.value==="nom","text-gray-400":Q.value!=="nom","rotate-180":Q.value==="nom"&&se.value==="asc"}]),viewBox:"0 0 20 20",fill:"currentColor"},q[20]||(q[20]=[A("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"},null,-1)]),2))])])]),q[24]||(q[24]=A("th",{scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900"}," Description ",-1)),q[25]||(q[25]=A("th",{scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900"}," Usine ",-1)),q[26]||(q[26]=A("th",{scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900"}," Concessionnaire ",-1)),q[27]||(q[27]=A("th",{scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900"}," Agriculteur ",-1)),A("th",IE,[A("button",{onClick:q[5]||(q[5]=ce=>_e("date_modification")),class:"group inline-flex items-center"},[q[23]||(q[23]=vi(" Dernière modification ")),A("span",FE,[(je(),ze("svg",{class:zi(["h-5 w-5",{"text-gray-900":Q.value==="date_modification","text-gray-400":Q.value!=="date_modification","rotate-180":Q.value==="date_modification"&&se.value==="asc"}]),viewBox:"0 0 20 20",fill:"currentColor"},q[22]||(q[22]=[A("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"},null,-1)]),2))])])]),q[28]||(q[28]=A("th",{scope:"col",class:"relative py-3.5 pl-3 pr-4 sm:pr-6 lg:pr-8"},[A("span",{class:"sr-only"},"Actions")],-1))])]),A("tbody",jE,[$e.value.length===0?(je(),ze("tr",zE,q[29]||(q[29]=[A("td",{colspan:"7",class:"py-4 px-6 text-center text-gray-500"}," Aucun plan disponible ",-1)]))):Zt("",!0),(je(!0),ze(Qt,null,Mn($e.value,ce=>(je(),ze("tr",{key:ce.id,class:"hover:bg-gray-50"},[A("td",UE,Tt(ce.nom),1),A("td",$E,Tt(ce.description||"-"),1),A("td",qE,[ce.usine&&typeof ce.usine=="object"?(je(),ze("div",VE,[A("div",GE,[A("div",HE,[A("span",WE,Tt(ye(ce.usine)),1)])]),A("div",ZE,[A("div",KE,Tt(vn(co)(ce.usine)),1)])])):(je(),ze("div",YE," Non assigné "))]),A("td",JE,[ce.concessionnaire&&typeof ce.concessionnaire=="object"?(je(),ze("div",XE,[A("div",QE,[A("div",eS,[A("span",tS,Tt(ye(ce.concessionnaire)),1)])]),A("div",nS,[A("div",iS,Tt(vn(co)(ce.concessionnaire)),1)])])):(je(),ze("div",rS," Non assigné "))]),A("td",sS,[ce.agriculteur&&typeof ce.agriculteur=="object"?(je(),ze("div",oS,[A("div",aS,[A("div",lS,[A("span",uS,Tt(ye(ce.agriculteur)),1)])]),A("div",cS,[A("div",hS,Tt(vn(co)(ce.agriculteur)),1)])])):(je(),ze("div",dS," Non assigné "))]),A("td",fS,Tt(ue(ce.date_modification)),1),A("td",pS,[A("button",{onClick:V=>N(ce),class:"text-primary-600 hover:text-primary-900 mr-4"}," Ouvrir ",8,gS),A("button",{onClick:V=>O(ce),class:"text-primary-600 hover:text-primary-900 mr-4"}," Modifier ",8,mS),le(ce)?(je(),ze("button",{key:0,onClick:V=>K(ce),class:"text-red-600 hover:text-red-900"}," Supprimer ",8,vS)):Zt("",!0)])]))),128))])])])])]),Pi(q1,{modelValue:f.value,"onUpdate:modelValue":q[6]||(q[6]=ce=>f.value=ce),concessionnaires:a.value,clients:d.value,onCreated:fe},null,8,["modelValue","concessionnaires","clients"]),m.value?(je(),ze("div",yS,[A("div",_S,[A("div",bS,[q[31]||(q[31]=A("h2",{class:"text-xl font-semibold text-gray-900"},"Modifier le plan",-1)),A("button",{onClick:q[7]||(q[7]=ce=>m.value=!1),class:"text-gray-400 hover:text-gray-500 focus:outline-none"},q[30]||(q[30]=[A("svg",{class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),A("form",{onSubmit:td(ie,["prevent"]),class:"space-y-4"},[A("div",null,[q[32]||(q[32]=A("label",{for:"edit-nom",class:"block text-sm font-medium text-gray-700"}," Nom ",-1)),cn(A("input",{type:"text",id:"edit-nom","onUpdate:modelValue":q[8]||(q[8]=ce=>b.value.nom=ce),disabled:T.value,class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm disabled:bg-gray-100 disabled:cursor-not-allowed",required:""},null,8,wS),[[Kn,b.value.nom]])]),A("div",null,[q[33]||(q[33]=A("label",{for:"edit-description",class:"block text-sm font-medium text-gray-700"}," Description ",-1)),cn(A("textarea",{id:"edit-description","onUpdate:modelValue":q[9]||(q[9]=ce=>b.value.description=ce),disabled:T.value,rows:"3",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm disabled:bg-gray-100 disabled:cursor-not-allowed"},null,8,xS),[[Kn,b.value.description]])]),vn(i).isAdmin||((de=vn(i).user)==null?void 0:de.user_type)==="usine"?(je(),ze("div",LS,[vn(i).isAdmin?(je(),ze("div",CS,[q[35]||(q[35]=A("label",{for:"edit-usine",class:"block text-sm font-medium text-gray-700"}," Usine ",-1)),cn(A("select",{id:"edit-usine","onUpdate:modelValue":q[10]||(q[10]=ce=>b.value.usine=ce),disabled:T.value,class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md disabled:bg-gray-100 disabled:cursor-not-allowed"},[q[34]||(q[34]=A("option",{value:null},"Sélectionner une usine",-1)),(je(!0),ze(Qt,null,Mn(u.value,ce=>(je(),ze("option",{key:ce.id,value:ce.id},Tt(ee(ce)),9,kS))),128))],8,PS),[[vr,b.value.usine]])])):Zt("",!0),A("div",null,[q[37]||(q[37]=A("label",{for:"edit-concessionnaire",class:"block text-sm font-medium text-gray-700"}," Concessionnaire ",-1)),cn(A("select",{id:"edit-concessionnaire","onUpdate:modelValue":q[11]||(q[11]=ce=>b.value.concessionnaire=ce),disabled:vn(i).isAdmin&&!b.value.usine||T.value,class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md disabled:bg-gray-100 disabled:cursor-not-allowed"},[q[36]||(q[36]=A("option",{value:null},"Sélectionner un concessionnaire",-1)),(je(!0),ze(Qt,null,Mn(Te.value,ce=>(je(),ze("option",{key:ce.id,value:ce.id},Tt(ee(ce)),9,SS))),128))],8,ES),[[vr,b.value.concessionnaire]]),vn(i).isAdmin&&!b.value.usine?(je(),ze("p",AS," Veuillez d'abord sélectionner une usine ")):Zt("",!0)]),A("div",null,[q[39]||(q[39]=A("label",{for:"edit-agriculteur",class:"block text-sm font-medium text-gray-700"}," Agriculteur ",-1)),cn(A("select",{id:"edit-agriculteur","onUpdate:modelValue":q[12]||(q[12]=ce=>b.value.agriculteur=ce),disabled:!b.value.concessionnaire||T.value,class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md disabled:bg-gray-100 disabled:cursor-not-allowed"},[q[38]||(q[38]=A("option",{value:null},"Sélectionner un agriculteur",-1)),(je(!0),ze(Qt,null,Mn(He.value,ce=>(je(),ze("option",{key:ce.id,value:ce.id},Tt(ee(ce)),9,BS))),128))],8,MS),[[vr,b.value.agriculteur]]),b.value.concessionnaire?Zt("",!0):(je(),ze("p",TS," Veuillez d'abord sélectionner un concessionnaire "))])])):Zt("",!0),$.value?(je(),ze("div",NS,[A("div",DS,[q[40]||(q[40]=A("div",{class:"flex-shrink-0"},[A("svg",{class:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor"},[A("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})])],-1)),A("div",RS,[A("p",OS,Tt($.value),1)])])])):Zt("",!0),A("div",IS,[A("button",{type:"button",class:"mt-3 inline-flex w-full justify-center rounded-md border border-gray-300 bg-white px-4 py-2 text-base font-medium text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 sm:mt-0 sm:text-sm",onClick:q[13]||(q[13]=ce=>m.value=!1)}," Annuler "),A("button",{type:"submit",disabled:T.value,class:"inline-flex w-full justify-center rounded-md border border-transparent bg-primary-600 px-4 py-2 text-base font-medium text-white shadow-sm hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 sm:text-sm disabled:opacity-50"},[T.value?(je(),ze("svg",jS,q[41]||(q[41]=[A("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),A("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):Zt("",!0),vi(" "+Tt(T.value?"Enregistrement...":"Enregistrer"),1)],8,FS)])],32)])])):Zt("",!0),y.value?(je(),Sl(hv,{key:3,title:"Supprimer le plan",message:"Êtes-vous sûr de vouloir supprimer ce plan ? Cette action est irréversible.",onConfirm:J,onCancel:Ee})):Zt("",!0)])])}}}),dv=G5({history:x5("/"),routes:[{path:"/",name:"home",component:kg,meta:{requiresAuth:!0,allowedRoles:["admin","usine","concessionnaire","agriculteur"]}},{path:"/plans",name:"plans",component:zS,meta:{requiresAuth:!0,allowedRoles:["admin","usine","concessionnaire","agriculteur"]}},{path:"/users",name:"users",component:hE,meta:{requiresAuth:!0,allowedRoles:["admin","usine","concessionnaire"]}},{path:"/profile",name:"profile",component:()=>Ql(()=>import("./ProfileView.js"),[]),meta:{requiresAuth:!0,allowedRoles:["admin","usine","concessionnaire","agriculteur"]}},{path:"/login",name:"login",component:Mw,meta:{requiresGuest:!0}},{path:"/forgot-password",name:"forgot-password",component:()=>Ql(()=>import("./ForgotPasswordView.js"),[]),meta:{requiresGuest:!0}},{path:"/reset-password/:token",name:"reset-password",component:()=>Ql(()=>import("./ResetPasswordView.js"),[]),meta:{requiresGuest:!0}},{path:"/change-password",name:"changePassword",component:hw,meta:{requiresAuth:!0,allowedRoles:["admin","usine","concessionnaire","agriculteur"]}},{path:"/map",name:"map",component:kg,meta:{requiresAuth:!0}},{path:"/:pathMatch(.*)*",name:"not-found",component:()=>Ql(()=>import("./NotFoundView.js"),[])}]});dv.beforeEach(async(e,t,n)=>{var d,f;const i=Es();if(console.log("Route:",e.path,"Auth state:",{initialized:i.initialized,isAuthenticated:i.isAuthenticated,user:i.user}),!i.initialized)try{await i.initialize(window.INITIAL_STATE)}catch(m){console.error("Error initializing auth store:",m)}const o=i.isAuthenticated,a=(d=i.user)==null?void 0:d.must_change_password,u=(f=i.user)==null?void 0:f.user_type;if(e.meta.requiresAuth&&!o){n("/login");return}if(o&&a&&e.name!=="changePassword"){n({name:"changePassword"});return}if(e.name==="changePassword"&&!a){n({name:"home"});return}if(e.meta.allowedRoles&&u&&!e.meta.allowedRoles.includes(u)){n({name:"home"});return}if(e.meta.requiresGuest&&o){n({name:"home"});return}n()});const pp=Q2(q3),fv=n_();pp.use(fv);pp.use(dv);const US=Es(fv);window.INITIAL_STATE&&US.initialize(window.INITIAL_STATE);pp.mount("#app");export{yi as _,il as a,A as b,ze as c,Hs as d,Zt as e,cn as f,je as g,gc as h,vi as i,Pi as j,ea as k,Ay as l,aA as m,zi as n,ra as o,dd as p,To as q,Nt as r,A1 as s,Tt as t,Es as u,Kn as v,td as w};
