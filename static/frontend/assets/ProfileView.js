import{d as E,i as C,r as c,k,o as S,c as n,a as s,w as M,b as j,n as y,t as x,f as v,v as f,h as u}from"./index.js";const U={class:"min-h-screen bg-gray-50 py-12"},V={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},A={class:"md:grid md:grid-cols-3 md:gap-6"},B={class:"mt-5 md:mt-0 md:col-span-2"},q={class:"shadow sm:rounded-md sm:overflow-hidden"},P={class:"px-4 py-5 bg-white space-y-6 sm:p-6"},N={class:"flex"},$={class:"flex-shrink-0"},T={key:0,class:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor"},D={key:1,class:"h-5 w-5 text-green-400",viewBox:"0 0 20 20",fill:"currentColor"},F={class:"ml-3"},O={class:"mt-1"},G={class:"mt-1"},H={class:"px-4 py-3 bg-gray-50 text-right sm:px-6"},I=["disabled"],J={class:"mt-10 sm:mt-0"},K={class:"md:grid md:grid-cols-3 md:gap-6"},Q={class:"mt-5 md:mt-0 md:col-span-2"},R={class:"shadow sm:rounded-md sm:overflow-hidden"},W={class:"px-4 py-5 bg-white space-y-6 sm:p-6"},X={class:"flex"},Y={class:"flex-shrink-0"},Z={key:0,class:"h-5 w-5 text-green-400",viewBox:"0 0 20 20",fill:"currentColor"},ss={key:1,class:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor"},es={class:"ml-3"},os={class:"mt-1"},rs={class:"mt-1"},ts={class:"mt-1"},as={class:"px-4 py-3 bg-gray-50 text-right sm:px-6"},ls=["disabled"],ns=E({__name:"ProfileView",setup(ds){const p=C(),g=c(!1),w=c(!1),r=c(null),l=c(null),a=c(null),d=k({username:"",email:""}),t=k({old_password:"",new_password:"",confirm_password:""});S(()=>{p.user&&(d.username=p.user.username,d.email=p.user.email)});async function L(){var m;g.value=!0,r.value=null;try{await p.updateUserEmail(d.email);const e=r.value;r.value="Email mis à jour avec succès",setTimeout(()=>{r.value==="Email mis à jour avec succès"&&(r.value=null)},3e3)}catch(e){if((m=e.response)!=null&&m.data){const o=e.response.data;if(typeof o=="object"){const b=Object.entries(o).map(([_,i])=>{const h=Array.isArray(i)?i[0]:i;return`${_}: ${h}`}).join(`
`);r.value=b}else r.value=String(o)}else e.message?r.value=e.message:r.value="Une erreur est survenue lors de la mise à jour de l'email"}finally{g.value=!1}}async function z(){var m;if(t.new_password!==t.confirm_password){l.value="Les mots de passe ne correspondent pas",a.value=null;return}w.value=!0,l.value=null,a.value=null;try{await p.changePassword(t.old_password,t.new_password),t.old_password="",t.new_password="",t.confirm_password="",a.value="Mot de passe modifié avec succès",setTimeout(()=>{a.value==="Mot de passe modifié avec succès"&&(a.value=null)},3e3)}catch(e){if((m=e.response)!=null&&m.data){const o=e.response.data;if(typeof o=="object"){const b=Object.entries(o).map(([_,i])=>{const h=Array.isArray(i)?i[0]:i;return`${_}: ${h}`}).join(`
`);l.value=b}else l.value=String(o)}else e.message?l.value=e.message:l.value="Une erreur est survenue lors du changement de mot de passe"}finally{w.value=!1}}return(m,e)=>(u(),n("div",U,[s("div",V,[s("div",A,[e[10]||(e[10]=s("div",{class:"md:col-span-1"},[s("div",{class:"px-4 sm:px-0"},[s("h3",{class:"text-lg font-medium leading-6 text-gray-900"}," Profil "),s("p",{class:"mt-1 text-sm text-gray-600"}," Ces informations seront affichées publiquement, soyez prudent avec ce que vous partagez. ")])],-1)),s("div",B,[s("form",{onSubmit:M(L,["prevent"])},[s("div",q,[s("div",P,[r.value?(u(),n("div",{key:0,class:y(["rounded-md p-4",r.value==="Email mis à jour avec succès"?"bg-green-50":"bg-red-50"])},[s("div",N,[s("div",$,[r.value!=="Email mis à jour avec succès"?(u(),n("svg",T,e[5]||(e[5]=[s("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"},null,-1)]))):(u(),n("svg",D,e[6]||(e[6]=[s("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"},null,-1)])))]),s("div",F,[s("h3",{class:y(["text-sm font-medium",[r.value==="Email mis à jour avec succès"?"text-green-800":"text-red-800"]])},x(r.value),3)])])],2)):j("",!0),s("div",null,[e[8]||(e[8]=s("label",{for:"username",class:"block text-sm font-medium text-gray-700"}," Nom d'utilisateur ",-1)),s("div",O,[v(s("input",{type:"text",name:"username",id:"username","onUpdate:modelValue":e[0]||(e[0]=o=>d.username=o),disabled:"",class:"shadow-sm bg-gray-100 block w-full sm:text-sm border-gray-300 rounded-md cursor-not-allowed"},null,512),[[f,d.username]]),e[7]||(e[7]=s("p",{class:"mt-1 text-sm text-gray-500"},"Le nom d'utilisateur ne peut pas être modifié.",-1))])]),s("div",null,[e[9]||(e[9]=s("label",{for:"email",class:"block text-sm font-medium text-gray-700"}," Adresse e-mail ",-1)),s("div",G,[v(s("input",{type:"email",name:"email",id:"email","onUpdate:modelValue":e[1]||(e[1]=o=>d.email=o),class:"shadow-sm focus:ring-primary-500 focus:border-primary-500 block w-full sm:text-sm border-gray-300 rounded-md"},null,512),[[f,d.email]])])])]),s("div",H,[s("button",{type:"submit",disabled:g.value,class:"inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500"},x(g.value?"Enregistrement...":"Enregistrer"),9,I)])])],32)])]),e[17]||(e[17]=s("div",{class:"hidden sm:block","aria-hidden":"true"},[s("div",{class:"py-5"},[s("div",{class:"border-t border-gray-200"})])],-1)),s("div",J,[s("div",K,[e[16]||(e[16]=s("div",{class:"md:col-span-1"},[s("div",{class:"px-4 sm:px-0"},[s("h3",{class:"text-lg font-medium leading-6 text-gray-900"}," Mot de passe "),s("p",{class:"mt-1 text-sm text-gray-600"}," Assurez-vous d'utiliser un mot de passe sécurisé. ")])],-1)),s("div",Q,[s("form",{onSubmit:M(z,["prevent"])},[s("div",R,[s("div",W,[l.value||a.value?(u(),n("div",{key:0,class:y(["rounded-md p-4",a.value?"bg-green-50":"bg-red-50"])},[s("div",X,[s("div",Y,[a.value?(u(),n("svg",Z,e[11]||(e[11]=[s("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"},null,-1)]))):(u(),n("svg",ss,e[12]||(e[12]=[s("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"},null,-1)])))]),s("div",es,[s("h3",{class:y(["text-sm font-medium",[a.value?"text-green-800":"text-red-800"]])},x(a.value||l.value),3)])])],2)):j("",!0),s("div",null,[e[13]||(e[13]=s("label",{for:"current-password",class:"block text-sm font-medium text-gray-700"}," Mot de passe actuel ",-1)),s("div",os,[v(s("input",{type:"password",name:"current-password",id:"current-password","onUpdate:modelValue":e[2]||(e[2]=o=>t.old_password=o),required:"",class:"shadow-sm focus:ring-primary-500 focus:border-primary-500 block w-full sm:text-sm border-gray-300 rounded-md"},null,512),[[f,t.old_password]])])]),s("div",null,[e[14]||(e[14]=s("label",{for:"new-password",class:"block text-sm font-medium text-gray-700"}," Nouveau mot de passe ",-1)),s("div",rs,[v(s("input",{type:"password",name:"new-password",id:"new-password","onUpdate:modelValue":e[3]||(e[3]=o=>t.new_password=o),required:"",class:"shadow-sm focus:ring-primary-500 focus:border-primary-500 block w-full sm:text-sm border-gray-300 rounded-md"},null,512),[[f,t.new_password]])])]),s("div",null,[e[15]||(e[15]=s("label",{for:"confirm-password",class:"block text-sm font-medium text-gray-700"}," Confirmer le nouveau mot de passe ",-1)),s("div",ts,[v(s("input",{type:"password",name:"confirm-password",id:"confirm-password","onUpdate:modelValue":e[4]||(e[4]=o=>t.confirm_password=o),required:"",class:"shadow-sm focus:ring-primary-500 focus:border-primary-500 block w-full sm:text-sm border-gray-300 rounded-md"},null,512),[[f,t.confirm_password]])])])]),s("div",as,[s("button",{type:"submit",disabled:w.value,class:"inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500"},x(w.value?"Modification...":"Modifier le mot de passe"),9,ls)])])],32)])])])])]))}});export{ns as default};
