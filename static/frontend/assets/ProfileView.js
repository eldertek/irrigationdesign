import{d as k,i as L,r as f,k as g,o as M,c as w,a as s,w as x,b,t as v,f as m,v as u,h as y}from"./index.js";const V={class:"min-h-screen bg-gray-50 py-12"},z={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},A={class:"md:grid md:grid-cols-3 md:gap-6"},E={class:"mt-5 md:mt-0 md:col-span-2"},S={class:"shadow sm:rounded-md sm:overflow-hidden"},U={class:"px-4 py-5 bg-white space-y-6 sm:p-6"},C={key:0,class:"rounded-md bg-red-50 p-4"},P={class:"flex"},j={class:"ml-3"},q={class:"text-sm font-medium text-red-800"},B={class:"mt-1"},N={class:"mt-1"},D={class:"px-4 py-3 bg-gray-50 text-right sm:px-6"},F=["disabled"],O={class:"mt-10 sm:mt-0"},T={class:"md:grid md:grid-cols-3 md:gap-6"},G={class:"mt-5 md:mt-0 md:col-span-2"},H={class:"shadow sm:rounded-md sm:overflow-hidden"},I={class:"px-4 py-5 bg-white space-y-6 sm:p-6"},J={key:0,class:"rounded-md bg-red-50 p-4"},K={class:"flex"},Q={class:"ml-3"},R={class:"text-sm font-medium text-red-800"},W={class:"mt-1"},X={class:"mt-1"},Y={class:"mt-1"},Z={class:"px-4 py-3 bg-gray-50 text-right sm:px-6"},$=["disabled"],rs=k({__name:"ProfileView",setup(ss){const i=L(),p=f(!1),c=f(!1),n=f(null),a=f(null),t=g({username:"",email:""}),r=g({old_password:"",new_password:"",confirm_password:""});M(()=>{i.user&&(t.username=i.user.username,t.email=i.user.email)});async function _(){var l;p.value=!0,n.value=null;try{await i.updateProfile({username:t.username,email:t.email})}catch(e){if((l=e.response)!=null&&l.data){const o=e.response.data,d=Object.values(o)[0];n.value=Array.isArray(d)?d[0]:String(d)}else n.value="Une erreur est survenue lors de la mise à jour du profil"}finally{p.value=!1}}async function h(){var l;if(r.new_password!==r.confirm_password){a.value="Les mots de passe ne correspondent pas";return}c.value=!0,a.value=null;try{await i.changePassword({old_password:r.old_password,new_password:r.new_password}),r.old_password="",r.new_password="",r.confirm_password=""}catch(e){if((l=e.response)!=null&&l.data){const o=e.response.data,d=Object.values(o)[0];a.value=Array.isArray(d)?d[0]:String(d)}else a.value="Une erreur est survenue lors du changement de mot de passe"}finally{c.value=!1}}return(l,e)=>(y(),w("div",V,[s("div",z,[s("div",A,[e[8]||(e[8]=s("div",{class:"md:col-span-1"},[s("div",{class:"px-4 sm:px-0"},[s("h3",{class:"text-lg font-medium leading-6 text-gray-900"}," Profil "),s("p",{class:"mt-1 text-sm text-gray-600"}," Ces informations seront affichées publiquement, soyez prudent avec ce que vous partagez. ")])],-1)),s("div",E,[s("form",{onSubmit:x(_,["prevent"])},[s("div",S,[s("div",U,[n.value?(y(),w("div",C,[s("div",P,[e[5]||(e[5]=s("div",{class:"flex-shrink-0"},[s("svg",{class:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor"},[s("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})])],-1)),s("div",j,[s("h3",q,v(n.value),1)])])])):b("",!0),s("div",null,[e[6]||(e[6]=s("label",{for:"username",class:"block text-sm font-medium text-gray-700"}," Nom d'utilisateur ",-1)),s("div",B,[m(s("input",{type:"text",name:"username",id:"username","onUpdate:modelValue":e[0]||(e[0]=o=>t.username=o),class:"shadow-sm focus:ring-primary-500 focus:border-primary-500 block w-full sm:text-sm border-gray-300 rounded-md"},null,512),[[u,t.username]])])]),s("div",null,[e[7]||(e[7]=s("label",{for:"email",class:"block text-sm font-medium text-gray-700"}," Adresse e-mail ",-1)),s("div",N,[m(s("input",{type:"email",name:"email",id:"email","onUpdate:modelValue":e[1]||(e[1]=o=>t.email=o),class:"shadow-sm focus:ring-primary-500 focus:border-primary-500 block w-full sm:text-sm border-gray-300 rounded-md"},null,512),[[u,t.email]])])])]),s("div",D,[s("button",{type:"submit",disabled:p.value,class:"inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500"},v(p.value?"Enregistrement...":"Enregistrer"),9,F)])])],32)])]),e[14]||(e[14]=s("div",{class:"hidden sm:block","aria-hidden":"true"},[s("div",{class:"py-5"},[s("div",{class:"border-t border-gray-200"})])],-1)),s("div",O,[s("div",T,[e[13]||(e[13]=s("div",{class:"md:col-span-1"},[s("div",{class:"px-4 sm:px-0"},[s("h3",{class:"text-lg font-medium leading-6 text-gray-900"}," Mot de passe "),s("p",{class:"mt-1 text-sm text-gray-600"}," Assurez-vous d'utiliser un mot de passe sécurisé. ")])],-1)),s("div",G,[s("form",{onSubmit:x(h,["prevent"])},[s("div",H,[s("div",I,[a.value?(y(),w("div",J,[s("div",K,[e[9]||(e[9]=s("div",{class:"flex-shrink-0"},[s("svg",{class:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor"},[s("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})])],-1)),s("div",Q,[s("h3",R,v(a.value),1)])])])):b("",!0),s("div",null,[e[10]||(e[10]=s("label",{for:"current-password",class:"block text-sm font-medium text-gray-700"}," Mot de passe actuel ",-1)),s("div",W,[m(s("input",{type:"password",name:"current-password",id:"current-password","onUpdate:modelValue":e[2]||(e[2]=o=>r.old_password=o),required:"",class:"shadow-sm focus:ring-primary-500 focus:border-primary-500 block w-full sm:text-sm border-gray-300 rounded-md"},null,512),[[u,r.old_password]])])]),s("div",null,[e[11]||(e[11]=s("label",{for:"new-password",class:"block text-sm font-medium text-gray-700"}," Nouveau mot de passe ",-1)),s("div",X,[m(s("input",{type:"password",name:"new-password",id:"new-password","onUpdate:modelValue":e[3]||(e[3]=o=>r.new_password=o),required:"",class:"shadow-sm focus:ring-primary-500 focus:border-primary-500 block w-full sm:text-sm border-gray-300 rounded-md"},null,512),[[u,r.new_password]])])]),s("div",null,[e[12]||(e[12]=s("label",{for:"confirm-password",class:"block text-sm font-medium text-gray-700"}," Confirmer le nouveau mot de passe ",-1)),s("div",Y,[m(s("input",{type:"password",name:"confirm-password",id:"confirm-password","onUpdate:modelValue":e[4]||(e[4]=o=>r.confirm_password=o),required:"",class:"shadow-sm focus:ring-primary-500 focus:border-primary-500 block w-full sm:text-sm border-gray-300 rounded-md"},null,512),[[u,r.confirm_password]])])])]),s("div",Z,[s("button",{type:"submit",disabled:c.value,class:"inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500"},v(c.value?"Modification...":"Modifier le mot de passe"),9,$)])])],32)])])])])]))}});export{rs as default};
